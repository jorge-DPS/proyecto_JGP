!function(){"use strict";function f(e){var t=e;return{get:function(){return t},set:function(e){t=e}}}function i(e){return function(){return e}}var e=tinymce.util.Tools.resolve("tinymce.PluginManager"),h=function(){return(h=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},a=i(!1),u=i(!0),t=i("[!-#%-*,-\\/:;?@\\[-\\]_{}¡«·»¿;·՚-՟։֊־׀׃׆׳״؉؊،؍؛؞؟٪-٭۔܀-܍߷-߹࠰-࠾࡞।॥॰෴๏๚๛༄-༒༺-༽྅࿐-࿔࿙࿚၊-၏჻፡-፨᐀᙭᙮᚛᚜᛫-᛭᜵᜶។-៖៘-៚᠀-᠊᥄᥅᨞᨟᪠-᪦᪨-᪭᭚-᭠᯼-᯿᰻-᰿᱾᱿᳓‐-‧‰-⁃⁅-⁑⁓-⁞⁽⁾₍₎〈〉❨-❵⟅⟆⟦-⟯⦃-⦘⧘-⧛⧼⧽⳹-⳼⳾⳿⵰⸀-⸮⸰⸱、-〃〈-】〔-〟〰〽゠・꓾꓿꘍-꘏꙳꙾꛲-꛷꡴-꡷꣎꣏꣸-꣺꤮꤯꥟꧁-꧍꧞꧟꩜-꩟꫞꫟꯫﴾﴿︐-︙︰-﹒﹔-﹡﹣﹨﹪﹫！-＃％-＊，-／：；？＠［-］＿｛｝｟-･]"),n=function(){return c},c={fold:function(e,t){return e()},is:a,isSome:a,isNone:u,getOr:l,getOrThunk:o,getOrDie:function(e){throw new Error(e||"error: getOrDie called on none.")},getOrNull:i(null),getOrUndefined:i(void 0),or:l,orThunk:o,map:n,each:function(){},bind:n,exists:a,forall:u,filter:n,equals:r,equals_:r,toArray:function(){return[]},toString:i("none()")};function r(e){return e.isNone()}function o(e){return e()}function l(e){return e}function s(e,t){for(var n=e.length,r=new Array(n),o=0;o<n;o++){var i=e[o];r[o]=t(i,o)}return r}function d(e,t){for(var n=0,r=e.length;n<r;n++)t(e[n],n)}function m(e,t){for(var n=e.length-1;0<=n;n--)t(e[n],n)}function g(e,t){return function(e){for(var t=[],n=0,r=e.length;n<r;++n){if(!S(e[n]))throw new Error("Arr.flatten item "+n+" was not an array, input: "+e);B.apply(t,e[n])}return t}(s(e,t))}function p(e,t){return F.call(e,t)}function v(e,t,n){!function(e,t,n){if(!(k(n)||A(n)||D(n)))throw console.error("Invalid call to Attribute.set. Key ",t,":: Value ",n,":: Element ",e),new Error("Attribute value was not simple");e.setAttribute(t,n+"")}(e.dom,t,n)}function y(e,t){return{element:e,offset:t}}function x(e,t){var n=s(e.dom.childNodes,P.fromDom);return 0<n.length&&t<n.length?y(n[t],0):y(e,t)}function b(t,n){T.from(t.dom.parentNode).map(P.fromDom).each(function(e){e.dom.insertBefore(n.dom,t.dom)})}function w(e,t){b(e,t),t.dom.appendChild(e.dom)}var O,C=function(n){function e(){return o}function t(e){return e(n)}var r=i(n),o={fold:function(e,t){return t(n)},is:function(e){return n===e},isSome:u,isNone:a,getOr:r,getOrThunk:r,getOrDie:r,getOrNull:r,getOrUndefined:r,or:e,orThunk:e,map:function(e){return C(e(n))},each:function(e){e(n)},bind:t,exists:t,forall:t,filter:function(e){return e(n)?o:c},toArray:function(){return[n]},toString:function(){return"some("+n+")"},equals:function(e){return e.is(n)},equals_:function(e,t){return e.fold(a,function(e){return t(n,e)})}};return o},T={some:C,none:n,from:function(e){return null==e?c:C(e)}},N=t,E=tinymce.util.Tools.resolve("tinymce.util.Tools"),n=function(n){return function(e){return e=typeof(t=e),(null===t?"null":"object"==e&&(Array.prototype.isPrototypeOf(t)||t.constructor&&"Array"===t.constructor.name)?"array":"object"==e&&(String.prototype.isPrototypeOf(t)||t.constructor&&"String"===t.constructor.name)?"string":e)===n;var t}},t=function(t){return function(e){return typeof e===t}},k=n("string"),S=n("array"),A=t("boolean"),D=t("number"),M=Array.prototype.slice,B=Array.prototype.push,F=Object.hasOwnProperty,t=("undefined"!=typeof window||Function("return this;")(),O=3,function(e){return e.dom.nodeType===O}),I=function(e){if(null==e)throw new Error("Node cannot be null or undefined");return{dom:e}},P={fromHtml:function(e,t){t=(t||document).createElement("div");if(t.innerHTML=e,!t.hasChildNodes()||1<t.childNodes.length)throw console.error("HTML does not have a single root node",e),new Error("HTML must have a single root node");return I(t.childNodes[0])},fromTag:function(e,t){e=(t||document).createElement(e);return I(e)},fromText:function(e,t){e=(t||document).createTextNode(e);return I(e)},fromDom:I,fromPoint:function(e,t,n){return T.from(e.dom.elementFromPoint(t,n)).map(I)}};function R(e){return ge.get(e)}function W(e,t){return n=t,1!==(t=e=void 0===(t=e)?document:t.dom).nodeType&&9!==t.nodeType&&11!==t.nodeType||0===t.childElementCount?[]:s(e.querySelectorAll(n),P.fromDom);var n}function j(e,t){return e.isBlock(t)||p(e.schema.getShortEndedElements(),t.nodeName)}function q(e,t){return"false"===e.getContentEditable(t)}function V(e,t){return!e.isBlock(t)&&p(e.schema.getWhiteSpaceElements(),t.nodeName)}function _(){return{sOffset:0,fOffset:0,elements:[]}}function H(e,t){return x(P.fromDom(e),t)}function L(e,t,n,r,o,i){for(var a=(i=void 0===i?!0:i)?t(!1):n;a;){var u=q(e,a);if(u||V(e,a)){if(u?r.cef(a):r.boundary(a))break;a=t(!0)}else{if(j(e,a)){if(r.boundary(a))break}else 3===a.nodeType&&r.text(a);if(a===o)break;a=t(!1)}}}function U(e,t,n,r,o){var i,a;j(i=e,a=n)||q(i,a)||V(i,a)||(a=a,"true"===(i=i).getContentEditable(a)&&"false"===i.getContentEditableParent(a.parentNode))||(r=e.getParent(r,e.isBlock),r=new pe(n,r),r=o?r.next:r.prev,L(e,r,n,{boundary:u,cef:u,text:function(e){o?t.fOffset+=e.length:t.sOffset+=e.length,t.elements.push(P.fromDom(e))}}))}function $(e,t,n,r,o,i){void 0===i&&(i=!0);var a=new pe(n,t),u=[],c=_();function l(){return 0<c.elements.length&&(u.push(c),c=_()),!1}return U(e,c,n,t,!1),L(e,a.next,n,{boundary:l,cef:function(e){return l(),o&&u.push.apply(u,o.cef(e)),!1},text:function(e){c.elements.push(P.fromDom(e)),o&&o.text(e,c)}},r,i),r&&U(e,c,r,t,!0),l(),u}function z(t,e){var n=H(e.startContainer,e.startOffset),r=n.element.dom,o=H(e.endContainer,e.endOffset),i=o.element.dom;return $(t,e.commonAncestorContainer,r,i,{text:function(e,t){e===i?t.fOffset+=e.length-o.offset:e===r&&(t.sOffset+=n.offset)},cef:function(e){return function(e,t){e=M.call(e,0);return e.sort(t),e}(g(W(P.fromDom(e),"*[contenteditable=true]"),function(e){e=e.dom;return $(t,e,e)}),function(e,t){return n=e.elements[0].dom,e=t.elements[0].dom,t=Node.DOCUMENT_POSITION_PRECEDING,0!=(n.compareDocumentPosition(e)&t)?1:-1;var n})}},!1)}function G(e,t){return t.collapsed?[]:z(e,t)}function K(e,t){var n=e.createRng();return n.selectNode(t),G(e,n)}function J(e,i){var t,n;return function(e,t){if(0===e.length)return[];for(var n=t(e[0]),r=[],o=[],i=0,a=e.length;i<a;i++){var u=e[i],c=t(u);c!==n&&(r.push(o),o=[]),n=c,o.push(u)}return 0!==o.length&&r.push(o),r}((t=function(e,n){var t=R(n),r=e.last,o=r+t.length,t=g(i,function(e,t){return e.start<o&&e.finish>r?[{element:n,start:Math.max(r,e.start)-r,finish:Math.min(o,e.finish)-r,matchId:t}]:[]});return{results:e.results.concat(t),last:o}},n={results:[],last:0},d(e,function(e){n=t(n,e)}),n.results),function(e){return e.matchId})}function Q(r,e){return g(e,function(e){var t=e.elements,n=s(t,R).join(""),e=function(e,t,n,r){void 0===r&&(r=e.length);var o=t.regex;o.lastIndex=n=void 0===n?0:n;for(var i=[];u=o.exec(e);){var a=u[t.matchIndex],u=u.index+u[0].indexOf(a),a=u+a.length;if(r<a)break;i.push({start:u,finish:a}),o.lastIndex=a}return i}(n,r,e.sOffset,n.length-e.fOffset);return J(t,e)})}function X(e,o){m(e,function(e,r){m(e,function(e){var t=P.fromDom(o.cloneNode(!1));v(t,"data-mce-index",r);var n=e.element.dom;n.length===e.finish&&0===e.start?w(e.element,t):(n.length!==e.finish&&n.splitText(e.finish),e=n.splitText(e.start),w(P.fromDom(e),t))})})}function Y(e,t,n,r){var o,i=n.getBookmark(),a=e.select("td[data-mce-selected],th[data-mce-selected]"),e=0<a.length?(o=e,g(a,function(e){return K(o,e)})):G(e,n.getRng()),e=Q(t,e);return X(e,r),n.moveToBookmark(i),e.length}function Z(e){return"number"==typeof(e=e.getAttribute("data-mce-index"))?""+e:e}function ee(e,t,n,r){var o=e.dom.create("span",{"data-mce-bogus":1});o.className="mce-match-marker";var i=e.getBody();return ve(e,t,!1),r?Y(e.dom,n,e.selection,o):function(e,t,n,r){n=K(e,n),n=Q(t,n);return X(n,r),n.length}(e.dom,n,i,o)}function te(e){var t=e.parentNode;e.firstChild&&t.insertBefore(e.firstChild,e),e.parentNode.removeChild(e)}function ne(e,t){var n=[],r=E.toArray(e.getBody().getElementsByTagName("span"));if(r.length)for(var o=0;o<r.length;o++){var i=Z(r[o]);null!==i&&i.length&&i===t.toString()&&n.push(r[o])}return n}function re(e,t,n){var r=t.get(),o=r.index,t=e.dom;return(n=!1!==n)?o+1===r.count?o=0:o++:o-1==-1?o=r.count-1:o--,t.removeClass(ne(e,r.index),"mce-match-marker-selected"),(r=ne(e,o)).length?(t.addClass(ne(e,o),"mce-match-marker-selected"),e.selection.scrollIntoView(r[0]),o):-1}function oe(e,t){var n=t.parentNode;e.remove(t),e.isEmpty(n)&&e.remove(n)}function ie(e,t,n,r,o,i){var a=function(e,t){e="("+e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&").replace(/\s/g,"[^\\S\\r\\n\\uFEFF]")+")";return t?"(?:^|\\s|"+N()+")"+e+"(?=$|\\s|"+N()+")":e}(n,o),a={regex:new RegExp(a,r?"g":"gi"),matchIndex:1};return(a=ee(e,t,a,i))&&(e=re(e,t,!0),t.set({index:e,count:a,text:n,matchCase:r,wholeWord:o,inSelection:i})),a}function ae(e,t){e=re(e,t,!0),t.set(h(h({},t.get()),{index:e}))}function ue(e,t){e=re(e,t,!1),t.set(h(h({},t.get()),{index:e}))}function ce(e){return null!==(e=Z(e))&&0<e.length}function le(e,t,n,r,o){var i,a=t.get(),u=a.index,c=u;r=!1!==r;for(var l=e.getBody(),s=E.grep(E.toArray(l.getElementsByTagName("span")),ce),f=0;f<s.length;f++){var d=Z(s[f]),m=i=parseInt(d,10);if(o||m===a.index){for(n.length?(s[f].firstChild.nodeValue=n,te(s[f])):oe(e.dom,s[f]);s[++f];){if((m=parseInt(Z(s[f]),10))!==i){f--;break}oe(e.dom,s[f])}r&&c--}else u<i&&s[f].setAttribute("data-mce-index",String(i-1))}return t.set(h(h({},a),{count:o?0:a.count-1,index:c})),(r?ae:ue)(e,t),!o&&0<t.get().count}function se(i,a){var t,e=(t=f(T.none()),{clear:function(){return t.set(T.none())},set:function(e){return t.set(T.some(e))},isSet:function(){return t.get().isSome()},on:function(e){return t.get().each(e)}});i.undoManager.add();var n=E.trim(i.selection.getContent({format:"text"}));function u(e){(1<a.get().count?e.enable:e.disable)("next"),(1<a.get().count?e.enable:e.disable)("prev")}function o(e,t){e=t?e.disable:e.enable,d(["replace","replaceall","prev","next"],e)}function c(e,t){ye.browser.isSafari()&&ye.deviceType.isTouch()&&("find"===t||"replace"===t||"replaceall"===t)&&e.focus(t)}function l(e){ve(i,a,!1),o(e,!0),u(e)}function s(e){var t,n=e.getData(),r=a.get();n.findtext.length?(r.text===n.findtext&&r.matchCase===n.matchcase&&r.wholeWord===n.wholewords?ae(i,a):((n=ie(i,a,n.findtext,n.matchcase,n.wholewords,n.inselection))<=0&&(t=e,i.windowManager.alert("Could not find the specified string.",function(){t.focus("findtext")})),o(e,0===n)),u(e)):l(e)}var r=a.get(),r={title:"Find and Replace",size:"normal",body:{type:"panel",items:[{type:"bar",items:[{type:"input",name:"findtext",placeholder:"Find",maximized:!0,inputMode:"search"},{type:"button",name:"prev",text:"Previous",icon:"action-prev",disabled:!0,borderless:!0},{type:"button",name:"next",text:"Next",icon:"action-next",disabled:!0,borderless:!0}]},{type:"input",name:"replacetext",placeholder:"Replace with",inputMode:"search"}]},buttons:[{type:"menu",name:"options",icon:"preferences",tooltip:"Preferences",align:"start",items:[{type:"togglemenuitem",name:"matchcase",text:"Match case"},{type:"togglemenuitem",name:"wholewords",text:"Find whole words only"},{type:"togglemenuitem",name:"inselection",text:"Find in selection"}]},{type:"custom",name:"find",text:"Find",primary:!0},{type:"custom",name:"replace",text:"Replace",disabled:!0},{type:"custom",name:"replaceall",text:"Replace All",disabled:!0}],initialData:{findtext:n,replacetext:"",wholewords:r.wholeWord,matchcase:r.matchCase,inselection:r.inSelection},onChange:function(e,t){"findtext"===t.name&&0<a.get().count&&l(e)},onAction:function(e,t){var n,r,o=e.getData();switch(t.name){case"find":s(e);break;case"replace":(le(i,a,o.replacetext)?u:l)(e);break;case"replaceall":le(i,a,o.replacetext,!0,!0),l(e);break;case"prev":ue(i,a),u(e);break;case"next":ae(i,a),u(e);break;case"matchcase":case"wholewords":case"inselection":r=(n=e).getData(),n=a.get(),a.set(h(h({},n),{matchCase:r.matchcase,wholeWord:r.wholewords,inSelection:r.inselection})),l(e)}c(e,t.name)},onSubmit:function(e){s(e),c(e,"find")},onClose:function(){i.focus(),ve(i,a),i.undoManager.add()}};e.set(i.windowManager.open(r,{inline:"toolbar"}))}function fe(e,t){return function(){se(e,t)}}var de,me,he,ge=(de=t,me="text",{get:function(e){if(!de(e))throw new Error("Can only get "+me+" value of a "+me+" node");return he(e).getOr("")},getOption:he=function(e){return de(e)?T.from(e.dom.nodeValue):T.none()},set:function(e,t){if(!de(e))throw new Error("Can only set raw "+me+" value of a "+me+" node");e.dom.nodeValue=t}}),pe=tinymce.util.Tools.resolve("tinymce.dom.TreeWalker"),ve=function(e,t,n){for(var r,o,i=t.get(),a=E.toArray(e.getBody().getElementsByTagName("span")),u=0;u<a.length;u++){var c=Z(a[u]);null!==c&&c.length&&(c===i.index.toString()&&(r=r||a[u].firstChild,o=a[u].firstChild),te(a[u]))}if(t.set(h(h({},i),{index:-1,count:0,text:""})),r&&o){t=e.dom.createRng();return t.setStart(r,0),t.setEnd(o,o.data.length),!1!==n&&e.selection.setRng(t),t}},ye=tinymce.util.Tools.resolve("tinymce.Env");e.add("searchreplace",function(e){var t,n,r,o,i,a,u=f({index:-1,count:0,text:"",matchCase:!1,wholeWord:!1,inSelection:!1});return n=u,(t=e).addCommand("SearchReplace",function(){se(t,n)}),o=u,(r=e).ui.registry.addMenuItem("searchreplace",{text:"Find and replace...",shortcut:"Meta+F",onAction:fe(r,o),icon:"search"}),r.ui.registry.addButton("searchreplace",{tooltip:"Find and replace",onAction:fe(r,o),icon:"search"}),r.shortcuts.add("Meta+F","",fe(r,o)),i=e,a=u,{done:function(e){return ve(i,a,e)},find:function(e,t,n,r){return ie(i,a,e,t,n,r=void 0===r?!1:r)},next:function(){return ae(i,a)},prev:function(){return ue(i,a)},replace:function(e,t,n){return le(i,a,e,t,n)}}})}();