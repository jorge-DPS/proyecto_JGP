!function(){"use strict";function c(n){var e=n;return{get:function(){return e},set:function(n){e=n}}}function i(n){return{isFullscreen:function(){return null!==n.get()}}}function e(){}function u(n){return function(){return n}}var n=tinymce.util.Tools.resolve("tinymce.PluginManager");var l=u(!1),f=u(!0),t=function(){return a},a={fold:function(n,e){return n()},is:l,isSome:l,isNone:f,getOr:s,getOrThunk:o,getOrDie:function(n){throw new Error(n||"error: getOrDie called on none.")},getOrNull:u(null),getOrUndefined:u(void 0),or:s,orThunk:o,map:t,each:e,bind:t,exists:l,forall:f,filter:t,equals:r,equals_:r,toArray:function(){return[]},toString:u("none()")};function r(n){return n.isNone()}function o(n){return n()}function s(n){return n}function m(){return n=function(n){return n.unbind()},t=c(Y.none()),{clear:function(){e(),t.set(Y.none())},isSet:function(){return t.get().isSome()},set:function(n){e(),t.set(Y.some(n))}};function e(){return t.get().each(n)}var n,t}function d(t){return function(n){return n=typeof(e=n),(null===e?"null":"object"==n&&(Array.prototype.isPrototypeOf(e)||e.constructor&&"Array"===e.constructor.name)?"array":"object"==n&&(String.prototype.isPrototypeOf(e)||e.constructor&&"String"===e.constructor.name)?"string":n)===t;var e}}function h(n){return!(null==n)}function g(n,e){for(var t=n.length,r=new Array(t),o=0;o<t;o++){var u=n[o];r[o]=e(u,o)}return r}function p(n,e){for(var t=0,r=n.length;t<r;t++)e(n[t],t)}function v(n,e){for(var t=[],r=0,o=n.length;r<o;r++){var u=n[r];e(u,r)&&t.push(u)}return t}function y(n,e){return function(n){for(var e=[],t=0,r=n.length;t<r;++t){if(!J(n[t]))throw new Error("Arr.flatten item "+t+" was not an array, input: "+n);nn.apply(e,n[t])}return e}(g(n,e))}function w(n){return e=n,(n=0)<=n&&n<e.length?Y.some(e[n]):Y.none();var e}function b(n){return void 0!==n.style&&Z(n.style.getPropertyValue)}function S(n,e){if(1!==(n=n.dom).nodeType)return!1;if(void 0!==n.matches)return n.matches(e);if(void 0!==n.msMatchesSelector)return n.msMatchesSelector(e);if(void 0!==n.webkitMatchesSelector)return n.webkitMatchesSelector(e);if(void 0!==n.mozMatchesSelector)return n.mozMatchesSelector(e);throw new Error("Browser lacks native selectors")}function E(n){return rn.fromDom(n.dom.ownerDocument)}function F(e){return Y.from(e.dom.parentNode).map(rn.fromDom).map(fn).map(function(n){return v(n,function(n){return e.dom!==n.dom})}).getOr([])}function T(n){return n=sn(n),ln(n)?Y.some(n):Y.none()}function x(n){return rn.fromDom(n.dom.host)}function D(n,e,t){!function(n,e,t){if(!(G(t)||Q(t)||$(t)))throw console.error("Invalid call to Attribute.set. Key ",e,":: Value ",t,":: Element ",n),new Error("Attribute value was not simple");n.setAttribute(e,t+"")}(n.dom,e,t)}function k(n,e){return null===(e=n.dom.getAttribute(e))?void 0:e}function C(n,e){n.dom.removeAttribute(e)}function O(n,e){var t=n.dom;!function(n,e){for(var t=en(n),r=0,o=t.length;r<o;r++){var u=t[r];e(n[u],u)}}(e,function(n,e){!function(n,e,t){if(!G(t))throw console.error("Invalid call to CSS.set. Property ",e,":: Value ",t,":: Element ",n),new Error("CSS value must be a string: "+t);b(n)&&n.style.setProperty(e,t)}(t,e,n)})}function A(n){function e(){return n.stopPropagation()}function t(){return n.preventDefault()}var r,o,u=rn.fromDom(function(n){if(an()&&h(n.target)){var e=rn.fromDom(n.target);if(on(e)&&mn(e)&&n.composed&&n.composedPath){e=n.composedPath();if(e)return w(e)}}return Y.from(n.target)}(n).getOr(n.target)),i=(r=t,o=e,function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return r(o.apply(null,n))});return{target:u,x:n.clientX,y:n.clientY,stop:e,prevent:t,kill:i,raw:n}}function N(n,e,t,r,o){var u,i,r=(u=t,i=r,function(n){u(n)&&i(A(n))});return n.dom.addEventListener(e,r,o),{unbind:function(r){for(var o=[],n=1;n<arguments.length;n++)o[n-1]=arguments[n];return function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];var t=o.concat(n);return r.apply(null,t)}}(gn,n,e,r,o)}}function M(n,e,t){return N(n,e,pn,t,!1)}function P(n){return n=void 0===n?window:n,Y.from(n.visualViewport)}function L(n,e,t,r){return{x:n,y:e,width:t,height:r,right:n+t,bottom:e+r}}function q(n){var t=void 0===n?window:n,e=t.document,r=(n=rn.fromDom(e),e=void 0!==n?n.dom:document,n=e.body.scrollLeft||e.documentElement.scrollLeft,e=e.body.scrollTop||e.documentElement.scrollTop,yn(n,e));return P(t).fold(function(){var n=t.document.documentElement,e=n.clientWidth,n=n.clientHeight;return L(r.left,r.top,e,n)},function(n){return L(Math.max(n.pageLeft,r.left),Math.max(n.pageTop,r.top),n.width,n.height)})}function H(t,r,n){return P(n).map(function(n){function e(n){return r(A(n))}return n.addEventListener(t,e),{unbind:function(){return n.removeEventListener(t,e)}}}).getOrThunk(function(){return{unbind:e}})}function R(n,e){n.fire("FullscreenStateChanged",{state:e})}function V(n){return n.getParam("fullscreen_native",!1,"boolean")}function W(n){var e=rn.fromDom(n.getElement());return T(e).map(x).getOrThunk(function(){return function(n){n=n.dom.body;if(null==n)throw new Error("Body is not available yet");return rn.fromDom(n)}(E(e))})}function B(n){return n.dom===(void 0!==(n=E(n).dom).fullscreenElement?n.fullscreenElement:void 0!==n.msFullscreenElement?n.msFullscreenElement:void 0!==n.webkitFullscreenElement?n.webkitFullscreenElement:null)}function j(n,e,t){return v(function(n,e){for(var t=Z(e)?e:l,r=n.dom,o=[];null!==r.parentNode&&void 0!==r.parentNode;){var u=r.parentNode,i=rn.fromDom(u);if(o.push(i),!0===t(i))break;r=u}return o}(n,t),e)}function z(n){return e=n,n=void 0===t?document:t.dom,1!==(t=n).nodeType&&9!==t.nodeType&&11!==t.nodeType||0===t.childElementCount?[]:g(n.querySelectorAll(e),rn.fromDom);var e,t}function I(n,e){return t=function(n){return S(n,e)},v(F(n),t);var t}function U(n){var e,t,r=(r="background-color",t=(e=n).dom,""!==(n=window.getComputedStyle(t).getPropertyValue(r))||dn(e)?n:hn(t,r));return void 0!==r&&""!==r?"background-color:"+r+"!important":"background-color:rgb(255,255,255)!important;"}function _(r,n,e){function t(t){return function(n){var e=k(n,"style"),e=void 0===e?"no-styles":e.trim();e===t||(D(n,Sn,e),O(n,r.parseStyle(t)))}}var o,u=(o="*",j(n,function(n){return S(n,o)},i)),i=y(u,function(n){return I(n,"*:not(.tox-silver-sink)")}),e=U(e);p(i,t("display:none!important;")),p(u,t(En+Fn+e)),t((!0===Tn?"":En)+Fn+e)(n)}function K(t,r){return function(e){e.setActive(null!==r.get());function n(n){return e.setActive(n.state)}return t.on("FullscreenStateChanged",n),function(){return t.off("FullscreenStateChanged",n)}}}var X=function(t){function n(){return o}function e(n){return n(t)}var r=u(t),o={fold:function(n,e){return e(t)},is:function(n){return t===n},isSome:f,isNone:l,getOr:r,getOrThunk:r,getOrDie:r,getOrNull:r,getOrUndefined:r,or:n,orThunk:n,map:function(n){return X(n(t))},each:function(n){n(t)},bind:e,exists:e,forall:e,filter:function(n){return n(t)?o:a},toArray:function(){return[t]},toString:function(){return"some("+t+")"},equals:function(n){return n.is(t)},equals_:function(n,e){return n.fold(l,function(n){return e(t,n)})}};return o},Y={some:X,none:t,from:function(n){return null==n?a:X(n)}},t=function(e){return function(n){return typeof n===e}},G=d("string"),J=d("array"),Q=t("boolean"),Z=t("function"),$=t("number"),nn=Array.prototype.push,en=Object.keys,tn=function(n){if(null==n)throw new Error("Node cannot be null or undefined");return{dom:n}},rn={fromHtml:function(n,e){e=(e||document).createElement("div");if(e.innerHTML=n,!e.hasChildNodes()||1<e.childNodes.length)throw console.error("HTML does not have a single root node",n),new Error("HTML must have a single root node");return tn(e.childNodes[0])},fromTag:function(n,e){n=(e||document).createElement(n);return tn(n)},fromText:function(n,e){n=(e||document).createTextNode(n);return tn(n)},fromDom:tn,fromPoint:function(n,e,t){return Y.from(n.dom.elementFromPoint(e,t)).map(tn)}},t=("undefined"!=typeof window||Function("return this;")(),function(e){return function(n){return n.dom.nodeType===e}}),on=t(1),un=t(3),cn=t(9),ln=t(11),fn=function(n){return g(n.dom.childNodes,rn.fromDom)},t=Z(Element.prototype.attachShadow)&&Z(Node.prototype.getRootNode),an=u(t),sn=t?function(n){return rn.fromDom(n.dom.getRootNode())}:function(n){return cn(n)?n:E(n)},mn=function(n){return h(n.dom.shadowRoot)},dn=function(n){var e=un(n)?n.dom.parentNode:n.dom;if(null==e||null===e.ownerDocument)return!1;var t,r,o=e.ownerDocument;return T(rn.fromDom(e)).fold(function(){return o.body.contains(e)},(t=dn,r=x,function(n){return t(r(n))}))},hn=function(n,e){return b(n)?n.style.getPropertyValue(e):""},gn=function(n,e,t,r){n.dom.removeEventListener(e,t,r)},pn=f,vn=function(t,r){return{left:t,top:r,translate:function(n,e){return vn(t+n,r+e)}}},yn=vn,t=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),wn=tinymce.util.Tools.resolve("tinymce.Env"),bn=tinymce.util.Tools.resolve("tinymce.util.Delay"),Sn="data-ephox-mobile-fullscreen-style",En="position:absolute!important;",Fn="top:0!important;left:0!important;margin:0!important;padding:0!important;width:100%!important;height:100%!important;overflow:visible!important;",Tn=wn.os.isAndroid(),xn=t.DOM,Dn=P().fold(function(){return{bind:e,unbind:e}},function(e){var t,r=(t=c(Y.none()),{clear:function(){return t.set(Y.none())},set:function(n){return t.set(Y.some(n))},isSet:function(){return t.get().isSome()},on:function(n){return t.get().each(n)}}),o=m(),u=m(),i=bn.throttle(function(){document.body.scrollTop=0,document.documentElement.scrollTop=0,window.requestAnimationFrame(function(){r.on(function(n){return O(n,{top:e.offsetTop+"px",left:e.offsetLeft+"px",height:e.height+"px",width:e.width+"px"})})})},50);return{bind:function(n){r.set(n),i(),o.set(H("resize",i)),u.set(H("scroll",i))},unbind:function(){r.on(function(){o.clear(),u.clear()}),r.clear()}}}),kn=function(e,r){function o(e){e(u,"tox-fullscreen"),e(i,"tox-fullscreen"),e(c,"tox-fullscreen"),T(l).map(function(n){return x(n).dom}).each(function(n){e(n,"tox-fullscreen"),e(n,"tox-shadowhost")})}function n(){var t,n;m&&(t=e.dom,n=z("["+Sn+"]"),p(n,function(n){var e=k(n,Sn);"no-styles"!==e?O(n,t.parseStyle(e)):C(n,"style"),C(n,Sn)})),o(xn.removeClass),Dn.unbind(),Y.from(r.get()).each(function(n){return n.fullscreenChangeHandler.unbind()})}var t,u=document.body,i=document.documentElement,c=e.getContainer(),l=rn.fromDom(c),f=W(e),a=r.get(),s=rn.fromDom(e.getBody()),m=wn.deviceType.isTouch(),d=c.style,h=e.iframeElement.style;a?(a.fullscreenChangeHandler.unbind(),V(e)&&B(f)&&function(n){n=n.dom;n.exitFullscreen?n.exitFullscreen():n.msExitFullscreen?n.msExitFullscreen():n.webkitCancelFullScreen&&n.webkitCancelFullScreen()}(E(f)),h.width=a.iframeWidth,h.height=a.iframeHeight,d.width=a.containerWidth,d.height=a.containerHeight,d.top=a.containerTop,d.left=a.containerLeft,t=a.scrollPos,window.scrollTo(t.x,t.y),r.set(null),R(e,!1),n(),e.off("remove",n)):(a=M(E(f),void 0!==document.fullscreenElement?"fullscreenchange":void 0!==document.msFullscreenElement?"MSFullscreenChange":void 0!==document.webkitFullscreenElement?"webkitfullscreenchange":"fullscreenchange",function(n){V(e)&&(B(f)||null===r.get()||kn(e,r))}),a={scrollPos:{x:(t=q(window)).x,y:t.y},containerWidth:d.width,containerHeight:d.height,containerTop:d.top,containerLeft:d.left,iframeWidth:h.width,iframeHeight:h.height,fullscreenChangeHandler:a},m&&_(e.dom,l,s),h.width=h.height="100%",d.width=d.height="",o(xn.addClass),Dn.bind(l),e.on("remove",n),r.set(a),V(e)&&function(n){n=n.dom;n.requestFullscreen?n.requestFullscreen():n.msRequestFullscreen?n.msRequestFullscreen():n.webkitRequestFullScreen&&n.webkitRequestFullScreen()}(f),R(e,!0))};n.add("fullscreen",function(n){var e,t,r,o,u=c(null);return n.inline||(t=u,(e=n).addCommand("mceFullScreen",function(){kn(e,t)}),o=u,(r=n).ui.registry.addToggleMenuItem("fullscreen",{text:"Fullscreen",icon:"fullscreen",shortcut:"Meta+Shift+F",onAction:function(){return r.execCommand("mceFullScreen")},onSetup:K(r,o)}),r.ui.registry.addToggleButton("fullscreen",{tooltip:"Fullscreen",icon:"fullscreen",onAction:function(){return r.execCommand("mceFullScreen")},onSetup:K(r,o)}),n.addShortcut("Meta+Shift+F","","mceFullScreen")),i(u)})}();