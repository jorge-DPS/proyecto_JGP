!function(){"use strict";function l(n){var e=n;return{get:function(){return e},set:function(n){e=n}}}function e(){}function u(n){return function(){return n}}function n(){return n=function(n){return n.unbind()},e=l(R.none()),t=function(){return e.get().each(n)},{clear:function(){t(),e.set(R.none())},isSet:function(){return e.get().isSome()},set:function(n){t(),e.set(R.some(n))}};var n,e,t}function c(n){return!(null===n||void 0===n)}function w(n,e){for(var t=n.length,r=new Array(t),o=0;o<t;o++){var u=n[o];r[o]=e(u,o)}return r}function b(n,e){for(var t=0,r=n.length;t<r;t++)e(n[t],t)}function i(n,e){for(var t=[],r=0,o=n.length;r<o;r++){var u=n[r];e(u,r)&&t.push(u)}return t}function f(n){return void 0!==n.style&&z(n.style.getPropertyValue)}function t(n){if(null==n)throw new Error("Node cannot be null or undefined");return{dom:n}}function a(n,e){if(1!==(n=n.dom).nodeType)return!1;if(void 0!==n.matches)return n.matches(e);if(void 0!==n.msMatchesSelector)return n.msMatchesSelector(e);if(void 0!==n.webkitMatchesSelector)return n.webkitMatchesSelector(e);if(void 0!==n.mozMatchesSelector)return n.mozMatchesSelector(e);throw new Error("Browser lacks native selectors")}function S(n){return K(n.dom.ownerDocument)}function E(n){return n=$(n),J(n)?R.some(n):R.none()}function F(n){return K(n.dom.host)}function s(n,e,t){!function(n,e,t){if(!(W(t)||j(t)||I(t)))throw console.error("Invalid call to Attribute.set. Key ",e,":: Value ",t,":: Element ",n),new Error("Attribute value was not simple");n.setAttribute(e,t+"")}(n.dom,e,t)}function T(n,e){return null===(e=n.dom.getAttribute(e))?void 0:e}function x(n,e){n.dom.removeAttribute(e)}function k(n,e){var i=n.dom;!function(n){for(var e,t=_(n),r=0,o=t.length;r<o;r++){var u=t[r];e=n[u],function(n,e,t){if(!W(t))throw console.error("Invalid call to CSS.set. Property ",e,":: Value ",t,":: Element ",n),new Error("CSS value must be a string: "+t);f(n)&&n.style.setProperty(e,t)}(i,u,e)}}(e)}function d(n){function e(){return n.stopPropagation()}function t(){return n.preventDefault()}var r,o,u=K(function(n){if(Z()&&c(n.target)){var e=K(n.target);if(X(e)&&c(e.dom.shadowRoot)&&n.composed&&n.composedPath){e=n.composedPath();if(e)return 0<(e=e).length?R.some(e[0]):R.none()}}return R.from(n.target)}(n).getOr(n.target)),i=(r=t,o=e,function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return r(o.apply(null,n))});return{target:u,x:n.clientX,y:n.clientY,stop:e,prevent:t,kill:i,raw:n}}function O(n,e,t){return r=e,e=!1,o=tn,u=t=t,t=function(n){o(n)&&u(d(n))},(n=n).dom.addEventListener(r,t,e),{unbind:function(r){for(var o=[],n=1;n<arguments.length;n++)o[n-1]=arguments[n];return function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];var t=o.concat(n);return r.apply(null,t)}}(en,n,r,t,e)};var r,o,u}function A(n){return n=void 0===n?window:n,R.from(n.visualViewport)}function C(n,e,t,r){return{x:n,y:e,width:t,height:r,right:n+t,bottom:e+r}}function m(t,r,n){return A(n).map(function(n){function e(n){return r(d(n))}return n.addEventListener(t,e),{unbind:function(){return n.removeEventListener(t,e)}}}).getOrThunk(function(){return{unbind:e}})}function M(n,e){n.fire("FullscreenStateChanged",{state:e})}function N(n){return n.getParam("fullscreen_native",!1,"boolean")}function P(n){return n.dom===(void 0!==(n=S(n).dom).fullscreenElement?n.fullscreenElement:void 0!==n.msFullscreenElement?n.msFullscreenElement:void 0!==n.webkitFullscreenElement?n.webkitFullscreenElement:null)}function h(n,e){return r=function(n){return a(n,e)},i((t=n,R.from(t.dom.parentNode).map(K).map(Q).map(function(n){return i(n,function(n){return t.dom!==n.dom})}).getOr([])),r);var t,r}function g(n){var e,t,r,o=(t="background-color",r=(e=n).dom,""!==(n=window.getComputedStyle(r).getPropertyValue(t))||nn(e)?n:(o=t,f(r=r)?r.style.getPropertyValue(o):""));return void 0!==o&&""!==o?"background-color:"+o+"!important":"background-color:rgb(255,255,255)!important;"}function q(r,n,e){function t(t){return function(n){var e=T(n,"style"),e=void 0===e?"no-styles":e.trim();e!==t&&(s(n,cn,e),k(n,r.parseStyle(t)))}}var o=(u=function(n){return a(n,"*")},i(function(n,e){for(var t=z(e)?e:v,r=n.dom,o=[];null!==r.parentNode&&void 0!==r.parentNode;){var u=r.parentNode,i=K(u);if(o.push(i),!0===t(i))break;r=u}return o}(n,void 0),u)),u=function(n){for(var e=[],t=0,r=n.length;t<r;++t){if(!B(n[t]))throw new Error("Arr.flatten item "+t+" was not an array, input: "+n);U.apply(e,n[t])}return e}(w(o,function(n){return h(n,"*:not(.tox-silver-sink)")})),e=g(e);b(u,t("display:none!important;")),b(o,t(fn+an+e)),t((!0===sn?"":fn)+an+e)(n)}function p(t,r){return function(e){e.setActive(null!==r.get());function n(n){return e.setActive(n.state)}return t.on("FullscreenStateChanged",n),function(){return t.off("FullscreenStateChanged",n)}}}var r,o=tinymce.util.Tools.resolve("tinymce.PluginManager"),v=u(!1),y=u(!0),D=function(){return L},L={fold:function(n,e){return n()},is:v,isSome:v,isNone:y,getOr:r=function(n){return n},getOrThunk:V=function(n){return n()},getOrDie:function(n){throw new Error(n||"error: getOrDie called on none.")},getOrNull:u(null),getOrUndefined:u(void 0),or:r,orThunk:V,map:D,each:e,bind:D,exists:v,forall:y,filter:D,equals:V=function(n){return n.isNone()},equals_:V,toArray:function(){return[]},toString:u("none()")},H=function(t){function n(){return o}function e(n){return n(t)}var r=u(t),o={fold:function(n,e){return e(t)},is:function(n){return t===n},isSome:y,isNone:v,getOr:r,getOrThunk:r,getOrDie:r,getOrNull:r,getOrUndefined:r,or:n,orThunk:n,map:function(n){return H(n(t))},each:function(n){n(t)},bind:e,exists:e,forall:e,filter:function(n){return n(t)?o:L},toArray:function(){return[t]},toString:function(){return"some("+t+")"},equals:function(n){return n.is(t)},equals_:function(n,e){return n.fold(v,function(n){return e(t,n)})}};return o},R={some:H,none:D,from:function(n){return null==n?L:H(n)}},V=function(t){return function(n){return n=typeof(e=n),(null===e?"null":"object"==n&&(Array.prototype.isPrototypeOf(e)||e.constructor&&"Array"===e.constructor.name)?"array":"object"==n&&(String.prototype.isPrototypeOf(e)||e.constructor&&"String"===e.constructor.name)?"string":n)===t;var e}},D=function(e){return function(n){return typeof n===e}},W=V("string"),B=V("array"),j=D("boolean"),z=D("function"),I=D("number"),U=Array.prototype.push,_=Object.keys,K=t,D=("undefined"!=typeof window||Function("return this;")(),function(e){return function(n){return n.dom.nodeType===e}}),X=D(1),Y=D(3),G=D(9),J=D(11),Q=function(n){return w(n.dom.childNodes,K)},D=z(Element.prototype.attachShadow)&&z(Node.prototype.getRootNode),Z=u(D),$=D?function(n){return K(n.dom.getRootNode())}:function(n){return G(n)?n:S(n)},nn=function(n){var e=Y(n)?n.dom.parentNode:n.dom;if(null==e||null===e.ownerDocument)return!1;var t,r,o=e.ownerDocument;return E(K(e)).fold(function(){return o.body.contains(e)},(t=nn,r=F,function(n){return t(r(n))}))},en=function(n,e,t,r){n.dom.removeEventListener(e,t,r)},tn=y,rn=function(t,r){return{left:t,top:r,translate:function(n,e){return rn(t+n,r+e)}}},on=rn,D=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),un=tinymce.util.Tools.resolve("tinymce.Env"),ln=tinymce.util.Tools.resolve("tinymce.util.Delay"),cn="data-ephox-mobile-fullscreen-style",fn="position:absolute!important;",an="top:0!important;left:0!important;margin:0!important;padding:0!important;width:100%!important;height:100%!important;overflow:visible!important;",sn=un.os.isAndroid(),dn=D.DOM,mn=A().fold(function(){return{bind:e,unbind:e}},function(e){var t,r=(t=l(R.none()),{clear:function(){return t.set(R.none())},set:function(n){return t.set(R.some(n))},isSet:function(){return t.get().isSome()},on:function(n){return t.get().each(n)}}),o=n(),u=n(),i=ln.throttle(function(){document.body.scrollTop=0,document.documentElement.scrollTop=0,window.requestAnimationFrame(function(){r.on(function(n){return k(n,{top:e.offsetTop+"px",left:e.offsetLeft+"px",height:e.height+"px",width:e.width+"px"})})})},50);return{bind:function(n){r.set(n),i(),o.set(m("resize",i)),u.set(m("scroll",i))},unbind:function(){r.on(function(){o.clear(),u.clear()}),r.clear()}}}),hn=function(o,u){function i(e){e(f,"tox-fullscreen"),e(a,"tox-fullscreen"),e(s,"tox-fullscreen"),E(d).map(function(n){return F(n).dom}).each(function(n){e(n,"tox-fullscreen"),e(n,"tox-shadowhost")})}function n(){var t,n,e,r;p&&(t=o.dom,n="["+cn+"]",n=1!==(e=r=document).nodeType&&9!==e.nodeType&&11!==e.nodeType||0===e.childElementCount?[]:w(r.querySelectorAll(n),K),b(n,function(n){var e=T(n,cn);"no-styles"!==e?k(n,t.parseStyle(e)):x(n,"style"),x(n,cn)})),i(dn.removeClass),mn.unbind(),R.from(u.get()).each(function(n){return n.fullscreenChangeHandler.unbind()})}var e,t,r,l,c,f=document.body,a=document.documentElement,s=o.getContainer(),d=K(s),m=(t=K(o.getElement()),E(t).map(F).getOrThunk(function(){var n=S(t).dom.body;if(null==n)throw new Error("Body is not available yet");return K(n)})),h=u.get(),g=K(o.getBody()),p=un.deviceType.isTouch(),v=s.style,y=o.iframeElement.style;h?(h.fullscreenChangeHandler.unbind(),N(o)&&P(m)&&((e=S(m).dom).exitFullscreen?e.exitFullscreen():e.msExitFullscreen?e.msExitFullscreen():e.webkitCancelFullScreen&&e.webkitCancelFullScreen()),y.width=h.iframeWidth,y.height=h.iframeHeight,v.width=h.containerWidth,v.height=h.containerHeight,v.top=h.containerTop,v.left=h.containerLeft,l=h.scrollPos,window.scrollTo(l.x,l.y),u.set(null),M(o,!1),n(),o.off("remove",n)):(e=O(S(m),void 0!==document.fullscreenElement?"fullscreenchange":void 0!==document.msFullscreenElement?"MSFullscreenChange":void 0!==document.webkitFullscreenElement?"webkitfullscreenchange":"fullscreenchange",function(n){N(o)&&(P(m)||null===u.get()||hn(o,u))}),e={scrollPos:{x:(h=window,r=void 0===h?window:h,l=r.document,h=(l=void 0!==(h=K(l))?h.dom:document).body.scrollLeft||l.documentElement.scrollLeft,l=l.body.scrollTop||l.documentElement.scrollTop,c=on(h,l),(l=A(r).fold(function(){var n=r.document.documentElement,e=n.clientWidth,n=n.clientHeight;return C(c.left,c.top,e,n)},function(n){return C(Math.max(n.pageLeft,c.left),Math.max(n.pageTop,c.top),n.width,n.height)})).x),y:l.y},containerWidth:v.width,containerHeight:v.height,containerTop:v.top,containerLeft:v.left,iframeWidth:y.width,iframeHeight:y.height,fullscreenChangeHandler:e},p&&q(o.dom,d,g),y.width=y.height="100%",v.width=v.height="",i(dn.addClass),mn.bind(d),o.on("remove",n),u.set(e),N(o)&&((e=m.dom).requestFullscreen?e.requestFullscreen():e.msRequestFullscreen?e.msRequestFullscreen():e.webkitRequestFullScreen&&e.webkitRequestFullScreen()),M(o,!0))};o.add("fullscreen",function(n){var e,t,r,o,u,i=l(null);return n.inline||(t=i,(e=n).addCommand("mceFullScreen",function(){hn(e,t)}),(r=n).ui.registry.addToggleMenuItem("fullscreen",{text:"Fullscreen",icon:"fullscreen",shortcut:"Meta+Shift+F",onAction:function(){return r.execCommand("mceFullScreen")},onSetup:p(r,o=i)}),r.ui.registry.addToggleButton("fullscreen",{tooltip:"Fullscreen",icon:"fullscreen",onAction:function(){return r.execCommand("mceFullScreen")},onSetup:p(r,o)}),n.addShortcut("Meta+Shift+F","","mceFullScreen")),u=i,{isFullscreen:function(){return null!==u.get()}}})}();