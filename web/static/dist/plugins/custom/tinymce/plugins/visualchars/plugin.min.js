!function(){"use strict";function n(n){return function(){return n}}function o(n){return n=typeof(t=n),"string"==(null===t?"null":"object"==n&&(Array.prototype.isPrototypeOf(t)||t.constructor&&"Array"===t.constructor.name)?"array":"object"==n&&(String.prototype.isPrototypeOf(t)||t.constructor&&"String"===t.constructor.name)?"string":n);var t}function r(n,t){for(var e=0,o=n.length;e<o;e++)t(n[e],e)}function i(n,t){for(var e=V(n),o=0,r=e.length;o<r;o++){var i=e[o];t(n[i],i)}}function e(n){return 3===n.dom.nodeType}function c(n,t,e){!function(n,t,e){if(!(o(e)||T(e)||S(e)))throw console.error("Invalid call to Attribute.set. Key ",t,":: Value ",e,":: Element ",n),new Error("Attribute value was not simple");n.setAttribute(t,e+"")}(n.dom,t,e)}function u(n,t){n.dom.removeAttribute(t)}function a(n,t){return void 0===(t=null===(t=n.dom.getAttribute(t))?void 0:t)||""===t?[]:t.split(" ")}function s(n){return void 0!==n.dom.classList}function l(n,t){return i=t,0<(n=function(n){for(var t=[],e=0,o=n.length;e<o;e++){var r=n[e];r!==i&&t.push(r)}return t}(a(t=n,"class"))).length?c(t,"class",n.join(" ")):u(t,"class"),0;var i}function t(n){if(null==n)throw new Error("Node cannot be null or undefined");return{dom:n}}function f(n){return'<span data-mce-bogus="1" class="mce-'+L[n]+'">'+n+"</span>"}function d(n){var t=B(n);return e(n)&&void 0!==t&&j.test(t)}function m(n){return"span"===n.nodeName.toLowerCase()&&n.classList.contains("mce-nbsp-wrap")}function v(n){var t=n.getBody(),e=n.selection.getBookmark(),o=void 0!==(o=function(n,t){for(;n.parentNode;){if(n.parentNode===t)return n;n=n.parentNode}}(n.selection.getNode(),t))?o:t;I(n,o),q(n,o),n.selection.moveToBookmark(e)}function g(n,t){var e=n,o=t.get();e.fire("VisualChars",{state:o}),o=n.getBody(),(!0===t.get()?q:I)(n,o)}function h(n,t){n.addCommand("mceVisualChars",function(){!function(n,t){t.set(!t.get());var e=n.selection.getBookmark();g(n,t),n.selection.moveToBookmark(e)}(n,t)})}function p(e,o){return function(t){t.setActive(o.get());function n(n){return t.setActive(n.state)}return e.on("VisualChars",n),function(){return e.off("VisualChars",n)}}}var y,b,w,k=tinymce.util.Tools.resolve("tinymce.PluginManager"),A=n(!1),C=n(!0),N=function(){return O},O={fold:function(n,t){return n()},is:A,isSome:A,isNone:C,getOr:b=function(n){return n},getOrThunk:y=function(n){return n()},getOrDie:function(n){throw new Error(n||"error: getOrDie called on none.")},getOrNull:n(null),getOrUndefined:n(void 0),or:b,orThunk:y,map:N,each:function(){},bind:N,exists:A,forall:C,filter:N,equals:N=function(n){return n.isNone()},equals_:N,toArray:function(){return[]},toString:n("none()")},N=function(t){return function(n){return typeof n===t}},T=N("boolean"),S=N("number"),V=Object.keys,B=("undefined"!=typeof window||Function("return this;")(),function(n){return n.dom.nodeValue}),E=t,L={" ":"nbsp","­":"shy"},N=function(n,t){var e="";return i(n,function(n,t){e+=t}),new RegExp("["+e+"]",t?"g":"")},j=N(L),x=N(L,!0),P=(w="",i(L,function(n){w&&(w+=","),w+="span.mce-"+n}),w),_="mce-nbsp",D=function(n,t){var e=[],n=function(n,t){for(var e=n.length,o=new Array(e),r=0;r<e;r++){var i=n[r];o[r]=t(i,r)}return o}(n.dom.childNodes,E);return r(n,function(n){e=(e=t(n)?e.concat([n]):e).concat(D(n,t))}),e},q=function(u,n){n=D(E(n),d);r(n,function(n){var t,e=n.dom.parentNode;if(m(e))t=E(e),e=_,s(t)?t.dom.classList.add(e):(r=r=e,r=a(t=t=t,"class").concat([r]),c(t,"class",r.join(" ")));else{for(var o,r=u.dom.encode(B(n)).replace(x,f),i=u.dom.create("div",null,r);o=i.lastChild;)u.dom.insertAfter(o,n.dom);u.dom.remove(n.dom)}})},I=function(o,n){n=o.dom.select(P,n);r(n,function(n){var t,e;m(n)?(e=E(n),t=_,s(e)?e.dom.classList.remove(t):l(e,t),0===(s(e=e)?e.dom.classList:a(e,"class")).length&&u(e,"class")):o.dom.remove(n,!0)})},M=tinymce.util.Tools.resolve("tinymce.util.Delay");k.add("visualchars",function(n){var t,e,o,r,i,u,c,a,s,l=(o=n.getParam("visualchars_default_state",!1),t=o,{get:function(){return t},set:function(n){t=n}});return h(n,l),(e=n).ui.registry.addToggleButton("visualchars",{tooltip:"Show invisible characters",icon:"visualchars",onAction:function(){return e.execCommand("mceVisualChars")},onSetup:p(e,o=l)}),e.ui.registry.addToggleMenuItem("visualchars",{text:"Show invisible characters",icon:"visualchars",onAction:function(){return e.execCommand("mceVisualChars")},onSetup:p(e,o)}),r=n,i=l,u=M.debounce(function(){v(r)},300),!1!==r.getParam("forced_root_block")&&r.on("keydown",function(n){!0===i.get()&&(13===n.keyCode?v(r):u())}),r.on("remove",u.stop),a=l,(c=n).on("init",function(){g(c,a)}),s=l,{isEnabled:function(){return s.get()}}})}();