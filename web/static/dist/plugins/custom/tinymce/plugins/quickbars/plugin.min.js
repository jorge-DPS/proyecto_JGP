!function(){"use strict";function e(u){u.ui.registry.addButton("quickimage",{icon:"image",tooltip:"Insert image",onAction:function(){var i=u;new o(function(n){var r=document.createElement("input");r.type="file",r.accept="image/*",r.style.position="fixed",r.style.left="0",r.style.top="0",r.style.opacity="0.001",document.body.appendChild(r),r.addEventListener("change",function(t){n(Array.prototype.slice.call(t.target.files))});var o=function(t){function e(){n([]),r.parentNode.removeChild(r)}a.os.isAndroid()&&"remove"!==t.type?l.setEditorTimeout(i,e,0):e(),i.off("focusin remove",o)};i.on("focusin remove",o),r.click()}).then(function(t){var i,n;0<t.length&&(i=t[0],n=i,new o(function(t){var e=new FileReader;e.onloadend=function(){t(e.result.split(",")[1])},e.readAsDataURL(n)}).then(function(t){var e,n,r,o;n=t,r=i,o=(e=u).editorUpload.blobCache,n=o.create((t=(new Date).getTime(),"mceu_"+Math.floor(1e9*Math.random())+ ++c+String(t)),r,n),o.add(n),e.insertContent(e.dom.createHTML("img",{src:n.blobUri()}))}))})}}),u.ui.registry.addButton("quicktable",{icon:"table",tooltip:"Insert table",onAction:function(){var t,e;(t=u).plugins.table?t.plugins.table.insertTable(2,2):(e=t).undoManager.transact(function(){e.insertContent(function(){var t,e,n='<table data-mce-id="mce" style="width: 100%">';for(n+="<tbody>",e=0;e<2;e++){for(n+="<tr>",t=0;t<2;t++)n+="<td><br></td>";n+="</tr>"}return(n+="</tbody>")+"</table>"}());var t=e.dom.select("*[data-mce-id]")[0];t.removeAttribute("data-mce-id");t=e.dom.select("td,th",t);e.selection.setCursorLocation(t[0],0)})}})}function i(t){return function(){return t}}function r(t){return void 0===t}var t=tinymce.util.Tools.resolve("tinymce.PluginManager"),c=0,o=tinymce.util.Tools.resolve("tinymce.util.Promise"),a=tinymce.util.Tools.resolve("tinymce.Env"),l=tinymce.util.Tools.resolve("tinymce.util.Delay"),u=i(!1),s=i(!0),n=function(){return f},f={fold:function(t,e){return t()},is:u,isSome:u,isNone:s,getOr:b=function(t){return t},getOrThunk:g=function(t){return t()},getOrDie:function(t){throw new Error(t||"error: getOrDie called on none.")},getOrNull:i(null),getOrUndefined:i(void 0),or:b,orThunk:g,map:n,each:function(){},bind:n,exists:u,forall:s,filter:n,equals:b=function(t){return t.isNone()},equals_:b,toArray:function(){return[]},toString:i("none()")},d=function(n){function t(){return o}function e(t){return t(n)}var r=i(n),o={fold:function(t,e){return e(n)},is:function(t){return n===t},isSome:s,isNone:u,getOr:r,getOrThunk:r,getOrDie:r,getOrNull:r,getOrUndefined:r,or:t,orThunk:t,map:function(t){return d(t(n))},each:function(t){t(n)},bind:e,exists:e,forall:e,filter:function(t){return t(n)?o:f},toArray:function(){return[n]},toString:function(){return"some("+n+")"},equals:function(t){return t.is(n)},equals_:function(t,e){return t.fold(u,function(t){return e(n,t)})}};return o},m={some:d,none:n,from:function(t){return null==t?f:d(t)}},g=function(n){return function(t){return t=typeof(e=t),(null===e?"null":"object"==t&&(Array.prototype.isPrototypeOf(e)||e.constructor&&"Array"===e.constructor.name)?"array":"object"==t&&(String.prototype.isPrototypeOf(e)||e.constructor&&"String"===e.constructor.name)?"string":t)===n;var e}},b=function(e){return function(t){return typeof t===e}},n=g("string"),p=g("object"),y=g("array"),h=b("boolean"),v=b("function");function k(t,e,n,r,o){return t(n,r)?m.some(n):v(o)&&o(n)?m.none():e(n,r,o)}function w(t){if(null==t)throw new Error("Node cannot be null or undefined");return{dom:t}}function T(t,e){if(1!==(t=t.dom).nodeType)return!1;if(void 0!==t.matches)return t.matches(e);if(void 0!==t.msMatchesSelector)return t.msMatchesSelector(e);if(void 0!==t.webkitMatchesSelector)return t.webkitMatchesSelector(e);if(void 0!==t.mozMatchesSelector)return t.mozMatchesSelector(e);throw new Error("Browser lacks native selectors")}function q(t,e,n){return C(t,function(t){return T(t,e)},n)}function S(o){var t=M(o,"quickbars_insert_toolbar","quickimage quicktable");0<t.trim().length&&o.ui.registry.addContextToolbar("quickblock",{predicate:function(t){function e(t){return t.dom===o.getBody()}var n=O(t),r=o.schema.getTextBlockElements();return k(T,q,n,"table",e).fold(function(){return k(function(t,e){return e(t)},C,n,function(t){return t.dom.nodeName.toLowerCase()in r&&o.dom.isEmpty(t.dom)},e).isSome()},function(){return!1})},items:t,position:"line",scope:"editor"})}function E(e){function n(t){return"IMG"===t.nodeName||"FIGURE"===t.nodeName&&/image/i.test(t.className)}var t=M(e,"quickbars_image_toolbar","alignleft aligncenter alignright");0<t.trim().length&&e.ui.registry.addContextToolbar("imageselection",{predicate:n,items:t,position:"node"}),0<(t=M(e,"quickbars_selection_toolbar","bold italic | quicklink h2 h3 blockquote")).trim().length&&e.ui.registry.addContextToolbar("textselection",{predicate:function(t){return!n(t)&&!e.selection.isCollapsed()&&"false"!==e.dom.getContentEditableParent(t)},items:t,position:"selection",scope:"editor"})}var N,O=w,C=("undefined"!=typeof window||Function("return this;")(),function(t,e,n){for(var r=t.dom,o=v(n)?n:u;r.parentNode;){var r=r.parentNode,i=O(r);if(e(i))return m.some(i);if(o(i))break}return m.none()}),M=(N=n,function(t,e,n){return function(){if(!N(n))throw new Error("Default value doesn't match requested type.")}(),function(t,e){if(y(t)||p(t))throw new Error("expected a string but found: "+t);return r(t)?e:h(t)?!1===t?"":e:t}(t.getParam(e,n),n)});t.add("quickbars",function(t){e(t),S(t),E(t)})}();