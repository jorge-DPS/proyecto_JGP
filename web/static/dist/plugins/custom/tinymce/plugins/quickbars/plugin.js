!function(){"use strict";function o(t,e,n){var o,r,i=t.editorUpload.blobCache,e=i.create((o="mceu",r=(new Date).getTime(),o+"_"+Math.floor(1e9*Math.random())+ ++u+String(r)),n,e);i.add(e),t.insertContent(t.dom.createHTML("img",{src:e.blobUri()}))}function e(u){u.ui.registry.addButton("quickimage",{icon:"image",tooltip:"Insert image",onAction:function(){var i;i=u,new r(function(n){var o=document.createElement("input");o.type="file",o.accept="image/*",o.style.position="fixed",o.style.left="0",o.style.top="0",o.style.opacity="0.001",document.body.appendChild(o);o.addEventListener("change",function(t){n(Array.prototype.slice.call(t.target.files))});var r=function(t){function e(){n([]),o.parentNode.removeChild(o)}c.os.isAndroid()&&"remove"!==t.type?a.setEditorTimeout(i,e,0):e(),i.off("focusin remove",r)};i.on("focusin remove",r),o.click()}).then(function(t){var e,n;0<t.length&&(e=t[0],n=e,new r(function(t){var e=new FileReader;e.onloadend=function(){t(e.result.split(",")[1])},e.readAsDataURL(n)}).then(function(t){o(u,t,e)}))})}}),u.ui.registry.addButton("quicktable",{icon:"table",tooltip:"Insert table",onAction:function(){var t,e,n,o,r,i;n=e=2,(t=u).plugins.table?t.plugins.table.insertTable(e,n):(r=e,i=n,(o=t).undoManager.transact(function(){o.insertContent(function(t,e){var n,o,r='<table data-mce-id="mce" style="width: 100%">';for(r+="<tbody>",o=0;o<e;o++){for(r+="<tr>",n=0;n<t;n++)r+="<td><br></td>";r+="</tr>"}return r+="</tbody>",r+="</table>"}(r,i));var t=o.dom.select("*[data-mce-id]")[0];t.removeAttribute("data-mce-id");t=o.dom.select("td,th",t);o.selection.setCursorLocation(t[0],0)}))}})}function i(t){return function(){return t}}var t=tinymce.util.Tools.resolve("tinymce.PluginManager"),u=0,r=tinymce.util.Tools.resolve("tinymce.util.Promise"),c=tinymce.util.Tools.resolve("tinymce.Env"),a=tinymce.util.Tools.resolve("tinymce.util.Delay"),l=i(!1),s=i(!0),n=function(){return f},f={fold:function(t,e){return t()},is:l,isSome:l,isNone:s,getOr:g,getOrThunk:m,getOrDie:function(t){throw new Error(t||"error: getOrDie called on none.")},getOrNull:i(null),getOrUndefined:i(void 0),or:g,orThunk:m,map:n,each:function(){},bind:n,exists:l,forall:s,filter:n,equals:d,equals_:d,toArray:function(){return[]},toString:i("none()")};function d(t){return t.isNone()}function m(t){return t()}function g(t){return t}function h(n){return function(t){return t=typeof(e=t),(null===e?"null":"object"==t&&(Array.prototype.isPrototypeOf(e)||e.constructor&&"Array"===e.constructor.name)?"array":"object"==t&&(String.prototype.isPrototypeOf(e)||e.constructor&&"String"===e.constructor.name)?"string":t)===n;var e}}function p(e){return function(t){return typeof t===e}}var b,y=function(n){function t(){return r}function e(t){return t(n)}var o=i(n),r={fold:function(t,e){return e(n)},is:function(t){return n===t},isSome:s,isNone:l,getOr:o,getOrThunk:o,getOrDie:o,getOrNull:o,getOrUndefined:o,or:t,orThunk:t,map:function(t){return y(t(n))},each:function(t){t(n)},bind:e,exists:e,forall:e,filter:function(t){return t(n)?r:f},toArray:function(){return[n]},toString:function(){return"some("+n+")"},equals:function(t){return t.is(n)},equals_:function(t,e){return t.fold(l,function(t){return e(n,t)})}};return r},v={some:y,none:n,from:function(t){return null==t?f:y(t)}},n=h("string"),k=h("object"),w=h("array"),T=p("boolean"),N=(b=void 0,function(t){return b===t}),q=p("function");function E(t,e,n,o,r){return t(n,o)?v.some(n):q(r)&&r(n)?v.none():e(n,o,r)}function M(t,e){if(1!==(t=t.dom).nodeType)return!1;if(void 0!==t.matches)return t.matches(e);if(void 0!==t.msMatchesSelector)return t.msMatchesSelector(e);if(void 0!==t.webkitMatchesSelector)return t.webkitMatchesSelector(e);if(void 0!==t.mozMatchesSelector)return t.mozMatchesSelector(e);throw new Error("Browser lacks native selectors")}function S(t,e,n){for(var o=t.dom,r=q(n)?n:l;o.parentNode;){var o=o.parentNode,i=_.fromDom(o);if(e(i))return v.some(i);if(r(i))break}return v.none()}function C(t,e,n){return S(t,function(t){return M(t,e)},n)}function O(r){var t=L(r,"quickbars_insert_toolbar","quickimage quicktable");0<t.trim().length&&r.ui.registry.addContextToolbar("quickblock",{predicate:function(t){function e(t){return t.dom===r.getBody()}var n=_.fromDom(t),o=r.schema.getTextBlockElements();return E(M,C,n,"table",e).fold(function(){return E(function(t,e){return e(t)},S,n,function(t){return t.dom.nodeName.toLowerCase()in o&&r.dom.isEmpty(t.dom)},e).isSome()},function(){return!1})},items:t,position:"line",scope:"editor"})}function x(e){function n(t){return"IMG"===t.nodeName||"FIGURE"===t.nodeName&&/image/i.test(t.className)}var t=L(e,"quickbars_image_toolbar","alignleft aligncenter alignright");0<t.trim().length&&e.ui.registry.addContextToolbar("imageselection",{predicate:n,items:t,position:"node"}),0<(t=L(e,"quickbars_selection_toolbar","bold italic | quicklink h2 h3 blockquote")).trim().length&&e.ui.registry.addContextToolbar("textselection",{predicate:function(t){return!n(t)&&!e.selection.isCollapsed()&&"false"!==e.dom.getContentEditableParent(t)},items:t,position:"selection",scope:"editor"})}var A,D=function(t){if(null==t)throw new Error("Node cannot be null or undefined");return{dom:t}},_={fromHtml:function(t,e){e=(e||document).createElement("div");if(e.innerHTML=t,!e.hasChildNodes()||1<e.childNodes.length)throw console.error("HTML does not have a single root node",t),new Error("HTML must have a single root node");return D(e.childNodes[0])},fromTag:function(t,e){t=(e||document).createElement(t);return D(t)},fromText:function(t,e){t=(e||document).createTextNode(t);return D(t)},fromDom:D,fromPoint:function(t,e,n){return v.from(t.dom.elementFromPoint(e,n)).map(D)}},L=("undefined"!=typeof window||Function("return this;")(),A=n,function(t,e,n){return function(t,e){if(e(t))return;throw new Error("Default value doesn't match requested type.")}(n,A),function(t,e){if(w(t)||k(t))throw new Error("expected a string but found: "+t);return N(t)?e:T(t)?!1===t?"":e:t}(t.getParam(e,n),n)});t.add("quickbars",function(t){e(t),O(t),x(t)})}();