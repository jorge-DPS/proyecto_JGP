!function(){"use strict";function p(e){return function(){return e}}var y=function(){},a=function(e){return e};function h(r){for(var o=[],e=1;e<arguments.length;e++)o[e-1]=arguments[e];return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var t=o.concat(e);return r.apply(null,t)}}function g(n){return function(e){return!n(e)}}function u(e){return void 0===e}function c(e){return!(null===e||void 0===e)}function x(e,n){return-1<j.call(e,n)}function v(e,n){for(var t=0,r=e.length;t<r;t++)if(n(e[t],t))return!0;return!1}function w(e,n){for(var t=[],r=0;r<e;r++)t.push(n(r));return t}function S(e,n){for(var t=e.length,r=new Array(t),o=0;o<t;o++){var u=e[o];r[o]=n(u,o)}return r}function C(e,n){for(var t=0,r=e.length;t<r;t++)n(e[t],t)}function T(e,n){for(var t=[],r=0,o=e.length;r<o;r++){var u=e[r];n(u,r)&&t.push(u)}return t}function s(e,r,o){return function(e){for(var n,t=e.length-1;0<=t;t--)n=e[t],o=r(o,n)}(e),o}function b(e,n,t){return C(e,function(e){t=n(t,e)}),t}function f(e,n){return function(e,n,t){for(var r=0,o=e.length;r<o;r++){var u=e[r];if(n(u,r))return I.some(u);if(t(u,r))break}return I.none()}(e,n,A)}function d(e,n){for(var t=0,r=e.length;t<r;t++)if(n(e[t],t))return I.some(t);return I.none()}function i(e){for(var n=[],t=0,r=e.length;t<r;++t){if(!N(e[t]))throw new Error("Arr.flatten item "+t+" was not an array, input: "+e);F.apply(n,e[t])}return n}function R(e,n){return i(S(e,n))}function O(e,n){for(var t=0,r=e.length;t<r;++t)if(!0!==n(e[t],t))return!1;return!0}function n(e){return[e]}function l(e,n){return 0<=n&&n<e.length?I.some(e[n]):I.none()}function m(e){return l(e,e.length-1)}function D(e,n){for(var t=0;t<e.length;t++){var r=n(e[t],t);if(r.isSome())return r}return I.none()}var A=p(!1),B=p(!0),e=function(){return E},E={fold:function(e,n){return e()},is:A,isSome:A,isNone:B,getOr:on=function(e){return e},getOrThunk:fn=function(e){return e()},getOrDie:function(e){throw new Error(e||"error: getOrDie called on none.")},getOrNull:p(null),getOrUndefined:p(void 0),or:on,orThunk:fn,map:e,each:y,bind:e,exists:A,forall:B,filter:e,equals:mr=function(e){return e.isNone()},equals_:mr,toArray:function(){return[]},toString:p("none()")},P=function(t){function e(){return o}function n(e){return e(t)}var r=p(t),o={fold:function(e,n){return n(t)},is:function(e){return t===e},isSome:B,isNone:A,getOr:r,getOrThunk:r,getOrDie:r,getOrNull:r,getOrUndefined:r,or:e,orThunk:e,map:function(e){return P(e(t))},each:function(e){e(t)},bind:n,exists:n,forall:n,filter:function(e){return e(t)?o:E},toArray:function(){return[t]},toString:function(){return"some("+t+")"},equals:function(e){return e.is(t)},equals_:function(e,n){return e.fold(A,function(e){return n(t,e)})}};return o},I={some:P,none:e,from:function(e){return null==e?E:P(e)}},t=function(t){return function(e){return e=typeof(n=e),(null===n?"null":"object"==e&&(Array.prototype.isPrototypeOf(n)||n.constructor&&"Array"===n.constructor.name)?"array":"object"==e&&(String.prototype.isPrototypeOf(n)||n.constructor&&"String"===n.constructor.name)?"string":e)===t;var n}},r=function(n){return function(e){return typeof e===n}},M=t("string"),k=t("object"),N=t("array"),o=r("boolean"),_=r("function"),z=r("number"),W=Array.prototype.slice,j=Array.prototype.indexOf,F=Array.prototype.push,L=function(){return(L=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var o in n=arguments[t])Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o]);return e}).apply(this,arguments)};function H(){for(var e=0,n=0,t=arguments.length;n<t;n++)e+=arguments[n].length;for(var r=Array(e),o=0,n=0;n<t;n++)for(var u=arguments[n],i=0,c=u.length;i<c;i++,o++)r[o]=u[i];return r}function q(t){var r,o=!1;return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return o||(o=!0,r=t.apply(null,e)),r}}function V(){return Be(0,0)}function U(e,n){var t=String(n).toLowerCase();return f(e,function(e){return e.search(t)})}function $(e,n,t){return""===n||e.length>=n.length&&e.substr(t,t+n.length)===n}function G(e,n){return-1!==e.indexOf(n)}function K(e,n){return $(e,n,0)}function X(e,n){return $(e,n,e.length-n.length)}function Y(e){return 0<e.length}function J(e){var n=e.current,t=e.version;return{current:n,version:t,isEdge:(e=function(e){return function(){return n===e}})("Edge"),isChrome:e("Chrome"),isIE:e("IE"),isOpera:e("Opera"),isFirefox:e(We),isSafari:e("Safari")}}function Q(e){var n=e.current,t=e.version;return{current:n,version:t,isWindows:(e=function(e){return function(){return n===e}})(Le),isiOS:e("iOS"),isAndroid:e(He),isOSX:e("OSX"),isLinux:e("Linux"),isSolaris:e(qe),isFreeBSD:e(Ve),isChromeOS:e(Ue)}}function Z(e,n){var t,r,o,u,i=ze.browsers(),c=ze.oses(),l=U(i,u=e).map(function(e){var n=Ee(e.versionRegexes,u);return{current:e.name,version:n}}).fold(je,Fe),a=U(c,o=e).map(function(e){var n=Ee(e.versionRegexes,o);return{current:e.name,version:n}}).fold($e,Ge);return{browser:l,os:a,deviceType:(t=l,r=e,i=n,l=(c=a).isiOS()&&!0===/ipad/i.test(r),e=c.isiOS()&&!l,a=(n=c.isiOS()||c.isAndroid())||i("(pointer:coarse)"),i=l||!e&&n&&i("(min-device-width:768px)"),n=e||n&&!i,r=t.isSafari()&&c.isiOS()&&!1===/safari/i.test(r),{isiPad:p(l),isiPhone:p(e),isTablet:p(i),isPhone:p(n),isTouch:p(a),isAndroid:c.isAndroid,isiOS:c.isiOS,isWebView:p(r),isDesktop:p(!n&&!i&&!r)})}}function ee(e){return window.matchMedia(e).matches}function ne(e){if(null==e)throw new Error("Node cannot be null or undefined");return{dom:e}}function te(e,n){if(1!==(e=e.dom).nodeType)return!1;if(void 0!==e.matches)return e.matches(n);if(void 0!==e.msMatchesSelector)return e.msMatchesSelector(n);if(void 0!==e.webkitMatchesSelector)return e.webkitMatchesSelector(n);if(void 0!==e.mozMatchesSelector)return e.mozMatchesSelector(n);throw new Error("Browser lacks native selectors")}function re(e){return 1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType||0===e.childElementCount}function oe(e,n){return Ke().browser.isIE()?(r=n,o=(t=e).dom,t=n.dom,r=Node.DOCUMENT_POSITION_CONTAINED_BY,0!=(o.compareDocumentPosition(t)&r)):(e=e.dom)!==(n=n.dom)&&e.contains(n);var t,r,o}function ue(e,n){for(var t=Qe(e),r=0,o=t.length;r<o;r++){var u=t[r];n(e[u],u)}}function ie(e,t){return en(e,function(e,n){return{k:n,v:t(e,n)}})}function ce(e,n){var t={},r=n,o=t,u=function(e,n){o[n]=e},i=y;return ue(e,function(e,n){(r(e,n)?u:i)(e,n)}),t}function le(e,n){return nn(e,n)?I.from(e[n]):I.none()}function ae(e,n,t){return{element:e,rowspan:n,colspan:t}}function fe(e,n,t){return{element:e,cells:n,section:t}}function se(e,n){return{element:e,isNew:n}}function de(e,n){return{cells:e,section:n}}function me(e){return e.dom.nodeType}function pe(e){return 8===me(e)||"#comment"===rn(e)}function ge(e){return Xe.fromDom(e.dom.ownerDocument)}function he(e){return ln(e)?e:ge(e)}function be(e){return I.from(e.dom.parentNode).map(Xe.fromDom)}function ve(e,n){for(var t=_(n)?n:A,r=e.dom,o=[];null!==r.parentNode&&void 0!==r.parentNode;){var u=r.parentNode,i=Xe.fromDom(u);if(o.push(i),!0===t(i))break;r=u}return o}function we(e){return I.from(e.dom.previousSibling).map(Xe.fromDom)}function ye(e){return I.from(e.dom.nextSibling).map(Xe.fromDom)}function xe(e){return S(e.dom.childNodes,Xe.fromDom)}function Se(e,n){return e=e.dom.childNodes,I.from(e[n]).map(Xe.fromDom)}function Ce(e){return Xe.fromDom(e.dom.host)}function Te(e){if(null==(e=e.dom.body))throw new Error("Body is not available yet");return Xe.fromDom(e)}function Re(e,n,t){return r=function(e){return te(e,n)},T(ve(e,t),r);var r}function Oe(e,n){return t=function(e){return te(e,n)},T(xe(e),t);var t}function De(e,n){return e=void 0===e?document:e.dom,re(e)?[]:S(e.querySelectorAll(n),Xe.fromDom)}var Ae,Be=function(e,n){return{major:e,minor:n}},Ee=function(e,n){n=String(n).toLowerCase();return 0===e.length?V():function(e,n){var t=function(e,n){for(var t=0;t<e.length;t++){var r=e[t];if(r.test(n))return r}}(e,n);if(!t)return{major:0,minor:0};e=function(e){return Number(n.replace(t,"$"+e))};return Be(e(1),e(2))}(e,n)},Pe=V,Ie=(Ae=/^\s+|\s+$/g,function(e){return e.replace(Ae,"")}),Me=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,ke=function(n){return function(e){return G(e,n)}},Ne=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(e){return G(e,"edge/")&&G(e,"chrome")&&G(e,"safari")&&G(e,"applewebkit")}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,Me],search:function(e){return G(e,"chrome")&&!G(e,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(e){return G(e,"msie")||G(e,"trident")}},{name:"Opera",versionRegexes:[Me,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:ke("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:ke("firefox")},{name:"Safari",versionRegexes:[Me,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(e){return(G(e,"safari")||G(e,"mobile/"))&&G(e,"applewebkit")}}],_e=[{name:"Windows",search:ke("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(e){return G(e,"iphone")||G(e,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:ke("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:ke("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:ke("linux"),versionRegexes:[]},{name:"Solaris",search:ke("sunos"),versionRegexes:[]},{name:"FreeBSD",search:ke("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:ke("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],ze={browsers:p(Ne),oses:p(_e)},We="Firefox",je=function(){return J({current:void 0,version:Pe()})},Fe=J,Le=(p("Edge"),p("Chrome"),p("IE"),p("Opera"),p(We),p("Safari"),"Windows"),He="Android",qe="Solaris",Ve="FreeBSD",Ue="ChromeOS",$e=function(){return Q({current:void 0,version:Pe()})},Ge=Q,Ke=(p(Le),p("iOS"),p(He),p("Linux"),p("OSX"),p(qe),p(Ve),p(Ue),q(function(){return Z(navigator.userAgent,ee)})),Xe={fromHtml:function(e,n){n=(n||document).createElement("div");if(n.innerHTML=e,!n.hasChildNodes()||1<n.childNodes.length)throw console.error("HTML does not have a single root node",e),new Error("HTML must have a single root node");return ne(n.childNodes[0])},fromTag:function(e,n){e=(n||document).createElement(e);return ne(e)},fromText:function(e,n){e=(n||document).createTextNode(e);return ne(e)},fromDom:ne,fromPoint:function(e,n,t){return I.from(e.dom.elementFromPoint(n,t)).map(ne)}},Ye=function(e,n){return e.dom===n.dom},Je=te,Qe=Object.keys,Ze=Object.hasOwnProperty,en=function(e,t){var r={};return ue(e,function(e,n){n=t(e,n);r[n.k]=n.v}),r},nn=function(e,n){return Ze.call(e,n)},tn=["tfoot","thead","tbody","colgroup"],rn=("undefined"!=typeof window||Function("return this;")(),function(e){return e.dom.nodeName.toLowerCase()}),on=function(n){return function(e){return me(e)===n}},un=on(1),cn=on(3),ln=on(9),an=on(11),fn=_(Element.prototype.attachShadow)&&_(Node.prototype.getRootNode),sn=p(fn),dn=fn?function(e){return Xe.fromDom(e.dom.getRootNode())}:he,mn=function(e){return c(e.dom.shadowRoot)},pn=function(e){var n=cn(e)?e.dom.parentNode:e.dom;if(null==n||null===n.ownerDocument)return!1;var t,r,o=n.ownerDocument;return function(e){e=dn(e);return an(e)?I.some(e):I.none()}(Xe.fromDom(n)).fold(function(){return o.body.contains(n)},(t=pn,r=Ce,function(e){return t(r(e))}))},gn=function(e,n){var t=[];return C(xe(e),function(e){t=(t=n(e)?t.concat([e]):t).concat(gn(e,n))}),t};function hn(e,n,t,r,o){return e(t,r)?I.some(t):_(o)&&o(t)?I.none():n(t,r,o)}function bn(e,n,t){for(var r=e.dom,o=_(t)?t:A;r.parentNode;){var r=r.parentNode,u=Xe.fromDom(r);if(n(u))return I.some(u);if(o(u))break}return I.none()}function vn(e,n,t){return bn(e,function(e){return te(e,n)},t)}function wn(e,n){return t=function(e){return te(e,n)},f(e.dom.childNodes,function(e){return t(Xe.fromDom(e))}).map(Xe.fromDom);var t}function yn(e,n){return n=n,e=void 0===e?document:e.dom,re(e)?I.none():I.from(e.querySelector(n)).map(Xe.fromDom)}function xn(e,n,t){return hn(te,vn,e,n,t)}function Sn(e,n,t){if(!(M(t)||o(t)||z(t)))throw console.error("Invalid call to Attribute.set. Key ",n,":: Value ",t,":: Element ",e),new Error("Attribute value was not simple");e.setAttribute(n,t+"")}function Cn(e,n,t){Sn(e.dom,n,t)}function Tn(e,n){var t=e.dom;ue(n,function(e,n){Sn(t,n,e)})}function Rn(e,n){return null===(n=e.dom.getAttribute(n))?void 0:n}function On(e,n){return I.from(Rn(e,n))}function Dn(e,n){e.dom.removeAttribute(n)}function An(e){return b(e.dom.attributes,function(e,n){return e[n.name]=n.value,e},{})}function Bn(e){return void 0!==e.style&&_(e.style.getPropertyValue)}function En(e,n,t){if(!M(t))throw console.error("Invalid call to CSS.set. Property ",n,":: Value ",t,":: Element ",e),new Error("CSS value must be a string: "+t);Bn(e)&&e.style.setProperty(n,t)}function Pn(e,n,t){e=e.dom,En(e,n,t)}function In(e,n){var t=e.dom;ue(n,function(e,n){En(t,n,e)})}function Mn(e,n){var t=e.dom,r=window.getComputedStyle(t).getPropertyValue(n);return""!==r||pn(e)?r:gt(t,n)}function kn(e,n){return e=e.dom,n=gt(e,n),I.from(n).filter(function(e){return 0<e.length})}function Nn(e,n){var t=e.dom,n=n;Bn(t=t)&&t.style.removeProperty(n),On(e,"style").map(Ie).is("")&&Dn(e,"style")}function _n(e,n,t){return void 0===t&&(t=0),On(e,n).map(function(e){return parseInt(e,10)}).getOr(t)}function zn(e,n){return _n(e,n,1)}function Wn(e){return 1<zn(e,"colspan")}function jn(e){return 1<zn(e,"rowspan")}function Fn(e,n){return parseInt(Mn(e,n),10)}function Ln(e,n){return vt(e,n,B)}function Hn(e,n){return t=["td","th"],(r=void 0===(r=n)?A:n)(e=e)?I.none():x(t,rn(e))?I.some(e):vn(e,t.join(","),function(e){return te(e,"table")||r(e)});var t,r}function qn(e){return Ln(e,"th,td")}function Vn(e){return te(e,"colgroup")?Oe(e,"col"):R(yt(e),function(e){return Oe(e,"col")})}function Un(e){return Ln(e,"tr")}function $n(e,t){return S(e,function(e){if("colgroup"!==rn(e))return n=S(qn(e),function(e){var n=_n(e,"rowspan",1),t=_n(e,"colspan",1);return ae(e,n,t)}),fe(e,n,t(e));var n=S(Vn(e),function(e){var n=_n(e,"span",1);return ae(e,1,n)});return fe(e,n,"colgroup")})}function Gn(e){return be(e).map(function(e){e=rn(e);return x(tn,e)?e:"tbody"}).getOr("tbody")}function Kn(e){var n=Un(e),n=H(yt(e),n);return $n(n,Gn)}function Xn(e,n){return e=R(e.all,function(e){return e.cells}),T(e,n)}function Yn(e){var c={},n=[],t={},u=0,l=0,a=0;return C(e,function(e){var i,r,o;"colgroup"===e.section?(r={},o=0,C(e.cells,function(n){var t=n.colspan;w(t,function(e){e=o+e;r[e]={element:n.element,colspan:t,column:e}}),o+=t}),t=r):(i=[],C(e.cells,function(e){for(var n=0;void 0!==c[a+","+n];)n++;for(var t={element:e.element,rowspan:e.rowspan,colspan:e.colspan,row:a,column:n},r=0;r<e.colspan;r++)for(var o=0;o<e.rowspan;o++){var u=n+r;c[a+o+","+u]=t,l=Math.max(l,u+1)}i.push(t)}),u++,n.push(fe(e.element,i,e.section)),a++)}),{grid:{rows:u,columns:l},access:c,all:n,columns:t}}function Jn(e,n){var t=n.column,r=n.column+n.colspan-1,o=n.row,n=n.row+n.rowspan-1;return t<=e.finishCol&&r>=e.startCol&&o<=e.finishRow&&n>=e.startRow}function Qn(e,n){return n.column>=e.startCol&&n.column+n.colspan-1<=e.finishCol&&n.row>=e.startRow&&n.row+n.rowspan-1<=e.finishRow}function Zn(e,n,t){var n=Tt(e,n,Ye),r=Tt(e,t,Ye);return n.bind(function(t){return r.map(function(e){return n=t,e=e,{startRow:Math.min(n.row,e.row),startCol:Math.min(n.column,e.column),finishRow:Math.max(n.row+n.rowspan-1,e.row+e.rowspan-1),finishCol:Math.max(n.column+n.colspan-1,e.column+e.colspan-1)};var n})})}function et(n,e,t){return Zn(n,e,t).map(function(e){e=Rt(n,h(Jn,e));return S(e,function(e){return e.element})})}function nt(e,n){return Tt(e,n,function(e,n){return oe(n,e)}).map(function(e){return e.element})}function tt(e,n,t,r,o){var u=Et(e),n=Ye(e,t)?I.some(n):nt(u,n),i=Ye(e,o)?I.some(r):nt(u,r);return n.bind(function(n){return i.bind(function(e){return et(u,n,e)})})}function rt(n,t){be(n).each(function(e){e.dom.insertBefore(t.dom,n.dom)})}function ot(e,n){ye(e).fold(function(){be(e).each(function(e){It(e,n)})},function(e){rt(e,n)})}function ut(e,n){rt(e,n),It(n,e)}function it(t,r){C(r,function(e,n){n=0===n?t:r[n-1];ot(n,e)})}function ct(n,e){C(e,function(e){It(n,e)})}function lt(e){e.dom.textContent="",C(xe(e),function(e){Mt(e)})}function at(e){var n,t=xe(e);0<t.length&&(n=e,C(t,function(e){rt(n,e)})),Mt(e)}function ft(e){return kt.get(e)}function st(e){return kt.getOption(e)}function dt(e,n){return kt.set(e,n)}var mt,pt,gt=function(e,n){return Bn(e)?e.style.getPropertyValue(n):""},ht=p(10),bt=p(10),vt=function(e,n,t){return R(xe(e),function(e){return te(e,n)?t(e)?[e]:[]:vt(e,n,t)})},wt=function(e,n){return xn(e,"table",n)},yt=function(e){return wt(e).fold(p([]),function(e){return Oe(e,"colgroup")})},xt=function(e){e=Kn(e);return Yn(e)},St=Yn,Ct=function(e,n,t){t=e.access[n+","+t];return void 0!==t?I.some(t):I.none()},Tt=function(e,n,t){e=Xn(e,function(e){return t(n,e.element)});return 0<e.length?I.some(e[0]):I.none()},Rt=Xn,Ot=function(e){return R(e.all,function(e){return e.cells})},Dt=function(e){return e=e.columns,t=[],ue(e,function(e,n){t.push(e)}),t;var t},At=function(e){return 0<Qe(e.columns).length},Bt=function(e,n){return I.from(e.columns[n])},Et=xt,Pt=function(n,t){Se(n,0).fold(function(){It(n,t)},function(e){n.dom.insertBefore(t.dom,e.dom)})},It=function(e,n){e.dom.appendChild(n.dom)},Mt=function(e){e=e.dom;null!==e.parentNode&&e.parentNode.removeChild(e)},kt=(mt=cn,{get:function(e){if(!mt(e))throw new Error("Can only get text value of a text node");return pt(e).getOr("")},getOption:pt=function(e){return mt(e)?I.from(e.dom.nodeValue):I.none()},set:function(e,n){if(!mt(e))throw new Error("Can only set raw text value of a text node");e.dom.nodeValue=n}}),Nt=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","li","table","thead","tbody","tfoot","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"];function _t(){return{up:p({selector:vn,closest:xn,predicate:bn,all:ve}),down:p({selector:De,predicate:gn}),styles:p({get:Mn,getRaw:kn,set:Pn,remove:Nn}),attrs:p({get:Rn,set:Cn,remove:Dn,copyTo:function(e,n){e=An(e);Tn(n,e)}}),insert:p({before:rt,after:ot,afterAll:it,append:It,appendAll:ct,prepend:Pt,wrap:ut}),remove:p({unwrap:at,remove:Mt}),create:p({nu:Xe.fromTag,clone:function(e){return Xe.fromDom(e.dom.cloneNode(!1))},text:Xe.fromText}),query:p({comparePosition:function(e,n){return e.dom.compareDocumentPosition(n.dom)},prevSibling:we,nextSibling:ye}),property:p({children:xe,name:rn,parent:be,document:function(e){return he(e).dom},isText:cn,isComment:pe,isElement:un,getText:ft,setText:dt,isBoundary:function(e){return!!un(e)&&("body"===rn(e)||x(Nt,rn(e)))},isEmptyTag:function(e){return!!un(e)&&x(["br","img","hr","input"],rn(e))},isNonEditable:function(e){return un(e)&&"false"===Rn(e,"contenteditable")}}),eq:Ye,is:Je}}function zt(e,n,t){return 0<t.length?function(t,r,e,n){e=r(t,e);return s(n,function(e,n){n=r(t,n);return ar(t,e,n)},e)}(e,n,t[0],t.slice(1)):I.none()}function Wt(e){return vn(e,"table")}function jt(i,c,l){function a(n){return function(e){return void 0!==l&&l(e)||Ye(e,n)}}return Ye(i,c)?I.some({boxes:I.some([i]),start:i,finish:c}):Wt(i).bind(function(u){return Wt(c).bind(function(r){if(Ye(u,r))return I.some({boxes:(n=i,t=c,o=Et(u),et(o,n,t)),start:i,finish:c});if(oe(u,r)){t=0<(e=Re(c,"td,th",a(u))).length?e[e.length-1]:c;return I.some({boxes:tt(u,i,u,c,r),start:i,finish:t})}if(oe(r,u)){var e=0<(e=Re(i,"td,th",a(r))).length?e[e.length-1]:i;return I.some({boxes:tt(r,i,u,c,r),start:i,finish:e})}return function(n,e,t,r){void 0===r&&(r=A);var o=[e].concat(n.up().all(e)),e=[t].concat(n.up().all(t)),t=function(n){return d(n,r).fold(function(){return n},function(e){return n.slice(0,e+1)})},o=t(o),u=t(e),e=f(o,function(e){return v(u,h(n.eq,e))});return{firstpath:o,secondpath:u,shared:e}}(fr,i,c,void 0).shared.bind(function(e){return xn(e,"table",l).bind(function(e){var n=Re(c,"td,th",a(e)),t=0<n.length?n[n.length-1]:c,n=Re(i,"td,th",a(e)),n=0<n.length?n[n.length-1]:i;return I.some({boxes:tt(e,i,u,c,r),start:n,finish:t})})});var n,t,o})})}function Ft(e,n){return 0<(n=De(e,n)).length?I.some(n):I.none()}function Lt(e,n,r){return yn(e,n).bind(function(t){return yn(e,r).bind(function(n){return sr(Wt,[t,n]).map(function(e){return{first:t,last:n,table:e}})})})}function Ht(e,t,r,o,n){return u=n,f(e,function(e){return te(e,u)}).bind(function(e){return u=t,i=r,wt(n=e).bind(function(e){var t=Et(e),r=u,o=i;return Tt(t,n,Ye).bind(function(e){var n=0<r?e.row+e.rowspan-1:e.row,e=0<o?e.column+e.colspan-1:e.column;return Ct(t,n+r,e+o).map(function(e){return e.element})})}).bind(function(e){return t=o,vn(n=e,"table").bind(function(e){return yn(e,t).bind(function(e){return jt(e,n).bind(function(n){return n.boxes.map(function(e){return{boxes:e,start:n.start,finish:n.finish}})})})});var n,t});var n,u,i});var u}function qt(o,e,n){return Lt(o,e,n).bind(function(u){function e(e){return Ye(o,e)}var n="thead,tfoot,tbody,table",t=vn(u.first,n,e),r=vn(u.last,n,e);return t.bind(function(o){return r.bind(function(e){return Ye(o,e)?(r=u.table,t=u.first,e=u.last,r=Et(r),Zn(n=r,t,e).bind(function(e){return function(e,n){for(var t=!0,r=h(Qn,n),o=n.startRow;o<=n.finishRow;o++)for(var u=n.startCol;u<=n.finishCol;u++)t=t&&Ct(e,o,u).exists(r);return t?I.some(n):I.none()}(n,e)})):I.none();var n,t,r})})})}function Vt(e,n,t,r){return e.fold(n,t,r)}function Ut(e,n){var o,u,i,c,l,t=function(e){return te(e.element,n)},r=Kn(e),a=St(r),f=(o=t,d=a.grid.columns,u=a.grid.rows,i=d,l=c=0,ue(a.access,function(e){var n,t,r;o(e)&&(t=(n=e.row)+e.rowspan-1,e=(r=e.column)+e.colspan-1,n<u?u=n:c<t&&(c=t),r<i?i=r:l<e&&(l=e))}),{minRow:u,minCol:i,maxRow:c,maxCol:l}),s="th:not("+n+"),td:not("+n+")",d=vt(e,"th,td",function(e){return te(e,s)});return C(d,Mt),function(e,n,t,r){for(var o,u,i,c=n.grid.columns,l=n.grid.rows,a=0;a<l;a++)for(var f=!1,s=0;s<c;s++)a<t.minRow||a>t.maxRow||s<t.minCol||s>t.maxCol||(Ct(n,a,s).filter(r).isNone()?(o=f,u=e[a].element,i=Xe.fromTag("td"),It(i,Xe.fromTag("br")),(o?It:Pt)(u,i)):f=!0)}(r,a,f,t),a=f,f=T(Ln(t=e,"tr"),function(e){return 0===e.dom.childElementCount}),C(f,Mt),a.minCol!==a.maxCol&&a.minRow!==a.maxRow||C(Ln(t,"th,td"),function(e){Dn(e,"rowspan"),Dn(e,"colspan")}),Dn(t,"width"),Dn(t,"height"),Nn(t,"width"),Nn(t,"height"),e}function $t(e){return"img"===rn(e)?1:st(e).fold(function(){return xe(e).length},function(e){return e.length})}function Gt(e){return st(e).filter(function(e){return 0!==e.trim().length||-1<e.indexOf("Â ")}).isSome()||x(br,rn(e))}function Kt(e,n){return Xe.fromDom(e.dom.cloneNode(n))}function Xt(e){return Kt(e,!1)}function Yt(e){return Kt(e,!0)}function Jt(){var e=Xe.fromTag("td");return It(e,Xe.fromTag("br")),e}function Qt(){return Xe.fromTag("col")}function Zt(){return Xe.fromTag("colgroup")}function er(e,n,t){var r,o=(r=n,e=n=e,r=Xe.fromTag(r),e=An(e),Tn(r,e),r,n=xe(Yt(n)),ct(r,n),r);return ue(t,function(e,n){null===e?Dn(o,n):Cn(o,n,e)}),o}function nr(e){return e}function tr(e){return function(){return Xe.fromTag("tr",e.dom)}}function rr(e){return{col:Qt,colgroup:Zt,row:tr(e),cell:Jt,replace:nr,gap:Jt}}function or(e){return S(e,Xe.fromDom)}function ur(e){return Vt(e.get(),p([]),a,n)}function ir(e){return{element:e,mergable:I.none(),unmergable:I.none(),selection:[e]}}function cr(e,n,t){return{element:t,mergable:(o=n,u=Cr,Vt(e.get(),I.none,function(n){return n.length<=1?I.none():qt(o,u.firstSelectedSelector,u.lastSelectedSelector).map(function(e){return{bounds:e,cells:n}})},I.none)),unmergable:(r=function(e,n){return On(e,n).exists(function(e){return 1<parseInt(e,10)})},0<(n=ur(e)).length&&O(n,function(e){return r(e,"rowspan")||r(e,"colspan")})?I.some(n):I.none()),selection:ur(e)};var r,o,u}function lr(e){for(var n=[],t=function(e){n.push(e)},r=0;r<e.length;r++)e[r].each(t);return n}var ar=function(n,e,t){return e.bind(function(e){return t.filter(h(n.eq,e))})},fr=_t(),sr=function(t,e){return zt(fr,function(e,n){return t(n)},e)},dr=Ft,mr=function(i){if(!N(i))throw new Error("cases must be an array");if(0===i.length)throw new Error("there must be at least one case");var c=[],t={};return C(i,function(e,r){var n=Qe(e);if(1!==n.length)throw new Error("one and only one name per case");var o=n[0],u=e[o];if(void 0!==t[o])throw new Error("duplicate key detected:"+o);if("cata"===o)throw new Error("cannot have a case named cata (sorry)");if(!N(u))throw new Error("case arguments must be an array");c.push(o),t[o]=function(){var e=arguments.length;if(e!==u.length)throw new Error("Wrong number of arguments to case "+o+". Expected "+u.length+" ("+u+"), got "+e);for(var t=new Array(e),n=0;n<t.length;n++)t[n]=arguments[n];return{fold:function(){if(arguments.length!==i.length)throw new Error("Wrong number of arguments to fold. Expected "+i.length+", got "+arguments.length);return arguments[r].apply(null,t)},match:function(e){var n=Qe(e);if(c.length!==n.length)throw new Error("Wrong number of arguments to match. Expected: "+c.join(",")+"\nActual: "+n.join(","));if(!O(c,function(e){return x(n,e)}))throw new Error("Not all branches were specified when using match. Specified: "+n.join(", ")+"\nRequired: "+c.join(", "));return e[o].apply(null,t)},log:function(e){console.log(e,{constructors:c,constructor:o,params:t})}}}}),t},e=mr([{none:[]},{multiple:["elements"]},{single:["element"]}]),pr=e.none,gr=e.multiple,hr=e.single,t=tinymce.util.Tools.resolve("tinymce.PluginManager"),br=["img","br"],vr=function(e){return r=Gt,(o=function(e){for(var n=0;n<e.childNodes.length;n++){var t=Xe.fromDom(e.childNodes[n]);if(r(t))return I.some(t);t=o(e.childNodes[n]);if(t.isSome())return t}return I.none()})(e.dom);var r,o},wr=function(e){return yr(e,Gt)},yr=function(e,o){var u=function(e){for(var n=xe(e),t=n.length-1;0<=t;t--){var r=n[t];if(o(r))return I.some(r);r=u(r);if(r.isSome())return r}return I.none()};return u(e)},xr={scope:["row","col"]},Sr=function(l,e,a){function f(e,n){var t=e.element.dom,r=n.dom;Bn(t)&&Bn(r)&&(r.style.cssText=t.style.cssText),Nn(n,"height"),1!==e.colspan&&Nn(e.element,"width")}return{col:function(e){var n=ge(e.element),n=Xe.fromTag(rn(e.element),n.dom);return f(e,n),l(e.element,n),n},colgroup:Zt,row:tr(e),cell:function(e){var t,r,o,u,i,n=ge(e.element),c=Xe.fromTag(rn(e.element),n.dom),n=a.getOr(["strong","em","b","i","span","font","h1","h2","h3","h4","h5","h6","p","div"]),n=0<n.length?(t=e.element,r=c,o=n,vr(t).map(function(e){var n=o.join(","),n=Re(e,n,function(e){return Ye(e,t)});return s(n,function(e,n){n=Xt(n);return Dn(n,"contenteditable"),It(e,n),n},r)}).getOr(r)):c;return It(n,Xe.fromTag("br")),f(e,c),u=e.element,i=c,ue(xr,function(n,t){return On(u,t).filter(function(e){return x(n,e)}).each(function(e){return Cn(i,t,e)})}),l(e.element,c),c},replace:er,gap:Jt}},Cr={selected:"data-mce-selected",selectedSelector:"td[data-mce-selected],th[data-mce-selected]",firstSelected:"data-mce-first-selected",firstSelectedSelector:"td[data-mce-first-selected],th[data-mce-first-selected]",lastSelected:"data-mce-last-selected",lastSelectedSelector:"td[data-mce-last-selected],th[data-mce-last-selected]"},r=mr([{none:[]},{only:["index"]},{left:["index","next"]},{middle:["prev","index","next"]},{right:["prev","index"]}]),Tr=L({},r);function Rr(t,r){function e(e){var n=r(e);if(n<=0||null===n){e=Mn(e,t);return parseFloat(e)||0}return n}function o(t,e){return b(e,function(e,n){n=Mn(t,n),n=void 0===n?0:parseInt(n,10);return isNaN(n)?e:e+n},0)}return{set:function(e,n){if(!z(n)&&!n.match(/^[0-9]+$/))throw new Error(t+".set accepts only positive integer values. Value was "+n);e=e.dom;Bn(e)&&(e.style[t]=n+"px")},get:e,getOuter:e,aggregate:o,max:function(e,n,t){t=o(e,t);return t<n?n-t:0}}}function Or(e){return Mo.get(e)}function Dr(e){return Mo.getOuter(e)}function Ar(t){var e=t.grid,n=w(e.columns,a),r=w(e.rows,a);return S(n,function(n){return ko(function(){return R(r,function(e){return Ct(t,e,n).filter(function(e){return e.column===n}).toArray()})},function(e){return 1===e.colspan},function(){return Ct(t,0,n)})})}function Br(t){var e=t.grid,n=w(e.rows,a),r=w(e.columns,a);return S(n,function(n){return ko(function(){return R(r,function(e){return Ct(t,n,e).filter(function(e){return e.row===n}).fold(p([]),function(e){return[e]})})},function(e){return 1===e.rowspan},function(){return Ct(t,n,0)})})}function Er(e){return zo.get(e)}function Pr(e){return zo.getOuter(e)}function Ir(e,n){return void 0!==e?e:void 0!==n?n:0}function Mr(e){var n=(u=e.dom.ownerDocument).body,t=u.defaultView,r=u.documentElement;if(n===e.dom)return jo(n.offsetLeft,n.offsetTop);var o=Ir(null==t?void 0:t.pageYOffset,r.scrollTop),u=Ir(null==t?void 0:t.pageXOffset,r.scrollLeft),t=Ir(r.clientTop,n.clientTop),n=Ir(r.clientLeft,n.clientLeft);return Fo(e).translate(u-n,o-t)}function kr(e,n){return{row:e,y:n}}function Nr(e,n){return{col:e,x:n}}function _r(e){return Mr(e).left+Dr(e)}function zr(e){return Mr(e).left}function Wr(e,n){return Nr(e,zr(n))}function jr(e,n){return Nr(e,_r(n))}function Fr(e){return Mr(e).top}function Lr(e,n){return kr(e,Fr(n))}function Hr(e,n){return kr(e,Fr(n)+Pr(n))}function qr(t,n,r){if(0===r.length)return[];var e=S(r.slice(1),function(e,n){return e.map(function(e){return t(n,e)})}),o=r[r.length-1].map(function(e){return n(r.length-1,e)});return e.concat([o])}function Vr(){var e=Ke().browser;return e.isIE()||e.isEdge()}function Ur(e,n,t){return n=Mn(e,n),t=t,n=parseFloat(n),isNaN(n)?t:n}function $r(e){return Vr()?(t=(n=e).dom.getBoundingClientRect().width,"border-box"===Mn(n,"box-sizing")?t:t-Ur(n,"padding-left",0)-Ur(n,"padding-right",0)-(Ur(n,"border-left-width",0)+Ur(n,"border-right-width",0))):Ur(e,"width",Or(e));var n,t}function Gr(e,n){Pn(e,"width",n+"px")}function Kr(e,n){Pn(e,"width",n+"%")}function Xr(e,n){Pn(e,"height",n+"px")}function Yr(e){var r,n,t,o,u,i,c,l=kn(r=e,"height").getOrThunk(function(){return e=r,(Vr()?(t=(n=e).dom.getBoundingClientRect().height,"border-box"===Mn(n,"box-sizing")?t:t-Ur(n,"padding-top",0)-Ur(n,"padding-bottom",0)-(Ur(n,"border-top-width",0)+Ur(n,"border-bottom-width",0))):Ur(e,"height",Er(e)))+"px";var e,n,t});return l?(n=l,t=e,o=Er,u=Xr,l=parseInt(n,10),X(n,"%")&&"table"!==rn(t)?(i=l,c=o,o=u,t=wt(u=t).map(function(e){e=c(e);return Math.floor(i/100*e)}).getOr(i),o(u,t),t):l):Er(e)}function Jr(e){return kn(e,"width").fold(function(){return I.from(Rn(e,"width"))},function(e){return I.some(e)})}function Qr(e,n){return e/n.pixelWidth()*100}function Zr(n,t){return Jr(n).fold(function(){var e=Or(n);return Qr(e,t)},function(r){return function(e,n){var t=$o.exec(r);if(null!==t)return parseFloat(t[1]);e=$r(e);return Qr(e,n)}(n,t)})}function eo(n,t){return Jr(n).fold(function(){return $r(n)},function(e){return function(e,n,t){var r=Go.exec(n);if(null!==r)return parseInt(r[1],10);n=$o.exec(n);return null===n?$r(e):parseFloat(n[1])/100*t.pixelWidth()}(n,e,t)})}function no(e){return Yr(e=e)/zn(e,"rowspan")}function to(e,n,t){Pn(e,"width",n+t)}function ro(e){return n=e,t=Or,e=I.from(n.dom.offsetParent).map(Xe.fromDom).getOr(Te(ge(n))),t(n)/t(e)*100+"%";var n,t}function oo(e){return un(e)&&"col"===rn(e)}function uo(e,n,t){return kn(e,n).fold(function(){return t(e)+"px"},function(e){return e})}function io(e,n){return uo(e,"width",function(e){return oo(e)?Or(e):eo(e,n)})}function co(e){return uo(e,"height",no)}function lo(e,n,t,r,o,u){return e.filter(r).fold(function(){return u(function(n,t){if(t<0||t>=n.length-1)return I.none();var e=n[t].fold(function(){var e=(e=n.slice(0,t),(e=W.call(e,0)).reverse(),e);return D(e,function(e,n){return e.map(function(e){return{value:e,delta:n+1}})})},function(e){return I.some({value:e,delta:0})}),r=n[t+1].fold(function(){var e=n.slice(t+1);return D(e,function(e,n){return e.map(function(e){return{value:e,delta:n+1}})})},function(e){return I.some({value:e,delta:1})});return e.bind(function(t){return r.map(function(e){var n=e.delta+t.delta;return Math.abs(e.value-t.value)/n})})}(t,n))},function(e){return o(e)})}function ao(e,n,r,o,u){var i=Ar(e),e=At(e)?S(Dt(e),function(e){return I.from(e.element)}):i,c=[I.some(qo.edge(n))].concat(S(qo.positions(i,n),function(e){return e.map(function(e){return e.x})})),l=g(Wn);return S(e,function(e,t){return lo(e,t,c,l,function(e){if(!oo(n=e)||kn(n,"width").isSome())return r(e,u);var n,e=null!=(e=i[t])?a(e):I.none();return lo(e,t,c,l,function(e){return o(I.some(Or(e)))},o)},o)})}function fo(e){return e.map(function(e){return e+"px"}).getOr("")}function so(e,n,t){return ao(e,n,eo,function(e){return e.getOrThunk(t.minCellWidth)},t)}function mo(e,n,t,r,o){var e=Br(e),u=[I.some(t.edge(n))].concat(S(t.positions(e,n),function(e){return e.map(function(e){return e.y})}));return S(e,function(e,n){return lo(e,n,u,g(jn),r,o)})}function po(e,n,t){for(var r=0,o=e;o<n;o++)r+=void 0!==t[o]?t[o]:0;return r}function go(e,n,t){var r,o,u,n=(r=n,At(n=e)?(u=r,e=Dt(n),S(e,function(e,n){return{element:e.element,width:u[n],colspan:e.colspan}})):(o=r,n=Ot(n),S(n,function(e){var n=po(e.column,e.column+e.colspan,o);return{element:e.element,width:n,colspan:e.colspan}})));C(n,function(e){t.setElementWidth(e.element,e.width)})}function ho(e,n,t,r,o){var u,i,c,l,a=xt(e),f=o.getCellDelta(n),s=o.getWidths(a,o),e=t===a.grid.columns-1,n=r.clampTableDelta(s,t,f,o.minCellWidth(),e),f=(f=t,u=n,i=o,c=r,l=(t=s).slice(0),f=f,t=0===(t=t).length?Tr.none():1===t.length?Tr.only(0):0===f?Tr.left(0,1):f===t.length-1?Tr.right(f-1,f):0<f&&f<t.length-1?Tr.middle(f-1,f,f+1):Tr.none(),f=p(S(l,p(0))),t.fold(f,function(e){return i.singleColumnWidth(l[e],u)},function(e,n){return c.calcLeftEdgeDeltas(l,e,n,u,i.minCellWidth(),i.isRelative)},function(e,n,t){return c.calcMiddleDeltas(l,e,n,t,u,i.minCellWidth(),i.isRelative)},function(e,n){return c.calcRightEdgeDeltas(l,e,n,u,i.minCellWidth(),i.isRelative)})),f=S(f,function(e,n){return e+s[n]});go(a,f,o),r.resizeTable(o.adjustTableWidth,n,e)}function bo(e){return S(e,p(0))}function vo(e,n,t,r,o){return o(e.slice(0,n)).concat(r).concat(o(e.slice(t)))}function wo(){function i(e,t,n,r){var o=(100+n)/100,u=Math.max(r,(e[t]+n)/o);return S(e,function(e,n){return(n===t?u:e/o)-e})}function c(e,n,t,r,o,u){return u?i(e,n,r,o):(t=t,o=Yo(e=e,n=n,r,o),vo(e,n,t+1,[o,0],bo))}return{resizeTable:function(e,n){return e(n)},clampTableDelta:Yo,calcLeftEdgeDeltas:c,calcMiddleDeltas:function(e,n,t,r,o,u,i){return c(e,t,r,o,u,i)},calcRightEdgeDeltas:function(e,n,t,r,o,u){if(u)return i(e,t,r,o);o=Yo(e,t,r,o);return bo(e.slice(0,t)).concat([o])}}}function yo(e,n){var t=I.from(e.dom.documentElement).map(Xe.fromDom).getOr(e);return{parent:p(t),view:p(e),origin:p(jo(0,0)),isResizable:n}}function xo(e,n,t){var r=t.substring(0,t.length-e.length),e=parseFloat(r);return r===e.toString()?n(e):Qo.invalid(t)}function So(e,n,t){var r,o,u,i=Zo.from(t),i=O(e,function(e){return"0px"===e})?(r=e.length,t=i.fold(function(){return p("")},function(e){return p(e/r+"px")},function(){return p(100/r+"%")}),w(r,t)):(o=e,u=n,i.fold(function(){return o},function(e){return t=(n=e)/u,S(o,function(e){return Zo.from(e).fold(function(){return e},function(e){return e*t+"px"},function(e){return e/100*n+"px"})});var n,t},function(e){return n=u,S(o,function(e){return Zo.from(e).fold(function(){return e},function(e){return e/n*100+"%"},function(e){return e+"%"})});var n}));return eu(i)}function Co(e,n){return 0===e.length?n:s(e,function(e,n){return Zo.from(n).fold(p(0),a,a)+e},0)}function To(e){return nu(e).fold(p("px"),p("px"),p("%"))}function Ro(l,e,n,a){var f=xt(l),i=f.all,s=Ot(f),d=Dt(f);e.each(function(e){var t,r,o,u,n=To(e),i=Or(l),c=ao(f,l,io,fo,a),i=So(c,i,e);At(f)?(o=i,u=n,C(d,function(e,n){n=Co([o[n]],ht());Pn(e.element,"width",n+u)})):(t=i,r=n,C(s,function(e){var n=t.slice(e.column,e.colspan+e.column),n=Co(n,ht());Pn(e.element,"width",n+r)})),Pn(l,"width",e)}),n.each(function(e){var n=To(e),t=Er(l),r=mo(f,l,Lo,co,fo),o=So(r,t,e),t=i,u=n;C(s,function(e){var n=o.slice(e.row,e.rowspan+e.row),n=Co(n,bt());Pn(e.element,"height",n+u)}),C(t,function(e,n){Pn(e.element,"height",o[n])}),Pn(l,"height",e)})}function Oo(e){return Jr(e).exists(function(e){return $o.test(e)})}function Do(e){return Jr(e).exists(function(e){return Go.test(e)})}function Ao(e){return Jr(e).isNone()}function Bo(e){return xt(e).grid}function Eo(e){return e.slice(0).sort()}function Po(e,o,u){if(0===o.length)throw new Error("You must specify at least one required field.");var t;return function(n,e){if(!N(e))throw new Error("The "+n+" fields must be an array. Was: "+e+".");C(e,function(e){if(!M(e))throw new Error("The value "+e+" in the "+n+" fields was not a string.")})}("required",o),t=Eo(o),f(t,function(e,n){return n<t.length-1&&e===t[n+1]}).each(function(e){throw new Error("The field: "+e+" occurs more than once in the combined fields: ["+t.join(", ")+"].")}),function(n){var t=Qe(n);O(o,function(e){return x(t,e)})||function(e){throw new Error("All required keys ("+Eo(o).join(", ")+") were not specified. Specified keys were: "+Eo(e).join(", ")+".")}(t),e(o,t);var r=T(o,function(e){return!u.validate(n[e],e)});return 0<r.length&&function(e){throw new Error("All values need to be of type: "+e+". Keys ("+Eo(r).join(", ")+") were not.")}(u.label),n}}function Io(n,e){var t=T(e,function(e){return!x(n,e)});0<t.length&&function(){throw new Error("Unsupported keys for object: "+Eo(t).join(", "))}()}var Mo=Rr("width",function(e){return e.dom.offsetWidth}),ko=function(e,n,t){var r=e();return f(r,n).orThunk(function(){return I.from(r[0]).orThunk(t)}).map(function(e){return e.element})},No=function(n,t){return function(e){return"rtl"===_o(e)?t:n}},_o=function(e){return"rtl"===Mn(e,"direction")?"rtl":"ltr"},zo=Rr("height",function(e){var n=e.dom;return pn(e)?n.getBoundingClientRect().height:n.offsetHeight}),Wo=function(t,r){return{left:t,top:r,translate:function(e,n){return Wo(t+e,r+n)}}},jo=Wo,Fo=function(e){var n=e.dom,t=n.ownerDocument.body;return t===n?jo(t.offsetLeft,t.offsetTop):pn(e)?(n=n.getBoundingClientRect(),jo(n.left,n.top)):jo(0,0)},Lo={delta:a,positions:function(e){return qr(Lr,Hr,e)},edge:Fr},Ho=No({delta:a,edge:zr,positions:function(e){return qr(Wr,jr,e)}},{delta:function(e){return-e},edge:_r,positions:function(e){return qr(jr,Wr,e)}}),qo={delta:function(e,n){return Ho(n).delta(e,n)},positions:function(e,n){return Ho(n).positions(e,n)},edge:function(e){return Ho(e).edge(e)}},Vo={unsupportedLength:["em","ex","cap","ch","ic","rem","lh","rlh","vw","vh","vi","vb","vmin","vmax","cm","mm","Q","in","pc","pt","px"],fixed:["px","pt"],relative:["%"],empty:[""]},Uo=(Me="[eE][+-]?[0-9]+",_e=["Infinity",(ke="[0-9]+")+"\\."+(Ne=function(e){return"(?:"+e+")?"})(ke)+Ne(Me),"\\."+ke+Ne(Me),ke+Ne(Me)].join("|"),new RegExp("^([+-]?(?:"+_e+"))(.*)$")),$o=/(\d+(\.\d+)?)%/,Go=/(\d+(\.\d+)?)px|em/,Ko=p($o),Xo=p(Go),on=function(o){return function(e,n,t,r){if(o(t)){r=Math.max(r,e[n]-Math.abs(t)),n=Math.abs(r-e[n]);return 0<=t?n:-n}return t}},Yo=on(function(e){return e<0}),Jo=on(B),Qo=mr([{invalid:["raw"]},{pixels:["value"]},{percent:["value"]}]),Zo=L(L({},Qo),{from:function(e){return X(e,"%")?xo("%",Qo.percent,e):X(e,"px")?xo("px",Qo.pixels,e):Qo.invalid(e)}}),eu=function(e){if(0===e.length)return e;var n,t=s(e,function(e,n){var t=Zo.from(n).fold(function(){return{value:n,remainder:0}},function(e){return n=e,{value:(e=Math.floor(n))+"px",remainder:n-e};var n},function(e){return{value:e+"%",remainder:0}});return{output:[t.value].concat(e.output),remainder:e.remainder+t.remainder}},{output:[],remainder:0}),e=t.output;return e.slice(0,e.length-1).concat([(e=e[e.length-1],n=Math.round(t.remainder),Zo.from(e).fold(p(e),function(e){return e+n+"px"},function(e){return e+n+"%"}))])},nu=Zo.from,tu=ro,ru=function(n){var o=[];return{bind:function(e){if(void 0===e)throw new Error("Event bind error: undefined handler");o.push(e)},unbind:function(n){o=T(o,function(e){return e!==n})},trigger:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r={};C(n,function(e,n){r[e]=t[n]}),C(o,function(e){e(r)})}}},ou=function(e){return{registry:ie(e,function(e){return{bind:e.bind,unbind:e.unbind}}),trigger:ie(e,function(e){return e.trigger})}},fn=function(e){return Po(Io,e,{validate:_,label:"function"})},e=fn(["compare","extract","mutate","sink"]),uu=fn(["element","start","stop","destroy"]),iu=fn(["forceDrop","drop","move","delayDrop"]);function cu(){var o,u,e={onEvent:y,reset:y},n=(o=I.none(),{onEvent:function(e,r){r.extract(e).each(function(e){var n=r,t=e,e=o.map(function(e){return n.compare(e,t)});o=I.some(t),e.each(function(e){u.trigger.move(e)})})},reset:function(){o=I.none()},events:(u=ou({move:ru(["info"])})).registry}),t=e;return{on:function(){t.reset(),t=n},off:function(){t.reset(),t=e},isOn:function(){return t===n},onEvent:function(e,n){t.onEvent(e,n)},events:n.events}}function lu(n,t,e){function r(){s.stop(),l.isOn()&&(l.off(),c.trigger.stop())}var o,u,i=!1,c=ou({start:ru([]),stop:ru([])}),l=cu(),a=(o=r,u=null,{cancel:function(){null!==u&&(clearTimeout(u),u=null)},throttle:function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];null!==u&&clearTimeout(u),u=setTimeout(function(){o.apply(null,e),u=null},200)}});function f(t){return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];i&&t.apply(null,e)}}l.events.move.bind(function(e){t.mutate(n,e.info)});var s=t.sink(iu({forceDrop:r,drop:f(r),move:f(function(e){a.cancel(),l.onEvent(e,t)}),delayDrop:f(a.throttle)}),e);return{element:s.element,go:function(e){s.start(e),l.on(),c.trigger.start()},on:function(){i=!0},off:function(){i=!1},destroy:function(){s.destroy()},events:c.registry}}function au(e){function n(){return e.stopPropagation()}function t(){return e.preventDefault()}var r,o,u=Xe.fromDom(function(e){if(sn()&&c(e.target)){var n=Xe.fromDom(e.target);if(un(n)&&mn(n)&&e.composed&&e.composedPath){n=e.composedPath();if(n)return l(n,0)}}return I.from(e.target)}(e).getOr(e.target)),i=(r=t,o=n,function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return r(o.apply(null,e))});return{target:u,x:e.clientX,y:e.clientY,stop:n,prevent:t,kill:i,raw:e}}function fu(e,n,t){return r=n,n=!1,o=Ml,u=t=t,t=function(e){o(e)&&u(au(e))},(e=e).dom.addEventListener(r,t,n),{unbind:h(Il,e,r,t,n)};var r,o,u}function su(e,n){return void 0===(n=Rn(e,n))||""===n?[]:n.split(" ")}function du(e){return void 0!==e.dom.classList}function mu(e,n){du(e)?e.dom.classList.add(n):(n=n=n,n=su(e=e=e,"class").concat([n]),Cn(e,"class",n.join(" ")))}function pu(e,n){return du(e)&&e.dom.classList.contains(n)}function gu(e){return"true"===Rn(e,"contenteditable")}function hu(e){e=De(e.parent(),"."+zl),C(e,Mt)}function bu(n,e,t){var r=n.origin();C(e,function(e){e.each(function(e){e=t(r,e);mu(e,zl),It(n.parent(),e)})})}function vu(e,n,t,r,o){var u,i,c,l,a=Mr(t),f=n.isResizable,s=0<(l=0<r.length?Lo.positions(r,t):[]).length?(u=f,R(e.all,function(e,n){return u(e.element)?[n]:[]})):[],r=T(l,function(e,n){return v(s,function(e){return n===e})});l=n,r=r,i=a,c=Dr(t),bu(l,r,function(e,n){var t,r,o,e=(t=n.row,r=i.left-e.left,o=n.y-e.top,n=c,e=Xe.fromTag("div"),In(e,{position:"absolute",left:r+"px",top:o-3.5+"px",height:"7px",width:n+"px"}),Tn(e,{"data-row":t,role:"presentation"}),e);return mu(e,Wl),e});var d,m,p,g,h,b=0<(o=0<o.length?qo.positions(o,t):[]).length?(m=f,p=[],w((d=e).grid.columns,function(e){Bt(d,e).map(function(e){return e.element}).forall(m)&&p.push(e)}),T(p,function(n){var e=Rt(d,function(e){return e.column===n});return O(e,function(e){return m(e.element)})})):[],o=T(o,function(e,n){return v(b,function(e){return n===e})});n=n,o=o,g=a,h=Pr(t),bu(n,o,function(e,n){var t,r,o,e=(t=n.col,r=n.x-e.left,o=g.top-e.top,n=h,e=Xe.fromTag("div"),In(e,{position:"absolute",left:r-3.5+"px",top:o+"px",height:n+"px",width:"7px"}),Tn(e,{"data-column":t,role:"presentation"}),e);return mu(e,jl),e})}function wu(e,n){var t,r,o;hu(e),e.isResizable(n)&&(t=xt(n),r=Br(t),o=Ar(t),vu(t,e,n,r,o))}function yu(e,n){e=De(e.parent(),"."+zl),C(e,n)}function xu(e){yu(e,function(e){Pn(e,"display","none")})}function Su(e){yu(e,function(e){Pn(e,"display","block")})}function Cu(o){function e(e,n){return I.from(Rn(e,n))}var n,t,r,u,i,c=(r=ou({drag:ru(["xDelta","yDelta","target"])}),u=I.none(),(i={mutate:function(e,n){t.trigger.drag(e,n)},events:(t=ou({drag:ru(["xDelta","yDelta"])})).registry}).events.drag.bind(function(n){u.each(function(e){r.trigger.drag(n.xDelta,n.yDelta,e)})}),{assign:function(e){u=I.some(e)},get:function(){return u},mutate:i.mutate,events:r.registry}),l=(i=void 0!==(n=void 0===(n={})?{}:n).mode?n.mode:_l,lu(c,i,n)),a=I.none();function f(e,n){return Fn(e,n)-_n(e,"data-initial-"+n,0)}function s(e,n){g.trigger.startAdjust(),c.assign(e),Cn(e,"data-initial-"+n,Fn(e,n)),mu(e,Fl),Pn(e,"opacity","0.2"),l.go(o.parent())}function d(e){return Ye(e,o.view())}c.events.drag.bind(function(t){e(t.target,"data-row").each(function(e){var n=Fn(t.target,"top");Pn(t.target,"top",n+t.yDelta+"px")}),e(t.target,"data-column").each(function(e){var n=Fn(t.target,"left");Pn(t.target,"left",n+t.xDelta+"px")})}),l.events.stop.bind(function(){c.get().each(function(r){a.each(function(t){e(r,"data-row").each(function(e){var n=f(r,"top");Dn(r,"data-initial-top"),g.trigger.adjustHeight(t,n,parseInt(e,10))}),e(r,"data-column").each(function(e){var n=f(r,"left");Dn(r,"data-initial-left"),g.trigger.adjustWidth(t,n,parseInt(e,10))}),wu(o,t)})})});var m=fu(o.parent(),"mousedown",function(e){var n=e.target;pu(n,Wl)&&s(e.target,"top"),n=e.target,pu(n,jl)&&s(e.target,"left")}),p=fu(o.view(),"mouseover",function(e){var n;n=e.target,xn(n,"table",d).filter(function(e){return xn(e,"[contenteditable]",d).exists(gu)}).fold(function(){pn(e.target)&&hu(o)},function(e){a=I.some(e),wu(o,e)})}),g=ou({adjustHeight:ru(["table","delta","row"]),adjustWidth:ru(["table","delta","column"]),startAdjust:ru([])});return{destroy:function(){m.unbind(),p.unbind(),l.destroy(),hu(o)},refresh:function(e){wu(o,e)},on:l.on,off:l.off,hideBars:h(xu,o),showBars:h(Su,o),events:g.registry}}function Tu(e,o,u){var t=Lo,i=qo,e=Cu(e),c=ou({beforeResize:ru(["table","type"]),afterResize:ru(["table","type"]),startDrag:ru([])});return e.events.adjustHeight.bind(function(e){var n=e.table;c.trigger.beforeResize(n,"row"),function(e,t,r,n){var o,u,i=xt(e),c=mo(i,e,n,no,function(e){return e.getOrThunk(bt)}),n=S(c,function(e,n){return r===n?Math.max(t+e,bt()):e}),c=(o=n,c=Ot(i),S(c,function(e){var n=po(e.row,e.row+e.rowspan,o);return{element:e.element,height:n,rowspan:e.rowspan}})),i=(u=n,S(i.all,function(e,n){return{element:e.element,height:u[n]}}));C(i,function(e){Xr(e.element,e.height)}),C(c,function(e){Xr(e.element,e.height)});n=s(n,function(e,n){return e+n},0);Xr(e,n)}(n,t.delta(e.delta,n),e.row,t),c.trigger.afterResize(n,"row")}),e.events.startAdjust.bind(function(e){c.trigger.startDrag()}),e.events.adjustWidth.bind(function(e){var n=e.table;c.trigger.beforeResize(n,"col");var t=i.delta(e.delta,n),r=u(n);ho(n,t,e.column,o,r),c.trigger.afterResize(n,"col")}),{on:e.on,off:e.off,hideBars:e.hideBars,showBars:e.showBars,destroy:e.destroy,events:c.registry}}function Ru(e,n){return e.fire("newrow",{node:n})}function Ou(e,n){return e.fire("newcell",{node:n})}function Du(e,n,t){e.fire("TableModified",L(L({},t),{table:n}))}function Au(e){return e.getParam("table_sizing_mode","auto")}function Bu(e){return e.getParam("table_responsive_width")}function Eu(e){return e.getParam("table_default_attributes",Vl,"object")}function Pu(e){return e.getParam("table_default_styles",function(e){if($l(e)){var n=e.getBody().offsetWidth;return L(L({},ql),{width:n+"px"})}return Gl(e)?ce(ql,function(e,n){return"width"!==n}):ql}(e),"object")}function Iu(e){return e.getParam("table_cell_advtab",!0,"boolean")}function Mu(e){return e.getParam("table_row_advtab",!0,"boolean")}function ku(e){return e.getParam("table_advtab",!0,"boolean")}function Nu(e){return e.getParam("table_style_by_css",!1,"boolean")}function _u(e){return"relative"===Au(e)||!0===Bu(e)}function zu(e){var n="section",e=e.getParam("table_header_type",n,"string");return x(["section","cells","sectionCells","auto"],e)?e:n}function Wu(e){var n=e.getParam("table_column_resizing",Ul,"string");return f(["preservetable","resizetable"],function(e){return e===n}).getOr(Ul)}function ju(e){return"preservetable"===Wu(e)}function Fu(e){return e.nodeName.toLowerCase()}function Lu(e){return e.getBoundingClientRect().width}function Hu(e){return e.getBoundingClientRect().height}function qu(e){return/^\d+(\.\d+)?$/.test(e)?e+"px":e}function Vu(e){function n(e){return Dn(e,"data-mce-style")}Dn(e,"data-mce-style"),C(qn(e),n),C(Vn(e),n)}function Uu(e,n){return n=e.dom.getStyle(n,"width")||e.dom.getAttrib(n,"width"),I.from(n).filter(Y)}function $u(e){return/^(\d+(\.\d+)?)%$/.test(e)}function Gu(e){return Xe.fromDom(e.selection.getStart())}function Ku(e,r){var t=Jl(parseFloat(e)),o=Jl(Or(r));return{width:t.get,pixelWidth:o.get,getWidths:function(e,n){return ao(e,r,Zr,function(e){return e.fold(function(){return t.minCellWidth()},function(e){return e/t.pixelWidth()*100})},t=n);var t},getCellDelta:function(e){return e/o.get()*100},singleColumnWidth:function(e,n){return[100-e]},minCellWidth:function(){return ht()/o.get()*100},setElementWidth:Kr,adjustTableWidth:function(e){var n=t.get(),n=n+e/100*n;Kr(r,n),t.set(n),o.set(Or(r))},isRelative:!0,label:"percent"}}function Xu(e,t){var n=Jl(e),r=n.get;return{width:r,pixelWidth:r,getWidths:function(e,n){return so(e,t,n)},getCellDelta:a,singleColumnWidth:function(e,n){return[Math.max(ht(),e+n)-e]},minCellWidth:ht,setElementWidth:Gr,adjustTableWidth:function(e){e=r()+e;Gr(t,e),n.set(e)},isRelative:!1,label:"pixel"}}function Yu(r){return Jr(r).fold(function(){return t=r,n=p(0),{width:e,pixelWidth:e,getWidths:function(e,n){return so(e,t,n)},getCellDelta:n,singleColumnWidth:p([0]),minCellWidth:n,setElementWidth:y,adjustTableWidth:y,isRelative:!0,label:"none"};function e(){return Or(t)}var t,n},function(e){return function(e,n){var t=Ko().exec(n);if(null!==t)return Ku(t[1],e);n=Xo().exec(n);if(null!==n){var r=parseInt(n[1],10);return Xu(r,e)}r=Or(e);return Xu(r,e)}(r,e)})}function Ju(e,n){if(_u(e)){var t=Uu(e,n.dom).filter($u).getOrThunk(function(){return tu(n)});return Zl(t,n)}return $l(e)?Ql(Or(n),n):Yu(n)}function Qu(e){Dn(e,"width")}function Zu(e,n){var t=Ju(e,n),n=ro(e=n);Ro(e,I.some(n),I.none(),t),Qu(e)}function ei(e,n){var t=Ju(e,n);e=t,n=Or(t=n)+"px",Ro(t,I.some(n),I.none(),e),Qu(t)}function ni(e){Nn(e,"width");var n=0<(n=Vn(e)).length?n:qn(e);C(n,function(e){Nn(e,"width"),Qu(e)}),Qu(e)}function ti(e){return"false"!==Rn(e,"data-mce-resize")}function ri(c){function l(e){return"TABLE"===e.nodeName}function a(e){return Ju(c,e)}function f(){return ju(c)?{resizeTable:function(e,n,t){t&&e(n)},clampTableDelta:function(e,n,t,r,o){if(o){if(0<=t)return t;o=b(e,function(e,n){return e+n-r},0);return Math.max(-o,t)}return Yo(e,n,t,r)},calcLeftEdgeDeltas:i=function(e,n,t,r,o){o=Jo(e,0<=r?t:n,r,o);return vo(e,n,t+1,[o,-o],bo)},calcMiddleDeltas:function(e,n,t,r,o,u){return i(e,t,r,o,u)},calcRightEdgeDeltas:function(e,n,t,r,o,u){if(u)return bo(e);r/=e.length;return S(e,p(r))}}:wo();var i}var s,d,u=I.none(),i=I.none(),m=I.none();return c.on("init",function(){var e,n,t,r,o=(e=ti,(o=c).inline?(n=Xl(o),r=Xe.fromTag("div"),In(r,{position:"static",height:"0",width:"0",padding:"0",margin:"0",border:"0"}),It(Te(Xe.fromDom(document)),r),r,t=e,{parent:p(r),view:p(n),origin:p(jo(0,0)),isResizable:t}):yo(Xe.fromDom(o.getDoc()),e));m=I.some(o),e=c.getParam("object_resizing",!0),(M(e)?"table"===e:e)&&c.getParam("table_resize_bars",!0,"boolean")&&(e=f(),(e=Tu(o,e,a)).on(),e.events.startDrag.bind(function(e){u=I.some(c.selection.getRng())}),e.events.beforeResize.bind(function(e){var n,t=e.table.dom,r=c,o=Lu(n=t),t=Hu(t),e=ea+e.type;r.fire("ObjectResizeStart",{target:n,width:o,height:t,origin:e})}),e.events.afterResize.bind(function(e){var n,t,r=e.table,o=r.dom;Vu(r),u.each(function(e){c.selection.setRng(e),c.focus()}),n=c,r=Lu(t=o),o=Hu(o),e=ea+e.type,n.fire("ObjectResized",{target:t,width:r,height:o,origin:e}),c.undoManager.add()}),i=I.some(e))}),c.on("ObjectResizeStart",function(e){var n,t=e.target;l(t)&&(n=Xe.fromDom(t),C(c.dom.select(".mce-clonedresizable"),function(e){c.dom.addClass(e,"mce-"+Wu(c)+"-columns")}),!Do(n)&&$l(c)?ei(c,n):!Oo(n)&&_u(c)&&Zu(c,n),Ao(n)&&K(e.origin,ea)&&Zu(c,n),s=e.width,d=Gl(c)?"":Uu(c,t).getOr(""))}),c.on("ObjectResized",function(e){var n,t,r,o,u,i=e.target;l(i)&&(n=Xe.fromDom(i),u=e.origin,K(u,"corner-")&&(t=n,r=u,i=e.width,u=X(r,"e"),""===d&&Zu(c,t),i!==s&&""!==d?(Pn(t,"width",d),e=f(),r=a(t),u=ju(c)||u?Bo(t).columns-1:0,ho(t,i-s,u,e,r)):$u(d)&&(o=parseFloat(d.replace("%","")),Pn(t,"width",i*o/s+"%")),/^(\d+(\.\d+)?)px$/.test(d)&&(t=xt(o=t),At(t)||C(qn(o),function(e){var n=Mn(e,"width");Pn(e,"width",n),Dn(e,"width")}))),Vu(n),Du(c,n.dom))}),c.on("SwitchMode",function(){i.each(function(e){c.mode.isReadOnly()?e.hideBars():e.showBars()})}),{lazyResize:function(){return i},lazyWire:function(){return m.getOr(yo(Xe.fromDom(c.getBody()),ti))},destroy:function(){i.each(function(e){e.destroy()}),m.each(function(e){c.inline&&Mt(e.parent())})}}}function oi(e,n){return{element:e,offset:n}}function ui(e,n){return(e.property().isText(n)?e.property().getText(n):e.property().children(n)).length}function ii(t,r){Jr(t).bind(function(e){return r=["fixed","relative","empty"],I.from(Uo.exec(e)).bind(function(e){var n=Number(e[1]),e=e[2],t=e;return v(r,function(e){return v(Vo[e],function(e){return t===e})})?I.some({value:n,unit:e}):I.none()});var r}).each(function(e){var n=e.value/2;to(t,n,e.unit),to(r,n,e.unit)})}function ci(e,n,t){e.cells[n]=t}function li(e,n){return de(n,e.section)}function ai(e,n){var t=e.cells,n=S(t,n);return de(n,e.section)}function fi(e,n){return e.cells[n]}function si(e,n){return fi(e,n).element}function di(e){return e.cells.length}function mi(e){return{rows:(e=function(e){for(var n=[],t=[],r=0,o=e.length;r<o;r++){var u=e[r];("colgroup"===u.section?n:t).push(u)}return{pass:n,fail:t}}(e)).fail,cols:e.pass}}function pi(e,n,t,r){t===r?Dn(e,n):Cn(e,n,t)}function gi(e,n,t){m(Oe(e,n)).fold(function(){return Pt(e,t)},function(e){return ot(e,t)})}function hi(u,e){function t(e,n){var t,r,o=(o=wn(t=u,r=n).getOrThunk(function(){var e=Xe.fromTag(r,ge(t).dom);return"thead"===r?gi(t,"caption,colgroup",e):"colgroup"===r?gi(t,"caption",e):It(t,e),e}),lt(o),o),e=("colgroup"===n?function(e){return R(e,function(e){return S(e.cells,function(e){return pi(e.element,"span",e.colspan,1),e.element})})}:function(e){return S(e,function(e){e.isNew&&i.push(e.element);var n=e.element;return lt(n),C(e.cells,function(e){e.isNew&&c.push(e.element),pi(e.element,"colspan",e.colspan,1),pi(e.element,"rowspan",e.rowspan,1),It(n,e.element)}),n})})(e);ct(o,e)}function n(e,n){0<e.length?t(e,n):wn(u,n).each(Mt)}var i=[],c=[],r=[],o=[],l=[],a=[];return C(e,function(e){switch(e.section){case"thead":r.push(e);break;case"tbody":o.push(e);break;case"tfoot":l.push(e);break;case"colgroup":a.push(e)}}),n(a,"colgroup"),n(r,"thead"),n(o,"tbody"),n(l,"tfoot"),{newRows:i,newCells:c}}function bi(e,n){if(0===e.length)return 0;var t=e[0];return d(e,function(e){return!n(t.element,e.element)}).fold(function(){return e.length},function(e){return e})}function vi(a,f){var s=S(a,function(e){return S(e.cells,A)});return S(a,function(e,l){return{details:R(e.cells,function(e,n){if(!1!==s[l][n])return[];var t,r,o,u,i,c,u=(o=n,u=f,c=(t=a)[r=l].cells.slice(o),c=bi(c,u),i=o,r=S(t,function(e){return fi(e,i)}).slice(r),{colspan:c,rowspan:bi(r,u)});return function(e,n,t,r){for(var o=e;o<e+t;o++)for(var u=n;u<n+r;u++)s[o][u]=!0}(l,n,u.rowspan,u.colspan),[{element:e.element,rowspan:u.rowspan,colspan:u.colspan,isNew:e.isNew}]}),section:e.section}})}function wi(e,n,t){var r,o=[];At(e)&&(r=S(Dt(e),function(e){return se(e.element,t)}),o.push(de(r,"colgroup")));for(var u=0;u<e.grid.rows;u++){for(var i=[],c=0;c<e.grid.columns;c++){var l=Ct(e,u,c).map(function(e){return se(e.element,t)}).getOrThunk(function(){return se(n.gap(),!0)});i.push(l)}var a=de(i,e.all[u].section);o.push(a)}return o}function yi(e,n){var t,e=vi(e,Ye);return t=n,S(e,function(e){var n=(n=e.details,D(n,function(e){return be(e.element).map(function(e){var n=be(e).isNone();return se(e,n)})}).getOrThunk(function(){return se(t.row(),!0)}));return{element:n.element,cells:e.details,section:e.section,isNew:n.isNew}})}function xi(e,n){return D(e.all,function(e){return f(e.cells,function(e){return Ye(n,e.element)})})}function Si(n,e){return e=S(e.selection,function(e){return Hn(e).bind(function(e){return xi(n,e)})}),0<(e=lr(e)).length?I.some(e):I.none()}function Ci(e,n,t,r){for(var o=mi(e).rows,u=!0,i=0;i<o.length;i++)for(var c=0;c<di(o[0]);c++){var l=t(si(o[i],c),n);!0===l&&!1===u?ci(o[i],c,se(r(),!0)):!0===l&&(u=!1)}return e}function Ti(e,n,u,i){var t,r,c=mi(e).rows;return 0<n&&n<c.length&&(t=c[n-1].cells,r=u,t=b(t,function(e,n){return v(e,function(e){return r(e.element,n.element)})?e:e.concat([n])},[]),C(t,function(r){for(var o=I.none(),e=n;e<c.length;e++)!function(t){for(var e=0;e<di(c[0]);e++)!function(n){var e=c[t].cells[n];u(e.element,r.element)&&(o=o.isNone()?I.some(i()):o).each(function(e){ci(c[t],n,se(e,!0))})}(e)}(e)})),e}function Ri(e,n){return{rowDelta:0,colDelta:di(e[0])-di(n[0])}}function Oi(e,n){return{rowDelta:e.length-n.length,colDelta:0}}function Di(e,n,t){var r="colgroup"===n.section?t.col:t.cell;return S(e,function(){return se(r(),!0)})}function Ai(e,t,r){return S(e,function(e){var n=Di(w(t,a),e,r);return li(e,e.cells.concat(n))})}function Bi(e,n,t){var r=n.colDelta<0?Ai:a;return(n.rowDelta<0?function(n,e,t){return n.concat(w(e,function(){var e=n[n.length-1];return li(e,Di(e.cells,e,t))}))}:a)(r(e,Math.abs(n.colDelta),t),Math.abs(n.rowDelta),t)}function Ei(n,t,r,o,u){return function(e,n,t){if(e.row>=n.length||e.column>di(n[0]))return ca.error("invalid start address out of table bounds, row: "+e.row+", column: "+e.column);var r=n.slice(e.row),n=r[0].cells.slice(e.column),e=di(t[0]),t=t.length;return ca.value({rowDelta:r.length-t,colDelta:n.length-e})}(n,t,r).map(function(e){e=Bi(t,e,o);return function(e,n,t,r,o){for(var u,i,c,l,a=e.row,f=e.column,s=a+t.length,d=f+di(t[0]),m=a;m<s;m++)for(var p=f;p<d;p++){g=p,c=void 0,c=h(o,fi((u=n)[i=m],g).element),l=u[i],1<u.length&&1<di(l)&&(0<g&&c(si(l,g-1))||g<l.cells.length-1&&c(si(l,g+1))||0<i&&c(si(u[i-1],g))||i<u.length-1&&c(si(u[i+1],g)))&&Ci(n,si(n[m],p),o,r.cell);var g=si(t[m-a],p-f),g=r.replace(g);ci(n[m],p,se(g,!0))}return n}(n,e,r,o,u)})}function Pi(t,e,n,r,o){var u=t,i=o,c=r.cell;0<u&&u<e[0].cells.length&&C(e,function(e){var n=e.cells[u-1],t=e.cells[u];i(t.element,n.element)&&ci(e,u,se(c(),!0))});var o=Oi(n,e),l=Bi(n,o,r),o=Oi(e,l),r=Bi(e,o,r);return S(r,function(e,n){n=e.cells.slice(0,t).concat(l[n].cells).concat(e.cells.slice(t,e.cells.length));return li(e,n)})}function Ii(e,n,t,r,o){return Ti(n,e,o,r.cell),o=Ri(t,n),t=Bi(t,o,r),o=Ri(n,t),o=Bi(n,o,r),r=mi(o),o=r.cols,r=r.rows,o.concat(r.slice(0,e)).concat(t).concat(r.slice(e,r.length))}function Mi(e,t,n,r,o){var u=(c=mi(e)).rows,i=c.cols,e=u.slice(0,t),c=u.slice(t),n=ai(u[n],function(e,n){return 0<t&&t<u.length&&r(si(u[t-1],n),si(u[t],n))?fi(u[t],n):se(o(e.element,r),!0)});return i.concat(e).concat([n]).concat(c)}function ki(e,u,i,c,l){return S(e,function(e){var n=0<u&&u<di(e)&&c(si(e,u-1),si(e,u)),t="colgroup"!==e.section&&n?fi(e,u):se(l(si(e,i),c),!0),r=u,o=t,t=(n=e).cells,e=t.slice(0,r),r=t.slice(r),r=e.concat([o]).concat(r);return li(n,r)})}function Ni(e,t,r,o){return S(e,function(e){return ai(e,function(e){return n=e,v(t,function(e){return r(n.element,e.element)})?se(o(e.element,r),!0):e;var n})})}function _i(e,n,t,r){return void 0!==si(e[n],t)&&0<n&&r(si(e[n-1],t),si(e[n],t))}function zi(e,n,t){return 0<n&&t(si(e,n-1),si(e,n))}function Wi(t,r,o,e){var n=R(t,function(e,n){return _i(t,n,r,o)||zi(e,r,o)?[]:[fi(e,r)]});return Ni(t,n,o,e)}function ji(e,t,r,n){var o=mi(e).rows,u=o[t],i=R(u.cells,function(e,n){return _i(o,t,n,r)||zi(u,n,r)?[]:[e]});return Ni(e,i,r,n)}function Fi(e){return{element:e,colspan:_n(e,"colspan",1),rowspan:_n(e,"rowspan",1)}}function Li(e){return e=e,e=fa.property().name(e),x(aa,e)}function Hi(e){return e=e,e=fa.property().name(e),x(["ol","ul"],e)}function qi(e){function u(e){return"br"===rn(e)}function t(o){return wr(o).bind(function(t){var r=ye(t).map(function(e){return!!Li(e)||(n=n=e,!!x(["br","img","hr","input"],fa.property().name(n))&&"img"!==rn(e));var n}).getOr(!1);return be(t).map(function(e){return!0===r||"li"===rn(n=e)||bn(n,Hi).isSome()||u(t)||Li(e)&&!Ye(o,e)?[]:[Xe.fromTag("br")];var n})}).getOr([])}var n=0===(n=R(e,function(e){var n=xe(e);return O(n,function(e){return u(e)||cn(e)&&0===ft(e).trim().length})?[]:n.concat(t(e))})).length?[Xe.fromTag("br")]:n;lt(e[0]),ct(e[0],n)}function Vi(e,n){return{grid:e,cursor:n}}function Ui(e,n,t){var r=mi(e).rows;return sa(r,n,t).orThunk(function(){return sa(r,0,0)})}function $i(e,n,t){var r=mi(e).rows;return Vi(e,sa(r,n,t))}function Gi(e){return b(e,function(e,n){return v(e,function(e){return e.row===n.row})?e:e.concat([n])},[]).sort(function(e,n){return e.row-n.row})}function Ki(e){return b(e,function(e,n){return v(e,function(e){return e.column===n.column})?e:e.concat([n])},[]).sort(function(e,n){return e.column-n.column})}function Xi(e,n,t){var r,e=(r=t.section,$n(e,function(){return r})),e=St(e);return wi(e,n,!0)}function Yi(e,n){return 0===(n=T(e,n)).length?I.some("td"):n.length===e.length?I.some("th"):I.none()}function Ji(e,n){var o=xt(e);return Si(o,n).bind(function(e){var n=e[e.length-1],t=e[0].column,r=n.column+n.colspan,n=i(S(o.all,function(e){return T(e.cells,function(e){return e.column>=t&&e.column<r})}));return Yi(n,function(e){return"th"===rn(e.element)})}).getOr("")}function Qi(e){return Fu(e.parentNode)}function Zi(e,n){var t="thead"===Qi(n),n=!v(n.cells,function(e){return"th"!==Fu(e)});return t||n?I.some({thead:t,ths:n}):I.none()}function ec(e,n){return"thead"===(t=Zi(0,n).fold(function(){return Qi(n)},function(e){return"thead"}))?"header":"tfoot"===t?"footer":"body";var t}function nc(n,e,t){var r,o,u=n.getParent(e,"table"),i=e.parentNode,c=Fu(i);t!==c&&((r=n.select(t,u)[0])||(r=n.create(t),o=u.firstChild,"thead"===t?m(Oe(Xe.fromDom(u),"caption,colgroup")).fold(function(){return u.insertBefore(r,o)},function(e){return n.insertAfter(r,e.dom)}):u.appendChild(r)),"tbody"===t&&"thead"===c&&r.firstChild?r.insertBefore(e,r.firstChild):r.appendChild(e),i.hasChildNodes()||n.remove(i))}function tc(e,n,t,r){var o=e.dom,t=function(e,n,t){if(c(t)&&Fu(n)!==t){t=e.dom.rename(n,t);return Ou(e,t),t}return n}(e,n,t);return u(r)||o.setAttrib(t,"scope",r),t}function rc(n,e,t,r){return C(e,function(e){return tc(n,e,t,r)}),0}function oc(e,n,t){var r,o,u=e.dom;"header"===t?(r="auto"===(r=zu(e))?(o=wt(Xe.fromDom(n.cells[0])).map(Un).getOr([]),D(o,function(e){return Zi(0,e.dom)}).map(function(e){return e.thead&&e.ths?"sectionCells":e.thead?"section":"cells"}).getOr("section")):r,rc(e,n.cells,"section"===r?"td":"th","col"),nc(u,n,"cells"===r?"tbody":"thead")):(rc(e,n.cells,"td",null),nc(u,n,"footer"===t?"tfoot":"tbody"))}function uc(e,n){return Da(e).map(function(e){return ur(n)}).getOr([])}function ic(e,t){var n=Da(e),r=n.bind(function(e){return wt(e)}).map(Un),e=function(n,e){return T(e,function(e){return v(or(e.dom.cells),function(e){return"1"===Rn(e,t)||Ye(e,n)})})};return((n=n).isSome()&&r.isSome()?I.some(e(n.getOrDie(),r.getOrDie())):I.none()).getOr([])}function cc(a,e,r){function n(e){return"table"===rn(Xl(e))}function t(u,i,c,l){return function(e,n){Vu(e);var t=l(),r=Xe.fromDom(a.getDoc()),o=Sr(c,r,f),r=Ju(a,e);return i(e)?u(t,e,n,o,r).bind(function(e){return C(e.newRows,function(e){Ru(a,e.dom)}),C(e.newCells,function(e){Ou(a,e.dom)}),e.cursor.map(function(e){var n=ra(oa,e),e=a.dom.createRng();return e.setStart(n.element.dom,n.offset),e.setEnd(n.element.dom,n.offset),e})}):I.none()}}function o(e,n){return le(e,"type").filter(function(e){return x(n,e)})}var f=Kl(a),u=t(ba,function(e){return!1===n(a)||1<Bo(e).rows},y,e),i=t(ha,function(e){return!1===n(a)||1<Bo(e).columns},y,e),c=t(da,B,y,e),l=t(ma,B,y,e),s=t(pa,B,ii,e),d=t(ga,B,ii,e),m=t(ya,B,y,e),p=t(xa,B,y,e),g=t(Ca,B,y,e),h=t(Ta,B,y,e),b=t(Ra,B,y,e),v=t(Oa,B,y,e),w=t(Sa,B,y,e);return{deleteRow:u,deleteColumn:i,insertRowsBefore:c,insertRowsAfter:l,insertColumnsBefore:s,insertColumnsAfter:d,mergeCells:m,unmergeCells:p,pasteColsBefore:g,pasteColsAfter:h,pasteRowsBefore:b,pasteRowsAfter:v,pasteCells:w,setTableCellType:function(t,e){return o(e,["td","th"]).each(function(e){var n=S(uc(Gu(t),r),function(e){return e.dom});rc(t,n,e,null)})},setTableRowType:function(t,e){return o(e,["header","body","footer"]).each(function(n){S(ic(Gu(t),Cr.selected),function(e){return oc(t,e.dom,n)})})},makeColumnsHeader:t(va,B,y,e),unmakeColumnsHeader:t(wa,B,y,e),getTableRowType:function(e){var n=ic(Gu(e),Cr.selected);if(0<n.length){var t=S(n,function(e){return ec(0,e.dom)}),e=x(t,"header"),n=x(t,"footer");if(e||n){t=x(t,"body");return!e||t||n?e||t||!n?"":"footer":"header"}return"body"}},getTableCellType:function(e){return Yi(uc(Gu(e),r),function(e){return"th"===rn(e)}).getOr("")},getTableColType:Ji}}function lc(e,n,t,r){return w(e,function(e){return function(e,n,t,r){for(var o=Xe.fromTag("tr"),u=0;u<e;u++){var i=r<n||u<t?Xe.fromTag("th"):Xe.fromTag("td");u<t&&Cn(i,"scope","row"),r<n&&Cn(i,"scope","col"),It(i,Xe.fromTag("br")),It(o,i)}return o}(n,t,r,e)})}function ac(e,n){e.selection.select(n.dom,!0),e.selection.collapse(!0)}function fc(r,t,o,u,i){var c=Pu(r),l={styles:c,attributes:Eu(r),colGroups:r.getParam("table_use_colgroups",!1,"boolean")};return r.undoManager.ignore(function(){var e=function(e,n,t,r,o,u){void 0===u&&(u=Ba);var i,c=Xe.fromTag("table"),l="cells"!==o;In(c,u.styles),Tn(c,u.attributes),u.colGroups&&It(c,(a=n,i=Xe.fromTag("colgroup"),w(a,function(){return It(i,Xe.fromTag("col"))}),i));var a,u=Math.min(e,t);l&&0<t&&(a=Xe.fromTag("thead"),It(c,a),f=lc(t,n,"sectionCells"===o?u:0,r),ct(a,f));var f=Xe.fromTag("tbody");It(c,f);r=lc(l?e-u:e,n,l?0:t,r);return ct(f,r),c}(o,t,i,u,zu(r),l);Cn(e,"data-mce-id","__mce");var n,e=(n=e,e=Xe.fromTag("div"),n=Xe.fromDom(n.dom.cloneNode(!0)),It(e,n),e.dom.innerHTML);r.insertContent(e),r.addVisual()}),yn(Xl(r),'table[data-mce-id="__mce"]').map(function(e){var n,t;return $l(r)?ei(r,e):Gl(r)?ni(e):(_u(r)||(t=c.width,M(t)&&-1!==t.indexOf("%")))&&Zu(r,e),Vu(e),Dn(e,"data-mce-id"),n=r,C(De(e,"tr"),function(e){Ru(n,e.dom),C(De(e,"th,td"),function(e){Ou(n,e.dom)})}),t=r,yn(e,"td,th").each(h(ac,t)),e.dom}).getOr(null)}function sc(e,n,t,r,o){void 0===r&&(r={});var u=function(e){return z(e)&&0<e};if(u(n)&&u(t)){u=r.headerRows||0,r=r.headerColumns||0;return fc(e,t,n,r,u)}return console.error(o),null}function dc(e){return function(){return e().fold(function(){return[]},function(e){return S(e,function(e){return e.dom})})}}function mc(n){return function(e){e=0<e.length?I.some(or(e)):I.none();n(e)}}function pc(e,n,t){var r=_n(e,n,1);1===t||r<=1?Dn(e,n):Cn(e,n,Math.min(t,r))}function gc(o,e,u){return function(e,n){for(var t=0;t<n.length;t++){var r=o.getStyle(n[t],u);if((e=void 0===e?r:e)!==r)return""}return e}(void 0,o.select("td,th",e))}function hc(e,n,t){t&&e.formatter.apply("align"+t,{},n)}function bc(n,t){Ea.each("left center right".split(" "),function(e){n.formatter.remove("align"+e,{},t)})}function vc(n){return function(e){return K(e,"rgb")?n.toHex(e):e}}function wc(e,n){return n=Xe.fromDom(n),{borderwidth:kn(n,"border-width").getOr(""),borderstyle:kn(n,"border-style").getOr(""),bordercolor:kn(n,"border-color").map(vc(e)).getOr(""),backgroundcolor:kn(n,"background-color").map(vc(e)).getOr("")}}function yc(e){var o=e[0],e=e.slice(1);return C(e,function(e){C(Qe(o),function(r){ue(e,function(e,n){var t=o[r];""!==t&&r===n&&t!==e&&(o[r]="")})})}),o}function xc(e){var n=[{name:"borderstyle",type:"listbox",label:"Border style",items:[{text:"Select...",value:""},{text:"Solid",value:"solid"},{text:"Dotted",value:"dotted"},{text:"Dashed",value:"dashed"},{text:"Double",value:"double"},{text:"Groove",value:"groove"},{text:"Ridge",value:"ridge"},{text:"Inset",value:"inset"},{text:"Outset",value:"outset"},{text:"None",value:"none"},{text:"Hidden",value:"hidden"}]},{name:"bordercolor",type:"colorinput",label:"Border color"},{name:"backgroundcolor",type:"colorinput",label:"Background color"}];return{title:"Advanced",name:"advanced",items:"cell"===e?[{name:"borderwidth",type:"input",label:"Border width"}].concat(n):n}}function Sc(e){return ka.concat((0<(e=Pa(e.getParam("table_cell_class_list",[],"array"))).length?I.some({name:"class",type:"listbox",label:"Class",items:e}):I.none()).toArray())}function Cc(t){return wt(t[0]).map(function(e){var n=xt(e),e=Ot(n),e=T(e,function(n){return v(t,function(e){return Ye(n.element,e)})});return S(e,function(e){return{element:e.element.dom,column:Bt(n,e.column).map(function(e){return e.element.dom})}})})}function Tc(t,r,e){var o=e.getData();e.close(),t.undoManager.transact(function(){var l,e,a,n,f;l=t,a=o,f=1===(e=r).length,1<=e.length&&(n=wt(e[0]),Cc(e).each(function(e){C(e,function(e){var n,t,r,o=tc(l,e.element,a.celltype),u=f?Na.normal(l,o):Na.ifTruthy(l,o),i=e.column.map(function(e){return f?Na.normal(l,e):Na.ifTruthy(l,e)}).getOr(u),c=a;(e=u).setAttrib("scope",c.scope),e.setAttrib("class",c.class),e.setStyle("height",qu(c.height)),i.setStyle("width",qu(c.width)),Iu(l)&&((u=u).setFormat("tablecellbackgroundcolor",(r=a).backgroundcolor),u.setFormat("tablecellbordercolor",r.bordercolor),u.setFormat("tablecellborderstyle",r.borderstyle),u.setFormat("tablecellborderwidth",qu(r.borderwidth))),f&&(bc(l,o),n=l,t=o,Ea.each("top middle bottom".split(" "),function(e){n.formatter.remove("valign"+e,{},t)})),a.halign&&hc(l,o,a.halign),!a.valign||(r=a.valign)&&l.formatter.apply("valign"+r,{},o)})}),n.each(function(e){return Du(l,e.dom)})),t.focus()})}function Rc(e,n){var t,r,o=uc(Gu(e),n);0!==o.length&&(t=function(i,e){e=Cc(e).map(function(e){return S(e,function(e){return t=e.element,r=Iu(n=i),u=e.column,o=n.dom,e=u.getOr(t),L({width:(u=function(e,n){return o.getStyle(e,n)||o.getAttrib(e,n)})(e,"width"),height:u(t,"height"),scope:o.getAttrib(t,"scope"),celltype:Fu(t),class:o.getAttrib(t,"class",""),halign:Ia(n,t),valign:Ma(n,t)},r?wc(o,t):{});var n,t,r,o,u})});return yc(e.getOrDie())}(e,o),r={type:"tabpanel",tabs:[{title:"General",name:"general",items:Sc(e)},xc("cell")]},n={type:"panel",items:[{type:"grid",columns:2,items:Sc(e)}]},e.windowManager.open({title:"Cell Properties",size:"normal",body:Iu(e)?r:n,buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:t,onSubmit:h(Tc,e,o)}))}function Oc(e){return _a.concat((0<(e=Pa(e.getParam("table_row_class_list",[],"array"))).length?I.some({name:"class",type:"listbox",label:"Class",items:e}):I.none()).toArray())}function Dc(n,t,r,e){var l=e.getData();e.close(),n.undoManager.transact(function(){var o,e,u,i,c;o=n,u=r,i=l,c=1===(e=t).length,C(e,function(e){i.type!==Fu(e.parentNode)&&oc(o,e,i.type);var n,t=c?Na.normal(o,e):Na.ifTruthy(o,e),r=i;(n=t).setAttrib("scope",r.scope),n.setAttrib("class",r.class),n.setStyle("height",qu(r.height)),Mu(o)&&((r=t).setStyle("background-color",(t=i).backgroundcolor),r.setStyle("border-color",t.bordercolor),r.setStyle("border-style",t.borderstyle)),i.align!==u.align&&(bc(o,e),hc(o,e,i.align))}),wt(Xe.fromDom(e[0])).each(function(e){return Du(o,e.dom)}),n.focus()})}function Ac(o){var e,n,t,r=ic(Gu(o),Cr.selected);0!==r.length&&(t=S(r,function(e){return t=e.dom,r=Mu(n=o),e=n.dom,L({height:e.getStyle(t,"height")||e.getAttrib(t,"height"),scope:e.getAttrib(t,"scope"),class:e.getAttrib(t,"class",""),type:ec(0,t),align:Ia(n,t)},r?wc(e,t):{});var n,t,r}),e=yc(t),n={type:"tabpanel",tabs:[{title:"General",name:"general",items:Oc(o)},xc("row")]},t={type:"panel",items:[{type:"grid",columns:2,items:Oc(o)}]},o.windowManager.open({title:"Row Properties",size:"normal",body:Mu(o)?n:t,buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:e,onSubmit:h(Dc,o,S(r,function(e){return e.dom}),e)}))}function Bc(t,r,e){var o,u=t.dom,i=e.getData();e.close(),""===i.class&&delete i.class,t.undoManager.transact(function(){var e,n;r||(e=parseInt(i.cols,10)||1,n=parseInt(i.rows,10)||1,r=fc(t,e,n,0,0)),function(e,n,t){var r,o=e.dom,u={},i={};if(u.class=t.class,i.height=qu(t.height),o.getAttrib(n,"width")&&!Nu(e)?u.width=(r=t.width)?r.replace(/px$/,""):"":i.width=qu(t.width),Nu(e)?(i["border-width"]=qu(t.border),i["border-spacing"]=qu(t.cellspacing)):(u.border=t.border,u.cellpadding=t.cellpadding,u.cellspacing=t.cellspacing),Nu(e)&&n.children)for(var c=0;c<n.children.length;c++)Wa(o,n.children[c],{"border-width":qu(t.border),padding:qu(t.cellpadding)}),ku(e)&&Wa(o,n.children[c],{"border-color":t.bordercolor});ku(e)&&(i["background-color"]=t.backgroundcolor,i["border-color"]=t.bordercolor,i["border-style"]=t.borderstyle),u.style=o.serializeStyle(L(L({},Pu(e)),i)),o.setAttribs(n,L(L({},Eu(e)),u)),Du(e,n)}(t,r,i),(o=u.select("caption",r)[0])&&!i.caption&&u.remove(o),!o&&i.caption&&((o=u.create("caption")).innerHTML=za.ie?"Â ":'<br data-mce-bogus="1"/>',r.insertBefore(o,r.firstChild)),""===i.align?bc(t,r):hc(t,r,i.align),t.focus(),t.addVisual()})}function Ec(e,n){var t,r,o,u,i,c=e.dom,l=(l=ku(r=e),o=Pu(r),u=Eu(r),i=l?(i=r.dom,{borderstyle:le(o,"border-style").getOr(""),bordercolor:vc(i)(le(o,"border-color").getOr("")),backgroundcolor:vc(i)(le(o,"background-color").getOr(""))}):{},L(L(L(L(L(L({},{height:"",width:"100%",cellspacing:"",cellpadding:"",caption:!1,class:"",align:"",border:""}),o),u),i),(i=o["border-width"],Nu(r)&&i?{border:i}:le(u,"border").fold(function(){return{}},function(e){return{border:e}}))),(i=le(o,"border-spacing").or(le(u,"cellspacing")).fold(function(){return{}},function(e){return{cellspacing:e}}),u=le(o,"border-padding").or(le(u,"cellpadding")).fold(function(){return{}},function(e){return{cellpadding:e}}),L(L({},i),u))));!1===n?(t=c.getParent(e.selection.getStart(),"table"))?(f=t,o=ku(r=e),a=r.dom,l=L({width:a.getStyle(f,"width")||a.getAttrib(f,"width"),height:a.getStyle(f,"height")||a.getAttrib(f,"height"),cellspacing:a.getStyle(f,"border-spacing")||a.getAttrib(f,"cellspacing"),cellpadding:a.getAttrib(f,"cellpadding")||gc(r.dom,f,"padding"),border:(i=a,c=kn(Xe.fromDom(u=f),"border-width"),Nu(r)&&c.isSome()?c.getOr(""):i.getAttrib(u,"border")||gc(r.dom,u,"border-width")||gc(r.dom,u,"border")),caption:!!a.select("caption",f)[0],class:a.getAttrib(f,"class",""),align:Ia(r,f)},o?wc(a,f):{})):ku(e)&&(l.borderstyle="",l.bordercolor="",l.backgroundcolor=""):(l.cols="1",l.rows="1",ku(e)&&(l.borderstyle="",l.bordercolor="",l.backgroundcolor=""));var a=Pa(e.getParam("table_class_list",[],"array"));0<a.length&&l.class&&(l.class=l.class.replace(/\s*mce\-item\-table\s*/g,""));var f={type:"grid",columns:2,items:(f=a,a=n?[{type:"input",name:"cols",label:"Cols",inputMode:"numeric"},{type:"input",name:"rows",label:"Rows",inputMode:"numeric"}]:[],n=e.getParam("table_appearance_options",!0,"boolean")?[{type:"input",name:"cellspacing",label:"Cell spacing",inputMode:"numeric"},{type:"input",name:"cellpadding",label:"Cell padding",inputMode:"numeric"},{type:"input",name:"border",label:"Border width"},{type:"label",label:"Caption",items:[{type:"checkbox",name:"caption",label:"Show caption"}]}]:[],f=0<f.length?[{type:"listbox",name:"class",label:"Class",items:f}]:[],a.concat([{type:"input",name:"width",label:"Width"},{type:"input",name:"height",label:"Height"}]).concat(n).concat([{type:"listbox",name:"align",label:"Alignment",items:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]}]).concat(f))},f=ku(e)?{type:"tabpanel",tabs:[{title:"General",name:"general",items:[f]},xc("table")]}:{type:"panel",items:[f]};e.windowManager.open({title:"Table Properties",size:"normal",body:f,onSubmit:h(Bc,e,t),buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:l})}function Pc(e){return Aa(Gu(e))}function Ic(e){return Da(Gu(e))}function Mc(i,r,t,c,n){function l(e){return wt(e,d)}function u(n){return function(e){i.selection.setRng(e),i.focus(),t.clear(n),Vu(n),Du(i,n.dom)}}function o(r){return Ic(i).each(function(t){l(t).each(function(e){var n=cr(c,e,t);r(e,n).each(u(e))})})}function a(){return Ic(i).map(function(u){return l(u).bind(function(e){var t,r,n=cr(c,e,u),o=Sr(y,Xe.fromDom(i.getDoc()),I.none());return n=n,t=o,r=xt(e),Si(r,n).map(function(e){var n=wi(r,t,!1),e=mi(n).rows.slice(e[0].row,e[e.length-1].row+e[e.length-1].rowspan),e=yi(e,t);return S(e,function(e){var t=Xt(e.element);return C(e.cells,function(e){var n=Yt(e.element);pi(n,"colspan",e.colspan,1),pi(n,"rowspan",e.rowspan,1),It(t,n)}),t})})})})}function f(){return Ic(i).map(function(t){return l(t).bind(function(e){var o,n=cr(c,e,t);return n=n,o=xt(e),Si(o,n).map(function(e){var t,r,n=e[e.length-1],e=e[0].column,n=n.column+n.colspan;return H(function(e,n,t){if(At(e)){var r=T(Dt(e),function(e){return e.column>=n&&e.column<t}),e=S(r,function(e){e=Yt(e.element);return pc(e,"span",t-n),e}),r=Xe.fromTag("colgroup");return ct(r,e),[r]}return[]}(o,e,n),(t=e,r=n,S(o.all,function(e){var n=T(e.cells,function(e){return e.column>=t&&e.column<r}),e=S(n,function(e){e=Yt(e.element);return pc(e,"colspan",r-t),e}),n=Xe.fromTag("tr");return ct(n,e),n})))})})})}function s(o,e){return e().each(function(e){var r=S(e,Yt);Ic(i).each(function(e){return l(e).each(function(e){var n,t=rr(Xe.fromDom(i.getDoc())),t=(n=r,t=t,{selection:ur(c),clipboard:n,generators:t});o(e,t).each(u(e))})})})}var d=Yl(i);function m(n,e){e.each(function(e){Du(n,e.dom)})}ue({mceTableSplitCells:function(){return o(r.unmergeCells)},mceTableMergeCells:function(){return o(r.mergeCells)},mceTableInsertRowBefore:function(){return o(r.insertRowsBefore)},mceTableInsertRowAfter:function(){return o(r.insertRowsAfter)},mceTableInsertColBefore:function(){return o(r.insertColumnsBefore)},mceTableInsertColAfter:function(){return o(r.insertColumnsAfter)},mceTableDeleteCol:function(){return o(r.deleteColumn)},mceTableDeleteRow:function(){return o(r.deleteRow)},mceTableCutCol:function(e){return f().each(function(e){n.setColumns(e),o(r.deleteColumn)})},mceTableCutRow:function(e){return a().each(function(e){n.setRows(e),o(r.deleteRow)})},mceTableCopyCol:function(e){return f().each(function(e){return n.setColumns(e)})},mceTableCopyRow:function(e){return a().each(function(e){return n.setRows(e)})},mceTablePasteColBefore:function(e){return s(r.pasteColsBefore,n.getColumns)},mceTablePasteColAfter:function(e){return s(r.pasteColsAfter,n.getColumns)},mceTablePasteRowBefore:function(e){return s(r.pasteRowsBefore,n.getRows)},mceTablePasteRowAfter:function(e){return s(r.pasteRowsAfter,n.getRows)},mceTableDelete:function(){return Pc(i).each(function(e){wt(e,d).filter(g(d)).each(function(e){var n=Xe.fromText("");ot(e,n),Mt(e),i.dom.isEmpty(i.getBody())?(i.setContent(""),i.selection.setCursorLocation()):((e=i.dom.createRng()).setStart(n.dom,0),e.setEnd(n.dom,0),i.selection.setRng(e),i.nodeChanged())})})},mceTableSizingMode:function(e,n){return t=n,Pc(i).each(function(e){Gl(i)||$l(i)||_u(i)||wt(e,d).each(function(e){"relative"!==t||Oo(e)?"fixed"!==t||Do(e)?"responsive"!==t||Ao(e)||ni(e):ei(i,e):Zu(i,e),Vu(e),Du(i,e.dom)})});var t}},function(e,n){return i.addCommand(n,e)}),ue({mceTableCellType:function(e,n){var t=wt(Gu(i),d);r.setTableCellType(i,n),m(i,t)},mceTableRowType:function(e,n){var t=wt(Gu(i),d);r.setTableRowType(i,n),m(i,t)}},function(e,n){return i.addCommand(n,e)}),i.addCommand("mceTableColType",function(e,n){return le(n,"type").each(function(e){return o("th"===e?r.makeColumnsHeader:r.unmakeColumnsHeader)})}),ue({mceTableProps:h(Ec,i,!1),mceTableRowProps:h(Ac,i),mceTableCellProps:h(Rc,i,c)},function(e,n){return i.addCommand(n,function(){return e()})}),i.addCommand("mceInsertTable",function(e,n){k(n)&&0<Qe(n).length?sc(i,n.rows,n.columns,n.options,"Invalid values for mceInsertTable - rows and columns values are required to insert a table."):Ec(i,!0)}),i.addCommand("mceTableApplyCellStyle",function(e,n){function r(e){return"tablecell"+e.toLowerCase().replace("-","")}var o;!k(n)||0!==(o=uc(Gu(i),c)).length&&(function(e){for(var n in e)if(Ze.call(e,n))return;return 1}(n=ce(n,function(e,n){return i.formatter.has(r(n))&&M(e)}))||(ue(n,function(n,t){C(o,function(e){Na.normal(i,e.dom).setFormat(r(t),n)})}),l(o[0]).each(function(e){return Du(i,e.dom,{structure:!1,style:!0})})))})}function kc(){function n(e){e.set(I.none())}var t=Jl(I.none()),r=Jl(I.none());return{getRows:t.get,setRows:function(e){t.set(e),n(r)},clearRows:function(){return n(t)},getColumns:r.get,setColumns:function(e){r.set(e),n(t)},clearColumns:function(){return n(r)}}}function Nc(t,e){return wt(t,e).bind(function(e){var n=qn(e);return d(n,function(e){return Ye(t,e)}).map(function(e){return{index:e,all:n}})})}function _c(e,n,t,r){return{start:e,soffset:n,finish:t,foffset:r}}function zc(e,n,t){var r,o=e=e.document.createRange();return n.fold(function(e){o.setStartBefore(e.dom)},function(e,n){o.setStart(e.dom,n)},function(e){o.setStartAfter(e.dom)}),r=e,t.fold(function(e){r.setEndBefore(e.dom)},function(e,n){r.setEnd(e.dom,n)},function(e){r.setEndAfter(e.dom)}),e}function Wc(e,n,t,r,o){return(e=e.document.createRange()).setStart(n.dom,t),e.setEnd(r.dom,o),e}function jc(e){return{left:e.left,top:e.top,right:e.right,bottom:e.bottom,width:e.width,height:e.height}}function Fc(e,n,t){return n(Xe.fromDom(t.startContainer),t.startOffset,Xe.fromDom(t.endContainer),t.endOffset)}function Lc(e,n){var o,t,n=(o=e,n.match({domRange:function(e){return{ltr:p(e),rtl:I.none}},relative:function(e,n){return{ltr:q(function(){return zc(o,e,n)}),rtl:q(function(){return I.some(zc(o,n,e))})}},exact:function(e,n,t,r){return{ltr:q(function(){return Wc(o,e,n,t,r)}),rtl:q(function(){return I.some(Wc(o,t,r,e,n))})}}}));return(t=(n=n).ltr()).collapsed?n.rtl().filter(function(e){return!1===e.collapsed}).map(function(e){return Ua.rtl(Xe.fromDom(e.endContainer),e.endOffset,Xe.fromDom(e.startContainer),e.startOffset)}).getOrThunk(function(){return Fc(0,Ua.ltr,t)}):Fc(0,Ua.ltr,t)}function Hc(t,r,e,n,o){function l(e){var n=t.dom.createRange();return n.setStart(r.dom,e),n.collapse(!0),n}var u=ft(r).length,u=function(e,n,t,r){if(0===r)return 0;if(e===t)return r-1;for(var o=t,u=1;u<r;u++){var i=l(u).getBoundingClientRect(),c=Math.abs(e-i.left);if(n<=i.bottom){if(n<i.top||o<c)return u-1;o=c}}return 0}(e,n,o.right,u);return l(u)}function qc(e,n){return n-e.left<e.right-n}function Vc(e,n,t){return(e=e.dom.createRange()).selectNode(n.dom),e.collapse(t),e}function Uc(e,n){var t=rn(e);return"input"===t?Ha.after(e):x(["br","img"],t)?0===n?Ha.before(e):Ha.after(e):Ha.on(e,n)}function $c(e,n){return e=e.fold(Ha.before,Uc,Ha.after),n=n.fold(Ha.before,Uc,Ha.after),Va.relative(e,n)}function Gc(e,n,t,r){return n=Uc(e,n),r=Uc(t,r),Va.relative(n,r)}function Kc(e){return I.from(e.getSelection())}function Xc(e,n){Kc(e).each(function(e){e.removeAllRanges(),e.addRange(n)})}function Yc(e,n,t,r,o){o=Wc(e,n,t,r,o),Xc(e,o)}function Jc(l,e){return Lc(l,e).match({ltr:function(e,n,t,r){Yc(l,e,n,t,r)},rtl:function(o,u,i,c){Kc(l).each(function(e){if(e.setBaseAndExtent)e.setBaseAndExtent(o.dom,u,i.dom,c);else if(e.extend)try{t=i,r=c,(n=e).collapse(o.dom,u),n.extend(t.dom,r)}catch(e){Yc(l,i,c,o,u)}else Yc(l,i,c,o,u);var n,t,r})}})}function Qc(e,n,t,r,o){o=Gc(n,t,r,o),Jc(e,o)}function Zc(e,n,t){t=$c(n,t),Jc(e,t)}function el(e){function n(e,n,t,r){return Wc(o,e,n,t,r)}var o=Va.getWin(e).dom,e=e.match({domRange:function(e){var n=Xe.fromDom(e.startContainer),t=Xe.fromDom(e.endContainer);return Gc(n,e.startOffset,t,e.endOffset)},relative:$c,exact:Gc});return Lc(o,e).match({ltr:n,rtl:n})}function nl(e){if(0<e.rangeCount){var n=e.getRangeAt(0),e=e.getRangeAt(e.rangeCount-1);return I.some(_c(Xe.fromDom(n.startContainer),n.startOffset,Xe.fromDom(e.endContainer),e.endOffset))}return I.none()}function tl(e){if(null===e.anchorNode||null===e.focusNode)return nl(e);var n,t,r,o,u,i,c,l,a,f=Xe.fromDom(e.anchorNode),s=Xe.fromDom(e.focusNode);return n=f,t=e.anchorOffset,r=s,o=e.focusOffset,i=t,c=r,l=o,(a=ge(u=n).dom.createRange()).setStart(u.dom,i),a.setEnd(c.dom,l),a,o=Ye(n,r)&&t===o,a.collapsed&&!o?I.some(_c(f,e.anchorOffset,s,e.focusOffset)):nl(e)}function rl(e){return Kc(e).filter(function(e){return 0<e.rangeCount}).bind(tl).map(function(e){return Va.exact(e.start,e.soffset,e.finish,e.foffset)})}function ol(e,n){return n=Va.exact(n,0,n,0),el(n)}function ul(n,t,r){var o,u,e;n.keyCode===Ya.TAB&&(o=Xl(t),u=function(e){var n=rn(e);return Ye(e,o)||x(Qa,n)},(e=t.selection.getRng()).collapsed&&(e=Xe.fromDom(e.startContainer),Hn(e,u).each(function(e){n.preventDefault(),(n.shiftKey?function(e,n,t,r){return Ja(e,n,Nc(o=t,void 0).fold(function(){return La.none()},function(e){return 0<=e.index-1?La.middle(o,e.all[e.index-1]):La.first(o)}),r);var o}:function(e,n,t,r){return Ja(e,n,Nc(o=t,void 0).fold(function(){return La.none(o)},function(e){return e.index+1<e.all.length?La.middle(o,e.all[e.index+1]):La.last(o)}),r);var o})(t,u,e,r).each(function(e){t.selection.setRng(e)})})))}function il(e,n){return{selection:e,kill:n}}function cl(e,n,t,r){return{start:Ha.on(e,n),finish:Ha.on(t,r)}}function ll(e,n){return n=$a(e,n),_c(Xe.fromDom(n.startContainer),n.startOffset,Xe.fromDom(n.endContainer),n.endOffset)}function al(t,e,r,n,o){return Ye(r,n)?I.none():jt(r,n,e).bind(function(e){var n=e.boxes.getOr([]);return 0<n.length?(o(t,n,e.start,e.finish),I.some(il(I.some(Za(r,0,r,$t(r))),!0))):I.none()})}function fl(e,n){return{item:e,mode:n}}function sl(n){return function(e){return 0===n.property().children(e).length}}function dl(e,n,t,r){return of(e,n,t,ef,{sibling:function(e,n){return e.query().prevSibling(n)},first:function(e){return 0<e.length?I.some(e[e.length-1]):I.none()}},r)}function ml(e,n,t,r){return of(e,n,t,ef,{sibling:function(e,n){return e.query().nextSibling(n)},first:function(e){return 0<e.length?I.some(e[0]):I.none()}},r)}function pl(e){return xn(e,"tr")}function gl(e){return"br"===rn(e)}function hl(n,e,t,r){return Se(o=e,u=t).filter(gl).orThunk(function(){return Se(o,u-1).filter(gl)}).bind(function(e){return r.traverse(e).fold(function(){return af(e,r.gather,n).map(r.relative)},function(e){return be(r=e).bind(function(n){var t=xe(n);return d(t,h(Ye,r)).map(function(e){return{parent:n,children:t,element:r,index:e}})}).map(function(e){return Ha.on(e.parent,e.index)});var r})});var o,u}function bl(e,n){return{left:e.left,top:e.top+n,right:e.right,bottom:e.bottom+n}}function vl(e,n){return{left:e.left,top:e.top-n,right:e.right,bottom:e.bottom-n}}function wl(e,n,t){return{left:e.left+n,top:e.top+t,right:e.right+n,bottom:e.bottom+t}}function yl(e){return{left:e.left,top:e.top,right:e.right,bottom:e.bottom}}function xl(e,n){return I.some(e.getRect(n))}function Sl(e,n,t){return un(n)?xl(e,n).map(yl):cn(n)?(e=e,n=n,(0<=(t=t)&&t<$t(n)?e.getRangedRect(n,t,n,t+1):0<t?e.getRangedRect(n,t-1,n,t):I.none()).map(yl)):I.none()}function Cl(e,n){return un(n)?xl(e,n).map(yl):cn(n)?e.getRangedRect(n,0,n,$t(n)).map(yl):I.none()}function Tl(n,e,t){return hn(function(e,n){return n(e)},bn,e,Li,void 0).fold(A,function(e){return Cl(n,e).exists(function(e){return(n=t).left<(e=e).left||Math.abs(e.right-n.left)<1||n.left>e.right;var n})})}function Rl(l,a,f){return l.getSelection().bind(function(n){return e=a,t=n.finish,r=n.foffset,o=f,(gl(t)?(u=e,(c=o).traverse(i=t).orThunk(function(){return af(i,c.gather,u)}).map(c.relative)):hl(e,t,r,o)).map(function(e){return{start:e,finish:e}}).fold(function(){return I.some(oi(n.finish,n.foffset))},function(e){e=l.fromSitus(e),e=lf.verify(l,n.finish,n.foffset,e.finish,e.foffset,f.failure,a);return lf.cata(e,function(e){return I.none()},function(){return I.none()},function(e){return I.some(oi(e,0))},function(e){return I.some(oi(e,$t(e)))})});var e,t,r,o,u,i,c})}function Ol(i,c,l,e,a){return xn(e,"td,th",c).bind(function(u){return xn(u,"table",c).bind(function(e){return n=e,bn(a,function(e){return be(e).exists(function(e){return Ye(e,n)})},void 0).isSome()?Rl(t=i,r=c,o=l).bind(function(e){return mf(t,r,e.element,e.offset,o,20).map(t.fromSitus)}).bind(function(n){return xn(n.finish,"td,th",c).map(function(e){return{start:u,finish:e,range:n}})}):I.none();var n,t,r,o})})}function Dl(e,n,t,r,o,u){return Ke().browser.isIE()?I.none():u(r,n).orThunk(function(){return Ol(e,n,t,r,o).map(function(e){e=e.range;return il(I.some(Za(e.start,e.soffset,e.finish,e.foffset)),!0)})})}function Al(e,r){return xn(e,"tr",r).bind(function(t){return xn(t,"table",r).bind(function(e){var n=De(e,"tr");return Ye(t,n[0])?dl(uf,e,function(e){return wr(e).isSome()},r).map(function(e){var n=$t(e);return il(I.some(Za(e,n,e,n)),!0)}):I.none()})})}function Bl(e,r){return xn(e,"tr",r).bind(function(t){return xn(t,"table",r).bind(function(e){var n=De(e,"tr");return Ye(t,n[n.length-1])?ml(uf,e,function(e){return vr(e).isSome()},r).map(function(e){return il(I.some(Za(e,0,e,0)),!0)}):I.none()})})}function El(e,n,t,r,o,u,i){return Ol(e,t,r,o,u).bind(function(e){return al(n,t,e.start,e.finish,i)})}function Pl(e,n){return xn(e,"td,th",n)}var Il=function(e,n,t,r){e.dom.removeEventListener(n,t,r)},Ml=B,kl=au,r=function(e){var n=e.replace(/\./g,"-");return{resolve:function(e){return n+"-"+e}}},Nl=r("ephox-dragster").resolve,_l=e({compare:function(e,n){return jo(n.left-e.left,n.top-e.top)},extract:function(e){return I.some(jo(e.x,e.y))},sink:function(e,n){var t,r=(n=n,n=L({layerClass:Nl("blocker")},n),t=Xe.fromTag("div"),Cn(t,"role","presentation"),In(t,{position:"fixed",left:"0px",top:"0px",width:"100%",height:"100%"}),mu(t,Nl("blocker")),mu(t,n.layerClass),{element:function(){return t},destroy:function(){Mt(t)}}),o=fu(r.element(),"mousedown",e.forceDrop),u=fu(r.element(),"mouseup",e.drop),i=fu(r.element(),"mousemove",e.move),c=fu(r.element(),"mouseout",e.delayDrop);return uu({element:r.element,start:function(e){It(e,r.element())},stop:function(){Mt(r.element())},destroy:function(){r.destroy(),u.unbind(),i.unbind(),c.unbind(),o.unbind()}})},mutate:function(e,n){e.mutate(n.left,n.top)}}),ke=r("ephox-snooker").resolve,zl=ke("resizer-bar"),Wl=ke("resizer-rows"),jl=ke("resizer-cols"),Fl=ke("resizer-bar-dragging"),Ll=function(e,n,t,r,o){e.fire("TableSelectionChange",{cells:n,start:t,finish:r,otherCells:o})},Hl=function(e){e.fire("TableSelectionClear")},ql={"border-collapse":"collapse",width:"100%"},Vl={border:"1"},Ul="preservetable",$l=function(e){return"fixed"===Au(e)||!1===Bu(e)},Gl=function(e){return"responsive"===Au(e)},Kl=function(e){e=e.getParam("table_clone_elements");return M(e)?I.some(e.split(/[ ,]/)):Array.isArray(e)?I.some(e):I.none()},Xl=function(e){return Xe.fromDom(e.getBody())},Yl=function(n){return function(e){return Ye(e,Xl(n))}},Jl=function(e){var n=e;return{get:function(){return n},set:function(e){n=e}}},Ql=Xu,Zl=Ku,ea="bar-",na=function(n,e,t){return n.property().isText(e)&&0===n.property().getText(e).trim().length||n.property().isComment(e)?t(e).bind(function(e){return na(n,e,t).orThunk(function(){return I.some(e)})}):I.none()},ta=function(e,n){var t=na(e,n,e.query().prevSibling).getOr(n);if(e.property().isText(t))return oi(t,ui(e,t));n=e.property().children(t);return 0<n.length?ta(e,n[n.length-1]):oi(t,ui(e,t))},ra=ta,oa=_t(),Ne=function(c,n,l,a,f){return function(r,o,e,t,u){var i=xt(o);return n(i,e).map(function(e){var n=wi(i,t,!1),e=c(n,e,Ye,f(t));return{grid:yi(e.grid,t),cursor:e.cursor}}).fold(function(){return I.none()},function(e){var n=hi(o,e.grid),t=I.from(u).getOrThunk(function(){return Yu(o)});return l(o,e.grid,t),a(o),wu(r,o),I.some({cursor:e.cursor,newRows:n.newRows,newCells:n.newCells})})}},Me=function(n,e){return Hn(e.element).bind(function(e){return xi(n,e)})},_e=function(n,e){var t=S(e.selection,function(e){return Hn(e).bind(function(e){return xi(n,e)})}),t=lr(t);return 0<t.length?I.some({cells:t,generators:e.generators,clipboard:e.clipboard}):I.none()},ua=function(t){return{is:function(e){return t===e},isValue:B,isError:A,getOr:p(t),getOrThunk:p(t),getOrDie:p(t),or:function(e){return ua(t)},orThunk:function(e){return ua(t)},fold:function(e,n){return n(t)},map:function(e){return ua(e(t))},mapError:function(e){return ua(t)},each:function(e){e(t)},bind:function(e){return e(t)},exists:function(e){return e(t)},forall:function(e){return e(t)},toOptional:function(){return I.some(t)}}},ia=function(t){return{is:A,isValue:A,isError:B,getOr:a,getOrThunk:function(e){return e()},getOrDie:function(){return e=String(t),function(){throw new Error(e)}();var e},or:function(e){return e},orThunk:function(e){return e()},fold:function(e,n){return e(t)},map:function(e){return ia(t)},mapError:function(e){return ia(e(t))},each:y,bind:function(e){return ia(t)},exists:A,forall:B,toOptional:I.none}},ca={value:ua,error:ia,fromOption:function(e,n){return e.fold(function(){return ia(n)},ua)}},la=fn(["cell","row","replace","gap","col","colgroup"]),on=function(t,r){void 0===r&&(r=Fi),la(t);function o(e){var n=(n=r(n=e),"col"!==rn(n.element)?t.cell(n):t.col(n));return u.get().isNone()&&u.set(I.some(n)),i=I.some({item:e,replacement:n}),n}var u=Jl(I.none()),i=I.none();return{getOrInit:function(n,t){return i.fold(function(){return o(n)},function(e){return t(n,e.item)?e.replacement:o(n)})},cursor:u.get}},e=function(o,c){return function(t){var r=Jl(I.none());la(t);function u(e){var n=t.replace(e,c,{scope:o});return i.push({item:e,sub:n}),r.get().isNone()&&r.set(I.some(n)),n}var i=[];return{replaceOrInit:function(n,t){return r=n,o=t,f(i,function(e){return o(e.item,r)}).fold(function(){return u(n)},function(e){return t(n,e.item)?e.sub:u(n)});var r,o},cursor:r.get}}},r=function(t){la(t);var e=Jl(I.none());return{combine:function(n){return e.get().isNone()&&e.set(I.some(n)),function(){var e=t.cell({element:n,colspan:1,rowspan:1});return Nn(e,"width"),Nn(n,"width"),e}},cursor:e.get}},aa=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","table","thead","tfoot","tbody","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"],fa=_t(),ke=function(e){0===qn(e).length&&Mt(e)},sa=function(e,n,t){return I.from(e[n]).bind(function(e){return I.from(e.cells[t]).bind(function(e){return I.from(e.element)})})},fn=function(e,n,t){var r=St(n),n=t.getWidths(r,t);go(r,n,t)},da=Ne(function(e,n,t,r){var o=n[0].row,u=n[0].row,i=Gi(n),e=b(i,function(e,n){return Mi(e,u,o,t,r.getOrInit)},e);return $i(e,u,n[0].column)},Si,y,y,on),ma=Ne(function(e,n,t,r){var o=Gi(n),u=o[o.length-1].row,i=o[o.length-1].row+o[o.length-1].rowspan,e=b(o,function(e,n){return Mi(e,i,u,t,r.getOrInit)},e);return $i(e,i,n[0].column)},Si,y,y,on),pa=Ne(function(e,n,t,r){var o=Ki(n),u=o[0].column,i=o[0].column,e=b(o,function(e,n){return ki(e,i,u,t,r.getOrInit)},e);return $i(e,n[0].row,i)},Si,fn,y,on),ga=Ne(function(e,n,t,r){var o=n[n.length-1].column,u=n[n.length-1].column+n[n.length-1].colspan,i=Ki(n),e=b(i,function(e,n){return ki(e,u,o,t,r.getOrInit)},e);return $i(e,n[0].row,u)},Si,fn,y,on),ha=Ne(function(e,n,t,r){var o,u,i=Ki(n),e=(o=i[0].column,u=i[i.length-1].column,e=S(e,function(e){var n=e.cells.slice(0,o).concat(e.cells.slice(u+1));return de(n,e.section)}),T(e,function(e){return 0<e.cells.length})),n=Ui(e,n[0].row,n[0].column);return Vi(e,n)},Si,fn,ke,on),ba=Ne(function(e,n,t,r){var o,u=Gi(n),i=(o=u[0].row,i=u[u.length-1].row,e=(u=mi(e)).rows,u.cols.concat(e.slice(0,o)).concat(e.slice(i+1))),n=Ui(i,n[0].row,n[0].column);return Vi(i,n)},Si,y,ke,on),va=(Ne(function(e,n,t,r){r=Wi(e,n.column,t,r.replaceOrInit);return $i(r,n.row,n.column)},Me,y,y,e("row","th")),Ne(function(e,n,t,r){var o=Ki(n),e=b(o,function(e,n){return Wi(e,n.column,t,r.replaceOrInit)},e);return $i(e,n[0].row,n[0].column)},Si,y,y,e("row","th"))),wa=(Ne(function(e,n,t,r){r=Wi(e,n.column,t,r.replaceOrInit);return $i(r,n.row,n.column)},Me,y,y,e(null,"td")),Ne(function(e,n,t,r){var o=Ki(n),e=b(o,function(e,n){return Wi(e,n.column,t,r.replaceOrInit)},e);return $i(e,n[0].row,n[0].column)},Si,y,y,e(null,"td"))),ya=(Ne(function(e,n,t,r){r=ji(e,n.row,t,r.replaceOrInit);return $i(r,n.row,n.column)},Me,y,y,e("col","th")),Ne(function(e,n,t,r){var o=Gi(n),e=b(o,function(e,n){return ji(e,n.row,t,r.replaceOrInit)},e);return $i(e,n[0].row,n[0].column)},Si,y,y,e("col","th")),Ne(function(e,n,t,r){r=ji(e,n.row,t,r.replaceOrInit);return $i(r,n.row,n.column)},Me,y,y,e(null,"td")),Ne(function(e,n,t,r){var o=Gi(n),e=b(o,function(e,n){return ji(e,n.row,t,r.replaceOrInit)},e);return $i(e,n[0].row,n[0].column)},Si,y,y,e(null,"td")),Ne(function(e,n,t,r){var o=n.cells;qi(o);n=function(e,n,t){var r=mi(e).rows;if(0===r.length)return e;for(var o=n.startRow;o<=n.finishRow;o++)for(var u=n.startCol;u<=n.finishCol;u++)ci(r[o],u,se(t(),!1));return e}(e,n.bounds,p(o[0]));return Vi(n,I.from(o[0]))},function(e,n){return n.mergable},y,y,r)),xa=Ne(function(e,n,t,r){e=s(n,function(e,n){return Ci(e,n,t,r.combine(n))},e);return Vi(e,I.from(n[0]))},function(e,n){return n.unmergable},fn,y,r),Sa=Ne(function(e,t,n,r){var o=(o=t.clipboard,u=t.generators,o=xt(o),wi(o,u,!0)),u={row:t.row,column:t.column};return Ei(u,e,o,t.generators,n).fold(function(){return Vi(e,I.some(t.element))},function(e){var n=Ui(e,t.row,t.column);return Vi(e,n)})},function(n,t){return Hn(t.element).bind(function(e){return xi(n,e).map(function(e){return L(L({},e),{generators:t.generators,clipboard:t.clipboard})})})},fn,y,on),Ca=Ne(function(e,n,t,r){var o=mi(e).rows,u=n.cells[0].column,o=o[n.cells[0].row],o=Xi(n.clipboard,n.generators,o),t=Pi(u,e,o,n.generators,t),n=Ui(t,n.cells[0].row,n.cells[0].column);return Vi(t,n)},_e,y,y,on),Ta=Ne(function(e,n,t,r){var o=mi(e).rows,u=n.cells[n.cells.length-1].column+n.cells[n.cells.length-1].colspan,o=o[n.cells[0].row],o=Xi(n.clipboard,n.generators,o),t=Pi(u,e,o,n.generators,t),n=Ui(t,n.cells[0].row,n.cells[0].column);return Vi(t,n)},_e,y,y,on),Ra=Ne(function(e,n,t,r){var o=mi(e).rows,u=n.cells[0].row,o=o[u],o=Xi(n.clipboard,n.generators,o),t=Ii(u,e,o,n.generators,t),n=Ui(t,n.cells[0].row,n.cells[0].column);return Vi(t,n)},_e,y,y,on),Oa=Ne(function(e,n,t,r){var o=mi(e).rows,u=n.cells[n.cells.length-1].row+n.cells[n.cells.length-1].rowspan,o=o[n.cells[0].row],o=Xi(n.clipboard,n.generators,o),t=Ii(u,e,o,n.generators,t),n=Ui(t,n.cells[0].row,n.cells[0].column);return Vi(t,n)},_e,y,y,on),Ne=function(r){return function(e){var n,t=rn(e),e="col"===t||"colgroup"===t?wt(n=e).bind(function(e){return dr(e,Cr.firstSelectedSelector)}).fold(function(){return n},function(e){return e[0]}):e;return xn(e,r)}},Da=Ne("th,td"),Aa=Ne("th,td,caption"),Ba={styles:{"border-collapse":"collapse",width:"100%"},attributes:{border:"1"},colGroups:!1},Ea=tinymce.util.Tools.resolve("tinymce.util.Tools"),Pa=function(e,n){return(n||[]).concat(S(e,function(e){var n,t=e.text||e.title;return nn(n=n=e,"menu")&&void 0!==n.menu&&null!==n.menu?{text:t,items:Pa(e.menu)}:{text:t,value:e.value}}))},_e=function(e,n,t,r){return f(e,function(e){return t.formatter.matchNode(r,n+e)}).getOr("")},Ia=h(_e,["left","center","right"],"align"),Ma=h(_e,["top","middle","bottom"],"valign"),ka=[{name:"width",type:"input",label:"Width"},{name:"height",type:"input",label:"Height"},{name:"celltype",type:"listbox",label:"Cell type",items:[{text:"Cell",value:"td"},{text:"Header cell",value:"th"}]},{name:"scope",type:"listbox",label:"Scope",items:[{text:"None",value:""},{text:"Row",value:"row"},{text:"Column",value:"col"},{text:"Row group",value:"rowgroup"},{text:"Column group",value:"colgroup"}]},{name:"halign",type:"listbox",label:"H Align",items:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},{name:"valign",type:"listbox",label:"V Align",items:[{text:"None",value:""},{text:"Top",value:"top"},{text:"Middle",value:"middle"},{text:"Bottom",value:"bottom"}]}],on=function(u){return function(t,r){var o=t.dom;return{setAttrib:function(e,n){u&&!n||o.setAttrib(r,e,n)},setStyle:function(e,n){u&&!n||o.setStyle(r,e,n)},setFormat:function(e,n){u&&!n||(""===n?t.formatter.remove(e,{value:null},r,!0):t.formatter.apply(e,{value:n},r))}}}},Na={normal:on(!1),ifTruthy:on(!0)},_a=[{type:"listbox",name:"type",label:"Row type",items:[{text:"Header",value:"header"},{text:"Body",value:"body"},{text:"Footer",value:"footer"}]},{type:"listbox",name:"align",label:"Alignment",items:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},{label:"Height",name:"height",type:"input"}],za=tinymce.util.Tools.resolve("tinymce.Env"),Wa=function(e,n,t,r){if("TD"===n.tagName||"TH"===n.tagName)M(t)?e.setStyle(n,t,r):e.setStyle(n,t);else if(n.children)for(var o=0;o<n.children.length;o++)Wa(e,n.children[o],t,r)},ja={tablecellbackgroundcolor:{selector:"td,th",styles:{backgroundColor:"%value"},remove_similar:!0},tablecellbordercolor:{selector:"td,th",styles:{borderColor:"%value"},remove_similar:!0},tablecellborderstyle:{selector:"td,th",styles:{borderStyle:"%value"},remove_similar:!0},tablecellborderwidth:{selector:"td,th",styles:{borderWidth:"%value"},remove_similar:!0}},Fa=mr([{none:["current"]},{first:["current"]},{middle:["current","target"]},{last:["current"]}]),La=L(L({},Fa),{none:function(e){return Fa.none(e=void 0===e?void 0:e)}}),Ne=mr([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),Ha={before:Ne.before,on:Ne.on,after:Ne.after,cata:function(e,n,t,r){return e.fold(n,t,r)},getStart:function(e){return e.fold(a,a,a)}},qa=mr([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),Va={domRange:qa.domRange,relative:qa.relative,exact:qa.exact,exactFromRange:function(e){return qa.exact(e.start,e.soffset,e.finish,e.foffset)},getWin:function(e){e=e.match({domRange:function(e){return Xe.fromDom(e.startContainer)},relative:function(e,n){return Ha.getStart(e)},exact:function(e,n,t,r){return e}});return Xe.fromDom(he(e).dom.defaultView)},range:_c},Ua=mr([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]),$a=function(u,e){return Lc(u,e).match({ltr:function(e,n,t,r){var o=u.document.createRange();return o.setStart(e.dom,n),o.setEnd(t.dom,r),o},rtl:function(e,n,t,r){var o=u.document.createRange();return o.setStart(t.dom,r),o.setEnd(e.dom,n),o}})},Ga=(Ua.ltr,Ua.rtl,function(e,n,t){return n>=e.left&&n<=e.right&&t>=e.top&&t<=e.bottom}),Ka=function(e,n,t,r){return cn(n)?function(n,t,r,o){var e=n.dom.createRange();e.selectNode(t.dom);e=e.getClientRects();return D(e,function(e){return Ga(e,r,o)?I.some(e):I.none()}).map(function(e){return Hc(n,t,r,o,e)})}(e,n,t,r):(n=n,u=t,i=r,c=(o=e).dom.createRange(),n=xe(n),D(n,function(e){return c.selectNode(e.dom),Ga(c.getBoundingClientRect(),u,i)?Ka(o,e,u,i):I.none()}));var o,u,i,c},Xa=document.caretPositionFromPoint?function(t,e,n){return I.from(t.dom.caretPositionFromPoint(e,n)).bind(function(e){if(null===e.offsetNode)return I.none();var n=t.dom.createRange();return n.setStart(e.offsetNode,e.offset),n.collapse(),I.some(n)})}:document.caretRangeFromPoint?function(e,n,t){return I.from(e.dom.caretRangeFromPoint(n,t))}:function(o,u,n){return Xe.fromPoint(o,u,n).bind(function(r){function e(){return e=o,t=u,(0===xe(n=r).length?function(e,n,t){var r=n.dom.getBoundingClientRect(),t=qc(r,t);return I.some(Vc(e,n,t))}:function(n,e,t){var r=n.dom.createRange();r.selectNode(e.dom);var r=r.getBoundingClientRect(),o=qc(r,t);return(!0===o?vr:wr)(e).map(function(e){return Vc(n,e,o)})})(e,n,t);var e,n,t}return 0===xe(r).length?e():function(e,n,t,r){var o=e.dom.createRange();o.selectNode(n.dom);o=o.getBoundingClientRect();return function(e,n,t,r){var o=e.dom.createRange();o.selectNode(n.dom);o=o.getBoundingClientRect(),t=Math.max(o.left,Math.min(o.right,t)),r=Math.max(o.top,Math.min(o.bottom,r));return Ka(e,n,t,r)}(e,n,Math.max(o.left,Math.min(o.right,t)),Math.max(o.top,Math.min(o.bottom,r)))}(o,r,u,n).orThunk(e)})},Ya=tinymce.util.Tools.resolve("tinymce.util.VK"),Ja=function(o,e,n,u){return n.fold(I.none,I.none,function(e,n){return vr(n).map(function(e){return ol(0,e)})},function(r){return wt(r,e).bind(function(e){var n,t=ir(r);return o.undoManager.transact(function(){u.insertRowsAfter(e,t)}),n=De(e,"tr"),m(n).bind(function(e){return yn(e,"td,th").map(function(e){return ol(0,e)})})})})},Qa=["table","li","dl"],Za=cl,_e=function(e,n,t,r){return void 0===r&&(r=ef),e.property().parent(n).map(function(e){return fl(e,r)})},ef=function(e,n,t,r){return void 0===r&&(r=nf),t.sibling(e,n).map(function(e){return fl(e,r)})},nf=function(e,n,t,r){void 0===r&&(r=nf);n=e.property().children(n);return t.first(n).map(function(e){return fl(e,r)})},tf=[{current:_e,next:ef,fallback:I.none()},{current:ef,next:nf,fallback:I.some(_e)},{current:nf,next:nf,fallback:I.some(ef)}],rf=function(n,t,r,o,e){return f(e=void 0===e?tf:e,function(e){return e.current===r}).bind(function(e){return e.current(n,t,o,e.next).orThunk(function(){return e.fallback.bind(function(e){return rf(n,t,e,o)})})})},of=function(n,e,t,r,o,u){return rf(n,e,r,o).bind(function(e){return u(e.item)?I.none():t(e.item)?I.some(e.item):of(n,e.item,t,e.mode,o,u)})},uf=_t(),on=function(e,n){return dl(uf,e,sl(uf),n)},Ne=function(e,n){return ml(uf,e,sl(uf),n)},cf=mr([{none:["message"]},{success:[]},{failedUp:["cell"]},{failedDown:["cell"]}]),lf=L(L({},cf),{verify:function(u,e,n,t,i,c,r){return xn(t,"td,th",r).bind(function(o){return xn(e,"td,th",r).map(function(r){return Ye(o,r)?Ye(t,o)&&$t(o)===i?c(r):cf.none("in same cell"):sr(pl,[o,r]).fold(function(){return t=o,n=(e=u).getRect(r),(t=e.getRect(t)).right>n.left&&t.left<n.right?cf.success():c(r);var e,n,t},function(e){return c(r)})})}).getOr(cf.none("default"))},cata:function(e,n,t,r,o){return e.fold(n,t,r,o)}}),af=function(e,n,t){return n(e,t).bind(function(e){return cn(e)&&0===ft(e).trim().length?af(e,n,t):I.some(e)})},ff=mr([{none:[]},{retry:["caret"]}]),_e={point:function(e){return e.bottom},adjuster:function(e,n,t,r,o){var u=bl(o,5);return Math.abs(t.bottom-r.bottom)<1||t.top>o.bottom?ff.retry(u):t.top===o.bottom?ff.retry(bl(o,1)):Tl(e,n,o)?ff.retry(wl(u,5,0)):ff.none()},move:bl,gather:Ne},sf=function(t,r,o,u,i){return 0===i?I.some(u):(e=t,n=u.left,c=r.point(u),e.elementFromPoint(n,c).filter(function(e){return"table"===rn(e)}).isSome()?(c=i-1,sf(t,r,o,r.move(u,5),c)):t.situsFromPoint(u.left,r.point(u)).bind(function(e){return e.start.fold(I.none,function(n){return Cl(t,n).bind(function(e){return r.adjuster(t,n,e,o,u).fold(I.none,function(e){return sf(t,r,o,e,i-1)})}).orThunk(function(){return I.some(u)})},I.none)}));var e,n,c},mr=function(n,t,e){var r=n.move(e,5),o=sf(t,n,e,r,100).getOr(r),u=o,e=t;return((r=n).point(u)>e.getInnerHeight()?I.some(r.point(u)-e.getInnerHeight()):r.point(u)<0?I.some(-r.point(u)):I.none()).fold(function(){return t.situsFromPoint(o.left,n.point(o))},function(e){return t.scrollBy(0,e),t.situsFromPoint(o.left,n.point(o)-e)})},df={tryUp:h(mr,{point:function(e){return e.top},adjuster:function(e,n,t,r,o){var u=vl(o,5);return Math.abs(t.top-r.top)<1||t.bottom<o.top?ff.retry(u):t.bottom===o.top?ff.retry(vl(o,1)):Tl(e,n,o)?ff.retry(wl(u,5,0)):ff.none()},move:vl,gather:on}),tryDown:h(mr,_e),ieTryUp:function(e,n){return e.situsFromPoint(n.left,n.top-5)},ieTryDown:function(e,n){return e.situsFromPoint(n.left,n.bottom+5)},getJumpSize:p(5)},mf=function(t,r,o,u,i,c){return 0===c?I.none():hf(t,r,o,u,i).bind(function(e){var n=t.fromSitus(e),n=lf.verify(t,o,u,n.finish,n.foffset,i.failure,r);return lf.cata(n,function(){return I.none()},function(){return I.some(e)},function(e){return Ye(o,e)&&0===u?pf(t,o,u,vl,i):mf(t,r,e,0,i,c-1)},function(e){return Ye(o,e)&&u===$t(e)?pf(t,o,u,bl,i):mf(t,r,e,$t(e),i,c-1)})})},pf=function(n,e,t,r,o){return Sl(n,e,t).bind(function(e){return gf(n,o,r(e,df.getJumpSize()))})},gf=function(e,n,t){var r=Ke().browser;return r.isChrome()||r.isSafari()||r.isFirefox()||r.isEdge()?n.otherRetry(e,t):r.isIE()?n.ieRetry(e,t):I.none()},hf=function(n,e,t,r,o){return Sl(n,t,r).bind(function(e){return gf(n,o,e)})};function bf(u){return{elementFromPoint:function(e,n){return Xe.fromPoint(Xe.fromDom(u.document),e,n)},getRect:function(e){return e.dom.getBoundingClientRect()},getRangedRect:function(e,n,t,r){r=Va.exact(e,n,t,r);return function(e,n){n=(e=$a(e,n)).getClientRects();return 0<(e=0<n.length?n[0]:e.getBoundingClientRect()).width||0<e.height?I.some(e).map(jc):I.none()}(u,r)},getSelection:function(){return rl(u).map(function(e){return ll(u,e)})},fromSitus:function(e){e=Va.relative(e.start,e.finish);return ll(u,e)},situsFromPoint:function(e,n){return t=u,e=e=e,n=n=n,t=Xe.fromDom(u.document),Xa(t,e,n).map(function(e){return _c(Xe.fromDom(e.startContainer),e.startOffset,Xe.fromDom(e.endContainer),e.endOffset)}).map(function(e){return cl(e.start,e.soffset,e.finish,e.foffset)});var t},clearSelection:function(){Kc(u).each(function(e){return e.removeAllRanges()})},collapseSelection:function(o){void 0===o&&(o=!1),rl(u).each(function(e){return e.fold(function(e){return e.collapse(o)},function(e,n){n=o?e:n;Zc(u,n,n)},function(e,n,t,r){t=o?e:t,r=o?n:r;Qc(u,t,r,t,r)})})},setSelection:function(e){Qc(u,e.start,e.soffset,e.finish,e.foffset)},setRelativeSelection:function(e,n){Zc(u,e,n)},selectContents:function(e){var n,t;t=n=e,(n=(e=u).document.createRange()).selectNodeContents(t.dom),Xc(e,n)},getInnerHeight:function(){return u.innerHeight},getScrollY:function(){var e=Xe.fromDom(u.document),n=void 0!==e?e.dom:document,e=n.body.scrollLeft||n.documentElement.scrollLeft,n=n.body.scrollTop||n.documentElement.scrollTop;return jo(e,n).top},scrollBy:function(e,n){var t=e,e=n,n=Xe.fromDom(u.document);(n=(void 0!==n?n.dom:document).defaultView)&&n.scrollBy(t,e)}}}function vf(e,n){return{rows:e,cols:n}}function wf(o,e){C(e,function(e){var n,t,r=e;du(n=o)?n.dom.classList.remove(r):(t=e=r,0<(r=T(su(e=r=n,"class"),function(e){return e!==t})).length?Cn(e,"class",r.join(" ")):Dn(e,"class")),0===(du(n=n)?n.dom.classList:su(n,"class")).length&&Dn(n,"class")})}var yf={traverse:ye,gather:Ne,relative:Ha.before,otherRetry:df.tryDown,ieRetry:df.ieTryDown,failure:lf.failedDown},xf={traverse:we,gather:on,relative:Ha.before,otherRetry:df.tryUp,ieRetry:df.ieTryUp,failure:lf.failedUp},on=function(n){return function(e){return e===n}},Sf=on(38),Cf=on(40),Tf=function(e){return 37<=e&&e<=40},Rf={isBackward:on(37),isForward:on(39)},Of={isBackward:on(39),isForward:on(37)},Df=function(e,n,t,r){var o,u,i,c,l,a,f,r=(o=bf(e),u=n,i=t,c=r,l=Jl(I.none()),{clearstate:f=(a={clear:function(){return l.set(I.none())},set:function(e){return l.set(I.some(e))},isSet:function(){return l.get().isSome()},on:function(e){return l.get().each(e)}}).clear,mousedown:function(e){c.clear(u),Pl(e.target,i).each(a.set)},mouseover:function(e){a.on(function(r){c.clearBeforeUpdate(u),Pl(e.target,i).each(function(t){jt(r,t,i).each(function(e){var n=e.boxes.getOr([]);(1<n.length||1===n.length&&!Ye(r,t))&&(c.selectRange(u,n,e.start,e.finish),o.selectContents(t))})})})},mouseup:function(e){f()}});return{clearstate:r.clearstate,mousedown:r.mousedown,mouseover:r.mouseover,mouseup:r.mouseup}},Af=function(e,d,m,p){function l(){return p.clear(d),I.none()}var a=bf(e);return{keydown:function(e,n,t,r,o,u){var e=e.raw,i=e.which,c=!0===e.shiftKey;return Ft(d,p.selectedSelector).fold(function(){return Cf(i)&&c?h(El,a,d,m,yf,r,n,p.selectRange):Sf(i)&&c?h(El,a,d,m,xf,r,n,p.selectRange):Cf(i)?h(Dl,a,m,yf,r,n,Bl):Sf(i)?h(Dl,a,m,xf,r,n,Al):I.none},function(o){function e(e){return function(){return D(e,function(e){return n=e.rows,e=e.cols,t=d,Ht(o,n,e,(r=p).firstSelectedSelector,r.lastSelectedSelector).map(function(e){return r.clearBeforeUpdate(t),r.selectRange(t,e.boxes,e.start,e.finish),e.boxes});var n,t,r}).fold(function(){return Lt(d,p.firstSelectedSelector,p.lastSelectedSelector).map(function(e){var n=Cf(i)||u.isForward(i)?Ha.after:Ha.before;return a.setRelativeSelection(Ha.on(e.first,0),n(e.table)),p.clear(d),il(I.none(),!0)})},function(e){return I.some(il(I.none(),!0))})}}return Cf(i)&&c?e([vf(1,0)]):Sf(i)&&c?e([vf(-1,0)]):u.isBackward(i)&&c?e([vf(0,-1),vf(-1,0)]):u.isForward(i)&&c?e([vf(0,1),vf(1,0)]):Tf(i)&&0==c?l:I.none})()},keyup:function(c,l,a,f,s){return Ft(d,p.selectedSelector).fold(function(){var t,r,e,o,u,n=c.raw,i=n.which;return 0!=(!0===n.shiftKey)&&Tf(i)?(t=d,r=m,e=a,n=s,u=p.selectRange,Ye(i=l,o=f)&&e===n?I.none():xn(i,"td,th",r).bind(function(n){return xn(o,"td,th",r).bind(function(e){return al(t,r,n,e,u)})})):I.none()},I.none)}}},Bf=function(e,r,n,o){var u=bf(e);return function(e,t){o.clearBeforeUpdate(r),jt(e,t,n).each(function(e){var n=e.boxes.getOr([]);o.selectRange(r,n,e.start,e.finish),u.selectContents(t),u.collapseSelection()})}},Ef={byClass:function(o){function u(e){e=De(e,o.selectedSelector),C(e,r)}var n,t,i=(n=o.selected,function(e){mu(e,n)}),r=(t=[o.selected,o.lastSelected,o.firstSelected],function(e){wf(e,t)});return{clearBeforeUpdate:u,clear:u,selectRange:function(e,n,t,r){u(e),C(n,i),mu(t,o.firstSelected),mu(r,o.lastSelected)},selectedSelector:o.selectedSelector,firstSelectedSelector:o.firstSelectedSelector,lastSelectedSelector:o.lastSelectedSelector}},byAttr:function(o,u,n){function t(e){Dn(e,o.selected),Dn(e,o.firstSelected),Dn(e,o.lastSelected)}function i(e){Cn(e,o.selected,"1")}function c(e){r(e),n()}var r=function(e){e=De(e,o.selectedSelector);C(e,t)};return{clearBeforeUpdate:r,clear:c,selectRange:function(e,n,t,r){c(e),C(n,i),Cn(t,o.firstSelected,"1"),Cn(r,o.lastSelected,"1"),u(n,t,r)},selectedSelector:o.selectedSelector,firstSelectedSelector:o.firstSelectedSelector,lastSelectedSelector:o.lastSelectedSelector}}},Pf=function(e,n,i){var c=xt(e);return Si(c,n).map(function(e){var n,t,r,o,u=wi(c,i,!1);return{upOrLeftCells:(o=i,t=u.slice(0,(n=e)[n.length-1].row+1),o=yi(t,o),R(o,function(e){e=e.cells.slice(0,n[n.length-1].column+1);return S(e,function(e){return e.element})})),downOrRightCells:(o=i,u=u.slice((r=e)[0].row+r[0].rowspan-1,u.length),o=yi(u,o),R(o,function(e){e=e.cells.slice(r[0].column+r[0].colspan-1,e.cells.length);return S(e,function(e){return e.element})}))}})},If=function(e){return!1===pu(Xe.fromDom(e.target),"ephox-snooker-resizer-bar")};function Mf(s,d,e){var m=Ef.byAttr(Cr,function(r,o,u){e.targets().each(function(t){wt(o).each(function(e){var n=Kl(s),n=Sr(y,Xe.fromDom(s.getDoc()),n),n=Pf(e,t,n);Ll(s,r,o,u,n)})})},function(){return Hl(s)});return s.on("init",function(e){var t=s.getWin(),r=Xl(s),n=Yl(s),o=Df(t,r,n,m),u=Af(t,r,n,m),i=Bf(t,r,n,m);s.on("TableSelectorChange",function(e){return i(e.start,e.finish)});function c(e,n){!0===e.raw.shiftKey&&(n.kill&&e.kill(),n.selection.each(function(e){e=Va.relative(e.start,e.finish),e=$a(t,e);s.selection.setRng(e)}))}function l(e){return 0===e.button}var a,f,n=(a=Jl(Xe.fromDom(r)),f=Jl(0),{touchEnd:function(e){var n,t,r=Xe.fromDom(e.target);"td"!==rn(r)&&"th"!==rn(r)||(n=a.get(),t=f.get(),Ye(n,r)&&e.timeStamp-t<300&&(e.preventDefault(),i(r,r))),a.set(r),f.set(e.timeStamp)}});s.on("dragstart",function(e){o.clearstate()}),s.on("mousedown",function(e){l(e)&&If(e)&&o.mousedown(kl(e))}),s.on("mouseover",function(e){var n;(void 0===(n=e).buttons||za.browser.isEdge()&&0===n.buttons||0!=(1&n.buttons))&&If(e)&&o.mouseover(kl(e))}),s.on("mouseup",function(e){l(e)&&If(e)&&o.mouseup(kl(e))}),s.on("touchend",n.touchEnd),s.on("keyup",function(e){var n,t,r=kl(e);r.raw.shiftKey&&Tf(r.raw.which)&&(n=s.selection.getRng(),t=Xe.fromDom(n.startContainer),e=Xe.fromDom(n.endContainer),u.keyup(r,t,n.startOffset,e,n.endOffset).each(function(e){c(r,e)}))}),s.on("keydown",function(e){var n=kl(e);d().each(function(e){return e.hideBars()});var t=s.selection.getRng(),r=Xe.fromDom(t.startContainer),o=Xe.fromDom(t.endContainer),e=No(Rf,Of)(Xe.fromDom(s.selection.getStart()));u.keydown(n,r,t.startOffset,o,t.endOffset,e).each(function(e){c(n,e)}),d().each(function(e){return e.showBars()})}),s.on("NodeChange",function(){var e=s.selection,n=Xe.fromDom(e.getStart()),e=Xe.fromDom(e.getEnd());sr(wt,[n,e]).fold(function(){return m.clear(r)},y)})}),{clear:m.clear}}function kf(e,t){function n(){return Aa(Gu(e)).bind(function(n){return wt(n).map(function(e){return"caption"===rn(n)?ir(n):cr(t,e,n)})})}function r(){u.set(q(n)()),C(i.get(),function(e){return e()})}function o(n,t){function r(){return u.get().fold(function(){n.setDisabled(!0)},function(e){n.setDisabled(t(e))})}return r(),i.set(i.get().concat([r])),function(){i.set(T(i.get(),function(e){return e!==r}))}}var u=Jl(I.none()),i=Jl([]);return e.on("NodeChange ExecCommand TableSelectorChange",r),{onSetupTable:function(e){return o(e,function(e){return!1})},onSetupCellOrRow:function(e){return o(e,function(e){return"caption"===rn(e.element)})},onSetupPasteable:function(n){return function(e){return o(e,function(e){return"caption"===rn(e.element)||n().isNone()})}},onSetupMergeable:function(e){return o(e,function(e){return e.mergable.isNone()})},onSetupUnmergeable:function(e){return o(e,function(e){return e.unmergable.isNone()})},resetTargets:r,targets:function(){return u.get()}}}function Nf(n,e,t){function r(e){return function(){return n.execCommand(e)}}n.ui.registry.addMenuButton("table",{tooltip:"Table",icon:"table",fetch:function(e){return e("inserttable | cell row column | advtablesort | tableprops deletetable")}}),n.ui.registry.addButton("tableprops",{tooltip:"Table properties",onAction:r("mceTableProps"),icon:"table",onSetup:e.onSetupTable}),n.ui.registry.addButton("tabledelete",{tooltip:"Delete table",onAction:r("mceTableDelete"),icon:"table-delete-table",onSetup:e.onSetupTable}),n.ui.registry.addButton("tablecellprops",{tooltip:"Cell properties",onAction:r("mceTableCellProps"),icon:"table-cell-properties",onSetup:e.onSetupCellOrRow}),n.ui.registry.addButton("tablemergecells",{tooltip:"Merge cells",onAction:r("mceTableMergeCells"),icon:"table-merge-cells",onSetup:e.onSetupMergeable}),n.ui.registry.addButton("tablesplitcells",{tooltip:"Split cell",onAction:r("mceTableSplitCells"),icon:"table-split-cells",onSetup:e.onSetupUnmergeable}),n.ui.registry.addButton("tableinsertrowbefore",{tooltip:"Insert row before",onAction:r("mceTableInsertRowBefore"),icon:"table-insert-row-above",onSetup:e.onSetupCellOrRow}),n.ui.registry.addButton("tableinsertrowafter",{tooltip:"Insert row after",onAction:r("mceTableInsertRowAfter"),icon:"table-insert-row-after",onSetup:e.onSetupCellOrRow}),n.ui.registry.addButton("tabledeleterow",{tooltip:"Delete row",onAction:r("mceTableDeleteRow"),icon:"table-delete-row",onSetup:e.onSetupCellOrRow}),n.ui.registry.addButton("tablerowprops",{tooltip:"Row properties",onAction:r("mceTableRowProps"),icon:"table-row-properties",onSetup:e.onSetupCellOrRow}),n.ui.registry.addButton("tableinsertcolbefore",{tooltip:"Insert column before",onAction:r("mceTableInsertColBefore"),icon:"table-insert-column-before",onSetup:e.onSetupCellOrRow}),n.ui.registry.addButton("tableinsertcolafter",{tooltip:"Insert column after",onAction:r("mceTableInsertColAfter"),icon:"table-insert-column-after",onSetup:e.onSetupCellOrRow}),n.ui.registry.addButton("tabledeletecol",{tooltip:"Delete column",onAction:r("mceTableDeleteCol"),icon:"table-delete-column",onSetup:e.onSetupCellOrRow}),n.ui.registry.addButton("tablecutrow",{tooltip:"Cut row",icon:"cut-row",onAction:r("mceTableCutRow"),onSetup:e.onSetupCellOrRow}),n.ui.registry.addButton("tablecopyrow",{tooltip:"Copy row",icon:"duplicate-row",onAction:r("mceTableCopyRow"),onSetup:e.onSetupCellOrRow}),n.ui.registry.addButton("tablepasterowbefore",{tooltip:"Paste row before",icon:"paste-row-before",onAction:r("mceTablePasteRowBefore"),onSetup:e.onSetupPasteable(t.getRows)}),n.ui.registry.addButton("tablepasterowafter",{tooltip:"Paste row after",icon:"paste-row-after",onAction:r("mceTablePasteRowAfter"),onSetup:e.onSetupPasteable(t.getRows)}),n.ui.registry.addButton("tablecutcol",{tooltip:"Cut column",icon:"cut-column",onAction:r("mceTableCutCol"),onSetup:e.onSetupCellOrRow}),n.ui.registry.addButton("tablecopycol",{tooltip:"Copy column",icon:"duplicate-column",onAction:r("mceTableCopyCol"),onSetup:e.onSetupCellOrRow}),n.ui.registry.addButton("tablepastecolbefore",{tooltip:"Paste column before",icon:"paste-column-before",onAction:r("mceTablePasteColBefore"),onSetup:e.onSetupPasteable(t.getColumns)}),n.ui.registry.addButton("tablepastecolafter",{tooltip:"Paste column after",icon:"paste-column-after",onAction:r("mceTablePasteColAfter"),onSetup:e.onSetupPasteable(t.getColumns)}),n.ui.registry.addButton("tableinsertdialog",{tooltip:"Insert table",onAction:r("mceInsertTable"),icon:"table"})}function _f(n,e,t){function r(e){return function(){return n.execCommand(e)}}function o(e){n.execCommand("mceInsertTable",!1,{rows:e.numRows,columns:e.numColumns})}var u={text:"Table properties",onSetup:e.onSetupTable,onAction:r("mceTableProps")},i={text:"Delete table",icon:"table-delete-table",onSetup:e.onSetupTable,onAction:r("mceTableDelete")};n.ui.registry.addMenuItem("tableinsertrowbefore",{text:"Insert row before",icon:"table-insert-row-above",onAction:r("mceTableInsertRowBefore"),onSetup:e.onSetupCellOrRow}),n.ui.registry.addMenuItem("tableinsertrowafter",{text:"Insert row after",icon:"table-insert-row-after",onAction:r("mceTableInsertRowAfter"),onSetup:e.onSetupCellOrRow}),n.ui.registry.addMenuItem("tabledeleterow",{text:"Delete row",icon:"table-delete-row",onAction:r("mceTableDeleteRow"),onSetup:e.onSetupCellOrRow}),n.ui.registry.addMenuItem("tablerowprops",{text:"Row properties",icon:"table-row-properties",onAction:r("mceTableRowProps"),onSetup:e.onSetupCellOrRow}),n.ui.registry.addMenuItem("tablecutrow",{text:"Cut row",icon:"cut-row",onAction:r("mceTableCutRow"),onSetup:e.onSetupCellOrRow}),n.ui.registry.addMenuItem("tablecopyrow",{text:"Copy row",icon:"duplicate-row",onAction:r("mceTableCopyRow"),onSetup:e.onSetupCellOrRow}),n.ui.registry.addMenuItem("tablepasterowbefore",{text:"Paste row before",icon:"paste-row-before",onAction:r("mceTablePasteRowBefore"),onSetup:e.onSetupPasteable(t.getRows)}),n.ui.registry.addMenuItem("tablepasterowafter",{text:"Paste row after",icon:"paste-row-after",onAction:r("mceTablePasteRowAfter"),onSetup:e.onSetupPasteable(t.getRows)}),n.ui.registry.addMenuItem("tableinsertcolumnbefore",{text:"Insert column before",icon:"table-insert-column-before",onAction:r("mceTableInsertColBefore"),onSetup:e.onSetupCellOrRow}),n.ui.registry.addMenuItem("tableinsertcolumnafter",{text:"Insert column after",icon:"table-insert-column-after",onAction:r("mceTableInsertColAfter"),onSetup:e.onSetupCellOrRow}),n.ui.registry.addMenuItem("tabledeletecolumn",{text:"Delete column",icon:"table-delete-column",onAction:r("mceTableDeleteCol"),onSetup:e.onSetupCellOrRow}),n.ui.registry.addMenuItem("tablecutcolumn",{text:"Cut column",icon:"cut-column",onAction:r("mceTableCutCol"),onSetup:e.onSetupCellOrRow}),n.ui.registry.addMenuItem("tablecopycolumn",{text:"Copy column",icon:"duplicate-column",onAction:r("mceTableCopyCol"),onSetup:e.onSetupCellOrRow}),n.ui.registry.addMenuItem("tablepastecolumnbefore",{text:"Paste column before",icon:"paste-column-before",onAction:r("mceTablePasteColBefore"),onSetup:e.onSetupPasteable(t.getColumns)}),n.ui.registry.addMenuItem("tablepastecolumnafter",{text:"Paste column after",icon:"paste-column-after",onAction:r("mceTablePasteColAfter"),onSetup:e.onSetupPasteable(t.getColumns)}),n.ui.registry.addMenuItem("tablecellprops",{text:"Cell properties",icon:"table-cell-properties",onAction:r("mceTableCellProps"),onSetup:e.onSetupCellOrRow}),n.ui.registry.addMenuItem("tablemergecells",{text:"Merge cells",icon:"table-merge-cells",onAction:r("mceTableMergeCells"),onSetup:e.onSetupMergeable}),n.ui.registry.addMenuItem("tablesplitcells",{text:"Split cell",icon:"table-split-cells",onAction:r("mceTableSplitCells"),onSetup:e.onSetupUnmergeable}),!1===n.getParam("table_grid",!0,"boolean")?n.ui.registry.addMenuItem("inserttable",{text:"Table",icon:"table",onAction:r("mceInsertTable")}):n.ui.registry.addNestedMenuItem("inserttable",{text:"Table",icon:"table",getSubmenuItems:function(){return[{type:"fancymenuitem",fancytype:"inserttable",onAction:o}]}}),n.ui.registry.addMenuItem("inserttabledialog",{text:"Insert table",icon:"table",onAction:r("mceInsertTable")}),n.ui.registry.addMenuItem("tableprops",u),n.ui.registry.addMenuItem("deletetable",i),n.ui.registry.addNestedMenuItem("row",{type:"nestedmenuitem",text:"Row",getSubmenuItems:function(){return"tableinsertrowbefore tableinsertrowafter tabledeleterow tablerowprops | tablecutrow tablecopyrow tablepasterowbefore tablepasterowafter"}}),n.ui.registry.addNestedMenuItem("column",{type:"nestedmenuitem",text:"Column",getSubmenuItems:function(){return"tableinsertcolumnbefore tableinsertcolumnafter tabledeletecolumn | tablecutcolumn tablecopycolumn tablepastecolumnbefore tablepastecolumnafter"}}),n.ui.registry.addNestedMenuItem("cell",{type:"nestedmenuitem",text:"Cell",getSubmenuItems:function(){return"tablecellprops tablemergecells tablesplitcells"}}),n.ui.registry.addContextMenu("table",{update:function(){return e.resetTargets(),e.targets().fold(function(){return""},function(e){return"caption"===rn(e.element)?"tableprops deletetable":"cell row column | advtablesort | tableprops deletetable"})}})}t.add("table",function(n){var e,t,r,o,u,i,c,l,a,f,s,d,m,p=(e=function(){return Xl(n)},t=function(){return Aa(Gu(n))},r=Cr.selectedSelector,{get:function(){return dr(e(),r).fold(function(){return t().map(hr).getOrThunk(pr)},function(e){return gr(e)})}}),g=kf(n,p),h=ri(n),b=Mf(n,h.lazyResize,g),v=cc(n,h.lazyWire,p),w=kc();return Mc(n,v,b,p,w),s=v,d=p,m=Yl(f=n),ue({mceTableRowType:function(){return s.getTableRowType(f)},mceTableCellType:function(){return s.getTableCellType(f)},mceTableColType:function(){return Da(Gu(f)).bind(function(t){return wt(t,m).map(function(e){var n=cr(d,e,t);return s.getTableColType(e,n)})}).getOr("")}},function(e,n){return f.addQueryValueHandler(n,e)}),c=p,l=v,a=b,(i=n).on("BeforeGetContent",function(t){!0===t.selection&&Vt(c.get(),y,function(e){t.preventDefault(),wt(e[0]).map(Yt).map(function(e){return[Ut(e,"[data-mce-selected]")]}).each(function(e){var n;t.content="text"===t.format?S(e,function(e){return e.dom.innerText}).join(""):(n=i,S(e,function(e){return n.selection.serializer.serialize(e.dom,{})}).join(""))})},y)}),i.on("BeforeSetContent",function(u){!0===u.selection&&!0===u.paste&&I.from(i.dom.getParent(i.selection.getStart(),"th,td")).each(function(e){var o=Xe.fromDom(e);wt(o).each(function(n){var e,t,r=T((e=u.content,(r=document.createElement("div")).innerHTML=e,xe(Xe.fromDom(r))),function(e){return"meta"!==rn(e)});1===r.length&&(t=r[0],"table"===rn(t))&&(u.preventDefault(),t=Xe.fromDom(i.getDoc()),t=rr(t),t={element:o,clipboard:r[0],generators:t},l.pasteCells(n,t).each(function(e){i.selection.setRng(e),i.focus(),a.clear(n)}))})})}),_f(n,g,w),Nf(n,g,w),0<(b=(u=n).getParam("table_toolbar","tableprops tabledelete | tableinsertrowbefore tableinsertrowafter tabledeleterow | tableinsertcolbefore tableinsertcolafter tabledeletecol")).length&&u.ui.registry.addContextToolbar("table",{predicate:function(e){return u.dom.is(e,"table")&&u.getBody().contains(e)},items:b,scope:"node",position:"node"}),n.on("PreInit",function(){n.serializer.addTempAttr(Cr.firstSelected),n.serializer.addTempAttr(Cr.lastSelected),n.formatter.register(ja)}),n.getParam("table_tab_navigation",!0,"boolean")&&n.on("keydown",function(e){ul(e,n,v)}),n.on("remove",function(){h.destroy()}),{insertTable:(o=n,function(e,n,t){t=sc(o,n,e,t=void 0===t?{}:t,"Invalid values for insertTable - rows and columns values are required to insert a table.");return o.undoManager.add(),t}),setClipboardRows:mc(w.setRows),getClipboardRows:dc(w.getRows),setClipboardCols:mc(w.setColumns),getClipboardCols:dc(w.getColumns),resizeHandler:h,selectionTargets:g}})}();