!function(){"use strict";function o(e){if(null===e)return"null";if(void 0===e)return"undefined";var t=typeof e;return"object"==t&&(Array.prototype.isPrototypeOf(e)||e.constructor&&"Array"===e.constructor.name)?"array":"object"==t&&(String.prototype.isPrototypeOf(e)||e.constructor&&"String"===e.constructor.name)?"string":t}function f(e){return{eq:e}}function d(r){return f(function(e,t){if(e.length!==t.length)return!1;for(var n=e.length,o=0;o<n;o++)if(!r.eq(e[o],t[o]))return!1;return!0})}function i(l){return f(function(e,t){var n,o,r,i=Object.keys(e),u=Object.keys(t);if(o=d(m),r=function(e){return t=n,Array.prototype.slice.call(e).sort(t);var t},!f(function(e,t){return o.eq(r(e),r(t))}).eq(i,u))return!1;for(var a=i.length,c=0;c<a;c++){var s=i[c];if(!l.eq(e[s],t[s]))return!1}return!0})}function r(n,o){return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return n(o.apply(null,e))}}function t(e){return e}var m=f(function(e,t){return e===t}),u=f(function(e,t){if(e===t)return!0;var n=o(e);return n===o(t)&&(-1!==["undefined","boolean","number","string","function","xml","null"].indexOf(n)?e===t:"array"===n?d(u).eq(e,t):"object"===n&&i(u).eq(e,t))}),U=function(){},_=function(e){return function(){return e}};function w(o){for(var r=[],e=1;e<arguments.length;e++)r[e-1]=arguments[e];return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=r.concat(e);return o.apply(null,n)}}function a(t){return function(e){return!t(e)}}function c(e){return function(){throw new Error(e)}}function g(e){e()}function k(e){return!ue(e)}function s(e,t){return le.call(e,t)}function ee(e,t){return-1<s(e,t)}function y(e,t){for(var n=0,o=e.length;n<o;n++)if(t(e[n],n))return!0;return!1}function E(e,t){for(var n=e.length,o=new Array(n),r=0;r<n;r++){var i=e[r];o[r]=t(i,r)}return o}function l(e,t){for(var n=e.length-1;0<=n;n--)t(e[n],n)}function p(e,t,n){return l(e,function(e){n=t(n,e)}),n}function T(e,t,n){return de(e,function(e){n=t(n,e)}),n}function D(e,t){return function(e,t,n){for(var o=0,r=e.length;o<r;o++){var i=e[o];if(t(i,o))return Y.some(i);if(n(i,o))break}return Y.none()}(e,t,W)}function h(e,t){for(var n=0,o=e.length;n<o;n++)if(t(e[n],n))return Y.some(n);return Y.none()}function v(e,t){return function(e){for(var t=[],n=0,o=e.length;n<o;++n){if(!ne(e[n]))throw new Error("Arr.flatten item "+n+" was not an array, input: "+e);fe.apply(t,e[n])}return t}(E(e,t))}function A(e,t){for(var n=0,o=e.length;n<o;++n)if(!0!==t(e[n],n))return!1;return!0}function b(e){return(e=se.call(e,0)).reverse(),e}function x(e,t){return me(e,function(e){return!ee(t,e)})}function B(e,t){return 0<=t&&t<e.length?Y.some(e[t]):Y.none()}function C(e){return B(e,0)}function N(e){return B(e,e.length-1)}function S(e,n){return be(e,function(e,t){return{k:t,v:n(e,t)}})}function O(n){return function(e,t){n[t]=e}}function R(e,n,o,r){return ve(e,function(e,t){(n(e,t)?o:r)(e,t)}),1}function M(e,t){var n={},o={};return R(e,t,O(n),O(o)),{t:n,f:o}}function I(e,t){var n={};return R(e,t,O(n),U),n}function te(e,t){return ye(e,t)?Y.from(e[t]):Y.none()}function F(e,t){return ye(e,t)&&void 0!==e[t]&&null!==e[t]}function P(e,t,n){var o,r;if(!e)return!1;if(n=n||e,void 0!==e.length){for(o=0,r=e.length;o<r;o++)if(!1===t.call(n,e[o],o,e))return!1}else for(o in e)if(e.hasOwnProperty(o)&&!1===t.call(n,e[o],o,e))return!1;return!0}function L(n,o){var r=[];return P(n,function(e,t){r.push(o(e,t,n))}),r}function V(n,o){var r=[];return P(n,function(e,t){o&&!o(e,t,n)||r.push(e)}),r}function H(e,t){if(e)for(var n=0,o=e.length;n<o;n++)if(e[n]===t)return n;return-1}function z(e,t,n,o){for(var r=ie(n)?e[0]:n,i=0;i<e.length;i++)r=t.call(o,r,e[i],i);return r}function n(e,t,n){for(var o=0,r=e.length;o<r;o++)if(t.call(n,e[o],o,e))return o;return-1}function j(e){return e[e.length-1]}var W=_(!1),q=_(!0),G=function(){return $},$=(Mt=function(e){return e.isNone()},{fold:function(e,t){return e()},is:W,isSome:W,isNone:q,getOr:Dt=function(e){return e},getOrThunk:Rt=function(e){return e()},getOrDie:function(e){throw new Error(e||"error: getOrDie called on none.")},getOrNull:_(null),getOrUndefined:_(void 0),or:Dt,orThunk:Rt,map:G,each:U,bind:G,exists:W,forall:q,filter:G,equals:Mt,equals_:Mt,toArray:function(){return[]},toString:_("none()")}),X=function(n){function e(){return r}function t(e){return e(n)}var o=_(n),r={fold:function(e,t){return t(n)},is:function(e){return n===e},isSome:q,isNone:W,getOr:o,getOrThunk:o,getOrDie:o,getOrNull:o,getOrUndefined:o,or:e,orThunk:e,map:function(e){return X(e(n))},each:function(e){e(n)},bind:t,exists:t,forall:t,filter:function(e){return e(n)?r:$},toArray:function(){return[n]},toString:function(){return"some("+n+")"},equals:function(e){return e.is(n)},equals_:function(e,t){return e.fold(W,function(e){return t(n,e)})}};return r},Y={some:X,none:G,from:function(e){return null==e?$:X(e)}},e=function(n){return function(e){return e=typeof(t=e),(null===t?"null":"object"==e&&(Array.prototype.isPrototypeOf(t)||t.constructor&&"Array"===t.constructor.name)?"array":"object"==e&&(String.prototype.isPrototypeOf(t)||t.constructor&&"String"===t.constructor.name)?"string":e)===n;var t}},K=function(t){return function(e){return typeof e===t}},J=function(t){return function(e){return t===e}},Q=e("string"),Z=e("object"),ne=e("array"),oe=J(null),re=K("boolean"),ie=J(void 0),ue=function(e){return null==e},ae=K("function"),ce=K("number"),se=Array.prototype.slice,le=Array.prototype.indexOf,fe=Array.prototype.push,de=function(e,t){for(var n=0,o=e.length;n<o;n++)t(e[n],n)},me=function(e,t){for(var n=[],o=0,r=e.length;o<r;o++){var i=e[o];t(i,o)&&n.push(i)}return n},ge=ae(Array.from)?Array.from:function(e){return se.call(e)},pe=Object.keys,he=Object.hasOwnProperty,ve=function(e,t){for(var n=pe(e),o=0,r=n.length;o<r;o++){var i=n[o];t(e[i],i)}},be=function(e,n){var o={};return ve(e,function(e,t){t=n(e,t);o[t.k]=t.v}),o},ye=function(e,t){return he.call(e,t)},xe=Array.isArray,we=function(){return(we=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)};function Ce(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;for(var o=Array(e),r=0,t=0;t<n;t++)for(var i=arguments[t],u=0,a=i.length;u<a;u++,r++)o[r]=i[u];return o}function Se(){return _t(0,0)}function ke(e,t){var n=String(t).toLowerCase();return D(e,function(e){return e.search(n)})}function Oe(e,t){return-1!==e.indexOf(t)}function _e(e,t){return""===(t=t)||e.length>=t.length&&e.substr(0,0+t.length)===t}function Ee(e){var t=e.current,n=e.version;return{current:t,version:n,isEdge:(e=function(e){return function(){return t===e}})("Edge"),isChrome:e("Chrome"),isIE:e("IE"),isOpera:e("Opera"),isFirefox:e(Ft),isSafari:e("Safari")}}function Te(e){var t=e.current,n=e.version;return{current:t,version:n,isWindows:(e=function(e){return function(){return t===e}})(Vt),isiOS:e("iOS"),isAndroid:e(Ht),isOSX:e("OSX"),isLinux:e("Linux"),isSolaris:e(zt),isFreeBSD:e(jt),isChromeOS:e(Ut)}}function De(e,t){var n,o,r,i,u=It.browsers(),a=It.oses(),c=ke(u,i=e).map(function(e){var t=Et(e.versionRegexes,i);return{current:e.name,version:t}}).fold(Pt,Lt),s=ke(a,r=e).map(function(e){var t=Et(e.versionRegexes,r);return{current:e.name,version:t}}).fold(Wt,qt);return{browser:c,os:s,deviceType:(n=c,o=e,u=t,c=(a=s).isiOS()&&!0===/ipad/i.test(o),e=a.isiOS()&&!c,s=(t=a.isiOS()||a.isAndroid())||u("(pointer:coarse)"),u=c||!e&&t&&u("(min-device-width:768px)"),t=e||t&&!u,n=n.isSafari()&&a.isiOS()&&!1===/safari/i.test(o),o=!t&&!u&&!n,{isiPad:_(c),isiPhone:_(e),isTablet:_(u),isPhone:_(t),isTouch:_(s),isAndroid:a.isAndroid,isiOS:a.isiOS,isWebView:_(n),isDesktop:_(o)})}}function Ae(e){return window.matchMedia(e).matches}function Be(e){return null==e?"":(""+e).replace(Xt,"")}function Ne(e,t){return t?!("array"!==t||!xe(e))||typeof e===t:void 0!==e}function Re(e){if(null==e)throw new Error("Node cannot be null or undefined");return{dom:e}}function Me(e,t){for(var n=[],o=function(e){return n.push(e),t(e)},r=t(e);(r=r.bind(o)).isSome(););return n}function Ie(e,t){if(1!==(e=e.dom).nodeType)return!1;if(void 0!==e.matches)return e.matches(t);if(void 0!==e.msMatchesSelector)return e.msMatchesSelector(t);if(void 0!==e.webkitMatchesSelector)return e.webkitMatchesSelector(t);if(void 0!==e.mozMatchesSelector)return e.mozMatchesSelector(t);throw new Error("Browser lacks native selectors")}function Fe(e){return 1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType||0===e.childElementCount}function Pe(e,t){return e.dom===t.dom}function Le(e,t){return Gt().browser.isIE()?(o=t,r=(n=e).dom,n=t.dom,o=Node.DOCUMENT_POSITION_CONTAINED_BY,0!=(r.compareDocumentPosition(n)&o)):(e=e.dom)!==(t=t.dom)&&e.contains(t);var n,o,r}function Ve(e){return e.dom.nodeType}function He(e){return Jt.fromDom(e.dom.ownerDocument)}function ze(e){return tn(e)?e:He(e)}function je(e){return Jt.fromDom(ze(e).dom.defaultView)}function Ue(e){return Y.from(e.dom.parentNode).map(Jt.fromDom)}function We(e){return Y.from(e.dom.nextSibling).map(Jt.fromDom)}function qe(e){return E(e.dom.childNodes,Jt.fromDom)}function Ge(e,t){return e=e.dom.childNodes,Y.from(e[t]).map(Jt.fromDom)}function $e(e){return Ge(e,0)}function Xe(e){return nn(e)}function Ye(t){return Xe(t)?t:function(){var e=ze(t).dom.head;if(null==e)throw new Error("Head is not available yet");return Jt.fromDom(e)}()}function Ke(e){return Jt.fromDom(e.dom.host)}function Je(t,e){de(e,function(e){mn(t,e)})}function Qe(e){e.dom.textContent="",de(qe(e),function(e){gn(e)})}function Ze(e){var t,n=qe(e);0<n.length&&(t=e,de(n,function(e){ln(t,e)})),gn(e)}function et(e,t){return void 0!==e?e:void 0!==t?t:0}function tt(e){var t=e.dom,n=t.ownerDocument.body;return n===t?vn(n.offsetLeft,n.offsetTop):pn(e)?(t=t.getBoundingClientRect(),vn(t.left,t.top)):vn(0,0)}function nt(e){var e=(t=void 0!==e?e.dom:document).body.scrollLeft||t.documentElement.scrollLeft,t=t.body.scrollTop||t.documentElement.scrollTop;return vn(e,t)}function ot(e,t,n){(n=(void 0!==n?n.dom:document).defaultView)&&n.scrollTo(e,t)}function rt(e,t){Gt().browser.isSafari()&&ae(e.dom.scrollIntoViewIfNeeded)?e.dom.scrollIntoViewIfNeeded(!1):e.dom.scrollIntoView(t)}function it(e,t,n,o){return{x:e,y:t,width:n,height:o,right:e+n,bottom:t+o}}function ut(e){return!!e&&!Object.getPrototypeOf(e)}function at(e){var t=e.map(function(e){return e.toLowerCase()});return function(e){if(e&&e.nodeName){e=e.nodeName.toLowerCase();return ee(t,e)}return!1}}function ct(e){return yn(e)&&e.hasAttribute("data-mce-bogus")}function st(e){return yn(e)&&"TABLE"===e.tagName}function lt(e){return void 0!==e.style&&ae(e.style.getPropertyValue)}function ft(e,t,n){if(!(Q(n)||re(n)||ce(n)))throw console.error("Invalid call to Attribute.set. Key ",t,":: Value ",n,":: Element ",e),new Error("Attribute value was not simple");e.setAttribute(t,n+"")}function dt(e,t,n){ft(e.dom,t,n)}function mt(e,t){var n=e.dom;ve(t,function(e,t){ft(n,t,e)})}function gt(e,t){return null===(t=e.dom.getAttribute(t))?void 0:t}function pt(e,t){return Y.from(gt(e,t))}function ht(e,t){e.dom.removeAttribute(t)}function vt(e,t){var n=e.dom;ve(t,function(e,t){!function(e,t,n){if(!Q(n))throw console.error("Invalid call to CSS.set. Property ",t,":: Value ",n,":: Element ",e),new Error("CSS value must be a string: "+n);lt(e)&&e.style.setProperty(t,n)}(n,t,e)})}function bt(e,t){var n=e.dom,o=window.getComputedStyle(n).getPropertyValue(t);return""!==o||pn(e)?o:An(n,t)}function yt(e,t){return e=e.dom,t=An(e,t),Y.from(t).filter(function(e){return 0<e.length})}function xt(e){var t={},n=e.dom;if(lt(n))for(var o=0;o<n.style.length;o++){var r=n.style.item(o);t[r]=n.style[r]}return t}function wt(e){return D(e,Zt)}function Ct(e,t){return e.children&&ee(e.children,t)}var St,kt,Ot,_t=function(e,t){return{major:e,minor:t}},Et=function(e,t){t=String(t).toLowerCase();return 0===e.length?Se():function(e,t){var n=function(e,t){for(var n=0;n<e.length;n++){var o=e[n];if(o.test(t))return o}}(e,t);if(!n)return{major:0,minor:0};e=function(e){return Number(t.replace(n,"$"+e))};return _t(e(1),e(2))}(e,t)},Tt=Se,Dt=function(t){return function(e){return e.replace(t,"")}},At=Dt(/^\s+|\s+$/g),Bt=Dt(/^\s+/g),Nt=Dt(/\s+$/g),Rt=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,Mt=function(t){return function(e){return Oe(e,t)}},G=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(e){return Oe(e,"edge/")&&Oe(e,"chrome")&&Oe(e,"safari")&&Oe(e,"applewebkit")}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,Rt],search:function(e){return Oe(e,"chrome")&&!Oe(e,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(e){return Oe(e,"msie")||Oe(e,"trident")}},{name:"Opera",versionRegexes:[Rt,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:Mt("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:Mt("firefox")},{name:"Safari",versionRegexes:[Rt,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(e){return(Oe(e,"safari")||Oe(e,"mobile/"))&&Oe(e,"applewebkit")}}],e=[{name:"Windows",search:Mt("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(e){return Oe(e,"iphone")||Oe(e,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:Mt("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:Mt("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:Mt("linux"),versionRegexes:[]},{name:"Solaris",search:Mt("sunos"),versionRegexes:[]},{name:"FreeBSD",search:Mt("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:Mt("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],It={browsers:_(G),oses:_(e)},Ft="Firefox",Pt=function(){return Ee({current:void 0,version:Tt()})},Lt=Ee,Vt=(_("Edge"),_("Chrome"),_("IE"),_("Opera"),_(Ft),_("Safari"),"Windows"),Ht="Android",zt="Solaris",jt="FreeBSD",Ut="ChromeOS",Wt=function(){return Te({current:void 0,version:Tt()})},qt=Te,Gt=(_(Vt),_("iOS"),_(Ht),_("Linux"),_("OSX"),_(zt),_(jt),_(Ut),Ot=!(St=function(){return De(navigator.userAgent,Ae)}),function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Ot||(Ot=!0,kt=St.apply(null,e)),kt}),J=navigator.userAgent,K=Gt(),Dt=K.browser,Rt=K.os,Mt=K.deviceType,G=/WebKit/.test(J)&&!Dt.isEdge(),e="FormData"in window&&"FileReader"in window&&"URL"in window&&!!URL.createObjectURL,K=-1!==J.indexOf("Windows Phone"),$t={opera:Dt.isOpera(),webkit:G,ie:!(!Dt.isIE()&&!Dt.isEdge())&&Dt.version.major,gecko:Dt.isFirefox(),mac:Rt.isOSX()||Rt.isiOS(),iOS:Mt.isiPad()||Mt.isiPhone(),android:Rt.isAndroid(),contentEditable:!0,transparentSrc:"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",caretAfter:!0,range:window.getSelection&&"Range"in window,documentMode:Dt.isIE()?document.documentMode||7:10,fileApi:e,ceFalse:!0,cacheSuffix:null,container:null,experimentalShadowDom:!1,canHaveCSP:!Dt.isIE(),desktop:Mt.isDesktop(),windowsPhone:K,browser:{current:Dt.current,version:Dt.version,isChrome:Dt.isChrome,isEdge:Dt.isEdge,isFirefox:Dt.isFirefox,isIE:Dt.isIE,isOpera:Dt.isOpera,isSafari:Dt.isSafari},os:{current:Rt.current,version:Rt.version,isAndroid:Rt.isAndroid,isChromeOS:Rt.isChromeOS,isFreeBSD:Rt.isFreeBSD,isiOS:Rt.isiOS,isLinux:Rt.isLinux,isOSX:Rt.isOSX,isSolaris:Rt.isSolaris,isWindows:Rt.isWindows},deviceType:{isDesktop:Mt.isDesktop,isiPad:Mt.isiPad,isiPhone:Mt.isiPhone,isPhone:Mt.isPhone,isTablet:Mt.isTablet,isTouch:Mt.isTouch,isWebView:Mt.isWebView}},Xt=/^\s*|\s*$/g,Yt=function(e,n,o,r){r=r||this,e&&(o&&(e=e[o]),P(e,function(e,t){return!1!==n.call(r,e,t,o)&&void Yt(e,n,o,r)}))},Kt={trim:Be,isArray:xe,is:Ne,toArray:function(e){if(xe(e))return e;for(var t=[],n=0,o=e.length;n<o;n++)t[n]=e[n];return t},makeMap:function(e,t,n){var o;for(t=t||",",n=n||{},o=(e="string"==typeof(e=e||[])?e.split(t):e).length;o--;)n[e[o]]={};return n},each:P,map:L,grep:V,inArray:H,hasOwn:function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},extend:function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];for(var o=0;o<t.length;o++){var r,i,u=t[o];for(i in u)!u.hasOwnProperty(i)||void 0!==(r=u[i])&&(e[i]=r)}return e},create:function(e,t,n){var o,r,i,u=this,a=0,c=(e=/^((static) )?([\w.]+)(:([\w.]+))?/.exec(e))[3].match(/(^|\.)(\w+)$/i)[2],s=u.createNS(e[3].replace(/\.\w+$/,""),n);if(!s[c]){if("static"===e[2])return s[c]=t,void(this.onCreate&&this.onCreate(e[2],e[3],s[c]));t[c]||(t[c]=function(){},a=1),s[c]=t[c],u.extend(s[c].prototype,t),e[5]&&(o=u.resolve(e[5]).prototype,r=e[5].match(/\.(\w+)$/i)[1],i=s[c],s[c]=a?function(){return o[r].apply(this,arguments)}:function(){return this.parent=o[r],i.apply(this,arguments)},s[c].prototype[c]=s[c],u.each(o,function(e,t){s[c].prototype[t]=o[t]}),u.each(t,function(e,t){o[t]?s[c].prototype[t]=function(){return this.parent=o[t],e.apply(this,arguments)}:t!==c&&(s[c].prototype[t]=e)})),u.each(t.static,function(e,t){s[c][t]=e})}},walk:Yt,createNS:function(e,t){var n,o;for(t=t||window,e=e.split("."),n=0;n<e.length;n++)t[o=e[n]]||(t[o]={}),t=t[o];return t},resolve:function(e,t){var n,o;for(t=t||window,n=0,o=(e=e.split(".")).length;n<o&&(t=t[e[n]]);n++);return t},explode:function(e,t){return!e||Ne(e,"array")?e:L(e.split(t||","),Be)},_addCacheSuffix:function(e){var t=$t.cacheSuffix;return t&&(e+=(-1===e.indexOf("?")?"?":"&")+t),e}},Jt={fromHtml:function(e,t){t=(t||document).createElement("div");if(t.innerHTML=e,!t.hasChildNodes()||1<t.childNodes.length)throw console.error("HTML does not have a single root node",e),new Error("HTML must have a single root node");return Re(t.childNodes[0])},fromTag:function(e,t){e=(t||document).createElement(e);return Re(e)},fromText:function(e,t){e=(t||document).createTextNode(e);return Re(e)},fromDom:Re,fromPoint:function(e,t,n){return Y.from(e.dom.elementFromPoint(t,n)).map(Re)}},Qt=("undefined"!=typeof window||Function("return this;")(),function(e){return e.dom.nodeName.toLowerCase()}),J=function(t){return function(e){return Ve(e)===t}},Zt=J(1),en=J(3),tn=J(9),nn=J(11),on=function(e){return Y.from(e.dom.previousSibling).map(Jt.fromDom)},rn=function(e){return b(Me(e,on))},un=function(e){return Me(e,We)},an=function(e){return Ge(e,e.dom.childNodes.length-1)},G=ae(Element.prototype.attachShadow)&&ae(Node.prototype.getRootNode),cn=_(G),sn=G?function(e){return Jt.fromDom(e.dom.getRootNode())}:ze,ln=function(t,n){Ue(t).each(function(e){e.dom.insertBefore(n.dom,t.dom)})},fn=function(e,t){We(e).fold(function(){Ue(e).each(function(e){mn(e,t)})},function(e){ln(e,t)})},dn=function(t,n){$e(t).fold(function(){mn(t,n)},function(e){t.dom.insertBefore(n.dom,e.dom)})},mn=function(e,t){e.dom.appendChild(t.dom)},gn=function(e){e=e.dom;null!==e.parentNode&&e.parentNode.removeChild(e)},pn=function(e){var t=en(e)?e.dom.parentNode:e.dom;if(null==t||null===t.ownerDocument)return!1;var n,o,r=t.ownerDocument,e=Jt.fromDom(t),e=sn(e);return(Xe(e)?Y.some(e):Y.none()).fold(function(){return r.body.contains(t)},(n=pn,o=Ke,function(e){return n(o(e))}))},hn=function(n,o){return{left:n,top:o,translate:function(e,t){return hn(n+e,o+t)}}},vn=hn,bn=function(e){var n=void 0===e?window:e,e=n.document,o=nt(Jt.fromDom(e)),e=void 0===n?window:n;return Y.from(e.visualViewport).fold(function(){var e=n.document.documentElement,t=e.clientWidth,e=e.clientHeight;return it(o.left,o.top,t,e)},function(e){return it(Math.max(e.pageLeft,o.left),Math.max(e.pageTop,o.top),e.width,e.height)})},e=function(t){return function(e){return!!e&&e.nodeType===t}},yn=e(1),K=function(o,e){var r=e.toLowerCase().split(" ");return function(e){var t;if(yn(e))for(t=0;t<r.length;t++){var n=e.ownerDocument.defaultView.getComputedStyle(e,null);if((n?n.getPropertyValue(o):null)===r[t])return!0}return!1}},Dt=function(t){return function(e){return yn(e)&&e.hasAttribute(t)}},Rt=function(t){return function(e){if(yn(e)){if(e.contentEditable===t)return!0;if(e.getAttribute("data-mce-contenteditable")===t)return!0}return!1}},xn=at(["textarea","input"]),wn=e(3),Cn=e(8),Sn=e(9),kn=e(11),On=at(["br"]),_n=at(["img"]),En=Rt("true"),Tn=Rt("false"),Mt=at(["td","th"]),Dn=at(["video","audio","object","embed"]),An=function(e,t){return lt(e)?e.style.getPropertyValue(t):""},Bn=Gt().browser,Nn=function(e,t,n){var o,r,i=0,u=0,a=e.ownerDocument;if(n=n||e,t){if(n===e&&t.getBoundingClientRect&&"static"===bt(Jt.fromDom(e),"position"))return{x:i=(r=t.getBoundingClientRect()).left+(a.documentElement.scrollLeft||e.scrollLeft)-a.documentElement.clientLeft,y:u=r.top+(a.documentElement.scrollTop||e.scrollTop)-a.documentElement.clientTop};for(o=t;o&&o!==n&&o.nodeType&&!Ct(o,n);)i+=o.offsetLeft||0,u+=o.offsetTop||0,o=o.offsetParent;for(o=t.parentNode;o&&o!==n&&o.nodeType&&!Ct(o,n);)i-=o.scrollLeft||0,u-=o.scrollTop||0,o=o.parentNode;u+=(t=Jt.fromDom(t),Bn.isFirefox()&&"table"===Qt(t)?wt(qe(t)).filter(function(e){return"caption"===Qt(e)}).bind(function(o){return wt(un(o)).map(function(e){var t=e.dom.offsetTop,n=o.dom.offsetTop,e=o.dom.offsetHeight;return t<=n?-e:0})}).getOr(0):0)}return{x:i,y:u}},J={},G={exports:J},Rn=void 0,Mn=J,In=G;(function(e){"object"==typeof Mn&&void 0!==In?In.exports=e():"function"==typeof Rn&&Rn.amd?Rn([],e):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).EphoxContactWrapper=e()})(function(){return function o(r,i,u){function a(t,e){if(!i[t]){if(!r[t]){var n=!1;if(!e&&n)return n(t,!0);if(c)return c(t,!0);n=new Error("Cannot find module '"+t+"'");throw n.code="MODULE_NOT_FOUND",n}n=i[t]={exports:{}};r[t][0].call(n.exports,function(e){return a(r[t][1][e]||e)},n,n.exports,o,r,i,u)}return i[t].exports}for(var c=!1,e=0;e<u.length;e++)a(u[e]);return a}({1:[function(e,t,n){var o,r,t=t.exports={};function i(){throw new Error("setTimeout has not been defined")}function u(){throw new Error("clearTimeout has not been defined")}function a(t){if(o===setTimeout)return setTimeout(t,0);if((o===i||!o)&&setTimeout)return o=setTimeout,setTimeout(t,0);try{return o(t,0)}catch(e){try{return o.call(null,t,0)}catch(e){return o.call(this,t,0)}}}!function(){try{o="function"==typeof setTimeout?setTimeout:i}catch(e){o=i}try{r="function"==typeof clearTimeout?clearTimeout:u}catch(e){r=u}}();var c,s=[],l=!1,f=-1;function d(){l&&c&&(l=!1,c.length?s=c.concat(s):f=-1,s.length&&m())}function m(){if(!l){var e=a(d);l=!0;for(var t=s.length;t;){for(c=s,s=[];++f<t;)c&&c[f].run();f=-1,t=s.length}c=null,l=!1,function(t){if(r===clearTimeout)return clearTimeout(t);if((r===u||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(t);try{r(t)}catch(e){try{return r.call(null,t)}catch(e){return r.call(this,t)}}}(e)}}function g(e,t){this.fun=e,this.array=t}function p(){}t.nextTick=function(e){var t=new Array(arguments.length-1);if(1<arguments.length)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];s.push(new g(e,t)),1!==s.length||l||a(m)},g.prototype.run=function(){this.fun.apply(null,this.array)},t.title="browser",t.browser=!0,t.env={},t.argv=[],t.version="",t.versions={},t.on=p,t.addListener=p,t.once=p,t.off=p,t.removeListener=p,t.removeAllListeners=p,t.emit=p,t.prependListener=p,t.prependOnceListener=p,t.listeners=function(e){return[]},t.binding=function(e){throw new Error("process.binding is not supported")},t.cwd=function(){return"/"},t.chdir=function(e){throw new Error("process.chdir is not supported")},t.umask=function(){return 0}},{}],2:[function(e,f,t){!function(t){function o(){}function i(e){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],l(e,this)}function r(n,o){for(;3===n._state;)n=n._value;0!==n._state?(n._handled=!0,i._immediateFn(function(){var e,t=1===n._state?o.onFulfilled:o.onRejected;if(null!==t){try{e=t(n._value)}catch(e){return void a(o.promise,e)}u(o.promise,e)}else(1===n._state?u:a)(o.promise,n._value)})):n._deferreds.push(o)}function u(t,e){try{if(e===t)throw new TypeError("A promise cannot be resolved with itself.");if(e&&("object"==typeof e||"function"==typeof e)){var n=e.then;if(e instanceof i)return t._state=3,t._value=e,void c(t);if("function"==typeof n)return void l((o=n,r=e,function(){o.apply(r,arguments)}),t)}t._state=1,t._value=e,c(t)}catch(e){a(t,e)}var o,r}function a(e,t){e._state=2,e._value=t,c(e)}function c(e){2===e._state&&0===e._deferreds.length&&i._immediateFn(function(){e._handled||i._unhandledRejectionFn(e._value)});for(var t=0,n=e._deferreds.length;t<n;t++)r(e,e._deferreds[t]);e._deferreds=null}function s(e,t,n){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.promise=n}function l(e,t){var n=!1;try{e(function(e){n||(n=!0,u(t,e))},function(e){n||(n=!0,a(t,e))})}catch(e){if(n)return;n=!0,a(t,e)}}var n=setTimeout;i.prototype.catch=function(e){return this.then(null,e)},i.prototype.then=function(e,t){var n=new this.constructor(o);return r(this,new s(e,t,n)),n},i.all=function(e){var a=Array.prototype.slice.call(e);return new i(function(r,i){if(0===a.length)return r([]);for(var u=a.length,e=0;e<a.length;e++)!function t(n,e){try{if(e&&("object"==typeof e||"function"==typeof e)){var o=e.then;if("function"==typeof o)return o.call(e,function(e){t(n,e)},i),0}a[n]=e,0==--u&&r(a)}catch(e){i(e)}}(e,a[e])})},i.resolve=function(t){return t&&"object"==typeof t&&t.constructor===i?t:new i(function(e){e(t)})},i.reject=function(n){return new i(function(e,t){t(n)})},i.race=function(r){return new i(function(e,t){for(var n=0,o=r.length;n<o;n++)r[n].then(e,t)})},i._immediateFn="function"==typeof t?function(e){t(e)}:function(e){n(e,0)},i._unhandledRejectionFn=function(e){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",e)},i._setImmediateFn=function(e){i._immediateFn=e},i._setUnhandledRejectionFn=function(e){i._unhandledRejectionFn=e},void 0!==f&&f.exports?f.exports=i:this.Promise||(this.Promise=i)}.call(this,e("timers").setImmediate)},{timers:3}],3:[function(c,e,s){!function(e,t){var o=c("process/browser.js").nextTick,n=Function.prototype.apply,r=Array.prototype.slice,i={},u=0;function a(e,t){this._id=e,this._clearFn=t}s.setTimeout=function(){return new a(n.call(setTimeout,window,arguments),clearTimeout)},s.setInterval=function(){return new a(n.call(setInterval,window,arguments),clearInterval)},s.clearTimeout=s.clearInterval=function(e){e.close()},a.prototype.unref=a.prototype.ref=function(){},a.prototype.close=function(){this._clearFn.call(window,this._id)},s.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},s.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},s._unrefActive=s.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;0<=t&&(e._idleTimeoutId=setTimeout(function(){e._onTimeout&&e._onTimeout()},t))},s.setImmediate="function"==typeof e?e:function(e){var t=u++,n=!(arguments.length<2)&&r.call(arguments,1);return i[t]=!0,o(function(){i[t]&&(n?e.apply(null,n):e.call(null),s.clearImmediate(t))}),t},s.clearImmediate="function"==typeof t?t:function(e){delete i[e]}}.call(this,c("timers").setImmediate,c("timers").clearImmediate)},{"process/browser.js":1,timers:3}],4:[function(e,t,n){var o=e("promise-polyfill"),e="undefined"!=typeof window?window:Function("return this;")();t.exports={boltExport:e.Promise||o}},{"promise-polyfill":2}]},{},[4])(4)});function Fn(e){setTimeout(function(){throw e},0)}function Pn(e){return zn(function(){return new Ln(e)})}var Ln=G.exports.boltExport,Vn=function(e){function o(e){r()?i(e):t.push(e)}var n=Y.none(),t=[],r=function(){return n.isSome()},i=function(t){n.each(function(e){setTimeout(function(){t(e)},0)})};return e(function(e){r()||(n=Y.some(e),de(t,i),t=[])}),{get:o,map:function(n){return Vn(function(t){o(function(e){t(n(e))})})},isReady:r}},Hn={nu:Vn,pure:function(t){return Vn(function(e){e(t)})}},zn=function(n){function e(e){n().then(e,Fn)}return{map:function(e){return zn(function(){return n().then(e)})},bind:function(t){return zn(function(){return n().then(function(e){return t(e).toPromise()})})},anonBind:function(e){return zn(function(){return n().then(function(){return e.toPromise()})})},toLazy:function(){return Hn.nu(e)},toCached:function(){var e=null;return zn(function(){return e=null===e?n():e})},toPromise:n,get:e}},jn=function(n){return{is:function(e){return n===e},isValue:q,isError:W,getOr:_(n),getOrThunk:_(n),getOrDie:_(n),or:function(e){return jn(n)},orThunk:function(e){return jn(n)},fold:function(e,t){return t(n)},map:function(e){return jn(e(n))},mapError:function(e){return jn(n)},each:function(e){e(n)},bind:function(e){return e(n)},exists:function(e){return e(n)},forall:function(e){return e(n)},toOptional:function(){return Y.some(n)}}},Un=function(n){return{is:W,isValue:W,isError:q,getOr:t,getOrThunk:function(e){return e()},getOrDie:function(){return c(String(n))()},or:function(e){return e},orThunk:function(e){return e()},fold:function(e,t){return e(n)},map:function(e){return Un(n)},mapError:function(e){return Un(e(n))},each:U,bind:function(e){return Un(n)},exists:W,forall:q,toOptional:Y.none}},Wn={value:jn,error:Un,fromOption:function(e,t){return e.fold(function(){return Un(t)},jn)}},e=function(u){if(!ne(u))throw new Error("cases must be an array");if(0===u.length)throw new Error("there must be at least one case");var a=[],n={};return de(u,function(e,o){var t=pe(e);if(1!==t.length)throw new Error("one and only one name per case");var r=t[0],i=e[r];if(void 0!==n[r])throw new Error("duplicate key detected:"+r);if("cata"===r)throw new Error("cannot have a case named cata (sorry)");if(!ne(i))throw new Error("case arguments must be an array");a.push(r),n[r]=function(){var e=arguments.length;if(e!==i.length)throw new Error("Wrong number of arguments to case "+r+". Expected "+i.length+" ("+i+"), got "+e);for(var n=new Array(e),t=0;t<n.length;t++)n[t]=arguments[t];return{fold:function(){if(arguments.length!==u.length)throw new Error("Wrong number of arguments to fold. Expected "+u.length+", got "+arguments.length);return arguments[o].apply(null,n)},match:function(e){var t=pe(e);if(a.length!==t.length)throw new Error("Wrong number of arguments to match. Expected: "+a.join(",")+"\nActual: "+t.join(","));if(!A(a,function(e){return ee(t,e)}))throw new Error("Not all branches were specified when using match. Specified: "+t.join(", ")+"\nRequired: "+a.join(", "));return e[r].apply(null,n)},log:function(e){console.log(e,{constructors:a,constructor:r,params:n})}}}}),n},qn=(e([{bothErrors:["error1","error2"]},{firstError:["error1","value2"]},{secondError:["value1","error2"]},{bothValues:["value1","value2"]}]),function(e){return e.fold(t,t)});function Gn(e,t,n,o,r){return e(n,o)?Y.some(n):ae(r)&&r(n)?Y.none():t(n,o,r)}function $n(e,t,n){for(var o=e.dom,r=ae(n)?n:W;o.parentNode;){var o=o.parentNode,i=Jt.fromDom(o);if(t(i))return Y.some(i);if(r(i))break}return Y.none()}function Xn(e,t,n){return Gn(function(e,t){return t(e)},$n,e,t,n)}function Yn(e,t,n){return $n(e,function(e){return Ie(e,t)},n)}function Kn(e,t){return t=t,e=void 0===e?document:e.dom,Fe(e)?Y.none():Y.from(e.querySelector(t)).map(Jt.fromDom)}function Jn(e,t,n){return Gn(Ie,Yn,e,t,n)}var Qn,Zn,eo,to,no=window.Promise||(Qn=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},eo=(Zn=function(e){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");this._state=null,this._value=null,this._deferreds=[],so(e,oo(io,this),oo(uo,this))}).immediateFn||"function"==typeof setImmediate&&setImmediate||function(e){setTimeout(e,1)},Zn.prototype.catch=function(e){return this.then(null,e)},Zn.prototype.then=function(n,o){var r=this;return new Zn(function(e,t){ro.call(r,new co(n,o,e,t))})},Zn.all=function(){var a=Array.prototype.slice.call(1===arguments.length&&Qn(arguments[0])?arguments[0]:arguments);return new Zn(function(r,i){if(0===a.length)return r([]);for(var u=a.length,e=0;e<a.length;e++)!function t(n,e){try{if(e&&("object"==typeof e||"function"==typeof e)){var o=e.then;if("function"==typeof o)return o.call(e,function(e){t(n,e)},i),0}a[n]=e,0==--u&&r(a)}catch(e){i(e)}}(e,a[e])})},Zn.resolve=function(t){return t&&"object"==typeof t&&t.constructor===Zn?t:new Zn(function(e){e(t)})},Zn.reject=function(n){return new Zn(function(e,t){t(n)})},Zn.race=function(r){return new Zn(function(e,t){for(var n=0,o=r.length;n<o;n++)r[n].then(e,t)})},Zn);function oo(e,t){return function(){e.apply(t,arguments)}}function ro(n){var o=this;null!==this._state?eo(function(){var e,t=o._state?n.onFulfilled:n.onRejected;if(null!==t){try{e=t(o._value)}catch(e){return void n.reject(e)}n.resolve(e)}else(o._state?n.resolve:n.reject)(o._value)}):this._deferreds.push(n)}function io(e){try{if(e===this)throw new TypeError("A promise cannot be resolved with itself.");if(e&&("object"==typeof e||"function"==typeof e)){var t=e.then;if("function"==typeof t)return void so(oo(t,e),oo(io,this),oo(uo,this))}this._state=!0,this._value=e,ao.call(this)}catch(e){uo.call(this,e)}}function uo(e){this._state=!1,this._value=e,ao.call(this)}function ao(){for(var e=0,t=this._deferreds.length;e<t;e++)ro.call(this,this._deferreds[e]);this._deferreds=null}function co(e,t,n,o){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.resolve=n,this.reject=o}function so(e,t,n){var o=!1;try{e(function(e){o||(o=!0,t(e))},function(e){o||(o=!0,n(e))})}catch(e){if(o)return;o=!0,n(e)}}function lo(e,t){return"number"!=typeof t&&(t=0),setTimeout(e,t)}function fo(e,t){return"number"!=typeof t&&(t=1),setInterval(e,t)}var Rt=function(n,o){function e(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];clearTimeout(r),r=lo(function(){n.apply(this,e)},o)}var r;return e.stop=function(){clearTimeout(r)},e},mo={requestAnimationFrame:function(e,t){to?to.then(e):to=new no(function(e){!function(e,t){for(var n=window.requestAnimationFrame,o=["ms","moz","webkit"],r=0;r<o.length&&!n;r++)n=window[o[r]+"RequestAnimationFrame"];(n=n||function(e){window.setTimeout(e,0)})(e,t)}(e,t=t||document.body)}).then(e)},setTimeout:lo,setInterval:fo,setEditorTimeout:function(e,t,n){return lo(function(){e.removed||t()},n)},setEditorInterval:function(e,t,n){var o=fo(function(){e.removed?clearInterval(o):t()},n);return o},debounce:Rt,throttle:Rt,clearInterval:function(e){return clearInterval(e)},clearTimeout:function(e){return clearTimeout(e)}};function go(l,f){void 0===f&&(f={});function n(e,t,n){var o,e=Kt._addCacheSuffix(e),r=te(m,e).getOrThunk(function(){return{id:"mce-u"+d++,passed:[],failed:[],count:0}});function i(e,t){for(var n=e.length;n--;)e[n]();r.status=t,r.passed=[],r.failed=[],o&&(o.onload=null,o.onerror=null,o=null)}function u(){return i(r.passed,2),0}function a(){return i(r.failed,3)}(m[e]=r).count++;var c,s=function(){var e=s;!function(){for(var e=l.styleSheets,t=e.length;t--;){var n=e[t].ownerNode;if(n&&n.id===o.id)return u(),1}}()&&(Date.now()-c<h?mo.setTimeout(e):a())};t&&r.passed.push(t),n&&r.failed.push(n),1!==r.status&&(2!==r.status?3!==r.status?(r.status=1,t=Jt.fromTag("link",p.dom),mt(t,{rel:"stylesheet",type:"text/css",id:r.id}),c=Date.now(),f.contentCssCors&&dt(t,"crossOrigin","anonymous"),f.referrerPolicy&&dt(t,"referrerpolicy",f.referrerPolicy),(o=t.dom).onload=s,o.onerror=a,n=t,mn(Ye(g),n),dt(t,"href",e)):a():u())}function o(t){return Pn(function(e){n(t,r(e,_(Wn.value(t))),r(e,_(Wn.error(t))))})}function t(e){var n=Kt._addCacheSuffix(e);te(m,n).each(function(e){var t;0==--e.count&&(delete m[n],t=e.id,e=Ye(g),Kn(e,"#"+t).each(gn))})}var d=0,m={},g=Jt.fromDom(l),p=ze(g),h=f.maxLoadTime||5e3;return{load:n,loadAll:function(e,t,n){var u,e=E(e,o);u=e,Pn(function(o){var r=[],i=0;0===u.length?o([]):de(u,function(e,t){var n;e.get((n=t,function(e){r[n]=e,++i>=u.length&&o(r)}))})}).get(function(e){e=function(e){for(var t=[],n=[],o=0,r=e.length;o<r;o++){var i=e[o];(i.isValue()?t:n).push(i)}return{pass:t,fail:n}}(e);0<e.fail.length?n(e.fail.map(qn)):t(e.pass.map(qn))})},unload:t,unloadAll:function(e){de(e,function(e){t(e)})},_setReferrerPolicy:function(e){f.referrerPolicy=e}}}var po,ho=(po=new WeakMap,{forElement:function(e,t){var n=sn(e).dom;return Y.from(po.get(n)).getOrThunk(function(){var e=go(n,t);return po.set(n,e),e})}}),vo=(bo.prototype.current=function(){return this.node},bo.prototype.next=function(e){return this.node=this.findSibling(this.node,"firstChild","nextSibling",e),this.node},bo.prototype.prev=function(e){return this.node=this.findSibling(this.node,"lastChild","previousSibling",e),this.node},bo.prototype.prev2=function(e){return this.node=this.findPreviousNode(this.node,"lastChild","previousSibling",e),this.node},bo.prototype.findSibling=function(e,t,n,o){var r,i;if(e){if(!o&&e[t])return e[t];if(e!==this.rootNode){if(r=e[n])return r;for(i=e.parentNode;i&&i!==this.rootNode;i=i.parentNode)if(r=i[n])return r}}},bo.prototype.findPreviousNode=function(e,t,n,o){var r,i;if(e&&(r=e[n],!this.rootNode||r!==this.rootNode)){if(r){if(!o)for(i=r[t];i;i=i[t])if(!i[t])return i;return r}return(e=e.parentNode)&&e!==this.rootNode?e:void 0}},bo);function bo(e,t){this.node=e,this.rootNode=t,this.current=this.current.bind(this),this.next=this.next.bind(this),this.prev=this.prev.bind(this),this.prev2=this.prev2.bind(this)}function yo(e){return Zt(e)&&!Wo(e)}function xo(e){return Zt(e)&&"br"===Qt(e)}function wo(e){return e===Jo}function Co(e){return e.replace(/\uFEFF/g,"")}function So(e){return tr(e)&&(e=e.parentNode),er(e)&&e.hasAttribute("data-mce-caret")}function ko(e){return tr(e)&&wo(e.data)}function Oo(e){return So(e)||ko(e)}function _o(e){return e.firstChild!==e.lastChild||!On(e.firstChild)}function Eo(e){var t=e.container();return!!wn(t)&&(t.data.charAt(e.offset())===Zo||e.isAtStart()&&ko(t.previousSibling))}function To(e){var t=e.container();return!!wn(t)&&(t.data.charAt(e.offset()-1)===Zo||e.isAtEnd()&&ko(t.nextSibling))}function Do(e){return tr(e)&&e.data[0]===Zo}function Ao(e){return tr(e)&&e.data[e.data.length-1]===Zo}function Bo(e){return e&&e.hasAttribute("data-mce-caret")?(t=(t=e.getElementsByTagName("br"))[t.length-1],ct(t)&&t.parentNode.removeChild(t),e.removeAttribute("data-mce-caret"),e.removeAttribute("data-mce-bogus"),e.removeAttribute("style"),e.removeAttribute("_moz_abspos"),e):null;var t}function No(e){return!sr(e)&&(ir(e)?!ur(e.parentNode):ar(e)||rr(e)||cr(e)||lr(e))}function Ro(e,t){return No(e)&&function(e,t){for(e=e.parentNode;e&&e!==t;e=e.parentNode){if(lr(e))return!1;if(nr(e))return!0}return!0}(e,t)}function Mo(e,t){return No(e)&&!1===(o=t,wn(t=e)&&dr(t.data)&&!1===(t=t,n=o,n=Jt.fromDom(n),t=Jt.fromDom(t),n=w(Pe,n),Yn(t,"pre,code",n).isSome()))||yn(n=e)&&"A"===n.nodeName&&!n.hasAttribute("href")&&(n.hasAttribute("name")||n.hasAttribute("id"))||mr(e);var n,o}function Io(e){return yn(e)&&"all"===e.getAttribute("data-mce-bogus")}function Fo(e,t){return function(e,t){var n,o=0;if(Mo(e,e))return!1;if(!(n=e.firstChild))return!0;var r=new vo(n,e);do{if(t){if(Io(n)){n=r.next(!0);continue}if(gr(n)){n=r.next();continue}}if(On(n))o++,n=r.next();else{if(Mo(n,e))return!1;n=r.next()}}while(n);return o<=1}(e.dom,t=void 0===t?!0:t)}function Po(e,t){return k(e)&&(Mo(e,t)||yo(Jt.fromDom(e)))}function Lo(e){return"span"===e.nodeName.toLowerCase()&&"bookmark"===e.getAttribute("data-mce-type")}function Vo(e,t){var n,o,r,i={};if(e){for(e=e.split(","),t=t||10,n=0;n<e.length;n+=2)o=String.fromCharCode(parseInt(e[n],t)),Cr[o]||(r="&"+e[n+1]+";",i[o]=r,i[r]=o);return i}}function Ho(e,t){return e.replace(t?vr:br,function(e){return Cr[e]||e})}function zo(e,t){return e.replace(t?vr:br,function(e){return 1<e.length?"&#"+(1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320)+65536)+";":Cr[e]||"&#"+e.charCodeAt(0)+";"})}function jo(e,t,n){return n=n||kr,e.replace(t?vr:br,function(e){return Cr[e]||n[e]||e})}var J=function(t){var n;return function(e){return(n=n||function(e,t){for(var n={},o=0,r=e.length;o<r;o++){var i=e[o];n[String(i)]=t(i,o)}return n}(t,q)).hasOwnProperty(Qt(e))}},Uo=J(["h1","h2","h3","h4","h5","h6"]),Wo=J(["article","aside","details","div","dt","figcaption","footer","form","fieldset","header","hgroup","html","main","nav","section","summary","body","p","dl","multicol","dd","figure","address","center","blockquote","h1","h2","h3","h4","h5","h6","listing","xmp","pre","plaintext","menu","dir","ul","ol","li","hr","table","tbody","thead","tfoot","th","tr","td","caption"]),qo=J(["h1","h2","h3","h4","h5","h6","p","div","address","pre","form","blockquote","center","dir","fieldset","header","footer","article","section","hgroup","aside","nav","figure"]),Go=J(["ul","ol","dl"]),$o=J(["li","dd","dt"]),Xo=J(["thead","tbody","tfoot"]),Yo=J(["td","th"]),Ko=J(["pre","script","textarea","style"]),Jo="\ufeff",Qo=" ",Zo=Jo,er=yn,tr=wn,nr=En,or=Tn,rr=On,ir=wn,ur=at(["script","style","textarea"]),ar=at(["img","input","textarea","hr","iframe","video","audio","object","embed"]),cr=at(["table"]),sr=Oo,lr=function(e){return!1===(yn(t=e)&&"true"===t.getAttribute("unselectable"))&&or(e);var t},fr=/^[ \t\r\n]*$/,dr=function(e){return fr.test(e)},mr=Dt("data-mce-bookmark"),gr=Dt("data-mce-bogus"),pr=function(e,t,n){var o=n||t;if(yn(t)&&Lo(t))return t;for(var r,i,u=t.childNodes,a=u.length-1;0<=a;a--)pr(e,u[a],o);return!yn(t)||1===(r=t.childNodes).length&&Lo(r[0])&&t.parentNode.insertBefore(r[0],t),kn(n=t)||Sn(n)||Mo(t,o)||yn(i=t)&&0<i.childNodes.length||(r=o,wn(n=t)&&0<n.data.length&&(r=new vo(i=n,n=r).prev(!1),i=new vo(i,n).next(!1),r=ie(r)||Po(r,n),n=ie(i)||Po(i,n),r&&n))||e.remove(t),t},hr=Kt.makeMap,vr=/[&<>\"\u0060\u007E-\uD7FF\uE000-\uFFEF]|[\uD800-\uDBFF][\uDC00-\uDFFF]/g,br=/[<>&\u007E-\uD7FF\uE000-\uFFEF]|[\uD800-\uDBFF][\uDC00-\uDFFF]/g,yr=/[<>&\"\']/g,xr=/&#([a-z0-9]+);?|&([a-z0-9]+);/gi,wr={128:"€",130:"‚",131:"ƒ",132:"„",133:"…",134:"†",135:"‡",136:"ˆ",137:"‰",138:"Š",139:"‹",140:"Œ",142:"Ž",145:"‘",146:"’",147:"“",148:"”",149:"•",150:"–",151:"—",152:"˜",153:"™",154:"š",155:"›",156:"œ",158:"ž",159:"Ÿ"},Cr={'"':"&quot;","'":"&#39;","<":"&lt;",">":"&gt;","&":"&amp;","`":"&#96;"},Sr={"&lt;":"<","&gt;":">","&amp;":"&","&quot;":'"',"&apos;":"'"},kr=Vo("50,nbsp,51,iexcl,52,cent,53,pound,54,curren,55,yen,56,brvbar,57,sect,58,uml,59,copy,5a,ordf,5b,laquo,5c,not,5d,shy,5e,reg,5f,macr,5g,deg,5h,plusmn,5i,sup2,5j,sup3,5k,acute,5l,micro,5m,para,5n,middot,5o,cedil,5p,sup1,5q,ordm,5r,raquo,5s,frac14,5t,frac12,5u,frac34,5v,iquest,60,Agrave,61,Aacute,62,Acirc,63,Atilde,64,Auml,65,Aring,66,AElig,67,Ccedil,68,Egrave,69,Eacute,6a,Ecirc,6b,Euml,6c,Igrave,6d,Iacute,6e,Icirc,6f,Iuml,6g,ETH,6h,Ntilde,6i,Ograve,6j,Oacute,6k,Ocirc,6l,Otilde,6m,Ouml,6n,times,6o,Oslash,6p,Ugrave,6q,Uacute,6r,Ucirc,6s,Uuml,6t,Yacute,6u,THORN,6v,szlig,70,agrave,71,aacute,72,acirc,73,atilde,74,auml,75,aring,76,aelig,77,ccedil,78,egrave,79,eacute,7a,ecirc,7b,euml,7c,igrave,7d,iacute,7e,icirc,7f,iuml,7g,eth,7h,ntilde,7i,ograve,7j,oacute,7k,ocirc,7l,otilde,7m,ouml,7n,divide,7o,oslash,7p,ugrave,7q,uacute,7r,ucirc,7s,uuml,7t,yacute,7u,thorn,7v,yuml,ci,fnof,sh,Alpha,si,Beta,sj,Gamma,sk,Delta,sl,Epsilon,sm,Zeta,sn,Eta,so,Theta,sp,Iota,sq,Kappa,sr,Lambda,ss,Mu,st,Nu,su,Xi,sv,Omicron,t0,Pi,t1,Rho,t3,Sigma,t4,Tau,t5,Upsilon,t6,Phi,t7,Chi,t8,Psi,t9,Omega,th,alpha,ti,beta,tj,gamma,tk,delta,tl,epsilon,tm,zeta,tn,eta,to,theta,tp,iota,tq,kappa,tr,lambda,ts,mu,tt,nu,tu,xi,tv,omicron,u0,pi,u1,rho,u2,sigmaf,u3,sigma,u4,tau,u5,upsilon,u6,phi,u7,chi,u8,psi,u9,omega,uh,thetasym,ui,upsih,um,piv,812,bull,816,hellip,81i,prime,81j,Prime,81u,oline,824,frasl,88o,weierp,88h,image,88s,real,892,trade,89l,alefsym,8cg,larr,8ch,uarr,8ci,rarr,8cj,darr,8ck,harr,8dl,crarr,8eg,lArr,8eh,uArr,8ei,rArr,8ej,dArr,8ek,hArr,8g0,forall,8g2,part,8g3,exist,8g5,empty,8g7,nabla,8g8,isin,8g9,notin,8gb,ni,8gf,prod,8gh,sum,8gi,minus,8gn,lowast,8gq,radic,8gt,prop,8gu,infin,8h0,ang,8h7,and,8h8,or,8h9,cap,8ha,cup,8hb,int,8hk,there4,8hs,sim,8i5,cong,8i8,asymp,8j0,ne,8j1,equiv,8j4,le,8j5,ge,8k2,sub,8k3,sup,8k4,nsub,8k6,sube,8k7,supe,8kl,oplus,8kn,otimes,8l5,perp,8m5,sdot,8o8,lceil,8o9,rceil,8oa,lfloor,8ob,rfloor,8p9,lang,8pa,rang,9ea,loz,9j0,spades,9j3,clubs,9j5,hearts,9j6,diams,ai,OElig,aj,oelig,b0,Scaron,b1,scaron,bo,Yuml,m6,circ,ms,tilde,802,ensp,803,emsp,809,thinsp,80c,zwnj,80d,zwj,80e,lrm,80f,rlm,80j,ndash,80k,mdash,80o,lsquo,80p,rsquo,80q,sbquo,80s,ldquo,80t,rdquo,80u,bdquo,810,dagger,811,Dagger,81g,permil,81p,lsaquo,81q,rsaquo,85c,euro",32),Or={encodeRaw:Ho,encodeAllRaw:function(e){return(""+e).replace(yr,function(e){return Cr[e]||e})},encodeNumeric:zo,encodeNamed:jo,getEncodeFunc:function(e,t){var n=Vo(t)||kr,e=hr(e.replace(/\+/g,","));return e.named&&e.numeric?function(e,t){return e.replace(t?vr:br,function(e){return void 0!==Cr[e]?Cr[e]:void 0!==n[e]?n[e]:1<e.length?"&#"+(1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320)+65536)+";":"&#"+e.charCodeAt(0)+";"})}:e.named?t?function(e,t){return jo(e,t,n)}:jo:e.numeric?zo:Ho},decode:function(e){return e.replace(xr,function(e,t){return t?65535<(t="x"===t.charAt(0).toLowerCase()?parseInt(t.substr(1),16):parseInt(t,10))?(t-=65536,String.fromCharCode(55296+(t>>10),56320+(1023&t))):wr[t]||String.fromCharCode(t):Sr[e]||kr[e]||(t=e,(e=Jt.fromTag("div").dom).innerHTML=t,e.textContent||e.innerText||t)})}},_r={},Er={},Tr=Kt.makeMap,Dr=Kt.each,Ar=Kt.extend,Br=Kt.explode,Nr=Kt.inArray,Rr=function(e,t){return(e=Kt.trim(e))?e.split(t||" "):[]},Mr=function(e){function t(e,t,n){function o(e,t){for(var n={},o=0,r=e.length;o<r;o++)n[e[o]]=t||{};return n}var r;t=t||"","string"==typeof(n=n||[])&&(n=Rr(n));for(var i=Rr(e),u=i.length;u--;)r={attributes:o(r=Rr([a,t].join(" "))),attributesOrder:r,children:o(n,Er)},c[i[u]]=r}function n(e,t){for(var n,o,r,i=Rr(e),u=i.length,a=Rr(t);u--;)for(n=c[i[u]],o=0,r=a.length;o<r;o++)n.attributes[a[o]]={},n.attributesOrder.push(a[o])}var a,o,r,i,u,c={};return _r[e]||(a="id accesskey class dir lang style tabindex title role",o="address blockquote div dl fieldset form h1 h2 h3 h4 h5 h6 hr menu ol p pre table ul",r="a abbr b bdo br button cite code del dfn em embed i iframe img input ins kbd label map noscript object q s samp script select small span strong sub sup textarea u var #text #comment","html4"!==e&&(a+=" contenteditable contextmenu draggable dropzone hidden spellcheck translate",o+=" article aside details dialog figure main header footer hgroup section nav",r+=" audio canvas command datalist mark meter output picture progress time wbr video ruby bdi keygen"),"html5-strict"!==e&&(a+=" xml:lang",r=[r,u="acronym applet basefont big font strike tt"].join(" "),Dr(Rr(u),function(e){t(e,"",r)}),o=[o,u="center dir isindex noframes"].join(" "),i=[o,r].join(" "),Dr(Rr(u),function(e){t(e,"",i)})),i=i||[o,r].join(" "),t("html","manifest","head body"),t("head","","base command link meta noscript script style title"),t("title hr noscript br"),t("base","href target"),t("link","href rel media hreflang type sizes hreflang"),t("meta","name http-equiv content charset"),t("style","media type scoped"),t("script","src async defer type charset"),t("body","onafterprint onbeforeprint onbeforeunload onblur onerror onfocus onhashchange onload onmessage onoffline ononline onpagehide onpageshow onpopstate onresize onscroll onstorage onunload",i),t("address dt dd div caption","",i),t("h1 h2 h3 h4 h5 h6 pre p abbr code var samp kbd sub sup i b u bdo span legend em strong small s cite dfn","",r),t("blockquote","cite",i),t("ol","reversed start type","li"),t("ul","","li"),t("li","value",i),t("dl","","dt dd"),t("a","href target rel media hreflang type",r),t("q","cite",r),t("ins del","cite datetime",i),t("img","src sizes srcset alt usemap ismap width height"),t("iframe","src name width height",i),t("embed","src type width height"),t("object","data type typemustmatch name usemap form width height",[i,"param"].join(" ")),t("param","name value"),t("map","name",[i,"area"].join(" ")),t("area","alt coords shape href target rel media hreflang type"),t("table","border","caption colgroup thead tfoot tbody tr"+("html4"===e?" col":"")),t("colgroup","span","col"),t("col","span"),t("tbody thead tfoot","","tr"),t("tr","","td th"),t("td","colspan rowspan headers",i),t("th","colspan rowspan headers scope abbr",i),t("form","accept-charset action autocomplete enctype method name novalidate target",i),t("fieldset","disabled form name",[i,"legend"].join(" ")),t("label","form for",r),t("input","accept alt autocomplete checked dirname disabled form formaction formenctype formmethod formnovalidate formtarget height list max maxlength min multiple name pattern readonly required size src step type value width"),t("button","disabled form formaction formenctype formmethod formnovalidate formtarget name type value","html4"===e?i:r),t("select","disabled form multiple name required size","option optgroup"),t("optgroup","disabled label","option"),t("option","disabled label selected value"),t("textarea","cols dirname disabled form maxlength name readonly required rows wrap"),t("menu","type label",[i,"li"].join(" ")),t("noscript","",i),"html4"!==e&&(t("wbr"),t("ruby","",[r,"rt rp"].join(" ")),t("figcaption","",i),t("mark rt rp summary bdi","",r),t("canvas","width height",i),t("video","src crossorigin poster preload autoplay mediagroup loop muted controls width height buffered",[i,"track source"].join(" ")),t("audio","src crossorigin preload autoplay mediagroup loop muted controls buffered volume",[i,"track source"].join(" ")),t("picture","","img source"),t("source","src srcset type media sizes"),t("track","kind src srclang label default"),t("datalist","",[r,"option"].join(" ")),t("article section nav aside main header footer","",i),t("hgroup","","h1 h2 h3 h4 h5 h6"),t("figure","",[i,"figcaption"].join(" ")),t("time","datetime",r),t("dialog","open",i),t("command","type label icon disabled checked radiogroup command"),t("output","for form name",r),t("progress","value max",r),t("meter","value min max low high optimum",r),t("details","open",[i,"summary"].join(" ")),t("keygen","autofocus challenge disabled form keytype name")),"html5-strict"!==e&&(n("script","language xml:space"),n("style","xml:space"),n("object","declare classid code codebase codetype archive standby align border hspace vspace"),n("embed","align name hspace vspace"),n("param","valuetype type"),n("a","charset name rev shape coords"),n("br","clear"),n("applet","codebase archive code object alt name width height align hspace vspace"),n("img","name longdesc align border hspace vspace"),n("iframe","longdesc frameborder marginwidth marginheight scrolling align"),n("font basefont","size color face"),n("input","usemap align"),n("select"),n("textarea"),n("h1 h2 h3 h4 h5 h6 div p legend caption","align"),n("ul","type compact"),n("li","type"),n("ol dl menu dir","compact"),n("pre","width xml:space"),n("hr","align noshade size width"),n("isindex","prompt"),n("table","summary width frame rules cellspacing cellpadding align bgcolor"),n("col","width align char charoff valign"),n("colgroup","width align char charoff valign"),n("thead","align char charoff valign"),n("tr","align char charoff valign bgcolor"),n("th","axis align char charoff valign nowrap bgcolor width height"),n("form","accept"),n("td","abbr axis scope align char charoff valign nowrap bgcolor width height"),n("tfoot","align char charoff valign"),n("tbody","align char charoff valign"),n("area","nohref"),n("body","background bgcolor text link vlink alink")),"html4"!==e&&(n("input button select textarea","autofocus"),n("input textarea","placeholder"),n("a","download"),n("link script img","crossorigin"),n("img","loading"),n("iframe","sandbox seamless allowfullscreen loading")),Dr(Rr("a form meter progress dfn"),function(e){c[e]&&delete c[e].children[e]}),delete c.caption.children.table,delete c.script,_r[e]=c)},Ir=function(e,n){var o;return e&&(o={},Dr(e="string"==typeof e?{"*":e}:e,function(e,t){o[t]=o[t.toUpperCase()]=("map"===n?Tr:Br)(e,/[, ]/)})),o};function Fr(r){var S={},i={},k=[],u={},t={},e=function(e,t,n){var o=r[e];return o?o=Tr(o,/[, ]/,Tr(o.toUpperCase(),/[, ]/)):(o=_r[e])||(o=Tr(t," ",Tr(t.toUpperCase()," ")),o=Ar(o,n),_r[e]=o),o},n=Mr((r=r||{}).schema);!1===r.verify_html&&(r.valid_elements="*[*]");var o=Ir(r.valid_styles),a=Ir(r.invalid_styles,"map"),c=Ir(r.valid_classes,"map"),s=e("whitespace_elements","pre script noscript style textarea video audio iframe object code"),l=e("self_closing_elements","colgroup dd dt li option p td tfoot th thead tr"),f=e("short_ended_elements","area base basefont br col frame hr img input isindex link meta param embed source wbr track"),d=e("boolean_attributes","checked compact declare defer disabled ismap multiple nohref noresize noshade nowrap readonly selected autoplay loop controls"),m="td th iframe video audio object script code",g=e("non_empty_elements",m+" pre",f),p=e("move_caret_before_on_enter_elements",m+" table",f),h=e("text_block_elements","h1 h2 h3 h4 h5 h6 p div address pre form blockquote center dir fieldset header footer article section hgroup aside main nav figure"),v=e("block_elements","hr table tbody thead tfoot th tr td li ol ul caption dl dt dd noscript menu isindex option datalist select optgroup figcaption details summary",h),b=e("text_inline_elements","span strong b em i font strike u var cite dfn code mark q sup sub samp");Dr((r.special||"script noscript iframe noframes noembed title style textarea xmp").split(" "),function(e){t[e]=new RegExp("</"+e+"[^>]*>","gi")});function O(e){return new RegExp("^"+e.replace(/([?+*])/g,".$1")+"$")}function y(e){var t,n,o,r,i,u,a,c,s,l,f,d,m,g,p,h,v,b,y=/^([#+\-])?([^\[!\/]+)(?:\/([^\[!]+))?(?:(!?)\[([^\]]+)])?$/,x=/^([!\-])?(\w+[\\:]:\w+|[^=:<]+)?(?:([=:<])(.*))?$/,w=/[*?+]/;if(e){var C=Rr(e,",");for(S["@"]&&(h=S["@"].attributes,v=S["@"].attributesOrder),t=0,n=C.length;t<n;t++)if(i=y.exec(C[t])){if(g=i[1],s=i[2],p=i[3],c=i[5],u={attributes:d={},attributesOrder:m=[]},"#"===g&&(u.paddEmpty=!0),"-"===g&&(u.removeEmpty=!0),"!"===i[4]&&(u.removeEmptyAttrs=!0),h&&(ve(h,function(e,t){d[t]=e}),m.push.apply(m,v)),c)for(o=0,r=(c=Rr(c,"|")).length;o<r;o++)if(i=x.exec(c[o])){if(a={},f=i[1],l=i[2].replace(/[\\:]:/g,":"),g=i[3],b=i[4],"!"===f&&(u.attributesRequired=u.attributesRequired||[],u.attributesRequired.push(l),a.required=!0),"-"===f){delete d[l],m.splice(Nr(m,l),1);continue}g&&("="===g&&(u.attributesDefault=u.attributesDefault||[],u.attributesDefault.push({name:l,value:b}),a.defaultValue=b),":"===g&&(u.attributesForced=u.attributesForced||[],u.attributesForced.push({name:l,value:b}),a.forcedValue=b),"<"===g&&(a.validValues=Tr(b,"?"))),w.test(l)?(u.attributePatterns=u.attributePatterns||[],a.pattern=O(l),u.attributePatterns.push(a)):(d[l]||m.push(l),d[l]=a)}h||"@"!==s||(h=d,v=m),p&&(u.outputName=s,S[p]=u),w.test(s)?(u.pattern=O(s),k.push(u)):S[s]=u}}}function x(e){S={},k=[],y(e),Dr(n,function(e,t){i[t]=e.children})}function w(e){var t,n=S[e];if(n)return n;for(t=k.length;t--;)if((n=k[t]).pattern.test(e))return n}m=function(e){var r=/^(~)?(.+)$/;e&&(_r.text_block_elements=_r.block_elements=null,Dr(Rr(e,","),function(e){var t=r.exec(e),e="~"===t[1],n=e?"span":"div",o=t[2];i[o]=i[n],u[o]=n,e||(v[o.toUpperCase()]={},v[o]={}),S[o]||(e=S[n],delete(e=Ar({},e)).removeEmptyAttrs,delete e.removeEmpty,S[o]=e),Dr(i,function(e,t){e[n]&&(i[t]=e=Ar({},i[t]),e[o]=e[n])})}))},e=function(e){var o=/^([+\-]?)([A-Za-z0-9_\-.\u00b7\u00c0-\u00d6\u00d8-\u00f6\u00f8-\u037d\u037f-\u1fff\u200c-\u200d\u203f-\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]+)\[([^\]]+)]$/;_r[r.schema]=null,e&&Dr(Rr(e,","),function(e){var t,n,e=o.exec(e);e&&(n=e[1],t=n?i[e[2]]:i[e[2]]={"#comment":{}},t=i[e[2]],Dr(Rr(e[3],"|"),function(e){"-"===n?delete t[e]:t[e]={}}))})};return r.valid_elements?x(r.valid_elements):(Dr(n,function(e,t){S[t]={attributes:e.attributes,attributesOrder:e.attributesOrder},i[t]=e.children}),"html5"!==r.schema&&Dr(Rr("strong/b em/i"),function(e){e=Rr(e,"/");S[e[1]].outputName=e[0]}),Dr(Rr("ol ul sub sup blockquote span font a table tbody strong em b i"),function(e){S[e]&&(S[e].removeEmpty=!0)}),Dr(Rr("p h1 h2 h3 h4 h5 h6 th td pre div address caption li"),function(e){S[e].paddEmpty=!0}),Dr(Rr("span"),function(e){S[e].removeEmptyAttrs=!0})),m(r.custom_elements),e(r.valid_children),y(r.extended_valid_elements),e("+ol[ul|ol],+ul[ul|ol]"),Dr({dd:"dl",dt:"dl",li:"ul ol",td:"tr",th:"tr",tr:"tbody thead tfoot",tbody:"table",thead:"table",tfoot:"table",legend:"fieldset",area:"map",param:"video audio object"},function(e,t){S[t]&&(S[t].parentsRequired=Rr(e))}),r.invalid_elements&&Dr(Br(r.invalid_elements),function(e){S[e]&&delete S[e]}),w("span")||y("span[!data-mce-type|*]"),{children:i,elements:S,getValidStyles:function(){return o},getValidClasses:function(){return c},getBlockElements:function(){return v},getInvalidStyles:function(){return a},getShortEndedElements:function(){return f},getTextBlockElements:function(){return h},getTextInlineElements:function(){return b},getBoolAttrs:function(){return d},getElementRule:w,getSelfClosingElements:function(){return l},getNonEmptyElements:function(){return g},getMoveCaretBeforeOnEnterElements:function(){return p},getWhiteSpaceElements:function(){return s},getSpecialElements:function(){return t},isValidChild:function(e,t){e=i[e.toLowerCase()];return!(!e||!e[t.toLowerCase()])},isValid:function(e,t){var n,o,r=w(e);if(r){if(!t)return!0;if(r.attributes[t])return!0;if(n=r.attributePatterns)for(o=n.length;o--;)if(n[o].pattern.test(e))return!0}return!1},getCustomElements:function(){return u},addValidElements:y,setValidElements:x,addCustomElements:m,addValidChildren:e}}function Pr(e,t,n,o){function r(e){return 1<(e=parseInt(e,10).toString(16)).length?e:"0"+e}return"#"+r(t)+r(n)+r(o)}function Lr(){return!1}function Vr(){return!0}function Hr(e,t,n,o){e.addEventListener?e.addEventListener(t,n,o||!1):e.attachEvent&&e.attachEvent("on"+t,n)}function zr(e,t,n,o){e.removeEventListener?e.removeEventListener(t,n,o||!1):e.detachEvent&&e.detachEvent("on"+t,n)}function jr(e,t){var n,o,r=t||{};for(n in e)qr[n]||(r[n]=e[n]);return r.target||(r.target=r.srcElement||document),r.composedPath&&(r.composedPath=function(){return e.composedPath()}),e&&Wr.test(e.type)&&void 0===e.pageX&&void 0!==e.clientX&&(t=(o=r.target.ownerDocument||document).documentElement,o=o.body,r.pageX=e.clientX+(t&&t.scrollLeft||o&&o.scrollLeft||0)-(t&&t.clientLeft||o&&o.clientLeft||0),r.pageY=e.clientY+(t&&t.scrollTop||o&&o.scrollTop||0)-(t&&t.clientTop||o&&o.clientTop||0)),r.preventDefault=function(){r.isDefaultPrevented=Vr,e&&(e.preventDefault?e.preventDefault():e.returnValue=!1)},r.stopPropagation=function(){r.isPropagationStopped=Vr,e&&(e.stopPropagation?e.stopPropagation():e.cancelBubble=!0)},!(r.stopImmediatePropagation=function(){r.isImmediatePropagationStopped=Vr,r.stopPropagation()})==(r.isDefaultPrevented===Vr||r.isDefaultPrevented===Lr)&&(r.isDefaultPrevented=Lr,r.isPropagationStopped=Lr,r.isImmediatePropagationStopped=Lr),void 0===r.metaKey&&(r.metaKey=!1),r}var Ur=function(h,e){var a,r,v=/rgb\s*\(\s*([0-9]+)\s*,\s*([0-9]+)\s*,\s*([0-9]+)\s*\)/gi,b=/(?:url(?:(?:\(\s*\"([^\"]+)\"\s*\))|(?:\(\s*\'([^\']+)\'\s*\))|(?:\(\s*([^)\s]+)\s*\))))|(?:\'([^\']+)\')|(?:\"([^\"]+)\")/gi,y=/\s*([^:]+):\s*([^;]+);?/g,x=/\s+$/,w={},C=Jo;h=h||{},e&&(a=e.getValidStyles(),r=e.getInvalidStyles());for(var t=("\\\" \\' \\; \\: ; : "+C).split(" "),S=0;S<t.length;S++)w[t[S]]=C+S,w[C+S]=t[S];return{toHex:function(e){return e.replace(v,Pr)},parse:function(e){function t(e){var t,n=d[e];if(n){for(t=(n=n.split(" ")).length;t--;)if(n[t]!==n[0])return;return d[e]=n[0],1}}function n(e){return s=!0,w[e]}function u(e,t){return s&&(e=e.replace(/\uFEFF[0-9]/g,function(e){return w[e]})),e=!t?e.replace(/\\([\'\";:])/g,"$1"):e}function o(e){return String.fromCharCode(parseInt(e.slice(1),16))}function r(e){return e.replace(/\\[0-9a-f]+/gi,o)}function i(e,t,n,o,r,i){if(r=r||i)return"'"+(r=u(r)).replace(/\'/g,"\\'")+"'";if(t=u(t||n||o),!h.allow_script_urls){o=t.replace(/[\s\r\n]+/g,"");if(/(java|vb)script:/i.test(o))return"";if(!h.allow_svg_data_urls&&/^data:image\/svg/i.test(o))return""}return"url('"+(t=m?m.call(g,t,"style"):t).replace(/\'/g,"\\'")+"')"}var a,c,s,l,f,d={},m=h.url_converter,g=h.url_converter_scope||this,p=function(e,t,n){var o=d[e+"-top"+t];if(o){var r=d[e+"-right"+t];if(r){var i=d[e+"-bottom"+t];if(i){var u=d[e+"-left"+t];if(u){var a=[o,r,i,u];for(S=a.length-1;S--&&a[S]===a[S+1];);-1<S&&n||(d[e+t]=-1===S?a[0]:a.join(" "),delete d[e+"-top"+t],delete d[e+"-right"+t],delete d[e+"-bottom"+t],delete d[e+"-left"+t])}}}}};if(e){for(e=(e=e.replace(/[\u0000-\u001F]/g,"")).replace(/\\[\"\';:\uFEFF]/g,n).replace(/\"[^\"]+\"|\'[^\']+\'/g,function(e){return e.replace(/[;:]/g,n)});c=y.exec(e);)if(y.lastIndex=c.index+c[0].length,a=c[1].replace(x,"").toLowerCase(),c=c[2].replace(x,""),a&&c){if(a=r(a),c=r(c),-1!==a.indexOf(C)||-1!==a.indexOf('"'))continue;if(!h.allow_script_urls&&("behavior"===a||/expression\s*\(|\/\*|\*\//.test(c)))continue;"font-weight"===a&&"700"===c?c="bold":"color"!==a&&"background-color"!==a||(c=c.toLowerCase()),c=(c=c.replace(v,Pr)).replace(b,i),d[a]=s?u(c,!0):c}p("border","",!0),p("border","-width"),p("border","-color"),p("border","-style"),p("padding",""),p("margin",""),l="border-style",f="border-color",t(p="border-width")&&t(l)&&t(f)&&(d.border=d[p]+" "+d[l]+" "+d[f],delete d[p],delete d[l],delete d[f]),"medium none"===d.border&&delete d.border,"none"===d["border-image"]&&delete d["border-image"]}return d},serialize:function(i,o){function e(e){var t,n=a[e];if(n)for(var o=0,r=n.length;o<r;o++)e=n[o],(t=i[e])&&(u+=(0<u.length?" ":"")+e+": "+t+";")}var u="";return o&&a?(e("*"),e(o)):ve(i,function(e,t){var n;!e||r&&((n=r["*"])&&n[t]||(n=r[o])&&n[t])||(u+=(0<u.length?" ":"")+t+": "+e+";")}),u}}},Wr=/^(?:mouse|contextmenu)|click/,qr={keyLocation:1,layerX:1,layerY:1,returnValue:1,webkitMovementX:1,webkitMovementY:1,keyIdentifier:1,mozPressure:1},Gr=($r.prototype.bind=function(e,t,n,o){function r(e){f.executeHandlers(jr(e||d.event),i)}var i,u,a,c,s,l,f=this,d=window;if(e&&3!==e.nodeType&&8!==e.nodeType){e[f.expando]?i=e[f.expando]:(i=f.count++,e[f.expando]=i,f.events[i]={}),o=o||e;for(var m=t.split(" "),g=m.length;g--;)s=r,c=l=!1,"DOMContentLoaded"===(a=m[g])&&(a="ready"),f.domLoaded&&"ready"===a&&"complete"===e.readyState?n.call(o,jr({type:a})):(f.hasMouseEnterLeave||(c=f.mouseEnterLeave[a])&&(s=function(e){var t=e.currentTarget,n=e.relatedTarget;if(n&&t.contains)n=t.contains(n);else for(;n&&n!==t;)n=n.parentNode;n||((e=jr(e||d.event)).type="mouseout"===e.type?"mouseleave":"mouseenter",e.target=t,f.executeHandlers(e,i))}),f.hasFocusIn||"focusin"!==a&&"focusout"!==a||(l=!0,c="focusin"===a?"focus":"blur",s=function(e){(e=jr(e||d.event)).type="focus"===e.type?"focusin":"focusout",f.executeHandlers(e,i)}),(u=f.events[i][a])?"ready"===a&&f.domLoaded?n(jr({type:a})):u.push({func:n,scope:o}):(f.events[i][a]=u=[{func:n,scope:o}],u.fakeName=c,u.capture=l,u.nativeHandler=s,"ready"===a?function(e,t,n){var o,r=e.document,i={type:"ready"};n.domLoaded?t(i):(o=function(){zr(e,"DOMContentLoaded",o),zr(e,"load",o),n.domLoaded||(n.domLoaded=!0,t(i)),e=null},"complete"===r.readyState||"interactive"===r.readyState&&r.body?o():Hr(e,"DOMContentLoaded",o),n.domLoaded||Hr(e,"load",o))}(e,s,f):Hr(e,c||a,s,l)));return e=u=null,n}},$r.prototype.unbind=function(n,e,t){var o,r,i;if(!n||3===n.nodeType||8===n.nodeType)return this;var u=n[this.expando];if(u){if(i=this.events[u],e){for(var a,c,s,l,f=e.split(" "),d=f.length;d--;)if(l=i[r=f[d]]){if(t)for(o=l.length;o--;)l[o].func===t&&(a=l.nativeHandler,c=l.fakeName,s=l.capture,(l=l.slice(0,o).concat(l.slice(o+1))).nativeHandler=a,l.fakeName=c,l.capture=s,i[r]=l);t&&0!==l.length||(delete i[r],zr(n,l.fakeName||r,l.nativeHandler,l.capture))}}else ve(i,function(e,t){zr(n,e.fakeName||t,e.nativeHandler,e.capture)}),i={};for(r in i)if(ye(i,r))return this;delete this.events[u];try{delete n[this.expando]}catch(e){n[this.expando]=null}}return this},$r.prototype.fire=function(e,t,n){var o;if(!e||3===e.nodeType||8===e.nodeType)return this;var r=jr(null,n);for(r.type=t,r.target=e;(o=e[this.expando])&&this.executeHandlers(r,o),(e=e.parentNode||e.ownerDocument||e.defaultView||e.parentWindow)&&!r.isPropagationStopped(););return this},$r.prototype.clean=function(e){var t,n;if(!e||3===e.nodeType||8===e.nodeType)return this;if(e[this.expando]&&this.unbind(e),(e=!e.getElementsByTagName?e.document:e)&&e.getElementsByTagName)for(this.unbind(e),t=(n=e.getElementsByTagName("*")).length;t--;)(e=n[t])[this.expando]&&this.unbind(e);return this},$r.prototype.destroy=function(){this.events={}},$r.prototype.cancel=function(e){return e&&(e.preventDefault(),e.stopImmediatePropagation()),!1},$r.prototype.executeHandlers=function(e,t){var t=this.events[t],n=t&&t[e.type];if(n)for(var o=0,r=n.length;o<r;o++){var i=n[o];if(i&&!1===i.func.call(i.scope,e)&&e.preventDefault(),e.isImmediatePropagationStopped())return}},$r.Event=new $r,$r);function $r(){this.domLoaded=!1,this.events={},this.count=1,this.expando="mce-data-"+(+new Date).toString(32),this.hasMouseEnterLeave="onmouseenter"in document.documentElement,this.hasFocusIn="onfocusin"in document.documentElement,this.count=1}function Xr(e,t,n){var o="0x"+t-65536;return o!=o||n?t:o<0?String.fromCharCode(65536+o):String.fromCharCode(o>>10|55296,1023&o|56320)}var Yr,Kr,Jr,Qr,Zr,ei,ti,ni,oi,ri,ii,ui,ai,ci,si,li,fi,di="sizzle"+-new Date,mi=window.document,gi=0,pi=0,hi=Ui(),vi=Ui(),bi=Ui(),yi=function(e,t){return e===t&&(ri=!0),0},xi="undefined",wi={}.hasOwnProperty,G=[],Ci=G.pop,Si=G.push,ki=G.push,Oi=G.slice,_i=G.indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(this[t]===e)return t;return-1},Ei="[\\x20\\t\\r\\n\\f]",Rt="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",J="\\["+Ei+"*("+Rt+")(?:"+Ei+"*([*^$|!~]?=)"+Ei+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+Rt+"))|)"+Ei+"*\\]",Dt=":("+Rt+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+J+")*)|.*)\\)|)",Ti=new RegExp("^"+Ei+"+|((?:^|[^\\\\])(?:\\\\.)*)"+Ei+"+$","g"),Di=new RegExp("^"+Ei+"*,"+Ei+"*"),Ai=new RegExp("^"+Ei+"*([>+~]|"+Ei+")"+Ei+"*"),Bi=new RegExp("="+Ei+"*([^\\]'\"]*?)"+Ei+"*\\]","g"),Ni=new RegExp(Dt),Ri=new RegExp("^"+Rt+"$"),Mi={ID:new RegExp("^#("+Rt+")"),CLASS:new RegExp("^\\.("+Rt+")"),TAG:new RegExp("^("+Rt+"|[*])"),ATTR:new RegExp("^"+J),PSEUDO:new RegExp("^"+Dt),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+Ei+"*(even|odd|(([+-]|)(\\d*)n|)"+Ei+"*(?:([+-]|)"+Ei+"*(\\d+)|))"+Ei+"*\\)|)","i"),bool:new RegExp("^(?:checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped)$","i"),needsContext:new RegExp("^"+Ei+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+Ei+"*((?:-\\d)?\\d*)"+Ei+"*\\)|)(?=[^-]|$)","i")},Ii=/^(?:input|select|textarea|button)$/i,Fi=/^h\d$/i,Pi=/^[^{]+\{\s*\[native \w/,Li=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,Vi=/[+~]/,Hi=/'|\\/g,zi=new RegExp("\\\\([\\da-f]{1,6}"+Ei+"?|("+Ei+")|.)","ig");try{ki.apply(G=Oi.call(mi.childNodes),mi.childNodes),G[mi.childNodes.length].nodeType}catch(e){ki={apply:G.length?function(e,t){Si.apply(e,Oi.call(t))}:function(e,t){for(var n=e.length,o=0;e[n++]=t[o++];);e.length=n-1}}}var ji=function(e,t,n,o){var r,i,u,a,c,s,l;if((t?t.ownerDocument||t:mi)!==ui&&ii(t),n=n||[],!e||"string"!=typeof e)return n;if(1!==(r=(t=t||ui).nodeType)&&9!==r)return[];if(ci&&!o){if(s=Li.exec(e))if(l=s[1]){if(9===r){if(!(a=t.getElementById(l))||!a.parentNode)return n;if(a.id===l)return n.push(a),n}else if(t.ownerDocument&&(a=t.ownerDocument.getElementById(l))&&fi(t,a)&&a.id===l)return n.push(a),n}else{if(s[2])return ki.apply(n,t.getElementsByTagName(e)),n;if((l=s[3])&&Yr.getElementsByClassName)return ki.apply(n,t.getElementsByClassName(l)),n}if(Yr.qsa&&(!si||!si.test(e))){if(c=a=di,s=t,l=9===r&&e,1===r&&"object"!==t.nodeName.toLowerCase()){for(u=Zr(e),(a=t.getAttribute("id"))?c=a.replace(Hi,"\\$&"):t.setAttribute("id",c),c="[id='"+c+"'] ",i=u.length;i--;)u[i]=c+Yi(u[i]);s=Vi.test(e)&&$i(t.parentNode)||t,l=u.join(",")}if(l)try{return ki.apply(n,s.querySelectorAll(l)),n}catch(e){}finally{a||t.removeAttribute("id")}}}return ti(e.replace(Ti,"$1"),t,n,o)};function Ui(){var n=[];function o(e,t){return n.push(e+" ")>Kr.cacheLength&&delete o[n.shift()],o[e+" "]=t}return o}function Wi(e){return e[di]=!0,e}function qi(e,t){var n=t&&e,o=n&&1===e.nodeType&&1===t.nodeType&&(~t.sourceIndex||1<<31)-(~e.sourceIndex||1<<31);if(o)return o;if(n)for(;n=n.nextSibling;)if(n===t)return-1;return e?1:-1}function Gi(u){return Wi(function(i){return i=+i,Wi(function(e,t){for(var n,o=u([],e.length,i),r=o.length;r--;)e[n=o[r]]&&(e[n]=!(t[n]=e[n]))})})}function $i(e){return e&&typeof e.getElementsByTagName!=xi&&e}function Xi(){}function Yi(e){for(var t=0,n=e.length,o="";t<n;t++)o+=e[t].value;return o}function Ki(u,e,t){var a=e.dir,c=t&&"parentNode"===a,s=pi++;return e.first?function(e,t,n){for(;e=e[a];)if(1===e.nodeType||c)return u(e,t,n)}:function(e,t,n){var o,r,i=[gi,s];if(n){for(;e=e[a];)if((1===e.nodeType||c)&&u(e,t,n))return!0}else for(;e=e[a];)if(1===e.nodeType||c){if((o=(r=e[di]||(e[di]={}))[a])&&o[0]===gi&&o[1]===s)return i[2]=o[2];if((r[a]=i)[2]=u(e,t,n))return!0}}}function Ji(r){return 1<r.length?function(e,t,n){for(var o=r.length;o--;)if(!r[o](e,t,n))return!1;return!0}:r[0]}function Qi(e,t,n,o,r){for(var i,u=[],a=0,c=e.length,s=null!=t;a<c;a++)(i=e[a])&&(n&&!n(i,o,r)||(u.push(i),s&&t.push(a)));return u}Yr=ji.support={},Qr=ji.isXML=function(e){e=e&&(e.ownerDocument||e).documentElement;return!!e&&"HTML"!==e.nodeName},ii=ji.setDocument=function(e){var c=e?e.ownerDocument||e:mi,e=c.defaultView;return c!==ui&&9===c.nodeType&&c.documentElement?(ai=(ui=c).documentElement,ci=!Qr(c),e&&e!==function(e){try{return e.top}catch(e){}return null}(e)&&(e.addEventListener?e.addEventListener("unload",function(){ii()},!1):e.attachEvent&&e.attachEvent("onunload",function(){ii()})),Yr.attributes=!0,Yr.getElementsByTagName=!0,Yr.getElementsByClassName=Pi.test(c.getElementsByClassName),Yr.getById=!0,Kr.find.ID=function(e,t){if(typeof t.getElementById!=xi&&ci){e=t.getElementById(e);return e&&e.parentNode?[e]:[]}},Kr.filter.ID=function(e){var t=e.replace(zi,Xr);return function(e){return e.getAttribute("id")===t}},Kr.find.TAG=Yr.getElementsByTagName?function(e,t){if(typeof t.getElementsByTagName!=xi)return t.getElementsByTagName(e)}:function(e,t){var n,o=[],r=0,i=t.getElementsByTagName(e);if("*"!==e)return i;for(;n=i[r++];)1===n.nodeType&&o.push(n);return o},Kr.find.CLASS=Yr.getElementsByClassName&&function(e,t){if(ci)return t.getElementsByClassName(e)},li=[],si=[],Yr.disconnectedMatch=!0,si=si.length&&new RegExp(si.join("|")),li=li.length&&new RegExp(li.join("|")),e=Pi.test(ai.compareDocumentPosition),fi=e||Pi.test(ai.contains)?function(e,t){var n=9===e.nodeType?e.documentElement:e,t=t&&t.parentNode;return e===t||!(!t||1!==t.nodeType||!(n.contains?n.contains(t):e.compareDocumentPosition&&16&e.compareDocumentPosition(t)))}:function(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1},yi=e?function(e,t){return e===t?(ri=!0,0):(n=!e.compareDocumentPosition-!t.compareDocumentPosition)||(1&(n=(e.ownerDocument||e)===(t.ownerDocument||t)?e.compareDocumentPosition(t):1)||!Yr.sortDetached&&t.compareDocumentPosition(e)===n?e===c||e.ownerDocument===mi&&fi(mi,e)?-1:t===c||t.ownerDocument===mi&&fi(mi,t)?1:oi?_i.call(oi,e)-_i.call(oi,t):0:4&n?-1:1);var n}:function(e,t){if(e===t)return ri=!0,0;var n,o=0,r=e.parentNode,i=t.parentNode,u=[e],a=[t];if(!r||!i)return e===c?-1:t===c?1:r?-1:i?1:oi?_i.call(oi,e)-_i.call(oi,t):0;if(r===i)return qi(e,t);for(n=e;n=n.parentNode;)u.unshift(n);for(n=t;n=n.parentNode;)a.unshift(n);for(;u[o]===a[o];)o++;return o?qi(u[o],a[o]):u[o]===mi?-1:a[o]===mi?1:0},c):ui},ji.matches=function(e,t){return ji(e,null,null,t)},ji.matchesSelector=function(e,t){if((e.ownerDocument||e)!==ui&&ii(e),t=t.replace(Bi,"='$1']"),Yr.matchesSelector&&ci&&(!li||!li.test(t))&&(!si||!si.test(t)))try{var n=(void 0).call(e,t);if(n||Yr.disconnectedMatch||e.document&&11!==e.document.nodeType)return n}catch(e){}return 0<ji(t,ui,null,[e]).length},ji.contains=function(e,t){return(e.ownerDocument||e)!==ui&&ii(e),fi(e,t)},ji.attr=function(e,t){(e.ownerDocument||e)!==ui&&ii(e);var n=Kr.attrHandle[t.toLowerCase()],n=n&&wi.call(Kr.attrHandle,t.toLowerCase())?n(e,t,!ci):void 0;return void 0!==n?n:Yr.attributes||!ci?e.getAttribute(t):(n=e.getAttributeNode(t))&&n.specified?n.value:null},ji.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},ji.uniqueSort=function(e){var t,n=[],o=0,r=0;if(ri=!Yr.detectDuplicates,oi=!Yr.sortStable&&e.slice(0),e.sort(yi),ri){for(;t=e[r++];)t===e[r]&&(o=n.push(r));for(;o--;)e.splice(n[o],1)}return oi=null,e},Jr=ji.getText=function(e){var t,n="",o=0,r=e.nodeType;if(r){if(1===r||9===r||11===r){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=Jr(e)}else if(3===r||4===r)return e.nodeValue}else for(;t=e[o++];)n+=Jr(t);return n},(Kr=ji.selectors={cacheLength:50,createPseudo:Wi,match:Mi,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(zi,Xr),e[3]=(e[3]||e[4]||e[5]||"").replace(zi,Xr),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||ji.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&ji.error(e[0]),e},PSEUDO:function(e){var t,n=!e[6]&&e[2];return Mi.CHILD.test(e[0])?null:(e[3]?e[2]=e[4]||e[5]||"":n&&Ni.test(n)&&(t=Zr(n,!0))&&(t=n.indexOf(")",n.length-t)-n.length)&&(e[0]=e[0].slice(0,t),e[2]=n.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(zi,Xr).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=hi[e+" "];return t||(t=new RegExp("(^|"+Ei+")"+e+"("+Ei+"|$)"))&&hi(e,function(e){return t.test("string"==typeof e.className&&e.className||typeof e.getAttribute!=xi&&e.getAttribute("class")||"")})},ATTR:function(t,n,o){return function(e){e=ji.attr(e,t);return null==e?"!="===n:!n||(e+="","="===n?e===o:"!="===n?e!==o:"^="===n?o&&0===e.indexOf(o):"*="===n?o&&-1<e.indexOf(o):"$="===n?o&&e.slice(-o.length)===o:"~="===n?-1<(" "+e+" ").indexOf(o):"|="===n&&(e===o||e.slice(0,o.length+1)===o+"-"))}},CHILD:function(m,e,t,g,p){var h="nth"!==m.slice(0,3),v="last"!==m.slice(-4),b="of-type"===e;return 1===g&&0===p?function(e){return!!e.parentNode}:function(e,t,n){var o,r,i,u,a,c,s=h!=v?"nextSibling":"previousSibling",l=e.parentNode,f=b&&e.nodeName.toLowerCase(),d=!n&&!b;if(l){if(h){for(;s;){for(i=e;i=i[s];)if(b?i.nodeName.toLowerCase()===f:1===i.nodeType)return!1;c=s="only"===m&&!c&&"nextSibling"}return!0}if(c=[v?l.firstChild:l.lastChild],v&&d){for(a=(o=(r=l[di]||(l[di]={}))[m]||[])[0]===gi&&o[1],u=o[0]===gi&&o[2],i=a&&l.childNodes[a];i=++a&&i&&i[s]||(u=a=0)||c.pop();)if(1===i.nodeType&&++u&&i===e){r[m]=[gi,a,u];break}}else if(d&&(o=(e[di]||(e[di]={}))[m])&&o[0]===gi)u=o[1];else for(;(i=++a&&i&&i[s]||(u=a=0)||c.pop())&&((b?i.nodeName.toLowerCase()!==f:1!==i.nodeType)||!++u||(d&&((i[di]||(i[di]={}))[m]=[gi,u]),i!==e)););return(u-=p)===g||u%g==0&&0<=u/g}}},PSEUDO:function(e,i){var t,u=Kr.pseudos[e]||Kr.setFilters[e.toLowerCase()]||ji.error("unsupported pseudo: "+e);return u[di]?u(i):1<u.length?(t=[e,e,"",i],Kr.setFilters.hasOwnProperty(e.toLowerCase())?Wi(function(e,t){for(var n,o=u(e,i),r=o.length;r--;)e[n=_i.call(e,o[r])]=!(t[n]=o[r])}):function(e){return u(e,0,t)}):u}},pseudos:{not:Wi(function(e){var o=[],r=[],a=ei(e.replace(Ti,"$1"));return a[di]?Wi(function(e,t,n,o){for(var r,i=a(e,null,o,[]),u=e.length;u--;)(r=i[u])&&(e[u]=!(t[u]=r))}):function(e,t,n){return o[0]=e,a(o,null,n,r),!r.pop()}}),has:Wi(function(t){return function(e){return 0<ji(t,e).length}}),contains:Wi(function(t){return t=t.replace(zi,Xr),function(e){return-1<(e.textContent||e.innerText||Jr(e)).indexOf(t)}}),lang:Wi(function(n){return Ri.test(n||"")||ji.error("unsupported lang: "+n),n=n.replace(zi,Xr).toLowerCase(),function(e){var t;do{if(t=ci?e.lang:e.getAttribute("xml:lang")||e.getAttribute("lang"))return(t=t.toLowerCase())===n||0===t.indexOf(n+"-")}while((e=e.parentNode)&&1===e.nodeType);return!1}}),target:function(e){var t=window.location&&window.location.hash;return t&&t.slice(1)===e.id},root:function(e){return e===ai},focus:function(e){return e===ui.activeElement&&(!ui.hasFocus||ui.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:function(e){return!1===e.disabled},disabled:function(e){return!0===e.disabled},checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,!0===e.selected},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:function(e){return!Kr.pseudos.empty(e)},header:function(e){return Fi.test(e.nodeName)},input:function(e){return Ii.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(e=e.getAttribute("type"))||"text"===e.toLowerCase())},first:Gi(function(){return[0]}),last:Gi(function(e,t){return[t-1]}),eq:Gi(function(e,t,n){return[n<0?n+t:n]}),even:Gi(function(e,t){for(var n=0;n<t;n+=2)e.push(n);return e}),odd:Gi(function(e,t){for(var n=1;n<t;n+=2)e.push(n);return e}),lt:Gi(function(e,t,n){for(var o=n<0?n+t:n;0<=--o;)e.push(o);return e}),gt:Gi(function(e,t,n){for(var o=n<0?n+t:n;++o<t;)e.push(o);return e})}}).pseudos.nth=Kr.pseudos.eq,de(["radio","checkbox","file","password","image"],function(e){var t;Kr.pseudos[e]=(t=e,function(e){return"input"===e.nodeName.toLowerCase()&&e.type===t})}),de(["submit","reset"],function(e){var n;Kr.pseudos[e]=(n=e,function(e){var t=e.nodeName.toLowerCase();return("input"===t||"button"===t)&&e.type===n})}),Xi.prototype=Kr.filters=Kr.pseudos,Kr.setFilters=new Xi,Zr=ji.tokenize=function(e,t){var n,o,r,i,u,a,c,s=vi[e+" "];if(s)return t?0:s.slice(0);for(u=e,a=[],c=Kr.preFilter;u;){for(i in n&&!(o=Di.exec(u))||(o&&(u=u.slice(o[0].length)||u),a.push(r=[])),n=!1,(o=Ai.exec(u))&&(n=o.shift(),r.push({value:n,type:o[0].replace(Ti," ")}),u=u.slice(n.length)),Kr.filter)Kr.filter.hasOwnProperty(i)&&(!(o=Mi[i].exec(u))||c[i]&&!(o=c[i](o))||(n=o.shift(),r.push({value:n,type:i,matches:o}),u=u.slice(n.length)));if(!n)break}return t?u.length:u?ji.error(e):vi(e,a).slice(0)},ei=ji.compile=function(e,t){var n,h,v,b,y,o,r=[],i=[],u=bi[e+" "];if(!u){for(n=(t=t||Zr(e)).length;n--;)((u=function e(t){for(var o,n,r,i=t.length,u=Kr.relative[t[0].type],a=u||Kr.relative[" "],c=u?1:0,s=Ki(function(e){return e===o},a,!0),l=Ki(function(e){return-1<_i.call(o,e)},a,!0),f=[function(e,t,n){return!u&&(n||t!==ni)||((o=t).nodeType?s:l)(e,t,n)}];c<i;c++)if(n=Kr.relative[t[c].type])f=[Ki(Ji(f),n)];else{if((n=Kr.filter[t[c].type].apply(null,t[c].matches))[di]){for(r=++c;r<i&&!Kr.relative[t[r].type];r++);return function e(m,g,p,h,v,t){return h&&!h[di]&&(h=e(h)),v&&!v[di]&&(v=e(v,t)),Wi(function(e,t,n,o){var r,i,u,a=[],c=[],s=t.length,l=e||function(e,t,n){for(var o=0,r=t.length;o<r;o++)ji(e,t[o],n);return n}(g||"*",n.nodeType?[n]:n,[]),f=!m||!e&&g?l:Qi(l,a,m,n,o),d=p?v||(e?m:s||h)?[]:t:f;if(p&&p(f,d,n,o),h)for(r=Qi(d,c),h(r,[],n,o),i=r.length;i--;)(u=r[i])&&(d[c[i]]=!(f[c[i]]=u));if(e){if(v||m){if(v){for(r=[],i=d.length;i--;)(u=d[i])&&r.push(f[i]=u);v(null,d=[],r,o)}for(i=d.length;i--;)(u=d[i])&&-1<(r=v?_i.call(e,u):a[i])&&(e[r]=!(t[r]=u))}}else d=Qi(d===t?d.splice(s,d.length):d),v?v(null,t,d,o):ki.apply(t,d)})}(1<c&&Ji(f),1<c&&Yi(t.slice(0,c-1).concat({value:" "===t[c-2].type?"*":""})).replace(Ti,"$1"),n,c<r&&e(t.slice(c,r)),r<i&&e(t=t.slice(r)),r<i&&Yi(t))}f.push(n)}return Ji(f)}(t[n]))[di]?r:i).push(u);(u=bi(e,(b=0<(v=r).length,y=0<(h=i).length,o=function(e,t,n,o,r){var i,u,a,c=0,s="0",l=e&&[],f=[],d=ni,m=e||y&&Kr.find.TAG("*",r),g=gi+=null==d?1:Math.random()||.1,p=m.length;for(r&&(ni=t!==ui&&t);s!==p&&null!=(i=m[s]);s++){if(y&&i){for(u=0;a=h[u++];)if(a(i,t,n)){o.push(i);break}r&&(gi=g)}b&&((i=!a&&i)&&c--,e&&l.push(i))}if(c+=s,b&&s!==c){for(u=0;a=v[u++];)a(l,f,t,n);if(e){if(0<c)for(;s--;)l[s]||f[s]||(f[s]=Ci.call(o));f=Qi(f)}ki.apply(o,f),r&&!e&&0<f.length&&1<c+v.length&&ji.uniqueSort(o)}return r&&(gi=g,ni=d),l},b?Wi(o):o))).selector=e}return u},ti=ji.select=function(e,t,n,o){var r,i,u,a,c,s="function"==typeof e&&e,l=!o&&Zr(e=s.selector||e);if(n=n||[],1===l.length){if(2<(i=l[0]=l[0].slice(0)).length&&"ID"===(u=i[0]).type&&Yr.getById&&9===t.nodeType&&ci&&Kr.relative[i[1].type]){if(!(t=(Kr.find.ID(u.matches[0].replace(zi,Xr),t)||[])[0]))return n;s&&(t=t.parentNode),e=e.slice(i.shift().value.length)}for(r=Mi.needsContext.test(e)?0:i.length;r--&&(u=i[r],!Kr.relative[a=u.type]);)if((c=Kr.find[a])&&(o=c(u.matches[0].replace(zi,Xr),Vi.test(i[0].type)&&$i(t.parentNode)||t))){if(i.splice(r,1),!(e=o.length&&Yi(i)))return ki.apply(n,o),n;break}}return(s||ei(e,l))(o,t,!ci,n,Vi.test(e)&&$i(t.parentNode)||t),n},Yr.sortStable=di.split("").sort(yi).join("")===di,Yr.detectDuplicates=!!ri,ii(),Yr.sortDetached=!0;function Zi(e){return void 0!==e}function eu(e){return"string"==typeof e}function tu(e,t){var n,o=(t=t||cu).createElement("div"),r=t.createDocumentFragment();for(o.innerHTML=e;n=o.firstChild;)r.appendChild(n);return r}function nu(e,t){return e&&t&&-1!==(" "+e.className+" ").indexOf(" "+t+" ")}function ou(e,t,n){var o,r;return t=_u(t)[0],e.each(function(){n&&o===this.parentNode||(o=this.parentNode,r=t.cloneNode(!1),this.parentNode.insertBefore(r,this)),r.appendChild(this)}),e}function ru(e,t){return new _u.fn.init(e,t)}function iu(e){return null==e?"":(""+e).replace(wu,"")}function uu(e,t){var n,o,r,i;if(e)if(void 0===(n=e.length)){for(o in e)if(e.hasOwnProperty(o)&&(i=e[o],!1===t.call(i,o,i)))break}else for(r=0;r<n&&(i=e[r],!1!==t.call(i,r,i));r++);return e}function au(e,n){var o=[];return uu(e,function(e,t){n(t,e)&&o.push(t)}),o}var cu=document,su=Array.prototype.push,lu=Array.prototype.slice,fu=/^(?:[^#<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/,du=Gr.Event,mu=Kt.makeMap("children,contents,next,prev"),gu=function(e,t,n,o){var r;if(eu(t))t=tu(t,Cu(e[0]));else if(t.length&&!t.nodeType){if(t=_u.makeArray(t),o)for(r=t.length-1;0<=r;r--)gu(e,t[r],n,o);else for(r=0;r<t.length;r++)gu(e,t[r],n,o);return e}if(t.nodeType)for(r=e.length;r--;)n.call(e[r],t);return e},pu=Kt.makeMap("fillOpacity fontWeight lineHeight opacity orphans widows zIndex zoom"," "),hu=Kt.makeMap("checked compact declare defer disabled ismap multiple nohref noshade nowrap readonly selected"," "),vu={for:"htmlFor",class:"className",readonly:"readOnly"},bu={float:"cssFloat"},yu={},xu={},wu=/^\s*|\s*$/g,Cu=function(e){return e?9===e.nodeType?e:e.ownerDocument:cu};ru.fn=ru.prototype={constructor:ru,selector:"",context:null,length:0,init:function(e,t){var n,o,r=this;if(!e)return r;if(e.nodeType)return r.context=r[0]=e,r.length=1,r;if(t&&t.nodeType)r.context=t;else{if(t)return _u(e).attr(t);r.context=t=document}if(eu(e)){if(!(n="<"===(r.selector=e).charAt(0)&&">"===e.charAt(e.length-1)&&3<=e.length?[null,e,null]:fu.exec(e)))return _u(t).find(e);if(n[1])for(o=tu(e,Cu(t)).firstChild;o;)su.call(r,o),o=o.nextSibling;else{if(!(o=Cu(t).getElementById(n[2])))return r;if(o.id!==n[2])return r.find(e);r.length=1,r[0]=o}}else this.add(e,!1);return r},toArray:function(){return Kt.toArray(this)},add:function(e,t){var n,o;if(eu(e))return this.add(_u(e));if(!1!==t)for(n=_u.unique(this.toArray().concat(_u.makeArray(e))),this.length=n.length,o=0;o<n.length;o++)this[o]=n[o];else su.apply(this,_u.makeArray(e));return this},attr:function(t,n){var e,o=this;if("object"==typeof t)uu(t,function(e,t){o.attr(e,t)});else{if(!Zi(n)){if(o[0]&&1===o[0].nodeType){if((e=yu[t])&&e.get)return e.get(o[0],t);if(hu[t])return o.prop(t)?t:void 0;null===(n=o[0].getAttribute(t,2))&&(n=void 0)}return n}this.each(function(){var e;1===this.nodeType&&((e=yu[t])&&e.set?e.set(this,n):null===n?this.removeAttribute(t,2):this.setAttribute(t,n,2))})}return o},removeAttr:function(e){return this.attr(e,null)},prop:function(e,t){var n=this;if("object"==typeof(e=vu[e]||e))uu(e,function(e,t){n.prop(e,t)});else{if(!Zi(t))return n[0]&&n[0].nodeType&&e in n[0]?n[0][e]:t;this.each(function(){1===this.nodeType&&(this[e]=t)})}return n},css:function(t,n){function e(e){return e.replace(/-(\D)/g,function(e,t){return t.toUpperCase()})}function o(e){return e.replace(/[A-Z]/g,function(e){return"-"+e})}var r,i,u=this;if("object"==typeof t)uu(t,function(e,t){u.css(e,t)});else if(Zi(n))t=e(t),"number"!=typeof n||pu[t]||(n=n.toString()+"px"),u.each(function(){var e=this.style;if((i=xu[t])&&i.set)i.set(this,n);else{try{this.style[bu[t]||t]=n}catch(e){}null!==n&&""!==n||(e.removeProperty?e.removeProperty(o(t)):e.removeAttribute(t))}});else{if(r=u[0],(i=xu[t])&&i.get)return i.get(r);if(!r.ownerDocument.defaultView)return r.currentStyle?r.currentStyle[e(t)]:"";try{return r.ownerDocument.defaultView.getComputedStyle(r,null).getPropertyValue(o(t))}catch(e){return}}return u},remove:function(){for(var e,t=this.length;t--;)e=this[t],du.clean(e),e.parentNode&&e.parentNode.removeChild(e);return this},empty:function(){for(var e,t=this.length;t--;)for(e=this[t];e.firstChild;)e.removeChild(e.firstChild);return this},html:function(t){var n;if(Zi(t)){n=this.length;try{for(;n--;)this[n].innerHTML=t}catch(e){_u(this[n]).empty().append(t)}return this}return this[0]?this[0].innerHTML:""},text:function(e){var t;if(Zi(e)){for(t=this.length;t--;)"innerText"in this[t]?this[t].innerText=e:this[0].textContent=e;return this}return this[0]?this[0].innerText||this[0].textContent:""},append:function(){return gu(this,arguments,function(e){(1===this.nodeType||this.host&&1===this.host.nodeType)&&this.appendChild(e)})},prepend:function(){return gu(this,arguments,function(e){(1===this.nodeType||this.host&&1===this.host.nodeType)&&this.insertBefore(e,this.firstChild)},!0)},before:function(){return this[0]&&this[0].parentNode?gu(this,arguments,function(e){this.parentNode.insertBefore(e,this)}):this},after:function(){return this[0]&&this[0].parentNode?gu(this,arguments,function(e){this.parentNode.insertBefore(e,this.nextSibling)},!0):this},appendTo:function(e){return _u(e).append(this),this},prependTo:function(e){return _u(e).prepend(this),this},replaceWith:function(e){return this.before(e).remove()},wrap:function(e){return ou(this,e)},wrapAll:function(e){return ou(this,e,!0)},wrapInner:function(e){return this.each(function(){_u(this).contents().wrapAll(e)}),this},unwrap:function(){return this.parent().each(function(){_u(this).replaceWith(this.childNodes)})},clone:function(){var e=[];return this.each(function(){e.push(this.cloneNode(!0))}),_u(e)},addClass:function(e){return this.toggleClass(e,!0)},removeClass:function(e){return this.toggleClass(e,!1)},toggleClass:function(r,i){var e=this;return"string"!=typeof r||(-1!==r.indexOf(" ")?uu(r.split(" "),function(){e.toggleClass(this,i)}):e.each(function(e,t){var n,o=nu(t,r);o!==i&&(n=t.className,o?t.className=iu((" "+n+" ").replace(" "+r+" "," ")):t.className+=n?" "+r:r)})),e},hasClass:function(e){return nu(this[0],e)},each:function(e){return uu(this,e)},on:function(e,t){return this.each(function(){du.bind(this,e,t)})},off:function(e,t){return this.each(function(){du.unbind(this,e,t)})},trigger:function(e){return this.each(function(){"object"==typeof e?du.fire(this,e.type,e):du.fire(this,e)})},show:function(){return this.css("display","")},hide:function(){return this.css("display","none")},slice:function(){return new _u(lu.apply(this,arguments))},eq:function(e){return-1===e?this.slice(e):this.slice(e,+e+1)},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},find:function(e){for(var t=[],n=0,o=this.length;n<o;n++)_u.find(e,this[n],t);return _u(t)},filter:function(n){return _u("function"==typeof n?au(this.toArray(),function(e,t){return n(t,e)}):_u.filter(n,this.toArray()))},closest:function(n){var o=[];return n instanceof _u&&(n=n[0]),this.each(function(e,t){for(;t;){if("string"==typeof n&&_u(t).is(n)){o.push(t);break}if(t===n){o.push(t);break}t=t.parentNode}}),_u(o)},offset:function(e){var t,n,o=0,r=0;return e?this.css(e):((n=this[0])&&(e=(t=n.ownerDocument).documentElement,n.getBoundingClientRect&&(o=(n=n.getBoundingClientRect()).left+(e.scrollLeft||t.body.scrollLeft)-e.clientLeft,r=n.top+(e.scrollTop||t.body.scrollTop)-e.clientTop)),{left:o,top:r})},push:su,sort:Array.prototype.sort,splice:Array.prototype.splice},Kt.extend(ru,{extend:Kt.extend,makeArray:function(e){return e&&e===e.window||e.nodeType?[e]:Kt.toArray(e)},inArray:function(e,t){var n;if(t.indexOf)return t.indexOf(e);for(n=t.length;n--;)if(t[n]===e)return n;return-1},isArray:Kt.isArray,each:uu,trim:iu,grep:au,find:ji,expr:ji.selectors,unique:ji.uniqueSort,text:ji.getText,contains:ji.contains,filter:function(e,t,n){var o=t.length;for(n&&(e=":not("+e+")");o--;)1!==t[o].nodeType&&t.splice(o,1);return 1===t.length?_u.find.matchesSelector(t[0],e)?[t[0]]:[]:_u.find.matches(e,t)}});function Su(e,t,n){var o=[],r=e[t];for("string"!=typeof n&&n instanceof _u&&(n=n[0]);r&&9!==r.nodeType;){if(void 0!==n){if(r===n)break;if("string"==typeof n&&_u(r).is(n))break}1===r.nodeType&&o.push(r),r=r[t]}return o}function ku(e,t,n,o){var r=[];for(o instanceof _u&&(o=o[0]);e;e=e[t])if(!n||e.nodeType===n){if(void 0!==o){if(e===o)break;if("string"==typeof o&&_u(e).is(o))break}r.push(e)}return r}function Ou(e,t,n){for(e=e[t];e;e=e[t])if(e.nodeType===n)return e;return null}uu({parent:function(e){e=e.parentNode;return e&&11!==e.nodeType?e:null},parents:function(e){return Su(e,"parentNode")},next:function(e){return Ou(e,"nextSibling",1)},prev:function(e){return Ou(e,"previousSibling",1)},children:function(e){return ku(e.firstChild,"nextSibling",1)},contents:function(e){return Kt.toArray(("iframe"===e.nodeName?e.contentDocument||e.contentWindow.document:e).childNodes)}},function(o,r){ru.fn[o]=function(t){var n=[];this.each(function(){var e=r.call(n,this,t,n);e&&(_u.isArray(e)?n.push.apply(n,e):n.push(e))}),1<this.length&&(mu[o]||(n=_u.unique(n)),0===o.indexOf("parents")&&(n=n.reverse()));var e=_u(n);return t?e.filter(t):e}}),uu({parentsUntil:function(e,t){return Su(e,"parentNode",t)},nextUntil:function(e,t){return ku(e,"nextSibling",1,t).slice(1)},prevUntil:function(e,t){return ku(e,"previousSibling",1,t).slice(1)}},function(r,i){ru.fn[r]=function(t,e){var n=[];this.each(function(){var e=i.call(n,this,t,n);e&&(_u.isArray(e)?n.push.apply(n,e):n.push(e))}),1<this.length&&(n=_u.unique(n),0!==r.indexOf("parents")&&"prevUntil"!==r||(n=n.reverse()));var o=_u(n);return e?o.filter(e):o}}),ru.fn.is=function(e){return!!e&&0<this.filter(e).length},ru.fn.init.prototype=ru.fn,ru.overrideDefaults=function(n){var o,r=function(e,t){return o=o||n(),0===arguments.length&&(e=o.element),t=t||o.context,new r.fn.init(e,t)};return _u.extend(r,this),r},ru.attrHooks=yu,ru.cssHooks=xu;var _u=ru,Eu=Kt.each,Tu=Kt.grep,Du=$t.ie,Au=/^([a-z0-9],?)+$/i,Bu=function(n,o,r){var i=o.keep_values,e={set:function(e,t,n){o.url_converter&&(t=o.url_converter.call(o.url_converter_scope||r(),t,n,e[0])),e.attr("data-mce-"+n,t).attr(n,t)},get:function(e,t){return e.attr("data-mce-"+t)||e.attr(t)}},t={style:{set:function(e,t){null===t||"object"!=typeof t?(i&&e.attr("data-mce-style",t),null!==t&&"string"==typeof t?(e.removeAttr("style"),e.css(n.parse(t))):e.attr("style",t)):e.css(t)},get:function(e){var t=e.attr("data-mce-style")||e.attr("style");return n.serialize(n.parse(t),e[0].nodeName)}}};return i&&(t.href=t.src=e),t},Nu=function(e,t){var n=t.attr("style"),n=e.serialize(e.parse(n),t[0].nodeName)||null;t.attr("data-mce-style",n)},Ru=function(e,t){var n,o,r=0;if(e)for(n=e.nodeType,e=e.previousSibling;e;e=e.previousSibling)o=e.nodeType,(!t||3!==o||o!==n&&e.nodeValue.length)&&(r++,n=o);return r};function Mu(u,a){var t=this;void 0===a&&(a={});function c(e){return e&&u&&Q(e)?u.getElementById(e):e}function i(e){return P("string"==typeof e?c(e):e)}function o(e,t,n){var o,r=i(e);return o=void 0===(o=r.length?(e=j[t])&&e.get?e.get(r,t):r.attr(t):o)?n||"":o}function r(e){return(e=c(e))?e.attributes:[]}function s(e,t,n){""===n&&(n=null);var o=i(e),r=o.attr(t);o.length&&((e=j[t])&&e.set?e.set(o,n,t):o.attr(t,n),r!==n&&a.onSetAttrib&&a.onSetAttrib({attrElm:o,attrName:t,attrValue:n}))}function l(){return a.root_element||u.body}function n(e,t){return Nn(u.body,c(e),t)}function f(e,t,n){return e=i(e),n?e.css(t):("float"===(t=t.replace(/-(\D)/g,function(e,t){return t.toUpperCase()}))&&(t=$t.browser.isIE()?"styleFloat":"cssFloat"),e[0]&&e[0].style?e[0].style[t]:void 0)}function d(e){var t,n;return e=c(e),t=f(e,"width"),n=f(e,"height"),-1===t.indexOf("px")&&(t=0),-1===n.indexOf("px")&&(n=0),{w:parseInt(t,10)||e.offsetWidth||e.clientWidth,h:parseInt(n,10)||e.offsetHeight||e.clientHeight}}function m(e,t){if(!e)return!1;if(!Array.isArray(e)){if("*"===t)return 1===e.nodeType;if(Au.test(t)){for(var n=t.toLowerCase().split(/,/),o=e.nodeName.toLowerCase(),r=n.length-1;0<=r;r--)if(n[r]===o)return!0;return!1}if(e.nodeType&&1!==e.nodeType)return!1}return e=Array.isArray(e)?e:[e],0<ji(t,e[0].ownerDocument||e[0],null,e).length}function g(e,t,n,o){var r,i=[],u=c(e);for(o=void 0===o,n=n||("BODY"!==l().nodeName?l().parentNode:null),Kt.is(t,"string")&&(t="*"===(r=t)?function(e){return 1===e.nodeType}:function(e){return m(e,r)});u&&!(u===n||ue(u.nodeType)||Sn(u)||kn(u));){if(!t||"function"==typeof t&&t(u)){if(!o)return[u];i.push(u)}u=u.parentNode}return o?i:null}function p(e,t,n){var o=t;if(e)for("string"==typeof t&&(o=function(e){return m(e,t)}),e=e[n];e;e=e[n])if("function"==typeof o&&o(e))return e;return null}function h(e,n,o){var r;return!!(e="string"==typeof e?c(e):e)&&(Kt.isArray(e)&&(e.length||0===e.length)?(r=[],Eu(e,function(e,t){e&&r.push(n.call(o,"string"==typeof e?c(e):e,t))}),r):n.call(o||t,e))}function v(e,t){i(e).each(function(e,n){Eu(t,function(e,t){s(n,t,e)})})}function b(e,n){e=i(e),Du?e.each(function(e,t){if(!1!==t.canHaveHTML){for(;t.firstChild;)t.removeChild(t.firstChild);try{t.innerHTML="<br>"+n,t.removeChild(t.firstChild)}catch(e){_u("<div></div>").html("<br>"+n).contents().slice(1).appendTo(t)}return n}}):e.html(n)}function y(e,n,o,r,i){return h(e,function(e){var t="string"==typeof n?u.createElement(n):n;return v(t,o),r&&("string"!=typeof r&&r.nodeType?t.appendChild(r):"string"==typeof r&&b(t,r)),i?t:e.appendChild(t)})}function x(e,t,n){return y(u.createElement(e),e,t,n,!0)}function w(e,t){return e=i(e),(t?e.each(function(){for(var e;e=this.firstChild;)3===e.nodeType&&0===e.data.length?this.removeChild(e):this.parentNode.insertBefore(e,this)}):e).remove(),1<e.length?e.toArray():e[0]}function C(e,t,n){i(e).toggleClass(t,n).each(function(){""===this.className&&_u(this).attr("class",null)})}function S(t,e,n){return h(e,function(e){return Kt.is(e,"array")&&(t=t.cloneNode(!0)),n&&Eu(Tu(e.childNodes),function(e){t.appendChild(e)}),e.parentNode.replaceChild(t,e)})}function k(e){if(yn(e)){var t="a"===e.nodeName.toLowerCase()&&!o(e,"href")&&o(e,"id");if(o(e,"name")||o(e,"data-mce-bookmark")||t)return 1}}function O(){return u.createRange()}function _(e){if(e&&yn(e)){var t=e.getAttribute("data-mce-contenteditable");return t&&"inherit"!==t?t:"inherit"!==e.contentEditable?e.contentEditable:null}return null}var E={},T=window,D={},A=0,B=ho.forElement(Jt.fromDom(u),{contentCssCors:a.contentCssCors,referrerPolicy:a.referrerPolicy}),N=[],R=a.schema||Fr({}),M=Ur({url_converter:a.url_converter,url_converter_scope:a.url_converter_scope},a.schema),I=a.ownEvents?new Gr:Gr.Event,F=R.getBlockElements(),P=_u.overrideDefaults(function(){return{context:u,element:z.getRoot()}}),e=Or.decode,L=Or.encodeAllRaw,V=function(e,t,n,o){if(Kt.isArray(e)){for(var r=e.length,i=[];r--;)i[r]=V(e[r],t,n,o);return i}return!a.collect||e!==u&&e!==T||N.push([e,t,n,o]),I.bind(e,t,n,o||z)},H=function(e,t,n){if(Kt.isArray(e)){for(var o=e.length,r=[];o--;)r[o]=H(e[o],t,n);return r}if(0<N.length&&(e===u||e===T))for(o=N.length;o--;){var i=N[o];e!==i[0]||t&&t!==i[1]||n&&n!==i[2]||I.unbind(i[0],i[1],i[2])}return I.unbind(e,t,n)},z={doc:u,settings:a,win:T,files:D,stdMode:!0,boxModel:!0,styleSheetLoader:B,boundEvents:N,styles:M,schema:R,events:I,isBlock:function(e){if("string"==typeof e)return!!F[e];if(e){var t=e.nodeType;if(t)return!(1!==t||!F[e.nodeName])}return!1},$:P,$$:i,root:null,clone:function(t,e){if(!Du||1!==t.nodeType||e)return t.cloneNode(e);var n=u.createElement(t.nodeName);return Eu(r(t),function(e){s(n,e.nodeName,o(t,e.nodeName))}),n},getRoot:l,getViewPort:function(e){e=bn(e);return{x:e.x,y:e.y,w:e.width,h:e.height}},getRect:function(e){e=c(e);var t=n(e),e=d(e);return{x:t.x,y:t.y,w:e.w,h:e.h}},getSize:d,getParent:function(e,t,n){n=g(e,t,n,!1);return n&&0<n.length?n[0]:null},getParents:g,get:c,getNext:function(e,t){return p(e,t,"nextSibling")},getPrev:function(e,t){return p(e,t,"previousSibling")},select:function(e,t){return ji(e,c(t)||a.root_element||u,[])},is:m,add:y,create:x,createHTML:function(e,t,n){var o,r="";for(o in r+="<"+e,t)t.hasOwnProperty(o)&&null!==t[o]&&void 0!==t[o]&&(r+=" "+o+'="'+L(t[o])+'"');return void 0!==n?r+">"+n+"</"+e+">":r+" />"},createFragment:function(e){var t,n=u.createElement("div"),o=u.createDocumentFragment();for(o.appendChild(n),e&&(n.innerHTML=e);t=n.firstChild;)o.appendChild(t);return o.removeChild(n),o},remove:w,setStyle:function(e,t,n){t=Q(t)?i(e).css(t,n):i(e).css(t);a.update_styles&&Nu(M,t)},getStyle:f,setStyles:function(e,t){t=i(e).css(t);a.update_styles&&Nu(M,t)},removeAllAttribs:function(e){return h(e,function(e){for(var t=e.attributes,n=t.length-1;0<=n;n--)e.removeAttributeNode(t.item(n))})},setAttrib:s,setAttribs:v,getAttrib:o,getPos:n,parseStyle:function(e){return M.parse(e)},serializeStyle:function(e,t){return M.serialize(e,t)},addStyle:function(e){var t,n;if(z!==Mu.DOM&&u===document){if(E[e])return;E[e]=!0}(n=u.getElementById("mceDefaultStyles"))||((n=u.createElement("style")).id="mceDefaultStyles",n.type="text/css",(t=u.getElementsByTagName("head")[0]).firstChild?t.insertBefore(n,t.firstChild):t.appendChild(n)),n.styleSheet?n.styleSheet.cssText+=e:n.appendChild(u.createTextNode(e))},loadCSS:function(e){de((e=e||"").split(","),function(e){D[e]=!0,B.load(e,U)})},addClass:function(e,t){i(e).addClass(t)},removeClass:function(e,t){C(e,t,!1)},hasClass:function(e,t){return i(e).hasClass(t)},toggleClass:C,show:function(e){i(e).show()},hide:function(e){i(e).hide()},isHidden:function(e){return"none"===i(e).css("display")},uniqueId:function(e){return(e||"mce_")+A++},setHTML:b,getOuterHTML:function(e){e="string"==typeof e?c(e):e;return yn(e)?e.outerHTML:_u("<div></div>").append(_u(e).clone()).html()},setOuterHTML:function(e,t){i(e).each(function(){try{if("outerHTML"in this)return void(this.outerHTML=t)}catch(e){}w(_u(this).html(t),!0)})},decode:e,encode:L,insertAfter:function(e,t){var o=c(t);return h(e,function(e){var t=o.parentNode,n=o.nextSibling;return n?t.insertBefore(e,n):t.appendChild(e),e})},replace:S,rename:function(t,e){var n;return t.nodeName!==e.toUpperCase()&&(n=x(e),Eu(r(t),function(e){s(n,e.nodeName,o(t,e.nodeName))}),S(n,t,!0)),n||t},findCommonAncestor:function(e,t){for(var n,o=e;o;){for(n=t;n&&o!==n;)n=n.parentNode;if(o===n)break;o=o.parentNode}return!o&&e.ownerDocument?e.ownerDocument.documentElement:o},toHex:function(e){return M.toHex(Kt.trim(e))},run:h,getAttribs:r,isEmpty:function(e,t){var n,o=0;if(k(e))return!1;if(e=e.firstChild){var r=new vo(e,e.parentNode),i=R?R.getWhiteSpaceElements():{};t=t||(R?R.getNonEmptyElements():null);do{if(n=e.nodeType,yn(e)){var u=e.getAttribute("data-mce-bogus");if(u){e=r.next("all"===u);continue}if(u=e.nodeName.toLowerCase(),t&&t[u]){if("br"!==u)return!1;o++,e=r.next();continue}if(k(e))return!1}if(8===n)return!1;if(3===n&&!dr(e.nodeValue))return!1;if(3===n&&e.parentNode&&i[e.parentNode.nodeName]&&dr(e.nodeValue))return!1;e=r.next()}while(e)}return o<=1},createRng:O,nodeIndex:Ru,split:function(e,t,n){var o,r,i=O();if(e&&t)return i.setStart(e.parentNode,Ru(e)),i.setEnd(t.parentNode,Ru(t)),o=i.extractContents(),(i=O()).setStart(t.parentNode,Ru(t)+1),i.setEnd(e.parentNode,Ru(e)+1),r=i.extractContents(),(i=e.parentNode).insertBefore(pr(z,o),e),n?i.insertBefore(n,e):i.insertBefore(t,e),i.insertBefore(pr(z,r),e),w(e),n||t},bind:V,unbind:H,fire:function(e,t,n){return I.fire(e,t,n)},getContentEditable:_,getContentEditableParent:function(e){for(var t=l(),n=null;e&&e!==t&&null===(n=_(e));e=e.parentNode);return n},destroy:function(){if(0<N.length)for(var e=N.length;e--;){var t=N[e];I.unbind(t[0],t[1],t[2])}ve(D,function(e,t){B.unload(t),delete D[t]}),ji.setDocument&&ji.setDocument()},isChildOf:function(e,t){for(;e;){if(t===e)return!0;e=e.parentNode}return!1},dumpRng:function(e){return"startContainer: "+e.startContainer.nodeName+", startOffset: "+e.startOffset+", endContainer: "+e.endContainer.nodeName+", endOffset: "+e.endOffset}},j=Bu(M,a,function(){return z});return z}(Rt=Mu=Mu||{}).DOM=Rt(document),Rt.nodeIndex=Ru;var Iu=Mu,Fu=Iu.DOM,Pu=Kt.each,Lu=Kt.grep,Vu=(Hu.prototype._setReferrerPolicy=function(e){this.settings.referrerPolicy=e},Hu.prototype.loadScript=function(e,t,n){function o(){r.remove(i),u&&(u.onerror=u.onload=u=null)}var r=Fu,i=r.uniqueId(),u=document.createElement("script");u.id=i,u.type="text/javascript",u.src=Kt._addCacheSuffix(e),this.settings.referrerPolicy&&r.setAttrib(u,"referrerpolicy",this.settings.referrerPolicy),u.onload=function(){o(),t()},u.onerror=function(){o(),ae(n)?n():"undefined"!=typeof console&&console.log&&console.log("Failed to load script: "+e)},(document.getElementsByTagName("head")[0]||document.body).appendChild(u)},Hu.prototype.isDone=function(e){return 2===this.states[e]},Hu.prototype.markDone=function(e){this.states[e]=2},Hu.prototype.add=function(e,t,n,o){var r=this.states[e];this.queue.push(e),void 0===r&&(this.states[e]=0),t&&(this.scriptLoadedCallbacks[e]||(this.scriptLoadedCallbacks[e]=[]),this.scriptLoadedCallbacks[e].push({success:t,failure:o,scope:n||this}))},Hu.prototype.load=function(e,t,n,o){return this.add(e,t,n,o)},Hu.prototype.remove=function(e){delete this.states[e],delete this.scriptLoadedCallbacks[e]},Hu.prototype.loadQueue=function(e,t,n){this.loadScripts(this.queue,e,t,n)},Hu.prototype.loadScripts=function(t,e,n,o){function r(t,e){Pu(i.scriptLoadedCallbacks[e],function(e){ae(e[t])&&e[t].call(e.scope)}),i.scriptLoadedCallbacks[e]=void 0}var i=this,u=[];i.queueLoadedCallbacks.push({success:e,failure:o,scope:n||this});var a=function(){var e=Lu(t);t.length=0,Pu(e,function(e){2!==i.states[e]?3!==i.states[e]?1!==i.states[e]&&(i.states[e]=1,i.loading++,i.loadScript(e,function(){i.states[e]=2,i.loading--,r("success",e),a()},function(){i.states[e]=3,i.loading--,u.push(e),r("failure",e),a()})):r("failure",e):r("success",e)}),i.loading||(e=i.queueLoadedCallbacks.slice(0),i.queueLoadedCallbacks.length=0,Pu(e,function(e){0===u.length?ae(e.success)&&e.success.call(e.scope):ae(e.failure)&&e.failure.call(e.scope,u)}))};a()},Hu.ScriptLoader=new Hu,Hu);function Hu(e){void 0===e&&(e={}),this.states={},this.queue=[],this.scriptLoadedCallbacks={},this.queueLoadedCallbacks=[],this.loading=0,this.settings=e}function zu(e){var t=e;return{get:function(){return t},set:function(e){t=e}}}function ju(){return te(Uu,Wu.get())}var Uu={},Wu=zu("en"),qu={getData:function(){return S(Uu,function(e){return we({},e)})},setCode:function(e){e&&Wu.set(e)},getCode:function(){return Wu.get()},add:function(e,t){var n=Uu[e];n||(Uu[e]=n={}),ve(t,function(e,t){n[t.toLowerCase()]=e})},translate:function(e){function n(e){return ae(e)?Object.prototype.toString.call(e):u(e)?"":""+e}function t(e){return e=n(e),te(i,e.toLowerCase()).map(n).getOr(e)}function o(e){return e.replace(/{context:\w+}$/,"")}var r,i=ju().getOr({}),u=function(e){return""===e||null==e};if(u(e))return"";if(Z(r=e)&&ye(r,"raw"))return n(e.raw);if(ne(r=e)&&1<r.length){var a=e.slice(1);return o(t(e[0]).replace(/\{([0-9]+)\}/g,function(e,t){return ye(a,t)?n(a[t]):e}))}return o(t(e))},isRtl:function(){return ju().bind(function(e){return te(e,"_dir")}).exists(function(e){return"rtl"===e})},hasCode:function(e){return ye(Uu,e)}};function Gu(){function c(t,n){var e=me(i,function(e){return e.name===t&&e.state===n});de(e,function(e){return e.callback()})}function s(e){var t;return(t=d[e]?d[e].dependencies:t)||[]}function l(e,t){return"object"==typeof t?t:"string"==typeof e?{prefix:"",resource:t,suffix:""}:{prefix:e.prefix,resource:t,suffix:e.suffix}}function e(e,t,n){void 0===n&&(n="added"),ye(d,e)&&"added"===n||ye(f,e)&&"loaded"===n?t():i.push({name:e,state:n,callback:t})}var o=this,r=[],f={},d={},i=[],m=function(r,i,u,a,e){var t,n;f[r]||(0!==(t="string"==typeof i?i:i.prefix+i.resource+i.suffix).indexOf("/")&&-1===t.indexOf("://")&&(t=Gu.baseURL+"/"+t),f[r]=t.substring(0,t.lastIndexOf("/")),n=function(){var t,e,n,o;c(r,"loaded"),t=i,e=u,n=a,o=s(r),de(o,function(e){e=l(t,e);m(e.resource,e,void 0,void 0)}),e&&(n?e.call(n):e.call(Vu))},d[r]?n():Vu.ScriptLoader.add(t,n,a,e))};return{items:r,urls:f,lookup:d,_listeners:i,get:function(e){return d[e]?d[e].instance:void 0},dependencies:s,requireLangPack:function(t,n){!1!==Gu.languageLoad&&e(t,function(){var e=qu.getCode();!e||n&&-1===(","+(n||"")+",").indexOf(","+e+",")||Vu.ScriptLoader.add(f[t]+"/langs/"+e+".js")},"loaded")},add:function(e,t,n){return r.push(t),d[e]={instance:t,dependencies:n},c(e,"added"),t},remove:function(e){delete f[e],delete d[e]},createUrl:l,addComponents:function(e,t){var n=o.urls[e];de(t,function(e){Vu.ScriptLoader.add(n+"/"+e)})},load:m,waitFor:e}}(J=Gu=Gu||{}).PluginManager=J(),J.ThemeManager=J();function $u(n,o){var r=null;return{cancel:function(){null!==r&&(clearTimeout(r),r=null)},throttle:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];null===r&&(r=setTimeout(function(){n.apply(null,e),r=null},o))}}}function Xu(n,o){var r=null;return{cancel:function(){null!==r&&(clearTimeout(r),r=null)},throttle:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];null!==r&&clearTimeout(r),r=setTimeout(function(){n.apply(null,e),r=null},o)}}}function Yu(e,t){return void 0===(t=gt(e,t))||""===t?[]:t.split(" ")}function Ku(e){return void 0!==e.dom.classList}function Ju(e,t){Ku(e)?e.dom.classList.add(t):(t=t=t,t=Yu(e=e=e,"class").concat([t]),dt(e,"class",t.join(" ")))}function Qu(e,t){return Ku(e)&&e.dom.classList.contains(t)}function Zu(e,t){return e=void 0===e?document:e.dom,Fe(e)?[]:E(e.querySelectorAll(t),Jt.fromDom)}function ea(o,e){function t(e,t){return(n=e.dom)&&n.hasAttribute&&n.hasAttribute(t)?Y.some(gt(e,t)):Y.none();var n}var n=o.selection.getRng(),r=Jt.fromDom(n.startContainer),i=Jt.fromDom(o.getBody()),e=e.fold(function(){return"."+Ea()},function(e){return"["+Ta()+'="'+e+'"]'}),r=Ge(r,n.startOffset).getOr(r);return(e=Jn(r,e,function(e){return Pe(e,i)})).bind(function(e){return t(e,""+Da()).bind(function(n){return t(e,""+Ta()).map(function(e){var t=Aa(o,n);return{uid:n,name:e,elements:t}})})})}function ta(t,e){function c(e,t){n(e,function(e){return t(e),e})}var o=zu({}),n=function(e,t){var n=o.get(),t=t(n.hasOwnProperty(e)?n[e]:{listeners:[],previous:zu(Y.none())});n[e]=t,o.set(n)},r=Xu(function(){var e=o.get(),e=(e=pe(e),(e=se.call(e,0)).sort(void 0),e);de(e,function(e){n(e,function(u){var a=u.previous.get();return ea(t,Y.some(e)).fold(function(){var t;a.isSome()&&(c(t=e,function(e){de(e.listeners,function(e){return e(!1,t)})}),u.previous.set(Y.none()))},function(e){var t,n,o,r=e.uid,i=e.name,e=e.elements;a.is(r)||(n=r,o=e,c(t=i,function(e){de(e.listeners,function(e){return e(!0,t,{uid:n,nodes:E(o,function(e){return e.dom})})})}),u.previous.set(Y.some(r)))}),{previous:u.previous,listeners:u.listeners}})})},30);return t.on("remove",function(){r.cancel()}),t.on("NodeChange",function(){r.throttle()}),{addListener:function(e,t){n(e,function(e){return{previous:e.previous,listeners:e.listeners.concat([t])}})}}}function na(e){var t=(new Date).getTime();return e+"_"+Math.floor(1e9*Math.random())+ ++Ba+String(t)}function oa(e,t){var n=He(e).dom,o=Jt.fromDom(n.createDocumentFragment()),n=(t=t,(n=(n||document).createElement("div")).innerHTML=t,qe(Jt.fromDom(n)));Je(o,n),Qe(e),mn(e,o)}function ra(e,t){return Jt.fromDom(e.dom.cloneNode(t))}function ia(e){return ra(e,!1)}function ua(e){return ra(e,!0)}function aa(e,t,n){function o(e){for(var t;(t=r[e]())&&!wn(t)&&!n(t););return Y.from(t).filter(wn)}void 0===n&&(n=W);var r=new vo(e,t);return{current:function(){return Y.from(r.current()).filter(wn)},next:function(){return o("next")},prev:function(){return o("prev")},prev2:function(){return o("prev2")}}}function ca(t,e){var i=e||function(e){return t.isBlock(e)||On(e)||Tn(e)},u=function(e,t,n,o){if(wn(e)){t=o(e,t,e.data);if(-1!==t)return Y.some({container:e,offset:t})}return n().bind(function(e){return u(e.container,e.offset,n,o)})};return{backwards:function(e,t,n,o){var r=aa(e,o,i);return u(e,t,function(){return r.prev().map(function(e){return{container:e,offset:e.length}})},n).getOrNull()},forwards:function(e,t,n,o){var r=aa(e,o,i);return u(e,t,function(){return r.next().map(function(e){return{container:e,offset:0}})},n).getOrNull()}}}function sa(e,t,n){return e.isSome()&&t.isSome()?Y.some(n(e.getOrDie(),t.getOrDie())):Y.none()}function la(e){return e?{left:Na(e.left),top:Na(e.top),bottom:Na(e.bottom),right:Na(e.right),width:Na(e.width),height:Na(e.height)}:{left:0,top:0,bottom:0,right:0,width:0,height:0}}function fa(e,t){return e=la(e),t||(e.left=e.left+e.width),e.right=e.left,e.width=0,e}function da(e,t,n){return 0<=e&&e<=Math.min(t.height,n.height)/2}function ma(e,t){var n=Math.min(t.height/2,e.height/2);return e.bottom-n<t.top||!(e.top>t.bottom)&&da(t.top-e.bottom,e,t)}function ga(e,t){return e.top>t.bottom||!(e.bottom<t.top)&&da(t.bottom-e.top,e,t)}function pa(e,t,n){return t>=e.left&&t<=e.right&&n>=e.top&&n<=e.bottom}function ha(e){var t=e.startContainer,n=e.startOffset;return t.hasChildNodes()&&e.endOffset===n+1?t.childNodes[n]:null}function va(e,t){return 1===e.nodeType&&e.hasChildNodes()&&(t>=e.childNodes.length&&(t=e.childNodes.length-1),e=e.childNodes[t]),e}function ba(e){return"string"==typeof e&&768<=e.charCodeAt(0)&&Ra.test(e)}function ya(e){return e&&/[\r\n\t ]/.test(e)}function xa(e){return!!e.setStart&&!!e.setEnd}function wa(e){var t=e.startContainer,n=e.startOffset;return!!(ya(e.toString())&&Pa(t.parentNode)&&wn(t)&&(t=t.data,ya(t[n-1])||ya(t[n+1])))}function Ca(e){return 0===e.left&&0===e.right&&0===e.top&&0===e.bottom}function Sa(e,t){return(t=fa(e,t)).width=1,t.right=t.left+1,t}var ka,Oa=Gu,_a=function(e,t){var n=[];return de(qe(e),function(e){n=(n=t(e)?n.concat([e]):n).concat(_a(e,t))}),n},Ea=_("mce-annotation"),Ta=_("data-mce-annotation"),Da=_("data-mce-annotation-uid"),Aa=function(e,t){e=Jt.fromDom(e.getBody());return Zu(e,"["+Da()+'="'+t+'"]')},Ba=0,Na=Math.round,Ra=new RegExp("[̀-ͯ҃-҇҈-҉֑-ֽֿׁ-ׂׄ-ׇׅؐ-ًؚ-ٰٟۖ-ۜ۟-ۤۧ-۪ۨ-ܑۭܰ-݊ަ-ް߫-߳ࠖ-࠙ࠛ-ࠣࠥ-ࠧࠩ-࡙࠭-࡛ࣣ-ंऺ़ु-ै्॑-ॗॢ-ॣঁ়াু-ৄ্ৗৢ-ৣਁ-ਂ਼ੁ-ੂੇ-ੈੋ-੍ੑੰ-ੱੵઁ-ં઼ુ-ૅે-ૈ્ૢ-ૣଁ଼ାିୁ-ୄ୍ୖୗୢ-ୣஂாீ்ௗఀా-ీె-ైొ-్ౕ-ౖౢ-ౣಁ಼ಿೂೆೌ-್ೕ-ೖೢ-ೣഁാു-ൄ്ൗൢ-ൣ්ාි-ුූෟัิ-ฺ็-๎ັິ-ູົ-ຼ່-ໍ༘-ཱ༹༙༵༷-ཾྀ-྄྆-྇ྍ-ྗྙ-ྼ࿆ိ-ူဲ-့္-်ွ-ှၘ-ၙၞ-ၠၱ-ၴႂႅ-ႆႍႝ፝-፟ᜒ-᜔ᜲ-᜴ᝒ-ᝓᝲ-ᝳ឴-឵ិ-ួំ៉-៓៝᠋-᠍ᢩᤠ-ᤢᤧ-ᤨᤲ᤹-᤻ᨗ-ᨘᨛᩖᩘ-ᩞ᩠ᩢᩥ-ᩬᩳ-᩿᩼᪰-᪽᪾ᬀ-ᬃ᬴ᬶ-ᬺᬼᭂ᭫-᭳ᮀ-ᮁᮢ-ᮥᮨ-ᮩ᮫-ᮭ᯦ᯨ-ᯩᯭᯯ-ᯱᰬ-ᰳᰶ-᰷᳐-᳔᳒-᳢᳠-᳨᳭᳴᳸-᳹᷀-᷵᷼-᷿‌-‍⃐-⃜⃝-⃠⃡⃢-⃤⃥-⃰⳯-⵿⳱ⷠ-〪ⷿ-〭〮-゙〯-゚꙯꙰-꙲ꙴ-꙽ꚞ-ꚟ꛰-꛱ꠂ꠆ꠋꠥ-ꠦ꣄꣠-꣱ꤦ-꤭ꥇ-ꥑꦀ-ꦂ꦳ꦶ-ꦹꦼꧥꨩ-ꨮꨱ-ꨲꨵ-ꨶꩃꩌꩼꪰꪲ-ꪴꪷ-ꪸꪾ-꪿꫁ꫬ-ꫭ꫶ꯥꯨ꯭ﬞ︀-️︠-︯ﾞ-ﾟ]"),Ma=yn,Dt=No,Ia=K("display","block table"),G=K("float","left right"),Fa=function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return function(e){for(var t=0;t<n.length;t++)if(!n[t](e))return!1;return!0}}(Ma,Dt,a(G)),Pa=a(K("white-space","pre pre-line pre-wrap")),La=wn,Va=On,Ha=Iu.nodeIndex,za=va,ja=function(e){return"createRange"in e?e.createRange():Iu.DOM.createRng()},Ua=function(e){var t=e.getClientRects(),t=0<t.length?la(t[0]):la(e.getBoundingClientRect());return!xa(e)&&Va(e)&&Ca(t)?function(e){var t=e.ownerDocument,n=ja(t),o=t.createTextNode(Qo),t=e.parentNode;t.insertBefore(o,e),n.setStart(o,0),n.setEnd(o,1);n=la(n.getBoundingClientRect());return t.removeChild(o),n}(e):Ca(t)&&xa(e)?function(e){var t=e.startContainer,n=e.endContainer,o=e.startOffset,r=e.endOffset;if(t===n&&wn(n)&&0===o&&1===r){e=e.cloneRange();return e.setEndAfter(n),Ua(e)}return null}(e):t},Wa=function(e){function o(e){var t;0!==e.height&&(0<r.length&&(t=r[r.length-1],e.left===t.left&&e.top===t.top&&e.bottom===t.bottom&&e.right===t.right)||r.push(e))}function t(e,t){var n=ja(e.ownerDocument);if(t<e.data.length){if(ba(e.data[t]))return r;if(ba(e.data[t-1])&&(n.setStart(e,t),n.setEnd(e,t+1),!wa(n)))return o(Sa(Ua(n),!1)),r}0<t&&(n.setStart(e,t-1),n.setEnd(e,t),wa(n)||o(Sa(Ua(n),!1))),t<e.data.length&&(n.setStart(e,t),n.setEnd(e,t+1),wa(n)||o(Sa(Ua(n),!0)))}var n,r=[];if(La(e.container()))return t(e.container(),e.offset()),r;if(Ma(e.container()))if(e.isAtEnd())n=za(e.container(),e.offset()),La(n)&&t(n,n.data.length),Fa(n)&&!Va(n)&&o(Sa(Ua(n),!1));else{if(n=za(e.container(),e.offset()),La(n)&&t(n,0),Fa(n)&&e.isAtEnd())return o(Sa(Ua(n),!1)),r;e=za(e.container(),e.offset()-1),Fa(e)&&!Va(e)&&(!Ia(e)&&!Ia(n)&&Fa(n)||o(Sa(Ua(e),!1))),Fa(n)&&o(Sa(Ua(n),!0))}return r};function qa(t,n,e){function o(){return e=e||Wa(qa(t,n))}return{container:_(t),offset:_(n),toRange:function(){var e=ja(t.ownerDocument);return e.setStart(t,n),e.setEnd(t,n),e},getClientRects:o,isVisible:function(){return 0<o().length},isAtStart:function(){return La(t),0===n},isAtEnd:function(){return La(t)?n>=t.data.length:n>=t.childNodes.length},isEqual:function(e){return e&&t===e.container()&&n===e.offset()},getNode:function(e){return za(t,e?n-1:n)}}}(ka=qa=qa||{}).fromRangeStart=function(e){return ka(e.startContainer,e.startOffset)},ka.fromRangeEnd=function(e){return ka(e.endContainer,e.endOffset)},ka.after=function(e){return ka(e.parentNode,Ha(e)+1)},ka.before=function(e){return ka(e.parentNode,Ha(e))},ka.isAbove=function(e,t){return sa(C(t.getClientRects()),N(e.getClientRects()),ma).getOr(!1)},ka.isBelow=function(e,t){return sa(N(t.getClientRects()),C(e.getClientRects()),ga).getOr(!1)},ka.isAtStart=function(e){return!!e&&e.isAtStart()},ka.isAtEnd=function(e){return!!e&&e.isAtEnd()},ka.isTextPosition=function(e){return!!e&&wn(e.container())},ka.isElementPosition=function(e){return!1===ka.isTextPosition(e)};function Ga(e,t){wn(t)&&0===t.data.length&&e.remove(t)}function $a(e,t,n){var o,r,i,u,a;kn(n)?(o=e,r=t,u=Y.from((i=n).firstChild),a=Y.from(i.lastChild),r.insertNode(i),u.each(function(e){return Ga(o,e.previousSibling)}),a.each(function(e){return Ga(o,e.nextSibling)})):(e=e,t.insertNode(n=n),Ga(e,n.previousSibling),Ga(e,n.nextSibling))}function Xa(t){return function(e){return t===e}}function Ya(e){var t,o;return(jc(e)?"text()":e.nodeName.toLowerCase())+"["+(o=Gc(qc(t=e)),e=n(o,Xa(t),t),o=o.slice(0,e+1),e=z(o,function(e,t,n){return jc(t)&&jc(o[n-1])&&e++,e},0),o=V(o,at([t.nodeName])),n(o,Xa(t),t)-e)+"]"}function Ka(e,t){var n,o=[],r=t.container(),i=t.offset();return jc(r)?n=function(e,t){for(;(e=e.previousSibling)&&jc(e);)t+=e.data.length;return t}(r,i):(i>=(t=r.childNodes).length?(n="after",i=t.length-1):n="before",r=t[i]),o.push(Ya(r)),r=function(e,t){var n=[];for(t=t.parentNode;t!==e;t=t.parentNode)n.push(t);return n}(e,r),r=V(r,a(ct)),(o=o.concat(L(r,Ya))).reverse().join("/")+","+n}function Ja(e,t){if(!t)return null;var t=(n=t.split(","))[0].split("/"),n=1<n.length?n[1]:"before";return(e=z(t,function(e,t){var n,o=/([\w\-\(\)]+)\[([0-9]+)\]/.exec(t);return o?("text()"===o[1]&&(o[1]="#text"),t=e,e=o[1],o=parseInt(o[2],10),n=Gc(t),n=V(n,function(e,t){return!jc(e)||!jc(n[t-1])}),(n=V(n,at([e])))[o]):null},e))?jc(e)?function(e,t){for(var n,o=e,r=0;jc(o);){if(n=o.data.length,r<=t&&t<=r+n){e=o,t-=r;break}if(!jc(o.nextSibling)){e=o,t=n;break}r+=n,o=o.nextSibling}return jc(e)&&t>e.data.length&&(t=e.data.length),zc(e,t)}(e,parseInt(n,10)):(n="after"===n?Wc(e)+1:Wc(e),zc(e.parentNode,n)):null}function Qa(e,t,n,o,r){var i=o[r?"startContainer":"endContainer"],o=o[r?"startOffset":"endOffset"],u=[],r=0,a=e.getRoot();for(wn(i)?u.push(n?function(e,t,n){for(var o=e(t.data.slice(0,n)).length,r=t.previousSibling;r&&wn(r);r=r.previousSibling)o+=e(r.data).length;return o}(t,i,o):o):(o>=(t=i.childNodes).length&&t.length&&(r=1,o=Math.max(0,t.length-1)),u.push(e.nodeIndex(t[o],n)+r));i&&i!==a;i=i.parentNode)u.push(e.nodeIndex(i,n));return u}function Za(e,t,n){var o=0;return Kt.each(e.select(t),function(e){if("all"!==e.getAttribute("data-mce-bogus"))return e!==n&&void o++}),o}function ec(e,t){var n=t?"start":"end",o=e[n+"Container"],r=e[n+"Offset"];yn(o)&&"TR"===o.nodeName&&(o=(n=o.childNodes)[Math.min(t?r:r-1,n.length-1)])&&(r=t?0:o.childNodes.length,e["set"+(t?"Start":"End")](o,r))}function tc(e){return ec(e,!0),ec(e,!1),e}function nc(e,t){return yn(e)&&(e=va(e,t),$c(e))?e:Oo(e)?(t=(e=wn(e)&&So(e)?e.parentNode:e).previousSibling,$c(t)?t:(t=e.nextSibling,$c(t)?t:void 0)):void 0}function oc(e,t,n){var o=n.getNode(),r=o?o.nodeName:null,i=n.getRng();return $c(o)||"IMG"===r?{name:r,index:Za(n.dom,r,o)}:(o=nc((o=i).startContainer,o.startOffset)||nc(o.endContainer,o.endOffset))?{name:r=o.tagName,index:Za(n.dom,r,o)}:(o=(r=n).dom,(n={}).start=Qa(o,e=e,t=t,i=i,!0),r.isCollapsed()||(n.end=Qa(o,e,t,i,!1)),n)}function rc(e,t,n){return t={"data-mce-type":"bookmark",id:t,style:"overflow:hidden;line-height:0px"},n?e.create("span",t,"&#xFEFF;"):e.create("span",t)}function ic(e,t){var n=e.dom,o=e.getRng(),r=n.uniqueId(),i=e.isCollapsed(),u=e.getNode(),a=u.nodeName;return"IMG"===a?{name:a,index:Za(n,a,u)}:(u=tc(o.cloneRange()),i||(u.collapse(!1),i=rc(n,r+"_end",t),$a(n,u,i)),(o=tc(o)).collapse(!0),t=rc(n,r+"_start",t),$a(n,o,t),e.moveToBookmark({id:r,keep:!0}),{id:r})}function uc(e,t,n){var o=e.getParam(t,n);return-1===o.indexOf("=")?o:(t=e.getParam(t,"","hash")).hasOwnProperty(e.id)?t[e.id]:n}function ac(e){return e.getParam("content_security_policy","")}function cc(e){return e.getParam("force_p_newlines",!1)?"p":!1===(e=e.getParam("forced_root_block","p"))?"":!0===e?"p":e}function sc(e){return e.getParam("forced_root_block_attrs",{})}function lc(e){return e.getParam("automatic_uploads",!0,"boolean")}function fc(e){return e.getParam("icons","","string")}function dc(e){return e.getParam("referrer_policy","","string")}function mc(e){return e.getParam("language","en","string")}function gc(e){return e.getParam("indent_use_margin",!1)}function pc(e){return!1!==(e=e.getParam("object_resizing"))&&!$t.iOS&&(Q(e)?e:"table,img,figure.image,div")}function hc(e){return e.getParam("event_root")}function vc(e){return e.getParam("theme")}function bc(e){return!1!==e.getParam("inline_boundaries")}function yc(e){return e.getParam("plugins","","string")}function xc(e){var t=e.parentNode;t&&t.removeChild(e)}function wc(e){var t=Co(e);return{count:e.length-t.length,text:t}}function Cc(e){for(var t;-1!==(t=e.data.lastIndexOf(Zo));)e.deleteData(t,1)}function Sc(e,t){return zc.isTextPosition(t)?(o=t,Jc(n=e)&&o.container()===n?(u=wc((r=n).data.substr(0,(i=o).offset())),a=wc(r.data.substr(i.offset())),0<(u.text+a.text).length?(Cc(r),zc(r,i.offset()-u.count)):i):Qc(n,o)):(e=e,((t=t).container()===e.parentNode?function(e,t){var n=t.container(),o=(o=ge(n.childNodes),(-1===(o=s(o,e))?Y.none():Y.some(o)).map(function(e){return e<t.offset()?zc(n,t.offset()-1):t}).getOr(t));return Zc(e),o}:Qc)(e,t));var n,o,r,i,u,a}function kc(e,t,n){var o,r,i=fa(t.getBoundingClientRect(),n),u="BODY"===e.tagName?(o=e.ownerDocument.documentElement,r=e.scrollLeft||o.scrollLeft,e.scrollTop||o.scrollTop):(u=e.getBoundingClientRect(),r=e.scrollLeft-u.left,e.scrollTop-u.top);return i.left+=r,i.right+=r,i.top+=u,i.bottom+=u,i.width=1,0<(t=t.offsetWidth-t.clientWidth)&&(n&&(t*=-1),i.left+=t,i.right+=t),i}function Oc(e,i,r,u){function a(){!function(){for(var e=Zu(Jt.fromDom(i),"*[contentEditable=false],video,audio,embed,object"),t=0;t<e.length;t++){var n,o=e[t].dom,r=o.previousSibling;Ao(r)&&(1===(n=r.data).length?r.parentNode.removeChild(r):r.deleteData(n.length-1,1)),r=o.nextSibling,Do(r)&&(1===(n=r.data).length?r.parentNode.removeChild(r):r.deleteData(0,1))}}(),s&&(Zc(s),s=null),l.get().each(function(e){_u(e.caret).remove(),l.set(Y.none())}),c&&(mo.clearInterval(c),c=null)}var c,s,l=zu(Y.none()),f=0<(e=cc(e)).length?e:"p";return{show:function(t,e){var n;if(a(),os(e))return null;if(!r(e))return s=function(e,t){var n,o=e.ownerDocument.createTextNode(Zo),r=e.parentNode;if(t){if(n=e.previousSibling,tr(n)){if(Oo(n))return n;if(Ao(n))return n.splitText(n.data.length-1)}r.insertBefore(o,e)}else{if(n=e.nextSibling,tr(n)){if(Oo(n))return n;if(Do(n))return n.splitText(1),n}e.nextSibling?r.insertBefore(o,e.nextSibling):r.appendChild(o)}return o}(e,t),n=e.ownerDocument.createRange(),rs(s.nextSibling)?(n.setStart(s,0),n.setEnd(s,0)):(n.setStart(s,1),n.setEnd(s,1)),n;s=function(e,t,n){var o=t.ownerDocument.createElement(e);o.setAttribute("data-mce-caret",n?"before":"after"),o.setAttribute("data-mce-bogus","all"),o.appendChild(((e=document.createElement("br")).setAttribute("data-mce-bogus","1"),e));e=t.parentNode;return n?e.insertBefore(o,t):t.nextSibling?e.insertBefore(o,t.nextSibling):e.appendChild(o),o}(f,e,t),o=kc(i,e,t),_u(s).css("top",o.top);var o=_u('<div class="mce-visual-caret" data-mce-bogus="all"></div>').css(o).appendTo(i)[0];return l.set(Y.some({caret:o,element:e,before:t})),l.get().each(function(e){t&&_u(e.caret).addClass("mce-visual-caret-before")}),c=mo.setInterval(function(){u()?_u("div.mce-visual-caret",i).toggleClass("mce-visual-caret-hidden"):_u("div.mce-visual-caret",i).addClass("mce-visual-caret-hidden")},500),(n=e.ownerDocument.createRange()).setStart(s,0),n.setEnd(s,0),n},hide:a,getCss:function(){return".mce-visual-caret {position: absolute;background-color: black;background-color: currentcolor;}.mce-visual-caret-hidden {display: none;}*[data-mce-caret] {position: absolute;left: -1000px;right: auto;top: 0;margin: 0;padding: 0;}"},reposition:function(){l.get().each(function(e){var t=kc(i,e.element,e.before);_u(e.caret).css(we({},t))})},destroy:function(){return mo.clearInterval(c)}}}function _c(){return es.isIE()||es.isEdge()||es.isFirefox()}function Ec(e){return rs(e)||st(e)&&_c()}function Tc(e,t){for(var n;n=e(t);)if(!ss(n))return n;return null}function Dc(e,t,n,o,r){var i=new vo(e,o),o=is(e)||ss(e);if(t<0){if(o&&n(e=Tc(i.prev,!0)))return e;for(;e=Tc(i.prev,r);)if(n(e))return e}if(0<t){if(o&&n(e=Tc(i.next,!0)))return e;for(;e=Tc(i.next,r);)if(n(e))return e}return null}function Ac(e,t){for(;e&&e!==t;){if(as(e))return e;e=e.parentNode}return null}function Bc(e,t,n){return Ac(e.container(),n)===Ac(t.container(),n)}function Nc(e,t){if(!t)return null;var n=t.container(),t=t.offset();return ls(n)?n.childNodes[t+e]:null}function Rc(e,t,n){for(var o,r,i,u=e?"previousSibling":"nextSibling";n&&n!==t;){if(o=n[u],cs(o)&&(o=o[u]),is(o)||us(o)){if(i=n,Ac(o,r=t)===Ac(i,r))return o;break}if(fs(o))break;n=n.parentNode}return null}function Mc(e,t,n){var o,r=w(Rc,!0,t),i=w(Rc,!1,t),u=n.startContainer,a=n.startOffset;if(So(u)){if("before"===(t=(u=!ls(u)?u.parentNode:u).getAttribute("data-mce-caret"))&&(o=u.nextSibling,Ec(o)))return ds(o);if("after"===t&&(o=u.previousSibling,Ec(o)))return ms(o)}if(!n.collapsed)return n;if(wn(u)){if(cs(u)){if(1===e){if(o=i(u))return ds(o);if(o=r(u))return ms(o)}if(-1===e){if(o=r(u))return ms(o);if(o=i(u))return ds(o)}return n}if(Ao(u)&&a>=u.data.length-1)return 1===e&&(o=i(u))?ds(o):n;if(Do(u)&&a<=1)return-1===e&&(o=r(u))?ms(o):n;if(a===u.data.length)return(o=i(u))?ds(o):n;if(0===a)return(o=r(u))?ms(o):n}return n}function Ic(e,t){return Y.from(Nc(e?0:-1,t)).filter(is)}function Fc(e,t,n){return n=Mc(e,t,n),-1===e?qa.fromRangeStart(n):qa.fromRangeEnd(n)}function Pc(e){return Y.from(e.getNode()).map(Jt.fromDom)}function Lc(e,t){for(;t=e(t);)if(t.isVisible())return t;return t}function Vc(e,t){return!((t=Bc(e,t))||!On(e.getNode()))||t}var Hc,zc=qa,jc=wn,Uc=ct,Wc=Iu.nodeIndex,qc=function(e){e=e.parentNode;return Uc(e)?qc(e):e},Gc=function(e){return e?z(e.childNodes,function(e,t){return Uc(t)&&"BR"!==t.nodeName?e=e.concat(Gc(t)):e.push(t),e},[]):[]},$c=Tn,Xc=w(oc,t,!0),Yc=Iu.DOM,Kc=yn,Jc=wn,Qc=function(e,t){return Zc(e),t},Zc=function(e){Kc(e)&&Oo(e)&&(_o(e)?e.removeAttribute("data-mce-caret"):xc(e)),Jc(e)&&(Cc(e),0===e.data.length&&xc(e))},es=Gt().browser,ts=Tn,ns=Dn,os=Mt,rs=function(e){return ts(e)||ns(e)},is=Tn,us=Dn,as=K("display","block table table-cell table-caption list-item"),cs=Oo,ss=So,ls=yn,fs=No,Rt=function(e,t){var n=t.ownerDocument.createRange();return e?(n.setStartBefore(t),n.setEndBefore(t)):(n.setStartAfter(t),n.setEndAfter(t)),n},ds=w(Rt,!0),ms=w(Rt,!1);(J=Hc={})[J.Backwards=-1]="Backwards",J[J.Forwards=1]="Forwards";function gs(e){return ar(e)||!!lr(e=e)&&!0!==T(ge(e.getElementsByTagName("*")),function(e,t){return e||nr(t)},!1)}function ps(e,t){return e.hasChildNodes()&&t<e.childNodes.length?e.childNodes[t]:null}function hs(e,t){if(0<e){if(Tl(t.previousSibling)&&!Ol(t.previousSibling))return zc.before(t);if(Ol(t))return zc(t,0)}if(e<0){if(Tl(t.nextSibling)&&!Ol(t.nextSibling))return zc.after(t);if(Ol(t))return zc(t,t.data.length)}return e<0&&!El(t)?zc.after(t):zc.before(t)}function vs(t){return{next:function(e){return Al(Hc.Forwards,e,t)},prev:function(e){return Al(Hc.Backwards,e,t)}}}function bs(e){return zc.isTextPosition(e)?0===e.offset():No(e.getNode())}function ys(e){if(zc.isTextPosition(e)){var t=e.container();return e.offset()===t.data.length}return No(e.getNode(!0))}function xs(e,t){return!zc.isTextPosition(e)&&!zc.isTextPosition(t)&&e.getNode()===t.getNode(!0)}function ws(e,t,n){return t=vs(t),Y.from(e?t.next(n):t.prev(n))}function Cs(r,i,u){return ws(r,i,u).bind(function(e){return Bc(u,e,i)&&(n=u,o=e,(t=r)?!xs(n,o)&&!(!zc.isTextPosition(t=n)&&On(t.getNode()))&&ys(n)&&bs(o):!xs(o,n)&&bs(n)&&ys(o))?ws(r,i,e):Y.some(e);var t,n,o})}function Ss(e,t){var n,o=e?t.firstChild:t.lastChild;return wn(o)?Y.some(zc(o,e?0:o.data.length)):o?No(o)?Y.some(e?zc.before(o):On(n=o)?zc.before(n):zc.after(n)):(t=t,o=o,o=(e=e)?zc.before(o):zc.after(o),ws(e,t,o)):Y.none()}function ks(e){return yn(e)&&e.id===Fl}function Os(e,t){for(;t&&t!==e;){if(t.id===Fl)return t;t=t.parentNode}return null}function _s(e,t){return yn(t)&&e.isBlock(t)&&!t.innerHTML&&!$t.ie&&(t.innerHTML='<br data-mce-bogus="1" />'),t}function Es(e,t,n){return!(!1!==t.hasChildNodes()||!Os(e,t)||(e=n,t=(n=t).ownerDocument.createTextNode(Zo),n.appendChild(t),e.setStart(t,0),e.setEnd(t,0),0))}function Ts(e,t,n,o){var r,i,u,a=n[t?"start":"end"],c=e.getRoot();if(a){for(e=a[0],i=c,r=a.length-1;1<=r;r--){if(u=i.childNodes,Es(c,i,o))return 1;if(a[r]>u.length-1)return!!Es(c,i,o)||function(t){return Il(i).fold(function(){return!1},function(e){return t.setStart(e.container(),e.offset()),t.setEnd(e.container(),e.offset()),!0})}(o);i=u[a[r]]}3===i.nodeType&&(e=Math.min(a[0],i.nodeValue.length)),1===i.nodeType&&(e=Math.min(a[0],i.childNodes.length)),t?o.setStart(i,e):o.setEnd(i,e)}return 1}function Ds(e){return wn(e)&&0<e.data.length}function As(e,t,n){var o,r,i,u,a=e.get(n.id+"_"+t),c=n.keep;if(a){if(r=a.parentNode,o="start"===t?c?a.hasChildNodes()?(r=a.firstChild,1):Ds(a.nextSibling)?(r=a.nextSibling,0):Ds(a.previousSibling)?(r=a.previousSibling,a.previousSibling.data.length):(r=a.parentNode,e.nodeIndex(a)+1):e.nodeIndex(a):c?a.hasChildNodes()?(r=a.firstChild,1):Ds(a.previousSibling)?(r=a.previousSibling,a.previousSibling.data.length):(r=a.parentNode,e.nodeIndex(a)):e.nodeIndex(a),i=r,u=o,!c){for(r=a.previousSibling,c=a.nextSibling,Kt.each(Kt.grep(a.childNodes),function(e){wn(e)&&(e.nodeValue=e.nodeValue.replace(/\uFEFF/g,""))});a=e.get(n.id+"_"+t);)e.remove(a,!0);r&&c&&r.nodeType===c.nodeType&&wn(r)&&!$t.opera&&(o=r.nodeValue.length,r.appendData(c.nodeValue),e.remove(c),i=r,u=o)}return Y.some(zc(i,u))}return Y.none()}function Bs(e,t,n){return 2===t?oc(Co,n,e):3===t?(n=(o=e).getRng(),{start:Ka(o.dom.getRoot(),zc.fromRangeStart(n)),end:Ka(o.dom.getRoot(),zc.fromRangeEnd(n))}):t?{rng:e.getRng()}:ic(e,!1);var o}function Ns(t,e){!function(e,t){var n,o,r,i,u,a,c=e.dom;if(t){if(Kt.isArray(t.start))return u=t,a=(e=c).createRng(),Ts(e,!0,u,a)&&Ts(e,!1,u,a)?Y.some(a):Y.none();if("string"==typeof t.start)return Y.some((u=t,r=(a=c).createRng(),i=Ja(a.getRoot(),u.start),r.setStart(i.container(),i.offset()),i=Ja(a.getRoot(),u.end),r.setEnd(i.container(),i.offset()),r));if(t.hasOwnProperty("id"))return r=As(o=c,"start",i=t),i=As(o,"end",i),sa(r,i.or(r),function(e,t){var n=o.createRng();return n.setStart(_s(o,e.container()),e.offset()),n.setEnd(_s(o,t.container()),t.offset()),n});if(t.hasOwnProperty("name"))return n=c,Y.from(n.select((c=t).name)[c.index]).map(function(e){var t=n.createRng();return t.selectNode(e),t});if(t.hasOwnProperty("rng"))return Y.some(t.rng)}return Y.none()}(t,e).each(function(e){t.setRng(e)})}function Rs(e){return yn(e)&&"SPAN"===e.tagName&&"bookmark"===e.getAttribute("data-mce-type")}function Ms(e){return" "===e}function Is(e){return""!==e&&-1!==" \f\n\r\t\v".indexOf(e)}function Fs(e){return!Is(e)&&!Ms(e)}function Ps(e){return!!e.nodeType}function Ls(e,t,n){var o,r,i,u=n.startOffset,a=n.startContainer;if(!(n.startContainer===n.endContainer&&(i=n.startContainer.childNodes[n.startOffset])&&/^(IMG)$/.test(i.nodeName)||1!==a.nodeType))for(u<(i=a.childNodes).length?(a=i[u],o=new vo(a,e.getParent(a,e.isBlock))):(a=i[i.length-1],(o=new vo(a,e.getParent(a,e.isBlock))).next(!0)),r=o.current();r;r=o.next())if(3===r.nodeType&&!Pl(r))return n.setStart(r,0),t.setRng(n),0}function Vs(e,t,n){if(e){var o=t?"nextSibling":"previousSibling";for(e=n?e:e[o];e;e=e[o])if(1===e.nodeType||!Pl(e))return e}}function Hs(e,t){return Ps(t)&&(t=t.nodeName),!!e.schema.getTextBlockElements()[t.toLowerCase()]}function zs(e,t,n){return e.schema.isValidChild(t,n)}function js(e,n){return"string"!=typeof e?e=e(n):n&&(e=e.replace(/%(\w+)/g,function(e,t){return n[t]||e})),e}function Us(e,t){return e=""+((e=e||"").nodeName||e),t=""+((t=t||"").nodeName||t),e.toLowerCase()===t.toLowerCase()}function Ws(e,t,n){return"color"!==n&&"backgroundColor"!==n||(t=e.toHex(t)),"fontWeight"===n&&700===t&&(t="bold"),""+(t="fontFamily"===n?t.replace(/[\'\"]/g,"").replace(/,\s+/g,","):t)}function qs(e,t,n){return Ws(e,e.getStyle(t,n),n)}function Gs(t,e){var n;return t.getParent(e,function(e){return(n=t.getStyle(e,"text-decoration"))&&"none"!==n}),n}function $s(e,t,n){return e.getParents(t,n,e.getRoot())}function Xs(t,e,o){function r(e){return I(e,function(e,t){return y(n,function(e){return e===t})})}var n=["inline","block","selector","attributes","styles","classes"];return y(t.formatter.get(e),function(e){var n=r(e);return y(t.formatter.get(o),function(e){var t,e=r(e);return i(t=void 0===t?u:t).eq(n,e)})})}function Ys(e){return F(e,"block")}function Ks(e){return F(e,"selector")}function Js(e){return F(e,"inline")}function Qs(e,t){for(var n=t;n;){if(yn(n)&&e.getContentEditable(n))return"false"===e.getContentEditable(n)?n:t;n=n.parentNode}return t}function Zs(e,t,n,o){for(var r=t.data,i=n;e?0<=i:i<r.length;e?i--:i++)if(o(r.charAt(i)))return e?i+1:i;return-1}function el(e,t,n){return Zs(e,t,n,function(e){return Ms(e)||Is(e)})}function tl(e,t,n){return Zs(e,t,n,Fs)}function nl(r,e,t,n,i,o){function u(e,t,n){var o=ca(r),o=i?o.backwards:o.forwards;return Y.from(o(e,t,function(e,t){return Ll(e.parentNode)?-1:n(i,a=e,t)},c))}var a,c=r.getParent(t,r.isBlock)||e;return u(t,n,el).bind(function(e){return o?u(e.container,e.offset+(i?-1:0),tl):Y.some(e)}).orThunk(function(){return a?Y.some({container:a,offset:i?0:a.length}):Y.none()})}function ol(e,t,n,o,r){wn(o)&&0===o.nodeValue.length&&o[r]&&(o=o[r]);for(var i=Vl(e,o),u=0;u<i.length;u++)for(var a=0;a<t.length;a++){var c=t[a];if(!("collapsed"in c&&c.collapsed!==n.collapsed)&&e.is(i[u],c.selector))return i[u]}return o}function rl(t,e,n,o){var r,i,u=t.dom,a=u.getRoot();if((i=!e[0].wrapper?u.getParent(n,e[0].block,a):i)||(r=u.getParent(n,"LI,TD,TH"),i=u.getParent(wn(n)?n.parentNode:n,function(e){return e!==a&&zl(t,e)},r)),!(i=i&&e[0].wrapper?Vl(u,i,"ul,ol").reverse()[0]||i:i))for(i=n;i[o]&&!u.isBlock(i[o])&&(i=i[o],!Us(i,"br")););return i||n}function il(e,t,n,o,r){var i,u,a=n,c=r?"previousSibling":"nextSibling",s=e.getRoot();if(wn(n)&&!Hl(n)&&(r?0<o:o<n.data.length))return n;for(;;){if(!t[0].block_expand&&e.isBlock(a))return a;for(i=a[c];i;i=i[c]){var l=wn(i)&&!jl(e,s,i,c);if(!Ll(i)&&(!On(u=i)||!u.getAttribute("data-mce-bogus")||u.nextSibling)&&!Hl(i,l))return a}if(a===s||a.parentNode===s){n=a;break}a=a.parentNode}return n}function ul(e){return Ll(e.parentNode)||Ll(e)}function al(e,t,n,o){void 0===o&&(o=!1);var r=t.startContainer,i=t.startOffset,u=t.endContainer,a=t.endOffset,c=e.dom;return yn(r)&&r.hasChildNodes()&&(r=va(r,i),wn(r)&&(i=0)),yn(u)&&u.hasChildNodes()&&(u=va(u,t.collapsed?a:a-1),wn(u)&&(a=u.nodeValue.length)),r=Qs(c,r),u=Qs(c,u),ul(r)&&(r=Ll(r)?r:r.parentNode,r=t.collapsed?r.previousSibling||r:r.nextSibling||r,wn(r)&&(i=t.collapsed?r.length:0)),ul(u)&&(u=Ll(u)?u:u.parentNode,u=t.collapsed?u.nextSibling||u:u.previousSibling||u,wn(u)&&(a=t.collapsed?0:u.length)),t.collapsed&&(nl(c,e.getBody(),r,i,!0,o).each(function(e){var t=e.container,e=e.offset;r=t,i=e}),nl(c,e.getBody(),u,a,!1,o).each(function(e){var t=e.container,e=e.offset;u=t,a=e})),(n[0].inline||n[0].block_expand)&&(n[0].inline&&wn(r)&&0!==i||(r=il(c,n,r,i,!0)),n[0].inline&&wn(u)&&a!==u.nodeValue.length||(u=il(c,n,u,a,!1))),n[0].selector&&!1!==n[0].expand&&!n[0].inline&&(r=ol(c,n,t,r,"previousSibling"),u=ol(c,n,t,u,"nextSibling")),(n[0].block||n[0].selector)&&(r=rl(e,n,r,"previousSibling"),u=rl(e,n,u,"nextSibling"),n[0].block&&(c.isBlock(r)||(r=il(c,n,r,i,!0)),c.isBlock(u)||(u=il(c,n,u,a,!1)))),yn(r)&&(i=c.nodeIndex(r),r=r.parentNode),yn(u)&&(a=c.nodeIndex(u)+1,u=u.parentNode),{startContainer:r,startOffset:i,endContainer:u,endOffset:a}}function cl(e,t){var n=e.childNodes;return t>=n.length?t=n.length-1:t<0&&(t=0),n[t]||e}function sl(e,t,a){function c(e){var t=e[0];return 3===t.nodeType&&t===o&&r>=t.nodeValue.length&&e.splice(0,1),t=e[e.length-1],0===u&&0<e.length&&t===i&&3===t.nodeType&&e.splice(e.length-1,1),e}function s(e,t,n){for(var o=[];e&&e!==n;e=e[t])o.push(e);return o}function n(e,t,n){var o=n?"nextSibling":"previousSibling",r=e;for(r.parentNode;r&&r!==t;r=i){var i=r.parentNode,u=s(r===e?r:r[o],o);u.length&&(n||u.reverse(),a(c(u)))}}var o=t.startContainer,r=t.startOffset,i=t.endContainer,u=t.endOffset,t=function(e,t){do{if(e.parentNode===t)return e}while(e=e.parentNode)};if(1===o.nodeType&&o.hasChildNodes()&&(o=cl(o,r)),1===i.nodeType&&i.hasChildNodes()&&(i=cl(i,u-1)),o===i)return a(c([o]));for(var l=e.findCommonAncestor(o,i),f=o;f;f=f.parentNode){if(f===i)return n(o,l,!0);if(f===l)break}for(f=i;f;f=f.parentNode){if(f===o)return n(i,l);if(f===l)break}e=t(o,l)||o,t=t(i,l)||i,n(o,e,!0),(e=s(e===o?e:e.nextSibling,"nextSibling",t===i?t.nextSibling:t)).length&&a(c(e)),n(i,t)}function ll(e){var t=[];if(e)for(var n=0;n<e.rangeCount;n++)t.push(e.getRangeAt(n));return t}function fl(e,t){return 0<(t=Zu(t,"td[data-mce-selected],th[data-mce-selected]")).length?t:me(v(e,function(e){e=ha(e);return e?[Jt.fromDom(e)]:[]}),Yo)}function dl(e){return fl(ll(e.selection.getSel()),Jt.fromDom(e.getBody()))}function ml(n,e){return sa((t=e.startContainer,o=e.startOffset,wn(t)?0===o?Y.some(Jt.fromDom(t)):Y.none():Y.from(t.childNodes[o]).map(Jt.fromDom)),(o=e.endContainer,e=e.endOffset,wn(o)?e===o.data.length?Y.some(Jt.fromDom(o)):Y.none():Y.from(o.childNodes[e-1]).map(Jt.fromDom)),function(e,t){e=D(Ul(n),w(Pe,e)),t=D(Wl(n),w(Pe,t));return e.isSome()&&t.isSome()}).getOr(!1);var t,o}function gl(e,t,n,o){var r=n,i=new vo(n,r),u=I(e.schema.getMoveCaretBeforeOnEnterElements(),function(e,t){return!ee(["td","th","table"],t.toLowerCase())});do{if(wn(n)&&0!==Kt.trim(n.nodeValue).length)return o?t.setStart(n,0):t.setEnd(n,n.nodeValue.length),0;if(u[n.nodeName])return o?t.setStartBefore(n):"BR"===n.nodeName?t.setEndBefore(n):t.setEndAfter(n),0}while(n=o?i.next():i.prev());"BODY"===r.nodeName&&(o?t.setStart(r,0):t.setEnd(r,r.childNodes.length))}function pl(e){return(e=e.selection.getSel())&&0<e.rangeCount}function hl(n,o){var e=dl(n);0<e.length?de(e,function(e){var t=e.dom,e=n.dom.createRng();e.setStartBefore(t),e.setEndAfter(t),o(e,!0)}):o(n.selection.getRng(),!1)}function vl(e,t,n){t=ic(e,t),n(t),e.moveToBookmark(t)}function bl(e){return ql.get(e)}function yl(e,t,n,o){var r=void 0===(r=t.uid)?na("mce-annotation"):r,t=function(e,t){var n={};for(r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var o=0,r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]]);return n}(t,["uid"]),e=Jt.fromTag("span",e);Ju(e,Ea()),dt(e,""+Da(),r),dt(e,""+Ta(),n);var i,t=(r=o(r,t)).attributes,r=void 0===(r=r.classes)?[]:r;return mt(e,void 0===t?{}:t),i=e,de(r,function(e){Ju(i,e)}),e}function xl(a,e,t,n,o){function c(){d.set(Y.none())}function s(e){de(e,r)}var l=[],f=yl(a.getDoc(),o,t,n),d=zu(Y.none()),r=function(e){var n,o,r,i;switch(n=a,r="span",i=Qt(o=e),Ue(o).fold(function(){return"skipping"},function(e){return"br"===i||en(t=o)&&bl(t)===Zo?"valid":Zt(t=o)&&Qu(t,Ea())?"existing":ks(o.dom)?"caret":zs(n,r,i)&&zs(n,Qt(e),r)?"valid":"invalid-child";var t})){case"invalid-child":c();var t=qe(e);s(t),c();break;case"valid":var u=d.get().getOrThunk(function(){var e=ia(f);return l.push(e),d.set(Y.some(e)),e});ln(t=e,u=u),mn(u,t)}};return sl(a.dom,e,function(e){c(),e=E(e,Jt.fromDom),s(e)}),l}function wl(r){var n,e,o,i=(n={},{register:function(e,t){n[e]={name:e,settings:t}},lookup:function(e){return n.hasOwnProperty(e)?Y.from(n[e]).map(function(e){return e.settings}):Y.none()}});o=i,(e=r).on("init",function(){e.serializer.addNodeFilter("span",function(e){de(e,function(t){var e=t;Y.from(e.attr(Ta())).bind(o.lookup).each(function(e){!1===e.persistent&&t.unwrap()})})})});var u=ta(r);return{register:function(e,t){i.register(e,t)},annotate:function(t,n){i.lookup(t).each(function(e){var i,u,a,c;u=t,a=e,c=n,(i=r).undoManager.transact(function(){var e,t,n=i.selection,o=n.getRng(),r=0<dl(i).length;o.collapsed&&!r&&(o=al(e=i,t=o,[{inline:!0}]),t.setStart(o.startContainer,o.startOffset),t.setEnd(o.endContainer,o.endOffset),e.selection.setRng(t)),n.getRng().collapsed&&!r?(r=yl(i.getDoc(),c,u,a.decorate),oa(r,Qo),n.getRng().insertNode(r.dom),n.select(r.dom)):vl(n,!1,function(){hl(i,function(e){xl(i,e,u,a.decorate,c)})})})})},annotationChanged:function(e,t){u.addListener(e,t)},remove:function(e){ea(r,Y.some(e)).each(function(e){e=e.elements;de(e,Ze)})},getAll:function(e){var o,t=(t=e,e=Jt.fromDom(r.getBody()),t=Zu(e,"["+Ta()+'="'+t+'"]'),o={},de(t,function(e){var t=gt(e,Da()),n=o.hasOwnProperty(t)?o[t]:[];o[t]=n.concat([e])}),o);return S(t,function(e){return E(e,function(e){return e.dom})})}}}var Cl,Sl,kl=Tn,Ol=wn,_l=yn,El=On,Tl=No,Dl=Ro,Al=function(e,t,n){var o,r,i;if(!_l(n)||!t)return null;if(t.isEqual(zc.after(n))&&n.lastChild){if(i=zc.after(n.lastChild),e<0&&Tl(n.lastChild)&&_l(n.lastChild))return El(n.lastChild)?zc.before(n.lastChild):i}else i=t;var u,a=i.container(),c=i.offset();if(Ol(a)){if(e<0&&0<c)return zc(a,--c);if(0<e&&c<a.length)return zc(a,++c);o=a}else{if(e<0&&0<c&&(s=ps(a,c-1),Tl(s)))return!gs(s)&&(r=Dc(s,e,Dl,s))?Ol(r)?zc(r,r.data.length):zc.after(r):Ol(s)?zc(s,s.data.length):zc.before(s);if(0<e&&c<a.childNodes.length&&(s=ps(a,c),Tl(s)))return El(s)?(u=n,(c=(t=s).nextSibling)&&Tl(c)?Ol(c)?zc(c,0):zc.before(c):Al(Hc.Forwards,zc.after(t),u)):!gs(s)&&(r=Dc(s,e,Dl,s))?Ol(r)?zc(r,0):zc.before(r):Ol(s)?zc(s,0):zc.after(s);o=s||i.getNode()}if((0<e&&i.isAtEnd()||e<0&&i.isAtStart())&&(o=Dc(o,e,q,n,!0),Dl(o,n)))return hs(e,o);var s=Dc(o,e,Dl,n),n=j(me(function(e,t){for(var n=[];e&&e!==t;)n.push(e),e=e.parentNode;return n}(a,n),kl));return!n||s&&n.contains(s)?s?hs(e,s):null:0<e?zc.after(n):zc.before(n)},Bl=function(t,n,e,o){return Cs(t,n,e).bind(function(e){return o(e)?Bl(t,n,e,o):Y.some(e)})},Nl=w(ws,!0),Rl=w(ws,!1),Ml=w(Ss,!0),Il=w(Ss,!1),Fl="_mce_caret",Pl=function(e,t){if(void 0===t&&(t=!1),k(e)&&wn(e)){e=t?e.data.replace(/ /g," "):e.data;return dr(e)}return!1},Ll=Rs,Vl=$s,Hl=Pl,zl=Hs,jl=function(e,t,n,o){var r=n.parentNode;return!k(n[o])&&(!(r!==t&&!ue(r)&&!e.isBlock(r))||jl(e,t,r,o))},Ul=function(t){return $e(t).fold(_([t]),function(e){return[t].concat(Ul(e))})},Wl=function(t){return an(t).fold(_([t]),function(e){return"br"===Qt(e)?on(e).map(function(e){return[t].concat(Wl(e))}).getOr([]):[t].concat(Wl(e))})},ql=(Cl=en,{get:function(e){if(!Cl(e))throw new Error("Can only get text value of a text node");return Sl(e).getOr("")},getOption:Sl=function(e){return Cl(e)?Y.from(e.dom.nodeValue):Y.none()},set:function(e,t){if(!Cl(e))throw new Error("Can only set raw text value of a text node");e.dom.nodeValue=t}});function Gl(e){return{getBookmark:w(Bs,e),moveToBookmark:w(Ns,e)}}(Gl=Gl||{}).isBookmarkNode=Rs;function $l(e,t){for(;t&&t!==e;){if(En(t)||Tn(t))return t;t=t.parentNode}return null}function Xl(t,n,e){if(!e.collapsed){if($t.browser.isIE()&&e.startOffset===e.endOffset-1&&e.startContainer===e.endContainer){var o=e.startContainer.childNodes[e.startOffset];if(yn(o))return y(o.getClientRects(),function(e){return pa(e,t,n)})}return y(e.getClientRects(),function(e){return pa(e,t,n)})}}function Yl(n,a){function r(e){return e&&("IMG"===e.nodeName||a.dom.is(e,"figure.image"))}function o(e){var t=e.target;!function(e,t){if("longpress"!==e.type&&0!==e.type.indexOf("touch"))return r(e.target)&&!Xl(e.clientX,e.clientY,t);var n=e.touches[0];return r(e.target)&&!Xl(n.clientX,n.clientY,t)}(e,a.selection.getRng())||e.isDefaultPrevented()||a.selection.select(t)}function c(e){return a.dom.is(e,"figure.image")?e.querySelector("img"):e}function s(e){var t=pc(a);return!!t&&"false"!==e.getAttribute("data-mce-resize")&&e!==a.getBody()&&Ie(Jt.fromDom(e),t)}function l(e,t,n){_.setStyles(c(e),{width:t,height:n})}function f(e){var t,n=e.screenX-h,o=e.screenY-v;C=n*p[2]+b,S=o*p[3]+y,C=C<5?5:C,S=S<5?5:S,(r(d)&&!1!==a.getParam("resize_img_proportional",!0,"boolean")?!sf.modifierPressed(e):sf.modifierPressed(e))&&(A(n)>A(o)?(S=B(C*x),C=B(S/x)):(C=B(S/x),S=B(C*x))),l(m,C,S),t=0<(t=p.startPos.x+n)?t:0,e=0<(e=p.startPos.y+o)?e:0,_.setStyles(g,{left:t,top:e,display:"block"}),g.innerHTML=C+" &times; "+S,p[2]<0&&m.clientWidth<=C&&_.setStyle(m,"left",void 0+(b-C)),p[3]<0&&m.clientHeight<=S&&_.setStyle(m,"top",void 0+(y-S)),(n=N.scrollWidth-k)+(o=N.scrollHeight-O)!=0&&_.setStyles(g,{left:t-n,top:e-o}),w||(t=d,n=b,e=y,o="corner-"+p.name,a.fire("ObjectResizeStart",{target:t,width:n,height:e,origin:o}),w=!0)}function i(e){function t(e,t){if(e)do{if(e===t)return 1}while(e=e.parentNode)}w||a.removed||(E(_.select("img[data-mce-selected],hr[data-mce-selected]"),function(e){e.removeAttribute("data-mce-selected")}),e="mousedown"===e.type?e.target:n.getNode(),t(e=_.$(e).closest("table,img,figure.image,hr")[0],N)&&(L(),t(n.getStart(!0),e)&&t(n.getEnd(!0),e))?I(e):F())}function u(e){return lf($l(a.getBody(),e))}var d,m,g,p,h,v,b,y,x,w,C,S,k,O,_=a.dom,E=Kt.each,T=a.getDoc(),D=document,A=Math.abs,B=Math.round,N=a.getBody(),R={nw:[0,0,-1,-1],ne:[1,0,1,-1],se:[1,1,1,1],sw:[0,1,-1,1]},M=function(){var e=w;w=!1;var t,n,o=function(e,t){t&&(d.style[e]||!a.schema.isValid(d.nodeName.toLowerCase(),e)?_.setStyle(c(d),e,t):_.setAttrib(c(d),e,""+t))};e&&(o("width",C),o("height",S)),_.unbind(T,"mousemove",f),_.unbind(T,"mouseup",M),D!==T&&(_.unbind(D,"mousemove",f),_.unbind(D,"mouseup",M)),_.remove(m),_.remove(g),I(d),e&&(t=d,n=C,o=S,e="corner-"+p.name,a.fire("ObjectResized",{target:t,width:n,height:o,origin:e}),_.setAttrib(d,"style",_.getAttrib(d,"style"))),a.nodeChanged()},I=function(e){F(),P();var t=_.getPos(e,N),o=t.x,r=t.y,t=e.getBoundingClientRect(),i=t.width||t.right-t.left,u=t.height||t.bottom-t.top;d!==e&&(d=e,C=S=0);t=a.fire("ObjectSelected",{target:e});s(e)&&!t.isDefaultPrevented()?E(R,function(t,n){var e=_.get("mceResizeHandle"+n);e&&_.remove(e),e=_.add(N,"div",{id:"mceResizeHandle"+n,"data-mce-bogus":"all",class:"mce-resizehandle",unselectable:!0,style:"cursor:"+n+"-resize; margin:0; padding:0"}),11===$t.ie&&(e.contentEditable=!1),_.bind(e,"mousedown",function(e){e.stopImmediatePropagation(),e.preventDefault(),h=e.screenX,v=e.screenY,b=c(d).clientWidth,y=c(d).clientHeight,x=y/b,(p=t).name=n,p.startPos={x:i*t[0]+o,y:u*t[1]+r},k=N.scrollWidth,O=N.scrollHeight,m=d.cloneNode(!0),_.addClass(m,"mce-clonedresizable"),_.setAttrib(m,"data-mce-bogus","all"),m.contentEditable=!1,m.unSelectabe=!0,_.setStyles(m,{left:o,top:r,margin:0}),l(m,i,u),m.removeAttribute("data-mce-selected"),N.appendChild(m),_.bind(T,"mousemove",f),_.bind(T,"mouseup",M),D!==T&&(_.bind(D,"mousemove",f),_.bind(D,"mouseup",M)),g=_.add(N,"div",{class:"mce-resize-helper","data-mce-bogus":"all"},b+" &times; "+y)}),t.elm=e,_.setStyles(e,{left:i*t[0]+o-e.offsetWidth/2,top:u*t[1]+r-e.offsetHeight/2})}):F(),d.setAttribute("data-mce-selected","1")},F=function(){P(),d&&d.removeAttribute("data-mce-selected"),ve(R,function(e,t){t=_.get("mceResizeHandle"+t);t&&(_.unbind(t),_.remove(t))})},P=function(){ve(R,function(e){e.elm&&(_.unbind(e.elm),delete e.elm)})},L=function(){try{a.getDoc().execCommand("enableObjectResizing",!1,"false")}catch(e){}};return a.on("init",function(){var e;L(),($t.browser.isIE()||$t.browser.isEdge())&&(a.on("mousedown click",function(e){var t=e.target,n=t.nodeName;w||!/^(TABLE|IMG|HR)$/.test(n)||u(t)||(2!==e.button&&a.selection.select(t,"TABLE"===n),"mousedown"===e.type&&a.nodeChanged())}),_.bind(N,"mscontrolselect",e=function(e){function t(e){mo.setEditorTimeout(a,function(){return a.selection.select(e)})}if(u(e.target)||Dn(e.target))return e.preventDefault(),void t(e.target);/^(TABLE|IMG|HR)$/.test(e.target.nodeName)&&(e.preventDefault(),"IMG"===e.target.tagName&&t(e.target))}),a.on("remove",function(){return _.unbind(N,"mscontrolselect",e)}));var t=mo.throttle(function(e){a.composing||i(e)});a.on("nodechange ResizeEditor ResizeWindow ResizeContent drop FullscreenStateChanged",t),a.on("keyup compositionend",function(e){d&&"TABLE"===d.nodeName&&t(e)}),a.on("hide blur",F),a.on("contextmenu longpress",o,!0)}),a.on("remove",P),{isResizable:s,showResizeRect:I,hideResizeRect:F,updateResizeRect:i,destroy:function(){d=m=null}}}function Kl(e){return En(e)||Tn(e)}function Jl(t,n,o){var r,e,i=o;if(i.caretPositionFromPoint)(e=i.caretPositionFromPoint(t,n))&&((r=o.createRange()).setStart(e.offsetNode,e.offset),r.collapse(!0));else if(o.caretRangeFromPoint)r=o.caretRangeFromPoint(t,n);else if(i.body.createTextRange){r=i.body.createTextRange();try{r.moveToPoint(t,n),r.collapse(!0)}catch(e){r=function(e,n,t){var o=t.elementFromPoint(e,n),r=t.body.createTextRange();if(o&&"HTML"!==o.tagName||(o=t.body),r.moveToElementText(o),0<(o=(o=Kt.toArray(r.getClientRects())).sort(function(e,t){return(e=Math.abs(Math.max(e.top-n,e.bottom-n)))-Math.abs(Math.max(t.top-n,t.bottom-n))})).length){n=(o[0].bottom+o[0].top)/2;try{return r.moveToPoint(e,n),r.collapse(!0),r}catch(e){}}return null}(t,n,o)}return t=r,n=o.body,o=t&&t.parentElement?t.parentElement():null,Tn(function(e,t,n){for(;e&&e!==t;){if(n(e))return e;e=e.parentNode}return null}(o,n,Kl))?null:t}return r}function Ql(e,t){return e&&t&&e.startContainer===t.startContainer&&e.startOffset===t.startOffset&&e.endContainer===t.endContainer&&e.endOffset===t.endOffset}function Zl(e,t,n){return null!==function(e,t,n){for(;e&&e!==t;){if(n(e))return e;e=e.parentNode}return null}(e,t,n)}function ef(e){return e&&"TABLE"===e.nodeName}function tf(e,t,n){for(var o=new vo(t,e.getParent(t.parentNode,e.isBlock)||e.getRoot());t=o[n?"prev":"next"]();)if(On(t))return 1}function nf(e,t,n,o,r){var i,u,a=e.getRoot(),c=e.schema.getNonEmptyElements(),s=e.getParent(r.parentNode,e.isBlock)||a;if(o&&On(r)&&t&&e.isEmpty(s))return Y.some(qa(r.parentNode,e.nodeIndex(r)));for(var l,f,d=new vo(r,s);u=d[o?"prev":"next"]();){if("false"===e.getContentEditableParent(u)||(f=a,Oo(l=u)&&!1===Zl(l,f,ks)))return Y.none();if(wn(u)&&0<u.nodeValue.length)return!1===Zl(u,a,function(e){return"A"===e.nodeName})?Y.some(qa(u,o?u.nodeValue.length:0)):Y.none();if(e.isBlock(u)||c[u.nodeName.toLowerCase()])return Y.none();i=u}return n&&i?Y.some(qa(i,0)):Y.none()}function of(e,t,n,o){var r,i,u=e.getRoot(),a=!1,c=o[(n?"start":"end")+"Container"],s=o[(n?"start":"end")+"Offset"],o=yn(c)&&s===c.childNodes.length,l=e.schema.getNonEmptyElements(),f=n;if(Oo(c))return Y.none();if(yn(c)&&s>c.childNodes.length-1&&(f=!1),Sn(c)&&(c=u,s=0),c===u){if(f&&(r=c.childNodes[0<s?s-1:0])){if(Oo(r))return Y.none();if(l[r.nodeName]||ef(r))return Y.none()}if(c.hasChildNodes()){if(s=Math.min(!f&&0<s?s-1:s,c.childNodes.length-1),c=c.childNodes[s],s=wn(c)&&o?c.data.length:0,!t&&c===u.lastChild&&ef(c))return Y.none();if(function(e,t){for(;t&&t!==e;){if(Tn(t))return 1;t=t.parentNode}}(u,c)||Oo(c))return Y.none();if(c.hasChildNodes()&&!1===ef(c)){var d=new vo(r=c,u);do{if(Tn(r)||Oo(r)){a=!1;break}if(wn(r)&&0<r.nodeValue.length){s=f?0:r.nodeValue.length,c=r,a=!0;break}if(l[r.nodeName.toLowerCase()]&&(!(i=r)||!/^(TD|TH|CAPTION)$/.test(i.nodeName))){s=e.nodeIndex(r),c=r.parentNode,f||s++,a=!0;break}}while(r=f?d.next():d.prev())}}}return t&&(wn(c)&&0===s&&nf(e,o,t,!0,c).each(function(e){c=e.container(),s=e.offset(),a=!0}),yn(c)&&(!(r=(r=c.childNodes[s])||c.childNodes[s-1])||!On(r)||r.previousSibling&&"A"===r.previousSibling.nodeName||tf(e,r,!1)||tf(e,r,!0)||nf(e,o,t,!0,r).each(function(e){c=e.container(),s=e.offset(),a=!0}))),f&&!t&&wn(c)&&s===c.nodeValue.length&&nf(e,o,t,!1,c).each(function(e){c=e.container(),s=e.offset(),a=!0}),a?Y.some(qa(c,s)):Y.none()}function rf(e,t){var n=t.collapsed,o=t.cloneRange(),r=qa.fromRangeStart(t);return of(e,n,!0,o).each(function(e){n&&qa.isAbove(r,e)||o.setStart(e.container(),e.offset())}),n||of(e,n,!1,o).each(function(e){o.setEnd(e.container(),e.offset())}),n&&o.collapse(!0),Ql(t,o)?Y.none():Y.some(o)}function uf(e,t){return e.splitText(t)}function af(e){var t=e.startContainer,n=e.startOffset,o=e.endContainer,e=e.endOffset;return t===o&&wn(t)?0<n&&n<t.nodeValue.length&&(t=(o=uf(t,n)).previousSibling,n<e?(t=o=uf(o,e-=n).previousSibling,e=o.nodeValue.length,n=0):e=0):(wn(t)&&0<n&&n<t.nodeValue.length&&(t=uf(t,n),n=0),wn(o)&&0<e&&e<o.nodeValue.length&&(e=(o=uf(o,e).previousSibling).nodeValue.length)),{startContainer:t,startOffset:n,endContainer:o,endOffset:e}}var cf=Gl,sf={BACKSPACE:8,DELETE:46,DOWN:40,ENTER:13,LEFT:37,RIGHT:39,SPACEBAR:32,TAB:9,UP:38,END:35,HOME:36,modifierPressed:function(e){return e.shiftKey||e.ctrlKey||e.altKey||this.metaKeyPressed(e)},metaKeyPressed:function(e){return $t.mac?e.metaKey:e.ctrlKey&&!e.altKey}},lf=Tn;function ff(n){return{walk:function(e,t){return sl(n,e,t)},split:af,normalize:function(t){return rf(n,t).fold(W,function(e){return t.setStart(e.startContainer,e.startOffset),t.setEnd(e.endContainer,e.endOffset),!0})}}}(Dt=ff).compareRanges=Ql,Dt.getCaretRangeFromPoint=Jl,Dt.getSelectedNode=ha,Dt.getNode=va;function df(e){return"textarea"===Qt(e)}function mf(e,t){var n=function(e){var t=e.dom.ownerDocument,n=t.body,o=t.defaultView,r=t.documentElement;if(n===e.dom)return vn(n.offsetLeft,n.offsetTop);var i=et(null==o?void 0:o.pageYOffset,r.scrollTop),t=et(null==o?void 0:o.pageXOffset,r.scrollLeft),o=et(r.clientTop,n.clientTop),n=et(r.clientLeft,n.clientLeft);return tt(e).translate(t-n,i-o)}(e),o=ud.get(e);return{element:e,bottom:n.top+o,height:o,pos:n,cleanup:t}}function gf(n,o,r,i){ld(n,function(e,t){return sd(n,o,r,i)},r)}function pf(e,t,n,o,r){var i={elm:o.element.dom,alignToTop:r};e.fire("ScrollIntoView",i).isDefaultPrevented()||(n(t,nt(t).top,o,r),e.fire("AfterScrollIntoView",i))}function hf(e,t,n,o){var r=Jt.fromDom(e.getDoc());pf(e,r,n,mf(Jt.fromDom(t),U),o)}function vf(e,t,n,o){var r=e.pos;n?ot(r.left,r.top,o):(e=r.top-t+e.height,ot(r.left,e,o))}function bf(e,t,n,o,r){var i=n+t,u=o.pos.top,a=o.bottom,c=n<=a-u;u<t?vf(o,n,!1!==r,e):i<u?vf(o,n,c?!1!==r:!0===r,e):i<a&&!c&&vf(o,n,!0===r,e)}function yf(e,t,n,o){var r=e.dom.defaultView.innerHeight;bf(e,t,r,n,o)}function xf(e,t,n,o){var r=e.dom.defaultView.innerHeight;bf(e,t,r,n,o);var i=(i=n.element,e=Jt.fromDom(document),t=nt(e),e=(r=cd).owner(i),e=ad(r,e),i=tt(i),e=p(e,function(e,t){t=tt(t);return{left:e.left+t.left,top:e.top+t.top}},{left:0,top:0}),vn(e.left+i.left+t.left,e.top+i.top+t.top)),t=bn(window);i.top<t.y?rt(n.element,!1!==o):i.top>t.bottom&&rt(n.element,!0===o)}function wf(e,t,n){(e.inline?function(e,t,n){return gf(e,yf,t,n)}:function(e,t,n){return gf(e,xf,t,n)})(e,t,n)}function Cf(e){var t=sn(e).dom;return e.dom===t.activeElement}function Sf(e){return void 0===e&&(e=Jt.fromDom(document)),Y.from(e.dom.activeElement).map(Jt.fromDom)}function kf(e,t){return(t=en(t)?bl(t).length:qe(t).length+1)<e?t:e<0?0:e}function Of(e){return dd(e.start,kf(e.soffset,e.start),e.finish,kf(e.foffset,e.finish))}function _f(e,t){return!ut(t.dom)&&(Le(e,t)||Pe(e,t))}function Ef(t){return function(e){return _f(t,e.start)&&_f(t,e.finish)}}function Tf(e){return!0===e.inline||md.isIE()}function Df(e){return dd(Jt.fromDom(e.startContainer),e.startOffset,Jt.fromDom(e.endContainer),e.endOffset)}function Af(e){var t=document.createRange();try{return t.setStart(e.start.dom,e.soffset),t.setEnd(e.finish.dom,e.foffset),Y.some(t)}catch(e){return Y.none()}}function Bf(e){var t,n=Tf(e)?(n=Jt.fromDom(e.getBody()),((t=je(n).dom.getSelection())&&0!==t.rangeCount?Y.from(t.getRangeAt(0)):Y.none()).map(Df).filter(Ef(n))):Y.none();e.bookmark=n.isSome()?n:e.bookmark}function Nf(n){return(n.bookmark||Y.none()).bind(function(e){return t=Jt.fromDom(n.getBody()),Y.from(e).filter(Ef(t)).map(Of);var t}).bind(Af)}function Rf(u){var a=$u(function(){Bf(u)},0);u.on("init",function(){var e,t,n,o,r,i;u.inline&&(o=u,e=a,t=function(){e.throttle()},Iu.DOM.bind(document,"mouseup",t),o.on("remove",function(){Iu.DOM.unbind(document,"mouseup",t)})),n=u,o=a,Gt().browser.isIE()?(i=n).on("focusout",function(){Bf(i)}):(r=o,n.on("mouseup touchend",function(e){r.throttle()})),n.on("keyup NodeChange",function(e){"nodechange"===e.type&&e.selectionChange||Bf(n)})}),u.on("remove",function(){a.cancel()})}function Mf(t,e){var n=t.getParam("custom_ui_selector","","string");return null!==pd.getParent(e,function(e){return gd.isEditorUIElement(e)||!!n&&t.dom.is(e,n)})}function If(n,e){e=e.editor,Rf(e),e.on("focusin",function(){var e=n.focusedEditor;e!==this&&(e&&e.fire("blur",{focusedEditor:this}),n.setActive(this),(n.focusedEditor=this).fire("focus",{blurredEditor:e}),this.focus(!0))}),e.on("focusout",function(){var t=this;mo.setEditorTimeout(t,function(){var e=n.focusedEditor;Mf(t,function(e){try{var t=sn(Jt.fromDom(e.getElement()));return Sf(t).fold(function(){return document.body},function(e){return e.dom})}catch(e){return document.body}}(t))||e!==t||(t.fire("blur",{focusedEditor:null}),n.focusedEditor=null)})}),id||(id=function(e){var t=n.activeEditor;t&&function(e){if(cn()&&k(e.target)){var t=Jt.fromDom(e.target);if(Zt(t)&&k(t.dom.shadowRoot)&&e.composed&&e.composedPath){t=e.composedPath();if(t)return C(t)}}return Y.from(e.target)}(e).each(function(e){e.ownerDocument===document&&(e===document.body||Mf(t,e)||n.focusedEditor!==t||(t.fire("blur",{focusedEditor:null}),n.focusedEditor=null))})},pd.bind(document,"focusin",id))}function Ff(e,t){e.focusedEditor===t.editor&&(e.focusedEditor=null),e.activeEditor||(pd.unbind(document,"focusin",id),id=null)}function Pf(t,e){var n;n=Jt.fromDom(t.getBody()),((e=e).collapsed?Y.from(va(e.startContainer,e.startOffset)).map(Jt.fromDom):Y.none()).bind(function(e){return Xo(e)?Y.some(e):!1===Le(n,e)?Y.some(n):Y.none()}).bind(function(e){return Ml(e.dom)}).fold(function(){t.selection.normalize()},function(e){return t.selection.setRng(e.toRange())})}function Lf(t){if(t.setActive)try{t.setActive()}catch(e){t.focus()}else t.focus()}function Vf(e){return e.inline?(n=e.getBody())&&(n=Jt.fromDom(n),Cf(n)||Sf(sn(t=n)).filter(function(e){return t.dom.contains(e.dom)}).isSome()):e.iframeElement&&Cf(Jt.fromDom(e.iframeElement));var t,n}function Hf(e,t,n,o,r){var i=n?t.startContainer:t.endContainer,u=n?t.startOffset:t.endOffset;return Y.from(i).map(Jt.fromDom).map(function(e){return o&&t.collapsed?e:Ge(e,r(e,u)).getOr(e)}).bind(function(e){return Zt(e)?Y.some(e):Ue(e).filter(Zt)}).map(function(e){return e.dom}).getOr(e)}function zf(e,t,n){return Hf(e,t,!0,n,function(e,t){return Math.min(e.dom.childNodes.length,t)})}function jf(e,t,n){return Hf(e,t,!1,n,function(e,t){return 0<t?t-1:t})}function Uf(e,t){for(var n=e;e&&wn(e)&&0===e.length;)e=t?e.nextSibling:e.previousSibling;return e||n}function Wf(n,e){return E(e,function(e){var t=n.fire("GetSelectionRange",{range:e});return t.range!==e?t.range:e})}function qf(e){return ae(e)?e:W}function Gf(i,e,t){var n=e(i),u=qf(t);return n.orThunk(function(){return u(i)?Y.none():function(e){for(var t=i.dom,n=qf(u);t.parentNode;){var t=t.parentNode,o=Jt.fromDom(t),r=e(o);if(r.isSome())return r;if(n(o))break}return Y.none()}(e)})}function $f(e,t,n){var o=e.formatter.get(n);if(o)for(var r=0;r<o.length;r++)if(!1===o[r].inherit&&e.dom.is(t,o[r].selector))return 1}function Xf(t,e,n,o){var r=t.dom.getRoot();return e!==r&&(e=t.dom.getParent(e,function(e){return!!$f(t,e,n)||e.parentNode===r||!!bd(t,e,n,o,!0)}),bd(t,e,n,o))}function Yf(e,t,n){return!!vd(t,n.inline)||!!vd(t,n.block)||(n.selector?1===t.nodeType&&e.is(t,n.selector):void 0)}function Kf(e,t,n,o,r,i){var u,a,c,s=n[o];if(n.onmatch)return n.onmatch(t,n,o);if(s)if(void 0===s.length){for(u in s)if(s.hasOwnProperty(u)){if(a="attributes"===o?e.getAttrib(t,u):qs(e,t,u),r&&!a&&!n.exact)return;if((!r||n.exact)&&!vd(a,Ws(e,js(s[u],i),u)))return}}else for(c=0;c<s.length;c++)if("attributes"===o?e.getAttrib(t,s[c]):qs(e,t,s[c]))return n;return n}function Jf(e,t,n,o){if(o)return Xf(e,o,t,n);if(o=e.selection.getNode(),Xf(e,o,t,n))return!0;var r=e.selection.getStart();return!(r===o||!Xf(e,r,t,n))}function Qf(i,t){function n(e){return Pe(e,Jt.fromDom(i.getBody()))}return Y.from(i.selection.getStart(!0)).bind(function(e){return Gf(Jt.fromDom(e),function(r){return function(e){for(var t,n=0;n<e.length;n++){var o=(t=e[n],o=void 0,bd(i,r.dom,o=t)?Y.some(o):Y.none());if(o.isSome())return o}return Y.none()}(t)},n)}).getOrNull()}function Zf(o,r,e){return T(e,function(e,t){var n=y(o.formatter.get(t),function(t){function o(e){return 1<e.length&&"%"===e.charAt(0)}return y(["styles","attributes"],function(e){return te(t,e).exists(function(e){var n,e=ne(e)?e:(n=[],ve(e,function(e,t){n.push(e)}),n);return y(e,o)})})});return o.formatter.matchNode(r,t,{},n)?e.concat([t]):e},[])}function ed(e,t,n){var o=n?"lastChild":"firstChild",r=n?"prev":"next";if(e[o])return e[o];if(e!==t){var i=e[r];if(i)return i;for(var u=e.parent;u&&u!==t;u=u.parent)if(i=u[r])return i}}function td(e){var t="a"===e.name&&!e.attr("href")&&e.attr("id");return e.attr("name")||e.attr("id")&&!e.firstChild||e.attr("data-mce-bookmark")||t}var nd,od,rd,id,G=ff,ud=(nd="height",od=function(e){var t=e.dom;return pn(e)?t.getBoundingClientRect().height:t.offsetHeight},{set:function(e,t){if(!ce(t)&&!t.match(/^[0-9]+$/))throw new Error(nd+".set accepts only positive integer values. Value was "+t);e=e.dom;lt(e)&&(e.style[nd]=t+"px")},get:K=function(e){var t=od(e);if(t<=0||null===t){e=bt(e,nd);return parseFloat(e)||0}return t},getOuter:K,aggregate:rd=function(n,e){return T(e,function(e,t){t=bt(n,t),t=void 0===t?0:parseInt(t,10);return isNaN(t)?e:e+t},0)},max:function(e,t,n){n=rd(e,n);return n<t?t-n:0}}),ad=function(n,e){return n.view(e).fold(_([]),function(e){var t=n.owner(e),t=ad(n,t);return[e].concat(t)})},cd=Object.freeze({__proto__:null,view:function(e){return(e.dom===document?Y.none():Y.from(null===(e=e.dom.defaultView)||void 0===e?void 0:e.frameElement)).map(Jt.fromDom)},owner:ze}),sd=function(e,t,n,o){var r=Jt.fromDom(e.getBody()),i=Jt.fromDom(e.getDoc());r.dom.offsetWidth;var u,n=(r=Jt.fromDom(n.startContainer),n=n.startOffset,n=function(e,t){var n=qe(e);if(0===n.length||df(e))return{element:e,offset:t};if(t<n.length&&!df(n[t]))return{element:n[t],offset:0};n=n[n.length-1];return df(n)?{element:e,offset:t}:"img"===Qt(n)?{element:n,offset:1}:en(n)?{element:n,offset:bl(n).length}:{element:n,offset:qe(n).length}}(r,n),u=Jt.fromHtml('<span data-mce-bogus="all">\ufeff</span>'),ln(n.element,u),mf(u,function(){return gn(u)}));pf(e,i,t,n,o),n.cleanup()},ld=function(e,t,n){var o=n.startContainer,r=n.startOffset,i=n.endContainer,u=n.endOffset;t(Jt.fromDom(o),Jt.fromDom(i));t=e.dom.createRng();t.setStart(o,r),t.setEnd(i,u),e.selection.setRng(n)},Rt=e([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),fd=(Rt.before,Rt.on,Rt.after,e([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}])),dd=(fd.domRange,fd.relative,fd.exact,function(e,t,n,o){return{start:e,soffset:t,finish:n,foffset:o}}),md=Gt().browser,gd={isEditorUIElement:function(e){e=e.className.toString();return-1!==e.indexOf("tox-")||-1!==e.indexOf("mce-")}},pd=Iu.DOM,hd=function(e){return e.editorManager.setActive(e)},vd=Us,bd=function(e,t,n,o,r){var i,u,a,c,s=e.formatter.get(n),l=e.dom;if(s&&t)for(u=0;u<s.length;u++)if(i=s[u],Yf(e.dom,t,i)&&Kf(l,t,i,"attributes",r,o)&&Kf(l,t,i,"styles",r,o)){if(c=i.classes)for(a=0;a<c.length;a++)if(!e.dom.hasClass(t,c[a]))return;return i}},yd={"#text":3,"#comment":8,"#cdata":4,"#pi":7,"#doctype":10,"#document-fragment":11},xd=(wd.create=function(e,t){var n=new wd(e,yd[e]||1);return t&&ve(t,function(e,t){n.attr(t,e)}),n},wd.prototype.replace=function(e){return e.parent&&e.remove(),this.insert(e,this),this.remove(),this},wd.prototype.attr=function(e,t){var n,o=this;if("string"!=typeof e)return null!=e&&ve(e,function(e,t){o.attr(t,e)}),o;if(n=o.attributes){if(void 0===t)return n.map[e];if(null===t){if(e in n.map){delete n.map[e];for(var r=n.length;r--;)if(n[r].name===e)return n.splice(r,1),o}return o}if(e in n.map){for(r=n.length;r--;)if(n[r].name===e){n[r].value=t;break}}else n.push({name:e,value:t});return n.map[e]=t,o}},wd.prototype.clone=function(){var e,t=new wd(this.name,this.type);if(e=this.attributes){var n=[];n.map={};for(var o=0,r=e.length;o<r;o++){var i=e[o];"id"!==i.name&&(n[n.length]={name:i.name,value:i.value},n.map[i.name]=i.value)}t.attributes=n}return t.value=this.value,t.shortEnded=this.shortEnded,t},wd.prototype.wrap=function(e){return this.parent.insert(e,this),e.append(this),this},wd.prototype.unwrap=function(){for(var e=this.firstChild;e;){var t=e.next;this.insert(e,this,!0),e=t}this.remove()},wd.prototype.remove=function(){var e=this.parent,t=this.next,n=this.prev;return e&&(e.firstChild===this?(e.firstChild=t)&&(t.prev=null):n.next=t,e.lastChild===this?(e.lastChild=n)&&(n.next=null):t.prev=n,this.parent=this.next=this.prev=null),this},wd.prototype.append=function(e){e.parent&&e.remove();var t=this.lastChild;return t?((t.next=e).prev=t,this.lastChild=e):this.lastChild=this.firstChild=e,e.parent=this,e},wd.prototype.insert=function(e,t,n){e.parent&&e.remove();var o=t.parent||this;return n?(t===o.firstChild?o.firstChild=e:t.prev.next=e,e.prev=t.prev,(e.next=t).prev=e):(t===o.lastChild?o.lastChild=e:t.next.prev=e,e.next=t.next,(e.prev=t).next=e),e.parent=o,e},wd.prototype.getAll=function(e){for(var t=[],n=this.firstChild;n;n=ed(n,this))n.name===e&&t.push(n);return t},wd.prototype.empty=function(){if(this.firstChild){for(var e=[],t=this.firstChild;t;t=ed(t,this))e.push(t);for(var n=e.length;n--;)(t=e[n]).parent=t.firstChild=t.lastChild=t.next=t.prev=null}return this.firstChild=this.lastChild=null,this},wd.prototype.isEmpty=function(e,t,n){void 0===t&&(t={});var o=this.firstChild;if(td(this))return!1;if(o)do{if(1===o.type){if(o.attr("data-mce-bogus"))continue;if(e[o.name])return!1;if(td(o))return!1}if(8===o.type)return!1;if(3===o.type&&!function(e){if(dr(e.value)){var t=e.parent;return!t||"span"===t.name&&!t.attr("style")||!/^[ ]+$/.test(e.value)}}(o))return!1;if(3===o.type&&o.parent&&t[o.parent.name]&&dr(o.value))return!1;if(n&&n(o))return!1}while(o=ed(o,this));return!0},wd.prototype.walk=function(e){return ed(this,null,e)},wd);function wd(e,t){this.name=e,1===(this.type=t)&&(this.attributes=[],this.attributes.map={})}function Cd(e){var a=[],c=(e=e||{}).indent,s=_d(e.indent_before||""),l=_d(e.indent_after||""),f=Or.getEncodeFunc(e.entity_encoding||"raw",e.entities),d="html"===e.element_format;return{start:function(e,t,n){var o,r,i,u;if(c&&s[e]&&0<a.length&&0<(u=a[a.length-1]).length&&"\n"!==u&&a.push("\n"),a.push("<",e),t)for(o=0,r=t.length;o<r;o++)i=t[o],a.push(" ",i.name,'="',f(i.value,!0),'"');a[a.length]=!n||d?">":" />",n&&c&&l[e]&&0<a.length&&0<(u=a[a.length-1]).length&&"\n"!==u&&a.push("\n")},end:function(e){var t;a.push("</",e,">"),c&&l[e]&&0<a.length&&0<(t=a[a.length-1]).length&&"\n"!==t&&a.push("\n")},text:function(e,t){0<e.length&&(a[a.length]=t?e:f(e))},cdata:function(e){a.push("<![CDATA[",e,"]]>")},comment:function(e){a.push("\x3c!--",e,"--\x3e")},pi:function(e,t){t?a.push("<?",e," ",f(t),"?>"):a.push("<?",e,"?>"),c&&a.push("\n")},doctype:function(e){a.push("<!DOCTYPE",e,">",c?"\n":"")},reset:function(){a.length=0},getContent:function(){return a.join("").replace(/\n$/,"")}}}function Sd(t,m){void 0===m&&(m=Fr());var g=Cd(t);return(t=t||{}).validate=!("validate"in t)||t.validate,{serialize:function(e){var l=t.validate,f={3:function(e){g.text(e.value,e.raw)},8:function(e){g.comment(e.value)},7:function(e){g.pi(e.name,e.value)},10:function(e){g.doctype(e.value)},4:function(e){g.cdata(e.value)},11:function(e){if(e=e.firstChild)for(;d(e),e=e.next;);}};g.reset();var d=function(e){var t,n,o,r,i,u,a,c,s=f[e.type];if(s)s(e);else{if(t=e.name,s=e.shortEnded,n=e.attributes,l&&n&&1<n.length&&((i=[]).map={},c=m.getElementRule(e.name))){for(u=0,a=c.attributesOrder.length;u<a;u++)(o=c.attributesOrder[u])in n.map&&(r=n.map[o],i.map[o]=r,i.push({name:o,value:r}));for(u=0,a=n.length;u<a;u++)(o=n[u].name)in i.map||(r=n.map[o],i.map[o]=r,i.push({name:o,value:r}));n=i}if(g.start(e.name,n,s),!s){if(e=e.firstChild)for(;d(e),e=e.next;);g.end(t)}}};return 1!==e.type||t.inner?f[11](e):d(e),g.getContent()}}}function kd(e,t){return e.replace(new RegExp(t.prefix+"_[0-9]+","g"),function(e){return te(t.uris,e).getOr(e)})}function Od(e,t,n){var o,r,i=1,u=e.getShortEndedElements(),a=/<([!?\/])?([A-Za-z0-9\-_\:\.]+)((?:\s+[^"\'>]+(?:(?:"[^"]*")|(?:\'[^\']*\')|[^>]*))*|\/|\s+)>/g;for(a.lastIndex=o=n;r=a.exec(t);){if(o=a.lastIndex,"/"===r[1])i--;else if(!r[1]){if(r[2]in u)continue;i++}if(0===i)break}return o}var _d=Kt.makeMap,Ed=["img","video"];function Td(q,G){void 0===G&&(G=Fr());function e(){}!1!==(q=q||{}).fix_self_closing&&(q.fix_self_closing=!0);function n(c,e){void 0===e&&(e="html");for(var t,i,s,n,o,r,l,u,a,f,d,m,g,p,h,v,b,y,x=c.html,w=0,C=[],S=0,k=Or.decode,O=Kt.makeMap("src,href,data,background,formaction,poster,xlink:href"),_=/((java|vb)script|mhtml):/i,E="html"===e?0:1,T=function(e){for(var t,n=C.length;n--&&C[n].name!==e;);if(0<=n){for(t=C.length-1;n<=t;t--)(e=C[t]).valid&&J(e.name);C.length=n}},D=function(e,t){return Y(kd(e,c),t)},A=function(e){""!==e&&(">"===e.charAt(0)&&(e=" "+e),q.allow_conditional_comments||"[if"!==e.substr(0,3).toLowerCase()||(e=" "+e),$(kd(e,c)))},B=function(e,t){var n=e||"",o=!_e(n,"--"),r=function(e,t,n){void 0===n&&(n=0);var o=e.toLowerCase();if(-1!==o.indexOf("[if ",n)&&(i=n,/^\s*\[if [\w\W]+\]>.*<!\[endif\](--!?)?>/.test(o.substr(i)))){i=o.indexOf("[endif]",n);return o.indexOf(">",i)}if(t){var r=o.indexOf(">",n);return-1!==r?r:o.length}r=/--!?>/;r.lastIndex=n;var i,e=r.exec(e);return e?e.index+e[0].length:o.length}(x,o,t);return e=x.substr(t,r-t),A(o?n+e:e),r+1},N=function(e,t,n,o,r){var i,u,a,r=(t=t.toLowerCase())in P?t:k(n||o||r||"");if(n=te(c.uris,r).getOr(r),L&&!l&&0==(0===(a=t).indexOf("data-")||0===a.indexOf("aria-"))){if(!(i=g[t])&&p){for(u=p.length;u--&&!(i=p[u]).pattern.test(t););-1===u&&(i=null)}if(!i)return;if(i.validValues&&!(n in i.validValues))return}if(O[t]&&!q.allow_script_urls){var r=n.replace(/[\s\u0000-\u001F]+/g,"");try{r=decodeURIComponent(r)}catch(e){r=unescape(r)}if(_.test(r))return;if(a=r,r=e,!(e=q).allow_html_data_urls&&(/^data:image\//i.test(a)?(e=e.allow_svg_data_urls,r=r,!(ue(e)?ee(Ed,r):e)&&/^data:image\/svg\+xml/i.test(a)):/^data:/i.test(a)))return}l&&(t in O||0===t.indexOf("on"))||(s.map[t]=n,s.push({name:t,value:n}))},R=new RegExp("<(?:(?:!--([\\w\\W]*?)--!?>)|(?:!\\[CDATA\\[([\\w\\W]*?)\\]\\]>)|(?:![Dd][Oo][Cc][Tt][Yy][Pp][Ee]([\\w\\W]*?)>)|(?:!(--)?)|(?:\\?([^\\s\\/<>]+) ?([\\w\\W]*?)[?/]>)|(?:\\/([A-Za-z][A-Za-z0-9\\-_\\:\\.]*)>)|(?:([A-Za-z][A-Za-z0-9\\-_\\:\\.]*)((?:\\s+[^\"'>]+(?:(?:\"[^\"]*\")|(?:'[^']*')|[^>]*))*|\\/|\\s+)>))","g"),M=/([\w:\-]+)(?:\s*=\s*(?:(?:\"((?:[^\"])*)\")|(?:\'((?:[^\'])*)\')|([^>\s]+)))?/g,I=G.getShortEndedElements(),F=q.self_closing_elements||G.getSelfClosingElements(),P=G.getBoolAttrs(),L=q.validate,V=q.remove_internals,H=q.fix_self_closing,z=G.getSpecialElements(),j=x+">";t=R.exec(j);){var U=t[0];if(w<t.index&&D(k(x.substr(w,t.index-w))),i=t[7])T(i=":"===(i=i.toLowerCase()).charAt(0)?i.substr(1):i);else if(i=t[8]){if(t.index+U.length>x.length){D(k(x.substr(t.index))),w=t.index+U.length;continue}u=(i=":"===(i=i.toLowerCase()).charAt(0)?i.substr(1):i)in I,H&&F[i]&&0<C.length&&C[C.length-1].name===i&&T(i);var W=function(e,t){e=e.exec(t);if(e){t=e[1],e=e[2];return"string"==typeof t&&"data-mce-bogus"===t.toLowerCase()?e:null}return null}(M,t[9]);if(null!==W){if("all"===W){w=Od(G,x,R.lastIndex),R.lastIndex=w;continue}f=!1}if(!L||(a=G.getElementRule(i))){if(f=!0,L&&(g=a.attributes,p=a.attributePatterns),(m=t[9])?((l=-1!==m.indexOf("data-mce-type"))&&V&&(f=!1),(s=[]).map={},m.replace(M,function(e,t,n,o,r){return N(i,t,n,o,r),""})):(s=[]).map={},L&&!l){if(h=a.attributesRequired,v=a.attributesDefault,b=a.attributesForced,a.removeEmptyAttrs&&!s.length&&(f=!1),b)for(n=b.length;n--;)r=(d=b[n]).name,"{$uid}"===(y=d.value)&&(y="mce_"+S++),s.map[r]=y,s.push({name:r,value:y});if(v)for(n=v.length;n--;)(r=(d=v[n]).name)in s.map||("{$uid}"===(y=d.value)&&(y="mce_"+S++),s.map[r]=y,s.push({name:r,value:y}));if(h){for(n=h.length;n--&&!(h[n]in s.map););-1===n&&(f=!1)}if(d=s.map["data-mce-bogus"]){if("all"===d){w=Od(G,x,R.lastIndex),R.lastIndex=w;continue}f=!1}}f&&K(i,s,u)}else f=!1;if(W=z[i]){W.lastIndex=w=t.index+U.length,w=(t=W.exec(x))?(f&&(o=x.substr(w,t.index-w)),t.index+t[0].length):(o=x.substr(w),x.length),f&&(0<o.length&&D(o,!0),J(i)),R.lastIndex=w;continue}u||(m&&m.indexOf("/")===m.length-1?f&&J(i):C.push({name:i,valid:f}))}else if(i=t[1])A(i);else if(i=t[2]){if(!(1==E||q.preserve_cdata||0<C.length&&G.isValidChild(C[C.length-1].name,"#cdata"))){w=B("",t.index+2),R.lastIndex=w;continue}X(i)}else if(i=t[3])Z(i);else{if((i=t[4])||"<!"===U){w=B(i,t.index+U.length),R.lastIndex=w;continue}if(i=t[5]){if(1!=E){w=B("?",t.index+2),R.lastIndex=w;continue}Q(i,t[6])}}w=t.index+U.length}for(w<x.length&&D(k(x.substr(w))),n=C.length-1;0<=n;n--)(i=C[n]).valid&&J(i.name)}var $=q.comment||e,X=q.cdata||e,Y=q.text||e,K=q.start||e,J=q.end||e,Q=q.pi||e,Z=q.doctype||e;return{parse:function(e,t){void 0===t&&(t="html"),n(function(e){for(var t,n=/data:[^;]+;base64,([a-z0-9\+\/=]+)/gi,o=[],r={},i=na("img"),u=0,a=0;t=n.exec(e);){var c=t[0],s=i+"_"+a++;r[s]=c,u<t.index&&o.push(e.substr(u,t.index-u)),o.push(s),u=t.index+c.length}return 0===u?{prefix:i,uris:r,html:e}:(u<e.length&&o.push(e.substr(u)),{prefix:i,uris:r,html:o.join("")})}(e),t)}}}(Td=Td||{}).findEndTag=Od;function Dd(e,t){for(var n,o,r,i=t,u=/<(\w+) [^>]*data-mce-bogus="all"[^>]*>/g,a=e.schema,t=e.getTempAttrs(),e=i,t=new RegExp(["\\s?("+t.join("|")+')="[^"]+"'].join("|"),"gi"),i=e.replace(t,""),c=a.getShortEndedElements();r=u.exec(i);)n=u.lastIndex,o=r[0].length,r=c[r[1]]?n:$m.findEndTag(a,i,n),i=i.substring(0,n-o)+i.substring(r),u.lastIndex=n-o;return Co(i)}function Ad(r){this.compare=function(e,t){if(e.nodeName!==t.nodeName)return!1;function n(t){var n={};return Ym(r.getAttribs(t),function(e){e=e.nodeName.toLowerCase();0!==e.indexOf("_")&&"style"!==e&&0!==e.indexOf("data-")&&(n[e]=r.getAttrib(t,e))}),n}function o(e,t){var n,o;for(o in e)if(e.hasOwnProperty(o)){if(void 0===(n=t[o]))return;if(e[o]!==n)return;delete t[o]}for(o in t)if(t.hasOwnProperty(o))return;return 1}return!(!o(n(e),n(t))||!o(r.parseStyle(r.getAttrib(e,"style")),r.parseStyle(r.getAttrib(t,"style")))||Rs(e)||Rs(t))}}function Bd(e){return e=e.container(),wn(e)&&(0===e.data.length||wo(e.data)&&cf.isBookmarkNode(e.parentNode))}function Nd(e){Qe(e),mn(e,Jt.fromHtml('<br data-mce-bogus="1">'))}function Rd(n){an(n).each(function(t){on(t).each(function(e){Wo(n)&&xo(t)&&Wo(e)&&gn(t)})})}function Md(e,t){return o=W,Le(n=t,e=e)?function(e,t){for(var n=ae(t)?t:W,o=e.dom,r=[];null!==o.parentNode&&void 0!==o.parentNode;){var i=o.parentNode,u=Jt.fromDom(i);if(r.push(u),!0===n(u))break;o=i}return r}(e,function(e){return o(e)||Pe(e,n)}).slice(0,-1):[];var n,o}function Id(e,t){return[e].concat(Md(e,t))}function Fd(e,t,n){return Bl(e,t,n,Bd)}function Pd(e,t){return D(Id(Jt.fromDom(t.container()),e),Wo)}function Ld(e){return Pc(e).exists(xo)}function Vd(e,t,n){var o=me(Id(Jt.fromDom(n.container()),t),Wo),t=C(o).getOr(t);return ws(e,t.dom,n).filter(Ld)}function Hd(e,t){return Pc(t).exists(xo)||Vd(!0,e,t).isSome()}function zd(e,t){return Y.from(t.getNode(!0)).map(Jt.fromDom).exists(xo)||Vd(!1,e,t).isSome()}function jd(e){return qa.isTextPosition(e)&&!e.isAtStart()&&!e.isAtEnd()}function Ud(e,t){return t=me(Id(Jt.fromDom(t.container()),e),Wo),C(t).getOr(e)}function Wd(e,t){return jd(t)?Jm(t):Jm(t)||Rl(Ud(e,t).dom,t).exists(Jm)}function qd(e,t){return jd(t)?Km(t):Km(t)||Nl(Ud(e,t).dom,t).exists(Km)}function Gd(e){return Pc(e).bind(function(e){return Xn(e,Zt)}).exists(function(e){return e=bt(e,"white-space"),ee(["pre","pre-wrap"],e)})}function $d(e,t){return!Gd(t)&&(ug(e,t)||cg(e,t)||zd(e,t)||Wd(e,t))}function Xd(e,t){return!Gd(t)&&(ag(e,t)||sg(e,t)||Hd(e,t)||qd(e,t))}function Yd(e,t){return $d(e,t)||Xd(e,(e=(n=t).container(),t=n.offset(),wn(e)&&t<e.data.length?qa(e,t+1):n));var n}function Kd(e,t){return Ms(e.charAt(t))}function Jd(e){return e=e.container(),wn(e)&&Oe(e.data,Qo)}function Qd(l,e){return Y.some(e).filter(Jd).bind(function(e){var t,n,o,r,i,u=e.container(),a=l,c=(t=u).data,s=qa(t,0);return(Kd(c,0)&&!Yd(a,s)?(t.data=" "+c.slice(1),1):(r=(n=u).data,o=r.split(""),(i=E(o,function(e,t){return Ms(e)&&0<t&&t<o.length-1&&Fs(o[t-1])&&Fs(o[t+1])?" ":e}).join(""))!==r&&(n.data=i,!0)))||(r=l,i=(n=u).data,u=qa(n,i.length-1),Kd(i,i.length-1)&&!Yd(r,u)&&(n.data=i.slice(0,-1)+" ",1))?Y.some(e):Y.none()})}function Zd(t){var e=Jt.fromDom(t.getBody());t.selection.isCollapsed()&&Qd(e,qa.fromRangeStart(t.selection.getRng())).each(function(e){t.selection.setRng(e.toRange())})}function em(e,t,n){var o,r,i,u,a,c;0!==n&&(r=Jt.fromDom(e),i=$n(r,Wo).getOr(r),o=e.data.slice(t,t+n),r=t+n>=e.data.length&&Xd(i,zc(e,e.data.length)),i=0===t&&$d(i,zc(e,0)),e.replaceData(t,n,(a=i,c=r,T(u=o,function(e,t){return Is(t)||Ms(t)?e.previousCharIsSpace||""===e.str&&a||e.str.length===u.length-1&&c?{previousCharIsSpace:!1,str:e.str+Qo}:{previousCharIsSpace:!0,str:e.str+" "}:{previousCharIsSpace:!1,str:e.str+t}},{previousCharIsSpace:!1,str:""}).str)))}function tm(e,t,n,o){void 0===o&&(o=!0);var r=Nt(e.data).length,i=o?e:t,e=o?t:e;return o?i.appendData(e.data):i.insertData(0,e.data),gn(Jt.fromDom(e)),n&&dg(i,r),i}function nm(e,t){return o=e,r=(n=t).container(),e=n.offset(),!1===zc.isTextPosition(n)&&r===o.parentNode&&e>zc.before(o).offset()?zc(t.container(),t.offset()-1):t;var n,o,r}function om(e){return No(e.previousSibling)?Y.some((t=e.previousSibling,wn(t)?zc(t,t.data.length):zc.after(t))):e.previousSibling?Il(e.previousSibling):Y.none();var t}function rm(e){return No(e.nextSibling)?Y.some((t=e.nextSibling,wn(t)?zc(t,0):zc.before(t))):e.nextSibling?Ml(e.nextSibling):Y.none();var t}function im(e,t,n){return(e?function(n,o){return rm(o).orThunk(function(){return om(o)}).orThunk(function(){return Nl(e=n,zc.after(t=o)).fold(function(){return Rl(e,zc.before(t))},Y.some);var e,t})}:function(o,r){return om(r).orThunk(function(){return rm(r)}).orThunk(function(){return e=o,n=zc.before((t=r).previousSibling||t.parentNode),Rl(e,n).fold(function(){return Nl(e,zc.after(t))},Y.some);var e,t,n})})(t,n).map(w(nm,n))}function um(t,n,e){e.fold(function(){t.focus()},function(e){t.selection.setRng(e.toRange(),n)})}function am(e,t){return t&&ye(e.schema.getBlockElements(),Qt(t))}function cm(e){if(Fo(e)){var t=Jt.fromHtml('<br data-mce-bogus="1">');return Qe(e),mn(e,t),Y.some(zc.before(t.dom))}return Y.none()}function sm(t,n,e,o){void 0===o&&(o=!0);var r,i,u,a,c,s,l,f=im(n,t.getBody(),e.dom),d=$n(e,w(am,t),(r=t.getBody(),function(e){return e.dom===r})),m=(u=f,c=i=e,a=ye(t.schema.getTextInlineElements(),Qt(c)),s=on(i).filter(en),l=We(i).filter(en),gn(i),f=l,e=u,c=function(e,t,n){var o=e.dom,e=t.dom,t=o.data.length;return tm(o,e,a),n.container()===e?zc(o,t):n},((i=s).isSome()&&f.isSome()&&e.isSome()?Y.some(c(i.getOrDie(),f.getOrDie(),e.getOrDie())):Y.none()).orThunk(function(){return a&&(s.each(function(e){return mg(e.dom,e.dom.length)}),l.each(function(e){return dg(e.dom,0)})),u}));t.dom.isEmpty(t.getBody())?(t.setContent(""),t.selection.setCursorLocation()):d.bind(cm).fold(function(){o&&um(t,n,m)},function(e){o&&um(t,n,Y.some(e))})}function lm(e,t){return{start:e,end:t}}function fm(e,t){return Jn(Jt.fromDom(e),"td,th",t)}function dm(e,t){return Yn(e,"table",t)}function mm(e){return!Pe(e.start,e.end)}function gm(e,n){return dm(e.start,n).bind(function(t){return dm(e.end,n).bind(function(e){return Pe(t,e)?Y.some(t):Y.none()})})}function pm(e){return Zu(e,"td,th")}function hm(e,r,i){return e.filter(function(e){return mm(e)&&pg(i,e)}).orThunk(function(){return n=i,t=fm((e=r).startContainer,n),o=fm(e.endContainer,n),e.collapsed?Y.none():sa(t,o,lm).fold(function(){return t.fold(function(){return o.bind(function(t){return dm(t,n).bind(function(e){return C(pm(e)).map(function(e){return lm(e,t)})})})},function(t){return dm(t,n).bind(function(e){return N(pm(e)).map(function(e){return lm(t,e)})})})},function(e){return pg(n,e)?Y.none():dm((t=e).start,n).bind(function(e){return N(pm(e)).map(function(e){return lm(t.start,e)})});var t});var n,e,t,o}).bind(function(e){return gm(t=e,i).map(function(e){return{rng:t,table:e,cells:pm(e)}});var t})}function vm(e,t){return h(e,function(e){return Pe(e,t)})}function bm(n){return sa(vm((o=n).cells,o.rng.start),vm(o.cells,o.rng.end),function(e,t){return o.cells.slice(e,t+1)}).map(function(e){var t=n.cells;return e.length===t.length?gg.removeTable(n.table):gg.emptyCells(e)});var o}function ym(e,t){var n,o,r,i,u,a=(n=e,function(e){return Pe(n,e)}),c=(e=fm((o=t).startContainer,r=a),r=fm(o.endContainer,r),sa(e,r,lm));return i=t,u=a,c.filter(function(e){return!mm(t=e)&&gm(t,u).exists(function(e){e=e.dom.rows;return 1===e.length&&1===e[0].cells.length})&&ml(e.start,i);var t}).map(function(e){return e.start}).map(function(e){return gg.deleteCellSelection(t,e)}).orThunk(function(){return hm(c,t,a).bind(bm)})}function xm(e,t){return de(t,Nd),e.selection.setCursorLocation(t[0].dom,0),!0}function wm(e,t,n){t.deleteContents();var o,t=hg(n).getOr(n),r=Jt.fromDom(e.dom.getParent(t.dom,e.dom.isBlock));return Fo(r)&&(Nd(r),e.selection.setCursorLocation(r.dom,0)),Pe(n,r)||(e=Ue(r).is(n)?[]:Ue(o=r).map(qe).map(function(e){return me(e,function(e){return!Pe(o,e)})}).getOr([]),de(e.concat(qe(n)),function(e){Pe(e,r)||Le(e,r)||gn(e)})),!0}function Cm(e,t){return sm(e,!1,t),!0}function Sm(e,t){return D(Id(t,e),Yo)}function km(e,t){return(e?ng:og)(t)}function Om(f,d,a){var m=Jt.fromDom(f.getBody());return vg(m,a).fold(function(){return o=f,r=d,i=m,n=a,u=zc.fromRangeStart(o.selection.getRng()),Sm(i,n).bind(function(e){return Fo(e)?bg(o,e):(t=i,n=e,e=u,Cs(r,o.getBody(),e).bind(function(e){return Sm(t,Jt.fromDom(e.getNode())).map(function(e){return!1===Pe(e,n)})}));var t,n}).getOr(!1)||(t=d,n=zc.fromRangeStart((e=f).selection.getRng()),km(t,n)||ws(t,e.getBody(),n).exists(function(e){return km(t,e)}));var o,r,i,u,e,t,n},function(e){return n=d,o=m,r=e,e=zc.fromRangeStart((t=f).selection.getRng()),(Fo(r)?bg(t,r):(a=o,s=r,l=e,Cs(c=n,(u=t).getBody(),l).bind(function(e){return o=c,r=l,i=e,Ml((n=s).dom).bind(function(t){return Il(n.dom).map(function(e){return o?r.isEqual(t)&&i.isEqual(e):r.isEqual(e)&&i.isEqual(t)})}).getOr(!0)?bg(u,s):(t=s,vg(a,Jt.fromDom(e.getNode())).map(function(e){return!1===Pe(e,t)}));var t,n,o,r,i}).or(Y.some(!0)))).getOr(!1);var u,a,c,s,l,t,n,o,r})}function _m(e,t){var n,o,r,i,u=Jt.fromDom(e.selection.getStart(!0)),a=dl(e);return e.selection.isCollapsed()&&0===a.length?Om(e,t,u):(n=u,t=Jt.fromDom((a=e).getBody()),u=a.selection.getRng(),0!==(e=dl(a)).length?xm(a,e):(o=a,i=u,vg(r=t,n).fold(function(){return t=o,ym(r,i).map(function(e){return e.fold(w(Cm,t),w(xm,t),w(wm,t))});var t},function(e){return bg(o,e)}).getOr(!1)))}function Em(e){return e.collapsed?e:(i=e,u=zc.fromRangeStart(i),a=zc.fromRangeEnd(i),c=i.commonAncestorContainer,ws(!1,c,a).map(function(e){return!Bc(u,a,c)&&Bc(u,e,c)?(t=u.container(),n=u.offset(),o=e.container(),r=e.offset(),(e=document.createRange()).setStart(t,n),e.setEnd(o,r),e):i;var t,n,o,r}).getOr(i));var i,u,a,c}function Tm(e,t){var n,o=t.firstChild,r=t.lastChild;return o&&"meta"===o.name&&(o=o.next),n=r=r&&"mce_marker"===r.attr("id")?r.prev:r,e=(t=e).getNonEmptyElements(),n&&(n.isEmpty(e)||(n=n,t.getBlockElements()[n.name]&&n.firstChild&&n.firstChild===n.lastChild&&("br"===(n=n.firstChild).name||n.value===Qo)))&&(r=r.prev),!(!o||o!==r||"ul"!==o.name&&"ol"!==o.name)}function Dm(e){return 0<e.length&&(!(t=e[e.length-1]).firstChild||(t=t)&&t.firstChild&&t.firstChild===t.lastChild&&((t=t.firstChild).data===Qo||On(t)))?e.slice(0,-1):e;var t}function Am(e,t){return(e=e.getParent(t,e.isBlock))&&"LI"===e.nodeName?e:null}function Bm(e,t){return e=zc.after(e),(e=vs(t).prev(e))?e.toRange():null}function Nm(e,o,r,t){var n,i,u,a,c,s,l,f,d=(d=o,l=e.serialize(t),e=(g=d.createFragment(l)).firstChild,t=g.lastChild,e&&"META"===e.nodeName&&e.parentNode.removeChild(e),t&&"mce_marker"===t.id&&t.parentNode.removeChild(t),g),m=Am(o,r.startContainer),e=Dm((l=d.firstChild,Kt.grep(l.childNodes,function(e){return"LI"===e.nodeName}))),t=o.getRoot(),g=function(e){var t=zc.fromRangeStart(r),n=vs(o.getRoot()),t=1===e?n.prev(t):n.next(t);return!t||Am(o,t.getNode())!==m};return g(1)?(d=e,l=t,f=(s=m).parentNode,Kt.each(d,function(e){f.insertBefore(e,s)}),d=l,l=zc.before(s),(l=vs(d).next(l))?l.toRange():null):g(2)?(i=m,a=t,o.insertAfter((u=e).reverse(),i),Bm(u[0],a)):(i=e,u=t,a=n=m,t=(e=r).cloneRange(),e=e.cloneRange(),t.setStartBefore(a),e.setEndAfter(a),e=[t.cloneContents(),e.cloneContents()],(c=n.parentNode).insertBefore(e[0],n),Kt.each(i,function(e){c.insertBefore(e,n)}),c.insertBefore(e[1],n),c.removeChild(n),Bm(i[i.length-1],u))}function Rm(e,t,n){var o,r,i,u,a,c=e.selection,s=e.dom;/^ | $/.test(t)&&(g=s,p=c.getRng(),h=t,a=Jt.fromDom(g.getRoot()),h=$d(a,zc.fromRangeStart(p))?h.replace(/^ /,"&nbsp;"):h.replace(/^&nbsp;/," "),t=h=Xd(a,zc.fromRangeEnd(p))?h.replace(/(&nbsp;| )(<br( \/)>)?$/,"&nbsp;"):h.replace(/&nbsp;(<br( \/)?>)?$/," "));var l=e.parser,f=n.merge,d=Sd({validate:e.getParam("validate")},e.schema),m='<span id="mce_marker" data-mce-type="bookmark">&#xFEFF;</span>',g={content:t,format:"html",selection:!0,paste:n.paste};if((g=e.fire("BeforeSetContent",g)).isDefaultPrevented())e.fire("SetContent",{content:g.content,format:"html",selection:!0,paste:n.paste});else{-1===(t=g.content).indexOf("{$caret}")&&(t+="{$caret}"),t=t.replace(/\{\$caret\}/,m);var p=(a=c.getRng()).startContainer||(a.parentElement?a.parentElement():null),h=e.getBody();p===h&&c.isCollapsed()&&s.isBlock(h.firstChild)&&((p=h.firstChild)&&!e.schema.getShortEndedElements()[p.nodeName])&&s.isEmpty(h.firstChild)&&((a=s.createRng()).setStart(h.firstChild,0),a.setEnd(h.firstChild,0),c.setRng(a)),c.isCollapsed()||function(e){var t=e.dom,n=Em(e.selection.getRng());e.selection.setRng(n);var o,r=t.getParent(n.startContainer,yg),i=n;null!==(o=r)&&o===t.getParent(i.endContainer,yg)&&ml(Jt.fromDom(o),i)?wm(e,n,Jt.fromDom(r)):e.getDoc().execCommand("Delete",!1,null)}(e);var v,b,y,x,w,h={context:(o=c.getNode()).nodeName.toLowerCase(),data:n.data,insert:!0},C=l.parse(t,h);if(!0===n.paste&&Tm(e.schema,C)&&Am(s,o))return a=Nm(d,s,c.getRng(),C),c.setRng(a),void e.fire("SetContent",g);if(function(){for(var e=C;e=e.walk();)1===e.type&&e.attr("data-mce-fragment","1")}(),"mce_marker"===(u=C.lastChild).attr("id"))for(u=(i=u).prev;u;u=u.walk(!0))if(3===u.type||!s.isBlock(u.name)){e.schema.isValidChild(u.parent.name,"span")&&u.parent.insert(i,u,"br"===u.name);break}if(e._selectionOverrides.showBlockCaretContainer(o),h.invalid){for(e.selection.setContent(m),o=c.getNode(),r=e.getBody(),9===o.nodeType?o=u=r:u=o;u!==r;)u=(o=u).parentNode;t=o===r?r.innerHTML:s.getOuterHTML(o),t=d.serialize(l.parse(t.replace(/<span (id="mce_marker"|id=mce_marker).+?<\/span>/i,function(){return d.serialize(C)}))),o===r?s.setHTML(r,t):s.setOuterHTML(o,t)}else h=e,v=t=d.serialize(C),"all"===(m=o).getAttribute("data-mce-bogus")?m.parentNode.insertBefore(h.dom.createFragment(v),m):(l=m.firstChild,t=m.lastChild,!l||l===t&&"BR"===l.nodeName?h.dom.setHTML(m,v):h.selection.setContent(v));v=f,x=(f=e).schema.getTextInlineElements(),w=f.dom,v&&(b=f.getBody(),y=new Ad(w),Kt.each(w.select("*[data-mce-fragment]"),function(e){for(var t=e.parentNode;t&&t!==b;t=t.parentNode)x[e.nodeName.toLowerCase()]&&y.compare(t,e)&&w.remove(e,!0)})),function(n,e){var t,o=n.dom,r=n.selection;if(e){r.scrollIntoView(e);var i=function(e){for(var t=n.getBody();e&&e!==t;e=e.parentNode)if("false"===o.getContentEditable(e))return e;return null}(e);if(i)return o.remove(e),r.select(i);var u=o.createRng(),i=e.previousSibling;i&&3===i.nodeType?(u.setStart(i,i.nodeValue.length),$t.ie||(a=e.nextSibling)&&3===a.nodeType&&(i.appendData(a.data),a.parentNode.removeChild(a))):(u.setStartBefore(e),u.setEndBefore(e));var a=o.getParent(e,o.isBlock);o.remove(e),a&&o.isEmpty(a)&&(n.$(a).empty(),u.setStart(a,0),u.setEnd(a,0),yg(a)||a.getAttribute("data-mce-fragment")||!(t=function(e){e=zc.fromRangeStart(e);if(e=vs(n.getBody()).next(e))return e.toRange()}(u))?o.add(a,o.create("br",{"data-mce-bogus":"1"})):(u=t,o.remove(a))),r.setRng(u)}}(e,s.get("mce_marker")),f=e.getBody(),Kt.each(f.getElementsByTagName("*"),function(e){e.removeAttribute("data-mce-fragment")}),f=s,c=c.getStart(),Y.from(f.getParent(c,"td,th")).map(Jt.fromDom).each(Rd),e.fire("SetContent",g),e.addVisual()}}function Mm(e,t,a){t=function(e,n){var t,o,r={},i={},u=[];for(t in a.firstChild&&xg(a.firstChild,function(t){de(e,function(e){e.name===t.name&&(r[e.name]?r[e.name].nodes.push(t):r[e.name]={filter:e,nodes:[t]})}),de(n,function(e){"string"==typeof t.attr(e.name)&&(i[e.name]?i[e.name].nodes.push(t):i[e.name]={filter:e,nodes:[t]})})}),r)r.hasOwnProperty(t)&&u.push(r[t]);for(o in i)i.hasOwnProperty(o)&&u.push(i[o]);return u}(e,t),de(t,function(t){de(t.filter.callbacks,function(e){e(t.nodes,t.filter.name,{})})})}function Im(e){return e instanceof xd}function Fm(e,t){var n;e.dom.setHTML(e.getBody(),t),Vf(n=e)&&Ml(n.getBody()).each(function(e){var t=e.getNode(),e=st(t)?Ml(t).getOr(e):e;n.selection.setRng(e.toRange())})}function Pm(e,t){return r=t,((e=(o=e).dom).parentNode?(e=Jt.fromDom(e.parentNode),n=function(e){return!Pe(o,e)&&r(e)},D(e.dom.childNodes,function(e){return n(Jt.fromDom(e))}).map(Jt.fromDom)):Y.none()).isSome();var n,o,r}function Lm(e){return 0<function(e){for(var t=[];e;){if(3===e.nodeType&&e.nodeValue!==wg||1<e.childNodes.length)return[];1===e.nodeType&&t.push(e),e=e.firstChild}return t}(e).length}function Vm(e){if(e){var t=new vo(e,e);for(e=t.current();e;e=t.next())if(wn(e))return e}return null}function Hm(e){var t=Jt.fromTag("span");return mt(t,{id:Cg,"data-mce-bogus":"1","data-mce-type":"format-caret"}),e&&mn(t,Jt.fromText(wg)),t}function zm(e,t,n){void 0===n&&(n=!0);var o,r,i,u,a,c=e.dom,s=e.selection;Lm(t)?sm(e,!1,Jt.fromDom(t),n):(o=s.getRng(),r=c.getParent(t,c.isBlock),i=o.startContainer,u=o.startOffset,a=o.endContainer,e=o.endOffset,(n=Vm(t))&&n.nodeValue.charAt(0)===wg&&n.deleteData(0,1),n=n,c.remove(t,!0),i===n&&0<u&&o.setStart(n,u-1),a===n&&0<e&&o.setEnd(n,e-1),r&&c.isEmpty(r)&&Nd(Jt.fromDom(r)),s.setRng(o))}function jm(e,t,n){void 0===n&&(n=!0);var o=e.dom,r=e.selection;if(t)zm(e,t,n);else if(!(t=Os(e.getBody(),r.getStart())))for(;t=o.get(Cg);)zm(e,t,!1)}function Um(e,t){return e.appendChild(t),t}function Wm(e,t){return t=p(e,function(e,t){return Um(e,t.cloneNode(!1))},t),Um(t,t.ownerDocument.createTextNode(wg))}function qm(e,t,n,o){var r,i,u,a,c,s,l,f=e.dom,d=e.selection,m=[],g=d.getRng(),p=g.startContainer,h=g.startOffset,v=p;for(3===p.nodeType&&(h!==p.nodeValue.length&&(r=!0),v=v.parentNode);v;){if(bd(e,v,t,n,o)){i=v;break}v.nextSibling&&(r=!0),m.push(v),v=v.parentNode}i&&(r?(s=d.getBookmark(),g.collapse(!0),l=al(e,g,e.formatter.get(t),!0),l=af(l),e.formatter.remove(t,n,l,o),d.moveToBookmark(s)):(u=Os(e.getBody(),i),h=a=Hm(!1).dom,(l=(p=e.dom).getParent(g=null!==u?u:i,w(Hs,e)))&&p.isEmpty(l)?g.parentNode.replaceChild(h,g):(c=Jt.fromDom(g),s=Zu(c,"br"),l=me(function(){for(var e=[],t=c.dom;t;)e.push(Jt.fromDom(t)),t=t.lastChild;return e}().slice(-1),xo),s.length===l.length&&de(l,gn),p.isEmpty(g)?g.parentNode.replaceChild(h,g):p.insertAfter(h,g)),g=function(t,e,n,o,r,i){var u=t.formatter,a=t.dom,c=me(pe(u.get()),function(e){return e!==o&&!Oe(e,"removeformat")}),c=Zf(t,n,c);if(0<me(c,function(e){return!Xs(t,e,o)}).length){n=n.cloneNode(!1);return a.add(e,n),u.remove(o,r,n,i),a.remove(n),Y.some(n)}return Y.none()}(e,a,i,t,n,o),a=Wm(m.concat(g.toArray()),a),zm(e,u,!1),d.setCursorLocation(a,1),f.isEmpty(i)&&f.remove(i)))}function Gm(e,t){return e.schema.getTextInlineElements().hasOwnProperty(Qt(t))&&!ks(t.dom)&&!ct(t.dom)}var $m=Td,Xm=Dd,Ym=Kt.each,J=function(n,o,r){return Y.from(r.container()).filter(wn).exists(function(e){var t=n?0:-1;return o(e.data.charAt(r.offset()+t))})},Km=w(J,!0,Is),Jm=w(J,!1,Is),Dt=function(t,n){return function(e){return Y.from(Nc(t?0:-1,e)).filter(n).isSome()}},K=function(e){return _n(e)&&"block"===bt(Jt.fromDom(e),"display")},Rt=function(e){return Tn(e)&&!(yn(e=e)&&"all"===e.getAttribute("data-mce-bogus"))},Qm=Dt(!0,K),Zm=Dt(!1,K),eg=Dt(!0,Dn),tg=Dt(!1,Dn),ng=Dt(!0,st),og=Dt(!1,st),rg=Dt(!0,Rt),ig=Dt(!1,Rt),J=function(e,n,o){return Fd(e,n.dom,o).forall(function(t){return Pd(n,o).fold(function(){return!1===Bc(t,o,n.dom)},function(e){return!1===Bc(t,o,n.dom)&&Le(e,Jt.fromDom(t.container()))})})},K=function(t,n,o){return Pd(n,o).fold(function(){return Fd(t,n.dom,o).forall(function(e){return!1===Bc(e,o,n.dom)})},function(e){return Fd(t,e.dom,o).isNone()})},ug=w(K,!1),ag=w(K,!0),cg=w(J,!1),sg=w(J,!0),lg=w(Vd,!1),fg=w(Vd,!0),dg=function(e,t){var n=e.data.slice(t),n=n.length-Bt(n).length;return em(e,t,n)},mg=function(e,t){var n=e.data.slice(0,t),n=n.length-Nt(n).length;return em(e,t-n,n)},gg=e([{removeTable:["element"]},{emptyCells:["cells"]},{deleteCellSelection:["rng","cell"]}]),pg=function(e,t){return gm(t,e).isSome()},hg=function(e){var t;return(8===Ve(t=e)||"#comment"===Qt(t)?on:an)(e).bind(hg).orThunk(function(){return Y.some(e)})},vg=function(e,t){return D(Id(t,e),function(e){return"caption"===Qt(e)})},bg=function(e,t){return Nd(t),e.selection.setCursorLocation(t.dom,0),Y.some(!0)},yg=Mt,xg=function(e,t){t(e),e.firstChild&&xg(e.firstChild,t),e.next&&xg(e.next,t)},wg=Zo,Cg="_mce_caret",Sg={},kg=V,Og=P,Dt=function(e){var t,n=e.selection.getRng(),o=at(["pre"]);n.collapsed||(t=e.selection.getSelectedBlocks(),Og(kg(kg(t,o),function(e){return o(e.previousSibling)&&-1!==H(t,e.previousSibling)}),function(e){var t=e.previousSibling;_u(e=e).remove(),_u(t).append("<br><br>").append(e.childNodes)}))};Sg["pre"]||(Sg.pre=[]),Sg.pre.push(Dt);function _g(e){return yn(e)&&!Rs(e)&&!ks(e)&&!ct(e)}function Eg(e,t){for(var n=e;n;n=n[t]){if(wn(n)&&0!==n.nodeValue.length)return e;if(yn(n)&&!Rs(n))return n}return e}function Tg(e,t,n){var o,r,i=new Ad(e);if(t&&n&&(t=Eg(t,"previousSibling"),n=Eg(n,"nextSibling"),i.compare(t,n))){for(o=t.nextSibling;o&&o!==n;)o=(r=o).nextSibling,t.appendChild(r);return e.remove(n),Kt.each(Kt.grep(n.childNodes),function(e){t.appendChild(e)}),t}return n}function Dg(e,t,n,o){o&&!1!==t.merge_siblings&&(o=Tg(e,Vs(o),o),Tg(e,o,Vs(o,!0)))}function Ag(t,n){return function(e){return!(!e||!qs(t,e,n))}}function Bg(n,o,r){return function(e){var t;n.setStyle(e,o,r),""===e.getAttribute("style")&&e.removeAttribute("style"),t=n,"SPAN"===(e=e).nodeName&&0===t.getAttribs(e).length&&t.remove(e,!0)}}function Ng(e,t,n){return e.isChildOf(t,n)&&t!==n&&!e.isBlock(n)}function Rg(e,t,n){var o=t[n?"startContainer":"endContainer"],r=t[n?"startOffset":"endOffset"];return yn(o)&&(t=o.childNodes.length-1,!n&&r&&r--,o=o.childNodes[t<r?t:r]),wn(o)&&n&&r>=o.nodeValue.length&&(o=new vo(o,e.getBody()).next()||o),o=wn(o)&&!n&&0===r?new vo(o,e.getBody()).prev()||o:o}function Mg(e,t){var n=t?"firstChild":"lastChild";if(/^(TR|TH|TD)$/.test(e.nodeName)&&e[n]){t=e[n];return"TR"===e.nodeName&&t[n]||t}return e}function Ig(e,t,n,o){return o=e.create(n,o),t.parentNode.insertBefore(o,t),o.appendChild(t),o}function Fg(e,t,n,o,r){return t=Jt.fromDom(t),o=Jt.fromDom(e.create(o,r)),r=(n?un:rn)(t),Je(o,r),n?(ln(t,o),dn(o,t)):(fn(t,o),mn(o,t)),o.dom}function Pg(e,t,n,o){return!(t=Vs(t,n,o))||"BR"===t.nodeName||e.isBlock(t)}function Lg(e,o,r,t,i){var n,u,a=e.dom,c=a;if(!(Pp(u=t,(l=o).inline)||Pp(u,l.block)||l.selector&&yn(u)&&c.is(u,l.selector)||o.links&&"A"===t.nodeName))return Mp.keep();var s,l,f,d,m,g=t;if(o.inline&&"all"===o.remove&&ne(o.preserve_attributes)){var p=me(a.getAttribs(g),function(e){return ee(o.preserve_attributes,e.name.toLowerCase())});if(a.removeAllAttribs(g),de(p,function(e){return a.setAttrib(g,e.name,e.value)}),0<p.length)return Mp.rename("span")}if("all"!==o.remove){Fp(o.styles,function(e,t){e=Ws(a,js(e,r),t+""),ce(t)&&(t=e,i=null),!o.remove_similar&&i&&!Pp(qs(a,i,t),e)||a.setStyle(g,t,""),n=!0}),n&&""===a.getAttrib(g,"style")&&(g.removeAttribute("style"),g.removeAttribute("data-mce-style")),Fp(o.attributes,function(e,t){var n;e=js(e,r),ce(t)&&(t=e,i=null),!o.remove_similar&&i&&!Pp(a.getAttrib(i,t),e)||("class"===t&&(e=a.getAttrib(g,t))&&(n="",de(e.split(/\s+/),function(e){/mce\-\w+/.test(e)&&(n+=(n?" ":"")+e)}),n)?a.setAttrib(g,t,n):("class"===t&&g.removeAttribute("className"),Ip.test(t)&&g.removeAttribute("data-mce-"+t),g.removeAttribute(t)))}),Fp(o.classes,function(e){e=js(e,r),i&&!a.hasClass(i,e)||a.removeClass(g,e)});for(var h=a.getAttribs(g),v=0;v<h.length;v++){var b=h[v].nodeName;if(0!==b.indexOf("_")&&0!==b.indexOf("data-"))return Mp.keep()}}return"none"!==o.remove?(l=o,p=(t=g).parentNode,d=(s=e).dom,m=cc(s),l.block&&(m?p===d.getRoot()&&(l.list_block&&Pp(t,l.list_block)||de(ge(t.childNodes),function(e){zs(s,m,e.nodeName.toLowerCase())?f?f.appendChild(e):(f=Ig(d,e,m),d.setAttribs(f,s.settings.forced_root_block_attrs)):f=0})):d.isBlock(t)&&!d.isBlock(p)&&(Pg(d,t,!1)||Pg(d,t.firstChild,!0,!0)||t.insertBefore(d.create("br"),t.firstChild),Pg(d,t,!0)||Pg(d,t.lastChild,!1,!0)||t.appendChild(d.create("br")))),l.selector&&l.inline&&!Pp(l.inline,t)||d.remove(t,!0),Mp.removed()):Mp.keep()}function Vg(t,e,n,o,r){return Lg(t,e,n,o,r).fold(W,function(e){return t.dom.rename(o,e),!0},q)}function Hg(e,r,i,u,t){var n,o,a,c,s,l;return null===r.get()&&(o=e,a=zu({}),(n=r).set({}),o.on("NodeChange",function(e){!function(o,e,t,n){var r=pe(t.get()),i={},u={},a=me($s(o.dom,e),function(e){return 1===e.nodeType&&!e.getAttribute("data-mce-bogus")});ve(n,function(e,n){Kt.each(a,function(t){return o.formatter.matchNode(t,n,{},e.similar)?(-1===r.indexOf(n)&&(de(e.callbacks,function(e){e(!0,{node:t,format:n,parents:a})}),i[n]=e.callbacks),u[n]=e.callbacks,!1):!$f(o,t,n)&&void 0})});e=Up(t.get(),u,e,a);t.set(we(we({},i),e))}(o,e.element,a,n.get())})),e=i,c=u,s=t,l=(t=r).get(),de(e.split(","),function(e){l[e]||(l[e]={similar:s,callbacks:[]}),l[e].callbacks.push(c)}),t.set(l),{unbind:function(){var e,t=i,n=u,o=(e=r).get();de(t.split(","),function(e){o[e].callbacks=me(o[e].callbacks,function(e){return e!==n}),0===o[e].callbacks.length&&delete o[e]}),e.set(o)}}}function zg(e,t){var n=(t||document).createDocumentFragment();return de(e,function(e){n.appendChild(e.dom)}),Jt.fromDom(n)}function jg(e,t,n){return{element:e,width:t,rows:n}}function Ug(e,t){return{element:e,cells:t}}function Wg(e,t){return t=parseInt(gt(e,t),10),isNaN(t)?1:t}function qg(e){return T(e,function(e,t){return t.cells.length>e?t.cells.length:e},0)}function Gg(e,t){for(var n=e.rows,o=0;o<n.length;o++)for(var r=n[o].cells,i=0;i<r.length;i++)if(Pe(r[i],t))return Y.some({x:i,y:o});return Y.none()}function $g(e,t,n,o,r){for(var i=[],u=e.rows,a=n;a<=r;a++){var c=u[a].cells,c=t<o?c.slice(t,o+1):c.slice(o,t+1);i.push(Ug(u[a].element,c))}return i}function Xg(e){var r=jg(ia(e),0,[]);return de(Zu(e,"tr"),function(n,o){de(Zu(n,"td,th"),function(e,t){!function(e,t,n,o,r){for(var i=Wg(r,"rowspan"),u=Wg(r,"colspan"),a=e.rows,c=n;c<n+i;c++){a[c]||(a[c]=Ug(ua(o),[]));for(var s=t;s<t+u;s++)a[c].cells[s]=c===n&&s===t?r:ia(r)}}(r,function(e,t,n){for(;o=t,((r=e.rows)[n]?r[n].cells:[])[o];)t++;var o,r;return t}(r,t,o),o,n,e)})}),jg(r.element,qg(r.rows),r.rows)}function Yg(e,t){var n,o,r,i=Jt.fromDom(t.commonAncestorContainer),u=Id(i,e),e=me(u,function(e){return yo(e)||Uo(e)}),u=(r=t,D(o=u,function(e){return"li"===Qt(e)&&ml(e,r)}).fold(_([]),function(e){return D(o,function(e){return"ul"===Qt(e)||"ol"===Qt(e)}).map(function(e){var t=Jt.fromTag(Qt(e)),e=I(xt(e),function(e,t){return _e(t,"list-style")});return vt(t,e),[Jt.fromTag("li"),t]}).getOr([])})),i=e.concat(u.length?u:$o(n=i)?Ue(n).filter(Go).fold(_([]),function(e){return[n,e]}):Go(n)?[n]:[]);return E(i,ia)}function Kg(){return zg([])}function Jg(e,r){return t=r[0],Yn(t,"table",w(Pe,e)).bind(function(e){var u,t,n=r[0],o=r[r.length-1],e=Xg(e);return t=o,Gg(u=e,n).bind(function(i){return Gg(u,t).map(function(e){return t=u,n=i.x,r=i.y,o=e.x,r=r<(e=e.y)?$g(t,n,r,o,e):$g(t,n,e,o,r),jg(t.element,qg(r),r);var t,n,o,r})}).map(function(e){return zg([(e=E((n=t=e).rows,function(e){var t=E(e.cells,function(e){e=ua(e);return ht(e,"colspan"),ht(e,"rowspan"),e}),e=ia(e.element);return Je(e,t),e}),t=ia(n.element),n=Jt.fromTag("tbody"),Je(n,e),mn(t,n),t)]);var t,n})}).getOrThunk(Kg);var t}function Qg(e,t){var n;return 0<(n=fl(t,e)).length?Jg(e,n):(n=e,0<(e=t).length&&e[0].collapsed?Kg():(t=n,n=e[0],e=Jt.fromDom(n.cloneContents()),n=Yg(t,n),e=T(n,function(e,t){return mn(t,e),t},e),0<n.length?zg([e]):e))}function Zg(e,t){return 0<=t&&t<e.length&&Is(e.charAt(t))}function ep(e,t){return e=Co(e.innerText),t?e.replace(/^[ \f\n\r\t\v]+/,""):e}function tp(e,t,n){if((n=void 0===n?{}:n).get=!0,n.format=t,n.selection=!0,(n=e.fire("BeforeGetContent",n)).isDefaultPrevented())return e.fire("GetContent",n),n.content;if("text"===n.format)return u=e,Y.from(u.selection.getRng()).map(function(e){var t=Y.from(u.dom.getParent(e.commonAncestorContainer,u.dom.isBlock)),n=u.getBody(),o=t.map(function(e){return e.nodeName}).getOr("div").toLowerCase(),r=$t.browser.isIE()&&"pre"!==o,i=u.dom.add(n,o,{"data-mce-bogus":"all",style:"overflow: hidden; opacity: 0;"},e.cloneContents()),o=ep(i,r),e=Co(i.textContent);if(u.dom.remove(i),Zg(e,0)||Zg(e,e.length-1)){n=t.getOr(n),n=ep(n,r),r=n.indexOf(o);return-1===r?o:(Zg(n,r-1)?" ":"")+o+(Zg(n,r+o.length)?" ":"")}return o}).getOr("");var u;n.getInner=!0;var o,r,i,a=(a=n,i=(o=e).selection.getRng(),r=o.dom.create("body"),t=o.selection.getSel(),t=Wf(o,ll(t)),(i=a.contextual?Qg(Jt.fromDom(o.getBody()),t).dom:i.cloneContents())&&r.appendChild(i),o.selection.serializer.serialize(r,a));return"tree"===n.format?a:(n.content=e.selection.isCollapsed()?"":a,e.fire("GetContent",n),n.content)}function np(e){return yn(e)?e.outerHTML:wn(e)?Or.encodeRaw(e.data,!1):Cn(e)?"\x3c!--"+e.data+"--\x3e":""}function op(e,n){var o=0;de(e,function(e){var t;0===e[0]?o++:1===e[0]?(function(e,t,n){t=function(e){var t,n=document.createElement("div"),o=document.createDocumentFragment();for(e&&(n.innerHTML=e);t=n.firstChild;)o.appendChild(t);return o}(t);e.hasChildNodes()&&n<e.childNodes.length?(n=e.childNodes[n]).parentNode.insertBefore(t,n):e.appendChild(t)}(n,e[1],o),o++):2===e[0]&&(t=o,(e=n).hasChildNodes()&&t<e.childNodes.length&&(t=e.childNodes[t]).parentNode.removeChild(t))})}function rp(t){var e=(n=t.getBody(),me(E(ge(n.childNodes),np),function(e){return 0<e.length})),n=v(e,function(e){e=Dd(t.serializer,e);return 0<e.length?[e]:[]});return-1!==(e=n.join("")).indexOf("</iframe>")?{type:"fragmented",fragments:n,content:"",bookmark:null,beforeBookmark:null}:{type:"complete",fragments:null,content:e,bookmark:null,beforeBookmark:null}}function ip(e,t,n){var o,r,m,g,p,h,s,v,l,i;"fragmented"===t.type?(o=t.fragments,r=e.getBody(),i=E(ge(r.childNodes),np),op((o=(m=i).length+(g=o).length+2,p=new Array(o),h=new Array(o),s=function(e,t,n,o,r){var i=l(e,t,n,o);if(null===i||i.start===t&&i.diag===t-o||i.end===e&&i.diag===e-n)for(var u=e,a=n;u<t||a<o;)u<t&&a<o&&m[u]===g[a]?(r.push([0,m[u]]),++u,++a):o-n<t-e?(r.push([2,m[u]]),++u):(r.push([1,g[a]]),++a);else{s(e,i.start,n,i.start-i.diag,r);for(var c=i.start;c<i.end;++c)r.push([0,m[c]]);s(i.end,t,i.end-i.diag,o,r)}},v=function(e,t,n,o){for(var r=e;r-t<o&&r<n&&m[r]===g[r-t];)++r;return{start:e,end:r,diag:t}},l=function(e,t,n,o){var r=t-e,i=o-n;if(0==r||0==i)return null;var u,a,c,s,l,f=r-i,r=i+r,d=(r%2==0?r:1+r)/2;for(p[1+d]=e,h[1+d]=t+1,u=0;u<=d;++u){for(a=-u;a<=u;a+=2){for(c=a+d,a===-u||a!==u&&p[c-1]<p[c+1]?p[c]=p[c+1]:p[c]=p[c-1]+1,l=(s=p[c])-e+n-a;s<t&&l<o&&m[s]===g[l];)p[c]=++s,++l;if(f%2!=0&&f-u<=a&&a<=f+u&&h[c-f]<=p[c])return v(h[c-f],a+e-n,t,o)}for(a=f-u;a<=f+u;a+=2){for(c=a+d-f,a===f-u||a!==f+u&&h[c+1]<=h[c-1]?h[c]=h[c+1]-1:h[c]=h[c-1],l=(s=h[c]-1)-e+n-a;e<=s&&n<=l&&m[s]===g[l];)h[c]=s--,l--;if(f%2==0&&-u<=a&&a<=u&&h[c]<=p[c+f])return v(h[c],a+e-n,t,o)}}},s(0,m.length,0,g.length,o=[]),o),r)):e.setContent(t.content,{format:"raw"}),e.selection.moveToBookmark(n?t.beforeBookmark:t.bookmark)}function up(e){return"fragmented"===e.type?e.fragments.join(""):e.content}function ap(e){var t=Jt.fromTag("body",Wp.get().getOrThunk(function(){var e=document.implementation.createHTMLDocument("undo");return Wp.set(Y.some(e)),e}));return oa(t,up(e)),de(Zu(t,"*[data-mce-bogus]"),Ze),t.dom.innerHTML}function cp(e,t){return!(!e||!t)&&(n=t,up(e)===up(n)||(t=t,ap(e)===ap(t)));var n}function sp(e){return 0===e.get()}function lp(e,t,n){sp(n)&&(e.typing=t)}function fp(e,t){e.typing&&(lp(e,!1,t),e.add())}function dp(e){return e instanceof xd}function mp(e,t){Mm(e.serializer.getNodeFilters(),e.serializer.getAttributeFilters(),t)}function gp(){return{type:"complete",fragments:[],content:"",bookmark:null,beforeBookmark:null}}function pp(s){return{undoManager:{beforeChange:function(e,t){var n=s,t=t;sp(e)&&t.set(Y.some(Xc(n.selection)))},addUndoLevel:function(e,t,n,o,r,i){return function(e,t,n,o,r,i,u){var a=rp(e);if(i=Kt.extend(i=i||{},a),!1===sp(o)||e.removed)return null;o=t.data[n.get()];if(e.fire("BeforeAddUndo",{level:i,lastLevel:o,originalEvent:u}).isDefaultPrevented())return null;if(o&&cp(o,i))return null;t.data[n.get()]&&r.get().each(function(e){t.data[n.get()].beforeBookmark=e});r=e.getParam("custom_undo_redo_levels",0,"number");if(r&&t.data.length>r){for(var c=0;c<t.data.length-1;c++)t.data[c]=t.data[c+1];t.data.length--,n.set(t.data.length)}i.bookmark=Xc(e.selection),n.get()<t.data.length-1&&(t.data.length=n.get()+1),t.data.push(i),n.set(t.data.length-1);u={level:i,lastLevel:o,originalEvent:u};return 0<n.get()?(e.setDirty(!0),e.fire("AddUndo",u),e.fire("change",u)):e.fire("AddUndo",u),i}(s,e,t,n,o,r,i)},undo:function(e,t,n){return o=s,t=t,n=n,(e=e).typing&&(e.add(),e.typing=!1,lp(e,!1,t)),0<n.get()&&(n.set(n.get()-1),r=e.data[n.get()],ip(o,r,!0),o.setDirty(!0),o.fire("Undo",{level:r})),r;var o,r},redo:function(e,t){return n=s,t=t,(e=e).get()<t.length-1&&(e.set(e.get()+1),o=t[e.get()],ip(n,o,!1),n.setDirty(!0),n.fire("Redo",{level:o})),o;var n,o},clear:function(e,t){var n=s,t=t;(e=e).data=[],t.set(0),e.typing=!1,n.fire("ClearUndos")},reset:function(e){(e=e).clear(),e.add()},hasUndo:function(e,t){return n=s,e=e,0<t.get()||e.typing&&e.data[0]&&!cp(rp(n),e.data[0]);var n},hasRedo:function(e,t){return e=e,t.get()<e.data.length-1&&!e.typing},transact:function(e,t,n){return n=n,fp(e=e,t),e.beforeChange(),e.ignore(n),e.add()},ignore:function(e,t){try{e.set(e.get()+1),t()}finally{e.set(e.get()-1)}},extra:function(e,t,n,o){var r=s,i=t,t=o;(o=e).transact(n)&&(e=o.data[i.get()].bookmark,n=o.data[i.get()-1],ip(r,n,!0),o.transact(t)&&(o.data[i.get()-1].beforeBookmark=e))}},formatter:{match:function(e,t,n){return Jf(s,e,t,n)},matchAll:function(e,t){return r=e,i=t,u=[],a={},t=(o=s).selection.getStart(),o.dom.getParent(t,function(e){for(var t=0;t<r.length;t++){var n=r[t];!a[n]&&bd(o,e,n,i)&&(a[n]=!0,u.push(n))}},o.dom.getRoot()),u;var o,r,i,u,a},matchNode:function(e,t,n,o){return bd(s,e,t,n,o)},canApply:function(a){return function(e){var t,n,o,r,i=e.formatter.get(a),u=e.dom;if(i)for(e=e.selection.getStart(),t=$s(u,e),o=i.length-1;0<=o;o--){if(!(r=i[o].selector)||i[o].defaultBlock)return!0;for(n=t.length-1;0<=n;n--)if(u.is(t[n],r))return!0}return!1}(s)},closest:function(e){return Qf(s,e)},apply:function(e,t,n){return jp(s,e,t,n)},remove:function(e,t,n,o){return Lp(s,e,t,n,o)},toggle:function(e,t,n){var o=e,r=t,e=n,n=(t=s).formatter.get(o);(!Jf(t,o,r,e)||"toggle"in n[0]&&!n[0].toggle?jp:Lp)(t,o,r,e)},formatChanged:function(e,t,n,o){return Hg(s,e,t,n,o)}},editor:{getContent:function(e,t){return i=s,u=e,a=t,Y.from(i.getBody()).fold(_("tree"===u.format?new xd("body",11):""),function(e){return t=i,n=a,o=e,(e=u).format=n,e.get=!0,e.getInner=!0,e.no_events||t.fire("BeforeGetContent",e),r="raw"===e.format?Kt.trim(Xm(t.serializer,o.innerHTML)):"text"===e.format?t.dom.isEmpty(o)?"":Co(o.innerText||o.textContent):"tree"===e.format?t.serializer.serialize(o,e):(n=(r=t).serializer.serialize(o,e),r=cc(r),r=new RegExp("^(<"+r+"[^>]*>(&nbsp;|&#160;|\\s| |<br \\/>|)<\\/"+r+">[\r\n]*|<br \\/>[\r\n]*)$"),n.replace(r,"")),ee(["text","tree"],e.format)||Ko(Jt.fromDom(o))?e.content=r:e.content=Kt.trim(r),e.no_events||t.fire("GetContent",e),e.content;var t,n,o,r});var i,u,a},setContent:function(e,t){return u=s,a=e,(c=t).format=c.format||"html",c.set=!0,c.content=Im(a)?"":a,c.no_events||u.fire("BeforeSetContent",c),Im(a)||(a=c.content),Y.from(u.getBody()).fold(_(a),function(e){return Im(a)?function(e,t,n,o){Mm(e.parser.getNodeFilters(),e.parser.getAttributeFilters(),n);var r=Sd({validate:e.validate},e.schema).serialize(n);return o.content=Ko(Jt.fromDom(t))?r:Kt.trim(r),Fm(e,o.content),o.no_events||e.fire("SetContent",o),n}(u,e,a,c):(t=u,n=e,r=c,0===(o=a).length||/^\s+$/.test(o)?(i='<br data-mce-bogus="1">',"TABLE"===n.nodeName?o="<tr><td>"+i+"</td></tr>":/^(UL|OL)$/.test(n.nodeName)&&(o="<li>"+i+"</li>"),o=(e=cc(t))&&t.schema.isValidChild(n.nodeName.toLowerCase(),e.toLowerCase())?(o=i,t.dom.createHTML(e,sc(t),o)):o||'<br data-mce-bogus="1">',Fm(t,o),t.fire("SetContent",r)):("raw"!==r.format&&(o=Sd({validate:t.validate},t.schema).serialize(t.parser.parse(o,{isRootContent:!0,insert:!0}))),r.content=Ko(Jt.fromDom(n))?o:Kt.trim(o),Fm(t,r.content),r.no_events||t.fire("SetContent",r)),r.content);var t,n,o,r,i});var u,a,c},insertContent:function(e,t){return Rm(s,e,t)},addVisual:function(e){var o,t=e,r=(o=s).dom,e=k(t)?t:o.getBody();ie(o.hasVisual)&&(o.hasVisual=o.getParam("visual",!0,"boolean")),de(r.select("table,a",e),function(e){switch(e.nodeName){case"TABLE":var t=o.getParam("visual_table_class","mce-item-table","string"),n=r.getAttrib(e,"border");n&&"0"!==n||!o.hasVisual?r.removeClass(e,t):r.addClass(e,t);break;case"A":r.getAttrib(e,"href")||(n=r.getAttrib(e,"name")||e.id,t=o.getParam("visual_anchor_class","mce-item-anchor","string"),n&&o.hasVisual?r.addClass(e,t):r.removeClass(e,t))}}),o.fire("VisualAid",{element:t,hasVisual:o.hasVisual})}},selection:{getContent:function(e,t){return tp(s,e,t)}},raw:{getModel:function(){return Y.none()}}}}function hp(o,r){function i(e){return Z(e)?e:{}}var e=c("Unimplemented feature for rtc");return{undoManager:{beforeChange:U,addUndoLevel:e,undo:function(){return r.undo(),gp()},redo:function(){return r.redo(),gp()},clear:e,reset:e,hasUndo:function(){return r.hasUndo()},hasRedo:function(){return r.hasRedo()},transact:function(e,t,n){return r.transact(n),gp()},ignore:e,extra:e},formatter:{match:function(e,t,n){return r.matchFormat(e,i(t))},matchAll:e,matchNode:e,canApply:function(e){return r.canApplyFormat(e)},closest:function(e){return r.closestFormat(e)},apply:function(e,t,n){return r.applyFormat(e,i(t))},remove:function(e,t,n,o){return r.removeFormat(e,i(t))},toggle:function(e,t,n){return r.toggleFormat(e,i(t))},formatChanged:function(e,t,n,o){return r.formatChanged(t,n,o)}},editor:{getContent:function(e,t){if("html"!==t&&"tree"!==t)return pp(o).editor.getContent(e,t);var n=r.getContent(),e=Sd({inner:!0});return mp(o,n),"tree"===t?n:e.serialize(n)},setContent:function(e,t){var n=dp(e)?e:o.parser.parse(e,{isRootContent:!0,insert:!0});return r.setContent(n),e},insertContent:function(e,t){var n=Y.from(o.selection.getStart(!0)).map(function(e){return e.nodeName.toLowerCase()}).fold(function(){return{}},function(e){return{context:e}}),n=dp(e)?e:o.parser.parse(e,we(we({},n),{insert:!0}));r.insertContent(n)},addVisual:function(e){}},selection:{getContent:function(e,t){if("html"!==e&&"tree"!==e)return pp(o).selection.getContent(e,t);var n=r.getSelectedContent(),t=Sd({});return mp(o,n),"tree"===e?n:t.serialize(n)}},raw:{getModel:function(){return Y.some(r.getRawModel())}}}}function vp(e){return ye(e.plugins,"rtc")}function bp(e){return e.rtcInstance||pp(e)}function yp(e){if(e=e.rtcInstance)return e;throw new Error("Failed to get RTC instance not yet initialized.")}function xp(e){return 0===e.dom.length?(gn(e),Y.none()):Y.some(e)}function wp(e,t,u,a){e.bind(function(i){return(a?mg:dg)(i.dom,a?i.dom.length:0),t.filter(en).map(function(e){var t=u,n=a,o=i.dom,r=e.dom,e=(n?o:r).length;n?(tm(o,r,!1,!n),t.setStart(r,e)):(tm(r,o,!1,!n),t.setEnd(r,e))})}).orThunk(function(){var e=a;return t.filter(function(e){return cf.isBookmarkNode(e.dom)}).bind(e?We:on).or(t).filter(en).map(function(e){var n,o=a;Ue(n=e).each(function(e){var t=n.dom;o&&$d(e,zc(t,0))?dg(t,0):!o&&Xd(e,zc(t,t.length))&&mg(t,t.length)})})})}function Cp(e,t,n){var o;(t=(o=t,we(we({format:"html"},n=void 0===n?{}:n),{set:!0,selection:!0,content:o}))).no_events||!(t=e.fire("BeforeSetContent",t)).isDefaultPrevented()?(n.content=function(e,t){if("raw"===t.format)return t.content;var n=e.selection.getRng(),n=e.dom.getParent(n.commonAncestorContainer,e.dom.isBlock),n=n?{context:n.nodeName.toLowerCase()}:{},t=e.parser.parse(t.content,we(we({isRootContent:!0,forced_root_block:!1},n),t));return Sd({validate:e.validate},e.schema).serialize(t)}(e,t),function(e,t){var n=Y.from(t.firstChild).map(Jt.fromDom),o=Y.from(t.lastChild).map(Jt.fromDom);e.deleteContents(),e.insertNode(t);var r=n.bind(on).filter(en).bind(xp),t=o.bind(We).filter(en).bind(xp);wp(r,n,e,!0),wp(t,o,e,!1),e.collapse(!1)}(o=e.selection.getRng(),o.createContextualFragment(n.content)),e.selection.setRng(o),wf(e,o),t.no_events||e.fire("SetContent",t)):e.fire("SetContent",t)}function Sp(e,t,n){var o;e&&e.hasOwnProperty(t)&&(0===(o=me(e[t],function(e){return e!==n})).length?delete e[t]:e[t]=o)}function kp(e){return!!e.select}function Op(e){return!(!e||!e.ownerDocument)&&Le(Jt.fromDom(e.ownerDocument),Jt.fromDom(e))}function _p(i,u,e,a){function n(e,t){return m||(m={},g={},d.on("NodeChange",function(e){var n=e.element,o=f.getParents(n,null,f.getRoot()),r={};Kt.each(m,function(e,n){Kt.each(o,function(t){if(f.is(t,n))return g[n]||(Kt.each(e,function(e){e(!0,{node:t,selector:n,parents:o})}),g[n]=e),r[n]=e,!1})}),Kt.each(g,function(e,t){r[t]||(delete g[t],Kt.each(e,function(e){e(!1,{node:n,selector:t,parents:o})}))})})),m[e]||(m[e]=[]),m[e].push(t),{unbind:function(){Sp(m,e,t),Sp(g,e,t)}}}function t(e,t){return Cp(a,e,t)}function o(e){var t=p();t.collapse(!!e),h(t)}function c(){return u.getSelection?u.getSelection():u.document.selection}function r(){var e=c(),t=null==e?void 0:e.anchorNode,n=null==e?void 0:e.focusNode;if(!e||!t||!n||ut(t)||ut(n))return!0;var o=i.createRng();return o.setStart(t,e.anchorOffset),o.collapse(!0),(t=i.createRng()).setStart(n,e.focusOffset),t.collapse(!0),o.compareBoundaryPoints(o.START_TO_START,t)<=0}var s,l,f,d,m,g,p=function(){function e(e,t,n){try{return t.compareBoundaryPoints(e,n)}catch(e){return-1}}var t,n;if(!u)return null;var o=u.document;if(null==o)return null;if(void 0!==a.bookmark&&!1===Vf(a)){var r=Nf(a);if(r.isSome())return r.map(function(e){return Wf(a,[e])[0]}).getOr(o.createRange())}try{(t=c())&&!ut(t.anchorNode)&&(n=0<t.rangeCount?t.getRangeAt(0):(t.createRange?t:o).createRange(),n=Wf(a,[n])[0])}catch(e){}return(n=n||(o.createRange?o.createRange():o.body.createTextRange())).setStart&&9===n.startContainer.nodeType&&n.collapsed&&(o=i.getRoot(),n.setStart(o,0),n.setEnd(o,0)),s&&l&&(0===e(n.START_TO_START,n,s)&&0===e(n.END_TO_END,n,s)?n=l:l=s=null),n},h=function(e,t){var n;if((o=e)&&(kp(o)||Op(o.startContainer)&&Op(o.endContainer))){var o=kp(e)?e:null;if(o){l=null;try{o.select()}catch(e){}}else{o=c();if(e=a.fire("SetSelectionRange",{range:e,forward:t}).range,o){l=e;try{o.removeAllRanges(),o.addRange(e)}catch(e){}!1===t&&o.extend&&(o.collapse(e.endContainer,e.endOffset),o.extend(e.startContainer,e.startOffset)),s=0<o.rangeCount?o.getRangeAt(0):null}e.collapsed||e.startContainer!==e.endContainer||!o.setBaseAndExtent||$t.ie||e.endOffset-e.startOffset<2&&e.startContainer.hasChildNodes()&&(n=e.startContainer.childNodes[e.startOffset])&&"IMG"===n.tagName&&(o.setBaseAndExtent(e.startContainer,e.startOffset,e.endContainer,e.endOffset),o.anchorNode===e.startContainer&&o.focusNode===e.endContainer||o.setBaseAndExtent(n,0,n,1)),a.fire("AfterSetSelectionRange",{range:e,forward:t})}}},v={bookmarkManager:null,controlSelection:null,dom:f=i,win:u,serializer:e,editor:d=a,collapse:o,setCursorLocation:function(e,t){var n=i.createRng();e?(n.setStart(e,t),n.setEnd(e,t),h(n),o(!1)):(gl(i,n,a.getBody(),!0),h(n))},getContent:function(e){return e=(t=void 0===(t=e)?{}:t).format||"html",t,yp(a).selection.getContent(e,t);var t},setContent:t,getBookmark:function(e,t){return b.getBookmark(e,t)},moveToBookmark:function(e){return b.moveToBookmark(e)},select:function(e,t){var o=i,r=t;return Y.from(e).map(function(e){var t=o.nodeIndex(e),n=o.createRng();return n.setStart(e.parentNode,t),n.setEnd(e.parentNode,t+1),r&&(gl(o,n,e,!0),gl(o,n,e,!1)),n}).each(h),e},isCollapsed:function(){var e=p(),t=c();return!(!e||e.item)&&(e.compareEndPoints?0===e.compareEndPoints("StartToEnd",e):!t||e.collapsed)},isForward:r,setNode:function(e){return t(i.getOuterHTML(e)),e},getNode:function(){return function(e,t){if(!t)return e;var n=t.startContainer,o=t.endContainer,r=t.startOffset,i=t.endOffset,e=t.commonAncestorContainer;return!t.collapsed&&(n===o&&i-r<2&&n.hasChildNodes()&&(e=n.childNodes[r]),3===n.nodeType&&3===o.nodeType&&(n=n.length===r?Uf(n.nextSibling,!0):n.parentNode,o=0===i?Uf(o.previousSibling,!1):o.parentNode,n&&n===o))?n:e&&3===e.nodeType?e.parentNode:e}(a.getBody(),p())},getSel:c,setRng:h,getRng:p,getStart:function(e){return zf(a.getBody(),p(),e)},getEnd:function(e){return jf(a.getBody(),p(),e)},getSelectedBlocks:function(e,t){return function(e,t,n,o){var r,i=[],u=e.getRoot();if(n=e.getParent(n||zf(u,t,t.collapsed),e.isBlock),o=e.getParent(o||jf(u,t,t.collapsed),e.isBlock),n&&n!==u&&i.push(n),n&&o&&n!==o)for(var a=new vo(n,u);(r=a.next())&&r!==o;)e.isBlock(r)&&i.push(r);return o&&n!==o&&o!==u&&i.push(o),i}(i,p(),e,t)},normalize:function(){var e=p(),t=c();if(1<ll(t).length||!pl(a))return e;t=rf(i,e);return t.each(function(e){h(e,r())}),t.getOr(e)},selectorChanged:function(e,t){return n(e,t),v},selectorChangedWithUnbind:n,getScrollContainer:function(){for(var e,t=i.getRoot();t&&"BODY"!==t.nodeName;){if(t.scrollHeight>t.clientHeight){e=t;break}t=t.parentNode}return e},scrollIntoView:function(e,t){(a.inline?function(e,t,n){return hf(e,t,yf,n)}:function(e,t,n){return hf(e,t,xf,n)})(a,e,t)},placeCaretAt:function(e,t){return h(Jl(e,t,a.getDoc()))},getBoundingClientRect:function(){var e=p();return e.collapsed?zc.fromRangeStart(e).getClientRects()[0]:e.getBoundingClientRect()},destroy:function(){u=s=l=null,y.destroy()}},b=cf(v),y=Yl(v,a);return v.bookmarkManager=b,v.controlSelection=y,v}function Ep(e,t){var n,o,u,a,r=Ur();t.convert_fonts_to_spans&&(o=e,u=r,a=Kt.explode(t.font_size_legacy_values),o.addNodeFilter("font",function(e){de(e,function(e){var t,n=u.parse(e.attr("style")),o=e.attr("color"),r=e.attr("face"),i=e.attr("size");o&&(n.color=o),r&&(n["font-family"]=r),i&&(n["font-size"]=a[parseInt(e.attr("size"),10)-1]),e.name="span",e.attr("style",u.serialize(n)),t=e,de(["color","face","size"],function(e){t.attr(e,null)})})})),n=r,e.addNodeFilter("strike",function(e){de(e,function(e){var t=n.parse(e.attr("style"));t["text-decoration"]="line-through",e.name="span",e.attr("style",n.serialize(t))})})}function Tp(e){var t,n=decodeURIComponent(e).split(","),e=/data:([^;]+)/.exec(n[0]);return{type:t=e?e[1]:t,data:n[1]}}function Dp(e,t){var n;try{n=atob(t)}catch(e){return Y.none()}for(var o=new Uint8Array(n.length),r=0;r<o.length;r++)o[r]=n.charCodeAt(r);return Y.some(new Blob([o],{type:e}))}function Ap(e){return 0===e.indexOf("blob:")?(r=e,new no(function(e,t){function n(){t("Cannot convert "+r+" to Blob. Resource might not exist or is inaccessible.")}try{var o=new XMLHttpRequest;o.open("GET",r,!0),o.responseType="blob",o.onload=function(){200===this.status?e(this.response):n()},o.onerror=n,o.send()}catch(e){n()}})):0===e.indexOf("data:")?(o=e,new no(function(e){var t=Tp(o),n=t.type,t=t.data;Dp(n,t).fold(function(){return e(new Blob([]))},e)})):null;var r,o}function Bp(e){return(e||"blobid")+qp++}var Np=Kt.each,Rp=function(e,t,n){Np(e.childNodes,function(e){_g(e)&&(t(e)&&n(e),e.hasChildNodes()&&Rp(e,t,n))})},Mp=e([{keep:[]},{rename:["name"]},{removed:[]}]),Ip=/^(src|href|style)$/,Fp=Kt.each,Pp=Us,Lp=function(a,c,s,e,l){function r(e){var n,o,r,i,u,t=(o=c,r=s,i=l,de($s((n=a).dom,e.parentNode).reverse(),function(e){var t;u||"_start"===e.id||"_end"===e.id||(t=bd(n,e,o,r,i))&&!1!==t.split&&(u=e)}),u);return function(e,t,n,o,r,i,u,a){var c,s,l=e.dom;if(n){for(var f=n.parentNode,d=o.parentNode;d&&d!==f;d=d.parentNode){for(var m=l.clone(d,!1),g=0;g<t.length&&null!==(m=function(t,e,n){return Lg(t,e,a,n,n).fold(_(n),function(e){return t.dom.createFragment().appendChild(n),t.dom.rename(n,e)},_(null))}(e,t[g],m));g++);m&&(c&&m.appendChild(c),s=s||m,c=m)}!i||u.mixed&&l.isBlock(n)||(o=l.split(n,o)),c&&(r.parentNode.insertBefore(c,r),s.appendChild(r),u.inline&&Dg(l,u,0,c))}return o}(a,f,t,e,e,!0,d,s)}function i(e){var t,n=m.get(e?"_start":"_end"),o=n[e?"firstChild":"lastChild"];return Rs(t=o)&&yn(t)&&("_start"===t.id||"_end"===t.id)&&(o=o[e?"firstChild":"lastChild"]),wn(o)&&0===o.data.length&&(o=e?n.previousSibling||n.nextSibling:n.nextSibling||n.previousSibling),m.remove(n,!0),o}function t(e){var t=al(a,e,f,e.collapsed);if(d.split){if(t=af(t),(o=Rg(a,t,!0))!==(e=Rg(a,t))){if(o=Mg(o,!0),e=Mg(e,!1),Ng(m,o,e)){var n=Y.from(o.firstChild).getOr(o);return r(Fg(m,n,!0,"span",{id:"_start","data-mce-type":"bookmark"})),void i(!0)}if(Ng(m,e,o))return n=Y.from(e.lastChild).getOr(e),r(Fg(m,n,!1,"span",{id:"_end","data-mce-type":"bookmark"})),void i(!1);var o=Ig(m,o,"span",{id:"_start","data-mce-type":"bookmark"}),e=Ig(m,e,"span",{id:"_end","data-mce-type":"bookmark"}),n=m.createRng();n.setStartAfter(o),n.setEndBefore(e),sl(m,n,function(e){de(e,function(e){Rs(e)||Rs(e.parentNode)||r(e)})}),r(o),r(e),o=i(!0),e=i()}else o=e=r(o);t.startContainer=o.parentNode||o,t.startOffset=m.nodeIndex(o),t.endContainer=e.parentNode||e,t.endOffset=m.nodeIndex(e)+1}sl(m,t,function(e){de(e,function(t){g(t),de(["underline","line-through","overline"],function(e){yn(t)&&a.dom.getStyle(t,"text-decoration")===e&&t.parentNode&&Gs(m,t.parentNode)===e&&Vg(a,{deep:!1,exact:!0,inline:"span",styles:{textDecoration:e}},null,t)})})})}var n,f=a.formatter.get(c),d=f[0],u=!0,m=a.dom,o=a.selection,g=function(e){var t,n;yn(e)&&m.getContentEditable(e)&&(t=u,u="true"===m.getContentEditable(e),n=!0);var o=ge(e.childNodes);if(u&&!n)for(var r=0;r<f.length&&!Vg(a,f[r],s,e,e);r++);if(d.deep&&o.length){for(r=0;r<o.length;r++)g(o[r]);n&&(u=t)}};if(e)Ps(e)?((n=m.createRng()).setStartBefore(e),n.setEndAfter(e),t(n)):t(e);else if("false"!==m.getContentEditable(o.getNode()))o.isCollapsed()&&d.inline&&!dl(a).length?qm(a,c,s,l):(vl(o,!0,function(){hl(a,t)}),d.inline&&Jf(a,c,s,o.getStart())&&Ls(m,o,o.getRng()),a.nodeChanged());else{e=o.getNode();for(var p=0;p<f.length&&(!f[p].ceFalseOverride||!Vg(a,f[p],s,e,e));p++);}},Vp=Kt.each,Hp=Kt.each,zp=F,jp=function(b,y,x,o){function w(n,e){var t;e=e||S,n&&(e.onformat&&e.onformat(n,e,x,o),Hp(e.styles,function(e,t){u.setStyle(n,t,js(e,x))}),!e.styles||(t=u.getAttrib(n,"style"))&&u.setAttrib(n,"data-mce-style",t),Hp(e.attributes,function(e,t){u.setAttrib(n,t,js(e,x))}),Hp(e.classes,function(e){e=js(e,x),u.hasClass(n,e)||u.addClass(n,e)}))}function d(e,t){var n=!1;return!!Ks(S)&&(Hp(e,function(e){if(!("collapsed"in e&&e.collapsed!==i))return u.is(t,e.selector)&&!ks(t)?(w(t,e),!(n=!0)):void 0}),n)}function n(h,e,t,c){var v=[],s=!0,l=S.inline||S.block,f=h.create(l);w(f),sl(h,e,function(e){var u,a=function(e){var t=!1,n=s,o=e.nodeName.toLowerCase(),r=e.parentNode.nodeName.toLowerCase();if(yn(e)&&h.getContentEditable(e)&&(n=s,s="true"===h.getContentEditable(e),t=!0),On(e)&&!function(e,t,n,o){if(e.getParam("format_empty_lines",!1,"boolean")&&Js(t)){t=we(we({},e.schema.getTextBlockElements()),{td:{},th:{},li:{},dt:{},dd:{},figcaption:{},caption:{},details:{},summary:{}}),e=Pm(Jt.fromDom(n),function(e){return ks(e.dom)});return F(t,o)&&Fo(Jt.fromDom(n.parentNode),!1)&&!e}}(b,S,e,r))return u=null,void(Ys(S)&&h.remove(e));if(S.wrapper&&bd(b,e,y,x))u=null;else{if(s&&!t&&Ys(S)&&!S.wrapper&&Hs(b,o)&&zs(b,r,l)){var i=h.rename(e,l);return w(i),v.push(i),void(u=null)}if(Ks(S)){i=d(C,e);if(!zp(S,"inline")||i)return void(u=null)}!s||t||!zs(b,l,o)||!zs(b,r,l)||!c&&3===e.nodeType&&1===e.nodeValue.length&&65279===e.nodeValue.charCodeAt(0)||ks(e)||zp(S,"inline")&&h.isBlock(e)?(u=null,Hp(Kt.grep(e.childNodes),a),t&&(s=n),u=null):(u||(u=h.clone(f,!1),e.parentNode.insertBefore(u,e),v.push(u)),u.appendChild(e))}};Hp(e,a)}),!0===S.links&&Hp(v,function(e){var t=function(e){"A"===e.nodeName&&w(e,S),Hp(Kt.grep(e.childNodes),t)};t(e)}),Hp(v,function(e){var n,o,t,r,i,u,a,c,s,l,f,d,m,g,p=(n=0,Hp(e.childNodes,function(e){var t;k(t=e)&&wn(t)&&0===t.length||Rs(e)||n++}),n);!(1<v.length)&&h.isBlock(e)||0!==p?(Js(S)||S.wrapper)&&(S.exact||1!==p||(c=e,g=!1,Hp(c.childNodes,function(e){if((t=e)&&1===t.nodeType&&!Rs(t)&&!ks(t)&&!ct(t))return g=e,!1;var t}),(l=g)&&!Rs(l)&&Yf(h,l,S)&&(s=h.clone(l,!1),w(s),h.replace(s,c,!0),h.remove(l,!0)),e=s||c),f=b,d=x,m=e,Vp(C,function(t){var o,e,n;Vp(f.dom.select(t.inline,m),function(e){_g(e)&&Vg(f,t,d,e,t.exact?e:null)}),o=f.dom,(e=t).clear_child_styles&&(n=e.links?"*:not(a)":"*",Np(o.select(n,m),function(n){_g(n)&&Np(e.styles,function(e,t){o.setStyle(n,t,"")})}))}),r=S,bd(t=b,(a=e).parentNode,i=y,u=x)&&Vg(t,r,u,a)||r.merge_with_parents&&t.dom.getParent(a.parentNode,function(e){if(bd(t,e,i,u))return Vg(t,r,u,a),!0}),p=e,S.styles&&S.styles.backgroundColor&&Rp(p,Ag(h,"fontSize"),Bg(h,"backgroundColor",js(S.styles.backgroundColor,x))),o=h,l=e,s=function(e){var t;1===e.nodeType&&e.parentNode&&1===e.parentNode.nodeType&&(t=Gs(o,e.parentNode),o.getStyle(e,"color")&&t?o.setStyle(e,"text-decoration",t):o.getStyle(e,"text-decoration")===t&&o.setStyle(e,"text-decoration",null))},S.styles&&(S.styles.color||S.styles.textDecoration)&&(Kt.walk(l,s,"childNodes"),s(l)),p=h,s=e,"sub"!==(l=S).inline&&"sup"!==l.inline||(Rp(s,Ag(p,"fontSize"),Bg(p,"fontSize","")),p.remove(p.select("sup"===l.inline?"sub":"sup",s),!0)),Dg(h,S,0,e)):h.remove(e,!0)})}var e,t,r,C=b.formatter.get(y),S=C[0],i=!o&&b.selection.isCollapsed(),u=b.dom,a=b.selection;if("false"!==u.getContentEditable(a.getNode()))S&&(o?Ps(o)?d(C,o)||((t=u.createRng()).setStartBefore(o),t.setEndAfter(o),n(u,al(b,t,C),0,!0)):n(u,o,0,!0):i&&Js(S)&&!dl(b).length?function(e,t,n){var o,r=e.selection,i=r.getRng(),u=i.startOffset,a=i.startContainer.nodeValue,c=Os(e.getBody(),r.getStart());c&&(o=Vm(c));var s,l,f=/[^\s\u00a0\u00ad\u200b\ufeff]/;a&&0<u&&u<a.length&&f.test(a.charAt(u))&&f.test(a.charAt(u-1))?(l=r.getBookmark(),i.collapse(!0),s=al(e,i,e.formatter.get(t)),s=af(s),e.formatter.apply(t,n,s),r.moveToBookmark(l)):(c&&o.nodeValue===wg||(s=e.getDoc(),l=Hm(!0).dom,o=(c=s.importNode(l,!0)).firstChild,i.insertNode(c),u=1),e.formatter.apply(t,n,c),r.setCursorLocation(o,u))}(b,y,x):(e=a.getNode(),t=C[0],b.settings.forced_root_block||!t.defaultBlock||u.getParent(e,u.isBlock)||jp(b,t.defaultBlock),a.setRng(Em(a.getRng())),vl(a,!0,function(e){hl(b,function(e,t){e=t?e:al(b,e,C);n(u,e)})}),Ls(u,a,a.getRng()),b.nodeChanged()),r=b,Og(Sg[y],function(e){e(r)}));else{o=a.getNode();for(var c=0,s=C.length;c<s;c++){var l=C[c];if(l.ceFalseOverride&&Ks(l)&&u.is(o,l.selector))return void w(o,l)}}},Up=function(e,n,o,r){return M(e,function(e,t){return!!ye(n,t)||(de(e,function(e){e(!1,{node:o,format:t,parents:r})}),!1)}).t},Wp=zu(Y.none()),qp=0;function Gp(o,s){var r={};return{findAll:function(e,n){n=n||q;e=me(e?ge(e.getElementsByTagName("img")):[],function(e){var t=e.src;return!!$t.fileApi&&!e.hasAttribute("data-mce-bogus")&&!e.hasAttribute("data-mce-placeholder")&&!(!t||t===$t.transparentSrc)&&(0===t.indexOf("blob:")?!o.isUploaded(t)&&n(e):0===t.indexOf("data:")&&n(e))}),e=E(e,function(c){if(void 0!==r[c.src])return new no(function(t){r[c.src].then(function(e){return"string"==typeof e?e:void t({image:c,blobInfo:e.blobInfo})})});var e=new no(function(e,t){var o,r,i,n,u,a;o=s,i=e,n=t,0!==(r=c).src.indexOf("blob:")?(t=(e=Tp(r.src)).data,e=e.type,u=t,(a=o.getByData(u,e))?i({image:r,blobInfo:a}):Ap(r.src).then(function(e){a=o.create(Bp(),e,u),o.add(a),i({image:r,blobInfo:a})},function(e){n(e)})):(a=o.getByUri(r.src))?i({image:r,blobInfo:a}):Ap(r.src).then(function(t){var n=t;new no(function(e){var t=new FileReader;t.onloadend=function(){e(t.result)},t.readAsDataURL(n)}).then(function(e){u=Tp(e).data,a=o.create(Bp(),t,u),o.add(a),i({image:r,blobInfo:a})})},function(e){n(e)})}).then(function(e){return delete r[e.image.src],e}).catch(function(e){return delete r[c.src],e});return r[c.src]=e});return no.all(e)}}}function $p(e,t,n,o){(e.padd_empty_with_br||t.insert)&&n[o.name]?o.empty().append(new xd("br",1)).shortEnded=!0:o.empty().append(new xd("#text",3)).value=Qo}function Xp(e,t){return e&&e.firstChild&&e.firstChild===e.lastChild&&e.firstChild.name===t}function Yp(t,e,n,o){return o.isEmpty(e,n,function(e){return(e=t.getElementRule(e.name))&&e.paddEmpty})}function Kp(e,o){function t(t){var e,n=t.attr("src");(e=t).attr("src")===$t.transparentSrc||e.attr("data-mce-placeholder")||t.attr("data-mce-bogus")||((n=/data:([^;]+);base64,([a-z0-9\+\/=]+)/i.exec(n))?Y.some({type:n[1],data:decodeURIComponent(n[2])}):Y.none()).filter(function(){return function(e,t){if(t.images_dataimg_filter){var n=new Image;return n.src=e.attr("src"),ve(e.attributes.map,function(e,t){n.setAttribute(t,e)}),t.images_dataimg_filter(n)}return!0}(t,o)}).bind(function(e){var t=e.type,n=e.data;return Y.from(r.getByData(n,t)).orThunk(function(){return Dp(t,n).map(function(e){e=r.create(Bp(),e,n);return r.add(e),e})})}).each(function(e){t.attr("src",e.blobUri())})}var r=o.blob_cache;r&&e.addAttributeFilter("src",function(e){return de(e,t)})}function Jp(_,E){void 0===E&&(E=Fr());var T={},D=[],A={},B={};function N(e){var t,n,o=e.name;o in T&&((n=A[o])?n.push(e):A[o]=[e]),t=D.length;for(;t--;)(o=D[t].name)in e.attributes.map&&((n=B[o])?n.push(e):B[o]=[e]);return e}(_=_||{}).validate=!("validate"in _)||_.validate,_.root_name=_.root_name||"body";var e,p,h,t={schema:E,addAttributeFilter:function(e,n){mh(gh(e),function(e){for(var t=0;t<D.length;t++)if(D[t].name===e)return void D[t].callbacks.push(n);D.push({name:e,callbacks:[n]})})},getAttributeFilters:function(){return[].concat(D)},addNodeFilter:function(e,n){mh(gh(e),function(e){var t=T[e];t||(T[e]=t=[]),t.push(n)})},getNodeFilters:function(){var e,t=[];for(e in T)T.hasOwnProperty(e)&&t.push({name:e,callbacks:T[e]});return t},filterNode:N,parse:function(e,i){var t,n,o,r,u,a,c,s,l=[];i=i||{},A={},B={};function f(e,t){var n=new xd(e,t);return e in T&&((t=A[e])?t.push(n):A[e]=[n]),n}function d(e){for(var t,n=E.getBlockElements(),o=e.prev;o&&3===o.type;){if(0<(t=o.value.replace(w,"")).length)return o.value=t,0;if(t=o.next){if(3===t.type&&t.value.length){o=o.prev;continue}if(!n[t.name]&&"script"!==t.name&&"style"!==t.name){o=o.prev;continue}}t=o.prev,o.remove(),o=t}}var m=ph(dh("script,style,head,html,body,title,meta,param"),E.getBlockElements()),g=E.getNonEmptyElements(),p=E.children,h=_.validate,v=("forced_root_block"in i?i:_).forced_root_block,b=!1===v?"":!0===v?"p":v,y=E.getWhiteSpaceElements(),x=/^[ \t\r\n]+/,w=/[ \t\r\n]+$/,C=/[ \t\r\n]+/g,S=/^[ \t\r\n]+$/,k=y.hasOwnProperty(i.context)||y.hasOwnProperty(_.root_name),v=$m({validate:h,allow_html_data_urls:_.allow_html_data_urls,allow_svg_data_urls:_.allow_svg_data_urls,allow_script_urls:_.allow_script_urls,allow_conditional_comments:_.allow_conditional_comments,preserve_cdata:_.preserve_cdata,self_closing_elements:function(e){var t,n={};for(t in e)"li"!==t&&"p"!==t&&(n[t]=e[t]);return n}(E.getSelfClosingElements()),cdata:function(e){s.append(f("#cdata",4)).value=e},text:function(e,t){var n;k||(e=e.replace(C," "),(n=s.lastChild)&&(m[n.name]||"br"===n.name)&&(e=e.replace(x,""))),0!==e.length&&((n=f("#text",3)).raw=!!t,s.append(n).value=e)},comment:function(e){s.append(f("#comment",8)).value=e},pi:function(e,t){s.append(f(e,7)).value=t,d(s)},doctype:function(e){s.append(f("#doctype",10)).value=e,d(s)},start:function(e,t,n){var o,r,i,u=h?E.getElementRule(e):{};if(u){for((o=f(u.outputName||e,1)).attributes=t,o.shortEnded=n,s.append(o),(u=p[s.name])&&p[o.name]&&!u[o.name]&&l.push(o),r=D.length;r--;)(i=D[r].name)in t.map&&((a=B[i])?a.push(o):B[i]=[o]);m[e]&&d(o),n||(s=o),!k&&y[e]&&(k=!0)}},end:function(e){var t,n,o,r=h?E.getElementRule(e):{};if(r){if(m[e]&&!k){if((t=s.firstChild)&&3===t.type)if(0<(n=t.value.replace(x,"")).length)t.value=n,t=t.next;else for(o=t.next,t.remove(),t=o;t&&3===t.type;)n=t.value,o=t.next,0!==n.length&&!S.test(n)||(t.remove(),t=o),t=o;if((t=s.lastChild)&&3===t.type)if(0<(n=t.value.replace(w,"")).length)t.value=n,t=t.prev;else for(o=t.prev,t.remove(),t=o;t&&3===t.type;)n=t.value,o=t.prev,0!==n.length&&!S.test(n)||(t.remove(),t=o),t=o}if(k&&y[e]&&(k=!1),r.removeEmpty&&Yp(E,g,y,s))return e=s.parent,m[s.name]?s.empty().remove():s.unwrap(),void(s=e);r.paddEmpty&&(Xp(r=s,"#text")&&r.firstChild.value===Qo||Yp(E,g,y,s))&&$p(_,i,m,s),s=s.parent}}},E),O=s=new xd(i.context||_.root_name,11);if(v.parse(e,i.format),h&&l.length&&(i.context?i.invalid=!0:function(e){for(var t,n,o,r,i,u,a,c,s,l,f=dh("tr,td,th,tbody,thead,tfoot,table"),d=E.getNonEmptyElements(),m=E.getWhiteSpaceElements(),g=E.getTextBlockElements(),p=E.getSpecialElements(),h=0;h<e.length;h++)if((t=e[h]).parent&&!t.fixed)if(g[t.name]&&"li"===t.parent.name){for(s=t.next;s&&g[s.name];)s.name="li",s.fixed=!0,t.parent.insert(s,t.parent),s=s.next;t.unwrap(t)}else{for(o=[t],n=t.parent;n&&!E.isValidChild(n.name,t.name)&&!f[n.name];n=n.parent)o.push(n);if(n&&1<o.length){for(o.reverse(),r=i=N(o[0].clone()),c=0;c<o.length-1;c++){for(E.isValidChild(i.name,o[c].name)?(u=N(o[c].clone()),i.append(u)):u=i,a=o[c].firstChild;a&&a!==o[c+1];)l=a.next,u.append(a),a=l;i=u}Yp(E,d,m,r)?n.insert(t,o[0],!0):(n.insert(r,o[0],!0),n.insert(t,r)),n=o[0],(Yp(E,d,m,n)||Xp(n,"br"))&&n.empty().remove()}else if(t.parent){if("li"===t.name){if((s=t.prev)&&("ul"===s.name||"ol"===s.name)){s.append(t);continue}if((s=t.next)&&("ul"===s.name||"ol"===s.name)){s.insert(t,s.firstChild,!0);continue}t.wrap(N(new xd("ul",1)));continue}E.isValidChild(t.parent.name,"div")&&E.isValidChild("div",t.name)?t.wrap(N(new xd("div",1))):p[t.name]?t.empty().remove():t.unwrap()}}}(l)),b&&("body"===O.name||i.isRootContent)&&function(){function e(e){e&&((o=e.firstChild)&&3===o.type&&(o.value=o.value.replace(x,"")),(o=e.lastChild)&&3===o.type&&(o.value=o.value.replace(w,"")))}var t,n,o=O.firstChild;if(E.isValidChild(O.name,b.toLowerCase())){for(;o;)t=o.next,3===o.type||1===o.type&&"p"!==o.name&&!m[o.name]&&!o.attr("data-mce-type")?(n||((n=f(b,1)).attr(_.forced_root_block_attrs),O.insert(n,o)),n.append(o)):(e(n),n=null),o=t;e(n)}}(),!i.invalid){for(c in A)if(A.hasOwnProperty(c)){for(a=T[c],r=(t=A[c]).length;r--;)t[r].parent||t.splice(r,1);for(n=0,o=a.length;n<o;n++)a[n](t,c,i)}for(n=0,o=D.length;n<o;n++)if((a=D[n]).name in B){for(r=(t=B[a.name]).length;r--;)t[r].parent||t.splice(r,1);for(r=0,u=a.callbacks.length;r<u;r++)a.callbacks[r](t,a.name,i)}}return O}};return p=_,h=(e=t).schema,p.remove_trailing_brs&&e.addNodeFilter("br",function(e,t,n){var o,r,i,u,a,c,s,l,f=e.length,d=Kt.extend({},h.getBlockElements()),m=h.getNonEmptyElements(),g=h.getWhiteSpaceElements();for(d.body=1,o=0;o<f;o++)if(i=(r=e[o]).parent,d[r.parent.name]&&r===i.lastChild){for(a=r.prev;a;){if("span"!==(c=a.name)||"bookmark"!==a.attr("data-mce-type")){"br"===c&&(r=null);break}a=a.prev}r&&(r.remove(),Yp(h,m,g,i)&&(s=h.getElementRule(i.name))&&(s.removeEmpty?i.remove():s.paddEmpty&&$p(p,n,d,i)))}else{for(u=r;i&&i.firstChild===u&&i.lastChild===u&&!d[(u=i).name];)i=i.parent;u===i&&!0!==p.padd_empty_with_br&&((l=new xd("#text",3)).value=Qo,r.replace(l))}}),e.addAttributeFilter("href",function(e){var t=e.length;if(!p.allow_unsafe_link_target)for(;t--;){var n=e[t];"a"===n.name&&"_blank"===n.attr("target")&&n.attr("rel",(n=(n=n.attr("rel"))?Kt.trim(n):"",/\b(noopener)\b/g.test(n)?n:n.split(" ").filter(function(e){return 0<e.length}).concat(["noopener"]).sort().join(" ")))}}),p.allow_html_in_named_anchor||e.addAttributeFilter("id,name",function(e){for(var t,n,o,r,i=e.length;i--;)if("a"===(r=e[i]).name&&r.firstChild&&!r.attr("href"))for(o=r.parent,t=r.lastChild;n=t.prev,o.insert(t,r),t=n;);}),p.fix_list_elements&&e.addNodeFilter("ul,ol",function(e){for(var t,n,o=e.length;o--;)"ul"!==(n=(t=e[o]).parent).name&&"ol"!==n.name||(t.prev&&"li"===t.prev.name?t.prev.append(t):((n=new xd("li",1)).attr("style","list-style-type: none"),t.wrap(n)))}),p.validate&&h.getValidClasses()&&e.addAttributeFilter("class",function(e){for(var t,n,o,r,i,u,a,c=e.length,s=h.getValidClasses();c--;){for(n=(t=e[c]).attr("class").split(" "),i="",o=0;o<n.length;o++)r=n[o],a=!1,(u=s["*"])&&u[r]&&(a=!0),u=s[t.name],(a=!a&&u&&u[r]?!0:a)&&(i&&(i+=" "),i+=r);i.length||(i=null),t.attr("class",i)}}),Kp(e,p),_.inline_styles&&Ep(t,_),t}function Qp(e,t,n){-1===Kt.inArray(t,n)&&(e.addAttributeFilter(n,function(e,t){for(var n=e.length;n--;)e[n].attr(t,null)}),t.push(n))}function Zp(u,a){var e=["data-mce-selected"],c=a&&a.dom?a.dom:Iu.DOM,s=a&&a.schema?a.schema:Fr(u);u.entity_encoding=u.entity_encoding||"named",u.remove_trailing_brs=!("remove_trailing_brs"in u)||u.remove_trailing_brs;var t,l=Jp(u,s),f=u,d=c;return(t=l).addAttributeFilter("data-mce-tabindex",function(e,t){for(var n,o=e.length;o--;)(n=e[o]).attr("tabindex",n.attr("data-mce-tabindex")),n.attr(t,null)}),t.addAttributeFilter("src,href,style",function(e,t){for(var n,o,r=e.length,i="data-mce-"+t,u=f.url_converter,a=f.url_converter_scope;r--;)void 0!==(o=(n=e[r]).attr(i))?(n.attr(t,0<o.length?o:null),n.attr(i,null)):(o=n.attr(t),"style"===t?o=d.serializeStyle(d.parseStyle(o),n.name):u&&(o=u.call(a,o,t,n.name)),n.attr(t,0<o.length?o:null))}),t.addAttributeFilter("class",function(e){for(var t,n,o=e.length;o--;)(t=e[o]).attr("class")&&(n=t.attr("class").replace(/(?:^|\s)mce-item-\w+(?!\S)/g,""),t.attr("class",0<n.length?n:null))}),t.addAttributeFilter("data-mce-type",function(e,t,n){for(var o,r=e.length;r--;)"bookmark"!==(o=e[r]).attr("data-mce-type")||n.cleanup||(Y.from(o.firstChild).exists(function(e){return!wo(e.value)})?o.unwrap():o.remove())}),t.addNodeFilter("noscript",function(e){for(var t,n=e.length;n--;)(t=e[n].firstChild)&&(t.value=Or.decode(t.value))}),t.addNodeFilter("script,style",function(e,t){for(var n,o,r,i=e.length,u=function(e){return e.replace(/(<!--\[CDATA\[|\]\]-->)/g,"\n").replace(/^[\r\n]*|[\r\n]*$/g,"").replace(/^\s*((<!--)?(\s*\/\/)?\s*<!\[CDATA\[|(<!--\s*)?\/\*\s*<!\[CDATA\[\s*\*\/|(\/\/)?\s*<!--|\/\*\s*<!--\s*\*\/)\s*[\r\n]*/gi,"").replace(/\s*(\/\*\s*\]\]>\s*\*\/(-->)?|\s*\/\/\s*\]\]>(-->)?|\/\/\s*(-->)?|\]\]>|\/\*\s*-->\s*\*\/|\s*-->\s*)\s*$/g,"")};i--;)o=(n=e[i]).firstChild?n.firstChild.value:"","script"===t?((r=n.attr("type"))&&n.attr("type","mce-no/type"===r?null:r.replace(/^mce\-/,"")),"xhtml"===f.element_format&&0<o.length&&(n.firstChild.value="// <![CDATA[\n"+u(o)+"\n// ]]>")):"xhtml"===f.element_format&&0<o.length&&(n.firstChild.value="\x3c!--\n"+u(o)+"\n--\x3e")}),t.addNodeFilter("#comment",function(e){for(var t,n=e.length;n--;)t=e[n],f.preserve_cdata&&0===t.value.indexOf("[CDATA[")?(t.name="#cdata",t.type=4,t.value=d.decode(t.value.replace(/^\[CDATA\[|\]\]$/g,""))):0===t.value.indexOf("mce:protected ")&&(t.name="#text",t.type=3,t.raw=!0,t.value=unescape(t.value).substr(14))}),t.addNodeFilter("xml:namespace,input",function(e,t){for(var n,o=e.length;o--;)7===(n=e[o]).type?n.remove():1===n.type&&("input"!==t||n.attr("type")||n.attr("type","text"))}),t.addAttributeFilter("data-mce-type",function(e){de(e,function(e){"format-caret"===e.attr("data-mce-type")&&(e.isEmpty(t.schema.getNonEmptyElements())?e.remove():e.unwrap())})}),t.addAttributeFilter("data-mce-src,data-mce-href,data-mce-style,data-mce-selected,data-mce-expando,data-mce-type,data-mce-resize,data-mce-placeholder",function(e,t){for(var n=e.length;n--;)e[n].attr(t,null)}),{schema:s,addNodeFilter:l.addNodeFilter,addAttributeFilter:l.addAttributeFilter,serialize:function(e,t){var n,o=we({format:"html"},t=void 0===t?{}:t),r=(t=(r=e,t=n=o,(e=a)&&e.hasEventListeners("PreProcess")&&!t.no_events?function(e,t,n){var o,r,i=e.dom;t=t.cloneNode(!0);var u=document.implementation;return u.createHTMLDocument&&(o=u.createHTMLDocument(""),Kt.each("BODY"===t.nodeName?t.childNodes:[t],function(e){o.body.appendChild(o.importNode(e,!0))}),t="BODY"!==t.nodeName?o.body.firstChild:o.body,r=i.doc,i.doc=o),e=e,n=we(we({},n),{node:t}),e.fire("PreProcess",n),r&&(i.doc=r),t}(e,r,n):r),n=Co((e=o).getInner?t.innerHTML:c.getOuterHTML(t)),e.selection||Ko(Jt.fromDom(t))?n:Kt.trim(n)),i=(e=l,t=r,r=(n=o).selection?we({forced_root_block:!1},n):n,!(n=function(e){return e&&"br"===e.name})(r=(t=e.parse(t,r)).lastChild)||n(i=r.prev)&&(r.remove(),i.remove()),t);return"tree"===o.format?i:(t=a,o=o,i=i=i,i=Sd(u,s).serialize(i),o.no_events||!t?i:(t=t,i=we(we({},o),{content:i}),t.fire("PostProcess",i).content))},addRules:function(e){s.addValidElements(e)},setRules:function(e){s.setValidElements(e)},addTempAttr:w(Qp,l,e),getTempAttrs:function(){return e},getNodeFilters:l.getNodeFilters,getAttributeFilters:l.getAttributeFilters}}function eh(e,t){return{schema:(t=Zp(e,t)).schema,addNodeFilter:t.addNodeFilter,addAttributeFilter:t.addAttributeFilter,serialize:t.serialize,addRules:t.addRules,setRules:t.setRules,addTempAttr:t.addTempAttr,getTempAttrs:t.getTempAttrs,getNodeFilters:t.getNodeFilters,getAttributeFilters:t.getAttributeFilters}}function th(e,t,n){return n=n=void 0===n?{}:n,bp(e).editor.setContent(t,n)}function nh(e){return Y.from(e).each(function(e){return e.destroy()})}function oh(e){return e=ne(e)?e.join(" "):e,e=E(Q(e)?e.split(" "):[],At),me(e,function(e){return 0<e.length})}function rh(e,t){return e.sections().hasOwnProperty(t)}function ih(e,t){return te(e,"toolbar_mode").orThunk(function(){return te(e,"toolbar_drawer").map(function(e){return!1===e?"wrap":e})}).getOr(t)}function uh(e,t,n,o){var r,i=oh(n.forced_plugins),u=oh(o.plugins),n=(a=rh(r=t,"mobile")?r.sections().mobile:{}).plugins?oh(a.plugins):u,a=(a=(r=t,a=u,t=n,(u=e)&&(0,e=(n=r).sections(),rh(n,"mobile")&&"mobile"===e.mobile.theme)?me(t,w(ee,Ch)):u&&rh(r,"mobile")?t:a),[].concat(oh(i)).concat(oh(a)));if($t.browser.isIE()&&ee(a,"rtc"))throw new Error("RTC plugin is not supported on IE 11.");return Kt.extend(o,{plugins:a.join(" ")})}function ah(e,t,n,o,r){var i,u,a=e?{mobile:(i=r.mobile||{},a=t,i={resize:!1,toolbar_mode:ih(i,"scrolling"),toolbar_sticky:!1},we(we(we({},Sh),i),a?{menubar:!1}:{}))}:{},c=(u=["mobile"],a=bh(a,r),r=M(a,function(e,t){return ee(u,t)}),a=r.t,r=r.f,{sections:_(a),settings:_(r)}),n=Kt.extend(n,o,c.settings(),e&&rh(c,"mobile")?function(e){void 0===e&&(e={});var t=c.sections(),t=t.hasOwnProperty("mobile")?t.mobile:{};return Kt.extend({},e,t)}():{},{validate:!0,external_plugins:(r=o,n=c.settings().external_plugins||{},r&&r.external_plugins?Kt.extend({},r.external_plugins,n):n)});return uh(e,c,o,n)}function ch(e,t,n){return Y.from(t.settings[n]).filter(e)}function sh(e,t,n){var o=Jt.fromDom(e.getBody()),r=e.inline?o:Jt.fromDom(ze(o).dom.documentElement),n=(i=(i=e.inline,o=t,e=n,n=(t=r).dom.getBoundingClientRect(),{x:o-(i?n.left+t.dom.clientLeft+Th(t):0),y:e-(i?n.top+t.dom.clientTop+Eh(t):0)})).x,t=i.y,r=Oh(i=r),i=_h(i);return 0<=n&&0<=t&&n<=r&&t<=i}var lh,fh,dh=Kt.makeMap,mh=Kt.each,gh=Kt.explode,ph=Kt.extend,hh=Iu.DOM,vh=Object.prototype.hasOwnProperty,bh=(lh=function(e,t){return Z(e)&&Z(t)?bh(e,t):t},function(){for(var e=new Array(arguments.length),t=0;t<e.length;t++)e[t]=arguments[t];if(0===e.length)throw new Error("Can't merge zero objects");for(var n={},o=0;o<e.length;o++){var r,i=e[o];for(r in i)vh.call(i,r)&&(n[r]=lh(n[r],i[r]))}return n}),Rt=Gt().deviceType,yh=Rt.isTouch(),xh=Rt.isPhone(),wh=Rt.isTablet(),Ch=["lists","autolink","autosave"],Sh={table_grid:!1,object_resizing:!1,resize:!1},kh=(fh={},{add:function(e,t){fh[e]=t},get:function(e){return fh[e]||{icons:{}}},has:function(e){return ye(fh,e)}}),K=function(e,t){return t.dom[e]},J=function(e,t){return parseInt(bt(t,e),10)},Oh=w(K,"clientWidth"),_h=w(K,"clientHeight"),Eh=w(J,"margin-top"),Th=w(J,"margin-left");function Dh(n){function o(){var e=n.theme;return e&&e.getNotificationManagerImpl?e.getNotificationManagerImpl():{open:e=function(){throw new Error("Theme did not provide a NotificationManager implementation.")},close:e,reposition:e,getArgs:e}}function r(){return Y.from(c[0])}function i(){0<c.length&&o().reposition(c)}function u(t){h(c,function(e){return e===t}).each(function(e){c.splice(e,1)})}function t(t,e){if(void 0===e&&(e=!0),!n.removed&&function(e){e=e.inline?e.getBody():e.getContentAreaContainer();return Y.from(e).map(Jt.fromDom).map(pn).getOr(!1)}(n))return e&&n.fire("BeforeOpenNotification",{notification:t}),D(c,function(e){return!((e=o().getArgs(e)).type!==t.type||e.text!==t.text||e.progressBar||e.timeout||t.progressBar||t.timeout)}).getOrThunk(function(){n.editorManager.setActive(n);var e=o().open(t,function(){u(e),i(),r().fold(function(){return n.focus()},function(e){return Jt.fromDom(e.getEl()).dom.focus()})});return c.push(e),i(),n.fire("OpenNotification",we({},e)),e})}var a,c=[];return(a=n).on("SkinLoaded",function(){var e=a.getParam("service_message");e&&t({text:e,type:"warning",timeout:0},!1)}),a.on("ResizeEditor ResizeWindow NodeChange",function(){mo.requestAnimationFrame(i)}),a.on("remove",function(){de(c.slice(),function(e){o().close(e)})}),{open:t,close:function(){r().each(function(e){o().close(e),u(e),i()})},getNotifications:function(){return c}}}function Ah(n){function o(){var e=n.theme;return e&&e.getWindowManagerImpl?e.getWindowManagerImpl():{open:e=function(){throw new Error("Theme did not provide a WindowManager implementation.")},openUrl:e,alert:e,confirm:e,close:e,getParams:e,setParams:e}}function r(e,t){return function(){return t?t.apply(e,arguments):void 0}}function i(t){n.fire("CloseWindow",{dialog:t}),0===(a=me(a,function(e){return e!==t})).length&&n.focus()}function u(e){n.editorManager.setActive(n),Bf(n);var t=e();return e=t,a.push(e),n.fire("OpenWindow",{dialog:e}),t}var a=[];return n.on("remove",function(){de(a,function(e){o().close(e)})}),{open:function(e,t){return u(function(){return o().open(e,t,i)})},openUrl:function(e){return u(function(){return o().openUrl(e,i)})},alert:function(e,t,n){o().alert(e,r(n||this,t))},confirm:function(e,t,n){o().confirm(e,r(n||this,t))},close:function(){Y.from(a[a.length-1]).each(function(e){o().close(e),i(e)})}}}function Bh(e,t){e.notificationManager.open({type:"error",text:t})}function Nh(e,t){e._skinLoaded?Bh(e,t):e.on("SkinLoaded",function(){Bh(e,t)})}function Rh(e,t,n){e.fire(t,{message:n}),console.error(n)}function Mh(e,t,n){return n?"Failed to load "+e+": "+n+" from url "+t:"Failed to load "+e+" url: "+t}function Ih(e,t,n){Rh(e,"PluginLoadError",Mh("plugin",t,n))}function Fh(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var o=window.console;o&&(o.error||o.log).apply(o,Ce([e],t))}var Ph=Oa.PluginManager,Lh=Oa.ThemeManager;function Vh(a,c){function r(e,n,o,t){var r=new XMLHttpRequest;r.open("POST",c.url),r.withCredentials=c.credentials,r.upload.onprogress=function(e){t(e.loaded/e.total*100)},r.onerror=function(){o("Image upload failed due to a XHR Transport error. Code: "+r.status)},r.onload=function(){var e,t;r.status<200||300<=r.status?o("HTTP Error: "+r.status):(t=JSON.parse(r.responseText))&&"string"==typeof t.location?n((e=c.basePath,t=t.location,e?e.replace(/\/$/,"")+"/"+t.replace(/^\//,""):t)):o("Invalid JSON: "+r.responseText)};var i=new FormData;i.append("file",e.blob(),e.filename()),r.send(i)}function s(e,t){return{url:t,blobInfo:e,status:!0}}function l(e,t,n){return{url:"",blobInfo:e,status:!1,error:{message:t,options:n}}}function f(e,t){Kt.each(d[e],function(e){e(t)}),delete d[e]}var d={};return!1===ae(c.handler)&&(c.handler=r),{upload:function(e,t){return c.url||c.handler!==r?(n=e,o=t,n=Kt.grep(e,function(e){return!a.isUploaded(e.blobUri())}),no.all(Kt.map(n,function(e){return a.isPending(e.blobUri())?(t=e.blobUri(),new no(function(e){d[t]=d[t]||[],d[t].push(e)})):(r=e,i=c.handler,u=o,a.markPending(r.blobUri()),new no(function(n){var t;try{var o=function(){t&&t.close()};i(r,function(e){o(),a.markUploaded(r.blobUri(),e),f(r.blobUri(),s(r,e)),n(s(r,e))},function(e,t){t=t||{};o(),a.removeFailed(r.blobUri()),f(r.blobUri(),l(r,e,t)),n(l(r,e,t))},function(e){e<0||100<e||(t=t||u()).progressBar.value(e)})}catch(e){n(l(r,e.message,{}))}}));var r,i,u,t}))):new no(function(e){e([])});var n,o}}}function Hh(e){return e+jh+++(e=function(){return Math.round(4294967295*Math.random()).toString(36)},"s"+(new Date).getTime().toString(36)+e()+e()+e())}function zh(c){function n(t){return function(e){return c.selection?t(e):[]}}function r(e,t,n){for(var o=0;-1!==(o=e.indexOf(t,o))&&(e=e.substring(0,o)+n+e.substr(o+t.length),o+=n.length-t.length+1),-1!==o;);return e}function o(e,t,n){var o='src="'+n+'"'+(n===$t.transparentSrc?' data-mce-placeholder="1"':"");return e=r(e,'src="'+t+'"',o),r(e,'data-mce-src="'+t+'"','data-mce-src="'+n+'"')}function s(t,n){de(c.undoManager.data,function(e){"fragmented"===e.type?e.fragments=E(e.fragments,function(e){return o(e,t,n)}):e.content=o(e.content,t,n)})}function i(){return c.notificationManager.open({text:c.translate("Image uploading..."),type:"info",timeout:-1,progressBar:!0})}function t(t){return m=m||Vh(w,{url:c.getParam("images_upload_url","","string"),basePath:c.getParam("images_upload_base_path","","string"),credentials:c.getParam("images_upload_credentials",!1,"boolean"),handler:c.getParam("images_upload_handler",null,"function")}),O().then(n(function(a){var e=E(a,function(e){return e.blobInfo});return m.upload(e,i).then(n(function(e){var u=[],e=E(e,function(e,t){var n,o,r=a[t].blobInfo,i=a[t].image;return e.status&&c.getParam("images_replace_blob_uris",!0,"boolean")?(x.removeByUri(i.src),n=i,t=e.url,o=c.convertURL(t,"src"),s(n.src,t),c.$(n).attr({src:c.getParam("images_reuse_filename",!1,"boolean")?t+(-1===t.indexOf("?")?"?":"&")+(new Date).getTime():t,"data-mce-src":o})):e.error&&(e.error.options.remove&&(s(i.getAttribute("src"),$t.transparentSrc),u.push(i)),o=e.error.message,Nh(c,qu.translate(["Failed to upload image: {0}",o]))),{element:i,status:e.status,uploadUri:e.url,blobInfo:r}});return 0<e.length&&S.fireIfChanged(),0<u.length&&(vp(c)?console.error("Removing images on failed uploads is currently unsupported for RTC"):c.undoManager.transact(function(){de(u,function(e){c.dom.remove(e),x.removeByUri(e.src)})})),t&&t(e),e}))}))}function e(t){return!1!==A(C,function(e){return e(t)})&&(0!==t.getAttribute("src").indexOf("data:")||c.getParam("images_dataimg_filter",q,"function")(t))}function u(e){return e.replace(/src="(blob:[^"]+)"/g,function(e,n){var t=w.getResultUri(n);if(t)return'src="'+t+'"';t=x.getByUri(n);return(t=t||T(c.editorManager.get(),function(e,t){return e||t.editorUpload&&t.editorUpload.blobCache.getByUri(n)},null))?'src="data:'+t.blob().type+";base64,"+t.base64()+'"':e})}var a,l,f,d,m,g,p,h,v,b,y,x=(a=[],l=function(e){if(!e.blob||!e.base64)throw new Error("blob and base64 representations of the image are required for BlobInfo to be created");var t=e.id||Hh("blobid"),n=e.name||t,o=e.blob;return{id:_(t),name:_(n),filename:_(e.filename||n+"."+({"image/jpeg":"jpg","image/jpg":"jpg","image/gif":"gif","image/png":"png","image/apng":"apng","image/avif":"avif","image/svg+xml":"svg","image/webp":"webp","image/bmp":"bmp","image/tiff":"tiff"}[o.type.toLowerCase()]||"dat")),blob:_(o),base64:_(e.base64),blobUri:_(e.blobUri||URL.createObjectURL(o)),uri:_(e.uri)}},{create:function(e,t,n,o,r){if(Q(e))return l({id:e,name:o,filename:r,blob:t,base64:n});if(Z(e))return l(e);throw new Error("Unknown input type")},add:function(e){d(e.id())||a.push(e)},get:d=function(t){return f(function(e){return e.id()===t})},getByUri:function(t){return f(function(e){return e.blobUri()===t})},getByData:function(t,n){return f(function(e){return e.base64()===t&&e.blob().type===n})},findFirst:f=function(e){return D(a,e).getOrUndefined()},removeByUri:function(t){a=me(a,function(e){return e.blobUri()!==t||(URL.revokeObjectURL(e.blobUri()),!1)})},destroy:function(){de(a,function(e){URL.revokeObjectURL(e.blobUri())}),a=[]}}),w=(p={},h=function(e,t){return{status:e,resultUri:t}},{hasBlobUri:v=function(e){return e in p},getResultUri:function(e){e=p[e];return e?e.resultUri:null},isPending:function(e){return!!v(e)&&1===p[e].status},isUploaded:function(e){return!!v(e)&&2===p[e].status},markPending:function(e){p[e]=h(1,null)},markUploaded:function(e,t){p[e]=h(2,t)},removeFailed:function(e){delete p[e]},destroy:function(){p={}}}),C=[],S=(y=zu(null),(b=c).on("change AddUndo",function(e){y.set(we({},e.level))}),{fireIfChanged:function(){var t=b.undoManager.data;N(t).filter(function(e){return!cp(y.get(),e)}).each(function(e){b.setDirty(!0),b.fire("change",{level:e,lastLevel:B(t,t.length-2).getOrNull()})})}}),k=function(e){if(lc(c))return t(e)},O=function(){return(g=g||Gp(w,x)).findAll(c.getBody(),e).then(n(function(e){return e=me(e,function(e){return"string"!=typeof e||(Nh(c,e),!1)}),de(e,function(e){s(e.image.src,e.blobInfo.blobUri()),e.image.src=e.blobInfo.blobUri(),e.image.removeAttribute("data-mce-src")}),e}))};return c.on("SetContent",function(){(lc(c)?k:O)()}),c.on("RawSaveContent",function(e){e.content=u(e.content)}),c.on("GetContent",function(e){e.source_view||"raw"===e.format||"tree"===e.format||(e.content=u(e.content))}),c.on("PostRender",function(){c.parser.addNodeFilter("img",function(e){de(e,function(e){var t=e.attr("src");x.getByUri(t)||(t=w.getResultUri(t))&&e.attr("src",t)})})}),{blobCache:x,addFilter:function(e){C.push(e)},uploadImages:t,uploadImagesAuto:k,scanForImages:O,destroy:function(){x.destroy(),w.destroy(),g=m=null}}}var jh=0;function Uh(e,t){function s(e){o="string"==typeof e?{name:e,classes:[],attrs:{}}:e;var t=_b.create(o.name),n=t;return(e=o).classes.length&&_b.addClass(n,e.classes.join(" ")),_b.setAttribs(n,e.attrs),t}var n,o,l=t&&t.schema||Fr({}),f=function(t,e,n){var o,r,i,u=0<e.length&&e[0],a=u&&u.name,c=(i=a,c="string"!=typeof(c=t)?c.nodeName.toLowerCase():c,!(!(c=(c=l.getElementRule(c))&&c.parentsRequired)||!c.length)&&(i&&-1!==Kt.inArray(c,i)?i:c[0]));if(c)a===c?(r=e[0],e=e.slice(1)):r=c;else if(u)r=e[0],e=e.slice(1);else if(!n)return t;return r&&(o=s(r)).appendChild(t),n&&(o||(o=_b.create("div")).appendChild(t),Kt.each(n,function(e){e=s(e);o.insertBefore(e,t)})),f(o,e,r&&r.siblings)};return e&&e.length?(o=e[0],n=s(o),(t=_b.create("div")).appendChild(f(n,e.slice(1),o.siblings)),t):""}function Wh(e){var t,i={classes:[],attrs:{}};return"*"!==(e=i.selector=Kt.trim(e))&&(t=e.replace(/(?:([#\.]|::?)([\w\-]+)|(\[)([^\]]+)\]?)/g,function(e,t,n,o,r){switch(t){case"#":i.attrs.id=n;break;case".":i.classes.push(n);break;case":":-1!==Kt.inArray("checked disabled enabled read-only required".split(" "),n)&&(i.attrs[n]=n)}return"["!==o||(r=r.match(/([\w\-]+)(?:\=\"([^\"]+))?/))&&(i.attrs[r[1]]=r[2]),""})),i.name=t||"div",i}function qh(n,e){var o,r="",t=(a=n.getParam("preview_styles","font-family font-size font-weight font-style text-decoration text-transform color background-color border border-radius outline text-shadow"),Q(a)?a:"");if(""===t)return"";function i(e){return e.replace(/%(\w+)/g,"")}if("string"==typeof e){if(!(e=n.formatter.get(e)))return;e=e[0]}if("preview"in e){var u=te(e,"preview");if(u.is(!1))return"";t=u.getOr(t)}var a=e.block||e.inline||"span",u=(u=(u=e.selector)&&"string"==typeof u?(u=(u=u.split(/\s*,\s*/)[0]).replace(/\s*(~\+|~|\+|>)\s*/g,"$1"),Kt.map(u.split(/(?:>|\s+(?![^\[\]]+\]))/),function(e){var t=Kt.map(e.split(/(?:~\+|~|\+)/),Wh),e=t.pop();return t.length&&(e.siblings=t),e}).reverse()):[]).length?(u[0].name||(u[0].name=a),a=e.selector,Uh(u,n)):Uh([a],n),c=_b.select(a,u)[0]||u.firstChild;return Ob(e.styles,function(e,t){e=i(e);e&&_b.setStyle(c,t,e)}),Ob(e.attributes,function(e,t){e=i(e);e&&_b.setAttrib(c,t,e)}),Ob(e.classes,function(e){e=i(e);_b.hasClass(c,e)||_b.addClass(c,e)}),n.fire("PreviewFormats"),_b.setStyles(u,{position:"absolute",left:-65535}),n.getBody().appendChild(u),o=_b.getStyle(n.getBody(),"fontSize",!0),o=/px$/.test(o)?parseInt(o,10):0,Ob(t.split(" "),function(e){var t=_b.getStyle(c,e,!0);if(!("background-color"===e&&/transparent|rgba\s*\([^)]+,\s*0\)/.test(t)&&(t=_b.getStyle(n.getBody(),e,!0),"#ffffff"===_b.toHex(t).toLowerCase())||"color"===e&&"#000000"===_b.toHex(t).toLowerCase())){if("font-size"===e&&/em|%$/.test(t)){if(0===o)return;t=parseFloat(t)/(/%$/.test(t)?100:1)*o+"px"}"border"===e&&t&&(r+="padding:0 2px;"),r+=e+":"+t+";"}}),n.fire("AfterPreviewFormats"),_b.remove(u),r}function Gh(r){var o,t,n,i,u,e=(n={},(i=function(e,t){e&&("string"!=typeof e?Kt.each(e,function(e,t){i(t,e)}):(ne(t)||(t=[t]),Kt.each(t,function(e){void 0===e.deep&&(e.deep=!e.selector),void 0===e.split&&(e.split=!e.selector||e.inline),void 0===e.remove&&e.selector&&!e.inline&&(e.remove="none"),e.selector&&e.inline&&(e.mixed=!0,e.block_expand=!0),"string"==typeof e.classes&&(e.classes=e.classes.split(/\s+/))}),n[e]=t))})((o=(e=r).dom,t={valigntop:[{selector:"td,th",styles:{verticalAlign:"top"}}],valignmiddle:[{selector:"td,th",styles:{verticalAlign:"middle"}}],valignbottom:[{selector:"td,th",styles:{verticalAlign:"bottom"}}],alignleft:[{selector:"figure.image",collapsed:!1,classes:"align-left",ceFalseOverride:!0,preview:"font-family font-size"},{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li",styles:{textAlign:"left"},inherit:!1,preview:!1,defaultBlock:"div"},{selector:"img,table",collapsed:!1,styles:{float:"left"},preview:"font-family font-size"}],aligncenter:[{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li",styles:{textAlign:"center"},inherit:!1,preview:"font-family font-size",defaultBlock:"div"},{selector:"figure.image",collapsed:!1,classes:"align-center",ceFalseOverride:!0,preview:"font-family font-size"},{selector:"img",collapsed:!1,styles:{display:"block",marginLeft:"auto",marginRight:"auto"},preview:!1},{selector:"table",collapsed:!1,styles:{marginLeft:"auto",marginRight:"auto"},preview:"font-family font-size"}],alignright:[{selector:"figure.image",collapsed:!1,classes:"align-right",ceFalseOverride:!0,preview:"font-family font-size"},{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li",styles:{textAlign:"right"},inherit:!1,preview:"font-family font-size",defaultBlock:"div"},{selector:"img,table",collapsed:!1,styles:{float:"right"},preview:"font-family font-size"}],alignjustify:[{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li",styles:{textAlign:"justify"},inherit:!1,defaultBlock:"div",preview:"font-family font-size"}],bold:[{inline:"strong",remove:"all",preserve_attributes:["class","style"]},{inline:"span",styles:{fontWeight:"bold"}},{inline:"b",remove:"all",preserve_attributes:["class","style"]}],italic:[{inline:"em",remove:"all",preserve_attributes:["class","style"]},{inline:"span",styles:{fontStyle:"italic"}},{inline:"i",remove:"all",preserve_attributes:["class","style"]}],underline:[{inline:"span",styles:{textDecoration:"underline"},exact:!0},{inline:"u",remove:"all",preserve_attributes:["class","style"]}],strikethrough:[{inline:"span",styles:{textDecoration:"line-through"},exact:!0},{inline:"strike",remove:"all",preserve_attributes:["class","style"]},{inline:"s",remove:"all",preserve_attributes:["class","style"]}],forecolor:{inline:"span",styles:{color:"%value"},links:!0,remove_similar:!0,clear_child_styles:!0},hilitecolor:{inline:"span",styles:{backgroundColor:"%value"},links:!0,remove_similar:!0,clear_child_styles:!0},fontname:{inline:"span",toggle:!1,styles:{fontFamily:"%value"},clear_child_styles:!0},fontsize:{inline:"span",toggle:!1,styles:{fontSize:"%value"},clear_child_styles:!0},lineheight:{selector:"h1,h2,h3,h4,h5,h6,p,li,td,th,div",defaultBlock:"p",styles:{lineHeight:"%value"}},fontsize_class:{inline:"span",attributes:{class:"%value"}},blockquote:{block:"blockquote",wrapper:!0,remove:"all"},subscript:{inline:"sub"},superscript:{inline:"sup"},code:{inline:"code"},link:{inline:"a",selector:"a",remove:"all",split:!0,deep:!0,onmatch:function(e,t,n){return yn(e)&&e.hasAttribute("href")},onformat:function(n,e,t){Kt.each(t,function(e,t){o.setAttrib(n,t,e)})}},removeformat:[{selector:"b,strong,em,i,font,u,strike,s,sub,sup,dfn,code,samp,kbd,var,cite,mark,q,del,ins",remove:"all",split:!0,expand:!1,block_expand:!0,deep:!0},{selector:"span",attributes:["style","class"],remove:"empty",split:!0,expand:!1,deep:!0},{selector:"*",attributes:["style","class"],split:!1,expand:!1,deep:!0}]},Kt.each("p h1 h2 h3 h4 h5 h6 div address pre div dt dd samp".split(/\s/),function(e){t[e]={block:e,remove:"all"}}),t)),i(e.getParam("formats")),{get:function(e){return e?n[e]:n},has:function(e){return ye(n,e)},register:i,unregister:function(e){return e&&n[e]&&delete n[e],n}}),a=zu(null);return function(e){e.addShortcut("meta+b","","Bold"),e.addShortcut("meta+i","","Italic"),e.addShortcut("meta+u","","Underline");for(var t=1;t<=6;t++)e.addShortcut("access+"+t,"",["FormatBlock",!1,"h"+t]);e.addShortcut("access+7","",["FormatBlock",!1,"p"]),e.addShortcut("access+8","",["FormatBlock",!1,"div"]),e.addShortcut("access+9","",["FormatBlock",!1,"address"])}(r),(u=r).on("mouseup keydown",function(e){var t=u,n=e.keyCode,o=t.selection,e=t.getBody();jm(t,null,!1),8!==n&&46!==n||!o.isCollapsed()||o.getStart().innerHTML!==wg||jm(t,Os(e,o.getStart())),37!==n&&39!==n||jm(t,Os(e,o.getStart()))}),{get:e.get,has:e.has,register:e.register,unregister:e.unregister,apply:function(e,t,n){yp(r).formatter.apply(e,t,n)},remove:function(e,t,n,o){yp(r).formatter.remove(e,t,n,o)},toggle:function(e,t,n){yp(r).formatter.toggle(e,t,n)},match:function(e,t,n){return e=e,t=t,n=n,yp(r).formatter.match(e,t,n)},closest:function(e){return e=e,yp(r).formatter.closest(e)},matchAll:function(e,t){return e=e,t=t,yp(r).formatter.matchAll(e,t)},matchNode:function(e,t,n,o){return e=e,t=t,n=n,o=o,yp(r).formatter.matchNode(e,t,n,o)},canApply:function(e){return e=e,yp(r).formatter.canApply(e)},formatChanged:function(e,t,n){return o=a,e=e,t=t,void 0===(n=n)&&(n=!1),yp(r).formatter.formatChanged(o,e,t,n);var o},getCssText:w(qh,r)}}function $h(n,o,r){function i(e){lp(o,!1,r),o.add({},e)}var u=zu(!1);n.on("init",function(){o.add()}),n.on("BeforeExecCommand",function(e){e=e.command.toLowerCase();"undo"!==e&&"redo"!==e&&"mcerepaint"!==e&&(fp(o,r),o.beforeChange())}),n.on("ExecCommand",function(e){var t=e.command.toLowerCase();"undo"!==t&&"redo"!==t&&"mcerepaint"!==t&&i(e)}),n.on("ObjectResizeStart cut",function(){o.beforeChange()}),n.on("SaveContent ObjectResized blur",i),n.on("dragend",i),n.on("keyup",function(e){var t=e.keyCode;e.isDefaultPrevented()||((33<=t&&t<=36||37<=t&&t<=40||45===t||e.ctrlKey)&&(i(),n.nodeChanged()),46!==t&&8!==t||n.nodeChanged(),u.get()&&o.typing&&!1===cp(rp(n),o.data[0])&&(!1===n.isDirty()&&(n.setDirty(!0),n.fire("change",{level:o.data[0],lastLevel:null})),n.fire("TypingUndo"),u.set(!1),n.nodeChanged()))}),n.on("keydown",function(e){var t,n=e.keyCode;e.isDefaultPrevented()||(33<=n&&n<=36||37<=n&&n<=40||45===n?o.typing&&i(e):(t=e.ctrlKey&&!e.altKey||e.metaKey,!(n<16||20<n)||224===n||91===n||o.typing||t||(o.beforeChange(),lp(o,!0,r),o.add({},e),u.set(!0))))}),n.on("mousedown",function(e){o.typing&&i(e)}),n.on("input",function(e){e.inputType&&("insertReplacementText"===e.inputType||"insertText"===e.inputType&&null===e.data||"insertFromPaste"===e.inputType||"insertFromDrop"===e.inputType)&&i(e)}),n.on("AddUndo Undo Redo ClearUndos",function(e){e.isDefaultPrevented()||n.nodeChanged()})}function Xh(u){var e,a=zu(Y.none()),c=zu(0),s=zu(0),l={data:[],typing:!1,beforeChange:function(){var e=c,t=a;yp(u).undoManager.beforeChange(e,t)},add:function(e,t){return n=l,o=s,r=c,i=a,e=e,t=t,yp(u).undoManager.addUndoLevel(n,o,r,i,e,t);var n,o,r,i},undo:function(){return e=l,t=c,n=s,yp(u).undoManager.undo(e,t,n);var e,t,n},redo:function(){return e=s,t=l.data,yp(u).undoManager.redo(e,t);var e,t},clear:function(){var e=l,t=s;yp(u).undoManager.clear(e,t)},reset:function(){var e=l;yp(u).undoManager.reset(e)},hasUndo:function(){return e=l,t=s,yp(u).undoManager.hasUndo(e,t);var e,t},hasRedo:function(){return e=l,t=s,yp(u).undoManager.hasRedo(e,t);var e,t},transact:function(e){return t=l,n=c,e=e,yp(u).undoManager.transact(t,n,e);var t,n},ignore:function(e){var t=c,e=e;yp(u).undoManager.ignore(t,e)},extra:function(e,t){var n=l,o=s,e=e,t=t;yp(u).undoManager.extra(n,o,e,t)}};return vp(u)||$h(u,l,c),(e=u).addShortcut("meta+z","","Undo"),e.addShortcut("meta+y,meta+shift+z","","Redo"),l}function Yh(e){return"keydown"===e.type||"keyup"===e.type}function Kh(e){return(e=e.keyCode)===sf.BACKSPACE||e===sf.DELETE}function Jh(e,t){return Ie(Jt.fromDom(t),e.getParam("inline_boundaries_selector","a[href],code,.mce-annotation","string"))}function Qh(e,t,n){return e=e,t=t,e=me(Iu.DOM.getParents(n.container(),"*",t),e),Y.from(e[e.length-1])}function Zh(e,t){if(!t)return t;var n=t.container(),o=t.offset();return e?ko(n)?wn(n.nextSibling)?zc(n.nextSibling,0):zc.after(n):Eo(t)?zc(n,o+1):t:ko(n)?wn(n.previousSibling)?zc(n.previousSibling,n.previousSibling.data.length):zc.before(n):To(t)?zc(n,o-1):t}function ev(e,t){return Le(e,t)?Xn(t,function(e){return qo(e)||$o(e)},(n=e,function(e){return Pe(n,Jt.fromDom(e.dom.parentNode))})):Y.none();var n}function tv(e){var t;e.dom.isEmpty(e.getBody())&&(e.setContent(""),e=(e=(t=e).getBody()).firstChild&&t.dom.isBlock(e.firstChild)?e.firstChild:e,t.selection.setCursorLocation(e,0))}function nv(e,t){return{from:e,to:t}}function ov(e,t){var n=Jt.fromDom(e),e=Jt.fromDom(t.container());return ev(n,e).map(function(e){return{block:e,position:t}})}function rv(e){var t,e=(t=qe(e),h(t,Wo).fold(function(){return t},function(e){return t.slice(0,e)}));return de(e,gn),e}function iv(e,t){return e=Id(t,e),D(e.reverse(),function(e){return Fo(e)}).each(gn)}function uv(e,t,n,o){return Fo(n)?(Nd(n),Ml(n.dom)):(0===me(rn(o),function(e){return!Fo(e)}).length&&Fo(t)&&ln(o,Jt.fromTag("br")),n=Rl(n.dom,zc.before(o.dom)),de(rv(t),function(e){ln(o,e)}),iv(e,t),n)}function av(e,t,n){if(Fo(n))return gn(n),Fo(t)&&Nd(t),Ml(t.dom);var o=Il(n.dom);return de(rv(t),function(e){mn(n,e)}),iv(e,t),o}function cv(e,t){Ss(e,t.dom).map(function(e){return e.getNode()}).map(Jt.fromDom).filter(xo).each(gn)}function sv(e,t,n){return cv(!0,t),cv(!1,n),(Le(r=n,o=t)?(r=Id(o,r),Y.from(r[r.length-1])):Y.none()).fold(w(av,e,t,n),w(uv,e,t,n));var o,r}function lv(e,t,n,o){return t?sv(e,o,n):sv(e,n,o)}function fv(t,n){var e,o,r,i,u,a=Jt.fromDom(t.getBody()),c=(u=a.dom,e=n,((o=t.selection.getRng()).collapsed?(i=e,c=o,u=ov(r=u,zc.fromRangeStart(c)),c=u.bind(function(e){return ws(i,r,e.position).bind(function(e){return ov(r,e).map(function(e){return t=r,n=i,On((o=e).position.getNode())&&!1===Fo(o.block)?Ss(!1,o.block.dom).bind(function(e){return e.isEqual(o.position)?ws(n,t,e).bind(function(e){return ov(t,e)}):Y.some(o)}).getOr(o):o;var t,n,o})})}),sa(u,c,nv).filter(function(e){return!1===Pe(e.from.block,e.to.block)&&Ue((n=e).from.block).bind(function(t){return Ue(n.to.block).filter(function(e){return Pe(t,e)})}).isSome()&&!1===Tn((t=e).from.block.dom)&&!1===Tn(t.to.block.dom);var t,n})):Y.none()).bind(function(e){return lv(a,n,e.from.block,e.to.block)}));return c.each(function(e){t.selection.setRng(e.toRange())}),c.isSome()}function dv(e,t){return t=Jt.fromDom(t),e=w(Pe,e),$n(t,Yo,e).isSome()}function mv(e){var n,o,r,t,i,u,a=Jt.fromDom(e.getBody()),c=e.selection.getRng();return i=c,u=Rl((t=a).dom,zc.fromRangeStart(i)).isNone(),c=Nl(t.dom,zc.fromRangeEnd(i)).isNone(),dv(t=t,(i=i).startContainer)||dv(t,i.endContainer)||!u||!c?(n=a,o=e.selection,r=o.getRng(),sa(ev(n,Jt.fromDom(r.startContainer)),ev(n,Jt.fromDom(r.endContainer)),function(e,t){return!1===Pe(e,t)&&(r.deleteContents(),lv(n,!0,e,t).each(function(e){o.setRng(e.toRange())}),!0)}).getOr(!1)):((e=e).setContent(""),e.selection.setCursorLocation(),!0)}function gv(e,t){return!e.selection.isCollapsed()&&mv(e)}function pv(e,t,n,o,r){return Y.from(t._selectionOverrides.showCaret(e,n,o,r))}function hv(e,t){return e.fire("BeforeObjectSelected",{target:t}).isDefaultPrevented()?Y.none():Y.some(((t=(e=t).ownerDocument.createRange()).selectNode(e),t))}function vv(e,t,n){var o=Mc(1,e.getBody(),t),o=(t=zc.fromRangeStart(o)).getNode();return rs(o)?pv(1,e,o,!t.isAtEnd(),!1):(o=t.getNode(!0),rs(o)?pv(1,e,o,!1,!1):(t=e.dom.getParent(t.getNode(),function(e){return Rb(e)||Nb(e)}),rs(t)?pv(1,e,t,!1,n):Y.none()))}function bv(e,t,n){return t.collapsed?vv(e,t,n).getOr(t):t}function yv(e){return rg(e)||eg(e)}function xv(e){return ig(e)||tg(e)}function wv(n,o,e,t,r,i){return pv(t,n,i.getNode(!r),r,!0).each(function(e){var t;o.collapsed?(t=o.cloneRange(),r?t.setEnd(e.startContainer,e.startOffset):t.setStart(e.endContainer,e.endOffset),t.deleteContents()):o.deleteContents(),n.selection.setRng(e)}),i=n.dom,wn(e=e)&&0===e.data.length&&i.remove(e),!0}function Cv(e,t){var n=e.selection.getRng();if(!wn(n.commonAncestorContainer))return!1;var o=t?Hc.Forwards:Hc.Backwards,r=vs(e.getBody()),i=w(Lc,t?r.next:r.prev),u=t?yv:xv,a=Fc(o,e.getBody(),n);return!(!(r=Zh(t,i(a)))||!Vc(a,r))&&(u(r)?wv(e,n,a.getNode(),o,t,r):!!((i=i(r))&&u(i)&&Vc(r,i))&&wv(e,n,a.getNode(),o,t,i))}function Sv(s,l,f){return ws(l,s,f).bind(function(e){return c=e.getNode(),Yo(Jt.fromDom(c))||$o(Jt.fromDom(c))?Y.none():(o=s,u=e,a=function(e){return yo(Jt.fromDom(e))&&!Bc(i,u,o)},Ic(!(r=l),i=f).fold(function(){return Ic(r,u).fold(W,a)},a)?Y.none():l&&Tn(e.getNode())||!1===l&&Tn(e.getNode(!0))?(t=s,c=f,n=e.getNode(!1===l),ev(Jt.fromDom(t),Jt.fromDom(c.getNode())).map(function(e){return Fo(e)?Mb.remove(e.dom):Mb.moveToElement(n)}).orThunk(function(){return Y.some(Mb.moveToElement(n))})):l&&ig(f)||!1===l&&rg(f)?Y.some(Mb.moveToPosition(e)):Y.none());var t,n,o,r,i,u,a,c})}function kv(e,t){return Y.from($l(e.getBody(),t))}function Ov(a,c){var e=a.selection.getNode();return kv(a,e).filter(Tn).fold(function(){return t=a.getBody(),n=c,i=a.selection.getRng(),u=Mc(n?1:-1,t,i),i=zc.fromRangeStart(u),u=Jt.fromDom(t),(!1===n&&ig(i)?Y.some(Mb.remove(i.getNode(!0))):n&&rg(i)?Y.some(Mb.remove(i.getNode())):!1===n&&rg(i)&&zd(u,i)?lg(u,i).map(function(e){return Mb.remove(e.getNode())}):n&&ig(i)&&Hd(u,i)?fg(u,i).map(function(e){return Mb.remove(e.getNode())}):(o=t,e=n,i=(r=i).getNode(!1===(n=e)),n=n?"after":"before",yn(i)&&i.getAttribute("data-mce-caret")===n?(n=r.getNode(!1===(i=e)),(i&&Tn(n.nextSibling)?Y.some(Mb.moveToElement(n.nextSibling)):!1===i&&Tn(n.previousSibling)?Y.some(Mb.moveToElement(n.previousSibling)):Y.none()).fold(function(){return Sv(o,e,r)},Y.some)):Sv(o,e,r).bind(function(e){return t=o,n=r,e.fold(function(e){return Y.some(Mb.remove(e))},function(e){return Y.some(Mb.moveToElement(e))},function(e){return Bc(n,e,t)?Y.none():Y.some(Mb.moveToPosition(e))});var t,n}))).exists(function(e){return e.fold(function(e){return r._selectionOverrides.hideFakeCaret(),sm(r,i,Jt.fromDom(e)),!0},(o=i=c,function(e){e=o?zc.before(e):zc.after(e);return n.selection.setRng(e.toRange()),!0}),(t=n=r=a,function(e){return t.selection.setRng(e.toRange()),!0}));var t,n,o,r,i});var o,e,r,t,n,i,u},q)}function _v(e){var t=e.dom,n=e.selection,o=$l(e.getBody(),n.getNode());return En(o)&&t.isBlock(o)&&t.isEmpty(o)&&(e=t.create("br",{"data-mce-bogus":"1"}),t.setHTML(o,""),o.appendChild(e),n.setRng(zc.before(e).toRange())),!0}function Ev(e,t){return(e.selection.isCollapsed()?Ov:function(t,n){var e=t.selection.getNode();return!!Tn(e)&&kv(t,e.parentNode).filter(Tn).fold(function(){var e=Jt.fromDom(t.getBody());return de(Zu(e,".mce-offscreen-selection"),gn),sm(t,n,Jt.fromDom(t.selection.getNode())),tv(t),!0},function(){return!0})})(e,t)}function Tv(e,t){return!!e.selection.isCollapsed()&&(n=e,o=t,t=zc.fromRangeStart(n.selection.getRng()),ws(o,n.getBody(),t).filter(function(e){return(o?Qm:Zm)(e)}).bind(function(e){return Y.from(Nc(o?0:-1,e))}).exists(function(e){return n.selection.select(e),!0}));var n,o}function Dv(e){return Ib(e)&&e.data[0]===Zo}function Av(e){return Ib(e)&&e.data[e.data.length-1]===Zo}function Bv(e){return e.ownerDocument.createTextNode(Zo)}function Nv(e,t){return(e?function(e){if(Ib(e.previousSibling))return Av(e.previousSibling)||e.previousSibling.appendData(Zo),e.previousSibling;if(Ib(e))return Dv(e)||e.insertData(0,Zo),e;var t=Bv(e);return e.parentNode.insertBefore(t,e),t}:function(e){if(Ib(e.nextSibling))return Dv(e.nextSibling)||e.nextSibling.insertData(0,Zo),e.nextSibling;if(Ib(e))return Av(e)||e.appendData(Zo),e;var t=Bv(e);return e.nextSibling?e.parentNode.insertBefore(t,e.nextSibling):e.parentNode.appendChild(t),t})(t)}function Rv(e,t){return wn(e.container())?Nv(t,e.container()):Nv(t,e.getNode())}function Mv(e,t){return(t=t.get())&&e.container()===t&&ko(t)}function Iv(t,e){return e.fold(function(e){Zc(t.get());e=Fb(e);return t.set(e),Y.some(zc(e,e.length-1))},function(e){return Ml(e).map(function(e){if(Mv(e,t))return zc(t.get(),1);Zc(t.get());e=Rv(e,!0);return t.set(e),zc(e,1)})},function(e){return Il(e).map(function(e){if(Mv(e,t))return zc(t.get(),t.get().length-1);Zc(t.get());e=Rv(e,!1);return t.set(e),zc(e,e.length-1)})},function(e){Zc(t.get());e=Pb(e);return t.set(e),Y.some(zc(e,1))})}function Fv(e,t){for(var n=0;n<e.length;n++){var o=e[n].apply(null,t);if(o.isSome())return o}return Y.none()}function Pv(e,t){return Ac(t,e)||e}function Lv(e,t,n){var o=Ab(n),r=Pv(t,o.container());return Qh(e,r,o).fold(function(){return Nl(r,o).bind(w(Qh,e,r)).map(function(e){return Lb.before(e)})},Y.none)}function Vv(e,t){return null===Os(e,t)}function Hv(e,t,n){return Qh(e,t,n).filter(w(Vv,t))}function zv(e,t,n){var o=Bb(n);return Hv(e,t,o).bind(function(e){return Rl(e,o).isNone()?Y.some(Lb.start(e)):Y.none()})}function jv(e,t,n){var o=Ab(n);return Hv(e,t,o).bind(function(e){return Nl(e,o).isNone()?Y.some(Lb.end(e)):Y.none()})}function Uv(e,t,n){var o=Bb(n),r=Pv(t,o.container());return Qh(e,r,o).fold(function(){return Rl(r,o).bind(w(Qh,e,r)).map(function(e){return Lb.after(e)})},Y.none)}function Wv(e){return!1===(e=Vb(e),"rtl"===Iu.DOM.getStyle(e,"direction",!0)||(e=e.textContent,Db.test(e)))}function qv(e,t,n){return Fv([Lv,zv,jv,Uv],[e,t,n]).filter(Wv)}function Gv(e){return e.fold(_("before"),_("start"),_("end"),_("after"))}function $v(e){return e.fold(Lb.before,Lb.before,Lb.after,Lb.after)}function Xv(e){return e.fold(Lb.start,Lb.start,Lb.end,Lb.end)}function Yv(i,e,u,t,n,a){return sa(Qh(e,u,t),Qh(e,u,n),function(e,t){return e!==t&&(n=t,o=Ac(e,r=u),r=Ac(n,r),o&&o===r)?Lb.after(i?e:t):a;var n,o,r}).getOr(a)}function Kv(e,n){return e.fold(q,function(e){return t=n,!(Gv(e=e)===Gv(t)&&Vb(e)===Vb(t));var t})}function Jv(e,t){return e?t.fold(r(Y.some,Lb.start),Y.none,r(Y.some,Lb.after),Y.none):t.fold(Y.none,r(Y.some,Lb.before),Y.none,r(Y.some,Lb.end))}function Qv(e,u,a,c){var t=Zh(e,c),s=qv(u,a,t);return qv(u,a,t).bind(w(Jv,e)).orThunk(function(){return n=u,o=a,r=s,i=Zh(t=e,c),ws(t,o,i).map(w(Zh,t)).fold(function(){return r.map($v)},function(e){return qv(n,o,e).map(w(Yv,t,n,o,i,e)).filter(w(Kv,r))}).filter(Wv);var t,n,o,r,i})}function Zv(e,t){var n=e.dom.createRng();n.setStart(t.container(),t.offset()),n.setEnd(t.container(),t.offset()),e.selection.setRng(n)}function eb(e,t){e?t.setAttribute("data-mce-selected","inline-boundary"):t.removeAttribute("data-mce-selected")}function tb(t,e,n){return Iv(e,n).map(function(e){return Zv(t,e),n})}function nb(e,t,n){return!!bc(e)&&(r=t,i=n,t=(o=e).getBody(),n=zc.fromRangeStart(o.selection.getRng()),e=w(Jh,o),Qv(i,e,t,n).bind(function(e){return tb(o,r,e)}).isSome());var o,r,i}function ob(c){var s=zu(null),l=w(Jh,c);return c.on("NodeChange",function(e){var n,o,r,t,i,u,a;!bc(c)||$t.browser.isIE()&&e.initial||(t=l,a=c.dom,i=e.parents,u=E(Zu(Jt.fromDom(a.getRoot()),'*[data-mce-selected="inline-boundary"]'),function(e){return e.dom}),a=me(u,t),u=me(i,t),de(x(a,u),w(eb,!1)),de(x(u,a),w(eb,!0)),i=s,(t=c).selection.isCollapsed()&&!0!==t.composing&&i.get()&&(u=zc.fromRangeStart(t.selection.getRng()),zc.isTextPosition(u)&&!1===(Eo(a=u)||To(a))&&(Zv(t,Sc(i.get(),u)),i.set(null))),n=l,o=c,r=s,e=e.parents,o.selection.isCollapsed()&&(e=me(e,n),de(e,function(e){var t=zc.fromRangeStart(o.selection.getRng());qv(n,o.getBody(),t).bind(function(e){return tb(o,r,e)})})))}),s}function rb(t,n){return function(e){return Iv(n,e).exists(function(e){return Zv(t,e),!0})}}function ib(o,r,i,u){var a=o.getBody(),c=w(Jh,o);o.undoManager.ignore(function(){var e,t,n;o.selection.setRng((e=i,t=u,(n=document.createRange()).setStart(e.container(),e.offset()),n.setEnd(t.container(),t.offset()),n)),o.execCommand("Delete"),qv(c,a,zc.fromRangeStart(o.selection.getRng())).map(Xv).map(rb(o,r))}),o.nodeChanged()}function ub(e,t,n){if(e.selection.isCollapsed()&&bc(e)){var o=zc.fromRangeStart(e.selection.getRng());return i=t,u=n,a=o,o=(r=e).getBody(),e=a.container(),c=Ac(e,o)||o,s=w(Jh,r),(l=qv(s,c,a)).bind(function(e){return u?e.fold(_(Y.some(Xv(e))),Y.none,_(Y.some($v(e))),Y.none):e.fold(Y.none,_(Y.some($v(e))),Y.none,_(Y.some(Xv(e))))}).map(rb(r,i)).getOrThunk(function(){var t=Cs(u,c,a),e=t.bind(function(e){return qv(s,c,e)});return sa(l,e,function(){return Qh(s,c,a).exists(function(e){return!!sa(Ml(o=e),Il(o),function(e,t){var e=Zh(!0,e),n=Zh(!1,t);return Nl(o,e).forall(function(e){return e.isEqual(n)})}).getOr(!0)&&(sm(r,u,Jt.fromDom(e)),!0);var o})}).orThunk(function(){return e.bind(function(e){return t.map(function(e){return u?ib(r,i,a,e):ib(r,i,e,a),!0})})}).getOr(!1)})}var r,i,u,a,c,s,l;return!1}function ab(e){return 1===qe(e).length}function cb(c,s){var t,e=Jt.fromDom(c.getBody()),n=Jt.fromDom(c.selection.getStart()),l=me((t=Id(n,e),h(t,Wo).fold(_(t),function(e){return t.slice(0,e)})),ab);return N(l).exists(function(e){var t,n,o,r=zc.fromRangeStart(c.selection.getRng()),i=s,u=r,a=e.dom;return!(!sa(Ml(a),Il(a),function(e,t){var n=Zh(!0,e),o=Zh(!1,t),t=Zh(!1,u);return i?Nl(a,t).exists(function(e){return e.isEqual(o)&&u.isEqual(n)}):Rl(a,t).exists(function(e){return e.isEqual(n)&&u.isEqual(o)})}).getOr(!0)||ks((n=e).dom)&&Lm(n.dom)||(t=s,o=e,r=l,e=w(Gm,n=c),0===(e=E(me(r,e),function(e){return e.dom})).length?sm(n,t,o):(t=o.dom,o=e,e=Hm(!1),o=Wm(o,e.dom),ln(Jt.fromDom(t),e),gn(Jt.fromDom(t)),o=zc(o,0),n.selection.setRng(o.toRange())),0))})}function sb(e,t){return!!e.selection.isCollapsed()&&cb(e,t)}function lb(e,t,n){return e._selectionOverrides.hideFakeCaret(),sm(e,t,Jt.fromDom(n)),!0}function fb(e,t){return e.selection.isCollapsed()?(o=e,i=(r=t)?eg:tg,u=Fc(r?Hc.Forwards:Hc.Backwards,o.getBody(),o.selection.getRng()),i(u)?lb(o,r,u.getNode(!r)):Y.from(Zh(r,u)).filter(function(e){return i(e)&&Vc(u,e)}).exists(function(e){return lb(o,r,e.getNode(!r))})):(n=t,e=(t=e).selection.getNode(),!!Dn(e)&&lb(t,n,e));var n,o,r,i,u}function db(e){return e=parseInt(e,10),isNaN(e)?0:e}function mb(e,t){return(e||"table"===Qt(t)?"margin":"padding")+("rtl"===bt(t,"direction")?"-right":"-left")}function gb(e){var n,t=Ub(e);return!e.mode.isReadOnly()&&(1<t.length||(n=e,A(t,function(e){var t=mb(gc(n),e),t=yt(e,t).map(db).getOr(0);return"false"!==n.dom.getContentEditable(e.dom)&&0<t})))}function pb(e){return Go(e)||$o(e)}function hb(e,a){var c=e.dom,t=e.selection,n=e.formatter,o=e.getParam("indentation","40px","string"),s=/[a-z%]+$/i.exec(o)[0],l=parseInt(o,10),f=gc(e),o=cc(e);e.queryCommandState("InsertUnorderedList")||e.queryCommandState("InsertOrderedList")||""!==o||c.getParent(t.getNode(),c.isBlock)||n.apply("div"),de(Ub(e),function(e){var t,n=c,o=a,r=l,i=s,u=e.dom,e=mb(f,Jt.fromDom(u));"outdent"===o?(t=Math.max(0,db(u.style[e])-r),n.setStyle(u,e,t?t+i:"")):(t=db(u.style[e])+r+i,n.setStyle(u,e,t))})}function vb(e,t){if(e.selection.isCollapsed()&&gb(e)){var n=e.dom,o=e.selection.getRng(),r=zc.fromRangeStart(o),n=n.getParent(o.startContainer,n.isBlock);if(null!==n&&ug(Jt.fromDom(n),r))return hb(e,"outdent"),!0}return!1}function bb(e,t){e.getDoc().execCommand(t,!1,null)}function yb(e){return void 0===e.touches||1!==e.touches.length?Y.none():Y.some(e.touches[0])}function xb(e,t){return e.hasOwnProperty(t.nodeName)}function wb(e){var t,n,o,r=e.dom,i=e.selection,u=(h=e.schema).getBlockElements(),a=i.getStart(),c=e.getBody(),s=cc(e);if(a&&yn(a)&&s){var l=c.nodeName.toLowerCase();if(h.isValidChild(l,s.toLowerCase())&&(f=u,b=c,v=a,!y(Md(Jt.fromDom(v),Jt.fromDom(b)),function(e){return xb(f,e.dom)}))){for(var f,d,m,g=i.getRng(),p=g.startContainer,h=g.startOffset,l=g.endContainer,v=g.endOffset,b=Vf(e),a=c.firstChild;a;)if(d=u,wn(m=a)||yn(m)&&!xb(d,m)&&!Rs(m)){if(function(e,t){if(wn(t)){if(0===t.nodeValue.length)return 1;if(/^\s+$/.test(t.nodeValue)&&(!t.nextSibling||xb(e,t.nextSibling)))return 1}}(u,a)){a=(n=a).nextSibling,r.remove(n);continue}t||(t=r.create(s,sc(e)),a.parentNode.insertBefore(t,a),o=!0),a=(n=a).nextSibling,t.appendChild(n)}else t=null,a=a.nextSibling;o&&b&&(g.setStart(p,h),g.setEnd(l,v),i.setRng(g),e.nodeChanged())}}}function Cb(e,t){t.hasAttribute("data-mce-caret")&&(Bo(t),e.selection.setRng(e.selection.getRng()),e.selection.scrollIntoView(t))}function Sb(e,t){var n=Kn(Jt.fromDom(e.getBody()),"*[data-mce-caret]").fold(_(null),function(e){return e.dom});if(n)return"compositionstart"===t.type?(t.preventDefault(),t.stopPropagation(),void Cb(e,n)):void(_o(n)&&(Cb(e,n),e.undoManager.add()))}var kb,Ob=Kt.each,_b=Iu.DOM,Eb=[9,27,sf.HOME,sf.END,19,20,44,144,145,33,34,45,16,17,18,91,92,93,sf.DOWN,sf.UP,sf.LEFT,sf.RIGHT].concat($t.browser.isFirefox()?[224]:[]),Tb="data-mce-placeholder",Db=/[\u0591-\u07FF\uFB1D-\uFDFF\uFE70-\uFEFC]/,Ab=w(Zh,!0),Bb=w(Zh,!1),Nb=En,Rb=Tn,Mb=e([{remove:["element"]},{moveToElement:["element"]},{moveToPosition:["position"]}]),Ib=wn,Fb=w(Nv,!0),Pb=w(Nv,!1),Lb=e([{before:["element"]},{start:["element"]},{end:["element"]},{after:["element"]}]),Vb=function(e){return e.fold(t,t,t,t)},Hb=(w(Qv,!1),w(Qv,!0),function(e,t,n){var o=e?1:-1;return t.setRng(zc(n.container(),n.offset()+o).toRange()),t.getSel().modify("move",e?"forward":"backward","word"),!0}),Mt=function(e,t,n){return!!bc(t)&&(o=e,t=(e=t).selection.getRng(),t=o?zc.fromRangeEnd(t):zc.fromRangeStart(t),!!ae(e.selection.getSel().modify)&&(o&&Eo(t)?Hb(!0,e.selection,t):!(o||!To(t))&&Hb(!1,e.selection,t)));var o},zb=w(Mt,!0),jb=w(Mt,!1),Ub=function(e){return me(E(e.selection.getSelectedBlocks(),Jt.fromDom),function(e){return!pb(e)&&!Ue(e).map(pb).getOr(!1)&&Xn(e,function(e){return En(e.dom)||Tn(e.dom)}).exists(function(e){return En(e.dom)})})};(Dt=kb={})[Dt.Br=0]="Br",Dt[Dt.Block=1]="Block",Dt[Dt.Wrap=2]="Wrap",Dt[Dt.Eol=3]="Eol";function Wb(e,t){return e===Hc.Backwards?b(t):t}function qb(e,r){return T(e,function(e,o){return e.fold(function(){return Y.some(o)},function(n){return sa(C(n.getClientRects()),C(o.getClientRects()),function(e,t){e=Math.abs(r-e.left);return Math.abs(r-t.left)<=e?o:n}).or(e)})},Y.none())}function Gb(t,e){return C(e.getClientRects()).bind(function(e){return qb(t,e.left)})}function $b(t){function e(e){return E(e,function(e){return(e=la(e)).node=t,e})}if(yn(t))return e(t.getClientRects());if(wn(t)){var n=t.ownerDocument.createRange();return n.setStart(t,0),n.setEnd(t,t.data.length),e(n.getClientRects())}}function Xb(e){return v(e,$b)}var Yb,Rt=function(e,t,n,o){for(var r,i,u=vs(n),a=o,c=[];a&&(i=u,s=a,r=t===Hc.Forwards?i.next(s):i.prev(s));){if(On(r.getNode(!1)))return t===Hc.Forwards?{positions:Wb(t,c).concat([r]),breakType:kb.Br,breakAt:Y.some(r)}:{positions:Wb(t,c),breakType:kb.Br,breakAt:Y.some(r)};if(r.isVisible()){if(e(a,r)){var s=(i=a,On((s=r).getNode(t===Hc.Forwards))?kb.Br:!1===Bc(i,s)?kb.Block:kb.Wrap);return{positions:Wb(t,c),breakType:s,breakAt:Y.some(r)}}c.push(r),a=r}else a=r}return{positions:Wb(t,c),breakType:kb.Eol,breakAt:Y.none()}},K=function(n,o,r,e){return o(r,e).breakAt.map(function(e){var t=o(r,e).positions;return n===Hc.Backwards?t.concat(e):[e].concat(t)}).getOr([])},Kb=w(Rt,qa.isAbove,-1),Jb=w(Rt,qa.isBelow,1),Qb=w(K,-1,Kb),Zb=w(K,1,Jb);(J=Yb={})[J.Up=-1]="Up",J[J.Down=1]="Down";function ey(t){return function(e){return e.line>t}}function ty(t){return function(e){return e.line===t}}function ny(e,t){return Math.abs(e.left-t)}function oy(e,t){return Math.abs(e.right-t)}function ry(e,t){return e>=t.left&&e<=t.right}function iy(e,t){return e>=t.top&&e<=t.bottom}function uy(e,r){return z(e,function(e,t){var n=Math.min(ny(e,r),oy(e,r)),o=Math.min(ny(t,r),oy(t,r));return ry(r,t)||!ry(r,e)&&(o===n&&b0(t.node)||o<n)?t:e})}function ay(e,t,n,o,r){var i=y0(o,e,Ro,t,!r);do{if(!i||n(i))return}while(i=y0(i,e,Ro,t))}function cy(e,t,n){var o=Xb(me(ge(e.getElementsByTagName("*")),Ec)),o=me(o,w(iy,n));if(n=uy(o,t)){o=!st(n.node)&&!Dn(n.node);if((n=uy(function(e,n,t){void 0===t&&(t=!0);function o(t,e){return e=me(Xb([e]),function(e){return!t(e,n)}),r=r.concat(e),0===e.length}var r=[];return r.push(n),ay(Yb.Up,e,w(o,ma),n.node,t),ay(Yb.Down,e,w(o,ga),n.node,t),r}(e,n,o),t))&&Ec(n.node))return{node:(n=n).node,before:ny(n,t=t)<oy(n,t)}}return null}function sy(e,t){e.selection.setRng(t),wf(e,e.selection.getRng())}function ly(e,t,n){return Y.some(bv(e,t,n))}function fy(e,t,n,o,r,i){var u=t===Hc.Forwards,a=vs(e.getBody()),a=w(Lc,u?a.next:a.prev),r=u?o:r;if(!n.collapsed){var c=ha(n);if(i(c))return pv(t,e,c,t===Hc.Backwards,!1)}return i=Fc(t,e.getBody(),n),r(i)?hv(e,i.getNode(!u)):(c=Zh(u,a(i)),i=So(n.startContainer),c?r(c)?pv(t,e,c.getNode(!u),u,!1):(a=a(c))&&r(a)&&Vc(c,a)?pv(t,e,a.getNode(!u),u,!1):i?ly(e,c.toRange(),!1):Y.none():i?Y.some(n):Y.none())}function dy(t,e,n,o,r,i){var u=Fc(e,t.getBody(),n),a=j(u.getClientRects()),c=e===Yb.Down;if(!a)return Y.none();var s=(c?v0:h0)(t.getBody(),ey(1),u),l=me(s,ty(1)),f=a.left;if((s=uy(l,f))&&i(s.node)){a=Math.abs(f-s.left),i=Math.abs(f-s.right);return pv(e,t,s.node,a<i,!1)}if(n=o(u)?u.getNode():r(u)?u.getNode(!0):ha(n)){n=function(e,t,n,o){function r(e){return j(e.getClientRects())}var i,u,a,c,t=vs(t),s=[],l=0,f=1===e?(i=t.next,u=ga,a=ma,zc.after(o)):(i=t.prev,u=ma,a=ga,zc.before(o)),d=r(f);do{if(f.isVisible()&&!a(c=r(f),d)){if(0<s.length&&u(c,j(s))&&l++,(c=la(c)).position=f,c.line=l,n(c))return s;s.push(c)}}while(f=i(f));return s}(e,t.getBody(),ey(1),n),f=uy(me(n,ty(1)),f);if(f)return ly(t,f.position.toRange(),!1);if(f=j(me(n,ty(0))))return ly(t,f.position.toRange(),!1)}return 0===l.length?x0(t,c).filter(c?r:o).map(function(e){return bv(t,e.toRange(),!1)}):Y.none()}function my(t,e,n){return x0(t,e).filter(n).exists(function(e){return t.selection.setRng(e.toRange()),!0})}function gy(e,t,n){var o=vs(e.getBody()),r=w(Lc,1===t?o.next:o.prev);!n.collapsed||""===cc(e)||(o=e.dom.getParent(n.startContainer,"PRE"))&&(r(zc.fromRangeStart(n))||(n=e.dom.create(cc(e)),(!$t.ie||11<=$t.ie)&&(n.innerHTML='<br data-mce-bogus="1">'),n=n,1===t?e.$(o).after(n):e.$(o).before(n),e.selection.select(n,!0),e.selection.collapse()))}function py(t,e){return o=e?Hc.Forwards:Hc.Backwards,r=(n=t).selection.getRng(),fy(n,o,r,rg,ig,w0).orThunk(function(){return gy(n,o,r),Y.none()}).exists(function(e){return sy(t,e),!0});var n,o,r}function hy(t,e){return o=e?1:-1,r=(n=t).selection.getRng(),dy(n,o,r,function(e){return rg(e)||ng(e)},function(e){return ig(e)||og(e)},w0).orThunk(function(){return gy(n,o,r),Y.none()}).exists(function(e){return sy(t,e),!0});var n,o,r}function vy(e,t){return my(e,t,t?ig:rg)}function by(e){return ee(["figcaption"],Qt(e))}function yy(e){var t=document.createRange();return t.setStartBefore(e.dom),t.setEndBefore(e.dom),t}function xy(e,t,n){(n?mn:dn)(e,t)}function wy(a,c){var s=Jt.fromDom(a.getBody()),l=zc.fromRangeStart(a.selection.getRng()),f=cc(a),d=sc(a),e=l,t=w(Pe,s);return Xn(Jt.fromDom(e.container()),Wo,t).filter(by).exists(function(){if(r=s,u=l,(i=c)?(i=r.dom,Jb(i,u).breakAt.isNone()):(r=r.dom,Kb(r,u).breakAt.isNone())){i=(e=s,t=d,n=c,""===(i=f)?(r=e,u=n,o=Jt.fromTag("br"),xy(r,o,u),yy(o)):(o=e,e=n,n=t,t=Jt.fromTag(i),i=Jt.fromTag("br"),mt(t,n),mn(t,i),xy(o,t,e),yy(i)));return a.selection.setRng(i),!0}var e,t,n,o,r,i,u;return!1})}function Cy(e,t){return!!e.selection.isCollapsed()&&wy(e,t)}function Sy(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return function(){return e.apply(null,t)}}function ky(e,t){return D((n=t,v(E(e,function(e){return we({shiftKey:!1,altKey:!1,ctrlKey:!1,metaKey:!1,keyCode:0,action:U},e)}),function(e){return n.keyCode===e.keyCode&&n.shiftKey===e.shiftKey&&n.altKey===e.altKey&&n.ctrlKey===e.ctrlKey&&n.metaKey===e.metaKey?[e]:[]})),function(e){return e.action()});var n}function Oy(t,e){var n=e?Hc.Forwards:Hc.Backwards,e=t.selection.getRng();return fy(t,n,e,eg,tg,Dn).exists(function(e){return sy(t,e),!0})}function _y(t,e){var n=e?1:-1,e=t.selection.getRng();return dy(t,n,e,eg,tg,Dn).exists(function(e){return sy(t,e),!0})}function Ey(e,t){return my(e,t,t?tg:eg)}function Ty(t,e,n,o){var r,i,u,a=t.selection.getRng(),c=e?1:-1;return!(!_c()||(r=e,i=n,u=zc.fromRangeStart(a),!Ss(!r,i).exists(function(e){return e.isEqual(u)}))||(pv(c,t,n,!e,!1).each(function(e){sy(t,e)}),0))}function Dy(a,c,s){var e=function(e,t){e=t.getNode(e);return yn(e)&&"TABLE"===e.nodeName?Y.some(e):Y.none()}(!!c,s),t=!1===c;e.fold(function(){return sy(a,s.toRange())},function(u){return Ss(t,a.getBody()).filter(function(e){return e.isEqual(s)}).fold(function(){return sy(a,s.toRange())},function(e){var n,o,r=c,i=u,t=s;(o=cc(n=a))?n.undoManager.transact(function(){var e=Jt.fromTag(o);mt(e,sc(n)),mn(e,Jt.fromTag("br")),(r?fn:ln)(Jt.fromDom(i),e);var t=n.dom.createRng();t.setStart(e.dom,0),t.setEnd(e.dom,0),sy(n,t)}):sy(n,t.toRange())})})}function Ay(e,t,n,o){var r,i,u,a,c,s,l,f,d,m,g=e.selection.getRng(),p=zc.fromRangeStart(g),g=e.getBody();if(t||!k0(o,p))return!(!t||!O0(o,p))&&(r=g,d=i=n,m=u=p,h=N(m.getClientRects()).bind(function(e){return S0(d,e.left,e.top)}).bind(function(e){return Gb(Ml(t=e).map(function(e){return[e].concat(Jb(t,e).positions)}).getOr([]),m);var t}).orThunk(function(){return C(u.getClientRects()).bind(function(e){return qb(Zb(r,zc.after(i)),e.left)})}).getOr(zc.after(i)),Dy(e,t,h),!0);var h=(a=g,l=c=n,f=s=p,C(f.getClientRects()).bind(function(e){return C0(l,e.left,e.top)}).bind(function(e){return Gb(Il(t=e).map(function(e){return Kb(t,e).positions.concat(e)}).getOr([]),f);var t}).orThunk(function(){return C(s.getClientRects()).bind(function(e){return qb(Qb(a,zc.before(c)),e.left)})}).getOr(zc.before(c)));return Dy(e,t,h),!0}function By(n,o,r){return Y.from(n.dom.getParent(n.selection.getNode(),"td,th")).bind(function(t){return Y.from(n.dom.getParent(t,"table")).map(function(e){return r(n,o,e,t)})}).getOr(!1)}function Ny(e,t){return By(e,t,Ty)}function Ry(e,t){return By(e,t,Ay)}function My(e,t){var n,o,r=t,i=e.dom,u=e.schema.getMoveCaretBeforeOnEnterElements();if(t){!/^(LI|DT|DD)$/.test(t.nodeName)||(o=function(e){for(;e;){if(1===e.nodeType||3===e.nodeType&&e.data&&/[\r\n\s]/.test(e.data))return e;e=e.nextSibling}}(t.firstChild))&&/^(UL|OL|DL)$/.test(o.nodeName)&&t.insertBefore(i.doc.createTextNode(Qo),t.firstChild);var a=i.createRng();if(t.normalize(),t.hasChildNodes()){for(var c=new vo(t,t);n=c.current();){if(wn(n)){a.setStart(n,0),a.setEnd(n,0);break}if(u[n.nodeName.toLowerCase()]){a.setStartBefore(n),a.setEndBefore(n);break}r=n,n=c.next()}n||(a.setStart(r,0),a.setEnd(r,0))}else On(t)?t.nextSibling&&i.isBlock(t.nextSibling)?(a.setStartBefore(t),a.setEndBefore(t)):(a.setStartAfter(t),a.setEndAfter(t)):(a.setStart(t,0),a.setEnd(t,0));e.selection.setRng(a),wf(e,a)}}function Iy(e){return Y.from(e.dom.getParent(e.selection.getStart(!0),e.dom.isBlock))}function Fy(e,t){return e&&e.parentNode&&e.parentNode.nodeName===t}function Py(e){return e&&/^(OL|UL|LI)$/.test(e.nodeName)}function Ly(e){var t=e.parentNode;return/^(LI|DT|DD)$/.test(t.nodeName)?t:e}function Vy(e,t,n){for(var o=e[n?"firstChild":"lastChild"];o&&!yn(o);)o=o[n?"nextSibling":"previousSibling"];return o===t}function Hy(e){e.innerHTML='<br data-mce-bogus="1">'}function zy(e,t){return e.nodeName===t||e.previousSibling&&e.previousSibling.nodeName===t}function jy(e,t){return t&&e.isBlock(t)&&!/^(TD|TH|CAPTION|FORM)$/.test(t.nodeName)&&!/^(fixed|absolute)/i.test(t.style.position)&&"true"!==e.getContentEditable(t)}function Uy(e,t,n){return!1===wn(t)?n:e?1===n&&t.data.charAt(n-1)===Zo?0:n:n===t.data.length-1&&t.data.charAt(n)===Zo?t.data.length:n}function Wy(e,t){for(var n,o=e.getRoot(),r=t;r!==o&&"false"!==e.getContentEditable(r);)"true"===e.getContentEditable(r)&&(n=r),r=r.parentNode;return r!==o?n:o}function qy(e,t){var n=cc(e);n&&n.toLowerCase()===t.tagName.toLowerCase()&&function(e,n,t){var o=e.dom;Y.from(t.style).map(o.parseStyle).each(function(e){var t=xt(Jt.fromDom(n)),e=we(we({},t),e);o.setStyles(n,e)});var r=Y.from(t.class).map(function(e){return e.split(/\s+/)}),e=Y.from(n.className).map(function(e){return me(e.split(/\s+/),function(e){return""!==e})});sa(r,e,function(t,e){e=me(e,function(e){return!ee(t,e)}),e=Ce(t,e);o.setAttrib(n,"class",e.join(" "))});var i=["style","class"],t=I(t,function(e,t){return!ee(i,t)});o.setAttribs(n,t)}(e,t,sc(e))}function Gy(u,e){function t(e){var t,n=g,o=f.getTextInlineElements(),r=e||"TABLE"===s||"HR"===s?l.create(e||h):a.cloneNode(!1),i=r;if(!1===u.getParam("keep_styles",!0))l.setAttrib(r,"style",null),l.setAttrib(r,"class",null);else for(;o[n.nodeName]&&(ks(n)||Rs(n)||(t=n.cloneNode(!1),l.setAttrib(t,"id",""),r.hasChildNodes()?t.appendChild(r.firstChild):i=t,r.appendChild(t))),(n=n.parentNode)&&n!==O;);return qy(u,r),Hy(i),r}function n(){c=/^(H[1-6]|PRE|FIGURE)$/.test(s)&&"HGROUP"!==y?t(h):t(),u.getParam("end_container_on_empty_block",!1)&&jy(l,o)&&l.isEmpty(a)?c=l.split(o,a):l.insertAfter(c,a),My(u,c)}var a,c,o,s,i,l=u.dom,f=u.schema,d=f.getNonEmptyElements(),r=u.selection.getRng(),m=function(e){var t,n,o=Uy(e,g,p);if(wn(g)&&(e?0<o:o<g.nodeValue.length))return!1;if(g.parentNode===a&&i&&!e)return!0;if(e&&yn(g)&&g===a.firstChild)return!0;if(zy(g,"TABLE")||zy(g,"HR"))return i&&!e||!i&&e;var r=new vo(g,a);for(wn(g)&&(e&&0===o?r.prev():e||o!==g.nodeValue.length||r.next());t=r.current();){if(yn(t)){if(!t.getAttribute("data-mce-bogus")&&(n=t.nodeName.toLowerCase(),d[n]&&"br"!==n))return!1}else if(wn(t)&&!dr(t.nodeValue))return!1;e?r.prev():r.next()}return!0};rf(l,r).each(function(e){r.setStart(e.startContainer,e.startOffset),r.setEnd(e.endContainer,e.endOffset)});var g=r.startContainer,p=r.startOffset,h=cc(u),v=!(!e||!e.shiftKey),b=!(!e||!e.ctrlKey);yn(g)&&g.hasChildNodes()&&(i=p>g.childNodes.length-1,g=g.childNodes[Math.min(p,g.childNodes.length-1)]||g,p=i&&wn(g)?g.nodeValue.length:0);var y,h,x,w,C,S,k,O=Wy(l,g);O&&((h&&!v||!h&&v)&&(g=function(e,t,n,o){var r,i,u,a,c,s=h||"P",l=e.dom,f=Wy(l,n),d=l.getParent(n,l.isBlock);if(!d||!jy(l,d)){if(c=((d=d||f)===e.getBody()||(c=d)&&/^(TD|TH|CAPTION)$/.test(c.nodeName)?d:d.parentNode).nodeName.toLowerCase(),!d.hasChildNodes())return r=l.create(s),qy(e,r),d.appendChild(r),t.setStart(r,0),t.setEnd(r,0),r;for(u=n;u.parentNode!==d;)u=u.parentNode;for(;u&&!l.isBlock(u);)u=(i=u).previousSibling;if(i&&e.schema.isValidChild(c,s.toLowerCase())){for(r=l.create(s),qy(e,r),i.parentNode.insertBefore(r,i),u=i;u&&!l.isBlock(u);)a=u.nextSibling,r.appendChild(u),u=a;t.setStart(n,o),t.setEnd(n,o)}}return n}(u,r,g,p)),a=l.getParent(g,l.isBlock),o=a?l.getParent(a.parentNode,l.isBlock):null,s=a?a.nodeName.toUpperCase():"","LI"!==(y=o?o.nodeName.toUpperCase():"")||b||(o=(a=o).parentNode,s=y),/^(LI|DT|DD)$/.test(s)&&l.isEmpty(a)?(w=t,C=o,S=a,k=h,e=(x=u).dom,v=x.selection.getRng(),C!==x.getBody()&&(w=(k=Py(b=C)&&Py(b.parentNode)?"LI":k)?w(k):e.create("BR"),Vy(C,S,!0)&&Vy(C,S,!1)?Fy(C,"LI")?e.insertAfter(w,Ly(C)):e.replace(w,C):Vy(C,S,!0)?Fy(C,"LI")?(e.insertAfter(w,Ly(C)),w.appendChild(e.doc.createTextNode(" ")),w.appendChild(C)):C.parentNode.insertBefore(w,C):Vy(C,S,!1)?e.insertAfter(w,Ly(C)):(C=Ly(C),(v=v.cloneRange()).setStartAfter(S),v.setEndAfter(C),v=v.extractContents(),"LI"===k&&(v.firstChild&&"LI"===v.firstChild.nodeName)?(w=v.firstChild,e.insertAfter(v,C)):(e.insertAfter(v,C),e.insertAfter(w,C))),e.remove(S),My(x,w))):h&&a===u.getBody()||(h=h||"P",So(a)?(c=Bo(a),l.isEmpty(a)&&Hy(a),qy(u,c),My(u,c)):m()?n():m(!0)?(c=a.parentNode.insertBefore(t(),a),My(u,zy(a,"HR")?c:a)):((m=(w=r).cloneRange()).setStart(w.startContainer,Uy(!0,w.startContainer,w.startOffset)),m.setEnd(w.endContainer,Uy(!1,w.endContainer,w.endOffset)),(m=m.cloneRange()).setEndAfter(a),m=m.extractContents(),de(_a(Jt.fromDom(m),en),function(e){e=e.dom;e.nodeValue=Co(e.nodeValue)}),function(e){for(;wn(e)&&(e.nodeValue=e.nodeValue.replace(/^[\r\n]+/,"")),e=e.firstChild;);}(m),c=m.firstChild,l.insertAfter(m,a),function(e,t){var n,o,r=c,i=[];if(r){for(;r=r.firstChild;){if(e.isBlock(r))return;yn(r)&&!t[r.nodeName.toLowerCase()]&&i.push(r)}for(n=i.length;n--;)!(r=i[n]).hasChildNodes()||r.firstChild===r.lastChild&&""===r.firstChild.nodeValue?e.remove(r):(o=r)&&"A"===o.nodeName&&e.isEmpty(o)&&e.remove(r)}}(l,d),function(e,t){t.normalize();var n=t.lastChild;n&&!/^(left|right)$/gi.test(e.getStyle(n,"float",!0))||e.add(t,"br")}(l,a),l.isEmpty(a)&&Hy(a),c.normalize(),l.isEmpty(c)?(l.remove(c),n()):(qy(u,c),My(u,c))),l.setAttrib(c,"id",""),u.fire("NewBlock",{newBlock:c})))}function $y(e,t,n){var o=e.create("span",{},"&nbsp;");n.parentNode.insertBefore(o,n),t.scrollIntoView(o),e.remove(o)}function Xy(e,t,n,o){e=e.createRng(),o?(e.setStartBefore(n),e.setEndBefore(n)):(e.setStartAfter(n),e.setEndAfter(n)),t.setRng(e)}function Yy(e,t){var n=Jt.fromTag("br");ln(Jt.fromDom(t),n),e.undoManager.add()}function Ky(e,t){_0(e.getBody(),t)||fn(Jt.fromDom(t),Jt.fromTag("br"));var n=Jt.fromTag("br");fn(Jt.fromDom(t),n),$y(e.dom,e.selection,n.dom),Xy(e.dom,e.selection,n.dom,!1),e.undoManager.add()}function Jy(e){return e&&"A"===e.nodeName&&"href"in e}function Qy(e){return e.fold(W,Jy,Jy,W)}function Zy(e,t){t.fold(U,w(Yy,e),w(Ky,e),U)}function e0(e,t){var n,o,r=(o=w(Jh,n=e),r=zc.fromRangeStart(n.selection.getRng()),qv(o,n.getBody(),r).filter(Qy));r.isSome()?r.each(w(Zy,e)):function(e,t){var n,o,r=e.selection,i=e.dom,u=r.getRng();rf(i,u).each(function(e){u.setStart(e.startContainer,e.startOffset),u.setEnd(e.endContainer,e.endOffset)});var a=u.startOffset,c=u.startContainer;1===c.nodeType&&c.hasChildNodes()&&(f=a>c.childNodes.length-1,c=c.childNodes[Math.min(a,c.childNodes.length-1)]||c,a=f&&3===c.nodeType?c.nodeValue.length:0);var s=i.getParent(c,i.isBlock),l=s?i.getParent(s.parentNode,i.isBlock):null,f=l?l.nodeName.toUpperCase():"",t=!(!t||!t.ctrlKey);"LI"!==f||t||(s=l),c&&3===c.nodeType&&a>=c.nodeValue.length&&!function(e){for(var t,n=new vo(c,s),o=e.getNonEmptyElements();t=n.next();)if(o[t.nodeName.toLowerCase()]||0<t.length)return 1}(e.schema)&&(n=i.create("br"),u.insertNode(n),u.setStartAfter(n),u.setEndAfter(n),o=!0),n=i.create("br"),$a(i,u,n),$y(i,r,n),Xy(i,r,n,o),e.undoManager.add()}(e,t)}function t0(e,t){return Iy(e).filter(function(e){return 0<t.length&&Ie(Jt.fromDom(e),t)}).isSome()}function n0(e,t){return t0(e,e.getParam("no_newline_selector",""))}function o0(n){return function(e,t){return""===cc(e)===n}}function r0(n){return function(e,t){return Iy(e).filter(function(e){return $o(Jt.fromDom(e))}).isSome()===n}}function i0(n,o){return function(e,t){return Iy(e).fold(_(""),function(e){return e.nodeName.toUpperCase()})===n.toUpperCase()===o}}function u0(e){return i0("pre",e)}function a0(n){return function(e,t){return e.getParam("br_in_pre",!0)===n}}function c0(e,t){return t0(e,e.getParam("br_newline_selector",".mce-toc h2,figcaption,caption"))}function s0(e,t){return t}function l0(e){var t=cc(e),n=function(e,t){for(var n,o=e.getRoot(),r=t;r!==o&&"false"!==e.getContentEditable(r);)"true"===e.getContentEditable(r)&&(n=r),r=r.parentNode;return r!==o?n:o}(e.dom,e.selection.getStart());return n&&e.schema.isValidChild(n.nodeName,t||"P")}function f0(e,t){return function(n,o){return T(e,function(e,t){return e&&t(n,o)},!0)?Y.some(t):Y.none()}}function d0(e,t){var n,o;n=e,o=t,Fv([f0([n0],E0.none()),f0([i0("summary",!0)],E0.br()),f0([u0(!0),a0(!1),s0],E0.br()),f0([u0(!0),a0(!1)],E0.block()),f0([u0(!0),a0(!0),s0],E0.block()),f0([u0(!0),a0(!0)],E0.br()),f0([r0(!0),s0],E0.br()),f0([r0(!0)],E0.block()),f0([o0(!0),s0,l0],E0.block()),f0([o0(!0)],E0.br()),f0([c0],E0.br()),f0([o0(!1),s0],E0.br()),f0([l0],E0.block())],[n,!(!o||!o.shiftKey)]).getOr(E0.none()).fold(function(){e0(e,t)},function(){Gy(e,t)},U)}function m0(r,i){return function(e){return n=r,(!Gd(o=e)&&(t=o,Rl((e=n).dom,t).isNone()||Nl(e.dom,t).isNone()||ug(e,t)||ag(e,t)||zd(e,t)||Hd(e,t)||Wd(n,o)||qd(n,o))?D0:A0)(i);var t,n,o}}function g0(e){var t,n,o=zc.fromRangeStart(e.selection.getRng()),r=Jt.fromDom(e.getBody());if(e.selection.isCollapsed()){var i=w(Jh,e),u=zc.fromRangeStart(e.selection.getRng());return qv(i,e.getBody(),u).bind((n=r,function(e){return e.fold(function(e){return Rl(n.dom,zc.before(e))},function(e){return Ml(e)},function(e){return Il(e)},function(e){return Nl(n.dom,zc.after(e))})})).bind(m0(r,o)).exists((t=e,function(e){return t.selection.setRng(e.toRange()),t.nodeChanged(),!0}))}return!1}function p0(e){var n,t,o,r,i,u,a,c,s,l,f=ob(e);return e.on("keyup compositionstart",w(Sb,e)),l=f,(s=e).on("keydown",function(e){var t,n,o;!1===e.isDefaultPrevented()&&(t=s,n=l,o=e,e=Gt().os,ky([{keyCode:sf.RIGHT,action:Sy(py,t,!0)},{keyCode:sf.LEFT,action:Sy(py,t,!1)},{keyCode:sf.UP,action:Sy(hy,t,!1)},{keyCode:sf.DOWN,action:Sy(hy,t,!0)},{keyCode:sf.RIGHT,action:Sy(Ny,t,!0)},{keyCode:sf.LEFT,action:Sy(Ny,t,!1)},{keyCode:sf.UP,action:Sy(Ry,t,!1)},{keyCode:sf.DOWN,action:Sy(Ry,t,!0)},{keyCode:sf.RIGHT,action:Sy(Oy,t,!0)},{keyCode:sf.LEFT,action:Sy(Oy,t,!1)},{keyCode:sf.UP,action:Sy(_y,t,!1)},{keyCode:sf.DOWN,action:Sy(_y,t,!0)},{keyCode:sf.RIGHT,action:Sy(nb,t,n,!0)},{keyCode:sf.LEFT,action:Sy(nb,t,n,!1)},{keyCode:sf.RIGHT,ctrlKey:!e.isOSX(),altKey:e.isOSX(),action:Sy(zb,t,n)},{keyCode:sf.LEFT,ctrlKey:!e.isOSX(),altKey:e.isOSX(),action:Sy(jb,t,n)},{keyCode:sf.UP,action:Sy(Cy,t,!1)},{keyCode:sf.DOWN,action:Sy(Cy,t,!0)}],o).each(function(e){o.preventDefault()}))}),c=f,(a=e).on("keydown",function(e){var t,n;!1===e.isDefaultPrevented()&&(t=c,n=e,ky([{keyCode:sf.BACKSPACE,action:Sy(vb,e=a,!1)},{keyCode:sf.BACKSPACE,action:Sy(Ev,e,!1)},{keyCode:sf.DELETE,action:Sy(Ev,e,!0)},{keyCode:sf.BACKSPACE,action:Sy(Cv,e,!1)},{keyCode:sf.DELETE,action:Sy(Cv,e,!0)},{keyCode:sf.BACKSPACE,action:Sy(ub,e,t,!1)},{keyCode:sf.DELETE,action:Sy(ub,e,t,!0)},{keyCode:sf.BACKSPACE,action:Sy(_m,e,!1)},{keyCode:sf.DELETE,action:Sy(_m,e,!0)},{keyCode:sf.BACKSPACE,action:Sy(Tv,e,!1)},{keyCode:sf.DELETE,action:Sy(Tv,e,!0)},{keyCode:sf.BACKSPACE,action:Sy(fb,e,!1)},{keyCode:sf.DELETE,action:Sy(fb,e,!0)},{keyCode:sf.BACKSPACE,action:Sy(gv,e,!1)},{keyCode:sf.DELETE,action:Sy(gv,e,!0)},{keyCode:sf.BACKSPACE,action:Sy(fv,e,!1)},{keyCode:sf.DELETE,action:Sy(fv,e,!0)},{keyCode:sf.BACKSPACE,action:Sy(sb,e,!1)},{keyCode:sf.DELETE,action:Sy(sb,e,!0)}],n).each(function(e){n.preventDefault()}))}),a.on("keyup",function(e){var t;!1===e.isDefaultPrevented()&&(t=e,ky([{keyCode:sf.BACKSPACE,action:Sy(_v,e=a)},{keyCode:sf.DELETE,action:Sy(_v,e)}],t))}),(u=e).on("keydown",function(e){var t,n;e.keyCode===sf.ENTER&&(t=u,(n=e).isDefaultPrevented()||(n.preventDefault(),(e=t.undoManager).typing&&(e.typing=!1,e.add()),t.undoManager.transact(function(){!1===t.selection.isCollapsed()&&t.execCommand("Delete"),d0(t,n)})))}),(i=e).on("keydown",function(e){var t;!1===e.isDefaultPrevented()&&(t=e,ky([{keyCode:sf.SPACEBAR,action:Sy(g0,i)}],t).each(function(e){t.preventDefault()}))}),o=t=e,r=$u(function(){o.composing||Zd(o)},0),T0.isIE()&&(o.on("keypress",function(e){r.throttle()}),o.on("remove",function(e){r.cancel()})),t.on("input",function(e){!1===e.isComposing&&Zd(t)}),(n=e).on("keydown",function(e){var t;!1===e.isDefaultPrevented()&&(t=e,ky([{keyCode:sf.END,action:Sy(vy,e=n,!0)},{keyCode:sf.HOME,action:Sy(vy,e,!1)},{keyCode:sf.END,action:Sy(Ey,e,!0)},{keyCode:sf.HOME,action:Sy(Ey,e,!1)}],t).each(function(e){t.preventDefault()}))}),f}var Mt=function(r,i,u,e,a,t){function n(e){var t,n,o=Xb([e]);for(-1===r&&(o=o.reverse()),t=0;t<o.length;t++)if(n=o[t],!u(n,l)){if(0<s.length&&i(n,j(s))&&c++,n.line=c,a(n))return!0;s.push(n)}}var c=0,s=[],l=j(t.getClientRects());if(!l)return s;t=t.getNode();return n(t),function(e,t,n,o){for(;o=Dc(o,e,Ro,t);)if(n(o))return}(r,e,n,t),s},h0=w(Mt,Yb.Up,ma,ga),v0=w(Mt,Yb.Down,ga,ma),b0=Tn,y0=Dc,x0=function(e,t){var n=e.selection.getRng(),e=e.getBody();if(t){var o=zc.fromRangeEnd(n),r=Jb(e,o);return N(r.positions)}return o=zc.fromRangeStart(n),r=Kb(e,o),C(r.positions)},w0=Tn,Dt=function(e,t,n,o,r){var i,n=Zu(Jt.fromDom(n),"td,th,caption").map(function(e){return e.dom}),n=me((i=e,v(n,function(e){var t={left:(t=la(e.getBoundingClientRect())).left- -1,top:t.top- -1,right:t.right+-2,bottom:t.bottom+-2,width:t.width+-1,height:t.height+-1};return[{x:t.left,y:i(t),cell:e},{x:t.right,y:i(t),cell:e}]})),function(e){return t(e,r)}),u=o,a=r;return T(n,function(e,o){return e.fold(function(){return Y.some(o)},function(e){var t=Math.sqrt(Math.abs(e.x-u)+Math.abs(e.y-a)),n=Math.sqrt(Math.abs(o.x-u)+Math.abs(o.y-a));return Y.some(n<t?o:e)})},Y.none()).map(function(e){return e.cell})},C0=w(Dt,function(e){return e.bottom},function(e,t){return e.y<t}),S0=w(Dt,function(e){return e.top},function(e,t){return e.y>t}),Rt=function(e,t,n){var o,r,i=e(t,n);return i.breakType===kb.Wrap&&0===i.positions.length||!On(n.getNode())&&i.breakType===kb.Br&&1===i.positions.length?(o=e,r=t,!i.breakAt.exists(function(e){return o(r,e).breakAt.isSome()})):i.breakAt.isNone()},k0=w(Rt,Kb),O0=w(Rt,Jb),_0=function(e,t){return n=zc.after(t),!!On(n.getNode())||Nl(e,zc.after(t)).map(function(e){return On(e.getNode())}).getOr(!1);var n},E0=e([{br:[]},{block:[]},{none:[]}]),T0=Gt().browser,K=function(n,o){var e=o.container(),t=o.offset();return wn(e)?(e.insertData(t,n),Y.some(qa(e,t+n.length))):Pc(o).map(function(e){var t=Jt.fromText(n);return(o.isAtEnd()?fn:ln)(e,t),qa(t.dom,n.length)})},D0=w(K,Qo),A0=w(K," "),B0=(N0.prototype.nodeChanged=function(e){var t,n,o=this.editor.selection;this.editor.initialized&&o&&!this.editor.getParam("disable_nodechange")&&!this.editor.mode.isReadOnly()&&(n=this.editor.getBody(),(o=o.getStart(!0)||n).ownerDocument===this.editor.getDoc()&&this.editor.dom.isChildOf(o,n)||(o=n),t=[],this.editor.dom.getParent(o,function(e){return e===n||void t.push(e)}),(e=e||{}).element=o,e.parents=t,this.editor.fire("NodeChange",e))},N0.prototype.isSameElementPath=function(e){var t,n=this.editor.$(e).parentsUntil(this.editor.getBody()).add(e);if(n.length===this.lastPath.length){for(t=n.length;0<=t&&n[t]===this.lastPath[t];t--);if(-1===t)return this.lastPath=n,!0}return this.lastPath=n,!1},N0);function N0(n){var o;this.lastPath=[],this.editor=n;var t=this;"onselectionchange"in n.getDoc()||n.on("NodeChange click mouseup keyup focus",function(e){var t=n.selection.getRng(),t={startContainer:t.startContainer,startOffset:t.startOffset,endContainer:t.endContainer,endOffset:t.endOffset};"nodechange"!==e.type&&Ql(t,o)||n.fire("SelectionChange"),o=t}),n.on("contextmenu",function(){n.fire("SelectionChange")}),n.on("SelectionChange",function(){var e=n.selection.getStart(!0);!e||!$t.range&&n.selection.isCollapsed()||pl(n)&&!t.isSameElementPath(e)&&n.dom.isChildOf(e,n.getBody())&&n.nodeChanged({selectionChange:!0})}),n.on("mouseup",function(e){!e.isDefaultPrevented()&&pl(n)&&("IMG"===n.selection.getNode().nodeName?mo.setEditorTimeout(n,function(){n.nodeChanged()}):n.nodeChanged())})}function R0(e){return yn(e)&&qo(Jt.fromDom(e))}function M0(e){var t=e.getBoundingClientRect(),e=(n=e.ownerDocument).documentElement,n=n.defaultView;return{top:t.top+n.pageYOffset-e.clientTop,left:t.left+n.pageXOffset-e.clientLeft}}function I0(e){e&&e.parentNode&&e.parentNode.removeChild(e)}function F0(e,s){var l=mo.throttle(function(e,t){s._selectionOverrides.hideFakeCaret(),s.selection.placeCaretAt(e,t)},0);return s.on("remove",l.stop),function(c){return e.on(function(e){var t,n,o,r,i,u,a=Math.max(Math.abs(c.screenX-e.screenX),Math.abs(c.screenY-e.screenY));if(!e.dragging&&10<a){if(s.fire("dragstart",{target:e.element}).isDefaultPrevented())return;e.dragging=!0,s.focus()}e.dragging&&(t=e,i={pageX:(o=c,r=(n=s).inline?M0(n.getBody()):{left:0,top:0},u=(i=n).getBody(),u=i.inline?{left:u.scrollLeft,top:u.scrollTop}:{left:0,top:0},(a={pageX:(o=function(e,t){if(t.target.ownerDocument===e.getDoc())return{left:t.pageX,top:t.pageY};var n,o,r=M0(e.getContentAreaContainer()),i=(o=(n=e).getBody(),i=n.getDoc().documentElement,e={left:o.scrollLeft,top:o.scrollTop},i={left:o.scrollLeft||i.scrollLeft,top:o.scrollTop||i.scrollTop},n.inline?e:i);return{left:t.pageX-r.left+i.left,top:t.pageY-r.top+i.top}}(n,o)).left-r.left+u.left,pageY:o.top-r.top+u.top}).pageX-t.relX),pageY:a.pageY+5},n=e.ghost,o=s.getBody(),n.parentNode!==o&&o.appendChild(n),r=e.ghost,u=e.width,t=e.height,a=e.maxX,o=e.maxY,e=n=0,r.style.left=(i=i).pageX+"px",r.style.top=i.pageY+"px",o<i.pageY+t&&(e=i.pageY+t-o),r.style.width=u-(n=a<i.pageX+u?i.pageX+u-a:n)+"px",r.style.height=t-e+"px",l(c.clientX,c.clientY))})}}function P0(e){function t(e){var t,n,o,r;0===e.button&&(t=D(s.dom.getParents(e.target),function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return function(e){for(var t=0;t<n.length;t++)if(n[t](e))return!0;return!1}}(ox,rx)).getOr(null),o=s.getBody(),ox(r=t)&&r!==o&&(n=s.dom.getPos(t),r=s.getBody(),o=s.getDoc().documentElement,c.set({element:t,dragging:!1,screenX:e.screenX,screenY:e.screenY,maxX:(s.inline?r.scrollWidth:o.offsetWidth)-2,maxY:(s.inline?r.scrollHeight:o.offsetHeight)-2,relX:e.pageX-n.x,relY:e.pageY-n.y,width:t.offsetWidth,height:t.offsetHeight,ghost:function(e,t,n){var o=s.dom,r=e.cloneNode(!0);o.setStyles(r,{width:t,height:n}),o.setAttrib(r,"data-mce-selected",null);e=o.create("div",{class:"mce-drag-container","data-mce-bogus":"all",unselectable:"on",contenteditable:"false"});return o.setStyles(e,{position:"absolute",opacity:.5,overflow:"hidden",border:0,padding:0,margin:0,width:t,height:n}),o.setStyles(r,{margin:0,boxSizing:"border-box"}),e.appendChild(r),e}(t,t.offsetWidth,t.offsetHeight)})))}function n(i){u.on(function(e){var t,n,o,r;e.dragging&&((o=3===(r=(n=a).selection.getSel().getRangeAt(0).startContainer).nodeType?r.parentNode:r)===(r=e.element)||n.dom.isChildOf(o,r)||ox(o)||((o=e.element.cloneNode(!0)).removeAttribute("data-mce-selected"),t=o,a.fire("drop",{clientX:i.clientX,clientY:i.clientY}).isDefaultPrevented()||a.undoManager.transact(function(){I0(e.element),a.insertContent(a.dom.getOuterHTML(t)),a._selectionOverrides.hideFakeCaret()})))}),ix(u)}var o,r,i,u,a,c,s,l=(o=zu(Y.none()),{clear:function(){return o.set(Y.none())},set:function(e){return o.set(Y.some(e))},isSet:function(){return o.get().isSome()},on:function(e){return o.get().each(e)}}),f=Iu.DOM,d=document,m=F0(c=l,s=e),g=(r=u=l,function(){r.on(function(e){e.dragging&&i.fire("dragend")}),ix(r)});(i=a=e).on("mousedown",t),e.on("mousemove",m),e.on("mouseup",n),f.bind(d,"mousemove",m),f.bind(d,"mouseup",g),e.on("remove",function(){f.unbind(d,"mousemove",m),f.unbind(d,"mouseup",g)})}function L0(e,t){return $l(e.getBody(),t)}function V0(l){function f(e){return e!==w&&(ax(e)||Dn(e))&&y.isChildOf(e,w)}function d(e){e&&b.setRng(e)}function m(e,t,n,o){return void 0===o&&(o=!0),l.fire("ShowCaret",{target:t,direction:e,before:n}).isDefaultPrevented()?null:(o&&b.scrollIntoView(t,-1===e),C.show(n,t))}function t(e){return Oo(e)||Do(e)||Ao(e)}function g(e){return t(e.startContainer)||t(e.endContainer)}function p(e,t){if(!e)return null;if(e.collapsed){if(!g(e)){var n=t?1:-1,o=Fc(n,w,e),r=o.getNode(!t);if(Ec(r))return m(n,r,!!t&&!o.isAtEnd(),!1);r=o.getNode(t);if(Ec(r))return m(n,r,!t&&!o.isAtEnd(),!1)}return null}if(r=e.startContainer,t=e.startOffset,o=e.endOffset,3===r.nodeType&&0===t&&ax(r.parentNode)&&(r=r.parentNode,t=y.nodeIndex(r),r=r.parentNode),1!==r.nodeType)return null;if(o===t+1&&r===e.endContainer){t=r.childNodes[t];if(f(t))return function(e){var t=e.cloneNode(!0),n=l.fire("ObjectSelected",{target:e,targetClone:t});if(n.isDefaultPrevented())return null;var t=function(e,t,n){var o=l.$,r=Kn(Jt.fromDom(l.getBody()),"#"+S).fold(function(){return o([])},function(e){return o([e.dom])});0===r.length&&(r=o('<div data-mce-bogus="all" class="mce-offscreen-selection"></div>').attr("id",S)).appendTo(l.getBody());var i=y.createRng();t===n&&$t.ie?(r.empty().append('<p style="font-size: 0" data-mce-bogus="all"> </p>').append(t),i.setStartAfter(r[0].firstChild.firstChild),i.setEndAfter(t)):(r.empty().append(Qo).append(t).append(Qo),i.setStart(r[0].firstChild,1),i.setEnd(r[0].lastChild,0)),r.css({top:y.getPos(e,l.getBody()).y}),r[0].focus();r=b.getSel();return r.removeAllRanges(),r.addRange(i),i}(e,n.targetClone,t),o=Jt.fromDom(e);return de(Zu(Jt.fromDom(l.getBody()),"*[data-mce-selected]"),function(e){Pe(o,e)||ht(e,i)}),y.getAttrib(e,i)||e.setAttribute(i,"1"),v=e,O(),t}(t)}return null}function h(){v&&v.removeAttribute(i),Kn(Jt.fromDom(l.getBody()),"#"+S).each(gn),v=null}var v,b=l.selection,y=l.dom,x=y.isBlock,w=l.getBody(),C=Oc(l,w,x,function(){return Vf(l)}),S="sel-"+y.uniqueId(),i="data-mce-selected",k=b.getRng,O=function(){C.hide()};return $t.ceFalse&&function(){l.on("mouseup",function(e){var t=k();t.collapsed&&sh(l,e.clientX,e.clientY)&&vv(l,t,!1).each(d)}),l.on("click",function(e){var t=L0(l,e.target);t&&(ax(t)&&(e.preventDefault(),l.focus()),ux(t)&&y.isChildOf(t,b.getNode())&&h())}),l.on("blur NewBlock",h),l.on("ResizeWindow FullscreenStateChanged",C.reposition);function o(e,t){var n=y.getParent(e,x),t=y.getParent(t,x);return!(!n||e===t||!y.isChildOf(n,t)||!1!==ax(L0(l,n)))||n&&(t=t,!(y.getParent(n,x)===y.getParent(t,x)))&&function(e){var t=vs(e);if(!e.firstChild)return!1;var e=zc.before(e.firstChild),e=t.next(e);return e&&!(rg(e=e)||ig(e)||eg(e)||tg(e))}(n)}var t,e,n,r,i,u,a,c,s;l.on("tap",function(e){var t=e.target,n=L0(l,t);ax(n)?(e.preventDefault(),hv(l,n).each(p)):f(t)&&hv(l,t).each(p)},!0),l.on("mousedown",function(e){var t,n=e.target;n!==w&&"HTML"!==n.nodeName&&!y.isChildOf(n,w)||!1===sh(l,e.clientX,e.clientY)||((t=L0(l,n))?ax(t)?(e.preventDefault(),hv(l,t).each(p)):(h(),ux(t)&&e.shiftKey||Xl(e.clientX,e.clientY,b.getRng())||(O(),b.placeCaretAt(e.clientX,e.clientY))):f(n)?hv(l,n).each(p):!1===Ec(n)&&(h(),O(),(t=cy(w,e.clientX,e.clientY))&&(o(n,t.node)||(e.preventDefault(),t=m(1,t.node,t.before,!1),l.getBody().focus(),d(t)))))}),l.on("keypress",function(e){sf.modifierPressed(e)||ax(b.getNode())&&e.preventDefault()}),l.on("GetSelectionRange",function(e){var t=e.range;v&&(v.parentNode?((t=t.cloneRange()).selectNode(v),e.range=t):v=null)}),l.on("SetSelectionRange",function(e){var t,n,o,r,i;e.range=(t=e.range,n=l.schema.getShortEndedElements(),u=y.createRng(),o=t.startContainer,r=t.startOffset,i=t.endContainer,t=t.endOffset,ye(n,o.nodeName.toLowerCase())?0===r?u.setStartBefore(o):u.setStartAfter(o):u.setStart(o,r),ye(n,i.nodeName.toLowerCase())?0===t?u.setEndBefore(i):u.setEndAfter(i):u.setEnd(i,t),u);var u=p(e.range,e.forward);u&&(e.range=u)}),l.on("AfterSetSelectionRange",function(e){var t=e.range,e=t.startContainer.parentNode;g(t)||"mcepastebin"===e.id||O(),y.hasClass(e,"mce-offscreen-selection")||h()}),l.on("copy",function(e){var t,n=e.clipboardData;e.isDefaultPrevented()||!e.clipboardData||$t.ie||(t=(t=y.get(S))?t.getElementsByTagName("*")[0]:t)&&(e.preventDefault(),n.clearData(),n.setData("text/html",t.outerHTML),n.setData("text/plain",t.outerText||t.innerText))}),P0(r=l),(i=r).on("drop",function(e){var t=void 0!==e.clientX?i.getDoc().elementFromPoint(e.clientX,e.clientY):null;!ox(t)&&"false"!==i.dom.getContentEditableParent(t)||e.preventDefault()}),r.getParam("block_unsupported_drop",!0,"boolean")&&(a=function(e){var t;e.defaultPrevented||(t=e.dataTransfer)&&(ee(t.types,"Files")||0<t.files.length)&&(e.preventDefault(),"drop"===e.type&&Nh(u,"Dropped file type is not supported"))},c=function(e){Mf(u,e.target)&&a(e)},s=function(){var t=Iu.DOM,n=u.dom,o=document,r=u.inline?u.getBody():u.getDoc(),e=["drop","dragover"];de(e,function(e){t.bind(o,e,c),n.bind(r,e,a)}),u.on("remove",function(){de(e,function(e){t.unbind(o,e,c),n.unbind(r,e,a)})})},(u=r).on("init",function(){mo.setEditorTimeout(u,s,0)})),e=$u(function(){var e;t.removed||!t.getBody().contains(document.activeElement)||(e=t.selection.getRng()).collapsed&&(e=bv(t,e,!1),t.selection.setRng(e))},0),(t=l).on("focus",function(){e.throttle()}),t.on("blur",function(){e.cancel()}),(n=l).on("init",function(){n.on("focusin",function(e){var t=e.target;Dn(t)&&(e=$l(n.getBody(),t),t=Tn(e)?e:t,n.selection.getNode()!==t&&hv(n,t).each(function(e){return n.selection.setRng(e)}))})})}(),{showCaret:m,showBlockCaretContainer:function(e){e.hasAttribute("data-mce-caret")&&(Bo(e),d(k()),b.scrollIntoView(e))},hideFakeCaret:O,destroy:function(){C.destroy(),v=null}}}function H0(i){function e(e,t){try{i.getDoc().execCommand(e,!1,t)}catch(e){}}function u(e){return e.isDefaultPrevented()}function t(){i.shortcuts.add("meta+a",null,"SelectAll")}function n(){i.on("keydown",function(e){if(!u(e)&&e.keyCode===s&&d.isCollapsed()&&0===d.getRng().startOffset){var t=d.getNode().previousSibling;if(t&&t.nodeName&&"table"===t.nodeName.toLowerCase())return e.preventDefault(),!1}})}var r,o,a,c=Kt.each,s=sf.BACKSPACE,l=sf.DELETE,f=i.dom,d=i.selection,m=i.parser,g=$t.gecko,p=$t.ie,h=$t.webkit,v="data:text/mce-internal,",b=p?"Text":"URL",p=function(){i.inline||(i.contentStyles.push("body {min-height: 150px}"),i.on("click",function(e){"HTML"===e.target.nodeName&&(11<$t.ie?i.getBody().focus():(e=i.selection.getRng(),i.getBody().focus(),i.selection.setRng(e),i.selection.normalize(),i.nodeChanged()))}))};return i.on("keydown",function(e){var t;if(!u(e)&&e.keyCode===sf.BACKSPACE){var n=(t=d.getRng()).startContainer,e=t.startOffset,o=f.getRoot(),r=n;if(t.collapsed&&0===e){for(;r&&r.parentNode&&r.parentNode.firstChild===r&&r.parentNode!==o;)r=r.parentNode;"BLOCKQUOTE"===r.tagName&&(i.formatter.toggle("blockquote",null,r),(t=f.createRng()).setStart(n,0),t.setEnd(n,0),d.setRng(t))}}}),r=function(e){var t=f.create("body"),e=e.cloneContents();return t.appendChild(e),d.serializer.serialize(t,{format:"html"})},i.on("keydown",function(e){var t,n,o=e.keyCode;u(e)||o!==l&&o!==s||(n=i.selection.isCollapsed(),t=i.getBody(),n&&!f.isEmpty(t)||!n&&(o=i.selection.getRng(),n=r(o),(o=f.createRng()).selectNode(i.getBody()),n!==r(o))||(e.preventDefault(),i.setContent(""),t.firstChild&&f.isBlock(t.firstChild)?i.selection.setCursorLocation(t.firstChild,0):i.selection.setCursorLocation(t,0),i.nodeChanged()))}),$t.windowsPhone||i.on("keyup focusin mouseup",function(e){sf.modifierPressed(e)||d.normalize()},!0),h&&(i.inline||f.bind(i.getDoc(),"mousedown mouseup",function(e){var t;e.target===i.getDoc().documentElement&&(t=d.getRng(),i.getBody().focus(),"mousedown"===e.type?Oo(t.startContainer)||d.placeCaretAt(e.clientX,e.clientY):d.setRng(t))}),i.on("click",function(e){var t=e.target;/^(IMG|HR)$/.test(t.nodeName)&&"false"!==f.getContentEditableParent(t)&&(e.preventDefault(),i.selection.select(t),i.nodeChanged()),"A"===t.nodeName&&f.hasClass(t,"mce-item-anchor")&&(e.preventDefault(),d.select(t))}),cc(i)&&i.on("init",function(){e("DefaultParagraphSeparator",cc(i))}),i.on("init",function(){i.dom.bind(i.getBody(),"submit",function(e){e.preventDefault()})}),n(),m.addNodeFilter("br",function(e){for(var t=e.length;t--;)"Apple-interchange-newline"===e[t].attr("class")&&e[t].remove()}),$t.iOS?(i.inline||i.on("keydown",function(){document.activeElement===document.body&&i.getWin().focus()}),p(),i.on("click",function(e){var t=e.target;do{if("A"===t.tagName)return void e.preventDefault()}while(t=t.parentNode)}),i.contentStyles.push(".mce-content-body {-webkit-touch-callout: none}")):t()),11<=$t.ie&&(p(),n()),$t.ie&&(t(),e("AutoUrlDetect",!1),i.on("dragstart",function(e){var t;(t=e).dataTransfer&&(i.selection.isCollapsed()&&"IMG"===t.target.tagName&&d.select(t.target),0<(e=i.selection.getContent()).length&&(e=v+escape(i.id)+","+escape(e),t.dataTransfer.setData(b,e)))}),i.on("drop",function(e){var t;u(e)||(t=e.dataTransfer&&(t=e.dataTransfer.getData(b))&&0<=t.indexOf(v)?(t=t.substr(v.length).split(","),{id:unescape(t[0]),html:unescape(t[1])}):null)&&t.id!==i.id&&(e.preventDefault(),e=Jl(e.x,e.y,i.getDoc()),d.setRng(e),t=t.html,i.queryCommandSupported("mceInsertClipboardContent")?i.execCommand("mceInsertClipboardContent",!1,{content:t,internal:!0}):i.execCommand("mceInsertContent",!1,t))})),g&&(i.on("keydown",function(e){if(!u(e)&&e.keyCode===s&&i.getBody().getElementsByTagName("hr").length&&d.isCollapsed()&&0===d.getRng().startOffset){var t=d.getNode(),n=t.previousSibling;if("HR"===t.nodeName)return f.remove(t),void e.preventDefault();n&&n.nodeName&&"hr"===n.nodeName.toLowerCase()&&(f.remove(n),e.preventDefault())}}),Range.prototype.getClientRects||i.on("mousedown",function(e){var t;u(e)||"HTML"!==e.target.nodeName||((t=i.getBody()).blur(),mo.setEditorTimeout(i,function(){t.focus()}))}),o=function(){var e=f.getAttribs(d.getStart().cloneNode(!1));return function(){var t=d.getStart();t!==i.getBody()&&(f.setAttrib(t,"style",null),c(e,function(e){t.setAttributeNode(e.cloneNode(!0))}))}},a=function(){return!d.isCollapsed()&&f.getParent(d.getStart(),f.isBlock)!==f.getParent(d.getEnd(),f.isBlock)},i.on("keypress",function(e){var t;if(!u(e)&&(8===e.keyCode||46===e.keyCode)&&a())return t=o(),i.getDoc().execCommand("delete",!1,null),t(),e.preventDefault(),!1}),f.bind(i.getDoc(),"cut",function(e){var t;!u(e)&&a()&&(t=o(),mo.setEditorTimeout(i,function(){t()}))}),i.getParam("readonly")||i.on("BeforeExecCommand mousedown",function(){e("StyleWithCSS",!1),e("enableInlineTableEditing",!1),pc(i)||e("enableObjectResizing",!1)}),i.on("SetContent ExecCommand",function(e){"setcontent"!==e.type&&"mceInsertLink"!==e.command||c(f.select("a"),function(e){var t=e.parentNode,n=f.getRoot();if(t.lastChild===e){for(;t&&!f.isBlock(t);){if(t.parentNode.lastChild!==t||t===n)return;t=t.parentNode}f.add(t,"br",{"data-mce-bogus":1})}})}),i.contentStyles.push("img:-moz-broken {-moz-force-broken-image-icon:1;min-width:24px;min-height:24px}"),$t.mac&&i.on("keydown",function(e){!sf.metaKeyPressed(e)||e.shiftKey||37!==e.keyCode&&39!==e.keyCode||(e.preventDefault(),i.selection.getSel().modify("move",37===e.keyCode?"backward":"forward","lineboundary"))}),n()),{refreshContentEditable:function(){},isHidden:function(){if(!g||i.removed)return!1;var e=i.selection.getSel();return!e||!e.rangeCount||0===e.rangeCount}}}function z0(e){return I(e,function(e){return!1===ie(e)})}function j0(e){var t=e.settings,n=e.editorUpload.blobCache;return z0({allow_conditional_comments:t.allow_conditional_comments,allow_html_data_urls:t.allow_html_data_urls,allow_svg_data_urls:t.allow_svg_data_urls,allow_html_in_named_anchor:t.allow_html_in_named_anchor,allow_script_urls:t.allow_script_urls,allow_unsafe_link_target:t.allow_unsafe_link_target,convert_fonts_to_spans:t.convert_fonts_to_spans,fix_list_elements:t.fix_list_elements,font_size_legacy_values:t.font_size_legacy_values,forced_root_block:t.forced_root_block,forced_root_block_attrs:t.forced_root_block_attrs,padd_empty_with_br:t.padd_empty_with_br,preserve_cdata:t.preserve_cdata,remove_trailing_brs:t.remove_trailing_brs,inline_styles:t.inline_styles,root_name:e.inline?e.getElement().nodeName.toLowerCase():void 0,validate:!0,blob_cache:n,images_dataimg_filter:t.images_dataimg_filter})}function U0(e){var t,r,n;e.bindPendingEventDelegates(),e.initialized=!0,e.fire("Init"),e.focus(!0),n=(r=e).dom.getRoot(),r.inline||pl(r)&&r.selection.getStart(!0)!==n||Ml(n).each(function(e){var t,n=e.getNode(),o=st(n)?Ml(n).getOr(e):e;$t.browser.isIE()?(t=r,n=o.toRange(),e=Jt.fromDom(t.getBody()),e=(Tf(t)?Y.from(n):Y.none()).map(Df).filter(Ef(e)),t.bookmark=e.isSome()?e:t.bookmark):r.selection.setRng(o.toRange())}),e.nodeChanged({initial:!0}),e.execCallback("init_instance_callback",e),(t=e).settings.auto_focus&&mo.setEditorTimeout(t,function(){var e=!0===t.settings.auto_focus?t:t.editorManager.get(t.settings.auto_focus);e.destroyed||e.focus()},100)}function W0(t,e){var n,o,r,i,u,a=t.settings,c=t.getDoc(),s=t.getBody();a.browser_spellcheck||a.gecko_spellcheck||(c.body.spellcheck=!1,cx.setAttrib(s,"spellcheck","false")),t.quirks=H0(t),t.fire("PostRender"),void 0!==(c=t.getParam("directionality",qu.isRtl()?"rtl":void 0))&&(s.dir=c),a.protect&&t.on("BeforeSetContent",function(t){Kt.each(a.protect,function(e){t.content=t.content.replace(e,function(e){return"\x3c!--mce:protected "+escape(e)+"--\x3e"})})}),t.on("SetContent",function(){t.addVisual(t.getBody())}),!1===e&&t.load({initial:!0,format:"html"}),t.startContent=t.getContent({format:"raw"}),t.on("compositionstart compositionend",function(e){t.composing="compositionstart"===e.type}),0<t.contentStyles.length&&(n="",Kt.each(t.contentStyles,function(e){n+=e+"\r\n"}),t.dom.addStyle(n)),r=(o=t).contentCSS,s=function(){o.on("remove",function(){return i.unloadAll(r)}),U0(o)},(i=((c=o).inline?c.ui:c.dom).styleSheetLoader).loadAll(r,s,s),a.content_style&&(e=a.content_style,s=Jt.fromDom((c=t).getBody()),s=Ye(sn(s)),u=Jt.fromTag("style"),dt(u,"type","text/css"),mn(u,Jt.fromText(e)),mn(s,u),c.on("remove",function(){gn(u)}))}function q0(t,e){var a,i,n,r,u,c,o,s=t.settings,l=t.getElement(),f=t.getDoc();s.inline||(t.getElement().style.visibility=t.orgVisibility),e||t.inline||(f.open(),f.write(t.iframeHTML),f.close()),t.inline&&(cx.addClass(l,"mce-content-body"),t.contentDocument=f=document,t.contentWindow=window,t.bodyElement=l,t.contentAreaContainer=l),(l=t.getBody()).disabled=!0,t.readonly=!!s.readonly,t.readonly||(t.inline&&"static"===cx.getStyle(l,"position",!0)&&(l.style.position="relative"),l.contentEditable=t.getParam("content_editable_state",!0)),l.disabled=!1,t.editorUpload=zh(t),t.schema=Fr(s),t.dom=Iu(f,{keep_values:!0,url_converter:t.convertURL,url_converter_scope:t,hex_colors:s.force_hex_style_colors,update_styles:!0,root_element:t.inline?t.getBody():null,collect:function(){return t.inline},schema:t.schema,contentCssCors:t.getParam("content_css_cors",!1,"boolean"),referrerPolicy:dc(t),onSetAttrib:function(e){t.fire("SetAttrib",e)}}),t.parser=((s=Jp(j0(a=t),a.schema)).addAttributeFilter("src,href,style,tabindex",function(e,t){for(var n,o,r=e.length,i=a.dom,u="data-mce-"+t;r--;)if((o=(n=e[r]).attr(t))&&!n.attr(u)){if(0===o.indexOf("data:")||0===o.indexOf("blob:"))continue;"style"===t?((o=i.serializeStyle(i.parseStyle(o),n.name)).length||(o=null),n.attr(u,o),n.attr(t,o)):"tabindex"===t?(n.attr(u,o),n.attr(t,null)):n.attr(u,a.convertURL(o,t,n.name))}}),s.addNodeFilter("script",function(e){for(var t=e.length;t--;){var n=e[t],o=n.attr("type")||"no/type";0!==o.indexOf("mce-")&&n.attr("type","mce-"+o)}}),a.settings.preserve_cdata&&s.addNodeFilter("#cdata",function(e){for(var t=e.length;t--;){var n=e[t];n.type=8,n.name="#comment",n.value="[CDATA["+a.dom.encode(n.value)+"]]"}}),s.addNodeFilter("p,h1,h2,h3,h4,h5,h6,div",function(e){for(var t=e.length,n=a.schema.getNonEmptyElements();t--;){var o=e[t];o.isEmpty(n)&&0===o.getAll("br").length&&(o.append(new xd("br",1)).shortEnded=!0)}}),s),t.serializer=eh((s=t.settings,we(we({},j0(t)),z0({url_converter:s.url_converter,url_converter_scope:s.url_converter_scope,element_format:s.element_format,entities:s.entities,entity_encoding:s.entity_encoding,indent:s.indent,indent_after:s.indent_after,indent_before:s.indent_before,block_elements:s.block_elements,boolean_attributes:s.boolean_attributes,custom_elements:s.custom_elements,extended_valid_elements:s.extended_valid_elements,invalid_elements:s.invalid_elements,invalid_styles:s.invalid_styles,move_caret_before_on_enter_elements:s.move_caret_before_on_enter_elements,non_empty_elements:s.non_empty_elements,schema:s.schema,self_closing_elements:s.self_closing_elements,short_ended_elements:s.short_ended_elements,special:s.special,text_block_elements:s.text_block_elements,text_inline_elements:s.text_inline_elements,valid_children:s.valid_children,valid_classes:s.valid_classes,valid_elements:s.valid_elements,valid_styles:s.valid_styles,verify_html:s.verify_html,whitespace_elements:s.whitespace_elements}))),t),t.selection=_p(t.dom,t.getWin(),t.serializer,t),t.annotator=wl(t),t.formatter=Gh(t),t.undoManager=Xh(t),t._nodeChangeDispatcher=new B0(t),t._selectionOverrides=V0(t),r=t,u=zu(Y.none()),c=zu(!1),o=Xu(function(e){r.fire("longpress",we(we({},e),{type:"longpress"})),c.set(!0)},400),r.on("touchstart",function(t){yb(t).each(function(e){o.cancel();e={x:e.clientX,y:e.clientY,target:t.target};o.throttle(t),c.set(!1),u.set(Y.some(e))})},!0),r.on("touchmove",function(e){o.cancel(),yb(e).each(function(o){u.get().each(function(e){var t=o,n=e,e=Math.abs(t.clientX-n.x),n=Math.abs(t.clientY-n.y);(5<e||5<n)&&(u.set(Y.none()),c.set(!1),r.fire("longpresscancel"))})})},!0),r.on("touchend touchcancel",function(t){o.cancel(),"touchcancel"!==t.type&&u.get().filter(function(e){return e.target.isEqualNode(t.target)}).each(function(){c.get()?t.preventDefault():r.fire("tap",we(we({},t),{type:"tap"}))})},!0),(n=s=t).on("click",function(e){n.dom.getParent(e.target,"details")&&e.preventDefault()}),(s=s).parser.addNodeFilter("details",function(e){de(e,function(e){e.attr("data-mce-open",e.attr("open")),e.attr("open","open")})}),s.serializer.addNodeFilter("details",function(e){de(e,function(e){var t=e.attr("data-mce-open");e.attr("open",Q(t)?t:null),e.attr("data-mce-open",null)})}),vp(t)||(i=t).on("click",function(e){var t,n,o,r;3<=e.detail&&(o=(t=i).selection.getRng(),r=qa.fromRangeStart(o),e=qa.fromRangeEnd(o),qa.isElementPosition(r)&&(n=r.container(),R0(n)&&Ml(n).each(function(e){return o.setStart(e.container(),e.offset())})),qa.isElementPosition(e)&&(n=r.container(),R0(n)&&Il(n).each(function(e){return o.setEnd(e.container(),e.offset())})),t.selection.setRng(Em(o)))});var d,m,g,p,h,v,b,y,x,s=vp(s=t)?zu(null):p0(s);x=s,(y=t).addCommand("delete",function(){var e,t=x;vb(e=y)||Ev(e,!1)||Cv(e,!1)||ub(e,t,!1)||fv(e,!1)||_m(e)||Tv(e,!1)||fb(e,!1)||gv(e)||sb(e,!1)||(bb(e,"Delete"),tv(e))}),y.addCommand("forwardDelete",function(){var e,t=x;Ev(e=y,!0)||Cv(e,!0)||ub(e,t,!0)||fv(e,!0)||_m(e)||Tv(e,!0)||fb(e,!0)||gv(e)||sb(e,!0)||bb(e,"ForwardDelete")}),cc(s=t)&&s.on("NodeChange",w(wb,s)),p=(g=t).dom,h=cc(g),v=g.getParam("placeholder",Yc.getAttrib(g.getElement(),"placeholder"),"string"),b=function(e,t){var n;!function(e){if(Yh(e)){var t=e.keyCode;return!Kh(e)&&(sf.metaKeyPressed(e)||e.altKey||112<=t&&t<=123||ee(Eb,t))}}(e)&&(n=g.getBody(),e=!(Yh(e=e)&&!(Kh(e)||"keyup"===e.type&&229===e.keyCode))&&function(e,t,n){if(Fo(Jt.fromDom(t),!1)){var o=""===n,r=t.firstElementChild;return!r||!e.getStyle(t.firstElementChild,"padding-left")&&!e.getStyle(t.firstElementChild,"padding-right")&&(o?!e.isBlock(r):n===r.nodeName.toLowerCase())}return!1}(p,n,h),""!==p.getAttrib(n,Tb)===e&&!t||(p.setAttrib(n,Tb,e?v:null),p.setAttrib(n,"aria-placeholder",e?v:null),g.fire("PlaceholderToggle",{state:e}),g.on(e?"keydown":"keyup",b),g.off(e?"keyup":"keydown",b)))},v&&g.on("init",function(e){b(e,!0),g.on("change SetContent ExecCommand",b),g.on("paste",function(e){return mo.setEditorTimeout(g,function(){return b(e)})})}),t.fire("PreInit"),te((m=d=t).plugins,"rtc").fold(function(){return m.rtcInstance=pp(d),Y.none()},function(e){return Y.some(e.setup().then(function(e){return m.rtcInstance=hp(d,e),e.isRemote}))}).fold(function(){W0(t,!1)},function(e){t.setProgressState(!0),e.then(function(e){t.setProgressState(!1),W0(t,e)})})}function G0(e,t){var n,o,r,i=e.editorManager.translate("Rich Text Area. Press ALT-0 for help."),u=(n=e.id,o=i,t.height,r=e.getParam("iframe_attrs",{}),i=Jt.fromTag("iframe"),mt(i,r),mt(i,{id:n+"_ifr",frameBorder:"0",allowTransparency:"true",title:o}),Ju(i,"tox-edit-area__iframe"),i.dom);return u.onload=function(){u.onload=null,e.fire("load")},i=function(e,t){if(document.domain!==window.location.hostname&&$t.browser.isIE()){var n=Hh("mce");e[n]=function(){q0(e)};n='javascript:(function(){document.open();document.domain="'+document.domain+'";var ed = window.parent.tinymce.get("'+e.id+'");document.write(ed.iframeHTML);document.close();ed.'+n+"(true);})()";return sx.setAttrib(t,"src",n),!0}return!1}(e,u),e.contentAreaContainer=t.iframeContainer,e.iframeElement=u,e.iframeHTML=function(e){var t=e.getParam("doctype","<!DOCTYPE html>")+"<html><head>";e.getParam("document_base_url","")!==e.documentBaseUrl&&(t+='<base href="'+e.documentBaseURI.getURI()+'" />'),t+='<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />';var n=uc(e,"body_id","tinymce"),o=uc(e,"body_class","");return ac(e)&&(t+='<meta http-equiv="Content-Security-Policy" content="'+ac(e)+'" />'),t+('</head><body id="'+n+'" class="mce-content-body '+o+'" data-id="'+e.id)+'"><br></body></html>'}(e),sx.add(t.iframeContainer,u),i}function $0(e){return e.replace(/^\-/,"")}function X0(e){return{editorContainer:e,iframeContainer:e,api:{}}}function Y0(e){var t,n,o=e.getElement();return e.orgDisplay=o.style.display,Q(vc(e))?e.theme.renderUI():ae(vc(e))?(o=(t=e).getElement(),(n=vc(t)(t,o)).editorContainer.nodeType&&(n.editorContainer.id=n.editorContainer.id||t.id+"_parent"),n.iframeContainer&&n.iframeContainer.nodeType&&(n.iframeContainer.id=n.iframeContainer.id||t.id+"_iframecontainer"),n.height=n.iframeHeight||o.offsetHeight,n):(e=(n=e).getElement(),n.inline?X0(null):(n=e,e=lx.create("div"),lx.insertAfter(e,n),X0(e)))}function K0(e){var n,o,t,r;e.fire("ScriptsLoaded"),n=e,m=Kt.trim(fc(n)),o=n.ui.registry.getAll().icons,c=we(we({},kh.get("default").icons),kh.get(m).icons),ve(c,function(e,t){ye(o,t)||n.ui.registry.addIcon(t,e)}),c=vc(m=e),Q(c)?(m.settings.theme=$0(c),i=Lh.get(c),m.theme=new i(m,Lh.urls[c]),m.theme.init&&m.theme.init(m,Lh.urls[c]||m.documentBaseUrl.replace(/\/$/,""),m.$)):m.theme={},r=[],Kt.each(yc(t=e).split(/[ ,]/),function(e){fx(t,r,$0(e))});var i=Y0(e),u=e,a=Y.from(i.api).getOr({}),c={show:Y.from(a.show).getOr(U),hide:Y.from(a.hide).getOr(U),disable:Y.from(a.disable).getOr(U),isDisabled:Y.from(a.isDisabled).getOr(W),enable:function(){u.mode.isReadOnly()||Y.from(a.enable).map(g)}};u.ui=we(we({},u.ui),c);var s,l,f,d,m={editorContainer:i.editorContainer,iframeContainer:i.iframeContainer};return e.editorContainer=m.editorContainer||null,e.contentCSS=e.contentCSS.concat((i=(c=s=e).getParam("content_css"),c=Q(i)?E(i.split(","),At):ne(i)?i:!1===i||c.inline?[]:["default"],l=s.editorManager.baseURL+"/skins/content",f="content"+s.editorManager.suffix+".css",d=!0===s.inline,E(c,function(e){return/^[a-z0-9\-]+$/i.test(e)&&!d?l+"/"+e+"/"+f:s.documentBaseURI.toAbsolute(e)}))),e.inline?q0(e):(m=G0(c=e,e=m),e.editorContainer&&(sx.get(e.editorContainer).style.display=c.orgDisplay,c.hidden=sx.isHidden(e.editorContainer)),c.getElement().style.display="none",sx.setAttrib(c.id,"aria-hidden","true"),void(m||q0(c)))}function J0(e){return"-"===e.charAt(0)}function Q0(t,e,n){return Y.from(e).filter(function(e){return 0<e.length&&!kh.has(e)}).map(function(e){return{url:t.editorManager.baseURL+"/icons/"+e+"/icons"+n+".js",name:Y.some(e)}})}function Z0(s,l){var e,t,f=Vu.ScriptLoader,n=f,o=l,r=function(){var o,r,e,i,t,n,u,a,c;t=f,a=mc(n=s),c=n.getParam("language_url","","string"),!1===qu.hasCode(a)&&"en"!==a&&(u=""!==c?c:n.editorManager.baseURL+"/langs/"+a+".js",t.add(u,U,void 0,function(){Rh(n,"LanguageLoadError",Mh("language",u,a))})),e=f,t=Q0(i=s,"default",c=l),c=Y.from(i.getParam("icons_url","","string")).filter(function(e){return 0<e.length}).map(function(e){return{url:e,name:Y.none()}}).orThunk(function(){return Q0(i,fc(i),"")}),de(function(e){for(var t=[],n=function(e){t.push(e)},o=0;o<e.length;o++)e[o].each(n);return t}([t,c]),function(o){e.add(o.url,U,void 0,function(){var e=i,t=o.url,n=o.name.getOrUndefined();Rh(e,"IconsLoadError",Mh("icons",t,n))})}),o=s,r=l,Kt.each(o.getParam("external_plugins"),function(e,t){Ph.load(t,e,U,void 0,function(){Ih(o,e,t)}),o.settings.plugins+=" "+t}),Kt.each(yc(o).split(/[ ,]/),function(e){var t,n;(e=Kt.trim(e))&&!Ph.urls[e]&&(J0(e)?(e=e.substr(1,e.length),t=Ph.dependencies(e),Kt.each(t,function(e){var t=Ph.createUrl({prefix:"plugins/",resource:e,suffix:"/plugin"+r+".js"},e);Ph.load(t.resource,t,U,void 0,function(){Ih(o,t.prefix+t.resource+t.suffix,t.resource)})})):(n={prefix:"plugins/",resource:e,suffix:"/plugin"+r+".js"},Ph.load(e,n,U,void 0,function(){Ih(o,n.prefix+n.resource+n.suffix,e)})))}),f.loadQueue(function(){s.removed||K0(s)},s,function(){s.removed||K0(s)})},i=vc(e=s);Q(i)?(J0(i)||Lh.urls.hasOwnProperty(i)||((t=e.getParam("theme_url"))?Lh.load(i,e.documentBaseURI.toAbsolute(t)):Lh.load(i,"themes/"+i+"/theme"+o+".js")),n.loadQueue(function(){Lh.waitFor(i,r)})):r()}function ex(e){return Ml(e.getBody()).map(function(e){e=e.container();return wn(e)?e.parentNode:e})}function tx(e,t){return n=e,Y.from(n.selection.getRng()).bind(function(e){var t=n.getBody();return e.startContainer===t&&0===e.startOffset?Y.none():Y.from(n.selection.getStart(!0))}).orThunk(w(ex,e)).map(Jt.fromDom).filter(Zt).map(t);var n}function nx(e,t){if(/^[0-9.]+$/.test(t)){var n=parseInt(t,10);if(1<=n&&n<=7){var o=Kt.explode(e.getParam("font_size_style_values","xx-small,x-small,small,medium,large,x-large,xx-large")),e=Kt.explode(e.getParam("font_size_classes",""));return e?e[n-1]||t:o[n-1]||t}return t}return t}var ox=Tn,rx=En,ix=function(e){e.on(function(e){I0(e.ghost)}),e.clear()},ux=En,ax=Tn,cx=Iu.DOM,sx=Iu.DOM,lx=Iu.DOM,fx=function(t,n,o){var e=Ph.get(o),r=Ph.urls[o]||t.documentBaseUrl.replace(/\/$/,"");if(o=Kt.trim(o),e&&-1===Kt.inArray(n,o)&&(Kt.each(Ph.dependencies(o),function(e){fx(t,n,e)}),!t.plugins[o]))try{var i=new e(t,r,t.$);(t.plugins[o]=i).init&&(i.init(t,r),n.push(o))}catch(e){!function(e,t,n){t=qu.translate(["Failed to initialize plugin: {0}",t]);Fh(t,n),Nh(e,t)}(t,o,e)}},dx=Iu.DOM,mx={"font-size":"size","font-family":"face"},J=function(i){return function(r,e){return Y.from(e).map(Jt.fromDom).filter(Zt).bind(function(e){return n=i,t=r,o=e.dom,Gf(Jt.fromDom(o),function(e){return yt(t=e,n).orThunk(function(){return"font"===Qt(t)?te(mx,n).bind(function(e){return pt(t,e)}):Y.none()});var t},function(e){return Pe(Jt.fromDom(t),e)}).or((e=e.dom,Y.from(Iu.DOM.getStyle(e,i,!0))));var n,t,o}).getOr("")}},gx=J("font-size"),px=r(function(e){return e.replace(/[\'\"\\]/g,"").replace(/,\s+/g,",")},J("font-family")),hx=Kt.each,vx=Kt.map,bx=Kt.inArray,yx=(xx.prototype.execCommand=function(t,n,o,e){var r,i=!1,u=this;if(!u.editor.removed){if(/^(mceAddUndoLevel|mceEndUndoLevel|mceBeginUndoLevel|mceRepaint)$/.test(t)||e&&e.skip_focus?(r=u.editor,Nf(r).each(function(e){return r.selection.setRng(e)})):u.editor.focus(),(e=u.editor.fire("BeforeExecCommand",{command:t,ui:n,value:o})).isDefaultPrevented())return!1;var a=t.toLowerCase();if(e=u.commands.exec[a])return e(a,n,o),u.editor.fire("ExecCommand",{command:t,ui:n,value:o}),!0;if(hx(this.editor.plugins,function(e){if(e.execCommand&&e.execCommand(t,n,o))return u.editor.fire("ExecCommand",{command:t,ui:n,value:o}),!(i=!0)}),i)return i;if(u.editor.theme&&u.editor.theme.execCommand&&u.editor.theme.execCommand(t,n,o))return u.editor.fire("ExecCommand",{command:t,ui:n,value:o}),!0;try{i=u.editor.getDoc().execCommand(t,n,o)}catch(e){}return!!i&&(u.editor.fire("ExecCommand",{command:t,ui:n,value:o}),!0)}},xx.prototype.queryCommandState=function(e){var t;if(!this.editor.quirks.isHidden()&&!this.editor.removed){if(e=e.toLowerCase(),t=this.commands.state[e])return t(e);try{return this.editor.getDoc().queryCommandState(e)}catch(e){}return!1}},xx.prototype.queryCommandValue=function(e){var t;if(!this.editor.quirks.isHidden()&&!this.editor.removed){if(e=e.toLowerCase(),t=this.commands.value[e])return t(e);try{return this.editor.getDoc().queryCommandValue(e)}catch(e){}}},xx.prototype.addCommands=function(e,n){void 0===n&&(n="exec");var o=this;hx(e,function(t,e){hx(e.toLowerCase().split(","),function(e){o.commands[n][e]=t})})},xx.prototype.addCommand=function(e,r,i){var u=this;e=e.toLowerCase(),this.commands.exec[e]=function(e,t,n,o){return r.call(i||u.editor,t,n,o)}},xx.prototype.queryCommandSupported=function(e){if(e=e.toLowerCase(),this.commands.exec[e])return!0;try{return this.editor.getDoc().queryCommandSupported(e)}catch(e){}return!1},xx.prototype.addQueryStateHandler=function(e,t,n){var o=this;e=e.toLowerCase(),this.commands.state[e]=function(){return t.call(n||o.editor)}},xx.prototype.addQueryValueHandler=function(e,t,n){var o=this;e=e.toLowerCase(),this.commands.value[e]=function(){return t.call(n||o.editor)}},xx.prototype.hasCustomCommand=function(e){return e=e.toLowerCase(),!!this.commands.exec[e]},xx.prototype.execNativeCommand=function(e,t,n){return void 0===t&&(t=!1),void 0===n&&(n=null),this.editor.getDoc().execCommand(e,t,n)},xx.prototype.isFormatMatch=function(e){return this.editor.formatter.match(e)},xx.prototype.toggleFormat=function(e,t){this.editor.formatter.toggle(e,t?{value:t}:void 0),this.editor.nodeChanged()},xx.prototype.storeSelection=function(e){this.selectionBookmark=this.editor.selection.getBookmark(e)},xx.prototype.restoreSelection=function(){this.editor.selection.moveToBookmark(this.selectionBookmark)},xx.prototype.setupCommands=function(i){var o=this;this.addCommands({"mceResetDesignMode,mceBeginUndoLevel":function(){},"mceEndUndoLevel,mceAddUndoLevel":function(){i.undoManager.add()},"Cut,Copy,Paste":function(e){var t,n=i.getDoc();try{o.execNativeCommand(e)}catch(e){t=!0}!(t="paste"===e&&!n.queryCommandEnabled(e)?!0:t)&&n.queryCommandSupported(e)||(e=i.translate("Your browser doesn't support direct access to the clipboard. Please use the Ctrl+X/C/V keyboard shortcuts instead."),$t.mac&&(e=e.replace(/Ctrl\+/g,"⌘+")),i.notificationManager.open({text:e,type:"error"}))},unlink:function(){var e;i.selection.isCollapsed()?(e=i.dom.getParent(i.selection.getStart(),"a"))&&i.dom.remove(e,!0):i.formatter.remove("link")},"JustifyLeft,JustifyCenter,JustifyRight,JustifyFull,JustifyNone":function(e){var t=e.substring(7);"full"===t&&(t="justify"),hx("left,center,right,justify".split(","),function(e){t!==e&&i.formatter.remove("align"+e)}),"none"!==t&&o.toggleFormat("align"+t)},"InsertUnorderedList,InsertOrderedList":function(e){o.execNativeCommand(e);var t=i.dom.getParent(i.selection.getNode(),"ol,ul");t&&(e=t.parentNode,/^(H[1-6]|P|ADDRESS|PRE)$/.test(e.nodeName)&&(o.storeSelection(),i.dom.split(e,t),o.restoreSelection()))},"Bold,Italic,Underline,Strikethrough,Superscript,Subscript":function(e){o.toggleFormat(e)},"ForeColor,HiliteColor":function(e,t,n){o.toggleFormat(e,n)},FontName:function(e,t,n){var o;n=nx(o=i,n=n),o.formatter.toggle("fontname",{value:(n=n.split(/\s*,\s*/),E(n,function(e){return-1===e.indexOf(" ")||_e(e,'"')||_e(e,"'")?e:"'"+e+"'"}).join(","))}),o.nodeChanged()},FontSize:function(e,t,n){var o;(o=i).formatter.toggle("fontsize",{value:nx(o,n)}),o.nodeChanged()},LineHeight:function(e,t,n){var o,r=n;(o=i).undoManager.transact(function(){o.formatter.toggle("lineheight",{value:String(r)}),o.nodeChanged()})},RemoveFormat:function(e){i.formatter.remove(e)},mceBlockQuote:function(){o.toggleFormat("blockquote")},FormatBlock:function(e,t,n){return o.toggleFormat(n||"p")},mceCleanup:function(){var e=i.selection.getBookmark();i.setContent(i.getContent()),i.selection.moveToBookmark(e)},mceRemoveNode:function(e,t,n){n=n||i.selection.getNode();n!==i.getBody()&&(o.storeSelection(),i.dom.remove(n,!0),o.restoreSelection())},mceSelectNodeDepth:function(e,t,n){var o=0;i.dom.getParent(i.selection.getNode(),function(e){if(1===e.nodeType&&o++===n)return i.selection.select(e),!1},i.getBody())},mceSelectNode:function(e,t,n){i.selection.select(n)},mceInsertContent:function(e,t,n){var o,r;o=i,n="string"!=typeof(n=r=n)?(r=Kt.extend({paste:n.paste,data:{paste:n.paste}},n),{content:n.content,details:r}):{content:n,details:{}},bp(o).editor.insertContent(n.content,n.details)},mceInsertRawHTML:function(e,t,n){i.selection.setContent("tiny_mce_marker");var o=i.getContent();i.setContent(o.replace(/tiny_mce_marker/g,function(){return n}))},mceInsertNewLine:function(e,t,n){d0(i,n)},mceToggleFormat:function(e,t,n){o.toggleFormat(n)},mceSetContent:function(e,t,n){i.setContent(n)},"Indent,Outdent":function(e){hb(i,e)},mceRepaint:function(){},InsertHorizontalRule:function(){i.execCommand("mceInsertContent",!1,"<hr />")},mceToggleVisualAid:function(){i.hasVisual=!i.hasVisual,i.addVisual()},mceReplaceContent:function(e,t,n){i.execCommand("mceInsertContent",!1,n.replace(/\{\$selection\}/g,i.selection.getContent({format:"text"})))},mceInsertLink:function(e,t,n){"string"==typeof n&&(n={href:n});var o=i.dom.getParent(i.selection.getNode(),"a");n.href=n.href.replace(/ /g,"%20"),o&&n.href||i.formatter.remove("link"),n.href&&i.formatter.apply("link",n,o)},selectAll:function(){var e,t=i.dom.getParent(i.selection.getStart(),En);t&&((e=i.dom.createRng()).selectNodeContents(t),i.selection.setRng(e))},mceNewDocument:function(){i.setContent("")},InsertLineBreak:function(e,t,n){return e0(i,n),!0}});function e(t){return function(){var e=i.selection,e=e.isCollapsed()?[i.dom.getParent(e.getNode(),i.dom.isBlock)]:e.getSelectedBlocks(),e=vx(e,function(e){return!!i.formatter.matchNode(e,t)});return-1!==bx(e,!0)}}o.addCommands({JustifyLeft:e("alignleft"),JustifyCenter:e("aligncenter"),JustifyRight:e("alignright"),JustifyFull:e("alignjustify"),"Bold,Italic,Underline,Strikethrough,Superscript,Subscript":function(e){return o.isFormatMatch(e)},mceBlockQuote:function(){return o.isFormatMatch("blockquote")},Outdent:function(){return gb(i)},"InsertUnorderedList,InsertOrderedList":function(e){var t=i.dom.getParent(i.selection.getNode(),"ul,ol");return t&&("insertunorderedlist"===e&&"UL"===t.tagName||"insertorderedlist"===e&&"OL"===t.tagName)}},"state"),o.addCommands({Undo:function(){i.undoManager.undo()},Redo:function(){i.undoManager.redo()}}),o.addQueryValueHandler("FontName",function(){return tx(t=i,function(e){return px(t.getBody(),e.dom)}).getOr("");var t},this),o.addQueryValueHandler("FontSize",function(){return tx(t=i,function(e){return gx(t.getBody(),e.dom)}).getOr("");var t},this),o.addQueryValueHandler("LineHeight",function(){return tx(t=i,function(n){var e=Jt.fromDom(t.getBody());return Gf(n,function(e){return yt(e,"line-height")},w(Pe,e)).getOrThunk(function(){var e=parseFloat(bt(n,"line-height")),t=parseFloat(bt(n,"font-size"));return String(e/t)})}).getOr("");var t},this)},xx);function xx(e){this.commands={state:{},exec:{},value:{}},this.editor=e,this.setupCommands(e)}function wx(e,t,n){var o,r,i,u;Qu(e,t)&&!1===n?(r=t,Ku(o=e)?o.dom.classList.remove(r):(u=i=r,0<(r=me(Yu(i=r=o,"class"),function(e){return e!==u})).length?dt(i,"class",r.join(" ")):ht(i,"class")),0===(Ku(o=o)?o.dom.classList:Yu(o,"class")).length&&ht(o,"class")):n&&Ju(e,t)}function Cx(e,t,n){try{e.getDoc().execCommand(t,!1,String(n))}catch(e){}}function Sx(e,t){e.dom.contentEditable=t?"true":"false"}function kx(e,t){var n,o=Jt.fromDom(e.getBody());wx(o,"mce-content-readonly",t),t?(e.selection.controlSelection.hideResizeRect(),e._selectionOverrides.hideFakeCaret(),Y.from(e.selection.getNode()).each(function(e){e.removeAttribute("data-mce-selected")}),e.readonly=!0,Sx(o,!1),de(Zu(o,'*[contenteditable="true"]'),function(e){dt(e,Ex,"true"),Sx(e,!1)})):(e.readonly=!1,Sx(o,!0),de(Zu(o,"*["+Ex+'="true"]'),function(e){ht(e,Ex),Sx(e,!0)}),Cx(e,"StyleWithCSS",!1),Cx(e,"enableInlineTableEditing",!1),Cx(e,"enableObjectResizing",!1),(Vf(o=e)||(n=o,Sf().filter(function(e){return!(void 0!==(t=e.dom.classList)&&(t.contains("tox-edit-area")||t.contains("tox-edit-area__iframe")||t.contains("mce-content-body")))&&Mf(n,e.dom);var t}).isSome()))&&e.focus(),e.selection.setRng(e.selection.getRng()),e.nodeChanged())}function Ox(e){return e.readonly}function _x(t){t.parser.addAttributeFilter("contenteditable",function(e){Ox(t)&&de(e,function(e){e.attr(Ex,e.attr("contenteditable")),e.attr("contenteditable","false")})}),t.serializer.addAttributeFilter(Ex,function(e){Ox(t)&&de(e,function(e){e.attr("contenteditable",e.attr(Ex))})}),t.serializer.addTempAttr(Ex)}var Ex="data-mce-contenteditable",Tx=Kt.makeMap("focus blur focusin focusout click dblclick mousedown mouseup mousemove mouseover beforepaste paste cut copy selectionchange mouseout mouseenter mouseleave wheel keydown keypress keyup input beforeinput contextmenu dragstart dragend dragover draggesture dragdrop drop drag submit compositionstart compositionend compositionupdate touchstart touchmove touchend touchcancel"," "),Dx=(Ax.isNative=function(e){return!!Tx[e.toLowerCase()]},Ax.prototype.fire=function(e,t){var n=e.toLowerCase(),o=t||{};o.type=n,o.target||(o.target=this.scope),o.preventDefault||(o.preventDefault=function(){o.isDefaultPrevented=q},o.stopPropagation=function(){o.isPropagationStopped=q},o.stopImmediatePropagation=function(){o.isImmediatePropagationStopped=q},o.isDefaultPrevented=W,o.isPropagationStopped=W,o.isImmediatePropagationStopped=W),this.settings.beforeFire&&this.settings.beforeFire(o);var r=this.bindings[n];if(r)for(var i=0,u=r.length;i<u;i++){var a=r[i];if(a.once&&this.off(n,a.func),o.isImmediatePropagationStopped())return o.stopPropagation(),o;if(!1===a.func.call(this.scope,o))return o.preventDefault(),o}return o},Ax.prototype.on=function(e,t,n,o){if(t=!1===t?W:t){var r={func:t};o&&Kt.extend(r,o);for(var i=e.toLowerCase().split(" "),u=i.length;u--;){var a=i[u],c=this.bindings[a];c||(c=this.bindings[a]=[],this.toggleEvent(a,!0)),n?c.unshift(r):c.push(r)}}return this},Ax.prototype.off=function(e,t){var n=this;if(e)for(var o=e.toLowerCase().split(" "),r=o.length;r--;){var i=o[r],u=this.bindings[i];if(!i)return ve(this.bindings,function(e,t){n.toggleEvent(t,!1),delete n.bindings[t]}),this;if(u){if(t)for(var a=u.length;a--;)u[a].func===t&&(u=u.slice(0,a).concat(u.slice(a+1)),this.bindings[i]=u);else u.length=0;u.length||(this.toggleEvent(e,!1),delete this.bindings[i])}}else ve(this.bindings,function(e,t){n.toggleEvent(t,!1)}),this.bindings={};return this},Ax.prototype.once=function(e,t,n){return this.on(e,t,n,{once:!0})},Ax.prototype.has=function(e){return e=e.toLowerCase(),!(!this.bindings[e]||0===this.bindings[e].length)},Ax);function Ax(e){this.bindings={},this.settings=e||{},this.scope=this.settings.scope||this,this.toggleEvent=this.settings.toggleEvent||W}function Bx(n){return n._eventDispatcher||(n._eventDispatcher=new Dx({scope:n,toggleEvent:function(e,t){Dx.isNative(e)&&n.toggleNativeEvent&&n.toggleNativeEvent(e,t)}})),n._eventDispatcher}function Nx(e,t){return"selectionchange"===t?e.getDoc():!e.inline&&/^mouse|touch|click|contextmenu|drop|dragover|dragend/.test(t)?e.getDoc().documentElement:(t=hc(e))?(e.eventRoot||(e.eventRoot=Px.select(t)[0]),e.eventRoot):e.getBody()}function Rx(e,t,n){var o,r,i,u;e.hidden||Ox(e)?Ox(e)&&(o=e,"click"!==(r=n).type||sf.metaKeyPressed(r)||(i=Jt.fromDom(r.target),u=o,Jn(i,"a",function(e){return Pe(e,Jt.fromDom(u.getBody()))}).bind(function(e){return pt(e,"href")}).each(function(e){var t;r.preventDefault(),/^#/.test(e)?(t=o.dom.select(e+',[name="'+(_e(t=e,"#")?t.substring("#".length):t)+'"]')).length&&o.selection.scrollIntoView(t[0],!0):window.open(e,"_blank","rel=noopener noreferrer,menubar=yes,toolbar=yes,location=yes,status=yes,resizable=yes,scrollbars=yes")}))):e.fire(t,n)}function Mx(i,u){var e,t;i.delegates||(i.delegates={}),i.delegates[u]||i.removed||(t=Nx(i,u),hc(i)?(Fx||(Fx={},i.editorManager.on("removeEditor",function(){i.editorManager.activeEditor||Fx&&(ve(Fx,function(e,t){i.dom.unbind(Nx(i,t))}),Fx=null)})),Fx[u]||(Fx[u]=e=function(e){for(var t=e.target,n=i.editorManager.get(),o=n.length;o--;){var r=n[o].getBody();r!==t&&!Px.isChildOf(t,r)||Rx(n[o],u,e)}},Px.bind(t,u,e))):(Px.bind(t,u,e=function(e){Rx(i,u,e)}),i.delegates[u]=e))}function Ix(e,t,n,o){var r=n[t.get()],n=n[o];try{n.activate()}catch(e){return void console.error("problem while activating editor mode "+o+":",e)}r.deactivate(),r.editorReadOnly!==n.editorReadOnly&&kx(e,n.editorReadOnly),t.set(o),e.fire("SwitchMode",{mode:o})}var Fx,Mt={fire:function(e,t,n){if(this.removed&&"remove"!==e&&"detach"!==e)return t;var o=Bx(this).fire(e,t);if(!1!==n&&this.parent)for(var r=this.parent();r&&!o.isPropagationStopped();)r.fire(e,o,!1),r=r.parent();return o},on:function(e,t,n){return Bx(this).on(e,t,n)},off:function(e,t){return Bx(this).off(e,t)},once:function(e,t){return Bx(this).once(e,t)},hasEventListeners:function(e){return Bx(this).has(e)}},Px=Iu.DOM,Lx=we(we({},Mt),{bindPendingEventDelegates:function(){var t=this;Kt.each(t._pendingNativeEvents,function(e){Mx(t,e)})},toggleNativeEvent:function(e,t){var n=this;"focus"!==e&&"blur"!==e&&(t?n.initialized?Mx(n,e):n._pendingNativeEvents?n._pendingNativeEvents.push(e):n._pendingNativeEvents=[e]:n.initialized&&(n.dom.unbind(Nx(n,e),e,n.delegates[e]),delete n.delegates[e]))},unbindAllNativeEvents:function(){var n=this,e=n.getBody(),t=n.dom;n.delegates&&(ve(n.delegates,function(e,t){n.dom.unbind(Nx(n,t),t,e)}),delete n.delegates),!n.inline&&e&&t&&(e.onload=null,t.unbind(n.getWin()),t.unbind(n.getDoc())),t&&(t.unbind(e),t.unbind(n.getContainer()))}}),Vx=["design","readonly"],Hx=Kt.each,zx=Kt.explode,jx={f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123},Ux=Kt.makeMap("alt,ctrl,shift,meta,access"),Wx=(qx.prototype.add=function(e,t,n,o){var r=this,i=r.normalizeCommandFunc(n);return Hx(zx(Kt.trim(e)),function(e){e=r.createShortcut(e,t,i,o);r.shortcuts[e.id]=e}),!0},qx.prototype.remove=function(e){e=this.createShortcut(e);return!!this.shortcuts[e.id]&&(delete this.shortcuts[e.id],!0)},qx.prototype.normalizeCommandFunc=function(e){var t=this,n=e;return"string"==typeof n?function(){t.editor.execCommand(n,!1,null)}:Kt.isArray(n)?function(){t.editor.execCommand(n[0],n[1],n[2])}:n},qx.prototype.parseShortcut=function(e){var t,n={};Hx(zx(e.toLowerCase(),"+"),function(e){e in Ux?n[e]=!0:/^[0-9]{2,}$/.test(e)?n.keyCode=parseInt(e,10):(n.charCode=e.charCodeAt(0),n.keyCode=jx[e]||e.toUpperCase().charCodeAt(0))});var o=[n.keyCode];for(t in Ux)n[t]?o.push(t):n[t]=!1;return n.id=o.join(","),n.access&&(n.alt=!0,$t.mac?n.ctrl=!0:n.shift=!0),n.meta&&($t.mac?n.meta=!0:(n.ctrl=!0,n.meta=!1)),n},qx.prototype.createShortcut=function(e,t,n,o){e=Kt.map(zx(e,">"),this.parseShortcut);return e[e.length-1]=Kt.extend(e[e.length-1],{func:n,scope:o||this.editor}),Kt.extend(e[0],{desc:this.editor.translate(t),subpatterns:e.slice(1)})},qx.prototype.hasModifier=function(e){return e.altKey||e.ctrlKey||e.metaKey},qx.prototype.isFunctionKey=function(e){return"keydown"===e.type&&112<=e.keyCode&&e.keyCode<=123},qx.prototype.matchShortcut=function(e,t){return!!t&&t.ctrl===e.ctrlKey&&t.meta===e.metaKey&&t.alt===e.altKey&&t.shift===e.shiftKey&&!!(e.keyCode===t.keyCode||e.charCode&&e.charCode===t.charCode)&&(e.preventDefault(),!0)},qx.prototype.executeShortcutAction=function(e){return e.func?e.func.call(e.scope):null},qx);function qx(e){this.shortcuts={},this.pendingPatterns=[],this.editor=e;var n=this;e.on("keyup keypress keydown",function(t){!n.hasModifier(t)&&!n.isFunctionKey(t)||t.isDefaultPrevented()||(Hx(n.shortcuts,function(e){if(n.matchShortcut(t,e))return n.pendingPatterns=e.subpatterns.slice(0),"keydown"===t.type&&n.executeShortcutAction(e),!0}),n.matchShortcut(t,n.pendingPatterns[0])&&(1===n.pendingPatterns.length&&"keydown"===t.type&&n.executeShortcutAction(n.pendingPatterns[0]),n.pendingPatterns.shift()))})}var Gx=Kt.each,$x=Kt.trim,Xx="source protocol authority userInfo user password host port relative path directory file query anchor".split(" "),Yx={ftp:21,http:80,https:443,mailto:25},Kx=(Jx.parseDataUri=function(e){var t,n=decodeURIComponent(e).split(","),e=/data:([^;]+)/.exec(n[0]);return{type:t=e?e[1]:t,data:n[1]}},Jx.getDocumentBaseUrl=function(e){e=0!==e.protocol.indexOf("http")&&"file:"!==e.protocol?e.href:e.protocol+"//"+e.host+e.pathname;return/^[^:]+:\/\/\/?[^\/]+\//.test(e)&&(e=e.replace(/[\?#].*$/,"").replace(/[\/\\][^\/]+$/,""),/[\/\\]$/.test(e)||(e+="/")),e},Jx.prototype.setPath=function(e){e=/^(.*?)\/?(\w+)?$/.exec(e);this.path=e[0],this.directory=e[1],this.file=e[2],this.source="",this.getURI()},Jx.prototype.toRelative=function(e){if("./"===e)return e;var t=new Jx(e,{base_uri:this});if("mce_host"!==t.host&&this.host!==t.host&&t.host||this.port!==t.port||this.protocol!==t.protocol&&""!==t.protocol)return t.getURI();var n=this.getURI(),e=t.getURI();return n===e||"/"===n.charAt(n.length-1)&&n.substr(0,n.length-1)===e?n:(n=this.toRelPath(this.path,t.path),t.query&&(n+="?"+t.query),t.anchor&&(n+="#"+t.anchor),n)},Jx.prototype.toAbsolute=function(e,t){e=new Jx(e,{base_uri:this});return e.getURI(t&&this.isSameOrigin(e))},Jx.prototype.isSameOrigin=function(e){if(this.host==e.host&&this.protocol==e.protocol){if(this.port==e.port)return!0;var t=Yx[this.protocol];if(t&&(this.port||t)==(e.port||t))return!0}return!1},Jx.prototype.toRelPath=function(e,t){var n,o,r=0,i="",u=e.substring(0,e.lastIndexOf("/")).split("/"),a=t.split("/");if(u.length>=a.length)for(n=0,o=u.length;n<o;n++)if(n>=a.length||u[n]!==a[n]){r=n+1;break}if(u.length<a.length)for(n=0,o=a.length;n<o;n++)if(n>=u.length||u[n]!==a[n]){r=n+1;break}if(1===r)return t;for(n=0,o=u.length-(r-1);n<o;n++)i+="../";for(n=r-1,o=a.length;n<o;n++)i+=n!==r-1?"/"+a[n]:a[n];return i},Jx.prototype.toAbsPath=function(e,t){var n,o=0,r=[],i=/\/$/.test(t)?"/":"",e=e.split("/"),u=t.split("/");for(Gx(e,function(e){e&&r.push(e)}),e=r,n=u.length-1,r=[];0<=n;n--)0!==u[n].length&&"."!==u[n]&&(".."!==u[n]?0<o?o--:r.push(u[n]):o++);return 0!==(e=(n=e.length-o)<=0?b(r).join("/"):e.slice(0,n).join("/")+"/"+b(r).join("/")).indexOf("/")&&(e="/"+e),i&&e.lastIndexOf("/")!==e.length-1&&(e+=i),e},Jx.prototype.getURI=function(e){var t;return void 0===e&&(e=!1),this.source&&!e||(t="",e||(this.protocol?t+=this.protocol+"://":t+="//",this.userInfo&&(t+=this.userInfo+"@"),this.host&&(t+=this.host),this.port&&(t+=":"+this.port)),this.path&&(t+=this.path),this.query&&(t+="?"+this.query),this.anchor&&(t+="#"+this.anchor),this.source=t),this.source},Jx);function Jx(e,t){e=$x(e),this.settings=t||{};var n,o,r,i=this.settings.base_uri,u=this;/^([\w\-]+):([^\/]{2})/i.test(e)||/^\s*#/.test(e)?u.source=e:(n=0===e.indexOf("//"),0!==e.indexOf("/")||n||(e=(i&&i.protocol||"http")+"://mce_host"+e),/^[\w\-]*:?\/\//.test(e)||(o=this.settings.base_uri?this.settings.base_uri.path:new Jx(document.location.href).directory,e=this.settings.base_uri&&""==this.settings.base_uri.protocol?"//mce_host"+u.toAbsPath(o,e):(t=/([^#?]*)([#?]?.*)/.exec(e),(i&&i.protocol||"http")+"://mce_host"+u.toAbsPath(o,t[1])+t[2])),e=e.replace(/@@/g,"(mce_at)"),r=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@\/]*):?([^:@\/]*))?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/.exec(e),Gx(Xx,function(e,t){t=(t=r[t])&&t.replace(/\(mce_at\)/g,"@@");u[e]=t}),i&&(u.protocol||(u.protocol=i.protocol),u.userInfo||(u.userInfo=i.userInfo),u.port||"mce_host"!==u.host||(u.port=i.port),u.host&&"mce_host"!==u.host||(u.host=i.host),u.source=""),n&&(u.protocol=""))}var Qx=Iu.DOM,Zx=Kt.extend,ew=Kt.each,tw=Kt.resolve,nw=$t.ie,ow=(rw.prototype.render=function(){!function(t){var e=t.id;qu.setCode(mc(t));var n,o,r,i,u=function(){dx.unbind(window,"ready",u),t.render()};Gr.Event.domLoaded?t.getElement()&&$t.contentEditable&&(n=Jt.fromDom(t.getElement()),o=T(n.dom.attributes,function(e,t){return e[t.name]=t.value,e},{}),t.on("remove",function(){l(n.dom.attributes,function(e){return ht(n,e.name),0}),mt(n,o)}),t.ui.styleSheetLoader=ho.forElement(n,{contentCssCors:(r=t).getParam("content_css_cors"),referrerPolicy:dc(r)}),t.getParam("inline")?t.inline=!0:(t.orgVisibility=t.getElement().style.visibility,t.getElement().style.visibility="hidden"),(i=t.getElement().form||dx.getParent(e,"form"))&&(t.formElement=i,t.getParam("hidden_input")&&!xn(t.getElement())&&(dx.insertAfter(dx.create("input",{type:"hidden",name:e}),e),t.hasHiddenInput=!0),t.formEventDelegate=function(e){t.fire(e.type,e)},dx.bind(i,"submit reset",t.formEventDelegate),t.on("reset",function(){t.resetContent()}),!t.getParam("submit_patch")||i.submit.nodeType||i.submit.length||i._mceOldSubmit||(i._mceOldSubmit=i.submit,i.submit=function(){return t.editorManager.triggerSave(),t.setDirty(!1),i._mceOldSubmit(i)})),t.windowManager=Ah(t),t.notificationManager=Dh(t),"xml"===t.getParam("encoding")&&t.on("GetContent",function(e){e.save&&(e.content=dx.encode(e.content))}),t.getParam("add_form_submit_trigger")&&t.on("submit",function(){t.initialized&&t.save()}),t.getParam("add_unload_trigger")&&(t._beforeUnload=function(){!t.initialized||t.destroyed||t.isHidden()||t.save({format:"raw",no_events:!0,set_dirty:!1})},t.editorManager.on("BeforeUnload",t._beforeUnload)),t.editorManager.add(t),Z0(t,t.suffix)):dx.bind(window,"ready",u)}(this)},rw.prototype.focus=function(e){this.removed||(e?hd:function(t){var e=t.selection,n=t.getBody(),o=e.getRng();t.quirks.refreshContentEditable(),void 0!==t.bookmark&&!1===Vf(t)&&Nf(t).each(function(e){t.selection.setRng(e),o=e});var r,e=(r=t,e=e.getNode(),r.dom.getParent(e,function(e){return"true"===r.dom.getContentEditable(e)}));if(t.$.contains(n,e))return Lf(e),Pf(t,o),void hd(t);t.inline||($t.opera||Lf(n),t.getWin().focus()),($t.gecko||t.inline)&&(Lf(n),Pf(t,o)),hd(t)})(this)},rw.prototype.hasFocus=function(){return Vf(this)},rw.prototype.execCallback=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var o,r=this.settings[e];if(r)return this.callbackLookup&&(o=this.callbackLookup[e])&&(r=o.func,o=o.scope),"string"==typeof r&&(o=(o=r.replace(/\.\w+$/,""))?tw(o):0,r=tw(r),this.callbackLookup=this.callbackLookup||{},this.callbackLookup[e]={func:r,scope:o}),r.apply(o||this,t)},rw.prototype.translate=function(e){return qu.translate(e)},rw.prototype.getParam=function(e,t,n){return r=t,i=n,n=(o=e)in(t=this).settings?t.settings[o]:r,"hash"===i?(a={},"string"==typeof(e=n)?de(0<e.indexOf("=")?e.split(/[;,](?![^=;,]*(?:[;,]|$))/):e.split(","),function(e){e=e.split("=");1<e.length?a[Kt.trim(e[0])]=Kt.trim(e[1]):a[Kt.trim(e[0])]=Kt.trim(e[0])}):a=e,a):"string"===i?ch(Q,t,o).getOr(r):"number"===i?ch(ce,t,o).getOr(r):"boolean"===i?ch(re,t,o).getOr(r):"object"===i?ch(Z,t,o).getOr(r):"array"===i?ch(ne,t,o).getOr(r):"string[]"===i?ch((u=Q,function(e){return ne(e)&&A(e,u)}),t,o).getOr(r):"function"===i?ch(ae,t,o).getOr(r):n;var o,r,i,u,a},rw.prototype.hasPlugin=function(e,t){return!(!ee(yc(this).split(/[ ,]/),e)||t&&void 0===Ph.get(e))},rw.prototype.nodeChanged=function(e){this._nodeChangeDispatcher.nodeChanged(e)},rw.prototype.addCommand=function(e,t,n){this.editorCommands.addCommand(e,t,n)},rw.prototype.addQueryStateHandler=function(e,t,n){this.editorCommands.addQueryStateHandler(e,t,n)},rw.prototype.addQueryValueHandler=function(e,t,n){this.editorCommands.addQueryValueHandler(e,t,n)},rw.prototype.addShortcut=function(e,t,n,o){this.shortcuts.add(e,t,n,o)},rw.prototype.execCommand=function(e,t,n,o){return this.editorCommands.execCommand(e,t,n,o)},rw.prototype.queryCommandState=function(e){return this.editorCommands.queryCommandState(e)},rw.prototype.queryCommandValue=function(e){return this.editorCommands.queryCommandValue(e)},rw.prototype.queryCommandSupported=function(e){return this.editorCommands.queryCommandSupported(e)},rw.prototype.show=function(){this.hidden&&(this.hidden=!1,this.inline?this.getBody().contentEditable="true":(Qx.show(this.getContainer()),Qx.hide(this.id)),this.load(),this.fire("show"))},rw.prototype.hide=function(){var e=this,t=e.getDoc();e.hidden||(nw&&t&&!e.inline&&t.execCommand("SelectAll"),e.save(),e.inline?(e.getBody().contentEditable="false",e===e.editorManager.focusedEditor&&(e.editorManager.focusedEditor=null)):(Qx.hide(e.getContainer()),Qx.setStyle(e.id,"display",e.orgDisplay)),e.hidden=!0,e.fire("hide"))},rw.prototype.isHidden=function(){return!!this.hidden},rw.prototype.setProgressState=function(e,t){this.fire("ProgressState",{state:e,time:t})},rw.prototype.load=function(e){var t=this.getElement();if(this.removed)return"";if(t){(e=e||{}).load=!0;var n=xn(t)?t.value:t.innerHTML,n=this.setContent(n,e);return e.element=t,e.no_events||this.fire("LoadContent",e),e.element=t=null,n}},rw.prototype.save=function(e){var t,n,o=this,r=o.getElement();if(r&&o.initialized&&!o.removed)return(e=e||{}).save=!0,e.element=r,e.content=o.getContent(e),e.no_events||o.fire("SaveContent",e),"raw"===e.format&&o.fire("RawSaveContent",e),t=e.content,xn(r)?r.value=t:(!e.is_removing&&o.inline||(r.innerHTML=t),(n=Qx.getParent(o.id,"form"))&&ew(n.elements,function(e){if(e.name===o.id)return e.value=t,!1})),e.element=r=null,!1!==e.set_dirty&&o.setDirty(!1),t},rw.prototype.setContent=function(e,t){return th(this,e,t)},rw.prototype.getContent=function(e){return t=this,e=(n=void 0===(n=e)?{}:n).format||"html",n,bp(t).editor.getContent(n,e);var t,n},rw.prototype.insertContent=function(e,t){t&&(e=Zx({content:e},t)),this.execCommand("mceInsertContent",!1,e)},rw.prototype.resetContent=function(e){void 0===e?th(this,this.startContent,{format:"raw"}):th(this,e),this.undoManager.reset(),this.setDirty(!1),this.nodeChanged()},rw.prototype.isDirty=function(){return!this.isNotDirty},rw.prototype.setDirty=function(e){var t=!this.isNotDirty;this.isNotDirty=!e,e&&e!==t&&this.fire("dirty")},rw.prototype.getContainer=function(){return this.container||(this.container=Qx.get(this.editorContainer||this.id+"_parent")),this.container},rw.prototype.getContentAreaContainer=function(){return this.contentAreaContainer},rw.prototype.getElement=function(){return this.targetElm||(this.targetElm=Qx.get(this.id)),this.targetElm},rw.prototype.getWin=function(){var e;return this.contentWindow||(e=this.iframeElement)&&(this.contentWindow=e.contentWindow),this.contentWindow},rw.prototype.getDoc=function(){var e;return this.contentDocument||(e=this.getWin())&&(this.contentDocument=e.document),this.contentDocument},rw.prototype.getBody=function(){var e=this.getDoc();return this.bodyElement||(e?e.body:null)},rw.prototype.convertURL=function(e,t,n){var o=this.settings;return o.urlconverter_callback?this.execCallback("urlconverter_callback",e,n,!0,t):!o.convert_urls||n&&"LINK"===n.nodeName||0===e.indexOf("file:")||0===e.length?e:o.relative_urls?this.documentBaseURI.toRelative(e):this.documentBaseURI.toAbsolute(e,o.remove_script_host)},rw.prototype.addVisual=function(e){e=e=e,yp(this).editor.addVisual(e)},rw.prototype.remove=function(){var e,t,n,o,r;(e=this).removed||(t=e._selectionOverrides,n=e.editorUpload,o=e.getBody(),r=e.getElement(),o&&e.save({is_removing:!0}),e.removed=!0,e.unbindAllNativeEvents(),e.hasHiddenInput&&r&&hh.remove(r.nextSibling),e.fire("remove"),e.editorManager.remove(e),!e.inline&&o&&hh.setStyle(e.id,"display",e.orgDisplay),e.fire("detach"),hh.remove(e.getContainer()),nh(t),nh(n),e.destroy())},rw.prototype.destroy=function(e){var t,n,o;n=e,o=(t=this).selection,e=t.dom,t.destroyed||(n||t.removed?(n||(t.editorManager.off("beforeunload",t._beforeUnload),t.theme&&t.theme.destroy&&t.theme.destroy(),nh(o),nh(e)),(e=(o=t).formElement)&&(e._mceOldSubmit&&(e.submit=e._mceOldSubmit,e._mceOldSubmit=null),hh.unbind(e,"submit reset",o.formEventDelegate)),(o=t).contentAreaContainer=o.formElement=o.container=o.editorContainer=null,o.bodyElement=o.contentDocument=o.contentWindow=null,o.iframeElement=o.targetElm=null,o.selection&&(o.selection=o.selection.win=o.selection.dom=o.selection.dom.doc=null),t.destroyed=!0):t.remove())},rw.prototype.uploadImages=function(e){return this.editorUpload.uploadImages(e)},rw.prototype._scanForImages=function(){return this.editorUpload.scanForImages()},rw.prototype.addButton=function(){throw new Error("editor.addButton has been removed in tinymce 5x, use editor.ui.registry.addButton or editor.ui.registry.addToggleButton or editor.ui.registry.addSplitButton instead")},rw.prototype.addSidebar=function(){throw new Error("editor.addSidebar has been removed in tinymce 5x, use editor.ui.registry.addSidebar instead")},rw.prototype.addMenuItem=function(){throw new Error("editor.addMenuItem has been removed in tinymce 5x, use editor.ui.registry.addMenuItem instead")},rw.prototype.addContextToolbar=function(){throw new Error("editor.addContextToolbar has been removed in tinymce 5x, use editor.ui.registry.addContextToolbar instead")},rw);function rw(e,t,n){var o,r,i,u,a,c,s,l,f,d,m,g=this;this.plugins={},this.contentCSS=[],this.contentStyles=[],this.loadedCSS={},this.isNotDirty=!1,this.editorManager=n,this.documentBaseUrl=n.documentBaseURL,Zx(this,Lx),this.settings=(f=(l=this).documentBaseUrl,d=n.defaultSettings,m=f,f=yh,l=l,l={id:e,theme:"silver",toolbar_mode:ih(t=t,"floating"),plugins:"",document_base_url:m,add_form_submit_trigger:!0,submit_patch:!0,add_unload_trigger:!0,convert_urls:!0,relative_urls:!0,remove_script_host:!0,object_resizing:!0,doctype:"<!DOCTYPE html>",visual:!0,font_size_legacy_values:"xx-small,small,medium,large,x-large,xx-large,300%",forced_root_block:"p",hidden_input:!0,inline_styles:!0,convert_fonts_to_spans:!0,indent:!0,indent_before:"p,h1,h2,h3,h4,h5,h6,blockquote,div,title,style,pre,script,td,th,ul,ol,li,dl,dt,dd,area,table,thead,tfoot,tbody,tr,section,summary,article,hgroup,aside,figure,figcaption,option,optgroup,datalist",indent_after:"p,h1,h2,h3,h4,h5,h6,blockquote,div,title,style,pre,script,td,th,ul,ol,li,dl,dt,dd,area,table,thead,tfoot,tbody,tr,section,summary,article,hgroup,aside,figure,figcaption,option,optgroup,datalist",entity_encoding:"named",url_converter:l.convertURL,url_converter_scope:l},f=we(we({},l),f?Sh:{}),ah(xh||wh,xh,f,d,t)),this.settings.suffix&&(n.suffix=this.settings.suffix),this.suffix=n.suffix,this.settings.base_url&&n._setBaseUrl(this.settings.base_url),this.baseUri=n.baseURI,this.settings.referrer_policy&&(Vu.ScriptLoader._setReferrerPolicy(this.settings.referrer_policy),Iu.DOM.styleSheetLoader._setReferrerPolicy(this.settings.referrer_policy)),Oa.languageLoad=this.settings.language_load,Oa.baseURL=n.baseURL,this.id=e,this.setDirty(!1),this.documentBaseURI=new Kx(this.settings.document_base_url,{base_uri:this.baseUri}),this.baseURI=this.baseUri,this.inline=!!this.settings.inline,this.shortcuts=new Wx(this),this.editorCommands=new yx(this),this.settings.cache_suffix&&($t.cacheSuffix=this.settings.cache_suffix.replace(/^[\?\&]+/,"")),this.ui={registry:(r={},i={},u={},a={},c={},s={},{addAutocompleter:(e={addButton:(e=function(n,o){return function(e,t){return n[e.toLowerCase()]=we(we({},t),{type:o})}})(o={},"button"),addGroupToolbarButton:e(o,"grouptoolbarbutton"),addToggleButton:e(o,"togglebutton"),addMenuButton:e(o,"menubutton"),addSplitButton:e(o,"splitbutton"),addMenuItem:e(r,"menuitem"),addNestedMenuItem:e(r,"nestedmenuitem"),addToggleMenuItem:e(r,"togglemenuitem"),addAutocompleter:e(i,"autocompleter"),addContextMenu:e(a,"contextmenu"),addContextToolbar:e(c,"contexttoolbar"),addContextForm:e(c,"contextform"),addSidebar:e(s,"sidebar"),addIcon:function(e,t){return u[e.toLowerCase()]=t},getAll:function(){return{buttons:o,menuItems:r,icons:u,popups:i,contextMenus:a,contextToolbars:c,sidebars:s}}}).addAutocompleter,addButton:e.addButton,addContextForm:e.addContextForm,addContextMenu:e.addContextMenu,addContextToolbar:e.addContextToolbar,addIcon:e.addIcon,addMenuButton:e.addMenuButton,addMenuItem:e.addMenuItem,addNestedMenuItem:e.addNestedMenuItem,addSidebar:e.addSidebar,addSplitButton:e.addSplitButton,addToggleButton:e.addToggleButton,addGroupToolbarButton:e.addGroupToolbarButton,addToggleMenuItem:e.addToggleMenuItem,getAll:e.getAll}),styleSheetLoader:void 0,show:U,hide:U,enable:U,disable:U,isDisabled:W};var p,h,v,b,y,e=(b=zu("design"),y=zu({design:{activate:U,deactivate:U,editorReadOnly:!1},readonly:{activate:U,deactivate:U,editorReadOnly:!0}}),(h=p=this).serializer?_x(h):h.on("PreInit",function(){_x(h)}),(v=p).on("ShowCaret",function(e){Ox(v)&&e.preventDefault()}),v.on("ObjectSelected",function(e){Ox(v)&&e.preventDefault()}),{isReadOnly:function(){return Ox(p)},set:function(e){return function(e,t,n,o){if(o!==n.get()){if(!ye(t,o))throw new Error("Editor mode '"+o+"' is invalid");e.initialized?Ix(e,n,t,o):e.on("init",function(){return Ix(e,n,t,o)})}}(p,y.get(),b,e)},get:function(){return b.get()},register:function(e,t){y.set(function(e,t,n){if(ee(Vx,t))throw new Error("Cannot override default mode "+t);return we(we({},e),((e={})[t]=we(we({},n),{deactivate:function(){try{n.deactivate()}catch(e){console.error("problem while deactivating editor mode "+t+":",e)}}}),e))}(y.get(),e,t))}});this.mode=e,this.setMode=e.set,n.fire("SetupEditor",{editor:this}),this.execCallback("setup",this),this.$=_u.overrideDefaults(function(){return{context:g.inline?g.getBody():g.getDoc(),element:g.getBody()}})}function iw(t){var n=t.type;fw(bw.get(),function(e){switch(n){case"scroll":e.fire("ScrollWindow",t);break;case"resize":e.fire("ResizeWindow",t)}})}function uw(e){e!==gw&&(e?_u(window).on("resize scroll",iw):_u(window).off("resize scroll",iw),gw=e)}function aw(t){var e=hw;delete pw[t.id];for(var n=0;n<pw.length;n++)if(pw[n]===t){pw.splice(n,1);break}return hw=me(hw,function(e){return t!==e}),bw.activeEditor===t&&(bw.activeEditor=0<hw.length?hw[0]:null),bw.focusedEditor===t&&(bw.focusedEditor=null),e.length!==hw.length}var cw,sw=Iu.DOM,lw=Kt.explode,fw=Kt.each,dw=Kt.extend,mw=0,gw=!1,pw=[],hw=[],vw="CSS1Compat"!==document.compatMode,bw=we(we({},Mt),{baseURI:null,baseURL:null,defaultSettings:{},documentBaseURL:null,suffix:null,$:_u,majorVersion:"5",minorVersion:"6.2",releaseDate:"2020-12-08",editors:pw,i18n:qu,activeEditor:null,focusedEditor:null,settings:{},setup:function(){var e,t="",n=Kx.getDocumentBaseUrl(document.location);/^[^:]+:\/\/\/?[^\/]+\//.test(n)&&(n=n.replace(/[\?#].*$/,"").replace(/[\/\\][^\/]+$/,""),/[\/\\]$/.test(n)||(n+="/"));var o=window.tinymce||window.tinyMCEPreInit;if(o)e=o.base||o.baseURL,t=o.suffix;else{for(var r,i=document.getElementsByTagName("script"),u=0;u<i.length;u++)if(""!==(r=i[u].src||"")){var a=r.substring(r.lastIndexOf("/"));if(/tinymce(\.full|\.jquery|)(\.min|\.dev|)\.js/.test(r)){-1!==a.indexOf(".min")&&(t=".min"),e=r.substring(0,r.lastIndexOf("/"));break}}!e&&document.currentScript&&(-1!==(r=document.currentScript.src).indexOf(".min")&&(t=".min"),e=r.substring(0,r.lastIndexOf("/")))}this.baseURL=new Kx(n).toAbsolute(e),this.documentBaseURL=n,this.baseURI=new Kx(this.baseURL),this.suffix=t,this.on("AddEditor",w(If,this)),this.on("RemoveEditor",w(Ff,this))},overrideDefaults:function(e){var t=e.base_url;t&&this._setBaseUrl(t);t=e.suffix;e.suffix&&(this.suffix=t);e=(this.defaultSettings=e).plugin_base_urls;void 0!==e&&ve(e,function(e,t){Oa.PluginManager.urls[t]=e})},init:function(u){function a(e){var t=e.id;return t||(t=te(e,"name").filter(function(e){return!sw.get(e)}).getOrThunk(sw.uniqueId),e.setAttribute("id",t)),t}function c(e,t){return t.constructor===RegExp?t.test(e.className):sw.hasClass(e,t)}var n,s=this,l=Kt.makeMap("area base basefont br col frame hr img input isindex link meta param embed source wbr track colgroup option table tbody tfoot thead tr th td script noscript style textarea video audio iframe object menu"," "),f=function(e){n=e},e=function(){function n(e,t,n){t=new ow(e,t,s),i.push(t),t.on("init",function(){++r===o.length&&f(i)}),t.targetElm=t.targetElm||n,t.render()}var o,r=0,i=[];sw.unbind(window,"ready",e),function(){var e=u.onpageload;e&&e.apply(s,Array.prototype.slice.call(arguments,2))}("onpageload"),o=_u.unique(function(t){var n=[];if($t.browser.isIE()&&$t.browser.version.major<11)return Fh("TinyMCE does not support the browser you are using. For a list of supported browsers please see: https://www.tinymce.com/docs/get-started/system-requirements/"),[];if(vw)return Fh("Failed to initialize the editor as the document is not in standards mode. TinyMCE requires standards mode."),[];if(t.types)return fw(t.types,function(e){n=n.concat(sw.select(e.selector))}),n;if(t.selector)return sw.select(t.selector);if(t.target)return[t.target];switch(t.mode){case"exact":var e=t.elements||"";0<e.length&&fw(lw(e),function(t){var e=sw.get(t);e?n.push(e):fw(document.forms,function(e){fw(e.elements,function(e){e.name===t&&(t="mce_editor_"+mw++,sw.setAttrib(e,"id",t),n.push(e))})})});break;case"textareas":case"specific_textareas":fw(sw.select("textarea"),function(e){t.editor_deselector&&c(e,t.editor_deselector)||t.editor_selector&&!c(e,t.editor_selector)||n.push(e)})}return n}(u)),u.types?fw(u.types,function(t){Kt.each(o,function(e){return!sw.is(e,t.selector)||(n(a(e),dw({},u,t),e),!1)})}):(Kt.each(o,function(e){(e=s.get(e.id))&&e.initialized&&!(e.getContainer()||e.getBody()).parentNode&&(aw(e),e.unbindAllNativeEvents(),e.destroy(!0),e.removed=!0)}),0===(o=Kt.grep(o,function(e){return!s.get(e.id)})).length?f([]):fw(o,function(e){var t=e;u.inline&&t.tagName.toLowerCase()in l?Fh("Could not initialize inline editor on invalid inline target element",e):n(a(e),u,e)}))};return s.settings=u,sw.bind(window,"ready",e),new no(function(t){n?t(n):f=function(e){t(e)}})},get:function(t){return 0===arguments.length?hw.slice(0):Q(t)?D(hw,function(e){return e.id===t}).getOr(null):ce(t)&&hw[t]?hw[t]:null},add:function(e){var n=this;return pw[e.id]===e||(null===n.get(e.id)&&("length"!==e.id&&(pw[e.id]=e),pw.push(e),hw.push(e)),uw(!0),n.activeEditor=e,n.fire("AddEditor",{editor:e}),cw||(cw=function(e){var t=n.fire("BeforeUnload");if(t.returnValue)return e.preventDefault(),e.returnValue=t.returnValue,t.returnValue},window.addEventListener("beforeunload",cw))),e},createEditor:function(e,t){return this.add(new ow(e,t,this))},remove:function(e){var t,n,o=this;if(e){if(!Q(e))return n=e,oe(o.get(n.id))?null:(aw(n)&&o.fire("RemoveEditor",{editor:n}),0===hw.length&&window.removeEventListener("beforeunload",cw),n.remove(),uw(0<hw.length),n);fw(sw.select(e),function(e){(n=o.get(e.id))&&o.remove(n)})}else for(t=hw.length-1;0<=t;t--)o.remove(hw[t])},execCommand:function(e,t,n){var o=this.get(n);switch(e){case"mceAddEditor":return this.get(n)||new ow(n,this.settings,this).render(),!0;case"mceRemoveEditor":return o&&o.remove(),!0;case"mceToggleEditor":return o?o.isHidden()?o.show():o.hide():this.execCommand("mceAddEditor",0,n),!0}return!!this.activeEditor&&this.activeEditor.execCommand(e,t,n)},triggerSave:function(){fw(hw,function(e){e.save()})},addI18n:function(e,t){qu.add(e,t)},translate:function(e){return qu.translate(e)},setActive:function(e){var t=this.activeEditor;this.activeEditor!==e&&(t&&t.fire("deactivate",{relatedTarget:e}),e.fire("activate",{relatedTarget:t})),this.activeEditor=e},_setBaseUrl:function(e){this.baseURL=new Kx(this.documentBaseURL).toAbsolute(e.replace(/\/+$/,"")),this.baseURI=new Kx(this.baseURL)}});bw.setup();function yw(e,t,n){var o=t.x,r=t.y,i=e.w,u=e.h,e=t.w,t=t.h;return"b"===(n=(n||"").split(""))[0]&&(r+=t),"r"===n[1]&&(o+=e),"c"===n[0]&&(r+=_w(t/2)),"c"===n[1]&&(o+=_w(e/2)),"b"===n[3]&&(r-=u),"r"===n[4]&&(o-=i),"c"===n[3]&&(r-=_w(u/2)),"c"===n[4]&&(o-=_w(i/2)),Ew(o,r,i,u)}var xw,ww,Cw,Sw,kw=Math.min,Ow=Math.max,_w=Math.round,Ew=function(e,t,n,o){return{x:e,y:t,w:n,h:o}},Dt={inflate:function(e,t,n){return Ew(e.x-t,e.y-n,e.w+2*t,e.h+2*n)},relativePosition:yw,findBestRelativePosition:function(e,t,n,o){for(var r,i=0;i<o.length;i++)if((r=yw(e,t,o[i])).x>=n.x&&r.x+r.w<=n.w+n.x&&r.y>=n.y&&r.y+r.h<=n.h+n.y)return o[i];return null},intersect:function(e,t){var n=Ow(e.x,t.x),o=Ow(e.y,t.y),r=kw(e.x+e.w,t.x+t.w),t=kw(e.y+e.h,t.y+t.h);return r-n<0||t-o<0?null:Ew(n,o,r-n,t-o)},clamp:function(e,t,n){var o=e.x,r=e.y,i=e.x+e.w,u=e.y+e.h,a=t.x+t.w,c=t.y+t.h,e=Ow(0,t.x-o),t=Ow(0,t.y-r),a=Ow(0,i-a),c=Ow(0,u-c);return o+=e,r+=t,n&&(i+=e,u+=t,o-=a,r-=c),Ew(o,r,(i-=a)-o,(u-=c)-r)},create:Ew,fromClientRect:function(e){return Ew(e.left,e.top,e.width,e.height)}},Rt=(xw={},ww={},{load:function(t,n){var o='Script at URL "'+n+'" failed to load',r='Script at URL "'+n+"\" did not call `tinymce.Resource.add('"+t+"', data)` within 1 second";if(void 0!==xw[t])return xw[t];var e=new no(function(u,a){var e=function(n){void 0===n&&(n=1e3);function e(n){return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];o||(o=!0,null!==r&&(clearTimeout(r),r=null),n.apply(null,e))}}var o=!1,r=null,t=e(u),i=e(a);return{start:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];o||null!==r||(r=setTimeout(function(){return i.apply(null,e)},n))},resolve:t,reject:i}}();ww[t]=e.resolve,Vu.ScriptLoader.loadScript(n,function(){return e.start(r)},function(){return e.reject(o)})});return xw[t]=e},add:function(e,t){void 0!==ww[e]&&(ww[e](t),delete ww[e]),xw[e]=no.resolve(t)}}),Tw=Kt.each,Dw=Kt.extend,e=function(){};e.extend=Cw=function(n){function o(){var e,t,n;if(!Sw&&(this.init&&this.init.apply(this,arguments),t=this.Mixins))for(e=t.length;e--;)(n=t[e]).init&&n.init.apply(this,arguments)}function t(){return this}var r=this.prototype;Sw=!0;var i=new this;return Sw=!1,n.Mixins&&(Tw(n.Mixins,function(e){for(var t in e)"init"!==t&&(n[t]=e[t])}),r.Mixins&&(n.Mixins=r.Mixins.concat(n.Mixins))),n.Methods&&Tw(n.Methods.split(","),function(e){n[e]=t}),n.Properties&&Tw(n.Properties.split(","),function(e){var t="_"+e;n[e]=function(e){return void 0!==e?(this[t]=e,this):this[t]}}),n.Statics&&Tw(n.Statics,function(e,t){o[t]=e}),n.Defaults&&r.Defaults&&(n.Defaults=Dw({},r.Defaults,n.Defaults)),ve(n,function(e,t){var n,o;"function"==typeof e&&r[t]?i[t]=(n=t,o=e,function(){var e=this._super;this._super=r[n];var t=o.apply(this,arguments);return this._super=e,t}):i[t]=e}),o.prototype=i,(o.constructor=o).extend=Cw,o};var Aw,Bw,Nw=Math.min,Rw=Math.max,Mw=Math.round,Iw={serialize:function(e){e=JSON.stringify(e);return Q(e)?e.replace(/[\u0080-\uFFFF]/g,function(e){e=e.charCodeAt(0).toString(16);return"\\u"+"0000".substring(e.length)+e}):e},parse:function(e){try{return JSON.parse(e)}catch(e){}}},K={callbacks:{},count:0,send:function(t){var n=this,o=Iu.DOM,r=(void 0!==t.count?t:n).count,i="tinymce_jsonp_"+r;n.callbacks[r]=function(e){o.remove(i),delete n.callbacks[r],t.callback(e)},o.add(o.doc.body,"script",{id:i,src:t.url,type:"text/javascript"}),n.count++}},Fw=we(we({},Mt),{send:function(e){var t,n=0,o=function(){!e.async||4===t.readyState||1e4<n++?(e.success&&n<1e4&&200===t.status?e.success.call(e.success_scope,""+t.responseText,t,e):e.error&&e.error.call(e.error_scope,1e4<n?"TIMED_OUT":"GENERAL",t,e),t=null):mo.setTimeout(o,10)};if(e.scope=e.scope||this,e.success_scope=e.success_scope||e.scope,e.error_scope=e.error_scope||e.scope,e.async=!1!==e.async,e.data=e.data||"",Fw.fire("beforeInitialize",{settings:e}),(t=new XMLHttpRequest).overrideMimeType&&t.overrideMimeType(e.content_type),t.open(e.type||(e.data?"POST":"GET"),e.url,e.async),e.crossDomain&&(t.withCredentials=!0),e.content_type&&t.setRequestHeader("Content-Type",e.content_type),e.requestheaders&&Kt.each(e.requestheaders,function(e){t.setRequestHeader(e.key,e.value)}),t.setRequestHeader("X-Requested-With","XMLHttpRequest"),(t=Fw.fire("beforeSend",{xhr:t,settings:e}).xhr).send(e.data),!e.async)return o();mo.setTimeout(o,10)}}),Pw=Kt.extend,J=(Lw.sendRPC=function(e){return(new Lw).send(e)},Lw.prototype.send=function(e){var n=e.error,o=e.success,r=Pw(this.settings,e);r.success=function(e,t){(e=void 0===(e=Iw.parse(e))?{error:"JSON Parse error."}:e).error?n.call(r.error_scope||r.scope,e.error,t):o.call(r.success_scope||r.scope,e.result)},r.error=function(e,t){n&&n.call(r.error_scope||r.scope,e,t)},r.data=Iw.serialize({id:e.id||"c"+this.count++,method:e.method,params:e.params}),r.content_type="application/json",Fw.send(r)},Lw);function Lw(e){this.settings=Pw({},e),this.count=0}try{var Vw,Hw="__storage_test__";(Vw=window.localStorage).setItem(Hw,Hw),Vw.removeItem(Hw)}catch(e){Aw={},Bw=[],Hw={getItem:function(e){return Aw[e]||null},setItem:function(e,t){Bw.push(e),Aw[e]=String(t)},key:function(e){return Bw[e]},removeItem:function(t){Bw=Bw.filter(function(e){return e===t}),delete Aw[t]},clear:function(){Bw=[],Aw={}},length:0},Object.defineProperty(Hw,"length",{get:function(){return Bw.length},configurable:!1,enumerable:!1}),Vw=Hw}G={geom:{Rect:Dt},util:{Promise:no,Delay:mo,Tools:Kt,VK:sf,URI:Kx,Class:e,EventDispatcher:Dx,Observable:Mt,I18n:qu,XHR:Fw,JSON:Iw,JSONRequest:J,JSONP:K,LocalStorage:Vw,Color:function(e){function t(e){var t;return"object"==typeof e?"r"in e?(a=e.r,c=e.g,s=e.b):"v"in e&&function(e,t,n){if(e=(parseInt(e,10)||0)%360,t=parseInt(t,10)/100,n=parseInt(n,10)/100,t=Rw(0,Nw(t,1)),n=Rw(0,Nw(n,1)),0!==t){var e=e/60,o=n*t,r=o*(1-Math.abs(e%2-1)),t=n-o;switch(Math.floor(e)){case 0:a=o,c=r,s=0;break;case 1:a=r,c=o,s=0;break;case 2:a=0,c=o,s=r;break;case 3:a=0,c=r,s=o;break;case 4:a=r,c=0,s=o;break;case 5:a=o,c=0,s=r;break;default:a=c=s=0}a=Mw(255*(a+t)),c=Mw(255*(c+t)),s=Mw(255*(s+t))}else a=c=s=Mw(255*n)}(e.h,e.s,e.v):(t=/rgb\s*\(\s*([0-9]+)\s*,\s*([0-9]+)\s*,\s*([0-9]+)[^\)]*\)/gi.exec(e))?(a=parseInt(t[1],10),c=parseInt(t[2],10),s=parseInt(t[3],10)):(t=/#([0-F]{2})([0-F]{2})([0-F]{2})/gi.exec(e))?(a=parseInt(t[1],16),c=parseInt(t[2],16),s=parseInt(t[3],16)):(t=/#([0-F])([0-F])([0-F])/gi.exec(e))&&(a=parseInt(t[1]+t[1],16),c=parseInt(t[2]+t[2],16),s=parseInt(t[3]+t[3],16)),a=a<0?0:255<a?255:a,c=c<0?0:255<c?255:c,s=s<0?0:255<s?255:s,n}var n={},a=0,c=0,s=0;return e&&t(e),n.toRgb=function(){return{r:a,g:c,b:s}},n.toHsv=function(){return e=a,t=c,n=s,r=0,(i=Nw(e/=255,Nw(t/=255,n/=255)))===(u=Rw(e,Rw(t,n)))?{h:0,s:0,v:100*(r=i)}:(o=(u-i)/u,{h:Mw(60*((e===i?3:n===i?1:5)-(e===i?t-n:n===i?e-t:n-e)/((r=u)-i))),s:Mw(100*o),v:Mw(100*r)});var e,t,n,o,r,i,u},n.toHex=function(){function e(e){return 1<(e=parseInt(e,10).toString(16)).length?e:"0"+e}return"#"+e(a)+e(c)+e(s)},n.parse=t,n}},dom:{EventUtils:Gr,Sizzle:ji,DomQuery:_u,TreeWalker:vo,TextSeeker:ca,DOMUtils:Iu,ScriptLoader:Vu,RangeUtils:G,Serializer:eh,StyleSheetLoader:go,ControlSelection:Yl,BookmarkManager:cf,Selection:_p,Event:Gr.Event},html:{Styles:Ur,Entities:Or,Node:xd,Schema:Fr,SaxParser:$m,DomParser:Jp,Writer:Cd,Serializer:Sd},Env:$t,AddOnManager:Oa,Annotator:wl,Formatter:Gh,UndoManager:Xh,EditorCommands:yx,WindowManager:Ah,NotificationManager:Dh,EditorObservable:Lx,Shortcuts:Wx,Editor:ow,FocusManager:gd,EditorManager:bw,DOM:Iu.DOM,ScriptLoader:Vu.ScriptLoader,PluginManager:Ph,ThemeManager:Lh,IconManager:kh,Resource:Rt,trim:Kt.trim,isArray:Kt.isArray,is:Kt.is,toArray:Kt.toArray,makeMap:Kt.makeMap,each:Kt.each,map:Kt.map,grep:Kt.grep,inArray:Kt.inArray,extend:Kt.extend,create:Kt.create,walk:Kt.walk,createNS:Kt.createNS,resolve:Kt.resolve,explode:Kt.explode,_addCacheSuffix:Kt._addCacheSuffix,isOpera:$t.opera,isWebKit:$t.webkit,isIE:$t.ie,isGecko:$t.gecko,isMac:$t.mac},Rt=Kt.extend(bw,G),G=Rt;window.tinymce=G,window.tinyMCE=G,function(e){if("object"==typeof module)try{module.exports=e}catch(e){}}(Rt)}(),function(){"use strict";function W(){}function i(n,o){return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return n(o.apply(null,e))}}function l(e){return e}var q=function(e){return function(){return e}};function m(o){for(var r=[],e=1;e<arguments.length;e++)r[e-1]=arguments[e];return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=r.concat(e);return o.apply(null,n)}}function p(t){return function(e){return!t(e)}}function u(e){return function(){throw new Error(e)}}var c=q(!1),v=q(!0),e=tinymce.util.Tools.resolve("tinymce.ThemeManager"),A=function(){return(A=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)};function f(e,t){var n={};for(r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var o=0,r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]]);return n}function h(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;for(var o=Array(e),r=0,t=0;t<n;t++)for(var i=arguments[t],u=0,a=i.length;u<a;u++,r++)o[r]=i[u];return o}var t=function(){return a},a={fold:function(e,t){return e()},is:c,isSome:c,isNone:v,getOr:r,getOrThunk:o,getOrDie:function(e){throw new Error(e||"error: getOrDie called on none.")},getOrNull:q(null),getOrUndefined:q(void 0),or:r,orThunk:o,map:t,each:W,bind:t,exists:c,forall:v,filter:t,equals:n,equals_:n,toArray:function(){return[]},toString:q("none()")};function n(e){return e.isNone()}function o(e){return e()}function r(e){return e}function s(e){return!(null==e)}function d(e,t){if(X(e)){for(var n=0,o=e.length;n<o;++n)if(!t(e[n]))return!1;return!0}return!1}function g(e,t){return ee.call(e,t)}function b(e,t){for(var n=0,o=e.length;n<o;n++)if(t(e[n],n))return!0;return!1}function y(e,t){for(var n=[],o=0;o<e;o++)n.push(t(o));return n}function x(e,t){for(var n=[],o=0;o<e.length;o+=t){var r=Z.call(e,o,o+t);n.push(r)}return n}function S(e,t){for(var n=e.length,o=new Array(n),r=0;r<n;r++){var i=e[r];o[r]=t(i,r)}return o}function w(e,t){for(var n=[],o=[],r=0,i=e.length;r<i;r++){var u=e[r];(t(u,r)?n:o).push(u)}return{pass:n,fail:o}}function C(e,t){for(var n=[],o=0,r=e.length;o<r;o++){var i=e[o];t(i,o)&&n.push(i)}return n}function k(e,t,n){return function(e,t){for(var n=e.length-1;0<=n;n--)t(e[n],n)}(e,function(e){n=t(n,e)}),n}function O(e,t,n){return oe(e,function(e){n=t(n,e)}),n}function _(e,t){return function(e,t,n){for(var o=0,r=e.length;o<r;o++){var i=e[o];if(t(i,o))return G.some(i);if(n(i,o))break}return G.none()}(e,t,c)}function E(e,t){for(var n=0,o=e.length;n<o;n++)if(t(e[n],n))return G.some(n);return G.none()}function B(e){for(var t=[],n=0,o=e.length;n<o;++n){if(!X(e[n]))throw new Error("Arr.flatten item "+n+" was not an array, input: "+e);te.apply(t,e[n])}return t}function T(e,t){return B(S(e,t))}function D(e,t){for(var n=0,o=e.length;n<o;++n)if(!0!==t(e[n],n))return!1;return!0}function N(e){return(e=Z.call(e,0)).reverse(),e}function R(e,t){return C(e,function(e){return!ne(t,e)})}function M(e,t){return(e=Z.call(e,0)).sort(t),e}function I(e,t){return 0<=t&&t<e.length?G.some(e[t]):G.none()}function F(e){return I(e,e.length-1)}function P(e,t){for(var n=0;n<e.length;n++){var o=t(e[n],n);if(o.isSome())return o}return G.none()}var L,V,H=function(n){function e(){return r}function t(e){return e(n)}var o=q(n),r={fold:function(e,t){return t(n)},is:function(e){return n===e},isSome:v,isNone:c,getOr:o,getOrThunk:o,getOrDie:o,getOrNull:o,getOrUndefined:o,or:e,orThunk:e,map:function(e){return H(e(n))},each:function(e){e(n)},bind:t,exists:t,forall:t,filter:function(e){return e(n)?r:a},toArray:function(){return[n]},toString:function(){return"some("+n+")"},equals:function(e){return e.is(n)},equals_:function(e,t){return e.fold(c,function(e){return t(n,e)})}};return r},G={some:H,none:t,from:function(e){return null==e?a:H(e)}},z=function(n){return function(e){return e=typeof(t=e),(null===t?"null":"object"==e&&(Array.prototype.isPrototypeOf(t)||t.constructor&&"Array"===t.constructor.name)?"array":"object"==e&&(String.prototype.isPrototypeOf(t)||t.constructor&&"String"===t.constructor.name)?"string":e)===n;var t}},j=function(t){return function(e){return typeof e===t}},U=z("string"),$=z("object"),X=z("array"),Y=j("boolean"),K=(L=void 0,function(e){return L===e}),J=j("function"),Q=j("number"),Z=Array.prototype.slice,ee=Array.prototype.indexOf,te=Array.prototype.push,ne=function(e,t){return-1<g(e,t)},oe=function(e,t){for(var n=0,o=e.length;n<o;n++)t(e[n],n)},re=function(e){return I(e,0)},ie=J(Array.from)?Array.from:function(e){return Z.call(e)},ue=function(n){return{is:function(e){return n===e},isValue:v,isError:c,getOr:q(n),getOrThunk:q(n),getOrDie:q(n),or:function(e){return ue(n)},orThunk:function(e){return ue(n)},fold:function(e,t){return t(n)},map:function(e){return ue(e(n))},mapError:function(e){return ue(n)},each:function(e){e(n)},bind:function(e){return e(n)},exists:function(e){return e(n)},forall:function(e){return e(n)},toOptional:function(){return G.some(n)}}},ae=function(n){return{is:c,isValue:c,isError:v,getOr:l,getOrThunk:function(e){return e()},getOrDie:function(){return u(String(n))()},or:function(e){return e},orThunk:function(e){return e()},fold:function(e,t){return e(n)},map:function(e){return ae(n)},mapError:function(e){return ae(e(n))},each:W,bind:function(e){return ae(n)},exists:c,forall:v,toOptional:G.none}},ce={value:ue,error:ae,fromOption:function(e,t){return e.fold(function(){return ae(t)},ue)}};(yc=V=V||{})[yc.Error=0]="Error",yc[yc.Value=1]="Value";function se(e,t,n){return e.stype===V.Error?t(e.serror):n(e.svalue)}function le(e){return{stype:V.Value,svalue:e}}function fe(e){return{stype:V.Error,serror:e}}function de(e,n){return go(e,function(e,t){return{k:t,v:n(e,t)}})}function me(e,t){var n,o,r,i,u={};return n=t,i=u,o=function(e,t){i[t]=e},r=W,mo(e,function(e,t){(n(e,t)?o:r)(e,t)}),u}function ge(e,t){for(var n=lo(e),o=0,r=n.length;o<r;o++){var i=n[o],u=e[i];if(t(u,i,e))return G.some(u)}return G.none()}function pe(e){return po(e,function(e){return e})}function he(e,t){return vo(e,t)&&void 0!==e[t]&&null!==e[t]}function ve(n){var o,r=!1;return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return r||(r=!0,o=n.apply(null,e)),o}}function be(e){return So.defaultedThunk(q(e))}function ye(e,t){var n={};return n[e]=t,n}function xe(e,t){return n=t,o={},mo(e,function(e,t){ne(n,t)||(o[t]=e)}),o;var n,o}function we(e){return t={},oe(e,function(e){t[e.key]=e.value}),t;var t}function Ce(e,t){var n,o,r;return 0<(r=(n=[],o=[],oe(e,function(e){e.fold(function(e){n.push(e)},function(e){o.push(e)})}),{errors:n,values:o})).errors.length?(e=r.errors,ce.error(B(e))):(t=t,0===(r=r.values).length?ce.value(t):ce.value(wo(t,Co.apply(void 0,r))))}function Se(e){return i(io,B)(e)}function ke(e){return $(e)&&100<lo(e).length?" removed due to size":JSON.stringify(e,null,2)}function Oe(e,t){return io([{path:e,getErrorInfo:t}])}function _e(n,o,r){return ho(o,r).fold(function(){return e=r,t=o,Oe(n,function(){return'Could not find valid *strict* value for "'+e+'" in '+ke(t)});var e,t},oo)}function Ee(e,t,n){return t=ho(e,t).fold(function(){return n(e)},l),oo(t)}function Te(u,a,e,c){return e.fold(function(n,t,e,o){function r(e){return e=o.extract(u.concat([n]),c,e),co(e,function(e){return ye(t,c(e))})}function i(e){return e.fold(function(){var e=ye(t,c(G.none()));return oo(e)},function(e){e=o.extract(u.concat([n]),c,e);return co(e,function(e){return ye(t,c(G.some(e)))})})}return e.fold(function(){return uo(_e(u,a,n),r)},function(e){return uo(Ee(a,n,e),r)},function(){return uo(oo(ho(a,n)),i)},function(e){return uo(function(t,e,n){e=ho(t,e).map(function(e){return!0===e?n(t):e});return oo(e)}(a,n,e),i)},function(e){var t=e(a),e=co(Ee(a,n,q({})),function(e){return wo(t,e)});return uo(e,r)})},function(e,t){t=t(a);return oo(ye(e,c(t)))})}function De(o){return{extract:function(n,e,t){return ao(o(t,e),function(e){return t=e,Oe(n,function(){return t});var t})},toString:function(){return"val"}}}function Ae(e){var i=No(e),u=k(e,function(t,e){return e.fold(function(e){return wo(t,To(e,!0))},q(t))},{});return{extract:function(e,t,n){var o,r=Y(n)?[]:lo(me(n,function(e){return null!=e})),r=C(r,function(e){return!he(u,e)});return 0===r.length?i.extract(e,t,n):(o=r,Oe(e,function(){return"There are unsupported fields: ["+o.join(", ")+"] specified"}))},toString:i.toString}}function Be(r){return{extract:function(n,o,e){e=S(e,function(e,t){return r.extract(n.concat(["["+t+"]"]),o,e)});return Ao(e)},toString:function(){return"array("+r.toString()+")"}}}function Ne(r,i){return{extract:function(t,n,o){var e=lo(o),e=Be(De(r)).extract(t,l,e);return uo(e,function(e){e=S(e,function(e){return Bo.field(e,e,ko(),i)});return No(e).extract(t,n,o)})},toString:function(){return"setOf("+i.toString()+")"}}}function Re(n,t,o,r,i){return ho(r,i).fold(function(){return e=r,t=i,Oe(n,function(){return'The chosen schema: "'+t+'" did not exist in branches: '+ke(e)});var e,t},function(e){return e.extract(n.concat(["branch: "+i]),t,o)})}function Me(r,i){return{extract:function(t,n,o){return ho(o,r).fold(function(){return e=r,Oe(t,function(){return'Choice schema did not contain choice key: "'+e+'"'});var e},function(e){return Re(t,n,o,i,e)})},toString:function(){return"chooseOn("+r+"). Possible values: "+lo(i)}}}function Ie(t){return De(function(e){return t(e).fold(io,oo)})}function Fe(e,t,n){return no(function(e,t,n,o){n=t.extract([e],n,o);return so(n,function(e){return{input:o,errors:e}})}(e,t,l,n))}function Pe(e){return e.fold(function(e){throw new Error(jo(e))},l)}function Le(e,t,n){return Pe(Fe(e,t,n))}function Ve(e,t){return Me(e,de(t,No))}function He(t){return Ie(function(e){return ne(t,e)?ce.value(e):ce.error('Unsupported value: "'+e+'", choose one of "'+t.join(", ")+'".')})}function ze(e){return Po(e,e,ko(),Mo())}function je(e,t){return Po(e,e,ko(),t)}function Ue(e){return je(e,$o)}function We(e,t){return Po(e,e,ko(),He(t))}function qe(e,t){return Po(e,e,ko(),No(t))}function Ge(e,t){return Po(e,e,ko(),Io(t))}function $e(e,t){return Po(e,e,ko(),Be(t))}function Xe(e){return Po(e,e,Oo(),Mo())}function Ye(e,t){return Po(e,e,Oo(),t)}function Ke(e){return Ye(e,Go)}function Je(e){return Ye(e,$o)}function Qe(e,t){return Ye(e,No(t))}function Ze(e,t){return Po(e,e,be(t),Mo())}function et(e,t,n){return Po(e,e,be(t),n)}function tt(e,t){return et(e,t,$o)}function nt(e,t){return et(e,t,Yo)}function ot(e,t,n){return et(e,t,No(n))}function rt(e,t){return Fo(e,t)}function it(e){var t=e;return{get:function(){return t},set:function(e){t=e}}}function ut(e,t){var n=String(t).toLowerCase();return _(e,function(e){return e.search(n)})}function at(e,t){return-1!==e.indexOf(t)}function ct(e,t){return n=t,t=(e=e).length-t.length,""===n||e.length>=n.length&&e.substr(t,t+n.length)===n;var n}function st(e){return window.matchMedia(e).matches}function lt(e,t){if(1!==(e=e.dom).nodeType)return!1;if(void 0!==e.matches)return e.matches(t);if(void 0!==e.msMatchesSelector)return e.msMatchesSelector(t);if(void 0!==e.webkitMatchesSelector)return e.webkitMatchesSelector(t);if(void 0!==e.mozMatchesSelector)return e.mozMatchesSelector(t);throw new Error("Browser lacks native selectors")}function ft(e){return 1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType||0===e.childElementCount}function dt(e,t){return e.dom===t.dom}function mt(e,t){return n=e.dom,e=t.dom,t=Node.DOCUMENT_POSITION_CONTAINED_BY,0!=(n.compareDocumentPosition(e)&t);var n}function gt(e,t){return(Cr().browser.isIE()?mt:function(e,t){e=e.dom,t=t.dom;return e!==t&&e.contains(t)})(e,t)}function pt(e){return J(e)?e:c}function ht(e,t,n){for(var o=e.dom,r=pt(n);o.parentNode;){var o=o.parentNode,i=ir.fromDom(o),u=t(i);if(u.isSome())return u;if(r(i))break}return G.none()}function vt(e,t){return dt(e.element,t.event.target)}function bt(e){if(!he(e,"can")&&!he(e,"abort")&&!he(e,"run"))throw new Error("EventHandler defined by: "+JSON.stringify(e,null,2)+" does not have can, abort, or run!");return Le("Extracting event.handler",Ae([Ze("can",v),Ze("abort",c),Ze("run",W)]),e)}function yt(n){var t,o,r,i,e=(o=function(e){return e.can},function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return O(t,function(e,t){return e&&o(t).apply(void 0,n)},!0)}),u=(r=t=n,i=function(e){return e.abort},function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return O(r,function(e,t){return e||i(t).apply(void 0,n)},!1)});return bt({can:e,abort:u,run:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];oe(n,function(e){e.run.apply(void 0,t)})}})}function xt(e,t){hi(e,e.element,t,{})}function wt(e,t,n){hi(e,e.element,t,n)}function Ct(e){xt(e,Yr())}function St(e,t,n){hi(e,t,n,{})}function kt(e,t,n,o){e.getSystem().triggerEvent(n,t,o.event)}function Ot(e,t){return{key:e,value:bt({abort:t})}}function _t(e){return{key:e,value:bt({run:function(e,t){t.event.prevent()}})}}function Et(e,t){return{key:e,value:bt({run:t})}}function Tt(e,n,o){return{key:e,value:bt({run:function(e,t){n.apply(void 0,[e,t].concat(o))}})}}function Dt(e){return function(n){return{key:e,value:bt({run:function(e,t){vt(e,t)&&n(e,t)}})}}}function At(e,t,n){var o,r,n=t.partUids[n];return r=n,Et(o=e,function(e,t){e.getSystem().getByUid(r).each(function(e){kt(e,e.element,o,t)})})}function Bt(e,r){return Et(e,function(t,e){var n=e.event,o=t.getSystem().getByDom(n.target).fold(function(){return Sr(n.target,function(e){return t.getSystem().getByDom(e).toOptional()},c).getOr(t)},function(e){return e});r(t,o,e)})}function Nt(e){return Et(e,function(e,t){t.cut()})}function Rt(e,t){return Dt(e)(t)}function Mt(e){return e.dom.nodeName.toLowerCase()}function It(e){return ir.fromDom(e.dom.ownerDocument)}function Ft(e){return Oi(e)?e:It(e)}function Pt(e){return ir.fromDom(Ft(e).dom.documentElement)}function Lt(e){return ir.fromDom(Ft(e).dom.defaultView)}function Vt(e){return G.from(e.dom.parentNode).map(ir.fromDom)}function Ht(e){return G.from(e.dom.offsetParent).map(ir.fromDom)}function zt(e){return S(e.dom.childNodes,ir.fromDom)}function jt(e,t){return e=e.dom.childNodes,G.from(e[t]).map(ir.fromDom)}function Ut(t,n){Vt(t).each(function(e){e.dom.insertBefore(n.dom,t.dom)})}function Wt(e,t){G.from(e.dom.nextSibling).map(ir.fromDom).fold(function(){Vt(e).each(function(e){Ti(e,t)})},function(e){Ut(e,t)})}function qt(t,n){jt(t,0).fold(function(){Ti(t,n)},function(e){t.dom.insertBefore(n.dom,e.dom)})}function Gt(t,e){oe(e,function(e){Ti(t,e)})}function $t(e){e.dom.textContent="",oe(zt(e),function(e){Di(e)})}function Xt(e){var t,n=zt(e);0<n.length&&(t=e,oe(n,function(e){Ut(t,e)})),Di(e)}function Yt(e){return e.dom.innerHTML}function Kt(e,t){var n=It(e).dom,o=ir.fromDom(n.createDocumentFragment()),n=function(e,t){t=(t||document).createElement("div");return t.innerHTML=e,zt(ir.fromDom(t))}(t,n);Gt(o,n),$t(e),Ti(e,o)}function Jt(e,t,n){if(!(U(n)||Y(n)||Q(n)))throw console.error("Invalid call to Attribute.set. Key ",t,":: Value ",n,":: Element ",e),new Error("Attribute value was not simple");e.setAttribute(t,n+"")}function Qt(e,t,n){Jt(e.dom,t,n)}function Zt(e,t){return null===(t=e.dom.getAttribute(t))?void 0:t}function en(e,t){return G.from(Zt(e,t))}function tn(e,t){return!(!(e=e.dom)||!e.hasAttribute)&&e.hasAttribute(t)}function nn(e,t){e.dom.removeAttribute(t)}function on(e){return t=!1,ir.fromDom(e.dom.cloneNode(t));var t}function rn(e){var t=on(e);return e=t,t=ir.fromTag("div"),e=ir.fromDom(e.dom.cloneNode(!0)),Ti(t,e),Yt(t)}function un(e){var t=(new Date).getTime();return e+"_"+Math.floor(1e9*Math.random())+ ++Ni+String(t)}function an(t){function e(e){return function(){throw new Error("The component must be in a context to send: "+e+(t?"\n"+rn(t().element)+" is not in context.":""))}}return{debugInfo:q("fake"),triggerEvent:e("triggerEvent"),triggerFocus:e("triggerFocus"),triggerEscape:e("triggerEscape"),build:e("build"),addToWorld:e("addToWorld"),removeFromWorld:e("removeFromWorld"),addToGui:e("addToGui"),removeFromGui:e("removeFromGui"),getByUid:e("getByUid"),getByDom:e("getByDom"),broadcast:e("broadcast"),broadcastOn:e("broadcastOn"),broadcastEvent:e("broadcastEvent"),isConnected:c}}function cn(e,t){var n=e.toString(),o=n.indexOf(")")+1,r=n.indexOf("("),i=n.substring(r+1,o-1).split(/,\s*/);return e.toFunctionAnnotation=function(){return{name:t,parameters:ji(i)}},e}function sn(e){return To(Ui,e)}function ln(o){return e=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return o.apply(void 0,h([e.getApis(),e],t))},n=(t=o).toString(),r=n.indexOf(")")+1,t=n.indexOf("("),i=n.substring(t+1,r-1).split(/,\s*/),e.toFunctionAnnotation=function(){return{name:"OVERRIDE",parameters:ji(i.slice(1))}},e;var e,t,n,r,i}function fn(e,r){var i={};return mo(e,function(e,o){mo(e,function(e,t){var n=ho(i,t).getOr([]);i[t]=n.concat([r(o,e)])})}),i}function dn(e){return{classes:void 0!==e.classes?e.classes:[],attributes:void 0!==e.attributes?e.attributes:{},styles:void 0!==e.styles?e.styles:{}}}function mn(t,e,n,o){var r=A({},e);function i(e){return k(e,function(e,t){return A(A({},t.modification),e)},{})}oe(n,function(e){r[e.name()]=e.exhibit(t,o)});var u=fn(r,function(e,t){return{name:e,modification:t}}),e=k(u.classes,function(e,t){return t.modification.concat(e)},[]),n=i(u.attributes),u=i(u.styles);return dn({classes:e,attributes:n,styles:u})}function gn(e){return e.cHandler}function pn(e,t){return{name:e,handler:t}}function hn(e,t,n){var o,r,t=A(A({},n),(o=e,r={},oe(t,function(e){r[e.name()]=e.handlers(o)}),r));return fn(t,pn)}function vn(e){var r=J(e=e)?{can:q(!0),abort:q(!1),run:e}:e;return function(e,t){for(var n=[],o=2;o<arguments.length;o++)n[o-2]=arguments[o];e=[e,t].concat(n);r.abort.apply(void 0,e)?t.stop():r.can.apply(void 0,e)&&r.run.apply(void 0,e)}}function bn(e,t,n){return(t=t[n])?function(r,i,e,u){try{var t=M(e,function(e,t){var n=e[i],o=t[i],e=u.indexOf(n),t=u.indexOf(o);if(-1===e)throw new Error("The ordering for "+r+" does not have an entry for "+n+".\nOrder specified: "+JSON.stringify(u,null,2));if(-1===t)throw new Error("The ordering for "+r+" does not have an entry for "+o+".\nOrder specified: "+JSON.stringify(u,null,2));return e<t?-1:t<e?1:0});return ce.value(t)}catch(e){return ce.error([e])}}("Event: "+n,"name",e,t).map(function(e){e=S(e,function(e){return e.handler});return yt(e)}):ce.error(["The event ("+n+') has more than one behaviour that listens to it.\nWhen this occurs, you must specify an event ordering for the behaviours in your spec (e.g. [ "listing", "toggling" ]).\nThe behaviours that can trigger it are: '+JSON.stringify(S(e,function(e){return e.name}),null,2)])}function yn(e){var t;return Fe("custom.definition",No([Po("dom","dom",ko(),No([ze("tag"),Ze("styles",{}),Ze("classes",[]),Ze("attributes",{}),Xe("value"),Xe("innerHtml")])),ze("components"),ze("uid"),Ze("events",{}),Ze("apis",{}),Po("eventOrder","eventOrder",((t={})[Yr()]=["disabling",Xi,"toggling","typeaheadevents"],t[qr()]=[Xi,"focusing","keying"],t[ti()]=[Xi,"disabling","toggling","representing"],t[Lr()]=[Xi,"representing","streaming","invalidating"],t[ai()]=[Xi,"representing","item-events","tooltipping"],t[Dr()]=["focusing",Xi,"item-type-events"],t[Or()]=["focusing",Xi,"item-type-events"],t[Rr()]=["item-type-events","tooltipping"],t[Xr()]=["receiving","reflecting","tooltipping"],t=t,So.mergeWithThunk(q(t))),Wo()),Xe("domModification")]),e)}function xn(e,t){return void 0===(t=Zt(e,t))||""===t?[]:t.split(" ")}function wn(e){return void 0!==e.dom.classList}function Cn(e,t){return function(e,t,n){n=xn(e,t).concat([n]);return Qt(e,t,n.join(" ")),!0}(e,"class",t)}function Sn(e,t){return o=t,0<(e=C(xn(n=e,t="class"),function(e){return e!==o})).length?Qt(n,t,e.join(" ")):nn(n,t),0;var n,o}function kn(e,t){wn(e)?e.dom.classList.add(t):Cn(e,t)}function On(e){0===(wn(e)?e.dom.classList:xn(e,"class")).length&&nn(e,"class")}function _n(e,t){wn(e)?e.dom.classList.remove(t):Sn(e,t),On(e)}function En(e,t){return wn(e)&&e.dom.classList.contains(t)}function Tn(t,e){oe(e,function(e){kn(t,e)})}function Dn(t,e){oe(e,function(e){_n(t,e)})}function An(e){return void 0!==e.style&&J(e.style.getPropertyValue)}function Bn(e){return _i(e)}function Nn(e){return Bn(e)?e:ir.fromDom(Ft(e).dom.body)}function Rn(e){return ir.fromDom(e.dom.host)}function Mn(e,t,n){if(!U(n))throw console.error("Invalid call to CSS.set. Property ",t,":: Value ",n,":: Element ",e),new Error("CSS value must be a string: "+n);An(e)&&e.style.setProperty(t,n)}function In(e,t){An(e)&&e.style.removeProperty(t)}function Fn(e,t,n){e=e.dom,Mn(e,t,n)}function Pn(e,t){var n=e.dom;mo(t,function(e,t){Mn(n,t,e)})}function Ln(e,t){var n=e.dom;mo(t,function(e,t){e.fold(function(){In(n,t)},function(e){Mn(n,t,e)})})}function Vn(e,t){var n=e.dom,o=window.getComputedStyle(n).getPropertyValue(t);return""!==o||eu(e)?o:ou(n,t)}function Hn(e,t){return e=e.dom,t=ou(e,t),G.from(t).filter(function(e){return 0<e.length})}function zn(e,t,n){return e=ir.fromTag(e),Fn(e,t,n),Hn(e,t).isSome()}function jn(e,t){var n=e.dom;In(n,t),en(e,"style").map(fr).is("")&&nn(e,"style")}function Un(e){return e.dom.offsetWidth}function Wn(e){return e.dom.value}function qn(e,t){if(void 0===t)throw new Error("Value.set was undefined");e.dom.value=t}function Gn(e){var n,t=ir.fromTag(e.tag);o=e.attributes,n=t.dom,mo(o,function(e,t){Jt(n,t,e)}),Tn(t,e.classes),Pn(t,e.styles),e.innerHtml.each(function(e){return Kt(t,e)});var o=e.domChildren;return Gt(t,o),e.value.each(function(e){qn(t,e)}),e.uid,Pi(t,e.uid),t}function $n(e,t){return n=e,t=S(e=t,function(e){return Qe(e.name(),[ze("config"),Ze("state",Wi)])}),t=Fe("component.behaviours",No(t),n.behaviours).fold(function(e){throw new Error(jo(e)+"\nComplete spec:\n"+JSON.stringify(n,null,2))},function(e){return e}),{list:e,data:de(t,function(e){var t=e.map(function(e){return{config:e.config,state:e.state.init(e.config)}});return function(){return t}})};var n}function Xn(e){var t,n=(t=ho(n=e,"behaviours").getOr({}),n=C(lo(t),function(e){return void 0!==t[e]}),S(n,function(e){return t[e].me}));return $n(e,n)}function Yn(e,t,n){var o=A(A({},(o=e).dom),{uid:o.uid,domChildren:S(o.components,function(e){return e.element})}),e=e.domModification.fold(function(){return dn({})},dn);return e=e=0<t.length?mn(n,{"alloy.base.modification":e},t,o):e,A(A({},o=o),{attributes:A(A({},o.attributes),e.attributes),styles:A(A({},o.styles),e.styles),classes:o.classes.concat(e.classes)})}function Kn(e,t,n){var o={"alloy.base.behaviour":e.events};return function(e,t,n,o){o=hn(e,n,o);return $i(o,t)}(n,e.eventOrder,t,o).getOrDie()}function Jn(e){var n,t,o,r,i,u,a,c=(s=Hi(e)).events,s=function(e){e=ho(e,"components").getOr([]);return S(e,uu)}(e=f(s,["events"])),c=A(A({},e),{events:A(A({},Bi),c),components:s});return ce.value((t=it(zi),o=Pe(yn(n=c)),s=Xn(n),c=s.list,r=s.data,s=Yn(o,c,r),i=Gn(s),c=Kn(o,c,r),u=it(o.components),a={getSystem:t.get,config:function(e){var t=r;return(J(t[e.name()])?t[e.name()]:function(){throw new Error("Could not find "+e.name()+" in "+JSON.stringify(n,null,2))})()},hasConfigured:function(e){return J(r[e.name()])},spec:n,readState:function(e){return r[e]().map(function(e){return e.state.readState()}).getOr("not enabled")},getApis:function(){return o.apis},connect:function(e){t.set(e)},disconnect:function(){t.set(an(l))},element:i,syncComponents:function(){var e=zt(i),e=T(e,function(e){return t.get().getByDom(e).fold(function(){return[]},function(e){return[e]})});u.set(e)},components:u.get,events:c}));function l(){return a}}function Qn(e){return e=ir.fromText(e),ru({element:e})}var Zn,eo,to=function(e){return e.fold(fe,le)},no=function(e){return se(e,ce.error,ce.value)},oo=le,ro=function(e){var t=[],n=[];return oe(e,function(e){se(e,function(e){return n.push(e)},function(e){return t.push(e)})}),{values:t,errors:n}},io=fe,uo=function(e,t){return e.stype===V.Value?t(e.svalue):e},ao=function(e,t){return e.stype===V.Error?t(e.serror):e},co=function(e,t){return e.stype===V.Value?{stype:V.Value,svalue:t(e.svalue)}:e},so=function(e,t){return e.stype===V.Error?{stype:V.Error,serror:t(e.serror)}:e},lo=Object.keys,fo=Object.hasOwnProperty,mo=function(e,t){for(var n=lo(e),o=0,r=n.length;o<r;o++){var i=n[o];t(e[i],i)}},go=function(e,n){var o={};return mo(e,function(e,t){t=n(e,t);o[t.k]=t.v}),o},po=function(e,n){var o=[];return mo(e,function(e,t){o.push(n(e,t))}),o},ho=function(e,t){return vo(e,t)?G.from(e[t]):G.none()},vo=function(e,t){return fo.call(e,t)},bo=function(u){if(!X(u))throw new Error("cases must be an array");if(0===u.length)throw new Error("there must be at least one case");var a=[],n={};return oe(u,function(e,o){var t=lo(e);if(1!==t.length)throw new Error("one and only one name per case");var r=t[0],i=e[r];if(void 0!==n[r])throw new Error("duplicate key detected:"+r);if("cata"===r)throw new Error("cannot have a case named cata (sorry)");if(!X(i))throw new Error("case arguments must be an array");a.push(r),n[r]=function(){var e=arguments.length;if(e!==i.length)throw new Error("Wrong number of arguments to case "+r+". Expected "+i.length+" ("+i+"), got "+e);for(var n=new Array(e),t=0;t<n.length;t++)n[t]=arguments[t];return{fold:function(){if(arguments.length!==u.length)throw new Error("Wrong number of arguments to fold. Expected "+u.length+", got "+arguments.length);return arguments[o].apply(null,n)},match:function(e){var t=lo(e);if(a.length!==t.length)throw new Error("Wrong number of arguments to match. Expected: "+a.join(",")+"\nActual: "+t.join(","));if(!D(a,function(e){return ne(t,e)}))throw new Error("Not all branches were specified when using match. Specified: "+t.join(", ")+"\nRequired: "+a.join(", "));return e[r].apply(null,n)},log:function(e){console.log(e,{constructors:a,constructor:r,params:n})}}}}),n},yo=Object.prototype.hasOwnProperty,xo=function(u){return function(){for(var e=new Array(arguments.length),t=0;t<e.length;t++)e[t]=arguments[t];if(0===e.length)throw new Error("Can't merge zero objects");for(var n={},o=0;o<e.length;o++){var r,i=e[o];for(r in i)yo.call(i,r)&&(n[r]=u(n[r],i[r]))}return n}},wo=xo(function(e,t){return $(e)&&$(t)?wo(e,t):t}),Co=xo(function(e,t){return t}),So=bo([{strict:[]},{defaultedThunk:["fallbackThunk"]},{asOption:[]},{asDefaultedOptionThunk:["fallbackThunk"]},{mergeWithThunk:["baseThunk"]}]),ko=So.strict,Oo=So.asOption,_o=So.defaultedThunk,Eo=(So.asDefaultedOptionThunk,So.mergeWithThunk),To=(bo([{bothErrors:["error1","error2"]},{firstError:["error1","value2"]},{secondError:["value1","error2"]},{bothValues:["value1","value2"]}]),ye),Do=function(e,t){e=ro(e);return 0<e.errors.length?Se(e.errors):(e=e.values,t=t,0<e.length?oo(wo(t,Co.apply(void 0,e))):oo(t))},Ao=function(e){e=ro(e);return 0<e.errors.length?Se(e.errors):oo(e.values)},Bo=bo([{field:["key","okey","presence","prop"]},{state:["okey","instantiator"]}]),No=function(o){return{extract:function(e,t,n){return function(t,n,e,o){e=S(e,function(e){return Te(t,n,e,o)});return Do(e,{})}(e,n,o,t)},toString:function(){return"obj{\n"+S(o,function(e){return e.fold(function(e,t,n,o){return e+" -> "+o.toString()},function(e,t){return"state("+e+")"})}).join("\n")+"}"}}},Ro=function(a){return{extract:function(e,t,n){for(var o=[],r=0,i=a;r<i.length;r++){var u=i[r].extract(e,t,n);if(u.stype===V.Value)return u;o.push(u)}return Ao(o)},toString:function(){return"oneOf("+S(a,function(e){return e.toString()}).join(", ")+")"}}},Mo=q(De(oo)),Io=i(Be,No),Fo=Bo.state,Po=Bo.field,Lo=De(oo),Vo=function(e){return Io(e)},Ho=function(o){return{extract:function(e,t,n){return o().extract(e,t,n)},toString:function(){return o().toString()}}},zo=function(t,e){return Ne(function(e){return to(t(e))},e)},jo=function(e){return"Errors: \n"+function(e){e=10<e.length?e.slice(0,10).concat([{path:[],getErrorInfo:function(){return"... (only showing first ten failures)"}}]):e;return S(e,function(e){return"Failed path: ("+e.path.join(" > ")+")\n"+e.getErrorInfo()})}(e.errors).join("\n")+"\n\nInput object: "+ke(e.input)},Uo=Me,Wo=q(Lo),qo=function(n,o){return De(function(e){var t=typeof e;return n(e)?oo(e):io("Expected type: "+o+" but got: "+t)})},Go=qo(Q,"number"),$o=qo(U,"string"),Xo=qo(Y,"boolean"),Yo=qo(J,"function"),Ko=function(t){function e(e,t){for(var n=e.next();!n.done;){if(!t(n.value))return!1;n=e.next()}return!0}if(Object(t)!==t)return!0;switch({}.toString.call(t).slice(8,-1)){case"Boolean":case"Number":case"String":case"Date":case"RegExp":case"Blob":case"FileList":case"ImageData":case"ImageBitmap":case"ArrayBuffer":return!0;case"Array":case"Object":return Object.keys(t).every(function(e){return Ko(t[e])});case"Map":return e(t.keys(),Ko)&&e(t.values(),Ko);case"Set":return e(t.keys(),Ko);default:return!1}},Jo=De(function(e){return Ko(e)?oo(e):io("Expected value to be acceptable for sending via postMessage")}),Qo=function(e){return je(e,Yo)},Zo=function(e){return Ye(e,Yo)},er=function(e,t){return et(e,t,Go)},tr=function(e,t,n){return et(e,t,He(n))},nr=function(e,t){return et(e,t,Xo)},or=function(e,t,n){return et(e,t,Be(n))},rr=function(e){if(null==e)throw new Error("Node cannot be null or undefined");return{dom:e}},ir={fromHtml:function(e,t){t=(t||document).createElement("div");if(t.innerHTML=e,!t.hasChildNodes()||1<t.childNodes.length)throw console.error("HTML does not have a single root node",e),new Error("HTML must have a single root node");return rr(t.childNodes[0])},fromTag:function(e,t){e=(t||document).createElement(e);return rr(e)},fromText:function(e,t){e=(t||document).createTextNode(e);return rr(e)},fromDom:rr,fromPoint:function(e,t,n){return G.from(e.dom.elementFromPoint(t,n)).map(rr)}},ur=function(){return ar(0,0)},ar=function(e,t){return{major:e,minor:t}},cr={nu:ar,detect:function(e,t){t=String(t).toLowerCase();return 0===e.length?ur():function(e,t){var n=function(e,t){for(var n=0;n<e.length;n++){var o=e[n];if(o.test(t))return o}}(e,t);if(!n)return{major:0,minor:0};e=function(e){return Number(t.replace(n,"$"+e))};return ar(e(1),e(2))}(e,t)},unknown:ur},sr=function(e,n){return ut(e,n).map(function(e){var t=cr.detect(e.versionRegexes,n);return{current:e.name,version:t}})},lr=function(e,n){return ut(e,n).map(function(e){var t=cr.detect(e.versionRegexes,n);return{current:e.name,version:t}})},fr=(Zn=/^\s+|\s+$/g,function(e){return e.replace(Zn,"")}),dr=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,mr=function(t){return function(e){return at(e,t)}},gr=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(e){return at(e,"edge/")&&at(e,"chrome")&&at(e,"safari")&&at(e,"applewebkit")}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,dr],search:function(e){return at(e,"chrome")&&!at(e,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(e){return at(e,"msie")||at(e,"trident")}},{name:"Opera",versionRegexes:[dr,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:mr("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:mr("firefox")},{name:"Safari",versionRegexes:[dr,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(e){return(at(e,"safari")||at(e,"mobile/"))&&at(e,"applewebkit")}}],pr=[{name:"Windows",search:mr("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(e){return at(e,"iphone")||at(e,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:mr("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:mr("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:mr("linux"),versionRegexes:[]},{name:"Solaris",search:mr("sunos"),versionRegexes:[]},{name:"FreeBSD",search:mr("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:mr("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],hr={browsers:q(gr),oses:q(pr)},vr=function(e){var t=e.current,n=e.version,e=function(e){return function(){return t===e}};return{current:t,version:n,isEdge:e("Edge"),isChrome:e("Chrome"),isIE:e("IE"),isOpera:e("Opera"),isFirefox:e("Firefox"),isSafari:e("Safari")}},br={unknown:function(){return vr({current:void 0,version:cr.unknown()})},nu:vr,edge:q("Edge"),chrome:q("Chrome"),ie:q("IE"),opera:q("Opera"),firefox:q("Firefox"),safari:q("Safari")},yr=function(e){var t=e.current,n=e.version,e=function(e){return function(){return t===e}};return{current:t,version:n,isWindows:e("Windows"),isiOS:e("iOS"),isAndroid:e("Android"),isOSX:e("OSX"),isLinux:e("Linux"),isSolaris:e("Solaris"),isFreeBSD:e("FreeBSD"),isChromeOS:e("ChromeOS")}},xr={unknown:function(){return yr({current:void 0,version:cr.unknown()})},nu:yr,windows:q("Windows"),ios:q("iOS"),android:q("Android"),linux:q("Linux"),osx:q("OSX"),solaris:q("Solaris"),freebsd:q("FreeBSD"),chromeos:q("ChromeOS")},wr=function(e,t){var n,o,r=hr.browsers(),i=hr.oses(),u=sr(r,e).fold(br.unknown,br.nu),a=lr(i,e).fold(xr.unknown,xr.nu);return{browser:u,os:a,deviceType:(n=u,o=e,r=t,u=(i=a).isiOS()&&!0===/ipad/i.test(o),e=i.isiOS()&&!u,t=i.isiOS()||i.isAndroid(),a=t||r("(pointer:coarse)"),r=u||!e&&t&&r("(min-device-width:768px)"),t=e||t&&!r,n=n.isSafari()&&i.isiOS()&&!1===/safari/i.test(o),o=!t&&!r&&!n,{isiPad:q(u),isiPhone:q(e),isTablet:q(r),isPhone:q(t),isTouch:q(a),isAndroid:i.isAndroid,isiOS:i.isiOS,isWebView:q(n),isDesktop:q(o)})}},Cr=ve(function(){return wr(navigator.userAgent,st)}),Sr=function(e,t,n){var o=t(e),r=pt(n);return o.orThunk(function(){return r(e)?G.none():ht(e,t,r)})},kr=q,Or=kr("touchstart"),_r=kr("touchmove"),Er=kr("touchend"),Tr=kr("touchcancel"),Dr=kr("mousedown"),Ar=kr("mousemove"),Br=kr("mouseout"),Nr=kr("mouseup"),Rr=kr("mouseover"),Mr=kr("focusin"),Ir=kr("focusout"),Fr=kr("keydown"),Pr=kr("keyup"),Lr=kr("input"),Vr=kr("change"),Hr=kr("click"),zr=kr("transitionend"),jr=kr("selectstart"),Ur=function(e){return q("alloy."+e)},Wr={tap:Ur("tap")},qr=Ur("focus"),Gr=Ur("blur.post"),$r=Ur("paste.post"),Xr=Ur("receive"),Yr=Ur("execute"),Kr=Ur("focus.item"),Jr=Wr.tap,Qr=Ur("longpress"),Zr=Ur("sandbox.close"),ei=Ur("typeahead.cancel"),ti=Ur("system.init"),ni=Ur("system.touchmove"),oi=Ur("system.touchend"),ri=Ur("system.scroll"),ii=Ur("system.resize"),ui=Ur("system.attached"),ai=Ur("system.detached"),ci=Ur("system.dismissRequested"),si=Ur("system.repositionRequested"),li=Ur("focusmanager.shifted"),fi=Ur("slotcontainer.visibility"),di=Ur("change.tab"),mi=Ur("dismiss.tab"),gi=Ur("highlight"),pi=Ur("dehighlight"),hi=function(e,t,n,o){o=A({target:t},o);e.getSystem().triggerEvent(n,t,o)},vi=we,bi=Dt(ui()),yi=Dt(ai()),xi=Dt(ti()),wi=(eo=Yr(),function(e){return Et(eo,e)}),Ci=("undefined"!=typeof window||Function("return this;")(),function(t){return function(e){return e.dom.nodeType===t}}),Si=Ci(1),ki=Ci(3),Oi=Ci(9),_i=Ci(11),Ei=Vt,Ti=function(e,t){e.dom.appendChild(t.dom)},Di=function(e){e=e.dom;null!==e.parentNode&&e.parentNode.removeChild(e)},Ai=vi([{key:qr(),value:bt({can:function(e,t){var n=t.event,o=n.originator,r=n.target;return t=r,!(dt(n=o,e.element)&&!dt(n,t))||(console.warn(qr()+" did not get interpreted by the desired target. \nOriginator: "+rn(o)+"\nTarget: "+rn(r)+"\nCheck the "+qr()+" event handlers"),!1)}})}]),Bi=Object.freeze({__proto__:null,events:Ai}),Ni=0,Ri=q("alloy-id-"),Mi=q("data-alloy-id"),Ii=Ri(),Fi=Mi(),Pi=function(e,t){Object.defineProperty(e.dom,Fi,{value:t,writable:!0})},Li=function(e){e=Si(e)?e.dom[Fi]:null;return G.from(e)},Vi=un,Hi=l,zi=an(),ji=function(e){return S(e,function(e){return ct(e,"/*")?e.substring(0,e.length-"/*".length):e})},Ui=un("alloy-premade"),Wi={init:function(){return qi({readState:function(){return"No State required"}})}},qi=function(e){return e},Gi=function(e,t){return{cHandler:m.apply(void 0,[e.handler].concat(t)),purpose:e.purpose}},$i=function(e,r){e=po(e,function(n,o){return(1===n.length?ce.value(n[0].handler):bn(n,r,o)).map(function(e){var t=vn(e),e=1<n.length?C(r[o],function(t){return b(n,function(e){return e.name===t})}).join(" > "):n[0].name;return To(o,{handler:t,purpose:e})})});return Ce(e,{})},Xi="alloy.base.behaviour",Yi=J(Element.prototype.attachShadow)&&J(Node.prototype.getRootNode),Ki=q(Yi),Ji=Yi?function(e){return ir.fromDom(e.dom.getRootNode())}:Ft,Qi=function(e){e=Ji(e);return Bn(e)?G.some(e):G.none()},Zi=function(e){return s(e.dom.shadowRoot)},eu=function(e){var t=ki(e)?e.dom.parentNode:e.dom;if(null==t||null===t.ownerDocument)return!1;var n,o,r=t.ownerDocument;return Qi(ir.fromDom(t)).fold(function(){return r.body.contains(t)},(n=eu,o=Rn,function(e){return n(o(e))}))},tu=function(){return nu(ir.fromDom(document))},nu=function(e){e=e.dom.body;if(null==e)throw new Error("Body is not available yet");return ir.fromDom(e)},ou=function(e,t){return An(e)?e.style.getPropertyValue(t):""},ru=function(e){var t=Le("external.component",Ae([ze("element"),Xe("uid")]),e),n=it(an());t.uid.each(function(e){Pi(t.element,e)});var o={getSystem:n.get,config:G.none,hasConfigured:c,connect:function(e){n.set(e)},disconnect:function(){n.set(an(function(){return o}))},getApis:function(){return{}},element:t.element,spec:e,readState:q("No state"),syncComponents:W,components:q([]),events:{}};return sn(o)},iu=Vi,uu=function(t){return ho(t,Ui).fold(function(){var e=t.hasOwnProperty("uid")?t:A({uid:iu("")},t);return Jn(e).getOrDie()},function(e){return e})},au=sn;function cu(n,o){function e(e){var t=o(e);if(t<=0||null===t){e=Vn(e,n);return parseFloat(e)||0}return t}function r(n,e){return O(e,function(e,t){t=Vn(n,t),t=void 0===t?0:parseInt(t,10);return isNaN(t)?e:e+t},0)}return{set:function(e,t){if(!Q(t)&&!t.match(/^[0-9]+$/))throw new Error(n+".set accepts only positive integer values. Value was "+t);e=e.dom;An(e)&&(e.style[n]=t+"px")},get:e,getOuter:e,aggregate:r,max:function(e,t,n){n=r(e,n);return n<t?t-n:0}}}function su(e){return _u.get(e)}function lu(e){return _u.getOuter(e)}function fu(e,t){return void 0!==e?e:void 0!==t?t:0}function du(e){var t=(i=e.dom.ownerDocument).body,n=i.defaultView,o=i.documentElement;if(t===e.dom)return Tu(t.offsetLeft,t.offsetTop);var r=fu(null==n?void 0:n.pageYOffset,o.scrollTop),i=fu(null==n?void 0:n.pageXOffset,o.scrollLeft),n=fu(o.clientTop,t.clientTop),t=fu(o.clientLeft,t.clientLeft);return Du(e).translate(i-t,r-n)}function mu(e){return Au.get(e)}function gu(e){return Au.getOuter(e)}function pu(e){function t(){return e.stopPropagation()}function n(){return e.preventDefault()}var o=ir.fromDom(function(e){if(Ki()&&s(e.target)){var t=ir.fromDom(e.target);if(Si(t)&&Zi(t)&&e.composed&&e.composedPath){t=e.composedPath();if(t)return re(t)}}return G.from(e.target)}(e).getOr(e.target)),r=i(n,t);return{target:o,x:e.clientX,y:e.clientY,stop:t,prevent:n,kill:r,raw:e}}function hu(e,t,n,o,r){var i,u,o=(i=n,u=o,function(e){i(e)&&u(pu(e))});return e.dom.addEventListener(t,o,r),{unbind:m(Bu,e,t,o,r)}}function vu(e){var e=(t=void 0!==e?e.dom:document).body.scrollLeft||t.documentElement.scrollLeft,t=t.body.scrollTop||t.documentElement.scrollTop;return Tu(e,t)}function bu(e,t,n){(n=(void 0!==n?n.dom:document).defaultView)&&n.scrollTo(e,t)}function yu(e,t,n,o){return{x:e,y:t,width:n,height:o,right:e+n,bottom:t+o}}function xu(e){var n=void 0===e?window:e,e=n.document,o=vu(ir.fromDom(e));return function(e){e=void 0===e?window:e;return G.from(e.visualViewport)}(n).fold(function(){var e=n.document.documentElement,t=e.clientWidth,e=e.clientHeight;return yu(o.left,o.top,t,e)},function(e){return yu(Math.max(e.pageLeft,o.left),Math.max(e.pageTop,o.top),e.width,e.height)})}function wu(n){var e=ir.fromDom(document),o=vu(e);return function(e,t){e=t.owner(e),e=Nu(t,e);return G.some(e)}(n,Ru).fold(m(du,n),function(e){var t=Du(n),e=k(e,function(e,t){t=Du(t);return{left:e.left+t.left,top:e.top+t.top}},{left:0,top:0});return Tu(e.left+t.left+o.left,e.top+t.top+o.top)})}function Cu(e,t,n,o){return{x:e,y:t,width:n,height:o,right:e+n,bottom:t+o}}function Su(e){var t=du(e),n=gu(e),e=lu(e);return Cu(t.left,t.top,n,e)}function ku(e){var t=wu(e),n=gu(e),e=lu(e);return Cu(t.left,t.top,n,e)}function Ou(){return xu(window)}var _u=cu("height",function(e){var t=e.dom;return eu(e)?t.getBoundingClientRect().height:t.offsetHeight}),Eu=function(n,o){return{left:n,top:o,translate:function(e,t){return Eu(n+e,o+t)}}},Tu=Eu,Du=function(e){var t=e.dom,n=t.ownerDocument.body;return n===t?Tu(n.offsetLeft,n.offsetTop):eu(e)?function(e){e=e.getBoundingClientRect();return Tu(e.left,e.top)}(t):Tu(0,0)},Au=cu("width",function(e){return e.dom.offsetWidth}),Bu=function(e,t,n,o){e.dom.removeEventListener(t,n,o)},Nu=function(n,e){return n.view(e).fold(q([]),function(e){var t=n.owner(e),t=Nu(n,t);return[e].concat(t)})},Ru=Object.freeze({__proto__:null,view:function(e){return(e.dom===document?G.none():G.from(null===(e=e.dom.defaultView)||void 0===e?void 0:e.frameElement)).map(ir.fromDom)},owner:It});function Mu(e,t,n,o,r){return e(n,o)?G.some(n):J(r)&&r(n)?G.none():t(n,o,r)}function Iu(e,t,n){for(var o=e.dom,r=J(n)?n:c;o.parentNode;){var o=o.parentNode,i=ir.fromDom(o);if(t(i))return G.some(i);if(r(i))break}return G.none()}function Fu(e,t,n){return Mu(function(e,t){return t(e)},Iu,e,t,n)}function Pu(e,t,n){return Fu(e,t,n).isSome()}function Lu(e,t,n){return Iu(e,function(e){return lt(e,t)},n)}function Vu(e,t){return function(e,t){t=void 0===t?document:t.dom;return ft(t)?G.none():G.from(t.querySelector(e)).map(ir.fromDom)}(t,e)}function Hu(e,t,n){return Mu(lt,Lu,e,t,n)}function zu(){var t=un("aria-owns");return{id:t,link:function(e){Qt(e,"aria-owns",t)},unlink:function(e){nn(e,"aria-owns")}}}function ju(t,e){return Fu(e,function(e){if(!Si(e))return!1;e=Zt(e,"id");return void 0!==e&&-1<e.indexOf("aria-owns")}).bind(function(e){var t=Zt(e,"id"),e=Ji(e);return Vu(e,'[aria-owns="'+t+'"]')}).exists(function(e){return Wu(t,e)})}var Uu,Wu=function(t,e){return Pu(e,function(e){return dt(e,t.element)},c)||ju(t,e)};(xl=Uu=Uu||{})[xl.STOP=0]="STOP",xl[xl.NORMAL=1]="NORMAL",xl[xl.LOGGING=2]="LOGGING";function qu(t,e,n){var o,r,i,u;switch(ho(za.get(),t).orThunk(function(){var e=lo(za.get());return P(e,function(e){return-1<t.indexOf(e)?G.some(za.get()[e]):G.none()})}).getOr(Uu.NORMAL)){case Uu.NORMAL:return n(Ua());case Uu.LOGGING:var a=(o=t,r=e,i=[],u=(new Date).getTime(),{logEventCut:function(e,t,n){i.push({outcome:"cut",target:t,purpose:n})},logEventStopped:function(e,t,n){i.push({outcome:"stopped",target:t,purpose:n})},logNoParent:function(e,t,n){i.push({outcome:"no-parent",target:t,purpose:n})},logEventNoHandlers:function(e,t){i.push({outcome:"no-handlers-left",target:t})},logEventResponse:function(e,t,n){i.push({outcome:"response",purpose:n,target:t})},write:function(){var e=(new Date).getTime();ne(["mousemove","mouseover","mouseout",ti()],o)||console.log(o,{event:o,time:e-u,target:r.dom,sequence:S(i,function(e){return ne(["cut","stopped","response"],e.outcome)?"{"+e.purpose+"} "+e.outcome+" at ("+rn(e.target)+")":e.outcome})})}}),c=n(a);return a.write(),c;case Uu.STOP:return!0}}function Gu(e,t,n){return function(){var e=new Error;if(void 0===e.stack)return;e=e.stack.split("\n");_(e,function(t){return 0<t.indexOf("alloy")&&!b(ja,function(e){return-1<t.indexOf(e)})}).getOr("unknown")}(),Po(t,t,n,Ie(function(n){return ce.value(function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return n.apply(void 0,e)})}))}function $u(e,t){return rt(e,q(t))}function Xu(e){return rt(e,l)}function Yu(e,t,n,o,r,i){return{x:e,y:t,bubble:n,direction:o,boundsRestriction:r,label:i}}function Ku(t,n){return function(e,t){for(var n={},o=0,r=e.length;o<r;o++){var i=e[o];n[String(i)]=t(i,o)}return n}(["left","right","top","bottom"],function(e){return ho(n,e).map(function(e){return function(e,t){switch(t){case 1:return e.x;case 0:return e.x+e.width;case 2:return e.y;case 3:return e.y+e.height}}(t,e)})})}function Ju(e,r,i){function t(t,n){var o="top"===t||"bottom"===t?i.top:i.left;return ho(r,t).bind(l).bind(function(e){return"left"===t||"top"===t?n<=e?G.some(e):G.none():e<=n?G.some(e):G.none()}).map(function(e){return e+o}).getOr(n)}var n=t("left",e.x),o=t("top",e.y),u=t("right",e.right),e=t("bottom",e.bottom);return Cu(n,o,u-n,e-o)}function Qu(e,t){return e.x+e.width/2-t.width/2}function Zu(e,t){return e.x+e.width-t.width}function ea(e,t){return e.y-t.height}function ta(e){return e.y+e.height}function na(e,t){return e.y+e.height/2-t.height/2}function oa(e,t,n){return Yu(e.x,ta(e),n.southeast(),nc(),Ku(e,{left:1,top:3}),"layout-se")}function ra(e,t,n){return Yu(Zu(e,t),ta(e),n.southwest(),oc(),Ku(e,{right:0,top:3}),"layout-sw")}function ia(e,t,n){return Yu(e.x,ea(e,t),n.northeast(),rc(),Ku(e,{left:1,bottom:2}),"layout-ne")}function ua(e,t,n){return Yu(Zu(e,t),ea(e,t),n.northwest(),ic(),Ku(e,{right:0,bottom:2}),"layout-nw")}function aa(e,t,n){return Yu(e.x+e.width,na(e,t),n.east(),cc(),Ku(e,{left:0}),"layout-e")}function ca(e,t,n){return Yu(e.x-t.width,na(e,t),n.west(),sc(),Ku(e,{right:1}),"layout-w")}function sa(){return[oa,ra,ia,ua,fc,lc,aa,ca]}function la(){return[ra,oa,ua,ia,fc,lc,aa,ca]}function fa(){return[ia,ua,oa,ra,lc,fc]}function da(){return[ua,ia,ra,oa,lc,fc]}function ma(){return[oa,ra,ia,ua,fc,lc]}function ga(){return[ra,oa,ua,ia,fc,lc]}function pa(n,o,r){return xi(function(e,t){r(e,n,o)})}function ha(e,t,n,o,r,i){var u=Ae(e),e=Qe(t,[Ye("config",Ae(e))]);return mc(u,e,t,n,o,r,i)}function va(r,i,u){var e,t,n,o,a,c;return e=function(n){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];var o=[n].concat(e);return n.config({name:q(r)}).fold(function(){throw new Error("We could not find any behaviour configuration for: "+r+". Using API: "+u)},function(e){var t=Array.prototype.slice.call(o,1);return i.apply(void 0,[n,e.config,e.state].concat(t))})},t=u,o=(n=i).toString(),a=o.indexOf(")")+1,n=o.indexOf("("),c=o.substring(n+1,a-1).split(/,\s*/),e.toFunctionAnnotation=function(){return{name:t,parameters:ji(c.slice(0,1).concat(c.slice(3)))}},e}function ba(e){return{key:e,value:void 0}}function ya(e){return e=Le("Creating behaviour: "+e.name,pc,e),ha(e.fields,e.name,e.active,e.apis,e.extra,e.state)}function xa(e){return e.dom.focus()}function wa(e){return void 0===e&&(e=ir.fromDom(document)),G.from(e.dom.activeElement).map(ir.fromDom)}function Ca(t){return wa(Ji(t)).filter(function(e){return t.dom.contains(e.dom)})}function Sa(e,n){var o=Ji(n),t=wa(o).bind(function(t){function e(e){return dt(t,e)}var o,r;return e(n)?G.some(n):(o=e,(r=function(e){for(var t=0;t<e.childNodes.length;t++){var n=ir.fromDom(e.childNodes[t]);if(o(n))return G.some(n);n=r(e.childNodes[t]);if(n.isSome())return n}return G.none()})(n.dom))}),e=e(n);return t.each(function(t){wa(o).filter(function(e){return dt(e,t)}).fold(function(){xa(t)},W)}),e}function ka(e,t,n,o,r){return{position:e,left:t,top:n,right:o,bottom:r}}function Oa(e,t){function n(e){return e+"px"}Ln(e,{position:G.some(t.position),left:t.left.map(n),top:t.top.map(n),right:t.right.map(n),bottom:t.bottom.map(n)})}function _a(e,t,n,o,r,i){var u=t.x-n,a=t.y-o,c=r-(u+t.width),s=i-(a+t.height),l=G.some(u),f=G.some(a),d=G.some(c),m=G.some(s),g=G.none();return n=t.direction,o=function(){return ka(e,l,f,g,g)},r=function(){return ka(e,g,f,d,g)},i=function(){return ka(e,l,g,g,m)},u=function(){return ka(e,g,g,d,m)},a=function(){return ka(e,l,f,g,g)},c=function(){return ka(e,l,g,g,m)},s=function(){return ka(e,l,f,g,g)},t=function(){return ka(e,g,f,d,g)},n.fold(o,r,i,u,a,c,s,t)}function Ea(e,t){var n=m(wu,t),o=e.fold(n,n,function(){var e=vu();return wu(t).translate(-e.left,-e.top)}),e=gu(t),n=lu(t);return Cu(o.left,o.top,e,n)}function Ta(e,t,n,o){return o<(t=e+t)?n:t<n?o:t}function Da(e,t,n){return Math.min(Math.max(e,t),n)}function Aa(e,t,n,o){var r,i=e.x,u=e.y,a=(h=e.bubble.offset).left,c=h.top,s=Ju(o,e.boundsRestriction,h),l=s.y,f=s.bottom,d=s.x,m=s.right,g=(v=(r=i+a,g=b=u+c,v=t,p=n,h=(o=s).x,u=o.y,c=o.width,i=o.height,a=u<=g,n=(t=h<=r)&&a,s=r+v<=h+c&&g+p<=u+i,h=Math.abs(Math.min(v,t?h+c-r:h-(r+v))),u=Math.abs(Math.min(p,a?u+i-g:u-(g+p))),v=Math.max(o.x,o.right-v),p=Math.max(o.y,o.bottom-p),{originInBounds:n,sizeInBounds:s,limitX:Da(r,o.x,v),limitY:Da(g,o.y,p),deltaW:h,deltaH:u})).originInBounds,o=v.sizeInBounds,p=v.limitX,h=v.limitY,u=v.deltaW,v=v.deltaH,l=q(h+v-l),f=q(f-h),f=e.direction.fold(f,f,l,l,f,l,f,f),d=q(p+u-d),m=q(m-p),b={x:p,y:h,width:u,height:v,maxHeight:f,maxWidth:e.direction.fold(m,d,m,d,m,m,m,d),direction:e.direction,classes:{on:e.bubble.classesOn,off:e.bubble.classesOff},label:e.label,candidateYforTest:b};return g&&o?Sc.fit(b):Sc.nofit(b,u,v)}function Ba(e,t,n,u,a){function o(e,o,r,i){return e=e(t,n,u),Aa(e,c,s,a).fold(Sc.fit,function(e,t,n){return i<n||r<t?Sc.nofit(e,t,n):Sc.nofit(o,r,i)})}var c=n.width,s=n.height;return O(e,function(e,t){t=m(o,t);return e.fold(Sc.fit,t)},Sc.nofit({x:t.x,y:t.y,width:n.width,height:n.height,maxHeight:n.height,maxWidth:n.width,direction:nc(),classes:{on:[],off:[]},label:"none",candidateYforTest:t.y},-1,-1)).fold(l,l)}function Na(e,t,n,o){return jn(t,"max-height"),jn(t,"max-width"),t={width:gu(t=t),height:lu(t)},Ba(o.preference,e,t,n,o.bounds)}function Ra(e,t,n){var r;Oa(e,(n=n.origin,r=t,n.fold(function(){return ka("absolute",G.some(r.x),G.some(r.y),G.none(),G.none())},function(e,t,n,o){return _a("absolute",r,e,t,n,o)},function(e,t,n,o){return _a("fixed",r,e,t,n,o)})))}function Ma(e,t){!function(e,t){t=_u.max(e,t,["margin-top","border-top-width","padding-top","padding-bottom","border-bottom-width","margin-bottom"]);Fn(e,"max-height",t+"px")}(e,Math.floor(t))}function Ia(e,t,n){return void 0===e[t]?n:e[t]}function Fa(e,t,n,o,r,i){var u,a=Ia(i,"maxHeightFunction",kc()),c=Ia(i,"maxWidthFunction",W),i=e.anchorBox,e=e.origin,c={bounds:(u=e,r.fold(function(){return u.fold(Ou,Ou,Cu)},function(n){return u.fold(n,n,function(){var e=n(),t=xc(u,e.x,e.y);return Cu(t.left,t.top,e.width,e.height)})})),origin:e,preference:o,maxHeightFunction:a,maxWidthFunction:c};_c(i,t,n,c)}function Pa(e,t,n){function r(e){return ho(n,e).getOr([])}function o(e,t,n){var o=R(Ec,n);return{offset:Tu(e,t),classesOn:T(n,r),classesOff:T(o,r)}}return{southeast:function(){return o(-e,t,["top","alignLeft"])},southwest:function(){return o(e,t,["top","alignRight"])},south:function(){return o(-e/2,t,["top","alignCentre"])},northeast:function(){return o(-e,-t,["bottom","alignLeft"])},northwest:function(){return o(e,-t,["bottom","alignRight"])},north:function(){return o(-e/2,-t,["bottom","alignCentre"])},east:function(){return o(e,-t/2,["valignCentre","left"])},west:function(){return o(-e,-t/2,["valignCentre","right"])},innerNorthwest:function(){return o(-e,t,["top","alignRight"])},innerNortheast:function(){return o(e,t,["top","alignLeft"])},innerNorth:function(){return o(-e/2,t,["top","alignCentre"])},innerSouthwest:function(){return o(-e,-t,["bottom","alignRight"])},innerSoutheast:function(){return o(e,-t,["bottom","alignLeft"])},innerSouth:function(){return o(-e/2,-t,["bottom","alignCentre"])},innerWest:function(){return o(e,-t/2,["valignCentre","right"])},innerEast:function(){return o(-e,-t/2,["valignCentre","left"])}}}function La(){return Pa(0,0,{})}function Va(t,n){return function(e){return"rtl"===Tc(e)?n:t}}var Ha,za=it({}),ja=["alloy/data/Fields","alloy/debugging/Debugging"],Ua=q({logEventCut:W,logEventStopped:W,logNoParent:W,logEventNoHandlers:W,logEventResponse:W,write:W}),Wa=q([ze("menu"),ze("selectedMenu")]),qa=q([ze("item"),ze("selectedItem")]),Ga=(q(No(qa().concat(Wa()))),q(No(qa()))),$a=qe("initSize",[ze("numColumns"),ze("numRows")]),Xa=function(){return qe("markers",[ze("backgroundMenu")].concat(Wa()).concat(qa()))},Ya=function(e){return qe("markers",S(e,ze))},Ka=function(e){return Gu(0,e,be(W))},Ja=function(e){return Gu(0,e,be(G.none))},Qa=function(e){return Gu(0,e,ko())},Za=function(e){return Gu(0,e,ko())},ec=q($a),tc=bo([{southeast:[]},{southwest:[]},{northeast:[]},{northwest:[]},{south:[]},{north:[]},{east:[]},{west:[]}]),nc=tc.southeast,oc=tc.southwest,rc=tc.northeast,ic=tc.northwest,uc=tc.south,ac=tc.north,cc=tc.east,sc=tc.west,lc=function(e,t,n){return Yu(Qu(e,t),ea(e,t),n.north(),ac(),Ku(e,{bottom:2}),"layout-n")},fc=function(e,t,n){return Yu(Qu(e,t),ta(e),n.south(),uc(),Ku(e,{top:3}),"layout-s")},dc=Object.freeze({__proto__:null,events:function(u){return vi([Et(Xr(),function(o,e){var t,r=u.channels,n=lo(r),i=e,n=(n=n,(t=i).universal?n:C(n,function(e){return ne(t.channels,e)}));oe(n,function(e){var t=r[e],n=t.schema,n=Le("channel["+e+"] data\nReceiver: "+rn(o.element),n,i.data);t.onReceive(o,n)})})])}}),t=[je("channels",zo(ce.value,Ae([Qa("onReceive"),Ze("schema",Wo())])))],mc=function(n,e,o,r,t,i,u){function a(e){return he(e,o)?e[o]():G.none()}var t=de(t,function(e,t){return va(o,e,t)}),i=de(i,cn),c=A(A(A({},i),t),{revoke:m(ba,o),config:function(e){var t=Le(o+"-config",n,e);return{key:o,value:{config:t,me:c,configAsRaw:ve(function(){return Le(o+"-config",n,e)}),initialConfig:e,state:u}}},schema:function(){return e},exhibit:function(e,n){return a(e).bind(function(t){return ho(r,"exhibit").map(function(e){return e(n,t.config,t.state)})}).getOr(dn({}))},name:function(){return o},handlers:function(e){return a(e).map(function(e){return ho(r,"events").getOr(function(){return{}})(e.config,e.state)}).getOr({})}});return c},gc=we,pc=Ae([ze("fields"),ze("name"),Ze("active",{}),Ze("apis",{}),Ze("state",Wi),Ze("extra",{})]),hc=Ae([ze("branchKey"),ze("branches"),ze("name"),Ze("active",{}),Ze("apis",{}),Ze("state",Wi),Ze("extra",{})]),z=function(e){var t,n,o,r,i,u=Le("Creating behaviour: "+e.name,hc,e);return t=Ve(u.branchKey,u.branches),n=u.name,o=u.active,r=u.apis,i=u.extra,e=u.state,t=Qe(n,[Ye("config",u=t)]),mc(u,t,n,o,r,i,e)},vc=q(void 0),bc=ya({fields:t,name:"receiving",active:dc}),j=Object.freeze({__proto__:null,exhibit:function(e,t){return dn({classes:[],styles:t.useFixed()?{}:{position:"relative"}})}}),yc=bo([{none:[]},{relative:["x","y","width","height"]},{fixed:["x","y","width","height"]}]),xc=function(e,t,n){var o=Tu(t,n);return e.fold(q(o),q(o),function(){var e=vu();return o.translate(-e.left,-e.top)})},wc=(yc.none,yc.relative),Cc=yc.fixed,Sc=bo([{fit:["reposition"]},{nofit:["reposition","deltaW","deltaH"]}]),kc=q(function(e,t){Ma(e,t),Pn(e,{"overflow-x":"hidden","overflow-y":"auto"})}),Oc=q(function(e,t){Ma(e,t)}),_c=function(e,t,n,o){n=Na(e,t,n,o);Ra(t,n,o),function(e,t){t=t.classes;Dn(e,t.off),Tn(e,t.on)}(t,n),(0,o.maxHeightFunction)(t,n.maxHeight),(0,o.maxWidthFunction)(t,n.maxWidth)},Ec=["valignCentre","alignLeft","alignRight","alignCentre","top","bottom","left","right"],Tc=function(e){return"rtl"===Vn(e,"direction")?"rtl":"ltr"};(xo=Ha=Ha||{}).TopToBottom="toptobottom",xo.BottomToTop="bottomtotop";function Dc(e){return Pu(e,function(e){return Si(e)&&Zt(e,"data-alloy-vertical-dir")===Ha.BottomToTop})}function Ac(t,e,n,o,r,i,u){var a=u.map(Dc).getOr(!1),c=e.layouts.map(function(e){return e.onLtr(t)}),u=e.layouts.map(function(e){return e.onRtl(t)}),n=a?e.layouts.bind(function(e){return e.onBottomLtr.map(function(e){return e(t)})}).or(c).getOr(r):c.getOr(n),o=a?e.layouts.bind(function(e){return e.onBottomRtl.map(function(e){return e(t)})}).or(u).getOr(i):u.getOr(o);return Va(n,o)(t)}function Bc(e,t,n){var o,r,e=e.document.createRange();return o=e,t.fold(function(e){o.setStartBefore(e.dom)},function(e,t){o.setStart(e.dom,t)},function(e){o.setStartAfter(e.dom)}),r=e,n.fold(function(e){r.setEndBefore(e.dom)},function(e,t){r.setEnd(e.dom,t)},function(e){r.setEndAfter(e.dom)}),e}function Nc(e,t,n,o,r){return(e=e.document.createRange()).setStart(t.dom,n),e.setEnd(o.dom,r),e}function Rc(e){return{left:e.left,top:e.top,right:e.right,bottom:e.bottom,width:e.width,height:e.height}}function Mc(e,t,n){return t(ir.fromDom(n.startContainer),n.startOffset,ir.fromDom(n.endContainer),n.endOffset)}function Ic(e,t){var r,n,t=(r=e,t.match({domRange:function(e){return{ltr:q(e),rtl:G.none}},relative:function(e,t){return{ltr:ve(function(){return Bc(r,e,t)}),rtl:ve(function(){return G.some(Bc(r,t,e))})}},exact:function(e,t,n,o){return{ltr:ve(function(){return Nc(r,e,t,n,o)}),rtl:ve(function(){return G.some(Nc(r,n,o,e,t))})}}}));return(n=(t=t).ltr()).collapsed?t.rtl().filter(function(e){return!1===e.collapsed}).map(function(e){return zc.rtl(ir.fromDom(e.endContainer),e.endOffset,ir.fromDom(e.startContainer),e.startOffset)}).getOrThunk(function(){return Mc(0,zc.ltr,n)}):Mc(0,zc.ltr,n)}var Fc="data-alloy-vertical-dir",qo=function(){return Qe("layouts",[ze("onLtr"),ze("onRtl"),Xe("onBottomLtr"),Xe("onBottomRtl")])},dr=[ze("hotspot"),Xe("bubble"),Ze("overrides",{}),qo(),$u("placement",function(e,t,n){var o=t.hotspot,o=Ea(n,o.element),e=Ac(e.element,t,ma(),ga(),fa(),da(),G.some(t.hotspot.element));return G.some({anchorBox:o,bubble:t.bubble.getOr(La()),overrides:t.overrides,layouts:e,placer:G.none()})})],mr=[ze("x"),ze("y"),Ze("height",0),Ze("width",0),Ze("bubble",La()),Ze("overrides",{}),qo(),$u("placement",function(e,t,n){n=xc(n,t.x,t.y),n=Cu(n.left,n.top,t.width,t.height),e=Ac(e.element,t,sa(),la(),sa(),la(),G.none());return G.some({anchorBox:n,bubble:t.bubble,overrides:t.overrides,layouts:e,placer:G.none()})})],Pc=function(e,t,n,o){return{start:e,soffset:t,finish:n,foffset:o}},gr=bo([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),Lc=(gr.before,gr.on,gr.after,function(e){return e.fold(l,l,l)}),Vc=bo([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),Hc={domRange:Vc.domRange,relative:Vc.relative,exact:Vc.exact,exactFromRange:function(e){return Vc.exact(e.start,e.soffset,e.finish,e.foffset)},getWin:function(e){e=e.match({domRange:function(e){return ir.fromDom(e.startContainer)},relative:function(e,t){return Lc(e)},exact:function(e,t,n,o){return e}});return Lt(e)},range:Pc},zc=bo([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]);zc.ltr,zc.rtl;function jc(e){return il.getOption(e)}function Uc(e){return jc(e).filter(function(e){return 0!==e.trim().length||-1<e.indexOf(" ")}).isSome()||ne(ul,Mt(e))}function Wc(e,t){return function(e,t){t=void 0===t?document:t.dom;return ft(t)?[]:S(t.querySelectorAll(e),ir.fromDom)}(t,e)}function qc(e,t,n,o){var r,i,u,a,c=(i=t,u=n,a=o,(c=It(r=e).dom.createRange()).setStart(r.dom,i),c.setEnd(u.dom,a),c),o=dt(e,n)&&t===o;return c.collapsed&&!o}function Gc(e){if(0<e.rangeCount){var t=e.getRangeAt(0),e=e.getRangeAt(e.rangeCount-1);return G.some(Pc(ir.fromDom(t.startContainer),t.startOffset,ir.fromDom(e.endContainer),e.endOffset))}return G.none()}function $c(e){if(null===e.anchorNode||null===e.focusNode)return Gc(e);var t=ir.fromDom(e.anchorNode),n=ir.fromDom(e.focusNode);return qc(t,e.anchorOffset,n,e.focusOffset)?G.some(Pc(t,e.anchorOffset,n,e.focusOffset)):Gc(e)}function Xc(e){return G.from(e.getSelection()).filter(function(e){return 0<e.rangeCount}).bind($c)}function Yc(e,t){var i,e=Ic(i=e,t).match({ltr:function(e,t,n,o){var r=i.document.createRange();return r.setStart(e.dom,t),r.setEnd(n.dom,o),r},rtl:function(e,t,n,o){var r=i.document.createRange();return r.setStart(n.dom,o),r.setEnd(e.dom,t),r}});return 0<(t=0<(e=(t=e).getClientRects()).length?e[0]:t.getBoundingClientRect()).width||0<t.height?G.some(t).map(Rc):G.none()}function Kc(e,t){return{element:e,offset:t}}function Jc(e,t){var n=zt(e);return 0===n.length?Kc(e,t):t<n.length?Kc(n[t],0):(t=n[n.length-1],n=ki(t)?il.get(t).length:zt(t).length,Kc(t,n))}function Qc(e){return e.fold(l,function(e,t,n){return e.translate(-t,-n)})}function Zc(e){return e.fold(l,l)}function es(e){return O(e,function(e,t){return e.translate(t.left,t.top)},Tu(0,0))}function ts(e){return e=S(e,Zc),es(e)}function ns(e,t,n){var o=It(e.element),o=vu(o),n=function(n,e){e=Lt(e.root).dom;return G.from(e.frameElement).map(ir.fromDom).filter(function(e){var t=It(e),e=It(n.element);return dt(t,e)}).map(du)}(e,n).getOr(o);return sl(n,o.left,o.top)}function os(e,t,n,o){var r=e,i=t,u=n,a=o;return e<0&&(r=0,u=n+e),t<0&&(i=0,a=o+t),i=cl(Tu(r,i)),G.some({point:i,width:u,height:a})}function rs(e,i,u,a,c){return e.map(function(e){var t,n=[i,e.point],o=(t=function(){return ts(n)},o=function(){return ts(n)},r=function(){return function(e){e=S(e,Qc);return es(e)}(n)},a.fold(t,o,r)),r={x:o.left,y:o.top,width:e.width,height:e.height},o=(u.showAbove?fa:ma)(),e=(u.showAbove?da:ga)(),e=Ac(c,u,o,e,o,e,G.none());return{anchorBox:r,bubble:u.bubble.getOr(La()),overrides:u.overrides,layouts:e,placer:G.none()}})}function is(e,t){return(ki(e)?Kc:Jc)(e,t)}function us(e,t){return t.getSelection.getOrThunk(function(){return function(){return Xc(e)}})().map(function(e){var t=is(e.start,e.soffset),e=is(e.finish,e.foffset);return Hc.range(t.element,t.offset,e.element,e.offset)})}function as(e){return e.x+e.width}function cs(e,t){return e.x-t.width}function ss(e,t){return e.y-t.height+e.height}function ls(e,t,n){return Yu(as(e),e.y,n.southeast(),nc(),Ku(e,{left:0,top:2}),"link-layout-se")}function fs(e,t,n){return Yu(cs(e,t),e.y,n.southwest(),oc(),Ku(e,{right:1,top:2}),"link-layout-sw")}function ds(e,t,n){return Yu(as(e),ss(e,t),n.northeast(),rc(),Ku(e,{left:0,bottom:3}),"link-layout-ne")}function ms(e,t,n){return Yu(cs(e,t),ss(e,t),n.northwest(),ic(),Ku(e,{right:1,bottom:3}),"link-layout-nw")}function gs(){return[ls,fs,ds,ms]}function ps(){return[fs,ls,ms,ds]}function hs(e,t,n,o,r){t={anchorBox:n.anchorBox,origin:t},Fa(t,r.element,n.bubble,n.layouts,o,n.overrides)}function vs(e,t){Ti(e.element,t.element)}function bs(t,e){var n,o=t.components();oe((n=t).components(),function(e){return Di(e.element)}),$t(n.element),n.syncComponents(),o=R(o,e),oe(o,function(e){gl(e),t.getSystem().removeFromWorld(e)}),oe(e,function(e){e.getSystem().isConnected()?vs(t,e):(t.getSystem().addToWorld(e),vs(t,e),eu(t.element)&&pl(e)),t.syncComponents()})}function ys(e,t){hl(e,t,Ti)}function xs(e){gl(e),Di(e.element),e.getSystem().removeFromWorld(e)}function ws(t){var e=Vt(t.element).bind(function(e){return t.getSystem().getByDom(e).toOptional()});xs(t),e.each(function(e){e.syncComponents()})}function Cs(e){var t=e.components();oe(t,xs),$t(e.element),e.syncComponents()}function Ss(e,t){vl(e,t,Ti)}function ks(t){var e=zt(t.element);oe(e,function(e){t.getByDom(e).each(gl)}),Di(t.element)}function Os(t,e,n,o){return n.get().each(function(e){Cs(t)}),e=e.getAttachPoint(t),ys(e,t),o=t.getSystem().build(o),ys(t,o),n.set(o),o}function _s(e,t,n,o){return o=Os(e,t,n,o),t.onOpen(e,o),o}function Es(t,n,o){o.get().each(function(e){Cs(t),ws(t),n.onClose(t,e),o.clear()})}function Ts(e){var n=Le("Dismissal",Ol,e);return(e={})[Cl()]={schema:Ae([ze("target")]),onReceive:function(t,e){wl.isOpen(t)&&(wl.isPartOf(t,e.target)||n.isExtraPart(t,e.target)||n.fireEventInstead.fold(function(){return wl.close(t)},function(e){return xt(t,e.event)}))}},e}function Ds(e){var n=Le("Reposition",_l,e);return(e={})[Sl()]={onReceive:function(t){wl.isOpen(t)&&n.fireEventInstead.fold(function(){return n.doReposition(t)},function(e){return xt(t,e.event)})}},e}function As(e,t,n){t.store.manager.onLoad(e,t,n)}function Bs(e,t,n){t.store.manager.onUnload(e,t,n)}function Ns(e,t,n,o){var r=t.store;n.update([o]),r.setValue(e,o),t.onSetValue(e,o)}function Rs(e,t){return A(A({},e.dump),gc(t))}function Ms(e){return vo(e,"uiType")}function Is(e,t,n,o){return Ms(n)&&n.uiType===Al?(i=n,u=o,(r=e).exists(function(e){return e!==i.owner})?Bl.single(!0,q(i)):ho(u,i.name).fold(function(){throw new Error("Unknown placeholder component: "+i.name+"\nKnown: ["+lo(u)+"]\nNamespace: "+r.getOr("none")+"\nSpec: "+JSON.stringify(i,null,2))},function(e){return e.replace()})):Bl.single(!1,q(n));var r,i,u}function Fs(t,n,e,o){var r,i,u,o=de(o,function(e,t){return o=e,r=!1,{name:q(n=t),required:function(){return o.fold(function(e,t){return e},function(e,t){return e})},used:function(){return r},replace:function(){if(r)throw new Error("Trying to use the same placeholder more than once: "+n);return r=!0,o}};var n,o,r}),e=(r=t,i=n,u=o,T(e,function(e){return Nl(r,i,e,u)}));return mo(o,function(e){if(!1===e.used()&&e.required())throw new Error("Placeholder: "+e.name()+" was not found in components list\nNamespace: "+t.getOr("none")+"\nComponents: "+JSON.stringify(n.components,null,2))}),e}function Ps(e){return e.fold(G.some,G.none,G.some,G.some)}function Ls(e){function t(e){return e.name}return e.fold(t,t,t,t)}function Vs(e,t,n,o){return wo(t.defaults(e,n,o),n,{uid:e.partUids[t.name]},t.overrides(e,n,o))}function Hs(r,e){var t={};return oe(e,function(e){Ps(e).each(function(n){var o=Vl(r,n.pname);t[n.name]=function(e){var t=Le("Part: "+n.name+" in "+r,No(n.schema),e);return A(A({},o),{config:e,validated:t})}})}),t}function zs(e,t,n){return{uiType:Il(),owner:e,name:t,config:n,validated:{}}}function js(e){return T(e,function(e){return e.fold(G.none,G.some,G.none,G.none).map(function(e){return qe(e.name,e.schema.concat([Xu(Ll())]))}).toArray()})}function Us(e){return S(e,Ls)}function Ws(e,t,n){return o=t,i={},r={},oe(n,function(e){e.fold(function(o){i[o.pname]=Rl(!0,function(e,t,n){return o.factory.sketch(Vs(e,o,t,n))})},function(e){var t=o.parts[e.name];r[e.name]=q(e.factory.sketch(Vs(o,e,t[Ll()]),t))},function(o){i[o.pname]=Rl(!1,function(e,t,n){return o.factory.sketch(Vs(e,o,t,n))})},function(r){i[r.pname]=Ml(!0,function(t,e,n){var o=t[r.name];return S(o,function(e){return r.factory.sketch(wo(r.defaults(t,e,n),e,r.overrides(t,e)))})})})}),{internals:q(i),externals:q(r)};var o,i,r}function qs(e,t,n){return Fs(G.some(e),t,t.components,n)}function Gs(e,t,n){return n=t.partUids[n],e.getSystem().getByUid(n).toOptional()}function $s(e,t,n){return Gs(e,t,n).getOrDie("Could not find part: "+n)}function Xs(e,t,n){var o={},r=t.partUids,i=e.getSystem();return oe(n,function(e){o[e]=q(i.getByUid(r[e]))}),o}function Ys(e,t){var n=e.getSystem();return de(t.partUids,function(e,t){return q(n.getByUid(e))})}function Ks(e){return lo(e.partUids)}function Js(e,t,n){var o={},r=t.partUids,i=e.getSystem();return oe(n,function(e){o[e]=q(i.getByUid(r[e]).getOrDie())}),o}function Qs(t,e){return e=Us(e),we(S(e,function(e){return{key:e,value:t+"-"+e}}))}function Zs(t){return Po("partUids","partUids",Eo(function(e){return Qs(e.uid,t)}),Wo())}function el(e,t,n,o,r){return r=r,r=(0<(o=o).length?[qe("parts",o)]:[]).concat([ze("uid"),Ze("dom",{}),Ze("components",[]),Xu("originalSpec"),Ze("debug.sketcher",{})]).concat(r),Le(e+" [SpecSchema]",Ae(r.concat(t)),n)}function tl(e,t,n,o,r){var i=Hl(r),u=js(n),r=Zs(n),r=el(e,t,i,u,[r]),n=Ws(0,r,n);return o(r,qs(e,r,n.internals()),i,n.externals())}var nl,ol,rl,il=(nl=ki,ol="text",{get:function(e){if(!nl(e))throw new Error("Can only get "+ol+" value of a "+ol+" node");return rl(e).getOr("")},getOption:rl=function(e){return nl(e)?G.from(e.dom.nodeValue):G.none()},set:function(e,t){if(!nl(e))throw new Error("Can only set raw "+ol+" value of a "+ol+" node");e.dom.nodeValue=t}}),ul=["img","br"],al=function(e,r){var i=function(e){for(var t=zt(e),n=t.length-1;0<=n;n--){var o=t[n];if(r(o))return G.some(o);o=i(o);if(o.isSome())return o}return G.none()};return i(e)},pr=bo([{screen:["point"]},{absolute:["point","scrollLeft","scrollTop"]}]),cl=pr.screen,sl=pr.absolute,kr=[Xe("getSelection"),ze("root"),Xe("bubble"),qo(),Ze("overrides",{}),Ze("showAbove",!1),$u("placement",function(e,t,n){var o=Lt(t.root).dom,r=ns(e,0,t),i=us(o,t).bind(function(e){return Yc(o,Hc.exactFromRange(e)).orThunk(function(){var t=ir.fromText("\ufeff");return Ut(e.start,t),Yc(o,Hc.exact(t,0,t,1)).map(function(e){return Di(t),e})}).bind(function(e){return os(e.left,e.top,e.width,e.height)})}),e=us(o,t).bind(function(e){return Si(e.start)?G.some(e.start):Ei(e.start)}).getOr(e.element);return rs(i,r,t,n,e)})],Wr=[ze("node"),ze("root"),Xe("bubble"),qo(),Ze("overrides",{}),Ze("showAbove",!1),$u("placement",function(n,o,r){var i=ns(n,0,o);return o.node.bind(function(e){var t=e.dom.getBoundingClientRect(),e=os(t.left,t.top,t.width,t.height),t=o.node.getOr(n.element);return rs(e,i,o,r,t)})})],Ur=[ze("item"),qo(),Ze("overrides",{}),$u("placement",function(e,t,n){n=Ea(n,t.item.element),e=Ac(e.element,t,gs(),ps(),gs(),ps(),G.none());return G.some({anchorBox:n,bubble:La(),overrides:t.overrides,layouts:e,placer:G.none()})})],ll=Ve("anchor",{selection:kr,node:Wr,hotspot:dr,submenu:Ur,makeshift:mr}),fl=function(e,t,n,o,r,i){i=i.map(Su);return dl(e,t,n,o,r,i)},dl=function(i,u,e,t,a,c){var s=Le("positioning anchor.info",ll,t);Sa(function(){Fn(a.element,"position","fixed");var e=Hn(a.element,"visibility");Fn(a.element,"visibility","hidden");var t,n=u.useFixed()?(t=document.documentElement,Cc(0,0,t.clientWidth,t.clientHeight)):(t=du((o=i).element),o=o.element.dom.getBoundingClientRect(),wc(t.left,t.top,o.width,o.height)),o=s.placement,r=c.map(q).or(u.getBounds);o(i,s,n).each(function(e){e.placer.getOr(hs)(i,n,e,r,a)}),e.fold(function(){jn(a.element,"visibility")},function(e){Fn(a.element,"visibility",e)}),Hn(a.element,"left").isNone()&&Hn(a.element,"top").isNone()&&Hn(a.element,"right").isNone()&&Hn(a.element,"bottom").isNone()&&Hn(a.element,"position").is("fixed")&&jn(a.element,"position")},a.element)},Ci=Object.freeze({__proto__:null,position:function(e,t,n,o,r){fl(e,t,n,o,r,G.none())},positionWithin:fl,positionWithinBounds:dl,getMode:function(e,t,n){return t.useFixed()?"fixed":"absolute"}}),Ai=[Ze("useFixed",c),Xe("getBounds")],ml=ya({fields:Ai,name:"positioning",active:j,apis:Ci}),gl=function(e){xt(e,ai());e=e.components();oe(e,gl)},pl=function(e){var t=e.components();oe(t,pl),xt(e,ui())},hl=function(e,t,n){e.getSystem().addToWorld(t),n(e.element,t.element),eu(e.element)&&pl(t),e.syncComponents()},vl=function(e,t,n){n(e,t.element);e=zt(t.element);oe(e,function(e){t.getByDom(e).each(pl)})},Ri=function(e,t,n){return n.isOpen()},bl=function(e,t,n){var o,r,i=t.getAttachPoint(e);Fn(e.element,"position",ml.getMode(i)),o=e,e="visibility",r=t.cloakVisibilityAttr,t="hidden",Hn(o.element,e).fold(function(){nn(o.element,r)},function(e){Qt(o.element,r,e)}),Fn(o.element,e,t)},yl=function(e,t,n){var o,r,i;o=e.element,b(["top","left","right","bottom"],function(e){return Hn(o,e).isSome()})||jn(e.element,"position"),r=e,i="visibility",t=t.cloakVisibilityAttr,en(r.element,t).fold(function(){return jn(r.element,i)},function(e){return Fn(r.element,i,e)})},Mi=Object.freeze({__proto__:null,cloak:bl,decloak:yl,open:_s,openWhileCloaked:function(e,t,n,o,r){bl(e,t),_s(e,t,n,o),r(),yl(e,t)},close:Es,isOpen:Ri,isPartOf:function(t,n,e,o){return e.isOpen()&&e.get().exists(function(e){return n.isPartOf(t,e,o)})},getState:function(e,t,n){return n.get()},setContent:function(e,t,n,o){return n.get().map(function(){return Os(e,t,n,o)})}}),Yi=Object.freeze({__proto__:null,events:function(n,o){return vi([Et(Zr(),function(e,t){Es(e,n,o)})])}}),xl=[Ka("onOpen"),Ka("onClose"),ze("isPartOf"),ze("getAttachPoint"),Ze("cloakVisibilityAttr","data-precloak-visibility")],wl=ya({fields:xl,name:"sandboxing",active:Yi,apis:Mi,state:Object.freeze({__proto__:null,init:function(){var t=it(G.none()),e=q("not-implemented");return qi({readState:e,isOpen:function(){return t.get().isSome()},clear:function(){t.set(G.none())},set:function(e){t.set(G.some(e))},get:function(){return t.get()}})}})}),Cl=q("dismiss.popups"),Sl=q("reposition.popups"),kl=q("mouse.released"),Ol=Ae([Ze("isExtraPart",c),Qe("fireEventInstead",[Ze("event",ci())])]),_l=Ae([Qe("fireEventInstead",[Ze("event",si())]),Qo("doReposition")]),$a=Object.freeze({__proto__:null,onLoad:As,onUnload:Bs,setValue:function(e,t,n,o){t.store.manager.setValue(e,t,n,o)},getValue:function(e,t,n){return t.store.manager.getValue(e,t,n)},getState:function(e,t,n){return n}}),tc=Object.freeze({__proto__:null,events:function(n,o){var e=n.resetOnDom?[bi(function(e,t){As(e,n,o)}),yi(function(e,t){Bs(e,n,o)})]:[pa(n,o,As)];return vi(e)}}),t=function(){var e=it(null);return qi({set:e.set,get:e.get,isNotSet:function(){return null===e.get()},clear:function(){e.set(null)},readState:function(){return{mode:"memory",value:e.get()}}})},dc=function(){var i=it({}),u=it({});return qi({readState:function(){return{mode:"dataset",dataByValue:i.get(),dataByText:u.get()}},lookup:function(e){return ho(i.get(),e).orThunk(function(){return ho(u.get(),e)})},update:function(e){var t=i.get(),n=u.get(),o={},r={};oe(e,function(t){o[t.value]=t,ho(t,"meta").each(function(e){ho(e,"text").each(function(e){r[e]=t})})}),i.set(A(A({},t),o)),u.set(A(A({},n),r))},clear:function(){i.set({}),u.set({})}})},yc=Object.freeze({__proto__:null,memory:t,dataset:dc,manual:function(){return qi({readState:function(){}})},init:function(e){return e.store.manager.state(e)}}),xo=[Xe("initialValue"),ze("getFallbackEntry"),ze("getDataKey"),ze("setValue"),$u("manager",{setValue:Ns,getValue:function(e,t,n){var o=t.store,r=o.getDataKey(e);return n.lookup(r).fold(function(){return o.getFallbackEntry(r)},function(e){return e})},onLoad:function(t,n,o){n.store.initialValue.each(function(e){Ns(t,n,o,e)})},onUnload:function(e,t,n){n.clear()},state:dc})],gr=[ze("getValue"),Ze("setValue",W),Xe("initialValue"),$u("manager",{setValue:function(e,t,n,o){t.store.setValue(e,o),t.onSetValue(e,o)},getValue:function(e,t,n){return t.store.getValue(e)},onLoad:function(t,n,e){n.store.initialValue.each(function(e){n.store.setValue(t,e)})},onUnload:W,state:Wi.init})],pr=[Xe("initialValue"),$u("manager",{setValue:function(e,t,n,o){n.set(o),t.onSetValue(e,o)},getValue:function(e,t,n){return n.get()},onLoad:function(e,t,n){t.store.initialValue.each(function(e){n.isNotSet()&&n.set(e)})},onUnload:function(e,t,n){n.clear()},state:t})],kr=[et("store",{mode:"memory"},Ve("mode",{memory:pr,manual:gr,dataset:xo})),Ka("onSetValue"),Ze("resetOnDom",!1)],El=ya({fields:kr,name:"representing",active:tc,apis:$a,extra:{setValueFrom:function(e,t){t=El.getValue(t);El.setValue(e,t)}},state:yc}),Wr=function(o,e){return ot(o,{},S(e,function(e){return t=e.name(),n="Cannot configure "+e.name()+" for "+o,Po(t,t,Oo(),De(function(e){return io("The field: "+t+" is forbidden. "+n)}));var t,n}).concat([rt("dump",l)]))},dr=function(e){return e.dump},Tl=Wr,Dl=Rs,Al="placeholder",Bl=bo([{single:["required","valueThunk"]},{multiple:["required","valueThunks"]}]),Nl=function(o,r,i,u){return Is(o,0,i,u).fold(function(e,t){var n=Ms(i)?t(r,i.config,i.validated):t(r),t=ho(n,"components").getOr([]),t=T(t,function(e){return Nl(o,r,e,u)});return[A(A({},n),{components:t})]},function(e,t){if(Ms(i)){var n=t(r,i.config,i.validated);return i.validated.preprocess.getOr(l)(n)}return t(r)})},Rl=Bl.single,Ml=Bl.multiple,Il=q(Al),Ur=bo([{required:["data"]},{external:["data"]},{optional:["data"]},{group:["data"]}]),mr=Ze("factory",{sketch:l}),Ai=Ze("schema",[]),j=ze("name"),Ci=Po("pname","pname",_o(function(e){return"<alloy."+un(e.name)+">"}),Wo()),Ri=Fo("schema",function(){return[Xe("preprocess")]}),xl=Ze("defaults",q({})),Yi=Ze("overrides",q({})),Mi=No([mr,Ai,j,Ci,xl,Yi]),dc=No([mr,Ai,j,xl,Yi]),t=No([mr,Ai,j,Ci,xl,Yi]),pr=No([mr,Ri,j,ze("unit"),Ci,xl,Yi]),gr=function(t,n){return function(e){e=Le("Converting part type",n,e);return t(e)}},Fl=gr(Ur.required,Mi),xo=gr(Ur.external,dc),Pl=gr(Ur.optional,t),kr=gr(Ur.group,pr),Ll=q("entirety"),tc=Object.freeze({__proto__:null,required:Fl,external:xo,optional:Pl,group:kr,asNamedPart:Ps,name:Ls,asCommon:function(e){return e.fold(l,l,l,l)},original:Ll}),Vl=function(e,t){return{uiType:Il(),owner:e,name:t}},$a=Object.freeze({__proto__:null,generate:Hs,generateOne:zs,schemas:js,names:Us,substitutes:Ws,components:qs,defaultUids:Qs,defaultUidsSchema:Zs,getAllParts:Ys,getAllPartNames:Ks,getPart:Gs,getPartOrDie:$s,getParts:Xs,getPartsOrDie:Js}),Hl=function(e){return vo(e,"uid")?e:A(A({},e),{uid:Vi("uid")})};function zl(e){var t=Le("Sketcher for "+e.name,cf,e),n=de(t.apis,ln),e=de(t.extraApis,cn);return A(A({name:t.name,configFields:t.configFields,sketch:function(e){return function(e,t,n,o){o=Hl(o);return n(el(e,t,o,[],[]),o)}(t.name,t.configFields,t.factory,e)}},n),e)}function jl(e){for(var t=[],n=function(e){t.push(e)},o=0;o<e.length;o++)e[o].each(n);return t}function Ul(e,t){return e?G.some(t):G.none()}function Wl(e){return"input"===Mt(e)&&"radio"!==Zt(e,"type")||"textarea"===Mt(e)}function ql(n,o,e,r){var t=Wc(n.element,"."+o.highlightClass);oe(t,function(t){b(r,function(e){return e.element===t})||(_n(t,o.highlightClass),n.getSystem().getByDom(t).each(function(e){o.onDehighlight(n,e),xt(e,pi())}))})}function Gl(e,t,n,o){ql(e,t,0,[o]),ff(e,t,n,o)||(kn(o.element,t.highlightClass),t.onHighlight(e,o),xt(o,gi()))}function $l(t,n,e,o){var r=Wc(t.element,"."+n.itemClass);return E(r,function(e){return En(e,n.highlightClass)}).bind(function(e){e=Ta(e,o,0,r.length-1);return t.getSystem().getByDom(r[e]).toOptional()})}function Xl(e,t,n){var o=N(e.slice(0,t)),t=N(e.slice(t+1));return _(o.concat(t),n)}function Yl(e,t,n){return t=N(e.slice(0,t)),_(t,n)}function Kl(e,t,n){var o=e.slice(0,t),t=e.slice(t+1);return _(t.concat(o),n)}function Jl(e,t,n){return t=e.slice(t+1),_(t,n)}function Ql(t){return function(e){e=e.raw;return ne(t,e.which)}}function Zl(e){return function(t){return D(e,function(e){return e(t)})}}function ef(e){return!0===e.raw.shiftKey}function tf(e){return!0===e.raw.ctrlKey}function nf(e,t){return{matches:e,classification:t}}function of(e,t,n){t.exists(function(t){return n.exists(function(e){return dt(e,t)})})||wt(e,li(),{prevFocus:t,newFocus:n})}function rf(){function o(e){return Ca(e.element)}return{get:o,set:function(e,t){var n=o(e);e.getSystem().triggerFocus(t,e.element);t=o(e);of(e,n,t)}}}function uf(){function o(e){return hf.getHighlighted(e).map(function(e){return e.element})}return{get:o,set:function(t,e){var n=o(t);t.getSystem().getByDom(e).fold(W,function(e){hf.highlight(t,e)});e=o(t);of(t,n,e)}}}var af,cf=Ae([ze("name"),ze("factory"),ze("configFields"),Ze("apis",{}),Ze("extraApis",{})]),sf=Ae([ze("name"),ze("factory"),ze("configFields"),ze("partFields"),Ze("apis",{}),Ze("extraApis",{})]),yc=function(e){var t=Le("Sketcher for "+e.name,sf,e),n=Hs(t.name,t.partFields),o=de(t.apis,ln),e=de(t.extraApis,cn);return A(A({name:t.name,partFields:t.partFields,configFields:t.configFields,sketch:function(e){return tl(t.name,t.configFields,t.partFields,t.factory,e)},parts:n},o),e)},dr=Object.freeze({__proto__:null,getCurrent:function(e,t,n){return t.find(e)}}),Ai=[ze("find")],lf=ya({fields:Ai,name:"composing",apis:dr}),ff=function(e,t,n,o){return En(o.element,t.highlightClass)},df=function(e,t,n,o){t=Wc(e.element,"."+t.itemClass);return G.from(t[o]).fold(function(){return ce.error("No element found with index "+o)},e.getSystem().getByDom)},mf=function(t,e,n){return Vu(t.element,"."+e.itemClass).bind(function(e){return t.getSystem().getByDom(e).toOptional()})},gf=function(t,e,n){e=Wc(t.element,"."+e.itemClass);return(0<e.length?G.some(e[e.length-1]):G.none()).bind(function(e){return t.getSystem().getByDom(e).toOptional()})},pf=function(t,e,n){e=Wc(t.element,"."+e.itemClass);return jl(S(e,function(e){return t.getSystem().getByDom(e).toOptional()}))},mr=Object.freeze({__proto__:null,dehighlightAll:function(e,t,n){return ql(e,t,0,[])},dehighlight:function(e,t,n,o){ff(e,t,n,o)&&(_n(o.element,t.highlightClass),t.onDehighlight(e,o),xt(o,pi()))},highlight:Gl,highlightFirst:function(t,n,o){mf(t,n).each(function(e){Gl(t,n,o,e)})},highlightLast:function(t,n,o){gf(t,n).each(function(e){Gl(t,n,o,e)})},highlightAt:function(t,n,o,e){df(t,n,o,e).fold(function(e){throw new Error(e)},function(e){Gl(t,n,o,e)})},highlightBy:function(t,n,o,e){var r=pf(t,n);_(r,e).each(function(e){Gl(t,n,o,e)})},isHighlighted:ff,getHighlighted:function(t,e,n){return Vu(t.element,"."+e.highlightClass).bind(function(e){return t.getSystem().getByDom(e).toOptional()})},getFirst:mf,getLast:gf,getPrevious:function(e,t,n){return $l(e,t,0,-1)},getNext:function(e,t,n){return $l(e,t,0,1)},getCandidates:pf}),Ri=[ze("highlightClass"),ze("itemClass"),Ka("onHighlight"),Ka("onDehighlight")],hf=ya({fields:Ri,name:"highlighting",apis:mr}),vf=[8],bf=[9],yf=[13],xf=[27],wf=[32],Cf=[37],Sf=[38],kf=[39],Of=[40],_f=p(ef);(j=af=af||{}).OnFocusMode="onFocus",j.OnEnterOrSpaceMode="onEnterOrSpace",j.OnApiMode="onApi";function Ef(e,t,n,o,a){function c(t,n,e,o,r){var i,e=e(t,n,o,r);return i=n.event,_(e,function(e){return e.matches(i)}).map(function(e){return e.classification}).bind(function(e){return e(t,n,o,r)})}var r={schema:function(){return e.concat([Ze("focusManager",rf()),et("focusInside","onFocus",Ie(function(e){return ne(["onFocus","onEnterOrSpace","onApi"],e)?ce.value(e):ce.error("Invalid value for focusInside")})),$u("handler",r),$u("state",t),$u("sendFocusIn",a)])},processKey:c,toEvents:function(i,u){var e=i.focusInside!==af.OnFocusMode?G.none():a(i).map(function(n){return Et(qr(),function(e,t){n(e,i,u),t.stop()})}),t=[Et(Fr(),function(o,r){c(o,r,n,i,u).fold(function(){var t,n,e;t=o,n=r,e=Ql(wf.concat(yf))(n.event),i.focusInside===af.OnEnterOrSpaceMode&&e&&vt(t,n)&&a(i).each(function(e){e(t,i,u),n.stop()})},function(e){r.stop()})}),Et(Pr(),function(e,t){c(e,t,o,i,u).each(function(e){t.stop()})})];return vi(e.toArray().concat(t))}};return r}function Tf(e,t){return G.some(!0)}function Df(e,t,n){return n.execute(e,t,e.element)}function Af(i){return function(e,t,n,o){var r=i(e.element);return Bd(r,e,t,n,o)}}function Bf(e,t){return t=Va(e,t),Af(t)}function Nf(e,t){return e=Va(t,e),Af(e)}function Rf(e){return!((e=e.dom).offsetWidth<=0&&e.offsetHeight<=0)}function Mf(e,t,n){var o,n=Wc(e,n),n=C(n,Rf);return E(o=n,function(e){return dt(e,t)}).map(function(e){return{index:e,candidates:o}})}function If(e,t){return E(e,function(e){return dt(t,e)})}function Ff(t,e,n,o){return o(Math.floor(e/n),e%n).bind(function(e){e=e.row*n+e.column;return 0<=e&&e<t.length?G.some(t[e]):G.none()})}function Pf(o,e,r,i,u){return Ff(o,e,i,function(e,t){var n=e===r-1?o.length-e*i:i,n=Ta(t,u,0,n-1);return G.some({row:e,column:n})})}function Lf(o,e,r,i,u){return Ff(o,e,i,function(e,t){var n=Ta(e,u,0,r-1),e=n===r-1?o.length-n*i:i,e=Da(t,0,e-1);return G.some({row:n,column:e})})}function Vf(t,n,e){Vu(t.element,n.selector).each(function(e){n.focusManager.set(t,e)})}function Hf(e,t,n,r){var i=function(e,t,n){var o=Ta(t,r,0,n.length-1);return o===e?G.none():(t=n[o],"button"===Mt(t)&&"disabled"===Zt(t,"disabled")?i(e,o,n):G.from(n[o]))};return Mf(e,n,t).bind(function(e){var t=e.index,e=e.candidates;return i(t,t,e)})}function zf(t,n,o){return(r=o).focusManager.get(t).bind(function(e){return Hu(e,r.selector)}).bind(function(e){return o.execute(t,n,e)});var r}function jf(t,n,e){n.getInitial(t).orThunk(function(){return Vu(t.element,n.selector)}).each(function(e){n.focusManager.set(t,e)})}function Uf(e,t,n){return Hf(e,n.selector,t,-1)}function Wf(e,t,n){return Hf(e,n.selector,t,1)}function qf(r){return function(e,t,n,o){return r(e,t,n,o).bind(function(){return n.executeOnMove?zf(e,t,n):G.some(!0)})}}function Gf(e,t,n){return n.onEscape(e,t)}function $f(e,t,n){return G.from(e[t]).bind(function(e){return G.from(e[n]).map(function(e){return{rowIndex:t,columnIndex:n,cell:e}})})}function Xf(e,t,n,o){var r=e[t].length,r=Ta(n,o,0,r-1);return $f(e,t,r)}function Yf(e,t,n,o){return n=Ta(n,o,0,e.length-1),o=e[n].length,o=Da(t,0,o-1),$f(e,n,o)}function Kf(e,t,n,o){var r=e[t].length,r=Da(n+o,0,r-1);return $f(e,t,r)}function Jf(e,t,n,o){return n=Da(n+o,0,e.length-1),o=e[n].length,o=Da(t,0,o-1),$f(e,n,o)}function Qf(t,n,e){n.previousSelector(t).orThunk(function(){var e=n.selectors;return Vu(t.element,e.cell)}).each(function(e){n.focusManager.set(t,e)})}function Zf(t,n,e){Vu(t.element,n.selector).each(function(e){n.focusManager.set(t,e)})}function ed(e,t,n){return Hf(e,n.selector,t,-1)}function td(e,t,n){return Hf(e,n.selector,t,1)}function nd(e,t,n,o){o=e.getSystem().build(o),hl(e,o,n)}function od(e,t,n,o){e=Md(e),_(e,function(e){return dt(o.element,e.element)}).each(ws)}function rd(t,e,n,r,o){var i=Md(t);return G.from(i[r]).map(function(e){return od(t,0,0,e),o.each(function(e){nd(t,0,function(e,t){var n,o;o=t,jt(n=e,r).fold(function(){Ti(n,o)},function(e){Ut(e,o)})},e)}),e})}function id(e,t){return{key:e,value:{config:{},me:function(e,t){t=vi(t);return ya({fields:[ze("enabled")],name:e,active:{events:q(t)}})}(e,t),configAsRaw:q({}),initialConfig:{},state:Wi}}}function ud(e,t){t.ignore||(xa(e.element),t.onFocus(e))}function ad(e,t,n){(t=t.aria).update(e,t,n.get())}function cd(t,e,n){e.toggleClass.each(function(e){(n.get()?kn:_n)(t.element,e)})}function sd(e,t,n){Pd(e,t,n,!n.get())}function ld(e,t,n){n.set(!0),cd(e,t,n),ad(e,t,n)}function fd(e,t,n){n.set(!1),cd(e,t,n),ad(e,t,n)}function dd(e,t,n){Pd(e,t,n,t.selected)}function md(){function e(e,t){t.stop(),Ct(e)}return[Et(Hr(),e),Et(Jr(),e),Nt(Or()),Nt(Dr())]}function gd(e){return vi(B([e.map(function(n){return wi(function(e,t){n(e),t.stop()})}).toArray(),md()]))}function pd(e){(Ca(e.element).isNone()||Fd.isFocused(e))&&(Fd.isFocused(e)||Fd.focus(e),wt(e,Hd,{item:e}))}function hd(e){wt(e,zd,{item:e})}function vd(){return"item-widget"}function bd(e,t){var n={};mo(e,function(e,t){oe(e,function(e){n[e]=t})});var o=t,r=go(t,function(e,t){return{k:e,v:t}}),i=de(r,function(e,t){return[t].concat(Xd(n,o,r,t))});return de(n,function(e){return ho(i,e).getOr([e])})}function yd(e,t,r,n,i){function u(){return e.lazySink(t)}function a(e){return 2===e.length?o:{}}var o="horizontal"===n.type?{layouts:{onLtr:ma,onRtl:ga}}:{};return Qd.sketch({dom:{tag:"div"},data:n.data,markers:n.menu.markers,highlightImmediately:n.menu.highlightImmediately,onEscape:function(){return wl.close(t),e.onEscape.map(function(e){return e(t)}),G.some(!0)},onExecute:function(){return G.some(!0)},onOpenMenu:function(e,t){ml.positionWithinBounds(u().getOrDie(),r,t,i())},onOpenSubmenu:function(e,t,n,o){var r=u().getOrDie();ml.position(r,A({anchor:"submenu",item:t},a(o)),n)},onRepositionMenu:function(e,t,n){var o=u().getOrDie();ml.positionWithinBounds(o,r,t,i()),oe(n,function(e){var t=a(e.triggeringPath);ml.position(o,A({anchor:"submenu",item:e.triggeringItem},t),e.triggeredMenu)})}})}function xd(e,t){return e.x+e.width/2-t.width/2}function wd(e,t){return e.x+e.width-t.width}function Cd(e,t){return e.y+e.height-t.height}function Sd(e,t,n){return Yu(wd(e,t),Cd(e,t),n.innerSoutheast(),ic(),Ku(e,{right:0,bottom:3}),"layout-inner-se")}function kd(e,t,n){return Yu(e.x,Cd(e,t),n.innerSouthwest(),rc(),Ku(e,{left:1,bottom:3}),"layout-inner-sw")}function Od(e,t,n){return Yu(wd(e,t),e.y,n.innerNortheast(),oc(),Ku(e,{right:0,top:2}),"layout-inner-ne")}function _d(e,t,n){return Yu(e.x,e.y,n.innerNorthwest(),nc(),Ku(e,{left:1,top:2}),"layout-inner-nw")}function Ed(e){var t=void 0!==e.uid&&he(e,"uid")?e.uid:Vi("memento");return{get:function(e){return e.getSystem().getByUid(t).getOrDie()},getOpt:function(e){return e.getSystem().getByUid(t).toOptional()},asSpec:function(){return A(A({},e),{uid:t})}}}function Td(e){return G.from(e()["temporary-placeholder"]).getOr("!not found!")}function Dd(e,t){return G.from(t()[e.toLowerCase()]).getOrThunk(function(){return Td(t)})}var Ad,Ci=function(e){function i(e,t){return e=e.visibilitySelector.bind(function(e){return Hu(t,e)}).getOr(t),0<su(e)}function t(t,n,e){!function(e,t){e=Wc(e.element,t.selector),e=C(e,function(e){return i(t,e)});return G.from(e[t.firstTabstop])}(t,n).each(function(e){n.focusManager.set(t,e)})}function u(t,e,n,o,r){return r(e,n,function(e){return i(t=o,e=e)&&t.useTabstopAt(e);var t}).fold(function(){return o.cyclic?G.some(!0):G.none()},function(e){return o.focusManager.set(t,e),G.some(!0)})}function r(t,e,n,o){var r,i=Wc(t.element,n.selector);return(r=n).focusManager.get(t).bind(function(e){return Hu(e,r.selector)}).bind(function(e){return E(i,m(dt,e)).bind(function(e){return u(t,i,e,n,o)})})}var n=[Xe("onEscape"),Xe("onEnter"),Ze("selector",'[data-alloy-tabstop="true"]:not(:disabled)'),Ze("firstTabstop",0),Ze("useTabstopAt",v),Xe("visibilitySelector")].concat([e]),o=q([nf(Zl([ef,Ql(bf)]),function(e,t,n){var o=n.cyclic?Xl:Yl;return r(e,0,n,o)}),nf(Ql(bf),function(e,t,n){var o=n.cyclic?Kl:Jl;return r(e,0,n,o)}),nf(Ql(xf),function(t,n,e){return e.onEscape.bind(function(e){return e(t,n)})}),nf(Zl([_f,Ql(yf)]),function(t,n,e){return e.onEnter.bind(function(e){return e(t,n)})})]),e=q([]);return Ef(n,Wi.init,o,e,function(){return G.some(t)})},xl=Ci(rt("cyclic",c)),Yi=Ci(rt("cyclic",v)),Mi=function(e,t,n){return Wl(n)&&Ql(wf)(t.event)?G.none():(St(e,n,Yr()),G.some(!0))},dc=[Ze("execute",Mi),Ze("useSpace",!1),Ze("useEnter",!0),Ze("useControlEnter",!1),Ze("useDown",!1)],t=Ef(dc,Wi.init,function(e,t,n,o){var r=n.useSpace&&!Wl(e.element)?wf:[],i=n.useEnter?yf:[],e=n.useDown?Of:[],e=r.concat(i).concat(e);return[nf(Ql(e),Df)].concat(n.useControlEnter?[nf(Zl([tf,Ql(yf)]),Df)]:[])},function(e,t,n,o){return n.useSpace&&!Wl(e.element)?[nf(Ql(wf),Tf)]:[]},function(){return G.none()}),gr=function(){var n=it(G.none());return qi({readState:function(){return n.get().map(function(e){return{numRows:String(e.numRows),numColumns:String(e.numColumns)}}).getOr({numRows:"?",numColumns:"?"})},setGridSize:function(e,t){n.set(G.some({numRows:e,numColumns:t}))},getNumRows:function(){return n.get().map(function(e){return e.numRows})},getNumColumns:function(){return n.get().map(function(e){return e.numColumns})}})},Ur=Object.freeze({__proto__:null,flatgrid:gr,init:function(e){return e.state(e)}}),pr=function(r){return function(e,t,n,o){return Bd(r,e,t,n,o)}},Bd=function(t,n,e,o,r){return o.focusManager.get(n).bind(function(e){return t(n.element,e,o,r)}).map(function(e){return o.focusManager.set(n,e),!0})},Ai=pr,dr=pr,Nd=pr,Ri=[ze("selector"),Ze("execute",Mi),Ja("onEscape"),Ze("captureTab",!1),ec()],mr=function(r){return function(e,t,n,o){return Mf(e,t,n.selector).bind(function(e){return r(e.candidates,e.index,o.getNumRows().getOr(n.initSize.numRows),o.getNumColumns().getOr(n.initSize.numColumns))})}},j=function(e,t,n){return n.captureTab?G.some(!0):G.none()},Ci=mr(function(e,t,n,o){return Pf(e,t,n,o,-1)}),dc=mr(function(e,t,n,o){return Pf(e,t,n,o,1)}),pr=mr(function(e,t,n,o){return Lf(e,t,n,o,-1)}),mr=mr(function(e,t,n,o){return Lf(e,t,n,o,1)}),Ci=q([nf(Ql(Cf),Bf(Ci,dc)),nf(Ql(kf),Nf(Ci,dc)),nf(Ql(Sf),Ai(pr)),nf(Ql(Of),dr(mr)),nf(Zl([ef,Ql(bf)]),j),nf(Zl([_f,Ql(bf)]),j),nf(Ql(xf),function(e,t,n){return n.onEscape(e,t)}),nf(Ql(wf.concat(yf)),function(t,n,o,e){return(r=o).focusManager.get(t).bind(function(e){return Hu(e,r.selector)}).bind(function(e){return o.execute(t,n,e)});var r})]),dc=q([nf(Ql(wf),Tf)]),pr=Ef(Ri,gr,Ci,dc,function(){return G.some(Vf)}),mr=[ze("selector"),Ze("getInitial",G.none),Ze("execute",Mi),Ja("onEscape"),Ze("executeOnMove",!1),Ze("allowVertical",!0)],j=q([nf(Ql(wf),Tf)]),Ri=Ef(mr,Wi.init,function(e,t,n,o){var r=Cf.concat(n.allowVertical?Sf:[]),n=kf.concat(n.allowVertical?Of:[]);return[nf(Ql(r),qf(Bf(Uf,Wf))),nf(Ql(n),qf(Nf(Uf,Wf))),nf(Ql(yf),zf),nf(Ql(wf),zf),nf(Ql(xf),Gf)]},j,function(){return G.some(jf)}),gr=[qe("selectors",[ze("row"),ze("cell")]),Ze("cycles",!0),Ze("previousSelector",G.none),Ze("execute",Mi)],Ci=function(e,t){return function(n,o,i){var u=i.cycles?e:t;return Hu(o,i.selectors.row).bind(function(e){var t=Wc(e,i.selectors.cell);return If(t,o).bind(function(o){var r=Wc(n,i.selectors.row);return If(r,e).bind(function(e){var t,n=(t=i,S(r,function(e){return Wc(e,t.selectors.cell)}));return u(n,e,o).map(function(e){return e.cell})})})})}},dc=Ci(function(e,t,n){return Xf(e,t,n,-1)},function(e,t,n){return Kf(e,t,n,-1)}),mr=Ci(function(e,t,n){return Xf(e,t,n,1)},function(e,t,n){return Kf(e,t,n,1)}),j=Ci(function(e,t,n){return Yf(e,n,t,-1)},function(e,t,n){return Jf(e,n,t,-1)}),Ci=Ci(function(e,t,n){return Yf(e,n,t,1)},function(e,t,n){return Jf(e,n,t,1)}),dr=q([nf(Ql(Cf),Bf(dc,mr)),nf(Ql(kf),Nf(dc,mr)),nf(Ql(Sf),Ai(j)),nf(Ql(Of),dr(Ci)),nf(Ql(wf.concat(yf)),function(t,n,o){return Ca(t.element).bind(function(e){return o.execute(t,n,e)})})]),Ci=q([nf(Ql(wf),Tf)]),gr=Ef(gr,Wi.init,dr,Ci,function(){return G.some(Qf)}),dr=[ze("selector"),Ze("execute",Mi),Ze("moveOnTab",!1)],Ci=function(t,n,o){return o.focusManager.get(t).bind(function(e){return o.execute(t,n,e)})},Mi=q([nf(Ql(Sf),Nd(ed)),nf(Ql(Of),Nd(td)),nf(Zl([ef,Ql(bf)]),function(e,t,n,o){return n.moveOnTab?Nd(ed)(e,t,n,o):G.none()}),nf(Zl([_f,Ql(bf)]),function(e,t,n,o){return n.moveOnTab?Nd(td)(e,t,n,o):G.none()}),nf(Ql(yf),Ci),nf(Ql(wf),Ci)]),Ci=q([nf(Ql(wf),Tf)]),dr=Ef(dr,Wi.init,Mi,Ci,function(){return G.some(Zf)}),Mi=[Ja("onSpace"),Ja("onEnter"),Ja("onShiftEnter"),Ja("onLeft"),Ja("onRight"),Ja("onTab"),Ja("onShiftTab"),Ja("onUp"),Ja("onDown"),Ja("onEscape"),Ze("stopSpaceKeyup",!1),Xe("focusIn")],Ci=Ef(Mi,Wi.init,function(e,t,n){return[nf(Ql(wf),n.onSpace),nf(Zl([_f,Ql(yf)]),n.onEnter),nf(Zl([ef,Ql(yf)]),n.onShiftEnter),nf(Zl([ef,Ql(bf)]),n.onShiftTab),nf(Zl([_f,Ql(bf)]),n.onTab),nf(Ql(Sf),n.onUp),nf(Ql(Of),n.onDown),nf(Ql(Cf),n.onLeft),nf(Ql(kf),n.onRight),nf(Ql(wf),n.onSpace),nf(Ql(xf),n.onEscape)]},function(e,t,n){return n.stopSpaceKeyup?[nf(Ql(wf),Tf)]:[]},function(e){return e.focusIn}),Mi=xl.schema(),xl=Yi.schema(),Yi=Ri.schema(),Ri=pr.schema(),pr=gr.schema(),gr=t.schema(),t=dr.schema(),dr=Ci.schema(),Rd=z({branchKey:"mode",branches:Object.freeze({__proto__:null,acyclic:Mi,cyclic:xl,flow:Yi,flatgrid:Ri,matrix:pr,execution:gr,menu:t,special:dr}),name:"keying",active:{events:function(e,t){return e.handler.toEvents(e,t)}},apis:{focusIn:function(t,n,o){n.sendFocusIn(n).fold(function(){t.getSystem().triggerFocus(t.element,t.element)},function(e){e(t,n,o)})},setGridSize:function(e,t,n,o,r){he(n,"setGridSize")?n.setGridSize(o,r):console.error("Layout does not support setGridSize")}},state:Ur}),Md=function(e,t){return e.components()},Id=ya({fields:[],name:"replacing",apis:Object.freeze({__proto__:null,append:function(e,t,n,o){nd(e,0,Ti,o)},prepend:function(e,t,n,o){nd(e,0,qt,o)},remove:od,replaceAt:rd,replaceBy:function(t,e,n,o,r){var i=Md(t);return E(i,o).bind(function(e){return rd(t,0,0,e,r)})},set:function(t,e,n,o){Sa(function(){var e=S(o,t.getSystem().build);bs(t,e)},t.element)},contents:Md})}),Ci=Object.freeze({__proto__:null,focus:ud,blur:function(e,t){t.ignore||e.element.dom.blur()},isFocused:function(e){return t=e.element,e=Ji(t).dom,t.dom===e.activeElement;var t}}),Mi=Object.freeze({__proto__:null,exhibit:function(e,t){t=t.ignore?{}:{attributes:{tabindex:"-1"}};return dn(t)},events:function(n){return vi([Et(qr(),function(e,t){ud(e,n),t.stop()})].concat(n.stopMousedown?[Et(Dr(),function(e,t){t.event.prevent()})]:[]))}}),xl=[Ka("onFocus"),Ze("stopMousedown",!1),Ze("ignore",!1)],Fd=ya({fields:xl,name:"focusing",active:Mi,apis:Ci}),Pd=function(e,t,n,o){(o?ld:fd)(e,t,n)},Yi=Object.freeze({__proto__:null,onLoad:dd,toggle:sd,isOn:function(e,t,n){return n.get()},on:ld,off:fd,set:Pd}),Ri=Object.freeze({__proto__:null,exhibit:function(){return dn({})},events:function(e,t){var n,o,r,i=(n=e,o=t,r=sd,wi(function(e){r(e,n,o)})),t=pa(e,t,dd);return vi(B([e.toggleOnExecute?[i]:[],[t]]))}}),Ld=function(e,t,n){Qt(e.element,"aria-expanded",n)},pr=[Ze("selected",!1),Xe("toggleClass"),Ze("toggleOnExecute",!0),et("aria",{mode:"none"},Ve("mode",{pressed:[Ze("syncWithExpanded",!1),$u("update",function(e,t,n){Qt(e.element,"aria-pressed",n),t.syncWithExpanded&&Ld(e,t,n)})],checked:[$u("update",function(e,t,n){Qt(e.element,"aria-checked",n)})],expanded:[$u("update",Ld)],selected:[$u("update",function(e,t,n){Qt(e.element,"aria-selected",n)})],none:[$u("update",W)]}))],Vd=ya({fields:pr,name:"toggling",active:Ri,apis:Yi,state:(Ad=!1,{init:function(){var t=it(Ad);return{get:function(){return t.get()},set:function(e){return t.set(e)},clear:function(){return t.set(Ad)},readState:function(){return t.get()}}}})}),Hd="alloy.item-hover",zd="alloy.item-focus",jd=q(Hd),Ud=q(zd),gr=[ze("data"),ze("components"),ze("dom"),Ze("hasSubmenu",!1),Xe("toggling"),Tl("itemBehaviours",[Vd,Fd,Rd,El]),Ze("ignoreFocus",!1),Ze("domModification",{}),$u("builder",function(e){return{dom:e.dom,domModification:A(A({},e.domModification),{attributes:A(A(A({role:e.toggling.isSome()?"menuitemcheckbox":"menuitem"},e.domModification.attributes),{"aria-haspopup":e.hasSubmenu}),e.hasSubmenu?{"aria-expanded":!1}:{})}),behaviours:Dl(e.itemBehaviours,[e.toggling.fold(Vd.revoke,function(e){return Vd.config(A({aria:{mode:"checked"}},e))}),Fd.config({ignore:e.ignoreFocus,stopMousedown:e.ignoreFocus,onFocus:function(e){hd(e)}}),Rd.config({mode:"execution"}),El.config({store:{mode:"memory",initialValue:e.data}}),id("item-type-events",h(md(),[Et(Rr(),pd),Et(Kr(),Fd.focus)]))]),components:e.components,eventOrder:e.eventOrder}}),Ze("eventOrder",{})],t=[ze("dom"),ze("components"),$u("builder",function(e){return{dom:e.dom,components:e.components,events:vi([(e=Kr(),Et(e,function(e,t){t.stop()}))])}})],Wd=q([Fl({name:"widget",overrides:function(t){return{behaviours:gc([El.config({store:{mode:"manual",getValue:function(e){return t.data},setValue:function(){}}})])}}})]),dr=[ze("uid"),ze("data"),ze("components"),ze("dom"),Ze("autofocus",!1),Ze("ignoreFocus",!1),Tl("widgetBehaviours",[El,Fd,Rd]),Ze("domModification",{}),Zs(Wd()),$u("builder",function(n){function o(e){return Gs(e,n,"widget").map(function(e){return Rd.focusIn(e),e})}var e=Ws(0,n,Wd()),t=qs(vd(),n,e.internals()),e=function(e,t){return Wl(t.event.target)||n.autofocus&&t.setSource(e.element),G.none()};return{dom:n.dom,components:t,domModification:n.domModification,events:vi([wi(function(e,t){o(e).each(function(e){t.stop()})}),Et(Rr(),pd),Et(Kr(),function(e,t){n.autofocus?o(e):Fd.focus(e)})]),behaviours:Dl(n.widgetBehaviours,[El.config({store:{mode:"memory",initialValue:n.data}}),Fd.config({ignore:n.ignoreFocus,onFocus:function(e){hd(e)}}),Rd.config({mode:"special",focusIn:n.autofocus?function(e){o(e)}:vc(),onLeft:e,onRight:e,onEscape:function(e,t){return Fd.isFocused(e)||n.autofocus?(n.autofocus&&t.setSource(e.element),G.none()):(Fd.focus(e),G.some(!0))}})])}})],qd=Ve("type",{widget:dr,item:gr,separator:t}),Ur=q([kr({factory:{sketch:function(e){e=Le("menu.spec item",qd,e);return e.builder(e)}},name:"items",unit:"item",defaults:function(e,t){return t.hasOwnProperty("uid")?t:A(A({},t),{uid:Vi("item")})},overrides:function(e,t){return{type:t.type,ignoreFocus:e.fakeFocus,domModification:{classes:[e.markers.item]}}}})]),xl=q([ze("value"),ze("items"),ze("dom"),ze("components"),Ze("eventOrder",{}),Wr("menuBehaviours",[hf,El,lf,Rd]),et("movement",{mode:"menu",moveOnTab:!0},Ve("mode",{grid:[ec(),$u("config",function(e,t){return{mode:"flatgrid",selector:"."+e.markers.item,initSize:{numColumns:t.initSize.numColumns,numRows:t.initSize.numRows},focusManager:e.focusManager}})],matrix:[$u("config",function(e,t){return{mode:"matrix",selectors:{row:t.rowSelector,cell:"."+e.markers.item},focusManager:e.focusManager}}),ze("rowSelector")],menu:[Ze("moveOnTab",!0),$u("config",function(e,t){return{mode:"menu",selector:"."+e.markers.item,moveOnTab:t.moveOnTab,focusManager:e.focusManager}})]})),je("markers",Ga()),Ze("fakeFocus",!1),Ze("focusManager",rf()),Ka("onHighlight")]),Gd=q("alloy.menu-focus"),$d=yc({name:"Menu",configFields:xl(),partFields:Ur(),factory:function(e,t,n,o){return{uid:e.uid,dom:e.dom,markers:e.markers,behaviours:Rs(e.menuBehaviours,[hf.config({highlightClass:e.markers.selectedItem,itemClass:e.markers.item,onHighlight:e.onHighlight}),El.config({store:{mode:"memory",initialValue:e.value}}),lf.config({find:G.some}),Rd.config(e.movement.config(e,e.movement))]),events:vi([Et(Ud(),function(t,n){var e=n.event;t.getSystem().getByDom(e.target).each(function(e){hf.highlight(t,e),n.stop(),wt(t,Gd(),{menu:t,item:e})})}),Et(jd(),function(e,t){t=t.event.item;hf.highlight(e,t)})]),components:t,eventOrder:e.eventOrder,domModification:{attributes:{role:"menu"}}}}}),Xd=function(n,o,r,e){return ho(r,e).bind(function(e){return ho(n,e).bind(function(e){var t=Xd(n,o,r,e);return G.some([e].concat(t))})}).getOr([])},Yd=function(e){return"prepared"===e.type?G.some(e.menu):G.none()},Kd={init:function(){function r(e,o,r){return n(e).bind(function(t){return n=e,ge(i.get(),function(e,t){return e===n}).bind(function(e){return o(e).map(function(e){return{triggeredMenu:t,triggeringItem:e,triggeringPath:r}})});var n})}var i=it({}),u=it({}),a=it({}),c=it(G.none()),s=it({}),n=function(e){return t(e).bind(Yd)},t=function(e){return ho(u.get(),e)},l=function(e){return ho(i.get(),e)};return{setMenuBuilt:function(e,t){var n;u.set(A(A({},u.get()),((n={})[e]={type:"prepared",menu:t},n)))},setContents:function(e,t,n,o){c.set(G.some(e)),i.set(n),u.set(t),s.set(o);n=bd(o,n);a.set(n)},expand:function(n){return ho(i.get(),n).map(function(e){var t=ho(a.get(),n).getOr([]);return[e].concat(t)})},refresh:function(e){return ho(a.get(),e)},collapse:function(e){return ho(a.get(),e).bind(function(e){return 1<e.length?G.some(e.slice(1)):G.none()})},lookupMenu:t,lookupItem:l,otherMenus:function(e){var t=s.get();return R(lo(t),e)},getPrimary:function(){return c.get().bind(n)},getMenus:function(){return u.get()},clear:function(){i.set({}),u.set({}),a.set({}),c.set(G.none())},isClear:function(){return c.get().isNone()},getTriggeringPath:function(e,o){var t=C(l(e).toArray(),function(e){return n(e).isSome()});return ho(a.get(),e).bind(function(e){var n=N(t.concat(e));return function(e){for(var t=[],n=0;n<e.length;n++){var o=e[n];if(!o.isSome())return G.none();t.push(o.getOrDie())}return G.some(t)}(T(n,function(e,t){return r(e,o,n.slice(0,t+1)).fold(function(){return c.get().is(e)?[]:[G.none()]},function(e){return[G.some(e)]})}))})}}},extractPreparedMenu:Yd},Jd=q("collapse-item"),Qd=zl({name:"TieredMenu",configFields:[Za("onExecute"),Za("onEscape"),Qa("onOpenMenu"),Qa("onOpenSubmenu"),Ka("onRepositionMenu"),Ka("onCollapseMenu"),Ze("highlightImmediately",!0),qe("data",[ze("primary"),ze("menus"),ze("expansions")]),Ze("fakeFocus",!1),Ka("onHighlight"),Ka("onHover"),Xa(),ze("dom"),Ze("navigateOnHover",!0),Ze("stayInDom",!1),Wr("tmenuBehaviours",[Rd,hf,lf,Id]),Ze("eventOrder",{})],apis:{collapseMenu:function(e,t){e.collapseMenu(t)},highlightPrimary:function(e,t){e.highlightPrimary(t)},repositionMenus:function(e,t){e.repositionMenus(t)}},factory:function(u,e){function n(e){var o,r,e=(o=e,r=u.data.primary,t=u.data.menus,de(t,function(e,t){function n(){return $d.sketch(A(A({},e),{value:t,markers:u.markers,fakeFocus:u.fakeFocus,onHighlight:u.onHighlight,focusManager:(u.fakeFocus?uf:rf)()}))}return t===r?{type:"prepared",menu:o.getSystem().build(n())}:{type:"notbuilt",nbMenu:n}})),t=g();return m.setContents(u.data.primary,e,u.data.expansions,t),m.getPrimary()}function a(e){return El.getValue(e).value}function i(t,e){hf.highlight(t,e),hf.getHighlighted(e).orThunk(function(){return hf.getFirst(e)}).each(function(e){St(t,e.element,Kr())})}function c(t,e){return jl(S(e,function(e){return t.lookupMenu(e).bind(function(e){return"prepared"===e.type?G.some(e.menu):G.none()})}))}function s(t,e,n){n=c(e,e.otherMenus(n)),oe(n,function(e){Dn(e.element,[u.markers.backgroundMenu]),u.stayInDom||Id.remove(t,e)})}function l(e,n){var t,e=(t=e,o.get().getOrThunk(function(){var n={},e=Wc(t.element,"."+u.markers.item),e=C(e,function(e){return"true"===Zt(e,"aria-haspopup")});return oe(e,function(e){t.getSystem().getByDom(e).each(function(e){var t=a(e);n[t]=e})}),o.set(G.some(n)),n}));mo(e,function(e,t){t=ne(n,t);Qt(e.element,"aria-expanded",t)})}function f(n,o,r){return G.from(r[0]).bind(function(e){return o.lookupMenu(e).bind(function(e){if("notbuilt"===e.type)return G.none();var t=e.menu,e=c(o,r.slice(1));return oe(e,function(e){kn(e.element,u.markers.backgroundMenu)}),eu(t.element)||Id.append(n,au(t)),Dn(t.element,[u.markers.backgroundMenu]),i(n,t),s(n,o,r),G.some(t)})})}var d,o=it(G.none()),m=Kd.init(),g=function(e){return de(u.data.menus,function(e,t){return T(e.items,function(e){return"separator"===e.type?[]:[e.data.value]})})};(b=d=d||{})[b.HighlightSubmenu=0]="HighlightSubmenu",b[b.HighlightParent=1]="HighlightParent";function r(o,r,i){void 0===i&&(i=d.HighlightSubmenu);var e=a(r);return m.expand(e).bind(function(n){return l(o,n),G.from(n[0]).bind(function(t){return m.lookupMenu(t).bind(function(e){e=function(e,t,n){if("notbuilt"!==n.type)return n.menu;n=e.getSystem().build(n.nbMenu());return m.setMenuBuilt(t,n),n}(o,t,e);return eu(e.element)||Id.append(o,au(e)),u.onOpenSubmenu(o,r,e,N(n)),i===d.HighlightSubmenu?(hf.highlightFirst(e),f(o,m,n)):(hf.dehighlightAll(e),G.some(r))})})})}function p(t,n){var e=a(n);return m.collapse(e).bind(function(e){return l(t,e),f(t,m,e).map(function(e){return u.onCollapseMenu(t,n,e),e})})}function t(n){return function(t,e){return Hu(e.getSource(),"."+u.markers.item).bind(function(e){return t.getSystem().getByDom(e).toOptional().bind(function(e){return n(t,e).map(function(){return!0})})})}}function h(e){return hf.getHighlighted(e).bind(hf.getHighlighted)}var v=vi([Et(Gd(),function(t,n){var e=n.event.item;m.lookupItem(a(e)).each(function(){var e=n.event.menu;hf.highlight(t,e);e=a(n.event.item);m.refresh(e).each(function(e){return s(t,m,e)})})}),wi(function(t,e){e=e.event.target;t.getSystem().getByDom(e).each(function(e){0===a(e).indexOf("collapse-item")&&p(t,e),r(t,e,d.HighlightSubmenu).fold(function(){u.onExecute(t,e)},function(){})})}),bi(function(t,e){n(t).each(function(e){Id.append(t,au(e)),u.onOpenMenu(t,e),u.highlightImmediately&&i(t,e)})})].concat(u.navigateOnHover?[Et(jd(),function(e,t){t=t.event.item;!function(t,e){e=a(e);m.refresh(e).bind(function(e){return l(t,e),f(t,m,e)})}(e,t),r(e,t,d.HighlightParent),u.onHover(e,t)})]:[])),b={collapseMenu:function(t){h(t).each(function(e){p(t,e)})},highlightPrimary:function(t){m.getPrimary().each(function(e){i(t,e)})},repositionMenus:function(n){m.getPrimary().bind(function(t){return h(n).bind(function(e){var t=a(e),e=pe(m.getMenus()),n=jl(S(e,Kd.extractPreparedMenu));return m.getTriggeringPath(t,function(e){return t=e,P(n,function(e){if(!e.getSystem().isConnected())return G.none();e=hf.getCandidates(e);return _(e,function(e){return a(e)===t})});var t})}).map(function(e){return{primary:t,triggeringPath:e}})}).fold(function(){G.from(n.components()[0]).filter(function(e){return"menu"===Zt(e.element,"role")}).each(function(e){u.onRepositionMenu(n,e,[])})},function(e){var t=e.primary,e=e.triggeringPath;u.onRepositionMenu(n,t,e)})}};return{uid:u.uid,dom:u.dom,markers:u.markers,behaviours:Rs(u.tmenuBehaviours,[Rd.config({mode:"special",onRight:t(function(e,t){return Wl(t.element)?G.none():r(e,t,d.HighlightSubmenu)}),onLeft:t(function(e,t){return Wl(t.element)?G.none():p(e,t)}),onEscape:t(function(e,t){return p(e,t).orThunk(function(){return u.onEscape(e,t).map(function(){return e})})}),focusIn:function(t,e){m.getPrimary().each(function(e){St(t,e.element,Kr())})}}),hf.config({highlightClass:u.markers.selectedMenu,itemClass:u.markers.menu}),lf.config({find:function(e){return hf.getHighlighted(e)}}),Id.config({})]),eventOrder:u.eventOrder,apis:b,events:v}},extraApis:{tieredData:function(e,t,n){return{primary:e,menus:t,expansions:n}},singleData:function(e,t){return{primary:e,menus:To(e,t),expansions:{}}},collapseItem:function(e){return{value:un(Jd()),meta:{text:e}}}}}),Zd=zl({name:"InlineView",configFields:[ze("lazySink"),Ka("onShow"),Ka("onHide"),Zo("onEscape"),Wr("inlineBehaviours",[wl,El,bc]),Qe("fireDismissalEventInstead",[Ze("event",ci())]),Qe("fireRepositionEventInstead",[Ze("event",si())]),Ze("getRelated",G.none),Ze("isExtraPart",c),Ze("eventOrder",G.none)],factory:function(i,e){function t(n){wl.isOpen(n)&&El.getValue(n).each(function(e){switch(e.mode){case"menu":wl.getState(n).each(function(e){Qd.repositionMenus(e)});break;case"position":var t=i.lazySink(n).getOrDie();ml.positionWithinBounds(t,e.anchor,n,e.getBounds())}})}var o=function(e,t,n,o){r(e,t,n,function(){return o.map(Su)})},r=function(e,t,n,o){var r=i.lazySink(e).getOrDie();wl.openWhileCloaked(e,n,function(){return ml.positionWithinBounds(r,t,e,o())}),El.setValue(e,G.some({mode:"position",anchor:t,getBounds:o}))},u=function(e,t,n,o){o=yd(i,e,t,n,o);wl.open(e,o),El.setValue(e,G.some({mode:"menu",menu:o}))},n={setContent:function(e,t){wl.setContent(e,t)},showAt:function(e,t,n){o(e,t,n,G.none())},showWithin:o,showWithinBounds:r,showMenuAt:function(e,t,n){u(e,t,n,function(){return G.none()})},showMenuWithinBounds:u,hide:function(e){wl.isOpen(e)&&(El.setValue(e,G.none()),wl.close(e))},getContent:function(e){return wl.getState(e)},reposition:t,isOpen:wl.isOpen};return{uid:i.uid,dom:i.dom,behaviours:Rs(i.inlineBehaviours,[wl.config({isPartOf:function(e,t,n){return Wu(t,n)||(o=n,i.getRelated(e).exists(function(e){return Wu(e,o)}));var o},getAttachPoint:function(e){return i.lazySink(e).getOrDie()},onOpen:function(e){i.onShow(e)},onClose:function(e){i.onHide(e)}}),El.config({store:{mode:"memory",initialValue:G.none()}}),bc.config({channels:A(A({},Ts(A({isExtraPart:e.isExtraPart},i.fireDismissalEventInstead.map(function(e){return{fireEventInstead:{event:e.event}}}).getOr({})))),Ds(A(A({},i.fireRepositionEventInstead.map(function(e){return{fireEventInstead:{event:e.event}}}).getOr({})),{doReposition:t})))})]),eventOrder:i.eventOrder,apis:n}},apis:{showAt:function(e,t,n,o){e.showAt(t,n,o)},showWithin:function(e,t,n,o,r){e.showWithin(t,n,o,r)},showWithinBounds:function(e,t,n,o,r){e.showWithinBounds(t,n,o,r)},showMenuAt:function(e,t,n,o){e.showMenuAt(t,n,o)},showMenuWithinBounds:function(e,t,n,o,r){e.showMenuWithinBounds(t,n,o,r)},hide:function(e,t){e.hide(t)},isOpen:function(e,t){return e.isOpen(t)},getContent:function(e,t){return e.getContent(t)},setContent:function(e,t,n){e.setContent(t,n)},reposition:function(e,t){e.reposition(t)}}}),em=function(e,t,n){return Yu(xd(e,t),e.y,n.innerNorth(),uc(),Ku(e,{top:2}),"layout-inner-n")},tm=function(e,t,n){return Yu(xd(e,t),Cd(e,t),n.innerSouth(),ac(),Ku(e,{bottom:3}),"layout-inner-s")},nm=tinymce.util.Tools.resolve("tinymce.util.Delay"),om=zl({name:"Button",factory:function(e){function n(t){return ho(e.dom,"attributes").bind(function(e){return ho(e,t)})}var t=gd(e.action),o=e.dom.tag;return{uid:e.uid,dom:e.dom,components:e.components,events:t,behaviours:Dl(e.buttonBehaviours,[Fd.config({}),Rd.config({mode:"execution",useSpace:!0,useEnter:!0})]),domModification:{attributes:function(){if("button"!==o)return{role:n("role").getOr("button")};var e=n("type").getOr("button"),t=n("role").map(function(e){return{role:e}}).getOr({});return A({type:e},t)}()},eventOrder:e.eventOrder}},configFields:[Ze("uid",void 0),ze("dom"),Ze("components",[]),Tl("buttonBehaviours",[Fd,Rd]),Xe("action"),Xe("role"),Ze("eventOrder",{})]}),rm={success:"checkmark",error:"warning",err:"error",warning:"warning",warn:"warning",info:"info"},im=zl({name:"Notification",factory:function(t){function n(e){return{dom:{tag:"div",classes:["tox-bar"],attributes:{style:"width: "+e+"%"}}}}function o(e){return{dom:{tag:"div",classes:["tox-text"],innerHtml:e+"%"}}}var r,i=Ed({dom:{tag:"p",innerHtml:t.translationProvider(t.text)},behaviours:gc([Id.config({})])}),u=Ed({dom:{tag:"div",classes:t.progress?["tox-progress-bar","tox-progress-indicator"]:["tox-progress-bar"]},components:[{dom:{tag:"div",classes:["tox-bar-container"]},components:[n(0)]},o(0)],behaviours:gc([Id.config({})])}),e={updateProgress:function(e,t){e.getSystem().isConnected()&&u.getOpt(e).each(function(e){Id.set(e,[{dom:{tag:"div",classes:["tox-bar-container"]},components:[n(t)]},o(t)])})},updateText:function(e,t){e.getSystem().isConnected()&&(e=i.get(e),Id.set(e,[Qn(t)]))}},a=B([t.icon.toArray(),t.level.toArray(),t.level.bind(function(e){return G.from(rm[e])}).toArray()]),c=Ed(om.sketch({dom:{tag:"button",classes:["tox-notification__dismiss","tox-button","tox-button--naked","tox-button--icon"]},components:[{dom:{tag:"div",classes:["tox-icon"],innerHtml:Dd("close",t.iconProvider),attributes:{"aria-label":t.translationProvider("Close")}}}],action:function(e){t.onAction(e)}})),a=[{dom:{tag:"div",classes:["tox-notification__icon"],innerHtml:(r=t.iconProvider,P(a,function(e){return G.from(r()[e.toLowerCase()])}).getOrThunk(function(){return Td(r)}))}},{dom:{tag:"div",classes:["tox-notification__body"]},components:[i.asSpec()],behaviours:gc([Id.config({})])}];return{uid:t.uid,dom:{tag:"div",attributes:{role:"alert"},classes:t.level.map(function(e){return["tox-notification","tox-notification--in","tox-notification--"+e]}).getOr(["tox-notification","tox-notification--in"])},behaviours:gc([Fd.config({}),id("notification-events",[Et(Mr(),function(e){c.getOpt(e).each(Fd.focus)})])]),components:a.concat(t.progress?[u.asSpec()]:[]).concat(t.closeButton?[c.asSpec()]:[]),apis:e}},configFields:[Xe("level"),ze("progress"),ze("icon"),ze("onAction"),ze("text"),ze("iconProvider"),ze("translationProvider"),nr("closeButton",!0)],apis:{updateProgress:function(e,t,n){e.updateProgress(t,n)},updateText:function(e,t,n){e.updateText(t,n)}}});function um(e,u,a){var c=u.backstage;return{open:function(e,t){function n(){t(),Zd.hide(i)}var o=!e.closeButton&&e.timeout&&(0<e.timeout||e.timeout<0),r=uu(im.sketch({text:e.text,level:ne(["success","error","warning","warn","info"],e.type)?e.type:void 0,progress:!0===e.progressBar,icon:G.from(e.icon),closeButton:!o,onAction:n,iconProvider:c.shared.providers.icons,translationProvider:c.shared.providers.translate})),i=uu(Zd.sketch(A({dom:{tag:"div",classes:["tox-notifications-container"]},lazySink:u.backstage.shared.getSink,fireDismissalEventInstead:{}},c.shared.header.isPositionedAtTop()?{}:{fireRepositionEventInstead:{}})));return a.add(i),0<e.timeout&&nm.setTimeout(function(){n()},e.timeout),{close:n,moveTo:function(e,t){Zd.showAt(i,{anchor:"makeshift",x:e,y:t},au(r))},moveRel:function(e,t){var n;"banner"!==t?(n=function(e){switch(e){case"bc-bc":return tm;case"tc-tc":return em;case"tc-bc":return lc;default:return fc}}(t),e={anchor:"node",root:tu(),node:G.some(ir.fromDom(e)),layouts:{onRtl:function(){return[n]},onLtr:function(){return[n]}}},Zd.showAt(i,e,au(r))):Zd.showAt(i,u.backstage.shared.anchors.banner(),au(r))},text:function(e){im.updateText(r,e)},settings:e,getEl:function(){return r.element.dom},progressBar:{value:function(e){im.updateProgress(r,e)}}}},close:function(e){e.close()},reposition:function(e){var n;oe(e,function(e){return e.moveTo(0,0)}),0<(n=e).length&&(re(n).each(function(e){return e.moveRel(null,"banner")}),oe(n,function(e,t){0<t&&e.moveRel(n[t-1].getEl(),"bc-tc")}))},getArgs:function(e){return e.settings}}}function am(n,o){var r=null;return{cancel:function(){null!==r&&(clearTimeout(r),r=null)},throttle:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];null!==r&&clearTimeout(r),r=setTimeout(function(){n.apply(null,e),r=null},o)}}}function cm(n,e,t,o,r){var i=wm(n,function(e){return t=e,(e=n).isBlock(t)||ne(["BR","IMG","HR","INPUT"],t.nodeName)||"false"===e.getContentEditable(t);var t});return G.from(i.backwards(e,t,o,r))}function sm(n,t){return Cm(ir.fromDom(n.selection.getNode())).getOrThunk(function(){var e=ir.fromHtml('<span data-mce-autocompleter="1" data-mce-bogus="1"></span>',n.getDoc());return Ti(e,ir.fromDom(t.extractContents())),t.insertNode(e.dom),Vt(e).each(function(e){return e.dom.normalize()}),al(e,Uc).map(function(e){var t;n.selection.setCursorLocation(e.dom,"img"===Mt(t=e)?1:jc(t).fold(function(){return zt(t).length},function(e){return e.length}))}),e})}function lm(e){return e.toString().replace(/\u00A0/g," ").replace(/\uFEFF/g,"")}function fm(e){return""!==e&&-1!=="  \f\n\r\t\v".indexOf(e)}function dm(e,t){return e.substring(t.length)}function mm(e,n,o,r){if(void 0===r&&(r=0),!(t=n).collapsed||3!==t.startContainer.nodeType)return G.none();var t=e.getParent(n.startContainer,e.isBlock)||e.getRoot();return cm(e,n.startContainer,n.startOffset,function(e,t,n){return function(e,t,n){for(var o=t-1;0<=o;o--){var r=e.charAt(o);if(fm(r))return G.none();if(r===n)break}return G.some(o)}(n,t,o).getOr(t)},t).bind(function(e){var t=n.cloneRange();if(t.setStart(e.container,e.offset),t.setEnd(n.endContainer,n.endOffset),t.collapsed)return G.none();e=lm(t);return 0!==e.lastIndexOf(o)||dm(e,o).length<r?G.none():G.some({text:dm(e,o),range:t,triggerChar:o})})}function gm(n,e,o,t){return void 0===t&&(t=0),Cm(ir.fromDom(e.startContainer)).fold(function(){return mm(n,e,o,t)},function(e){var t=n.createRng();t.selectNode(e.dom);e=lm(t);return G.some({range:t,text:dm(e,o),triggerChar:o})})}function pm(e,t){return{container:e,offset:t}}function hm(t){return function(e){e=_m(e.startContainer,e.startOffset);return!cm(t,e.container,e.offset,function(e,t){return 0===t?-1:t},t.getRoot()).filter(function(e){e=e.container.data.charAt(e.offset-1);return!fm(e)}).isSome()}}function vm(t,n){var o,r,e=n(),i=t.selection.getRng();return o=t.dom,r=i,P(e.triggerChars,function(e){return gm(o,r,e)}).bind(function(e){return Em(t,n,e)})}function bm(e){return Fe("toolbarbutton",Bm,e)}function ym(e){return Fe("ToggleButton",Nm,e)}function xm(e){var t,n=e.ui.registry.getAll().popups,e=de(n,function(e){return Fe("Autocompleter",Am,e).fold(function(e){throw new Error(jo(e))},function(e){return e})}),n=(n=po(e,function(e){return e.ch}),t={},oe(n,function(e){t[e]={}}),lo(t)),o=pe(e);return{dataset:e,triggerChars:n,lookupByChar:function(t){return C(o,function(e){return e.ch===t})}}}var wm=tinymce.util.Tools.resolve("tinymce.dom.TextSeeker"),Cm=function(e){return Hu(e,"[data-mce-autocompleter]")},Sm=function(n,e){e.on("keypress compositionend",n.onKeypress.throttle),e.on("remove",n.onKeypress.cancel);function o(e,t){wt(e,Fr(),{raw:t})}e.on("keydown",function(t){function e(){return n.getView().bind(hf.getHighlighted)}8===t.which&&n.onKeypress.throttle(t),n.isActive()&&(27===t.which&&n.cancelIfNecessary(),n.isMenuOpen()?13===t.which?(e().each(Ct),t.preventDefault()):40===t.which?(e().fold(function(){n.getView().each(hf.highlightFirst)},function(e){o(e,t)}),t.preventDefault(),t.stopImmediatePropagation()):37!==t.which&&38!==t.which&&39!==t.which||e().each(function(e){o(e,t),t.preventDefault(),t.stopImmediatePropagation()}):13!==t.which&&38!==t.which&&40!==t.which||n.cancelIfNecessary())}),e.on("NodeChange",function(e){n.isActive()&&!n.isProcessingAction()&&Cm(ir.fromDom(e.element)).isNone()&&n.cancelIfNecessary()})},km=tinymce.util.Tools.resolve("tinymce.util.Promise"),Om=function(e){if(3===e.nodeType)return pm(e,e.data.length);var t=e.childNodes;return 0<t.length?Om(t[t.length-1]):pm(e,t.length)},_m=function(e,t){var n=e.childNodes;return 0<n.length&&t<n.length?_m(n[t],0):0<n.length&&1===e.nodeType&&n.length===t?Om(n[n.length-1]):pm(e,t)},Em=function(t,e,n,o){void 0===o&&(o={});var e=e(),r=t.selection.getRng().startContainer.nodeValue,e=C(e.lookupByChar(n.triggerChar),function(e){return n.text.length>=e.minChars&&e.matches.getOrThunk(function(){return hm(t.dom)})(n.range,r,n.text)});if(0===e.length)return G.none();e=km.all(S(e,function(t){return t.fetch(n.text,t.maxResults,o).then(function(e){return{matchText:n.text,items:e,columns:t.columns,onAction:t.onAction,highlightOn:t.highlightOn}})}));return G.some({lookupData:e,context:n})},Tm=No([Ue("type"),Je("text")]),Dm=No([Ze("type","autocompleteitem"),Ze("active",!1),Ze("disabled",!1),Ze("meta",{}),Ue("value"),Je("text"),Je("icon")]),Am=No([Ue("type"),Ue("ch"),er("minChars",1),Ze("columns",1),er("maxResults",10),Zo("matches"),Qo("fetch"),Qo("onAction"),or("highlightOn",[],$o)]),Mi=[nr("disabled",!1),Je("tooltip"),Je("icon"),Je("text"),nt("onSetup",function(){return W})],Bm=No([Ue("type"),Qo("onAction")].concat(Mi)),Ci=[nr("active",!1)].concat(Mi),Nm=No(Ci.concat([Ue("type"),Qo("onAction")])),pr=[nt("predicate",function(){return!1}),tr("scope","node",["node","editor"]),tr("position","selection",["node","selection","line"])],Ri=Mi.concat([Ze("type","contextformbutton"),Ze("primary",!1),Qo("onAction"),rt("original",l)]),Yi=Ci.concat([Ze("type","contextformbutton"),Ze("primary",!1),Qo("onAction"),rt("original",l)]),dr=Mi.concat([Ze("type","contextformbutton")]),gr=Ci.concat([Ze("type","contextformtogglebutton")]),t=Ve("type",{contextformbutton:Ri,contextformtogglebutton:Yi}),Rm=No([Ze("type","contextform"),nt("initValue",function(){return""}),Je("label"),$e("commands",t),Ye("launch",Ve("type",{contextformbutton:dr,contextformtogglebutton:gr}))].concat(pr)),Mm=No([Ze("type","contexttoolbar"),Ue("items")].concat(pr));(ec=Uv=Uv||{})[ec.CLOSE_ON_EXECUTE=0]="CLOSE_ON_EXECUTE",ec[ec.BUBBLE_TO_SANDBOX=1]="BUBBLE_TO_SANDBOX";function Im(e){return ho(hg,e).getOr(mg)}function Fm(e){return{backgroundMenu:"tox-background-menu",selectedMenu:"tox-selected-menu",selectedItem:"tox-collection__item--active",hasIcons:"tox-menu--has-icons",menu:"color"===e?"tox-swatches":"tox-menu",tieredMenu:"tox-tiered-menu"}}function Pm(e){var t=Fm(e);return{backgroundMenu:t.backgroundMenu,selectedMenu:t.selectedMenu,menu:t.menu,selectedItem:t.selectedItem,item:Im(e)}}function Lm(e,t,n){var o=Fm(n);return{dom:{tag:"div",classes:B([[o.tieredMenu]])},markers:Pm(n)}}function Vm(t,n){return function(e){e=x(e,n);return S(e,function(e){return{dom:t,components:e}})}}function Hm(e,n){var o=[],r=[];return oe(e,function(e,t){n(e,t)?(0<r.length&&o.push(r),r=[],vo(e.dom,"innerHtml")&&r.push(e)):r.push(e)}),0<r.length&&o.push(r),S(o,function(e){return{dom:{tag:"div",classes:["tox-collection__group"]},components:e}})}function zm(t,n,e){return{dom:{tag:"div",classes:["tox-menu","tox-collection"].concat(1===t?["tox-collection--list"]:["tox-collection--grid"])},components:[$d.parts.items({preprocess:function(e){return"auto"!==t&&1<t?Vm({tag:"div",classes:["tox-collection__group"]},t)(e):Hm(e,function(e,t){return"separator"===n[t].type})}})]}}function jm(e){return b(e,function(e){return"icon"in e&&void 0!==e.icon})}function Um(e){return console.error(jo(e)),console.log(e),G.none()}function Wm(e,t,n,o,r){var i,u=(i=n,{dom:{tag:"div",classes:["tox-collection","tox-collection--horizontal"]},components:[$d.parts.items({preprocess:function(e){return Hm(e,function(e,t){return"separator"===i[t].type})}})]});return{value:e,dom:u.dom,components:u.components,items:n}}function qm(e,t,n,o,r){var i;return"color"===r?{value:e,dom:(i=(i=o,{dom:{tag:"div",classes:["tox-menu","tox-swatches-menu"]},components:[{dom:{tag:"div",classes:["tox-swatches"]},components:[$d.parts.items({preprocess:"auto"!==i?Vm({tag:"div",classes:["tox-swatches__row"]},i):l})]}]})).dom,components:i.components,items:n}:"normal"===r&&"auto"===o?{value:e,dom:(i=zm(o,n)).dom,components:i.components,items:n}:"normal"===r&&1===o?{value:e,dom:(i=zm(1,n)).dom,components:i.components,items:n}:"normal"===r?{value:e,dom:(i=zm(o,n)).dom,components:i.components,items:n}:"listpreview"!==r||"auto"===o?{value:e,dom:function(e,t,n){n=Fm(n);return{tag:"div",classes:B([[n.menu,"tox-menu-"+t+"-column"],e?[n.hasIcons]:[]])}}(t,o,r),components:Sg,items:n}:{value:e,dom:(i={dom:{tag:"div",classes:["tox-menu","tox-collection","tox-collection--toolbar","tox-collection--toolbar-lg"]},components:[$d.parts.items({preprocess:Vm({tag:"div",classes:["tox-collection__group"]},o)})]}).dom,components:i.components,items:n}}function Gm(e,n,t){var o=Wc(e.element,"."+t);if(0<o.length){t=E(o,function(e){var t=e.dom.getBoundingClientRect().top,e=o[0].dom.getBoundingClientRect().top;return Math.abs(t-e)>n}).getOr(o.length);return G.some({numColumns:t,numRows:Math.ceil(o.length/t)})}return G.none()}function $m(e,t){return gc([id(e,t)])}function Xm(e,t,n){e.getSystem().broadcastOn([Mg],{})}function Ym(e,t,n){(t.disabled()?zg:jg)(e,t)}function Km(e,t){return!0===t.useNative&&ne(Hg,Mt(e.element))}function Jm(e){Qt(e.element,"disabled","disabled")}function Qm(e){nn(e.element,"disabled")}function Zm(e){Qt(e.element,"aria-disabled","true")}function eg(e){Qt(e.element,"aria-disabled","false")}function tg(e,t){return Km(e,t)?tn(e.element,"disabled"):"true"===Zt(e.element,"aria-disabled")}function ng(e){return e.getParam("height",Math.max(e.getElement().offsetHeight,200))}function og(e){return e.getParam("width",Lg.DOM.getStyle(e.getElement(),"width"))}function rg(e){return G.from(e.getParam("min_width")).filter(Q)}function ig(e){return G.from(e.getParam("min_height")).filter(Q)}function ug(e){return G.from(e.getParam("max_width")).filter(Q)}function ag(e){return G.from(e.getParam("max_height")).filter(Q)}function cg(e){return!1!==e.getParam("menubar",!0,"boolean")}function sg(e){var t=!0===(o=e.getParam("toolbar",!0)),n=U(o),o=X(o)&&0<o.length;return!qg(e)&&(o||n||t)}function lg(t){var e=y(9,function(e){return t.getParam("toolbar"+(e+1),!1,"string")});return 0<(e=C(e,function(e){return"string"==typeof e})).length?G.some(e):G.none()}var fg,dg=Uv,mg="tox-menu-nav__js",gg="tox-collection__item",pg="tox-swatch",hg={normal:mg,color:pg},vg="tox-collection__item--enabled",bg="tox-collection__item-label",yg="tox-collection__item-caret",xg="tox-collection__item--active",wg="tox-collection__item-container",Cg="tox-collection__item-container--row",Sg=[$d.parts.items({})],xl=[Ue("type"),Ue("src"),Je("alt"),or("classes",[],$o)],kg=No(xl),Ur=[Ue("type"),Ue("text"),Je("name"),or("classes",["tox-collection__item-label"],$o)],Og=No(Ur),si=Ho(function(){return Uo("type",{cardimage:kg,cardtext:Og,cardcontainer:_g})}),_g=No([Ue("type"),tt("direction","horizontal"),tt("align","left"),tt("valign","middle"),$e("items",si)]),Ci=[nr("disabled",!1),Je("text"),Je("shortcut"),Po("value","value",_o(function(){return un("menuitem-value")}),Wo()),Ze("meta",{})],Eg=No([Ue("type"),Je("label"),$e("items",si),nt("onSetup",function(){return W}),nt("onAction",W)].concat(Ci)),Tg=No([Ue("type"),nr("active",!1),Je("icon")].concat(Ci)),Dg=No([Ue("type"),We("fancytype",["inserttable","colorswatch"]),nt("onAction",W)]),Ag=No([Ue("type"),nt("onSetup",function(){return W}),nt("onAction",W),Je("icon")].concat(Ci)),Bg=No([Ue("type"),Qo("getSubmenuItems"),nt("onSetup",function(){return W}),Je("icon")].concat(Ci)),Ng=No([Ue("type"),Je("icon"),nr("active",!1),nt("onSetup",function(){return W}),Qo("onAction")].concat(Ci)),Rg=function(e){return $m(un("unnamed-events"),e)},Ri=[ze("lazySink"),ze("tooltipDom"),Ze("exclusive",!0),Ze("tooltipComponents",[]),Ze("delay",300),tr("mode","normal",["normal","follow-highlight"]),Ze("anchor",function(e){return{anchor:"hotspot",hotspot:e,layouts:{onLtr:q([fc,lc,oa,ia,ra,ua]),onRtl:q([fc,lc,oa,ia,ra,ua])}}}),Ka("onHide"),Ka("onShow")],Yi=Object.freeze({__proto__:null,init:function(){function n(){o.get().each(function(e){clearTimeout(e)})}var o=it(G.none()),t=it(G.none()),e=q("not-implemented");return qi({getTooltip:function(){return t.get()},isShowing:function(){return t.get().isSome()},setTooltip:function(e){t.set(G.some(e))},clearTooltip:function(){t.set(G.none())},clearTimer:n,resetTimer:function(e,t){n(),o.set(G.some(setTimeout(function(){e()},t)))},readState:e})}}),Mg=un("tooltip.exclusive"),Ig=un("tooltip.show"),Fg=un("tooltip.hide"),Pg=ya({fields:Ri,name:"tooltipping",active:Object.freeze({__proto__:null,events:function(r,i){function n(t){i.getTooltip().each(function(e){ws(e),r.onHide(t,e),i.clearTooltip()}),i.clearTimer()}return vi(B([[Et(Ig,function(o){i.resetTimer(function(){var t,e,n;t=o,i.isShowing()||(Xm(t),e=r.lazySink(t).getOrDie(),n=t.getSystem().build({dom:r.tooltipDom,components:r.tooltipComponents,events:vi("normal"===r.mode?[Et(Rr(),function(e){xt(t,Ig)}),Et(Br(),function(e){xt(t,Fg)})]:[]),behaviours:gc([Id.config({})])}),i.setTooltip(n),ys(e,n),r.onShow(t,n),ml.position(e,r.anchor(t),n))},r.delay)}),Et(Fg,function(e){i.resetTimer(function(){n(e)},r.delay)}),Et(Xr(),function(e,t){t.universal||ne(t.channels,Mg)&&n(e)}),yi(function(e){n(e)})],"normal"===r.mode?[Et(Mr(),function(e){xt(e,Ig)}),Et(Gr(),function(e){xt(e,Fg)}),Et(Rr(),function(e){xt(e,Ig)}),Et(Br(),function(e){xt(e,Fg)})]:[Et(gi(),function(e,t){xt(e,Ig)}),Et(pi(),function(e){xt(e,Fg)})]]))}}),state:Yi,apis:Object.freeze({__proto__:null,hideAllExclusive:Xm,setComponents:function(e,t,n,o){n.getTooltip().each(function(e){e.getSystem().isConnected()&&Id.set(e,o)})}})}),Lg=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),Vg=tinymce.util.Tools.resolve("tinymce.util.I18n"),Hg=["input","button","textarea","select"],zg=function(t,e,n){e.disableClass.each(function(e){kn(t.element,e)}),(Km(t,e)?Jm:Zm)(t),e.onDisabled(t)},jg=function(t,e,n){e.disableClass.each(function(e){_n(t.element,e)}),(Km(t,e)?Qm:eg)(t),e.onEnabled(t)},t=Object.freeze({__proto__:null,enable:jg,disable:zg,isDisabled:tg,onLoad:Ym,set:function(e,t,n,o){(o?zg:jg)(e,t)}}),dr=Object.freeze({__proto__:null,exhibit:function(e,t){return dn({classes:t.disabled()?t.disableClass.toArray():[]})},events:function(n,e){return vi([Ot(Yr(),function(e,t){return tg(e,n)}),pa(n,e,Ym)])}}),gr=[nt("disabled",c),Ze("useNative",!0),Xe("disableClass"),Ka("onDisabled"),Ka("onEnabled")],Ug=ya({fields:gr,name:"disabling",active:dr,apis:t}),Wg=tinymce.util.Tools.resolve("tinymce.EditorManager"),qg=function(e){return lg(e).fold(function(){return 0<e.getParam("toolbar",[],"string[]").length},function(){return!0})};(pr=fg=fg||{}).default="wrap",pr.floating="floating",pr.sliding="sliding",pr.scrolling="scrolling";function Gg(e){return e.getParam("toolbar_mode","","string")}var $g;(ec=$g=$g||{}).auto="auto",ec.top="top",ec.bottom="bottom";function Xg(e){return e.getParam("toolbar_location",$g.auto,"string")}function Yg(e){return Xg(e)===$g.bottom}function Kg(e){var t=e.getParam("fixed_toolbar_container","","string");return 0<t.length&&e.inline?Vu(tu(),t):G.none()}function Jg(e){return e.inline&&Kg(e).isSome()}function Qg(e){return Kg(e).getOrThunk(function(){return Nn(Ji(ir.fromDom(e.getElement())))})}function Zg(e){return e.inline&&!cg(e)&&!sg(e)&&!qg(e)}function ep(e){return(e.getParam("toolbar_sticky",!1,"boolean")||e.inline)&&!Jg(e)&&!Zg(e)}function tp(e,t){var n=e.outerContainer.element;t&&(e.mothership.broadcastOn([Cl()],{target:n}),e.uiMothership.broadcastOn([Cl()],{target:n})),e.mothership.broadcastOn([Np],{readonly:t}),e.uiMothership.broadcastOn([Np],{readonly:t})}function np(e,t){e.on("init",function(){e.mode.isReadOnly()&&tp(t,!0)}),e.on("SwitchMode",function(){return tp(t,e.mode.isReadOnly())}),e.getParam("readonly",!1,"boolean")&&e.setMode("readonly")}function op(){var e;return bc.config({channels:((e={})[Np]={schema:Rp,onReceive:function(e,t){Ug.set(e,t.readonly)}},e)})}function rp(e,t){var n=e.getApi(t);return function(e){e(n)}}function ip(t,n){return bi(function(e){rp(t,e)(function(e){e=t.onSetup(e);null!=e&&n.set(e)})})}function up(t,n){return yi(function(e){return rp(t,e)(n.get())})}function ap(e){return T(e,function(e){return e.toArray()})}function cp(e,t,n,o){var r,i,u=it(W);return{type:"item",dom:t.dom,components:ap(t.optComponents),data:e.data,eventOrder:Lp,hasSubmenu:e.triggersSubmenu,itemBehaviours:gc([id("item-events",[(r=e,i=n,wi(function(e,t){rp(r,e)(r.onAction),r.triggersSubmenu||i!==dg.CLOSE_ON_EXECUTE||(xt(e,Zr()),t.stop())})),ip(e,u),up(e,u)]),Mp(function(){return e.disabled||o.isDisabled()}),op(),Id.config({})].concat(e.itemBehaviours))}}function sp(e){return{value:e.value,meta:A({text:e.text.getOr("")},e.meta)}}function lp(e){return{dom:{tag:"div",classes:["tox-collection__item-icon"],innerHtml:e}}}function fp(e){return{dom:{tag:"div",classes:[bg]},components:[Qn(Vg.translate(e))]}}function dp(e,t){return{dom:{tag:"div",classes:t,innerHtml:e}}}function mp(e,t){return{dom:{tag:"div",classes:[bg]},components:[{dom:{tag:e.tag,styles:e.styles},components:[Qn(Vg.translate(t))]}]}}function gp(e){return{dom:{tag:"div",classes:["tox-collection__item-accessory"],innerHtml:(e=e,n=Vp.mac?{alt:"&#x2325;",ctrl:"&#x2303;",shift:"&#x21E7;",meta:"&#x2318;",access:"&#x2303;&#x2325;"}:{meta:"Ctrl",access:"Shift+Alt"},e=e.split("+"),e=S(e,function(e){var t=e.toLowerCase().trim();return vo(n,t)?n[t]:e}),Vp.mac?e.join(""):e.join("+"))}};var n}function pp(e){return{dom:{tag:"div",classes:["tox-collection__item-checkmark"],innerHtml:Dd("checkmark",e)}}}function hp(e,t){return t=t.map(function(e){return{attributes:{title:Vg.translate(e)}}}).getOr({}),A({tag:"div",classes:[mg,gg].concat(e?["tox-collection__item-icon-rtl"]:[])},t)}function vp(e,o,t,r){void 0===r&&(r=G.none());var n,i,u,a,c,s,l=Vg.isRtl()&&e.iconContent.exists(function(e){return ne(zp,e)}),f=e.iconContent.map(function(e){return Vg.isRtl()&&ne(Hp,e)?e+"-rtl":e}).map(function(e){return t=e,n=o.icons,e=r,G.from(n()[t.toLowerCase()]).or(e).getOrThunk(function(){return Td(n)});var t,n}),d=G.from(e.meta).fold(function(){return fp},function(e){return vo(e,"style")?m(mp,e.style):fp});return"color"===e.presets?(s=e.ariaLabel,u=e.value,a=o,{dom:(c=f.getOr(""),s={tag:"div",attributes:s.map(function(e){return{title:a.translate(e)}}).getOr({}),classes:["tox-swatch"]},A(A({},s),"custom"===u?{tag:"button",classes:h(s.classes,["tox-swatches__picker-btn"]),innerHtml:c}:"remove"===u?{classes:h(s.classes,["tox-swatch--remove"]),innerHtml:c}:{attributes:A(A({},s.attributes),{"data-mce-color":u}),styles:{"background-color":u}})),optComponents:[]}):(n=e,f=f,i=d,d=l,t=(l=t)?f.or(G.some("")).map(lp):G.none(),l=n.checkMark,f=n.htmlContent.fold(function(){return n.textContent.map(i)},function(e){return G.some(dp(e,[bg]))}),{dom:hp(d,n.ariaLabel),optComponents:[t,f,n.shortcutContent.map(gp),l,n.caret]})}function bp(e,t){return ho(e,"tooltipWorker").map(function(n){return[Pg.config({lazySink:t.getSink,tooltipDom:{tag:"div",classes:["tox-tooltip-worker-container"]},tooltipComponents:[],anchor:function(e){return{anchor:"submenu",item:e,overrides:{maxHeightFunction:Oc}}},mode:"follow-highlight",onShow:function(t,e){n(function(e){Pg.setComponents(t,[ru({element:ir.fromDom(e)})])})}})]}).getOr([])}function yp(e,t){if(e=Vg.translate(e),e=Lg.DOM.encode(e),0<t.length){t=new RegExp(t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"gi");return e.replace(t,function(e){return'<span class="tox-autocompleter-highlight">'+e+"</span>"})}return e}function xp(e){return{value:e}}function wp(e){return Up.test(e)||Wp.test(e)}function Cp(e){return e={value:e.value.replace(Up,function(e,t,n,o){return t+t+n+n+o+o})},null===(e=Wp.exec(e.value))?["FFFFFF","FF","FF","FF"]:e}function Sp(e){return 1===(e=e.toString(16)).length?"0"+e:e}function kp(e){return e=Sp(e.red)+Sp(e.green)+Sp(e.blue),xp(e)}function Op(e,t,n,o){return{red:e,green:t,blue:n,alpha:o}}function _p(e){var t=parseInt(e,10);return t.toString()===e&&0<=t&&t<=255}function Ep(e){var t,n,o,r=(e.hue||0)%360,i=e.saturation/100,e=e.value/100,i=Gp(0,qp(i,1)),e=Gp(0,qp(e,1));if(0===i)return t=n=o=$p(255*e),Op(t,n,o,1);var r=r/60,u=e*i,a=u*(1-Math.abs(r%2-1)),e=e-u;switch(Math.floor(r)){case 0:t=u,n=a,o=0;break;case 1:t=a,n=u,o=0;break;case 2:t=0,n=u,o=a;break;case 3:t=0,n=a,o=u;break;case 4:t=a,n=0,o=u;break;case 5:t=u,n=0,o=a;break;default:t=n=o=0}return t=$p(255*(t+e)),n=$p(255*(n+e)),o=$p(255*(o+e)),Op(t,n,o,1)}function Tp(e){var t=Cp(e),n=parseInt(t[1],16),e=parseInt(t[2],16),t=parseInt(t[3],16);return Op(n,e,t,1)}function Dp(e,t,n,o){return e=parseInt(e,10),t=parseInt(t,10),n=parseInt(n,10),o=parseFloat(o),Op(e,t,n,o)}function Ap(e){return"rgba("+e.red+","+e.green+","+e.blue+","+e.alpha+")"}function Bp(e,t){return e.fire("ResizeContent",t)}var Np="silver.readonly",Rp=No([je("readonly",Xo)]),Mp=function(e){return Ug.config({disabled:e,disableClass:"tox-collection__item--state-disabled"})},Ip=function(e){return Ug.config({disabled:e})},Fp=function(e){return Ug.config({disabled:e,disableClass:"tox-tbtn--disabled"})},Pp=function(e){return Ug.config({disabled:e,disableClass:"tox-tbtn--disabled",useNative:!1})},Lp=((Uv={})[Yr()]=["disabling","alloy.base.behaviour","toggling","item-events"],Uv),Vp=tinymce.util.Tools.resolve("tinymce.Env"),Hp=["list-num-default","list-num-lower-alpha","list-num-lower-greek","list-num-lower-roman","list-num-upper-alpha","list-num-upper-roman"],zp=["list-bull-circle","list-bull-default","list-bull-square"],jp=Hs(vd(),Wd()),Up=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,Wp=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i,qp=Math.min,Gp=Math.max,$p=Math.round,Xp=/^rgb\((\d+),\s*(\d+),\s*(\d+)\)/,Yp=/^rgba\((\d+),\s*(\d+),\s*(\d+),\s*(\d?(?:\.\d+)?)\)/,Kp=Op(255,0,0,1),Jp=tinymce.util.Tools.resolve("tinymce.util.LocalStorage"),Qp="tinymce-custom-colors";function Zp(e){var t=[],r=document.createElement("canvas");r.height=1,r.width=1;for(var i=r.getContext("2d"),u=function(e,t){t/=255;return("0"+Math.round(e*t+255*(1-t)).toString(16)).slice(-2).toUpperCase()},n=0;n<e.length;n+=2)t.push({text:e[n+1],value:function(e){if(/^[0-9A-Fa-f]{6}$/.test(e))return"#"+e.toUpperCase();i.clearRect(0,0,r.width,r.height),i.fillStyle="#FFFFFF",i.fillStyle=e,i.fillRect(0,0,1,1);var t=i.getImageData(0,0,1,1).data,n=t[0],o=t[1],e=t[2],t=t[3];return"#"+u(n,t)+u(o,t)+u(e,t)}(e[n]),type:"choiceitem"});return t}function eh(e){return!1!==e.getParam("custom_colors")}function th(e){return void 0!==(e=e.getParam("color_map"))?Zp(e):gh}function nh(e){ph.add(e)}function oh(i){i.addCommand("mceApplyTextcolor",function(e,t){var n,o,r;o=e,r=t,(n=i).undoManager.transact(function(){n.focus(),n.formatter.apply(o,{value:r}),n.nodeChanged()})}),i.addCommand("mceRemoveTextcolor",function(e){var t,n;n=e,(t=i).undoManager.transact(function(){t.focus(),t.formatter.remove(n,{value:null},null,!0),t.nodeChanged()})})}function rh(e){var t=(t=(t=th(e)).length,Math.max(5,Math.ceil(Math.sqrt(t))));return e.getParam("color_cols",t,"number")}function ih(t,n,e,o){"custom"===e?hh(t)(function(e){e.each(function(e){nh(e),t.execCommand("mceApplyTextcolor",n,e),o(e)})},"#000000"):"remove"===e?(o(""),t.execCommand("mceRemoveTextcolor",n)):(o(e),t.execCommand("mceApplyTextcolor",n,e))}function uh(e,t){return e.concat(S(ph.state(),function(e){return{type:mh,text:e,value:e}}).concat((e={type:n="choiceitem",text:"Remove color",icon:"color-swatch-remove-color",value:"remove"},t?[e,{type:n,text:"Custom color",icon:"color-picker",value:"custom"}]:[e])));var n}function ah(t,n){return function(e){e(uh(t,n))}}function ch(e,t,n){t="forecolor"===t?"tox-icon-text-color__color":"tox-icon-highlight-bg-color__color",n=n,e.setIconFill(t,n),e.setIconStroke(t,n)}function sh(r,n,i,e,o){r.ui.registry.addSplitButton(n,{tooltip:e,presets:"color",icon:"forecolor"===n?"text-color":"highlight-bg-color",select:function(t){var n,o;return G.from((n=i,r.dom.getParents(r.selection.getStart(),function(e){(e=e.style["forecolor"===n?"color":"background-color"])&&(o=o||e)}),o)).bind(function(e){return function(e){if("transparent"===e)return G.some(Op(0,0,0,0));var t=Xp.exec(e);if(null!==t)return G.some(Dp(t[1],t[2],t[3],"1"));e=Yp.exec(e);return null!==e?G.some(Dp(e[1],e[2],e[3],e[4])):G.none()}(e).map(function(e){e=kp(e).value;return at(t.toLowerCase(),e)})}).getOr(!1)},columns:rh(r),fetch:ah(th(r),eh(r)),onAction:function(e){null!==o.get()&&ih(r,i,o.get(),function(){})},onItemAction:function(e,t){ih(r,i,t,function(e){o.set(e),e={name:n,color:e},r.fire("TextColorChange",e)})},onSetup:function(t){null!==o.get()&&ch(t,n,o.get());function e(e){e.name===n&&ch(t,e.name,e.color)}return r.on("TextColorChange",e),function(){r.off("TextColorChange",e)}}})}function lh(t,e,n,o){t.ui.registry.addNestedMenuItem(e,{text:o,icon:"forecolor"===e?"text-color":"highlight-bg-color",getSubmenuItems:function(){return[{type:"fancymenuitem",fancytype:"colorswatch",onAction:function(e){ih(t,n,e.value,W)}}]}})}function fh(e,t,n,o,r,i,u,a){var c=jm(t),a=vh(t,n,o,"color"!==r?"normal":"color",i,u,a);return qm(e,c,a,o,r)}function dh(e,t){var n=Pm(t);return 1===e?{mode:"menu",moveOnTab:!0}:"auto"===e?{mode:"grid",selector:"."+n.item,initSize:{numColumns:1,numRows:1}}:{mode:"matrix",rowSelector:"."+("color"===t?"tox-swatches__row":"tox-collection__group")}}var mh="choiceitem",gh=[{type:mh,text:"Light Green",value:"#BFEDD2"},{type:mh,text:"Light Yellow",value:"#FBEEB8"},{type:mh,text:"Light Red",value:"#F8CAC6"},{type:mh,text:"Light Purple",value:"#ECCAFA"},{type:mh,text:"Light Blue",value:"#C2E0F4"},{type:mh,text:"Green",value:"#2DC26B"},{type:mh,text:"Yellow",value:"#F1C40F"},{type:mh,text:"Red",value:"#E03E2D"},{type:mh,text:"Purple",value:"#B96AD9"},{type:mh,text:"Blue",value:"#3598DB"},{type:mh,text:"Dark Turquoise",value:"#169179"},{type:mh,text:"Orange",value:"#E67E23"},{type:mh,text:"Dark Red",value:"#BA372A"},{type:mh,text:"Dark Purple",value:"#843FA1"},{type:mh,text:"Dark Blue",value:"#236FA1"},{type:mh,text:"Light Gray",value:"#ECF0F1"},{type:mh,text:"Medium Gray",value:"#CED4D9"},{type:mh,text:"Gray",value:"#95A5A6"},{type:mh,text:"Dark Gray",value:"#7E8C8D"},{type:mh,text:"Navy Blue",value:"#34495E"},{type:mh,text:"Black",value:"#000000"},{type:mh,text:"White",value:"#ffffff"}],ph=function(t){void 0===t&&(t=10);var e=Jp.getItem(Qp),e=U(e)?JSON.parse(e):[],n=t-(e=e).length<0?e.slice(0,t):e,o=function(e){n.splice(e,1)};return{add:function(e){!function(e,t){t=g(e,t);return-1===t?G.none():G.some(t)}(n,e).each(o),n.unshift(e),n.length>t&&n.pop(),Jp.setItem(Qp,JSON.stringify(n))},state:function(){return n.slice(0)}}}(10),hh=function(r){return function(e,t){var n,o=(n=e,function(e){var t=e.getData();n(G.from(t.colorpicker)),e.close()});r.windowManager.open({title:"Color Picker",size:"normal",body:{type:"panel",items:[{type:"colorpicker",name:"colorpicker",label:"Color"}]},buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:{colorpicker:t},onAction:function(e,t){"hex-valid"===t.name&&(t.value?e.enable("ok"):e.disable("ok"))},onSubmit:o,onClose:function(){},onCancel:function(){e(G.none())}})}},vh=function(n,o,r,i,u,a,c){return jl(S(n,function(t){return"choiceitem"===t.type?Fe("choicemenuitem",Tg,t).fold(Um,function(e){return G.some(function(t,e,n,o,r,i,u,a){void 0===a&&(a=!0);a=vp({presets:n,textContent:e?t.text:G.none(),htmlContent:G.none(),ariaLabel:t.text,iconContent:t.icon,shortcutContent:e?t.shortcut:G.none(),checkMark:e?G.some(pp(u.icons)):G.none(),caret:G.none(),value:t.value},u,a);return wo(cp({data:sp(t),disabled:t.disabled,getApi:function(t){return{setActive:function(e){Vd.set(t,e)},isActive:function(){return Vd.isOn(t)},isDisabled:function(){return Ug.isDisabled(t)},setDisabled:function(e){return Ug.set(t,e)}}},onAction:function(e){return o(t.value)},onSetup:function(e){return e.setActive(r),function(){}},triggersSubmenu:!1,itemBehaviours:[]},a,i,u),{toggling:{toggleClass:vg,toggleOnExecute:!1,selected:t.active}})}(e,1===r,i,o,a(t.value),u,c,jm(n)))}):G.none()}))};function bh(t,n,e){function o(e){return wt(e,wh,{row:t,col:n})}function r(e,t){t.stop(),o(e)}var i;return uu({dom:{tag:"div",attributes:((i={role:"button"})["aria-labelledby"]=e,i)},behaviours:gc([id("insert-table-picker-cell",[Et(Rr(),Fd.focus),Et(Yr(),o),Et(Hr(),r),Et(Jr(),r)]),Vd.config({toggleClass:"tox-insert-table-picker__selected",toggleOnExecute:!1}),Fd.config({onFocus:function(e){return wt(e,xh,{row:t,col:n})}})])})}var yh,xh=un("cell-over"),wh=un("cell-execute"),Ch={inserttable:function(o){var e=un("size-label"),r=function(e,t,n){for(var o=[],r=0;r<t;r++){for(var i=[],u=0;u<n;u++)i.push(bh(r,u,e));o.push(i)}return o}(e,10,10),i=Ed({dom:{tag:"span",classes:["tox-insert-table-picker__label"],attributes:{id:e}},components:[Qn("0x0")],behaviours:gc([Id.config({})])});return{type:"widget",data:{value:un("widget-id")},dom:{tag:"div",classes:["tox-fancymenuitem"]},autofocus:!0,components:[jp.widget({dom:{tag:"div",classes:["tox-insert-table-picker"]},components:T(r,function(e){return S(e,au)}).concat(i.asSpec()),behaviours:gc([id("insert-table-picker",[Bt(xh,function(e,t,n){var o=n.event.row,n=n.event.col;!function(e,t,n,o,r){for(var i=0;i<o;i++)for(var u=0;u<r;u++)Vd.set(e[i][u],i<=t&&u<=n)}(r,o,n,10,10),Id.set(i.get(e),[Qn(n+1+"x"+(o+1))])}),Bt(wh,function(e,t,n){o.onAction({numRows:n.event.row+1,numColumns:n.event.col+1}),xt(e,Zr())})]),Rd.config({initSize:{numRows:10,numColumns:10},mode:"flatgrid",selector:'[role="button"]'})])})]}},colorswatch:function(t,e){var n=uh(e.colorinput.getColors(),e.colorinput.hasCustomColors()),o=e.colorinput.getColorCols(),e=fh(un("menu-value"),n,function(e){t.onAction({value:e})},o,"color",dg.CLOSE_ON_EXECUTE,function(){return!1},e.shared.providers),o=A(A({},e),{markers:Pm("color"),movement:dh(o,"color")});return{type:"widget",data:{value:un("widget-id")},dom:{tag:"div",classes:["tox-fancymenuitem"]},autofocus:!0,components:[jp.widget($d.sketch(o))]}}},Sh=function(e,u){return S(e,function(e){switch(e.type){case"cardcontainer":return o=Sh((n=e).items,u),r="vertical"===n.direction?"tox-collection__item-container--column":Cg,i="left"===n.align?"tox-collection__item-container--align-left":"tox-collection__item-container--align-right",{dom:{tag:"div",classes:[wg,r,i,function(){switch(n.valign){case"top":return"tox-collection__item-container--valign-top";case"middle":return"tox-collection__item-container--valign-middle";case"bottom":return"tox-collection__item-container--valign-bottom"}}()]},components:o};case"cardimage":return i=e.src,o=e.classes,t=e.alt,{dom:{tag:"img",classes:o,attributes:{src:i,alt:t.getOr("")}}};case"cardtext":t=e.name.exists(function(e){return ne(u.cardText.highlightOn,e)})?G.from(u.cardText.matchText).getOr(""):"";return dp(yp(e.text,t),e.classes)}var t,n,o,r,i})},kh=function(t,n,e,o,r,i,u,a){void 0===a&&(a=!0);a=vp({presets:o,textContent:G.none(),htmlContent:e?t.text.map(function(e){return yp(e,n)}):G.none(),ariaLabel:t.text,iconContent:t.icon,shortcutContent:G.none(),checkMark:G.none(),caret:G.none(),value:t.value},u.providers,a,t.icon);return cp({data:sp(t),disabled:t.disabled,getApi:function(){return{}},onAction:function(e){return r(t.value,t.meta)},onSetup:function(){return function(){}},triggersSubmenu:!1,itemBehaviours:bp(t.meta,u)},a,i,u.providers)},Oh=function(e){e=e.text.fold(function(){return{}},function(e){return{innerHtml:e}});return{type:"separator",dom:A({tag:"div",classes:[gg,"tox-collection__group-heading"]},e),components:[]}},_h=function(e,t,n,o){void 0===o&&(o=!0);o=vp({presets:"normal",iconContent:e.icon,textContent:e.text,htmlContent:G.none(),ariaLabel:e.text,caret:G.none(),checkMark:G.none(),shortcutContent:e.shortcut},n,o);return cp({data:sp(e),getApi:function(t){return{isDisabled:function(){return Ug.isDisabled(t)},setDisabled:function(e){return Ug.set(t,e)}}},disabled:e.disabled,onAction:e.onAction,onSetup:e.onSetup,triggersSubmenu:!1,itemBehaviours:[]},o,t,n)},Eh=function(e,t,n,o,r){void 0===o&&(o=!0);var i,i=(r=void 0===r?!1:r)?(r=n.icons,{dom:{tag:"div",classes:[yg],innerHtml:Dd("chevron-down",r)}}):(i=n.icons,{dom:{tag:"div",classes:[yg],innerHtml:Dd("chevron-right",i)}}),o=vp({presets:"normal",iconContent:e.icon,textContent:e.text,htmlContent:G.none(),ariaLabel:e.text,caret:G.some(i),checkMark:G.none(),shortcutContent:e.shortcut},n,o);return cp({data:sp(e),getApi:function(t){return{isDisabled:function(){return Ug.isDisabled(t)},setDisabled:function(e){return Ug.set(t,e)}}},disabled:e.disabled,onAction:W,onSetup:e.onSetup,triggersSubmenu:!0,itemBehaviours:[]},o,t,n)},Th=function(e,t,n,o){void 0===o&&(o=!0);o=vp({iconContent:e.icon,textContent:e.text,htmlContent:G.none(),ariaLabel:e.text,checkMark:G.some(pp(n.icons)),caret:G.none(),shortcutContent:e.shortcut,presets:"normal",meta:e.meta},n,o);return wo(cp({data:sp(e),disabled:e.disabled,getApi:function(t){return{setActive:function(e){Vd.set(t,e)},isActive:function(){return Vd.isOn(t)},isDisabled:function(){return Ug.isDisabled(t)},setDisabled:function(e){return Ug.set(t,e)}}},onAction:e.onAction,onSetup:e.onSetup,triggersSubmenu:!1,itemBehaviours:[]},o,t,n),{toggling:{toggleClass:vg,toggleOnExecute:!1,selected:e.active}})},Dh=function(t,n){return e=Ch,o=t.fancytype,(Object.prototype.hasOwnProperty.call(e,o)?G.some(e[o]):G.none()).map(function(e){return e(t,n)});var e,o},Ah=function(e,t,n,o){var r={dom:hp(!1,e.label),optComponents:[G.some({dom:{tag:"div",classes:[wg,Cg]},components:Sh(e.items,o)})]};return cp({data:sp(A({text:G.none()},e)),disabled:e.disabled,getApi:function(n){return{isDisabled:function(){return Ug.isDisabled(n)},setDisabled:function(t){Ug.set(n,t),oe(Wc(n.element,"*"),function(e){n.getSystem().getByDom(e).each(function(e){e.hasConfigured(Ug)&&Ug.set(e,t)})})}}},onAction:e.onAction,onSetup:e.onSetup,triggersSubmenu:!1,itemBehaviours:G.from(o.itemBehaviours).getOr([])},r,t,n.providers)};(xl=yh=yh||{})[xl.ContentFocus=0]="ContentFocus",xl[xl.UiFocus=1]="UiFocus";function Bh(e,t,n,o,r){function i(e){return r?A(A({},e),{shortcut:G.none(),icon:e.text.isSome()?G.none():e.icon}):e}var u=n.shared.providers;switch(e.type){case"menuitem":return Fe("menuitem",Ag,e).fold(Um,function(e){return G.some(_h(i(e),t,u,o))});case"nestedmenuitem":return Fe("nestedmenuitem",Bg,e).fold(Um,function(e){return G.some(Eh(i(e),t,u,o,r))});case"togglemenuitem":return Fe("togglemenuitem",Ng,e).fold(Um,function(e){return G.some(Th(i(e),t,u,o))});case"separator":return Fe("separatormenuitem",Tm,e).fold(Um,function(e){return G.some(Oh(e))});case"fancymenuitem":return Fe("fancymenuitem",Dg,e).fold(Um,function(e){return Dh(i(e),n)});default:return console.error("Unknown item in general menu",e),G.none()}}function Nh(e,n,o,t,r,i,u){var a=1===t,c=!a||jm(e);return jl(S(e,function(e){switch(e.type){case"separator":return Fe("Autocompleter.Separator",Tm,e).fold(Um,function(e){return G.some(Oh(e))});case"cardmenuitem":return Fe("cardmenuitem",Eg,e).fold(Um,function(t){return G.some(Ah(A(A({},t),{onAction:function(e){t.onAction(e),o(t.value,t.meta)}}),r,i,{itemBehaviours:bp(t.meta,i),cardText:{matchText:n,highlightOn:u}}))});default:return Fe("Autocompleter.Item",Dm,e).fold(Um,function(e){return G.some(kh(e,n,a,"normal",o,r,i,c))})}}))}function Rh(e,t,n,o,r){var i=jm(t),t=jl(S(t,function(e){function t(e){return Bh(e,n,o,(e=e,r?!e.hasOwnProperty("text"):i),r)}return"nestedmenuitem"===e.type&&e.getSubmenuItems().length<=0?t(A(A({},e),{disabled:!0})):t(e)}));return(r?Wm:qm)(e,i,t,1,"normal")}function Mh(e){return Qd.singleData(e.value,e)}function Ih(e,t,n){return hu(e,t,Vh,n,!1)}function Fh(e,t,n){return hu(e,t,Vh,n,!0)}function Ph(e,t,n){return Hu(e,t,n).isSome()}var Lh=function(a,c){function n(){return o.get().isSome()}function s(){n()&&Zd.hide(d)}function l(e,t,n,o){e.matchLength=t.text.length;var r,i,u=P(n,function(e){return G.from(e.columns)}).getOr(1);Zd.showAt(d,{anchor:"node",root:ir.fromDom(a.getBody()),node:G.from(e.element)},$d.sketch((r=qm("autocompleter-value",!0,o,u,"normal"),t=u,n=yh.ContentFocus,e="normal",o=(n===yh.ContentFocus?uf:rf)(),u=dh(t,e),i=Pm(e),{dom:r.dom,components:r.components,items:r.items,value:r.value,markers:{selectedItem:i.selectedItem,item:i.item},movement:u,fakeFocus:n===yh.ContentFocus,focusManager:o,menuBehaviours:Rg("auto"!==t?[]:[bi(function(n,e){Gm(n,4,i.item).each(function(e){var t=e.numColumns,e=e.numRows;Rd.setGridSize(n,e,t)})})])}))),Zd.getContent(d).each(hf.highlightFirst)}var o=it(G.none()),f=it(!1),d=uu(Zd.sketch({dom:{tag:"div",classes:["tox-autocompleter"]},components:[],fireDismissalEventInstead:{},inlineBehaviours:gc([id("dismissAutocompleter",[Et(ci(),function(){return m()})])]),lazySink:c.getSink})),m=function(){var e;n()&&(e=o.get().map(function(e){return e.element}),Cm(e.getOr(ir.fromDom(a.selection.getNode()))).each(Xt),s(),o.set(G.none()),f.set(!1))},r=ve(function(){return xm(a)}),g=function(e){var t;t=e,o.get().map(function(e){return gm(a.dom,a.selection.getRng(),e.triggerChar).bind(function(e){return Em(a,r,e,t)})}).getOrThunk(function(){return vm(a,r)}).fold(m,function(u){var e,t;e=u.context,n()||(t=sm(a,e.range),o.set(G.some({triggerChar:e.triggerChar,element:t,matchLength:e.text.length})),f.set(!1)),u.lookupData.then(function(i){o.get().map(function(e){var t,n,o,r=u.context;e.triggerChar===r.triggerChar&&(t=r.triggerChar,o=P(n=i,function(e){return G.from(e.columns)}).getOr(1),0<(n=T(n,function(r){var e=r.items;return Nh(e,r.matchText,function(n,o){var e=a.selection.getRng();gm(a.dom,e,t).fold(function(){return console.error("Lost context. Cursor probably moved")},function(e){var t=e.range,e={hide:function(){m()},reload:function(e){s(),g(e)}};f.set(!0),r.onAction(e,t,n,o),f.set(!1)})},o,dg.BUBBLE_TO_SANDBOX,c,r.highlightOn)})).length?l(e,r,i,n):(10<=r.text.length-e.matchLength?m:s)())})})})},e={onKeypress:am(function(e){27!==e.which&&g()},50),cancelIfNecessary:m,isMenuOpen:function(){return Zd.isOpen(d)},isActive:n,isProcessingAction:f.get,getView:function(){return Zd.getContent(d)}};!1===a.hasPlugin("rtc")&&Sm(e,a)},Vh=v,Hh=pu;function zh(n,o){var r=null;return{cancel:function(){null!==r&&(clearTimeout(r),r=null)},schedule:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];r=setTimeout(function(){n.apply(null,e),r=null},o)}}}function jh(e){return void 0===(e=e.raw).touches||1!==e.touches.length?G.none():G.some(e.touches[0])}function Uh(n){var r=it(G.none()),o=it(!1),i=zh(function(e){n.triggerEvent(Qr(),e),o.set(!0)},400),u=we([{key:Or(),value:function(t){return jh(t).each(function(e){i.cancel();e={x:e.clientX,y:e.clientY,target:t.target};i.schedule(t),o.set(!1),r.set(G.some(e))}),G.none()}},{key:_r(),value:function(e){return i.cancel(),jh(e).each(function(o){r.get().each(function(e){var t,n;t=o,n=e,e=Math.abs(t.clientX-n.x),n=Math.abs(t.clientY-n.y),(5<e||5<n)&&r.set(G.none())})}),G.none()}},{key:Er(),value:function(t){i.cancel();return r.get().filter(function(e){return dt(e.target,t.target)}).map(function(e){return o.get()?(t.prevent(),!1):n.triggerEvent(Jr(),t)})}}]);return{fireIfReady:function(t,e){return ho(u,e).bind(function(e){return e(t)})}}}function Wh(){return Cr().browser.isFirefox()}function qh(t,e){var n,o=Le("Getting GUI events settings",Yh,e),r=Uh(o),i=S(["touchstart","touchmove","touchend","touchcancel","gesturestart","mousedown","mouseup","mouseover","mousemove","mouseout","click"].concat(["selectstart","input","contextmenu","change","transitionend","drag","dragstart","dragend","dragenter","dragleave","dragover","drop","keyup"]),function(e){return Ih(t,e,function(t){r.fireIfReady(t,e).each(function(e){e&&t.kill()}),o.triggerEvent(e,t)&&t.kill()})}),u=it(G.none()),a=Ih(t,"paste",function(t){r.fireIfReady(t,"paste").each(function(e){e&&t.kill()}),o.triggerEvent("paste",t)&&t.kill(),u.set(G.some(setTimeout(function(){o.triggerEvent($r(),t)},0)))}),c=Ih(t,"keydown",function(e){var t;o.triggerEvent("keydown",e)?e.kill():!0!==o.stopBackspace||((t=e).raw.which!==vf[0]||ne(["input","textarea"],Mt(t.target))||Ph(t.target,'[contenteditable="true"]'))||e.prevent()}),s=(n=t,e=function(e){o.triggerEvent("focusin",e)&&e.kill()},Wh()?Fh(n,"focus",e):Ih(n,"focusin",e)),l=it(G.none()),f=(n=t,e=function(e){o.triggerEvent("focusout",e)&&e.kill(),l.set(G.some(setTimeout(function(){o.triggerEvent(Gr(),e)},0)))},Wh()?Fh(n,"blur",e):Ih(n,"focusout",e));return{unbind:function(){oe(i,function(e){e.unbind()}),c.unbind(),s.unbind(),f.unbind(),a.unbind(),u.get().each(clearTimeout),l.get().each(clearTimeout)}}}function Gh(e,t){return t=ho(e,"target").getOr(t),it(t)}function $h(e,o,t,n,r,i){var u,a,e=e(o,n),c=(u=it(!1),a=it(!1),{stop:function(){u.set(!0)},cut:function(){a.set(!0)},isStopped:u.get,isCut:a.get,event:t,setSource:r.set,getSource:r.get});return e.fold(function(){return i.logEventNoHandlers(o,n),Kh.complete()},function(t){var n=t.descHandler;return gn(n)(c),c.isStopped()?(i.logEventStopped(o,t.element,n.purpose),Kh.stopped()):c.isCut()?(i.logEventCut(o,t.element,n.purpose),Kh.complete()):Vt(t.element).fold(function(){return i.logNoParent(o,t.element,n.purpose),Kh.complete()},function(e){return i.logEventResponse(o,t.element,n.purpose),Kh.resume(e)})})}function Xh(e,t,n){var o,r=(o=it(!1),{stop:function(){o.set(!0)},cut:W,isStopped:o.get,isCut:c,event:t,setSource:u("Cannot set source of a broadcasted event"),getSource:u("Cannot get source of a broadcasted event")});return oe(e,function(e){e=e.descHandler;gn(e)(r)}),r.isStopped()}var Yh=Ae([Qo("triggerEvent"),Ze("stopBackspace",!0)]),Kh=bo([{stopped:[]},{resume:["element"]},{complete:[]}]),Jh=function(t,n,o,e,r,i){return $h(t,n,o,e,r,i).fold(function(){return!0},function(e){return Jh(t,n,o,e,r,i)},function(){return!1})},Qh=function(e,t,n,o,r){var i=Gh(n,o);return Jh(e,t,n,o,i,r)},Zh=function(e,t){return{element:e,descHandler:t}},ev=function(e,t){return{id:e,descHandler:t}};function tv(){var i={};return{registerId:function(o,r,e){mo(e,function(e,t){var n=void 0!==i[t]?i[t]:{};n[r]=Gi(e,o),i[t]=n})},unregisterId:function(n){mo(i,function(e,t){e.hasOwnProperty(n)&&delete e[n]})},filterByType:function(e){return ho(i,e).map(function(e){return po(e,function(e,t){return ev(t,e)})}).getOr([])},find:function(e,t,n){var r=ho(i,t);return Sr(n,function(e){return n=r,Li(o=e).fold(function(){return G.none()},function(t){return n.bind(function(e){return ho(e,t)}).map(function(e){return Zh(o,e)})});var n,o},e)}}}function nv(){function n(e){var t=e.element;return Li(t).fold(function(){return function(e,t){e=un(Ii+e);return Pi(t,e),e}("uid-",e.element)},function(e){return e})}var o=tv(),r={},i=function(e){Li(e.element).each(function(e){delete r[e],o.unregisterId(e)})};return{find:function(e,t,n){return o.find(e,t,n)},filter:function(e){return o.filterByType(e)},register:function(e){var t=n(e);he(r,t)&&function(e,t){var n=r[t];if(n!==e)throw new Error('The tagId "'+t+'" is already used by: '+rn(n.element)+"\nCannot use it for: "+rn(e.element)+"\nThe conflicting element is"+(eu(n.element)?" ":" not ")+"already in the DOM");i(e)}(e,t),o.registerId([e],t,e.events),r[t]=e},unregister:i,getById:function(e){return ho(r,e)}}}function ov(n){function o(t){return Vt(n.element).fold(function(){return!0},function(e){return dt(t,e)})}function c(e,t){return i.find(o,e,t)}function r(t){var e=i.filter(Xr());oe(e,function(e){e=e.descHandler;gn(e)(t)})}var i=nv(),e=qh(n.element,{triggerEvent:function(t,n){return qu(t,n.target,function(e){return Qh(c,t,n,n.target,e)})}}),u={debugInfo:q("real"),triggerEvent:function(t,n,o){qu(t,n,function(e){return Qh(c,t,o,n,e)})},triggerFocus:function(u,a){Li(u).fold(function(){xa(u)},function(e){qu(qr(),u,function(e){var t,n,o,r,i;return t=c,n=qr(),i=e,e=Gh(o={originator:a,kill:W,prevent:W,target:u},r=u),$h(t,n,o,r,e,i),!1})})},triggerEscape:function(e,t){u.triggerEvent("keydown",e.element,t.event)},getByUid:function(e){return g(e)},getByDom:function(e){return p(e)},build:uu,addToGui:function(e){s(e)},removeFromGui:function(e){l(e)},addToWorld:function(e){t(e)},removeFromWorld:function(e){a(e)},broadcast:function(e){f(e)},broadcastOn:function(e,t){d(e,t)},broadcastEvent:function(e,t){m(e,t)},isConnected:v},t=function(e){e.connect(u),ki(e.element)||(i.register(e),oe(e.components(),t),u.triggerEvent(ti(),e.element,{target:e.element}))},a=function(e){ki(e.element)||(oe(e.components(),a),i.unregister(e)),e.disconnect()},s=function(e){ys(n,e)},l=function(e){ws(e)},f=function(e){r({universal:!0,data:e})},d=function(e,t){r({universal:!1,channels:e,data:t})},m=function(e,t){e=i.filter(e);return Xh(e,t)},g=function(e){return i.getById(e).fold(function(){return ce.error(new Error('Could not find component with uid: "'+e+'" in system.'))},ce.value)},p=function(e){e=Li(e).getOr("not found");return g(e)};return t(n),{root:n,element:n.element,destroy:function(){e.unbind(),Di(n.element)},add:s,remove:l,getByUid:g,getByDom:p,addToWorld:t,removeFromWorld:a,broadcast:f,broadcastOn:d,broadcastEvent:m}}function rv(e,t,n,o){return o=vv(e,t,n,o),gv.sketch(o)}function iv(e,t){return gv.parts.label({dom:{tag:"label",classes:["tox-label"],innerHtml:t.translate(e)}})}function uv(i,u){function t(e,t){return S(Wc(e.element,".tox-collection__item"),t)}var e,n=i.label.map(function(e){return iv(e,u)}),o=(e=function(o){return function(t,n){Hu(n.event.target,"[data-collection-item-value]").each(function(e){o(t,n,e,Zt(e,"data-collection-item-value"))})}})(function(e,t,n,o){t.stop(),u.isDisabled()||wt(e,Cv,{name:i.name,value:o})}),r=[Et(Rr(),e(function(e,t,n){xa(n)})),Et(Hr(),o),Et(Jr(),o),Et(Mr(),e(function(e,t,n){Vu(e.element,"."+xg).each(function(e){_n(e,xg)}),kn(n,xg)})),Et(Ir(),e(function(e){Vu(e.element,"."+xg).each(function(e){_n(e,xg)})})),wi(e(function(e,t,n,o){wt(e,Cv,{name:i.name,value:o})}))],r=gv.parts.field({dom:{tag:"div",classes:["tox-collection"].concat(1!==i.columns?["tox-collection--grid"]:["tox-collection--list"])},components:[],factory:{sketch:l},behaviours:gc([Ug.config({disabled:u.isDisabled,onDisabled:function(e){t(e,function(e){kn(e,"tox-collection__item--state-disabled"),Qt(e,"aria-disabled",!0)})},onEnabled:function(e){t(e,function(e){_n(e,"tox-collection__item--state-disabled"),nn(e,"aria-disabled")})}}),op(),Id.config({}),El.config({store:{mode:"memory",initialValue:[]},onSetValue:function(n,e){!function(e,t){t=S(t,function(e){var t=Vg.translate(e.text),n=1===i.columns?'<div class="tox-collection__item-label">'+t+"</div>":"",o='<div class="tox-collection__item-icon">'+e.icon+"</div>",r={_:" "," - ":" ","-":" "},t=t.replace(/\_| \- |\-/g,function(e){return r[e]});return'<div class="tox-collection__item'+(u.isDisabled()?" tox-collection__item--state-disabled":"")+'" tabindex="-1" data-collection-item-value="'+hv.encodeAllRaw(e.value)+'" title="'+t+'" aria-label="'+t+'">'+o+n+"</div>"}),t="auto"!==i.columns&&1<i.columns?x(t,i.columns):[t],t=S(t,function(e){return'<div class="tox-collection__group">'+e.join("")+"</div>"});Kt(e.element,t.join(""))}(n,e),"auto"===i.columns&&Gm(n,5,"tox-collection__item").each(function(e){var t=e.numRows,e=e.numColumns;Rd.setGridSize(n,t,e)}),xt(n,Ev)}}),pv.config({}),Rd.config((o=i.columns,e="normal",1===o?{mode:"menu",moveOnTab:!1,selector:".tox-collection__item"}:"auto"===o?{mode:"flatgrid",selector:".tox-collection__item",initSize:{numColumns:1,numRows:1}}:{mode:"matrix",selectors:{row:"color"===e?".tox-swatches__row":".tox-collection__group",cell:"color"===e?"."+pg:"."+gg}})),id("collection-events",r)]),eventOrder:((r={})[Yr()]=["disabling","alloy.base.behaviour","collection-events"],r)});return rv(n,r,["tox-form__group--collection"],[])}function av(e){return gc([Fd.config({onFocus:e.selectOnFocus?function(e){var t=e.element,e=Wn(t);t.dom.setSelectionRange(0,e.length)}:W})])}function cv(e){return{tag:e.tag,attributes:A({type:"text"},e.inputAttributes),styles:e.inputStyles,classes:e.inputClasses}}var sv,lv,fv,dv,mv=zl({name:"Container",factory:function(e){var t=e.dom,n=t.attributes,t=f(t,["attributes"]);return{uid:e.uid,dom:A({tag:"div",attributes:A({role:"presentation"},n)},t),components:e.components,behaviours:e.containerBehaviours.dump,events:e.events,domModification:e.domModification,eventOrder:e.eventOrder}},configFields:[Ze("components",[]),Wr("containerBehaviours",[]),Ze("events",{}),Ze("domModification",{}),Ze("eventOrder",{})]}),Ur=q([Ze("prefix","form-field"),Wr("fieldBehaviours",[lf,El])]),si=q([Pl({schema:[ze("dom")],name:"label"}),Pl({factory:{sketch:function(e){return{uid:e.uid,dom:{tag:"span",styles:{display:"none"},attributes:{"aria-hidden":"true"},innerHtml:e.text}}}},schema:[ze("text")],name:"aria-descriptor"}),Fl({factory:{sketch:function(e){var t=xe(e,["factory"]);return e.factory.sketch(t)}},schema:[ze("factory")],name:"field"})]),gv=yc({name:"FormField",configFields:Ur(),partFields:si(),factory:function(r,e,t,n){var o=Rs(r.fieldBehaviours,[lf.config({find:function(e){return Gs(e,r,"field")}}),El.config({store:{mode:"manual",getValue:function(e){return lf.getCurrent(e).bind(El.getValue)},setValue:function(e,t){lf.getCurrent(e).each(function(e){El.setValue(e,t)})}}})]),i=vi([bi(function(e,t){var o=Xs(e,r,["label","field","aria-descriptor"]);o.field().each(function(n){var t=un(r.prefix);o.label().each(function(e){Qt(e.element,"for",t),Qt(n.element,"id",t)}),o["aria-descriptor"]().each(function(e){var t=un(r.prefix);Qt(e.element,"id",t),Qt(n.element,"aria-describedby",t)})})})]);return{uid:r.uid,dom:r.dom,components:e,behaviours:o,events:i,apis:{getField:function(e){return Gs(e,r,"field")},getLabel:function(e){return Gs(e,r,"label")}}}},apis:{getField:function(e,t){return e.getField(t)},getLabel:function(e,t){return e.getLabel(t)}}}),Ri=Object.freeze({__proto__:null,exhibit:function(e,t){return dn({attributes:we([{key:t.tabAttr,value:"true"}])})}}),Yi=[Ze("tabAttr","data-alloy-tabstop")],pv=ya({fields:Yi,name:"tabstopping",active:Ri}),hv=tinymce.util.Tools.resolve("tinymce.html.Entities"),vv=function(e,t,n,o){return{dom:bv(n),components:e.toArray().concat([t]),fieldBehaviours:gc(o)}},bv=function(e){return{tag:"div",classes:["tox-form__group"].concat(e)}},yv=un("form-component-change"),xv=un("form-close"),wv=un("form-cancel"),Cv=un("form-action"),Sv=un("form-submit"),kv=un("form-block"),Ov=un("form-unblock"),_v=un("form-tabchange"),Ev=un("form-resize"),gr=q([Xe("data"),Ze("inputAttributes",{}),Ze("inputStyles",{}),Ze("tag","input"),Ze("inputClasses",[]),Ka("onSetValue"),Ze("styles",{}),Ze("eventOrder",{}),Wr("inputBehaviours",[El,Fd]),Ze("selectOnFocus",!0)]),Tv=zl({name:"Input",configFields:gr(),factory:function(e,t){return{uid:e.uid,dom:cv(e),components:[],behaviours:A(A({},av(n=e)),Rs(n.inputBehaviours,[El.config({store:A(A({mode:"manual"},n.data.map(function(e){return{initialValue:e}}).getOr({})),{getValue:function(e){return Wn(e.element)},setValue:function(e,t){Wn(e.element)!==t&&qn(e.element,t)}}),onSetValue:n.onSetValue})])),eventOrder:e.eventOrder};var n}}),dr={},t={exports:dr};lv=dr,fv=t,dv=sv=void 0,function(e){"object"==typeof lv&&void 0!==fv?fv.exports=e():"function"==typeof sv&&sv.amd?sv([],e):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).EphoxContactWrapper=e()}(function(){return function o(r,i,u){function a(t,e){if(!i[t]){if(!r[t]){var n="function"==typeof dv&&dv;if(!e&&n)return n(t,!0);if(c)return c(t,!0);throw(n=new Error("Cannot find module '"+t+"'")).code="MODULE_NOT_FOUND",n}n=i[t]={exports:{}},r[t][0].call(n.exports,function(e){return a(r[t][1][e]||e)},n,n.exports,o,r,i,u)}return i[t].exports}for(var c="function"==typeof dv&&dv,e=0;e<u.length;e++)a(u[e]);return a}({1:[function(e,t,n){var o,r,t=t.exports={};function i(){throw new Error("setTimeout has not been defined")}function u(){throw new Error("clearTimeout has not been defined")}function a(t){if(o===setTimeout)return setTimeout(t,0);if((o===i||!o)&&setTimeout)return o=setTimeout,setTimeout(t,0);try{return o(t,0)}catch(e){try{return o.call(null,t,0)}catch(e){return o.call(this,t,0)}}}!function(){try{o="function"==typeof setTimeout?setTimeout:i}catch(e){o=i}try{r="function"==typeof clearTimeout?clearTimeout:u}catch(e){r=u}}();var c,s=[],l=!1,f=-1;function d(){l&&c&&(l=!1,c.length?s=c.concat(s):f=-1,s.length&&m())}function m(){if(!l){var e=a(d);l=!0;for(var t=s.length;t;){for(c=s,s=[];++f<t;)c&&c[f].run();f=-1,t=s.length}c=null,l=!1,function(t){if(r===clearTimeout)return clearTimeout(t);if((r===u||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(t);try{r(t)}catch(e){try{return r.call(null,t)}catch(e){return r.call(this,t)}}}(e)}}function g(e,t){this.fun=e,this.array=t}function p(){}t.nextTick=function(e){var t=new Array(arguments.length-1);if(1<arguments.length)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];s.push(new g(e,t)),1!==s.length||l||a(m)},g.prototype.run=function(){this.fun.apply(null,this.array)},t.title="browser",t.browser=!0,t.env={},t.argv=[],t.version="",t.versions={},t.on=p,t.addListener=p,t.once=p,t.off=p,t.removeListener=p,t.removeAllListeners=p,t.emit=p,t.prependListener=p,t.prependOnceListener=p,t.listeners=function(e){return[]},t.binding=function(e){throw new Error("process.binding is not supported")},t.cwd=function(){return"/"},t.chdir=function(e){throw new Error("process.chdir is not supported")},t.umask=function(){return 0}},{}],2:[function(e,f,t){!function(t){function o(){}function i(e){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],l(e,this)}function r(n,o){for(;3===n._state;)n=n._value;0!==n._state?(n._handled=!0,i._immediateFn(function(){var e,t=1===n._state?o.onFulfilled:o.onRejected;if(null!==t){try{e=t(n._value)}catch(e){return void a(o.promise,e)}u(o.promise,e)}else(1===n._state?u:a)(o.promise,n._value)})):n._deferreds.push(o)}function u(t,e){try{if(e===t)throw new TypeError("A promise cannot be resolved with itself.");if(e&&("object"==typeof e||"function"==typeof e)){var n=e.then;if(e instanceof i)return t._state=3,t._value=e,void c(t);if("function"==typeof n)return void l((o=n,r=e,function(){o.apply(r,arguments)}),t)}t._state=1,t._value=e,c(t)}catch(e){a(t,e)}var o,r}function a(e,t){e._state=2,e._value=t,c(e)}function c(e){2===e._state&&0===e._deferreds.length&&i._immediateFn(function(){e._handled||i._unhandledRejectionFn(e._value)});for(var t=0,n=e._deferreds.length;t<n;t++)r(e,e._deferreds[t]);e._deferreds=null}function s(e,t,n){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.promise=n}function l(e,t){var n=!1;try{e(function(e){n||(n=!0,u(t,e))},function(e){n||(n=!0,a(t,e))})}catch(e){if(n)return;n=!0,a(t,e)}}var e,n;e=this,n=setTimeout,i.prototype.catch=function(e){return this.then(null,e)},i.prototype.then=function(e,t){var n=new this.constructor(o);return r(this,new s(e,t,n)),n},i.all=function(e){var a=Array.prototype.slice.call(e);return new i(function(r,i){if(0===a.length)return r([]);var u=a.length;for(var e=0;e<a.length;e++)!function t(n,e){try{if(e&&("object"==typeof e||"function"==typeof e)){var o=e.then;if("function"==typeof o)return void o.call(e,function(e){t(n,e)},i)}a[n]=e,0==--u&&r(a)}catch(e){i(e)}}(e,a[e])})},i.resolve=function(t){return t&&"object"==typeof t&&t.constructor===i?t:new i(function(e){e(t)})},i.reject=function(n){return new i(function(e,t){t(n)})},i.race=function(r){return new i(function(e,t){for(var n=0,o=r.length;n<o;n++)r[n].then(e,t)})},i._immediateFn="function"==typeof t?function(e){t(e)}:function(e){n(e,0)},i._unhandledRejectionFn=function(e){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",e)},i._setImmediateFn=function(e){i._immediateFn=e},i._setUnhandledRejectionFn=function(e){i._unhandledRejectionFn=e},void 0!==f&&f.exports?f.exports=i:e.Promise||(e.Promise=i)}.call(this,e("timers").setImmediate)},{timers:3}],3:[function(c,e,s){!function(e,t){var o=c("process/browser.js").nextTick,n=Function.prototype.apply,r=Array.prototype.slice,i={},u=0;function a(e,t){this._id=e,this._clearFn=t}s.setTimeout=function(){return new a(n.call(setTimeout,window,arguments),clearTimeout)},s.setInterval=function(){return new a(n.call(setInterval,window,arguments),clearInterval)},s.clearTimeout=s.clearInterval=function(e){e.close()},a.prototype.unref=a.prototype.ref=function(){},a.prototype.close=function(){this._clearFn.call(window,this._id)},s.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},s.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},s._unrefActive=s.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;0<=t&&(e._idleTimeoutId=setTimeout(function(){e._onTimeout&&e._onTimeout()},t))},s.setImmediate="function"==typeof e?e:function(e){var t=u++,n=!(arguments.length<2)&&r.call(arguments,1);return i[t]=!0,o(function(){i[t]&&(n?e.apply(null,n):e.call(null),s.clearImmediate(t))}),t},s.clearImmediate="function"==typeof t?t:function(e){delete i[e]}}.call(this,c("timers").setImmediate,c("timers").clearImmediate)},{"process/browser.js":1,timers:3}],4:[function(e,t,n){var o=e("promise-polyfill"),e="undefined"!=typeof window?window:Function("return this;")();t.exports={boltExport:e.Promise||o}},{"promise-polyfill":2}]},{},[4])(4)});function Dv(e){setTimeout(function(){throw e},0)}function Av(e){return e=Mt(e),ne(jv,e)}function Bv(e,t){var n=t.getRoot(e).getOr(e.element);_n(n,t.invalidClass),t.notify.each(function(t){Av(e.element)&&Qt(e.element,"aria-invalid",!1),t.getContainer(e).each(function(e){Kt(e,t.validHtml)}),t.onValid(e)})}function Nv(t,e,n,o){var r=e.getRoot(t).getOr(t.element);kn(r,e.invalidClass),e.notify.each(function(e){Av(t.element)&&Qt(t.element,"aria-invalid",!0),e.getContainer(t).each(function(e){Kt(e,o)}),e.onInvalid(t,o)})}function Rv(t,e,n){return e.validator.fold(function(){return zv(ce.value(!0))},function(e){return e.validate(t)})}function Mv(t,n,e){return n.notify.each(function(e){e.onValidate(t)}),Rv(t,n).map(function(e){return t.getSystem().isConnected()?e.fold(function(e){return Nv(t,n,0,e),ce.error(e)},function(e){return Bv(t,n),ce.value(e)}):ce.error("No longer in system")})}var Iv,Fv=t.exports.boltExport,Pv=function(e){var n=G.none(),t=[],o=function(e){r()?u(e):t.push(e)},r=function(){return n.isSome()},i=function(e){oe(e,u)},u=function(t){n.each(function(e){setTimeout(function(){t(e)},0)})};return e(function(e){r()||(n=G.some(e),i(t),t=[])}),{get:o,map:function(n){return Pv(function(t){o(function(e){t(n(e))})})},isReady:r}},Lv={nu:Pv,pure:function(t){return Pv(function(e){e(t)})}},Vv=function(n){function e(e){n().then(e,Dv)}return{map:function(e){return Vv(function(){return n().then(e)})},bind:function(t){return Vv(function(){return n().then(function(e){return t(e).toPromise()})})},anonBind:function(e){return Vv(function(){return n().then(function(){return e.toPromise()})})},toLazy:function(){return Lv.nu(e)},toCached:function(){var e=null;return Vv(function(){return e=null===e?n():e})},toPromise:n,get:e}},Hv=function(e){return Vv(function(){return new Fv(e)})},zv=function(e){return Vv(function(){return Fv.resolve(e)})},jv=["input","textarea"],pr=Object.freeze({__proto__:null,markValid:Bv,markInvalid:Nv,query:Rv,run:Mv,isInvalid:function(e,t){e=t.getRoot(e).getOr(e.element);return En(e,t.invalidClass)}}),ec=Object.freeze({__proto__:null,events:function(t,e){return t.validator.map(function(e){return vi([Et(e.onEvent,function(e){Mv(e,t).get(l)})].concat(e.validateOnLoad?[bi(function(e){Mv(e,t).get(W)})]:[]))}).getOr({})}}),Uv=[ze("invalidClass"),Ze("getRoot",G.none),Qe("notify",[Ze("aria","alert"),Ze("getContainer",G.none),Ze("validHtml",""),Ka("onValid"),Ka("onInvalid"),Ka("onValidate")]),Qe("validator",[ze("validate"),Ze("onEvent","input"),Ze("validateOnLoad",!0)])],Wv=ya({fields:Uv,name:"invalidating",active:ec,apis:pr,extra:{validation:function(t){return function(e){e=El.getValue(e);return zv(t(e))}}}}),xl=Object.freeze({__proto__:null,getCoupled:function(e,t,n,o){return n.getOrCreate(e,t,o)}}),Ur=[je("others",zo(ce.value,Wo()))],qv=ya({fields:Ur,name:"coupling",apis:xl,state:Object.freeze({__proto__:null,init:function(){var r={},e=q({});return qi({readState:e,getOrCreate:function(t,n,o){var e=lo(n.others);if(e)return ho(r,o).getOrThunk(function(){var e=ho(n.others,o).getOrDie("No information found for coupled component: "+o)(t),e=t.getSystem().build(e);return r[o]=e});throw new Error("Cannot find coupled component: "+o+". Known coupled components: "+JSON.stringify(e,null,2))}})}})}),Gv=q("sink"),si=q(Pl({name:Gv(),overrides:q({dom:{tag:"div"},behaviours:gc([ml.config({useFixed:v})]),events:vi([Nt(Fr()),Nt(Dr()),Nt(Hr())])})}));(Yi=Iv=Iv||{})[Yi.HighlightFirst=0]="HighlightFirst",Yi[Yi.HighlightNone=1]="HighlightNone";function $v(e,t){var n=e.getHotspot(t).getOr(t),o=e.getAnchorOverrides();return e.layouts.fold(function(){return{anchor:"hotspot",hotspot:n,overrides:o}},function(e){return{anchor:"hotspot",hotspot:n,overrides:o,layouts:e}})}function Xv(e,t,n,o,r,i,u){var a,c,s,l,f,d,m=$v(e,n);return(a=m,c=n,s=o,l=r,f=u,t=t=t,t=(0,(e=e).fetch)(c).map(t),d=fy(c,e),t.map(function(e){return e.bind(function(e){return G.from(Qd.sketch(A(A({},l.menu()),{uid:Vi(""),data:e,highlightImmediately:f===Iv.HighlightFirst,onOpenMenu:function(e,t){var n=d().getOrDie();ml.position(n,a,t),wl.decloak(s)},onOpenSubmenu:function(e,t,n){var o=d().getOrDie();ml.position(o,{anchor:"submenu",item:t},n),wl.decloak(s)},onRepositionMenu:function(e,t,n){var o=d().getOrDie();ml.position(o,a,t),oe(n,function(e){ml.position(o,{anchor:"submenu",item:e.triggeringItem},e.triggeredMenu)})},onEscape:function(){return Fd.focus(c),wl.close(s),G.some(!0)}})))})})).map(function(e){return e.fold(function(){wl.isOpen(o)&&wl.close(o)},function(e){wl.cloak(o),wl.open(o,e),i(o)}),o})}function Yv(e,t,n,o,r,i,u){return wl.close(o),zv(o)}function Kv(e,t,n,o,r,i){var u=qv.getCoupled(n,"sandbox");return(wl.isOpen(u)?Yv:Xv)(e,t,n,u,o,r,i)}function Jv(e,t,n){t=lf.getCurrent(t).getOr(t),e=mu(e.element),n?Fn(t.element,"min-width",e+"px"):(t=t.element,Au.set(t,e))}function Qv(e){wl.getState(e).each(function(e){Qd.repositionMenus(e)})}function Zv(o,r,i){var u=zu(),e=fy(r,o);return{dom:{tag:"div",classes:o.sandboxClasses,attributes:{id:u.id,role:"listbox"}},behaviours:Dl(o.sandboxBehaviours,[El.config({store:{mode:"memory",initialValue:r}}),wl.config({onOpen:function(e,t){var n=$v(o,r);u.link(r.element),o.matchWidth&&Jv(n.hotspot,t,o.useMinWidth),o.onOpen(n,e,t),void 0!==i&&void 0!==i.onOpen&&i.onOpen(e,t)},onClose:function(e,t){u.unlink(r.element),void 0!==i&&void 0!==i.onClose&&i.onClose(e,t)},isPartOf:function(e,t,n){return Wu(t,n)||Wu(r,n)},getAttachPoint:function(){return e().getOrDie()}}),lf.config({find:function(e){return wl.getState(e).bind(function(e){return lf.getCurrent(e)})}}),bc.config({channels:A(A({},Ts({isExtraPart:c})),Ds({doReposition:Qv}))})])}}function eb(e){e=qv.getCoupled(e,"sandbox"),Qv(e)}function tb(n,t,o){function r(e,t){wt(e,py,{value:t})}var i,u,e=gv.parts.field({factory:Tv,inputClasses:["tox-textfield"],onSetValue:function(e){return Wv.run(e).get(function(){})},inputBehaviours:gc([Ug.config({disabled:t.providers.isDisabled}),op(),pv.config({}),Wv.config({invalidClass:"tox-textbox-field-invalid",getRoot:function(e){return Vt(e.element)},notify:{onValid:function(e){var t=El.getValue(e);wt(e,gy,{color:t})}},validator:{validateOnLoad:!1,validate:function(e){var t=El.getValue(e);if(0===t.length)return zv(ce.value(!0));e=ir.fromTag("span");Fn(e,"background-color",t);e=Hn(e,"background-color").fold(function(){return ce.error("blah")},function(e){return ce.value(t)});return zv(e)}}})]),selectOnFocus:!1}),a=n.label.map(function(e){return iv(e,t.providers)}),c=Ed((i={dom:{tag:"span",attributes:{"aria-label":t.providers.translate("Color swatch")}},layouts:{onRtl:function(){return[ra,oa,fc]},onLtr:function(){return[oa,ra,fc]}},components:[],fetch:ah(o.getColors(),o.hasCustomColors()),columns:o.getColorCols(),presets:"color",onItemAction:function(e,n){c.getOpt(e).each(function(t){"custom"===n?o.colorPicker(function(e){e.fold(function(){return xt(t,hy)},function(e){r(t,e),nh(e)})},"#ffffff"):r(t,"remove"===n?"":n)})}},u=t,dy.sketch({dom:i.dom,components:i.components,toggleClass:"mce-active",dropdownBehaviours:gc([Ip(u.providers.isDisabled),op(),my.config({}),pv.config({})]),layouts:i.layouts,sandboxClasses:["tox-dialog__popups"],lazySink:u.getSink,fetch:function(t){return Hv(function(e){return i.fetch(e)}).map(function(e){return G.from(Mh(wo(fh(un("menu-value"),e,function(e){i.onItemAction(t,e)},i.columns,i.presets,dg.CLOSE_ON_EXECUTE,function(){return!1},u.providers),{movement:dh(i.columns,i.presets)})))})},parts:{menu:Lm(0,0,i.presets)}})));return gv.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:a.toArray().concat([{dom:{tag:"div",classes:["tox-color-input"]},components:[e,c.asSpec()]}]),fieldBehaviours:gc([id("form-field-events",[Et(gy,function(e,t){c.getOpt(e).each(function(e){Fn(e.element,"background-color",t.event.color)}),wt(e,yv,{name:n.name})}),Et(py,function(t,n){gv.getField(t).each(function(e){El.setValue(e,n.event.value),lf.getCurrent(t).each(Fd.focus)})}),Et(hy,function(t,e){gv.getField(t).each(function(e){lf.getCurrent(t).each(Fd.focus)})})])])})}function nb(e,t,n){return{hue:e,saturation:t,value:n}}function ob(e){return-1===(e=e.event.raw).type.indexOf("touch")?void 0!==e.clientX?G.some(e).map(function(e){return Tu(e.clientX,e.clientY)}):G.none():void 0!==e.touches&&1===e.touches.length?G.some(e.touches[0]).map(function(e){return Tu(e.clientX,e.clientY)}):G.none()}function rb(e){return e.model.minX}function ib(e){return e.model.minY}function ub(e){return e.model.minX-1}function ab(e){return e.model.minY-1}function cb(e){return e.model.maxX}function sb(e){return e.model.maxY}function lb(e){return e.model.maxX+1}function fb(e){return e.model.maxY+1}function db(e,t,n){return t(e)-n(e)}function mb(e){return db(e,cb,rb)}function gb(e){return db(e,sb,ib)}function pb(e){return mb(e)/2}function hb(e){return gb(e)/2}function vb(e){return e.stepSize}function bb(e){return e.snapToGrid}function yb(e){return e.snapStart}function xb(e){return e.rounded}function wb(e,t){return void 0!==e[t+"-edge"]}function Cb(e){return wb(e,"left")}function Sb(e){return wb(e,"right")}function kb(e){return wb(e,"top")}function Ob(e){return wb(e,"bottom")}function _b(e){return e.model.value.get()}function Eb(e,t){return{x:e,y:t}}function Tb(e,t){wt(e,xy(),{value:t})}function Db(e,t,n,o){return e<t?e:n<e?n:e===t?t-1:Math.max(t,e-o)}function Ab(e,t,n,o){return n<e?e:e<t?t:e===n?n+1:Math.min(n,e+o)}function Bb(e,t,n){return Math.max(t,Math.min(n,e))}function Nb(e){var t=e.min,n=e.max,o=e.range,r=e.value,i=e.step,u=e.snap,a=e.snapStart,c=e.rounded,s=e.hasMinEdge,l=e.hasMaxEdge,f=e.minBound,d=e.maxBound,e=e.screenRange,s=s?t-1:t,l=l?n+1:n;if(r<f)return s;if(d<r)return l;var m,g,p,h,f=(f=f,Math.min(d,Math.max(r,f))-f),l=Bb(f/e*o+t,s,l);return u&&t<=l&&l<=n?(m=l,g=t,p=n,h=i,a.fold(function(){var e=Math.round((m-g)/h)*h;return Bb(g+e,g-1,p+1)},function(e){var t=Math.round((m-e)%h/h),n=Math.floor((m-e)/h),o=Math.floor((p-e)/h),t=Math.min(o,n+t);return Math.max(e,e+t*h)})):c?Math.round(l):l}function Rb(e){var t=e.min,n=e.max,o=e.range,r=e.value,i=e.hasMinEdge,u=e.hasMaxEdge,a=e.maxBound,c=e.maxOffset,s=e.centerMinEdge,e=e.centerMaxEdge;return r<t?i?0:s:n<r?u?a:e:(r-t)/o*c}function Mb(e){return e.element.dom.getBoundingClientRect()}function Ib(e){return Mb(e).left}function Fb(e){return Mb(e).right}function Pb(e){return Mb(e).top}function Lb(e){return Mb(e).bottom}function Vb(e){return Mb(e).width}function Hb(e){return Mb(e).height}function zb(e,t){return e=Mb(e),t=Mb(t),(e.left+e.right)/2-t.left}function jb(e,t){return e=Mb(e),t=Mb(t),(e.top+e.bottom)/2-t.top}function Ub(e,t){wt(e,xy(),{value:t})}function Wb(e,t,n){return e={min:rb(t),max:cb(t),range:mb(t),value:n,step:vb(t),snap:bb(t),snapStart:yb(t),rounded:xb(t),hasMinEdge:Cb(t),hasMaxEdge:Sb(t),minBound:Ib(e),maxBound:Fb(e),screenRange:Vb(e)},Nb(e)}function qb(e,t,n,o,r,i){var u,a,o=(a=i,i=n,n=o,o=r,r=Vb(u=t),n=n.bind(function(e){return G.some(zb(e,u))}).getOr(0),o=o.bind(function(e){return G.some(zb(e,u))}).getOr(r),o={min:rb(a),max:cb(a),range:mb(a),value:i,hasMinEdge:Cb(a),hasMaxEdge:Sb(a),minBound:Ib(u),minOffset:0,maxBound:Fb(u),maxOffset:r,centerMinEdge:n,centerMaxEdge:o},Rb(o));return Ib(t)-Ib(e)+o}function Gb(e,t){wt(e,xy(),{value:t})}function $b(e,t,n){return e={min:ib(t),max:sb(t),range:gb(t),value:n,step:vb(t),snap:bb(t),snapStart:yb(t),rounded:xb(t),hasMinEdge:kb(t),hasMaxEdge:Ob(t),minBound:Pb(e),maxBound:Lb(e),screenRange:Hb(e)},Nb(e)}function Xb(e,t,n,o,r,i){var u,a,o=(a=i,i=n,n=o,o=r,r=Hb(u=t),n=n.bind(function(e){return G.some(jb(e,u))}).getOr(0),o=o.bind(function(e){return G.some(jb(e,u))}).getOr(r),o={min:ib(a),max:sb(a),range:gb(a),value:i,hasMinEdge:kb(a),hasMaxEdge:Ob(a),minBound:Pb(u),minOffset:0,maxBound:Lb(u),maxOffset:r,centerMinEdge:n,centerMaxEdge:o},Rb(o));return Pb(t)-Pb(e)+o}function Yb(e,t){wt(e,xy(),{value:t})}function Kb(e,t){return{x:e,y:t}}function Jb(e){return"<alloy.field."+e+">"}function Qb(d,m,g,p){function h(e,t,n,o,r){var i,u,a=d(Ty+"range"),e=[gv.parts.label({dom:{tag:"label",innerHtml:n,attributes:{"aria-label":o}}}),gv.parts.field({data:r,factory:Tv,inputAttributes:A({type:"text"},"hex"===t?{"aria-live":"polite"}:{}),inputClasses:[m("textfield")],inputBehaviours:gc([(i=t,u=e,Wv.config({invalidClass:m("invalid"),notify:{onValidate:function(e){wt(e,Ey,{type:i})},onValid:function(e){wt(e,Oy,{type:i,value:El.getValue(e)})},onInvalid:function(e){wt(e,_y,{type:i,value:El.getValue(e)})}},validator:{validate:function(e){e=El.getValue(e),e=u(e)?ce.value(!0):ce.error(d("aria.input.invalid"));return zv(e)},validateOnLoad:!1}})),pv.config({})]),onSetValue:function(e){Wv.isInvalid(e)&&Wv.run(e).get(W)}})],a="hex"!==t?[gv.parts["aria-descriptor"]({text:a})]:[];return{dom:{tag:"div",attributes:{role:"presentation"}},components:e.concat(a)}}function v(e,t){var n=t.red,o=t.green,t=t.blue;El.setValue(e,{red:n,green:o,blue:t})}function b(e,t){y.getOpt(e).each(function(e){Fn(e.element,"background-color","#"+t.value)})}var y=Ed({dom:{tag:"div",classes:[m("rgba-preview")],styles:{"background-color":"white"},attributes:{role:"presentation"}}});return zl({factory:function(){function r(e){return u[e].get()}function i(e,t){u[e].set(t)}function t(e,t){"hex"!==(t=t.event).type?i(t.type,G.none()):p(e)}function n(o,e,t){t=parseInt(t,10),i(e,G.some(t)),r("red").bind(function(n){return r("green").bind(function(t){return r("blue").map(function(e){return Op(n,t,e,1)})})}).each(function(e){var t,n,e=(t=o,n=kp(e),ky.getField(t,"hex").each(function(e){Fd.isFocused(e)||El.setValue(t,{hex:n.value})}),n);b(o,e)})}function o(e,t){"hex"===(t=t.event).type?function(e,t){g(e);var n=xp(t);i("hex",G.some(t));t=Tp(n);v(e,t),a(t),wt(e,vy,{hex:n}),b(e,n)}(e,t.value):n(e,t.type,t.value)}function e(e){return{label:d(Ty+e+".label"),description:d(Ty+e+".description")}}var u={red:it(G.some(255)),green:it(G.some(255)),blue:it(G.some(255)),hex:it(G.some("ffffff"))},a=function(e){var t=e.red,n=e.green,e=e.blue;i("red",G.some(t)),i("green",G.some(n)),i("blue",G.some(e))},c=e("red"),s=e("green"),l=e("blue"),f=e("hex");return wo(ky.sketch(function(e){return{dom:{tag:"form",classes:[m("rgb-form")],attributes:{"aria-label":d("aria.color.picker")}},components:[e.field("red",gv.sketch(h(_p,"red",c.label,c.description,255))),e.field("green",gv.sketch(h(_p,"green",s.label,s.description,255))),e.field("blue",gv.sketch(h(_p,"blue",l.label,l.description,255))),e.field("hex",gv.sketch(h(wp,"hex",f.label,f.description,"ffffff"))),y.asSpec()],formBehaviours:gc([Wv.config({invalidClass:m("form-invalid")}),id("rgb-form-events",[Et(Oy,o),Et(_y,t),Et(Ey,t)])])}}),{apis:{updateHex:function(e,t){El.setValue(e,{hex:t.value}),function(e,t){t=Tp(t);v(e,t),a(t)}(e,t),b(e,t)}}})},name:"RgbForm",configFields:[],apis:{updateHex:function(e,t,n){e.updateHex(t,n)}},extraApis:{}})}function Zb(e,o){function r(e,t){var n=e.width,o=e.height;null!==(e=e.getContext("2d"))&&(e.fillStyle=t,e.fillRect(0,0,n,o),(t=e.createLinearGradient(0,0,n,0)).addColorStop(0,"rgba(255,255,255,1)"),t.addColorStop(1,"rgba(255,255,255,0)"),e.fillStyle=t,e.fillRect(0,0,n,o),(t=e.createLinearGradient(0,0,0,o)).addColorStop(0,"rgba(0,0,0,0)"),t.addColorStop(1,"rgba(0,0,0,1)"),e.fillStyle=t,e.fillRect(0,0,n,o))}var i=wy.parts.spectrum({dom:{tag:"canvas",attributes:{role:"presentation"},classes:[o("sv-palette-spectrum")]}}),u=wy.parts.thumb({dom:{tag:"div",attributes:{role:"presentation"},classes:[o("sv-palette-thumb")],innerHtml:"<div class="+o("sv-palette-inner-thumb")+' role="presentation"></div>'}});return zl({factory:function(e){var t=q({x:0,y:0}),n=gc([lf.config({find:G.some}),Fd.config({})]);return wy.sketch({dom:{tag:"div",attributes:{role:"presentation"},classes:[o("sv-palette")]},model:{mode:"xy",getInitialValue:t},rounded:!1,components:[i,u],onChange:function(e,t,n){wt(e,yy,{value:n})},onInit:function(e,t,n,o){r(n.element.dom,Ap(Kp))},sliderBehaviours:n})},name:"SaturationBrightnessPalette",configFields:[],apis:{setRgba:function(e,t,n){!function(e,t){e=e.components()[0].element.dom;r(e,Ap(t))}(t,n)}},extraApis:{}})}function ey(m,g){return zl({name:"ColourPicker",configFields:[ze("dom"),Ze("onValidHex",W),Ze("onInvalidHex",W)],factory:function(e){function t(e,n){c.getOpt(e).each(function(e){var t=Tp(n);f.paletteRgba.set(t),a.setRgba(e,t)})}function n(e,t){d.getOpt(e).each(function(e){u.updateHex(e,t)})}function s(t,n,e){oe(e,function(e){e(t,n)})}var o,l,r,i,u=Qb(m,g,e.onValidHex,e.onInvalidHex),a=Zb(0,g),f={paletteRgba:it(Kp)},c=Ed(a.sketch({})),d=Ed(u.sketch({}));return{uid:e.uid,dom:e.dom,components:[c.asSpec(),(r=g,i=wy.parts.spectrum({dom:{tag:"div",classes:[r("hue-slider-spectrum")],attributes:{role:"presentation"}}}),e=wy.parts.thumb({dom:{tag:"div",classes:[r("hue-slider-thumb")],attributes:{role:"presentation"}}}),wy.sketch({dom:{tag:"div",classes:[r("hue-slider")],attributes:{role:"presentation"}},rounded:!1,model:{mode:"y",getInitialValue:q({y:0})},components:[i,e],sliderBehaviours:gc([Fd.config({})]),onChange:function(e,t,n){wt(e,by,{value:n})}})),d.asSpec()],behaviours:gc([id("colour-picker-events",[Et(yy,(l=[n],function(e,t){var n,o,r,i,u,a=t.event.value,c=f.paletteRgba.get(),r=(r=o=0,i=(n=c).red/255,u=n.green/255,t=n.blue/255,c=Math.min(i,Math.min(u,t)),n=Math.max(i,Math.max(u,t)),c===n?nb(0,0,100*(r=c)):(o=60*((o=i===c?3:t===c?1:5)-(i===c?u-t:t===c?i-u:t-i)/(n-c)),c=(n-c)/n,r=n,nb(Math.round(o),Math.round(100*c),Math.round(100*r)))),a=nb(r.hue,a.x,100-a.y),a=Ep(a),a=kp(a);s(e,a,l)})),Et(by,(o=[t,n],function(e,t){t=function(e){e=nb((100-e)/100*360,100,100),e=Ep(e);return kp(e)}(t.event.value.y);s(e,t,o)}))]),lf.config({find:function(e){return d.getOpt(e)}}),Rd.config({mode:"acyclic"})])}}})}function ty(e){return Ny[e]}function ny(e,t,n){return El.config(wo({store:{mode:"manual",getValue:t,setValue:n}},e.map(function(e){return{store:{initialValue:e}}}).getOr({})))}function oy(e,t,n){return ny(e,function(e){return t(e.element)},function(e,t){return n(e.element,t)})}function ry(o,r){function t(e,t){t.stop()}function n(e){return function(t,n){oe(e,function(e){e(t,n)})}}function i(e,t){Ug.isDisabled(e)||(t=t.event.raw,a(e,t.dataTransfer.files))}function u(e,t){t=t.event.raw.target,a(e,t.files)}var a=function(e,t){var n;El.setValue(e,(t=t,n=My.explode(r.getSetting("images_file_types","jpeg,jpg,jpe,jfi,jif,jfif,png,gif,bmp,webp","string")),C(ie(t),function(t){return b(n,function(e){return ct(t.name,"."+e)})}))),wt(e,yv,{name:o.name})},c=Ed({dom:{tag:"input",attributes:{type:"file",accept:"image/*"},styles:{display:"none"}},behaviours:gc([id("input-file-events",[Nt(Hr()),Nt(Jr())])])}),e=o.label.map(function(e){return iv(e,r)}),s=gv.parts.field({factory:{sketch:function(e){return{uid:e.uid,dom:{tag:"div",classes:["tox-dropzone-container"]},behaviours:gc([Vy([]),Dy(),Ug.config({}),Vd.config({toggleClass:"dragenter",toggleOnExecute:!1}),id("dropzone-events",[Et("dragenter",n([t,Vd.toggle])),Et("dragleave",n([t,Vd.toggle])),Et("dragover",t),Et("drop",n([t,i])),Et(Vr(),u)])]),components:[{dom:{tag:"div",classes:["tox-dropzone"],styles:{}},components:[{dom:{tag:"p",innerHtml:r.translate("Drop an image here")}},om.sketch({dom:{tag:"button",innerHtml:r.translate("Browse for an image"),styles:{position:"relative"},classes:["tox-button","tox-button--secondary"]},components:[c.asSpec()],action:function(e){c.get(e).element.dom.click()},buttonBehaviours:gc([pv.config({}),Ip(r.isDisabled),op()])})]}]}}}});return rv(e,s,["tox-form__group--stretched"],[])}function iy(e){return{dom:{tag:"div",styles:{width:"1px",height:"1px",outline:"none"},attributes:{tabindex:"0"},classes:e},behaviours:gc([Fd.config({ignore:!0}),pv.config({})])}}function uy(e){return{dom:{tag:"div",classes:["tox-navobj"]},components:[iy([Hy]),e,iy([zy])],behaviours:gc([By(1)])}}function ay(e,t){wt(e,Fr(),{raw:{which:9,shiftKey:t}})}function cy(e,t){t=t.element,En(t,Hy)?ay(e,!0):En(t,zy)&&ay(e,!1)}function sy(e){return Ph(e,["."+Hy,"."+zy].join(","),c)}function ly(e,t){var n,o,r=jy&&e.sandboxed,i=A(A({},e.label.map(function(e){return{title:e}}).getOr({})),r?{sandbox:"allow-scripts allow-same-origin"}:{}),u=(n=r,o=it(""),{getValue:function(e){return o.get()},setValue:function(e,t){n?Qt(e.element,"srcdoc",t):(Qt(e.element,"src","javascript:''"),(e=e.element.dom.contentWindow.document).open(),e.write(t),e.close()),o.set(t)}}),r=e.label.map(function(e){return iv(e,t)}),e=gv.parts.field({factory:{sketch:function(e){return uy({uid:e.uid,dom:{tag:"iframe",attributes:i},behaviours:gc([pv.config({}),Fd.config({}),Py(G.none(),u.getValue,u.setValue)])})}}});return rv(r,e,["tox-form__group--stretched"],[])}var fy=function(t,e){return t.getSystem().getByUid(e.uid+"-"+Gv()).map(function(e){return function(){return ce.value(e)}}).getOrThunk(function(){return e.lazySink.fold(function(){return function(){return ce.error(new Error("No internal sink is specified, nor could an external sink be found"))}},function(e){return function(){return e(t)}})})},Ri=function(){return[Ze("sandboxClasses",[]),Tl("sandboxBehaviours",[lf,bc,wl,El])]},dr=q([ze("dom"),ze("fetch"),Ka("onOpen"),Ja("onExecute"),Ze("getHotspot",G.some),Ze("getAnchorOverrides",q({})),qo(),Wr("dropdownBehaviours",[Vd,qv,Rd,Fd]),ze("toggleClass"),Ze("eventOrder",{}),Xe("lazySink"),Ze("matchWidth",!1),Ze("useMinWidth",!1),Xe("role")].concat(Ri())),t=q([xo({schema:[Xa()],name:"menu",defaults:function(e){return{onExecute:e.onExecute}}}),si()]),dy=yc({name:"Dropdown",configFields:dr(),partFields:t(),factory:function(t,e,n,o){function r(e){wl.getState(e).each(function(e){Qd.highlightPrimary(e)})}var i,u={expand:function(e){Vd.isOn(e)||Kv(t,function(e){return e},e,o,W,Iv.HighlightNone).get(W)},open:function(e){Vd.isOn(e)||Kv(t,function(e){return e},e,o,W,Iv.HighlightFirst).get(W)},isOpen:Vd.isOn,close:function(e){Vd.isOn(e)&&Kv(t,function(e){return e},e,o,W,Iv.HighlightFirst).get(W)},repositionMenus:function(e){Vd.isOn(e)&&eb(e)}},a=function(e,t){return Ct(e),G.some(!0)};return{uid:t.uid,dom:t.dom,components:e,behaviours:Rs(t.dropdownBehaviours,[Vd.config({toggleClass:t.toggleClass,aria:{mode:"expanded"}}),qv.config({others:{sandbox:function(e){return Zv(t,e,{onOpen:function(){Vd.on(e)},onClose:function(){Vd.off(e)}})}}}),Rd.config({mode:"special",onSpace:a,onEnter:a,onDown:function(e,t){var n;return dy.isOpen(e)?(n=qv.getCoupled(e,"sandbox"),r(n)):dy.open(e),G.some(!0)},onEscape:function(e,t){return dy.isOpen(e)?(dy.close(e),G.some(!0)):G.none()}}),Fd.config({})]),events:gd(G.some(function(e){Kv(t,function(e){return e},e,o,r,Iv.HighlightFirst).get(W)})),eventOrder:A(A({},t.eventOrder),((a={})[Yr()]=["disabling","toggling","alloy.base.behaviour"],a)),apis:u,domModification:{attributes:A(A({"aria-haspopup":"true"},t.role.fold(function(){return{}},function(e){return{role:e}})),"button"===t.dom.tag?{type:(i="type",ho(t.dom,"attributes").bind(function(e){return ho(e,i)}).getOr("button"))}:{})}}},apis:{open:function(e,t){return e.open(t)},expand:function(e,t){return e.expand(t)},close:function(e,t){return e.close(t)},isOpen:function(e,t){return e.isOpen(t)},repositionMenus:function(e,t){return e.repositionMenus(t)}}}),my=ya({fields:[],name:"unselecting",active:Object.freeze({__proto__:null,events:function(){return vi([Ot(jr(),v)])},exhibit:function(){return dn({styles:{"-webkit-user-select":"none","user-select":"none","-ms-user-select":"none","-moz-user-select":"-moz-none"},attributes:{unselectable:"on"}})}})}),gy=un("color-input-change"),py=un("color-swatch-change"),hy=un("color-picker-cancel"),vy=un("rgb-hex-update"),by=un("slider-update"),yy=un("palette-update"),Uv=Pl({schema:[ze("dom")],name:"label"}),ec=function(t){return Pl({name:t+"-edge",overrides:function(e){return e.model.manager.edgeActions[t].fold(function(){return{}},function(o){return{events:vi([Tt(Or(),function(e,t,n){return o(e,n)},[e]),Tt(Dr(),function(e,t,n){return o(e,n)},[e]),Tt(Ar(),function(e,t,n){n.mouseIsDown.get()&&o(e,n)},[e])])}})}})},pr=ec("top-left"),zo=ec("top"),Ur=ec("top-right"),xl=ec("right"),Yi=ec("bottom-right"),dr=ec("bottom"),t=ec("bottom-left"),Uv=[Uv,ec("left"),xl,zo,dr,pr,Ur,t,Yi,Fl({name:"thumb",defaults:q({dom:{styles:{position:"absolute"}}}),overrides:function(e){return{events:vi([At(Or(),e,"spectrum"),At(_r(),e,"spectrum"),At(Er(),e,"spectrum"),At(Dr(),e,"spectrum"),At(Ar(),e,"spectrum"),At(Nr(),e,"spectrum")])}}}),Fl({schema:[Fo("mouseIsDown",function(){return it(!1)})],name:"spectrum",overrides:function(n){function o(t,e){return r.getValueFromEvent(e).map(function(e){return r.setValueFrom(t,n,e)})}var r=n.model.manager;return{behaviours:gc([Rd.config({mode:"special",onLeft:function(e){return r.onLeft(e,n)},onRight:function(e){return r.onRight(e,n)},onUp:function(e){return r.onUp(e,n)},onDown:function(e){return r.onDown(e,n)}}),Fd.config({})]),events:vi([Et(Or(),o),Et(_r(),o),Et(Dr(),o),Et(Ar(),function(e,t){n.mouseIsDown.get()&&o(e,t)})])}}})],xy=q("slider.change.value"),ec=function(n){return function(e,t){return function(e,t,n){n=(0<e?Ab:Db)(_b(n).x,rb(n),cb(n),vb(n));return Ub(t,{x:n}),G.some(n)}(n,e,t).map(function(){return!0})}},xl=ec(-1),zo=ec(1),dr=G.none,pr=G.none,Ur={"top-left":G.none(),top:G.none(),"top-right":G.none(),right:G.some(function(e,t){Tb(e,{x:lb(t)})}),"bottom-right":G.none(),bottom:G.none(),"bottom-left":G.none(),left:G.some(function(e,t){Tb(e,{x:ub(t)})})},t=Object.freeze({__proto__:null,setValueFrom:function(e,t,n){n=Wb(e,t,n);return Ub(e,{x:n}),n},setToMin:function(e,t){t=rb(t);Ub(e,{x:t})},setToMax:function(e,t){t=cb(t);Ub(e,{x:t})},findValueOfOffset:Wb,getValueFromEvent:function(e){return ob(e).map(function(e){return e.left})},findPositionOfValue:qb,setPositionFromValue:function(e,t,n,o){var r=_b(n),e=qb(e,o.getSpectrum(e),r.x,o.getLeftEdge(e),o.getRightEdge(e),n),n=mu(t.element)/2;Fn(t.element,"left",e-n+"px")},onLeft:xl,onRight:zo,onUp:dr,onDown:pr,edgeActions:Ur}),Yi=function(n){return function(e,t){return function(e,t,n){n=(0<e?Ab:Db)(_b(n).y,ib(n),sb(n),vb(n));return Gb(t,{y:n}),G.some(n)}(n,e,t).map(function(){return!0})}},ec=G.none,xl=G.none,zo=Yi(-1),dr=Yi(1),pr={"top-left":G.none(),top:G.some(function(e,t){Tb(e,{y:ab(t)})}),"top-right":G.none(),right:G.none(),"bottom-right":G.none(),bottom:G.some(function(e,t){Tb(e,{y:fb(t)})}),"bottom-left":G.none(),left:G.none()},Ur=Object.freeze({__proto__:null,setValueFrom:function(e,t,n){n=$b(e,t,n);return Gb(e,{y:n}),n},setToMin:function(e,t){t=ib(t);Gb(e,{y:t})},setToMax:function(e,t){t=sb(t);Gb(e,{y:t})},findValueOfOffset:$b,getValueFromEvent:function(e){return ob(e).map(function(e){return e.top})},findPositionOfValue:Xb,setPositionFromValue:function(e,t,n,o){var r=_b(n),e=Xb(e,o.getSpectrum(e),r.y,o.getTopEdge(e),o.getBottomEdge(e),n),n=su(t.element)/2;Fn(t.element,"top",e-n+"px")},onLeft:ec,onRight:xl,onUp:zo,onDown:dr,edgeActions:pr}),Yi=function(i,u){return function(e,t){return o=e,r=t,e=0<(n=i)?Ab:Db,n=(t=u)?_b(r).x:e(_b(r).x,rb(r),cb(r),vb(r)),r=t?e(_b(r).y,ib(r),sb(r),vb(r)):_b(r).y,Yb(o,Kb(n,r)),G.some(n).map(function(){return!0});var n,o,r}},ec=ob,xl=Yi(-1,!1),zo=Yi(1,!1),dr=Yi(-1,!0),pr=Yi(1,!0),Yi={"top-left":G.some(function(e,t){Tb(e,Eb(ub(t),ab(t)))}),top:G.some(function(e,t){Tb(e,Eb(pb(t),ab(t)))}),"top-right":G.some(function(e,t){Tb(e,Eb(lb(t),ab(t)))}),right:G.some(function(e,t){Tb(e,Eb(lb(t),hb(t)))}),"bottom-right":G.some(function(e,t){Tb(e,Eb(lb(t),fb(t)))}),bottom:G.some(function(e,t){Tb(e,Eb(pb(t),fb(t)))}),"bottom-left":G.some(function(e,t){Tb(e,Eb(ub(t),fb(t)))}),left:G.some(function(e,t){Tb(e,Eb(ub(t),hb(t)))})},pr=Object.freeze({__proto__:null,setValueFrom:function(e,t,n){var o=Wb(e,t,n.left),n=$b(e,t,n.top),n=Kb(o,n);return Yb(e,n),n},setToMin:function(e,t){var n=rb(t),t=ib(t);Yb(e,Kb(n,t))},setToMax:function(e,t){var n=cb(t),t=sb(t);Yb(e,Kb(n,t))},getValueFromEvent:ec,setPositionFromValue:function(e,t,n,o){var r=_b(n),i=qb(e,o.getSpectrum(e),r.x,o.getLeftEdge(e),o.getRightEdge(e),n),o=Xb(e,o.getSpectrum(e),r.y,o.getTopEdge(e),o.getBottomEdge(e),n),e=mu(t.element)/2,n=su(t.element)/2;Fn(t.element,"left",i-e+"px"),Fn(t.element,"top",o-n+"px")},onLeft:xl,onRight:zo,onUp:dr,onDown:pr,edgeActions:Yi}),wy=yc({name:"Slider",configFields:[Ze("stepSize",1),Ze("onChange",W),Ze("onChoose",W),Ze("onInit",W),Ze("onDragStart",W),Ze("onDragEnd",W),Ze("snapToGrid",!1),Ze("rounded",!0),Xe("snapStart"),je("model",Ve("mode",{x:[Ze("minX",0),Ze("maxX",100),Fo("value",function(e){return it(e.mode.minX)}),ze("getInitialValue"),$u("manager",t)],y:[Ze("minY",0),Ze("maxY",100),Fo("value",function(e){return it(e.mode.minY)}),ze("getInitialValue"),$u("manager",Ur)],xy:[Ze("minX",0),Ze("maxX",100),Ze("minY",0),Ze("maxY",100),Fo("value",function(e){return it({x:e.mode.minX,y:e.mode.minY})}),ze("getInitialValue"),$u("manager",pr)]})),Wr("sliderBehaviours",[Rd,El]),Fo("mouseIsDown",function(){return it(!1)})],partFields:Uv,factory:function(r,e,t,n){function i(e){return $s(e,r,"thumb")}function u(e){return $s(e,r,"spectrum")}function o(e){return Gs(e,r,"left-edge")}function a(e){return Gs(e,r,"right-edge")}function c(e){return Gs(e,r,"top-edge")}function s(e){return Gs(e,r,"bottom-edge")}function l(e,t){h.setPositionFromValue(e,t,r,{getLeftEdge:o,getRightEdge:a,getTopEdge:c,getBottomEdge:s,getSpectrum:u})}function f(e,t){p.value.set(t);var n=i(e);return l(e,n),r.onChange(e,n,t),G.some(!0)}function d(n){var e=r.mouseIsDown.get();r.mouseIsDown.set(!1),e&&Gs(n,r,"thumb").each(function(e){var t=p.value.get();r.onChoose(n,e,t)})}function m(e,t){t.stop(),r.mouseIsDown.set(!0),r.onDragStart(e,i(e))}function g(e,t){t.stop(),r.onDragEnd(e,i(e)),d(e)}var p=r.model,h=p.manager;return{uid:r.uid,dom:r.dom,components:e,behaviours:Rs(r.sliderBehaviours,[Rd.config({mode:"special",focusIn:function(e){return Gs(e,r,"spectrum").map(Rd.focusIn).map(v)}}),El.config({store:{mode:"manual",getValue:function(e){return p.value.get()}}}),bc.config({channels:((e={})[kl()]={onReceive:d},e)})]),events:vi([Et(xy(),function(e,t){f(e,t.event.value)}),bi(function(e,t){var n=p.getInitialValue();p.value.set(n);var o=i(e);l(e,o);n=u(e);r.onInit(e,o,n,p.value.get())}),Et(Or(),m),Et(Er(),g),Et(Dr(),m),Et(Nr(),g)]),apis:{resetToMin:function(e){h.setToMin(e,r)},resetToMax:function(e){h.setToMax(e,r)},changeValue:f,refresh:l},domModification:{styles:{position:"relative"}}}},apis:{resetToMin:function(e,t){e.resetToMin(t)},resetToMax:function(e,t){e.resetToMax(t)},refresh:function(e,t){e.refresh(t)}}}),Cy=[Wr("formBehaviours",[El])],Sy=function(o,e){return{uid:o.uid,dom:o.dom,components:e,behaviours:Rs(o.formBehaviours,[El.config({store:{mode:"manual",getValue:function(e){e=Ys(e,o);return de(e,function(e,o){return e().bind(function(e){var t,n=lf.getCurrent(e);return n=n,t=new Error("Cannot find a current component to extract the value from for form part '"+o+"': "+rn(e.element)),n.fold(function(){return ce.error(t)},ce.value)}).map(El.getValue)})},setValue:function(n,e){mo(e,function(t,e){Gs(n,o,e).each(function(e){lf.getCurrent(e).each(function(e){El.setValue(e,t)})})})}}})]),apis:{getField:function(e,t){return Gs(e,o,t).bind(lf.getCurrent)}}}},ky={getField:ln(function(e,t,n){return e.getField(t,n)}),sketch:function(e){var n,t=(n=[],{field:function(e,t){return n.push(e),zs("form",Jb(e),t)},record:function(){return n}}),e=e(t),t=t.record(),t=S(t,function(e){return Fl({name:e,pname:Jb(e)})});return tl("form",Cy,t,Sy,e)}},Oy=un("valid-input"),_y=un("invalid-input"),Ey=un("validating-input"),Ty="colorcustom.rgb.",Dy=function(){return lf.config({find:G.some})},Ay=function(e){return lf.config({find:e.getOpt})},By=function(e){return lf.config({find:function(t){return jt(t.element,e).bind(function(e){return t.getSystem().getByDom(e).toOptional()})}})},Ny={"colorcustom.rgb.red.label":"R","colorcustom.rgb.red.description":"Red component","colorcustom.rgb.green.label":"G","colorcustom.rgb.green.description":"Green component","colorcustom.rgb.blue.label":"B","colorcustom.rgb.blue.description":"Blue component","colorcustom.rgb.hex.label":"#","colorcustom.rgb.hex.description":"Hex color code","colorcustom.rgb.range":"Range 0 to 255","colorcustom.sb.saturation":"Saturation","colorcustom.sb.brightness":"Brightness","colorcustom.sb.picker":"Saturation and Brightness Picker","colorcustom.sb.palette":"Saturation and Brightness Palette","colorcustom.sb.instructions":"Use arrow keys to select saturation and brightness, on x and y axes","colorcustom.hue.hue":"Hue","colorcustom.hue.slider":"Hue Slider","colorcustom.hue.palette":"Hue Palette","colorcustom.hue.instructions":"Use arrow keys to select a hue","aria.color.picker":"Color Picker","aria.input.invalid":"Invalid input"},Ry=tinymce.util.Tools.resolve("tinymce.Resource"),My=tinymce.util.Tools.resolve("tinymce.util.Tools"),Iy=No([Ze("preprocess",l),Ze("postprocess",l)]),Fy=function(n,e){var o=Le("RepresentingConfigs.memento processors",Iy,e);return El.config({store:{mode:"manual",getValue:function(e){e=n.get(e),e=El.getValue(e);return o.postprocess(e)},setValue:function(e,t){t=o.preprocess(t),e=n.get(e);El.setValue(e,t)}}})},Py=ny,Ly=function(e){return oy(e,Yt,Kt)},Vy=function(e){return El.config({store:{mode:"memory",initialValue:e}})},Hy=un("alloy-fake-before-tabstop"),zy=un("alloy-fake-after-tabstop"),jy=!(Cr().browser.isIE()||Cr().browser.isEdge());function Uy(e,t){return Gy(document.createElement("canvas"),e,t)}function Wy(e){var t=Uy(e.width,e.height);return qy(t).drawImage(e,0,0),t}function qy(e){return e.getContext("2d")}function Gy(e,t,n){return e.width=t,e.height=n,e}function $y(e){return e.naturalWidth||e.width}function Xy(e){return e.naturalHeight||e.height}var Yy,Ky,Jy,Qy=window.Promise||(Yy=window,Ky=Zy.immediateFn||"function"==typeof Yy.setImmediate&&Yy.setImmediate||function(e){setTimeout(e,1)},Jy=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},Zy.prototype.catch=function(e){return this.then(null,e)},Zy.prototype.then=function(n,o){var r=this;return new Zy(function(e,t){t0.call(r,new i0(n,o,e,t))})},Zy.all=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var a=Array.prototype.slice.call(1===e.length&&Jy(e[0])?e[0]:e);return new Zy(function(r,i){if(0===a.length)return r([]);var u=a.length;for(var e=0;e<a.length;e++)!function t(n,e){try{if(e&&("object"==typeof e||"function"==typeof e)){var o=e.then;if("function"==typeof o)return void o.call(e,function(e){t(n,e)},i)}a[n]=e,0==--u&&r(a)}catch(e){i(e)}}(e,a[e])})},Zy.resolve=function(t){return t&&"object"==typeof t&&t.constructor===Zy?t:new Zy(function(e){e(t)})},Zy.reject=function(n){return new Zy(function(e,t){t(n)})},Zy.race=function(r){return new Zy(function(e,t){for(var n=0,o=r;n<o.length;n++)o[n].then(e,t)})},Zy);function Zy(e){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");this._state=null,this._value=null,this._deferreds=[],u0(e,e0(n0,this),e0(o0,this))}function e0(e,t){return function(){return e.apply(t,arguments)}}function t0(n){var o=this;null!==this._state?Ky(function(){var e,t=o._state?n.onFulfilled:n.onRejected;if(null!==t){try{e=t(o._value)}catch(e){return void n.reject(e)}n.resolve(e)}else(o._state?n.resolve:n.reject)(o._value)}):this._deferreds.push(n)}function n0(e){try{if(e===this)throw new TypeError("A promise cannot be resolved with itself.");if(e&&("object"==typeof e||"function"==typeof e)){var t=e.then;if("function"==typeof t)return void u0(e0(t,e),e0(n0,this),e0(o0,this))}this._state=!0,this._value=e,r0.call(this)}catch(e){o0.call(this,e)}}function o0(e){this._state=!1,this._value=e,r0.call(this)}function r0(){for(var e=0,t=this._deferreds;e<t.length;e++){var n=t[e];t0.call(this,n)}this._deferreds=[]}function i0(e,t,n,o){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.resolve=n,this.reject=o}function u0(e,t,n){var o=!1;try{e(function(e){o||(o=!0,t(e))},function(e){o||(o=!0,n(e))})}catch(e){if(o)return;o=!0,n(e)}}function a0(n){return new Qy(function(e,t){!function(e){var t=e.split(",");if(!(e=/data:([^;]+)/.exec(t[0])))return G.none();for(var e=e[1],t=t[1],n=atob(t),o=n.length,r=Math.ceil(o/1024),i=new Array(r),u=0;u<r;++u){for(var a=1024*u,c=Math.min(1024+a,o),s=new Array(c-a),l=a,f=0;l<c;++f,++l)s[f]=n[l].charCodeAt(0);i[u]=new Uint8Array(s)}return G.some(new Blob(i,{type:e}))}(n).fold(function(){t("uri is not base64: "+n)},e)})}function c0(e,o,r){return o=o||"image/png",J(HTMLCanvasElement.prototype.toBlob)?new Qy(function(t,n){e.toBlob(function(e){e?t(e):n()},o,r)}):a0(e.toDataURL(o,r))}function s0(e){return a=e,new Qy(function(e,t){var n=URL.createObjectURL(a),o=new Image,r=function(){o.removeEventListener("load",i),o.removeEventListener("error",u)};function i(){r(),e(o)}function u(){r(),t("Unable to load data of type "+a.type+": "+n)}o.addEventListener("load",i),o.addEventListener("error",u),o.src=n,o.complete&&i()}).then(function(e){URL.revokeObjectURL(e.src);var t=Uy($y(e),Xy(e));return qy(t).drawImage(e,0,0),t});var a}function l0(e,t,n){var o=t.type;function r(t,n){return e.then(function(e){return e.toDataURL(t||"image/png",n)})}return{getType:q(o),toBlob:function(){return Qy.resolve(t)},toDataURL:q(n),toBase64:function(){return n.split(",")[1]},toAdjustedBlob:function(t,n){return e.then(function(e){return c0(e,t,n)})},toAdjustedDataURL:r,toAdjustedBase64:function(e,t){return r(e,t).then(function(e){return e.split(",")[1]})},toCanvas:function(){return e.then(Wy)}}}function f0(t){return n=t,new Qy(function(e){var t=new FileReader;t.onloadend=function(){e(t.result)},t.readAsDataURL(n)}).then(function(e){return l0(s0(t),t,e)});var n}function d0(t,e){return c0(t,e).then(function(e){return l0(Qy.resolve(t),e,t.toDataURL())})}var m0=f0;function g0(e,t,n){e="string"==typeof e?parseFloat(e):e;return n<e?e=n:e<t&&(e=t),e}function p0(){return[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1]}var h0=[0,.01,.02,.04,.05,.06,.07,.08,.1,.11,.12,.14,.15,.16,.17,.18,.2,.21,.22,.24,.25,.27,.28,.3,.32,.34,.36,.38,.4,.42,.44,.46,.48,.5,.53,.56,.59,.62,.65,.68,.71,.74,.77,.8,.83,.86,.89,.92,.95,.98,1,1.06,1.12,1.18,1.24,1.3,1.36,1.42,1.48,1.54,1.6,1.66,1.72,1.78,1.84,1.9,1.96,2,2.12,2.25,2.37,2.5,2.62,2.75,2.87,3,3.2,3.4,3.6,3.8,4,4.3,4.7,4.9,5,5.5,6,6.5,6.8,7,7.3,7.5,7.8,8,8.4,8.7,9,9.4,9.6,9.8,10];function v0(e,t){for(var n=[],o=new Array(25),r=0;r<5;r++){for(var i=0;i<5;i++)n[i]=t[i+5*r];for(i=0;i<5;i++){for(var u=0,a=0;a<5;a++)u+=e[i+5*a]*n[a];o[i+5*r]=u}}return o}function b0(t,n){return t.toCanvas().then(function(e){return function(e,t,n){var o=qy(e);n=function(e,t){for(var n,o,r,i,u=e.data,a=t[0],c=t[1],s=t[2],l=t[3],f=t[4],d=t[5],m=t[6],g=t[7],p=t[8],h=t[9],v=t[10],b=t[11],y=t[12],x=t[13],w=t[14],C=t[15],S=t[16],k=t[17],O=t[18],_=t[19],E=0;E<u.length;E+=4)n=u[E],o=u[E+1],r=u[E+2],i=u[E+3],u[E]=n*a+o*c+r*s+i*l+f,u[E+1]=n*d+o*m+r*g+i*p+h,u[E+2]=n*v+o*b+r*y+i*x+w,u[E+3]=n*C+o*S+r*k+i*O+_;return e}(o.getImageData(0,0,e.width,e.height),n);return o.putImageData(n,0,0),d0(e,t)}(e,t.getType(),n)})}function y0(u,a){return u.toCanvas().then(function(e){return t=e,n=u.getType(),o=a,r=qy(t),i=r.getImageData(0,0,t.width,t.height),e=r.getImageData(0,0,t.width,t.height),e=function(e,t,n){function o(e,t,n){return n<e?e=n:e<t&&(e=t),e}for(var r=Math.round(Math.sqrt(n.length)),i=Math.floor(r/2),u=e.data,a=t.data,c=e.width,s=e.height,l=0;l<s;l++)for(var f=0;f<c;f++){for(var d=0,m=0,g=0,p=0;p<r;p++)for(var h=0;h<r;h++){var v=o(f+h-i,0,c-1),b=4*(o(l+p-i,0,s-1)*c+v),v=n[p*r+h];d+=u[b]*v,m+=u[1+b]*v,g+=u[2+b]*v}var y=4*(l*c+f);a[y]=o(d,0,255),a[1+y]=o(m,0,255),a[2+y]=o(g,0,255)}return t}(i,e,o),r.putImageData(e,0,0),d0(t,n);var t,n,o,r,i})}function x0(n){return function(e,t){return b0(e,n(p0(),t))}}var w0,C0,S0,k0=(w0=[-1,0,0,0,255,0,-1,0,0,255,0,0,-1,0,255,0,0,0,1,0,0,0,0,0,1],function(e){return b0(e,w0)}),O0=x0(function(e,t){return v0(e,[1,0,0,0,t=g0(255*t,-255,255),0,1,0,0,t,0,0,1,0,t,0,0,0,1,0,0,0,0,0,1])}),_0=x0(function(e,t){var n;return t=g0(t,-1,1),v0(e,[(n=(t*=100)<0?127+t/100*127:127*(n=0===(n=t%1)?h0[t]:h0[Math.floor(t)]*(1-n)+h0[Math.floor(t)+1]*n)+127)/127,0,0,0,.5*(127-n),0,n/127,0,0,.5*(127-n),0,0,n/127,0,.5*(127-n),0,0,0,1,0,0,0,0,0,1])}),E0=(C0=[0,-1,0,-1,5,-1,0,-1,0],function(e){return y0(e,C0)}),T0=(S0=function(e,t){return 255*Math.pow(e/255,1-t)},function(t,n){return t.toCanvas().then(function(e){return D0(e,t.getType(),n)})});function D0(e,t,n){for(var o=qy(e),r=new Array(256),i=0;i<r.length;i++)r[i]=S0(i,n);var u=function(e,t){for(var n=e.data,o=0;o<n.length;o+=4)n[o]=t[n[o]],n[o+1]=t[n[o+1]],n[o+2]=t[n[o+2]];return e}(o.getImageData(0,0,e.width,e.height),r);return o.putImageData(u,0,0),d0(e,t)}function A0(e,t,n){var o=$y(e),r=Xy(e),i=t/o,o=n/r,r=!1;(i<.5||2<i)&&(i=i<.5?.5:2,r=!0),(o<.5||2<o)&&(o=o<.5?.5:2,r=!0);var u,a,c,o=(u=e,a=i,c=o,new Qy(function(e){var t=$y(u),n=Xy(u),o=Math.floor(t*a),r=Math.floor(n*c),i=Uy(o,r);qy(i).drawImage(u,0,0,t,n,0,0,o,r),e(i)}));return r?o.then(function(e){return A0(e,t,n)}):o}function B0(t,n){return t.toCanvas().then(function(e){return function(e,t,n){var o=Uy(e.width,e.height),r=qy(o),i=0,u=0;90!==(n=n<0?360+n:n)&&270!==n||Gy(o,o.height,o.width);90!==n&&180!==n||(i=o.width);270!==n&&180!==n||(u=o.height);return r.translate(i,u),r.rotate(n*Math.PI/180),r.drawImage(e,0,0),d0(o,t)}(e,t.getType(),n)})}function N0(t,n){return t.toCanvas().then(function(e){return function(e,t,n){var o=Uy(e.width,e.height),r=qy(o);"v"===n?(r.scale(1,-1),r.drawImage(e,0,-o.height)):(r.scale(-1,1),r.drawImage(e,-o.width,0));return d0(o,t)}(e,t.getType(),n)})}function R0(t,n,o,r,i){return t.toCanvas().then(function(e){return function(e,t,n,o,r,i){i=Uy(r,i);return qy(i).drawImage(e,-n,-o),d0(i,t)}(e,t.getType(),n,o,r,i)})}function M0(e){return k0(e)}function I0(e){return E0(e)}function F0(e,t){return T0(e,t)}function P0(e,t,n,o){return b0(e,(e=p0(),n=n,o=o,v0(e,[g0(t,0,2),0,0,0,0,0,n=g0(n,0,2),0,0,0,0,0,o=g0(o,0,2),0,0,0,0,0,1,0,0,0,0,0,1])))}function L0(e,t){return O0(e,t)}function V0(e,t){return _0(e,t)}function H0(e,t,n){return r=t,i=n,(o=e).toCanvas().then(function(e){return A0(e,r,i).then(function(e){return d0(e,o.getType())})});var o,r,i}function z0(e,t){return A({dom:{tag:"span",innerHtml:e,classes:["tox-icon","tox-tbtn__icon-wrap"]}},t)}function j0(e,t){return z0(Dd(e,t),{})}function U0(e,t){return z0(Dd(e,t),{behaviours:gc([Id.config({})])})}function W0(e,t,n){return{dom:{tag:"span",innerHtml:n.translate(e),classes:[t+"__select-label"]},behaviours:gc([Id.config({})])}}function q0(t,n,o){function e(e,t){return e=El.getValue(e),Fd.focus(e),wt(e,"keydown",{raw:t.event.raw}),dy.close(e),G.some(!0)}var r=it(W),i=t.text.map(function(e){return Ed(W0(e,n,o.providers))}),u=t.icon.map(function(e){return Ed(U0(e,o.providers.icons))}),a=t.role.fold(function(){return{}},function(e){return{role:e}}),c=t.tooltip.fold(function(){return{}},function(e){e=o.providers.translate(e);return{title:e,"aria-label":e}});return Ed(dy.sketch(A(A(A({},t.uid?{uid:t.uid}:{}),a),{dom:{tag:"button",classes:[n,n+"--select"].concat(S(t.classes,function(e){return n+"--"+e})),attributes:A({},c)},components:ap([u.map(function(e){return e.asSpec()}),i.map(function(e){return e.asSpec()}),G.some({dom:{tag:"div",classes:[n+"__select-chevron"],innerHtml:Dd("chevron-down",o.providers.icons)}})]),matchWidth:!0,useMinWidth:!0,dropdownBehaviours:gc(h(t.dropdownBehaviours,[Ip(function(){return t.disabled||o.providers.isDisabled()}),op(),my.config({}),Id.config({}),id("dropdown-events",[ip(t,r),up(t,r)]),id("menubutton-update-display-text",[Et(bx,function(t,n){i.bind(function(e){return e.getOpt(t)}).each(function(e){Id.set(e,[Qn(o.providers.translate(n.event.text))])})}),Et(yx,function(t,n){u.bind(function(e){return e.getOpt(t)}).each(function(e){Id.set(e,[U0(n.event.icon,o.providers.icons)])})})])])),eventOrder:wo(vx,{mousedown:["focusing","alloy.base.behaviour","item-type-events","normal-dropdown-events"]}),sandboxBehaviours:gc([Rd.config({mode:"special",onLeft:e,onRight:e})]),lazySink:o.getSink,toggleClass:n+"--active",parts:{menu:Lm(0,t.columns,t.presets)},fetch:function(e){return Hv(m(t.fetch,e))}}))).asSpec()}function G0(e){return"separator"===e.type}function $0(e,n){return 0<(e=O(e,function(e,t){return U(t)?""===t?e:"|"===t?0<e.length&&!G0(e[e.length-1])?e.concat([xx]):e:vo(n,t.toLowerCase())?e.concat([n[t.toLowerCase()]]):e:e.concat([t])},[])).length&&G0(e[e.length-1])&&e.pop(),e}function X0(e,t){return vo(e,"getSubmenuItems")?(o=t,t=(n=e).getSubmenuItems(),o=wx(t,o),{item:n,menus:wo(o.menus,To(n.value,o.items)),expansions:wo(o.expansions,To(n.value,n.value))}):{item:e,menus:{},expansions:{}};var n,o}function Y0(e,n,o,t){var r=un("primary-menu"),i=wx(e,o.shared.providers.menuItems());return 0===i.items.length?G.none():(e=Rh(r,i.items,n,o,t),t=de(i.menus,function(e,t){return Rh(t,e,n,o,!1)}),e=wo(t,To(r,e)),G.from(Qd.tieredData(r,e,i.expansions)))}function K0(n){return{isDisabled:function(){return Ug.isDisabled(n)},setDisabled:function(e){return Ug.set(n,e)},setActive:function(e){var t=n.element;e?(kn(t,"tox-tbtn--enabled"),Qt(t,"aria-pressed",!0)):(_n(t,"tox-tbtn--enabled"),nn(t,"aria-pressed"))},isActive:function(){return En(n.element,"tox-tbtn--enabled")}}}function J0(n,e,o,t){return q0({text:n.text,icon:n.icon,tooltip:n.tooltip,role:t,fetch:function(e,t){n.fetch(function(e){t(Y0(e,dg.CLOSE_ON_EXECUTE,o,!1))})},onSetup:n.onSetup,getApi:K0,columns:1,presets:"normal",classes:[],dropdownBehaviours:[pv.config({})]},e,o.shared)}function Q0(t,r,i){return function(e){e(S(t,function(e){var t,n,o=e.text.fold(function(){return{}},function(e){return{text:e}});return A(A({type:e.type,active:!1},o),{onAction:function(e){var t=!e.isActive();e.setActive(t),n.storage.set(t),i.shared.getSink().each(function(e){r().getOpt(e).each(function(e){xa(e.element),wt(e,Cv,{name:n.name,value:n.storage.get()})})})},onSetup:(t=n=e,function(e){e.setActive(t.storage.get())})})}))}}function Z0(e,t,n,o,r,i){return void 0===n&&(n=[]),t=t.fold(function(){return{}},function(e){return{action:e}}),t=A({buttonBehaviours:gc([Ip(function(){return e.disabled||i.isDisabled()}),op(),pv.config({}),id("button press",[_t("click"),_t("mousedown")])].concat(n)),eventOrder:{click:["button press","alloy.base.behaviour"],mousedown:["button press","alloy.base.behaviour"]}},t),o=wo(t,{dom:o}),wo(o,{components:r})}function ex(e,t,n,o){void 0===o&&(o=[]);var r={tag:"button",classes:["tox-tbtn"],attributes:e.tooltip.map(function(e){return{"aria-label":n.translate(e),title:n.translate(e)}}).getOr({})},i=e.icon.map(function(e){return j0(e,n.icons)}),i=ap([i]);return Z0(e,t,o,r,i,n)}function tx(e,t,n,o){return void 0===o&&(o=[]),o=ex(e,G.some(t),n,o),om.sketch(o)}function nx(e,t,n,o,r){void 0===o&&(o=[]),void 0===r&&(r=[]);var i=n.translate(e.text),u=e.icon?e.icon.map(function(e){return j0(e,n.icons)}):G.none(),a=u.isSome()?ap([u]):[],c=u.isSome()?{}:{innerHtml:i},r=h(e.primary||e.borderless?["tox-button"]:["tox-button","tox-button--secondary"],u.isSome()?["tox-button--icon"]:[],e.borderless?["tox-button--naked"]:[],r),i=A(A({tag:"button",classes:r},c),{attributes:{title:i}});return Z0(e,t,o,i,a,n)}function ox(e,t,n,o,r){return void 0===o&&(o=[]),void 0===r&&(r=[]),r=nx(e,G.some(t),n,o,r),om.sketch(r)}function rx(t,n){return function(e){"custom"===n?wt(e,Cv,{name:t,value:{}}):"submit"===n?xt(e,Sv):"cancel"===n?xt(e,wv):console.error("Unknown button type: ",n)}}function ix(t,e,n){if("menu"===e){var o=t,r=A(A({},t),{onSetup:function(e){return e.setDisabled(t.disabled),W},fetch:Q0(o.items,function(){return i},n)}),i=Ed(J0(r,"tox-tbtn",n,G.none()));return i.asSpec()}if("custom"===(o=e)||"cancel"===o||"submit"===o){r=rx(t.name,e),o=A(A({},t),{borderless:!1});return ox(o,r,n.shared.providers,[])}console.error("Unknown footer button type: ",e)}function ux(e,t){var n,o=rx(e.name,"custom");return n=G.none(),t=gv.parts.field(A({factory:om},nx(e,G.some(o),t,[Vy(""),Dy()]))),rv(n,t,[],[])}function ax(e){var t=/^\s*(\d+(?:\.\d+)?)\s*(|cm|mm|in|px|pt|pc|em|ex|ch|rem|vw|vh|vmin|vmax|%)\s*$/.exec(e);return null===t?ce.error(e):(e=parseFloat(t[1]),t=t[2],ce.value({value:e,unit:t}))}function cx(e,t){function n(e){return Object.prototype.hasOwnProperty.call(o,e)}var o={"":96,px:96,pt:72,cm:2.54,pc:12,mm:25.4,in:1};return e.unit===t?G.some(e.value):n(e.unit)&&n(t)?o[e.unit]===o[t]?G.some(e.value):G.some(e.value/o[e.unit]*o[t]):G.none()}function sx(e){return G.none()}function lx(e,t){var n=ax(e).toOptional(),e=ax(t).toOptional();return t=e,e=function(e,o){return cx(e,o.unit).map(function(e){return o.value/e}).map(function(e){return t=e,n=o.unit,function(e){return cx(e,n).map(function(e){return{value:e*t,unit:n}})};var t,n}).getOr(sx)},((n=n).isSome()&&t.isSome()?G.some(e(n.getOrDie(),t.getOrDie())):G.none()).getOr(sx)}function fx(o,t){function e(e){return{dom:{tag:"div",classes:["tox-form__group"]},components:e}}function n(e){return{dom:{tag:"label",classes:["tox-label"],innerHtml:t.translate(e)}}}var r=sx,i=un("ratio-event"),u=Cx.parts.lock({dom:{tag:"button",classes:["tox-lock","tox-button","tox-button--naked","tox-button--icon"],attributes:{title:t.translate(o.label.getOr("Constrain proportions"))}},components:[{dom:{tag:"span",classes:["tox-icon","tox-lock-icon__lock"],innerHtml:Dd("lock",t.icons)}},{dom:{tag:"span",classes:["tox-icon","tox-lock-icon__unlock"],innerHtml:Dd("unlock",t.icons)}}],buttonBehaviours:gc([Ug.config({disabled:function(){return o.disabled||t.isDisabled()}}),op(),pv.config({})])}),a=function(n){return gv.parts.field({factory:Tv,inputClasses:["tox-textfield"],inputBehaviours:gc([Ug.config({disabled:function(){return o.disabled||t.isDisabled()}}),op(),pv.config({}),id("size-input-events",[Et(Mr(),function(e,t){wt(e,i,{isField1:n})}),Et(Vr(),function(e,t){wt(e,yv,{name:o.name})})])]),selectOnFocus:!1})},c=Cx.parts.field1(e([gv.parts.label(n("Width")),a(!0)])),a=Cx.parts.field2(e([gv.parts.label(n("Height")),a(!1)]));return Cx.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:[{dom:{tag:"div",classes:["tox-form__controls-h-stack"]},components:[c,a,e([n("&nbsp;"),u])]}],field1Name:"width",field2Name:"height",locked:!0,markers:{lockClass:"tox-locked"},onLockedChange:function(e,o,t){ax(El.getValue(e)).each(function(e){r(e).each(function(e){var t,n;El.setValue(o,(n={"":0,px:0,pt:1,mm:1,pc:2,ex:2,em:2,ch:2,rem:2,cm:3,in:4,"%":4},(e=-1!==(e=(t=e).value.toFixed((e=t.unit)in n?n[e]:1)).indexOf(".")?e.replace(/\.?0*$/,""):e)+t.unit))})})},coupledFieldBehaviours:gc([Ug.config({disabled:function(){return o.disabled||t.isDisabled()},onDisabled:function(e){Cx.getField1(e).bind(gv.getField).each(Ug.disable),Cx.getField2(e).bind(gv.getField).each(Ug.disable),Cx.getLock(e).each(Ug.disable)},onEnabled:function(e){Cx.getField1(e).bind(gv.getField).each(Ug.enable),Cx.getField2(e).bind(gv.getField).each(Ug.enable),Cx.getLock(e).each(Ug.enable)}}),op(),id("size-input-events2",[Et(i,function(e,t){var n=t.event.isField1,t=n?Cx.getField1(e):Cx.getField2(e),e=n?Cx.getField2(e):Cx.getField1(e),t=t.map(El.getValue).getOr(""),e=e.map(El.getValue).getOr("");r=lx(t,e)})])])})}function dx(o,a){function e(e,t,n,o){return Ed(ox({name:e,text:e,disabled:n,primary:o,icon:G.none(),borderless:!1},t,a))}function t(e,t,n,o){return Ed(tx({name:e,icon:G.some(e),tooltip:G.some(t),disabled:o,primary:!1,borderless:!1},n,a))}function u(e,t){e.map(function(e){e=e.get(t);e.hasConfigured(Ug)&&Ug.disable(e)})}function c(e,t){e.map(function(e){e=e.get(t);e.hasConfigured(Ug)&&Ug.enable(e)})}function r(e,t,n){wt(e,t,n)}function n(e){return xt(e,kx.disable()),0}function i(e){return xt(e,kx.enable()),0}function s(e,t){n(e),r(e,Sx.transform(),{transform:t}),i(e)}function l(e){return function(){U.getOpt(e).each(function(e){Id.set(e,[j])})}}function f(e,t){n(e),r(e,Sx.transformApply(),{transform:t,swap:l(e)}),i(e)}function d(){return e("Back",function(e){return r(e,Sx.back(),{swap:l(e)})},!1,!1)}function m(){return e("Apply",function(e){return r(e,Sx.apply(),{swap:l(e)})},!0,!0)}function g(t,n){return function(e){return t(e,n)}}function p(e,t){t=t,n(e=e),r(e,Sx.tempTransform(),{transform:t}),i(e)}function h(e,t,n,o,r){var i=wy.parts.label({dom:{tag:"label",classes:["tox-label"],innerHtml:a.translate(e)}}),u=wy.parts.spectrum({dom:{tag:"div",classes:["tox-slider__rail"],attributes:{role:"presentation"}}}),e=wy.parts.thumb({dom:{tag:"div",classes:["tox-slider__handle"],attributes:{role:"presentation"}}});return Ed(wy.sketch({dom:{tag:"div",classes:["tox-slider"],attributes:{role:"presentation"}},model:{mode:"x",minX:n,maxX:r,getInitialValue:q({x:o})},components:[i,u,e],sliderBehaviours:gc([Fd.config({})]),onChoose:t}))}function v(e,t,n,o,r){return[d(),(i=t,h(e,function(e,t,n){n=g(i,n.x/100);s(e,n)},n,o,r)),m()];var i}var b={tag:"div",classes:["tox-image-tools__toolbar","tox-image-tools-edit-panel"]},y=W,x=function(){return Ed({dom:{tag:"div",classes:["tox-spacer"]},behaviours:gc([Ug.config({})])})},w=[d(),x(),e("Apply",function(e){f(e,function(e){var t=o.getRect();return gx(e,t.x,t.y,t.w,t.h)}),o.hideCrop()},!1,!0)],C=mv.sketch({dom:b,components:w.map(function(e){return e.asSpec()}),containerBehaviours:gc([id("image-tools-crop-buttons-events",[Et(kx.disable(),function(e,t){u(w,e)}),Et(kx.enable(),function(e,t){c(w,e)})])])}),S=Ed(fx({name:"size",label:G.none(),constrain:!0,disabled:!1},a)),k=[d(),x(),S,x(),e("Apply",function(r){S.getOpt(r).each(function(e){var t,n,o=El.getValue(e),e=parseInt(o.width,10),o=parseInt(o.height,10),o=(t=e,n=o,function(e){return H0(e,t,n)});f(r,o)})},!1,!0)],O=mv.sketch({dom:b,components:k.map(function(e){return e.asSpec()}),containerBehaviours:gc([id("image-tools-resize-buttons-events",[Et(kx.disable(),function(e,t){u(k,e)}),Et(kx.enable(),function(e,t){c(k,e)})])])}),_=g(mx,"h"),E=g(mx,"v"),T=g(px,-90),D=g(px,90),A=[d(),x(),t("flip-horizontally","Flip horizontally",function(e){p(e,_)},!1),t("flip-vertically","Flip vertically",function(e){p(e,E)},!1),t("rotate-left","Rotate counterclockwise",function(e){p(e,T)},!1),t("rotate-right","Rotate clockwise",function(e){p(e,D)},!1),x(),m()],B=mv.sketch({dom:b,components:A.map(function(e){return e.asSpec()}),containerBehaviours:gc([id("image-tools-fliprotate-buttons-events",[Et(kx.disable(),function(e,t){u(A,e)}),Et(kx.enable(),function(e,t){c(A,e)})])])}),N=function(e,t,n,o,r){var i=v(e,t,n,o,r);return mv.sketch({dom:b,components:i.map(function(e){return e.asSpec()}),containerBehaviours:gc([id("image-tools-filter-panel-buttons-events",[Et(kx.disable(),function(e,t){u(i,e)}),Et(kx.enable(),function(e,t){c(i,e)})])])})},R=[d(),x(),m()],M=mv.sketch({dom:b,components:R.map(function(e){return e.asSpec()})}),I=N("Brightness",L0,-100,0,100),F=N("Contrast",V0,-100,0,100),P=N("Gamma",F0,-100,0,100),L=(z=function(e){return h(e,function(c,e,t){var n=L.getOpt(c),o=H.getOpt(c),r=V.getOpt(c);n.each(function(a){o.each(function(u){r.each(function(e){var t,n,o,r=El.getValue(a).x/100,i=El.getValue(e).x/100,e=El.getValue(u).x/100,e=(t=r,n=i,o=e,function(e){return P0(e,t,n,o)});s(c,e)})})})},0,100,200)})("R"),V=z("G"),H=z("B"),x=[d(),L,V,H,m()],R=mv.sketch({dom:b,components:x.map(function(e){return e.asSpec()})}),N=function(t,n,o){return function(e){r(e,Sx.swap(),{transform:n,swap:function(){U.getOpt(e).each(function(e){Id.set(e,[t]),o(e)})}})}},z=G.some(I0),x=G.some(M0),y=[t("crop","Crop",N(C,G.none(),function(e){o.showCrop()}),!1),t("resize","Resize",N(O,G.none(),function(e){S.getOpt(e).each(function(e){var t=o.getMeasurements(),n=t.width,t=t.height;El.setValue(e,{width:n,height:t})})}),!1),t("orientation","Orientation",N(B,G.none(),y),!1),t("brightness","Brightness",N(I,G.none(),y),!1),t("sharpen","Sharpen",N(M,z,y),!1),t("contrast","Contrast",N(F,G.none(),y),!1),t("color-levels","Color levels",N(R,G.none(),y),!1),t("gamma","Gamma",N(P,G.none(),y),!1),t("invert","Invert",N(M,x,y),!1)],j=mv.sketch({dom:b,components:y.map(function(e){return e.asSpec()})}),y=mv.sketch({dom:{tag:"div"},components:[j],containerBehaviours:gc([Id.config({})])}),U=Ed(y);return{memContainer:U,getApplyButton:function(e){return U.getOpt(e).map(function(e){e=e.components()[0];return e.components()[e.components().length-1]})}}}var mx=N0,gx=R0,px=B0,hx=un("toolbar.button.execute"),vx=((Yi={})[Yr()]=["disabling","alloy.base.behaviour","toggling","toolbar-button-events"],Yi),bx=un("update-menu-text"),yx=un("update-menu-icon"),xx={type:"separator"},wx=function(e,n){e=$0(U(e)?e.split(" "):e,n);return k(e,function(e,t){t=function(e){if(G0(e))return e;var t=ho(e,"value").getOrThunk(function(){return un("generated-menu-item")});return wo({value:t},e)}(t),t=X0(t,n);return{menus:wo(e.menus,t.menus),items:[t.item].concat(e.items),expansions:wo(e.expansions,t.expansions)}},{menus:{},expansions:{},items:[]})},t=q([Ze("field1Name","field1"),Ze("field2Name","field2"),Qa("onLockedChange"),Ya(["lockClass"]),Ze("locked",!1),Tl("coupledFieldBehaviours",[lf,El])]),Ur=function(e,t){return Fl({factory:gv,name:e,overrides:function(o){return{fieldBehaviours:gc([id("coupled-input-behaviour",[Et(Lr(),function(n){Gs(n,o,t).bind(lf.getCurrent).each(function(t){Gs(n,o,"lock").each(function(e){Vd.isOn(e)&&o.onLockedChange(n,t,e)})})})])])}}})},pr=q([Ur("field1","field2"),Ur("field2","field1"),Fl({factory:om,schema:[ze("dom")],name:"lock",overrides:function(e){return{buttonBehaviours:gc([Vd.config({selected:e.locked,toggleClass:e.markers.lockClass,aria:{mode:"pressed"}})])}}})]),Cx=yc({name:"FormCoupledInputs",configFields:t(),partFields:pr(),factory:function(n,e,t,o){return{uid:n.uid,dom:n.dom,components:e,behaviours:Dl(n.coupledFieldBehaviours,[lf.config({find:G.some}),El.config({store:{mode:"manual",getValue:function(e){var t=Js(e,n,["field1","field2"]),e={};return e[n.field1Name]=El.getValue(t.field1()),e[n.field2Name]=El.getValue(t.field2()),e},setValue:function(e,t){e=Js(e,n,["field1","field2"]);he(t,n.field1Name)&&El.setValue(e.field1(),t[n.field1Name]),he(t,n.field2Name)&&El.setValue(e.field2(),t[n.field2Name])}}})]),apis:{getField1:function(e){return Gs(e,n,"field1")},getField2:function(e){return Gs(e,n,"field2")},getLock:function(e){return Gs(e,n,"lock")}}}},apis:{getField1:function(e,t){return e.getField1(t)},getField2:function(e,t){return e.getField2(t)},getLock:function(e,t){return e.getLock(t)}}}),Sx={undo:q(un("undo")),redo:q(un("redo")),zoom:q(un("zoom")),back:q(un("back")),apply:q(un("apply")),swap:q(un("swap")),transform:q(un("transform")),tempTransform:q(un("temp-transform")),transformApply:q(un("transform-apply"))},Uv=q("save-state"),Yi=q("disable"),Ur=q("enable"),kx={formActionEvent:Cv,saveState:Uv,disable:Yi,enable:Ur},Ox=tinymce.util.Tools.resolve("tinymce.geom.Rect"),_x=tinymce.util.Tools.resolve("tinymce.dom.DomQuery"),Ex=tinymce.util.Tools.resolve("tinymce.util.Observable"),Tx=tinymce.util.Tools.resolve("tinymce.util.VK");function Dx(e){var t,n;if(e.changedTouches)for(t="screenX screenY pageX pageY clientX clientY".split(" "),n=0;n<t.length;n++)e[t[n]]=e.changedTouches[0][t[n]]}function Ax(e,s){var l,f,d,m,g=s.document||document,p=g.getElementById(s.handle||e),h=function(e){if(Dx(e),e.button!==f)return v(e);e.deltaX=e.screenX-d,e.deltaY=e.screenY-m,e.preventDefault(),s.drag(e)},v=function(e){Dx(e),_x(g).off("mousemove touchmove",h).off("mouseup touchend",v),l.remove(),s.stop&&s.stop(e)};this.destroy=function(){_x(p).off()},_x(p).on("mousedown touchstart",function(e){var t,n,o,r,i,u,a,t=(t=g,n=Math.max,o=t.documentElement,r=t.body,i=n(o.scrollWidth,r.scrollWidth),u=n(o.clientWidth,r.clientWidth),a=n(o.offsetWidth,r.offsetWidth),c=n(o.scrollHeight,r.scrollHeight),t=n(o.clientHeight,r.clientHeight),{width:i<a?u:i,height:c<n(o.offsetHeight,r.offsetHeight)?t:c});Dx(e),e.preventDefault(),f=e.button;var c=p;d=e.screenX,m=e.screenY,c=window.getComputedStyle?window.getComputedStyle(c,null).getPropertyValue("cursor"):c.runtimeStyle.cursor,l=_x("<div></div>").css({position:"absolute",top:0,left:0,width:t.width,height:t.height,zIndex:2147483647,opacity:1e-4,cursor:c}).appendTo(g.body),_x(g).on("mousemove touchmove",h).on("mouseup touchend",v),s.start(e)})}function Bx(t){function u(e,s){c.getOpt(e).each(function(e){var n=f.get(),o=mu(e.element),r=su(e.element),i=s.dom.naturalWidth*n,u=s.dom.naturalHeight*n,a=Math.max(0,o/2-i/2),c=Math.max(0,r/2-u/2),t={left:a.toString()+"px",top:c.toString()+"px",width:i.toString()+"px",height:u.toString()+"px",position:"absolute"};Pn(s,t),l.getOpt(e).each(function(e){Pn(e.element,t)}),d.get().each(function(e){var t=m.get();e.setRect({x:t.x*n+a,y:t.y*n+c,w:t.w*n,h:t.h*n}),e.setClampRect({x:a,y:c,w:i,h:u}),e.setViewPortRect({x:0,y:0,w:o,h:r})})})}function n(e,t){var n,i=ir.fromTag("img");return Qt(i,"src",t),n=i.dom,new km(function(e){var t=function(){n.removeEventListener("load",t),e(n)};n.complete?e(n):n.addEventListener("load",t)}).then(function(){return c.getOpt(e).map(function(e){var t=ru({element:i});Id.replaceAt(e,1,G.some(t));var n=a.get(),o={x:0,y:0,w:i.dom.naturalWidth,h:i.dom.naturalHeight};a.set(o);var r,t=Ox.inflate(o,-20,-20);return m.set(t),n.w===o.w&&n.h===o.h||(r=i,c.getOpt(e).each(function(e){var t=mu(e.element),n=su(e.element),o=r.dom.naturalWidth,e=r.dom.naturalHeight,e=Math.min(t/o,n/e);1<=e?f.set(1):f.set(e)})),u(e,i),i})})}var l=Ed({dom:{tag:"div",classes:["tox-image-tools__image-bg"],attributes:{role:"presentation"}}}),f=it(1),d=it(G.none()),m=it({x:0,y:0,w:1,h:1}),a=it({x:0,y:0,w:1,h:1}),e=mv.sketch({dom:{tag:"div",classes:["tox-image-tools__image"]},components:[l.asSpec(),{dom:{tag:"img",attributes:{src:t}}},{dom:{tag:"div"},behaviours:gc([id("image-panel-crop-events",[bi(function(e){c.getOpt(e).each(function(e){e=e.element.dom,e=Ix({x:10,y:10,w:100,h:100},{x:0,y:0,w:200,h:200},{x:0,y:0,w:200,h:200},e,function(){});e.toggleVisibility(!1),e.on("updateRect",function(e){var t=e.rect,e=f.get(),e={x:Math.round(t.x/e),y:Math.round(t.y/e),w:Math.round(t.w/e),h:Math.round(t.h/e)};m.set(e)}),d.set(G.some(e))})})])])}],containerBehaviours:gc([Id.config({}),id("image-panel-events",[bi(function(e){n(e,t)})])])}),c=Ed(e);return{memContainer:c,updateSrc:n,zoom:function(e,t){var n=f.get(),n=0<t?Math.min(2,n+.1):Math.max(.1,n-.1);f.set(n),c.getOpt(e).each(function(e){var t=e.components()[1].element;u(e,t)})},showCrop:function(){d.get().each(function(e){e.toggleVisibility(!0)})},hideCrop:function(){d.get().each(function(e){e.toggleVisibility(!1)})},getRect:function(){return m.get()},getMeasurements:function(){var e=a.get();return{width:e.w,height:e.h}}}}function Nx(e,t,n,o,r){return tx({name:e,icon:G.some(t),disabled:n,tooltip:G.some(e),primary:!1,borderless:!1},o,r)}function Rx(e,t){t?Ug.enable(e):Ug.disable(e)}var Mx=0,Ix=function(a,n,c,o,r){var e,t="tox-",u="tox-crid-"+Mx++,s=[{name:"move",xMul:0,yMul:0,deltaX:1,deltaY:1,deltaW:0,deltaH:0,label:"Crop Mask"},{name:"nw",xMul:0,yMul:0,deltaX:1,deltaY:1,deltaW:-1,deltaH:-1,label:"Top Left Crop Handle"},{name:"ne",xMul:1,yMul:0,deltaX:0,deltaY:1,deltaW:1,deltaH:-1,label:"Top Right Crop Handle"},{name:"sw",xMul:0,yMul:1,deltaX:1,deltaY:0,deltaW:-1,deltaH:1,label:"Bottom Left Crop Handle"},{name:"se",xMul:1,yMul:1,deltaX:0,deltaY:0,deltaW:1,deltaH:1,label:"Bottom Right Crop Handle"}],i=["top","right","bottom","left"],l=function(e,t){return{x:t.x+e.x,y:t.y+e.y,w:t.w,h:t.h}},f=function(e,t){return{x:t.x-e.x,y:t.y-e.y,w:t.w,h:t.h}};function d(e,t,n,o){var r=t.x,i=t.y,u=t.w,t=t.h;r+=n*e.deltaX,i+=o*e.deltaY,u+=n*e.deltaW,t+=o*e.deltaH,e=a=Ox.clamp({x:r,y:i,w:u=u<20?20:u,h:t=t<20?20:t},c,"move"===e.name),e=f(c,e=a),h.fire("updateRect",{rect:e}),p(e)}function m(t){function e(e,t){t.h<0&&(t.h=0),t.w<0&&(t.w=0),_x("#"+u+"-"+e,o).css({left:t.x,top:t.y,width:t.w,height:t.h})}My.each(s,function(e){_x("#"+u+"-"+e.name,o).css({left:t.w*e.xMul+t.x,top:t.h*e.yMul+t.y})}),e("top",{x:n.x,y:n.y,w:n.w,h:t.y-n.y}),e("right",{x:t.x+t.w,y:t.y,w:n.w-t.x-t.w+n.x,h:t.h}),e("bottom",{x:n.x,y:t.y+t.h,w:n.w,h:n.h-t.y-t.h+n.y}),e("left",{x:n.x,y:t.y,w:t.x-n.x,h:t.h}),e("move",t)}function g(e){m(a=e)}function p(e){g(l(c,e))}_x('<div id="'+u+'" class="'+t+'croprect-container" role="grid" aria-dropeffect="execute">').appendTo(o),My.each(i,function(e){_x("#"+u,o).append('<div id="'+u+"-"+e+'"class="'+t+'croprect-block" style="display: none" data-mce-bogus="all">')}),My.each(s,function(e){_x("#"+u,o).append('<div id="'+u+"-"+e.name+'" class="'+t+"croprect-handle "+t+"croprect-handle-"+e.name+'"style="display: none" data-mce-bogus="all" role="gridcell" tabindex="-1" aria-label="'+e.label+'" aria-grabbed="false" title="'+e.label+'">')}),e=My.map(s,function(t){var n;return new Ax(u,{document:o.ownerDocument,handle:u+"-"+t.name,start:function(){n=a},drag:function(e){d(t,n,e.deltaX,e.deltaY)}})}),m(a),_x(o).on("focusin focusout",function(e){_x(e.target).attr("aria-grabbed","focus"===e.type?"true":"false")}),_x(o).on("keydown",function(t){var i;function e(e,t,n,o,r){e.stopPropagation(),e.preventDefault(),d(i,n,o,r)}switch(My.each(s,function(e){if(t.target.id===u+"-"+e.name)return i=e,!1}),t.keyCode){case Tx.LEFT:e(t,0,a,-10,0);break;case Tx.RIGHT:e(t,0,a,10,0);break;case Tx.UP:e(t,0,a,0,-10);break;case Tx.DOWN:e(t,0,a,0,10);break;case Tx.ENTER:case Tx.SPACEBAR:t.preventDefault(),r()}});var h=My.extend({toggleVisibility:function(e){var t=My.map(s,function(e){return"#"+u+"-"+e.name}).concat(My.map(i,function(e){return"#"+u+"-"+e})).join(",");e?_x(t,o).show():_x(t,o).hide()},setClampRect:function(e){c=e,m(a)},setRect:g,getInnerRect:function(){return f(c,a)},setInnerRect:p,setViewPortRect:function(e){n=e,m(a)},destroy:function(){My.each(e,function(e){e.destroy()}),e=[]}},Ex);return h};function Fx(){var n=[],o=-1;function e(){return 0<o}function t(){return-1!==o&&o<n.length-1}return{data:n,add:function(e){var t=n.splice(++o);return n.push(e),{state:e,removed:t}},undo:function(){if(0<o)return n[--o]},redo:function(){if(t())return n[++o]},canUndo:e,canRedo:t}}function Px(e){var t=it(e),n=it(G.none()),o=Fx();function r(e){t.set(e)}function i(e){URL.revokeObjectURL(e.url)}function u(e){var t=a(e);return r(t),e=o.add(t).removed,My.each(e,i),t.url}o.add(e);var a=function(e){return{blob:e,url:URL.createObjectURL(e)}},c=function(){n.get().each(i),n.set(G.none())};return{getBlobState:function(){return t.get()},setBlobState:r,addBlobState:u,getTempState:function(){return n.get().fold(function(){return t.get()},function(e){return e})},updateTempState:function(e){e=a(e);return c(),n.set(G.some(e)),e.url},addTempState:function(e){e=a(e);return n.set(G.some(e)),e.url},applyTempState:function(t){return n.get().fold(function(){},function(e){u(e.blob),t()})},destroyTempState:c,undo:function(){var e=o.undo();return r(e),e.url},redo:function(){var e=o.redo();return r(e),e.url},getHistoryStates:function(){return{undoEnabled:o.canUndo(),redoEnabled:o.canRedo()}}}}function Lx(e,t){function i(e){var t=l.getHistoryStates();p.updateButtonUndoStates(e,t.undoEnabled,t.redoEnabled),wt(e,kx.formActionEvent,{name:kx.saveState(),value:t.undoEnabled})}function u(e){return e.toBlob()}function a(e){wt(e,kx.formActionEvent,{name:kx.disable(),value:{}})}function r(t,e,n,o,r){return a(t),m0(e).then(n).then(u).then(o).then(function(e){return d(t,e).then(function(e){return i(t),r(),f(t),e})}).catch(function(e){return console.log(e),f(t),e})}function c(e,t,n){var o=l.getBlobState().blob;r(e,o,t,function(e){return l.updateTempState(e)},n)}var o,s,l=Px(e.currentState),f=function(e){n.getApplyButton(e).each(function(e){Ug.enable(e)}),wt(e,kx.formActionEvent,{name:kx.enable(),value:{}})},d=function(e,t){return a(e),g.updateSrc(e,t)},m=function(e){var t=l.getBlobState().url;return l.destroyTempState(),i(e),t},g=Bx(e.currentState.url),p=(o=Ed(Nx("Undo","undo",!0,function(e){wt(e,Sx.undo(),{direction:1})},e=t)),s=Ed(Nx("Redo","redo",!0,function(e){wt(e,Sx.redo(),{direction:1})},e)),{container:mv.sketch({dom:{tag:"div",classes:["tox-image-tools__toolbar","tox-image-tools__sidebar"]},components:[o.asSpec(),s.asSpec(),Nx("Zoom in","zoom-in",!1,function(e){wt(e,Sx.zoom(),{direction:1})},e),Nx("Zoom out","zoom-out",!1,function(e){wt(e,Sx.zoom(),{direction:-1})},e)]}),updateButtonUndoStates:function(e,t,n){o.getOpt(e).each(function(e){Rx(e,t)}),s.getOpt(e).each(function(e){Rx(e,n)})}}),n=dx(g,t);return{dom:{tag:"div",attributes:{role:"presentation"}},components:[n.memContainer.asSpec(),g.memContainer.asSpec(),p.container],behaviours:gc([El.config({store:{mode:"manual",getValue:function(){return l.getBlobState()}}}),id("image-tools-events",[Et(Sx.undo(),function(t,e){var n=l.undo();d(t,n).then(function(e){f(t),i(t)})}),Et(Sx.redo(),function(t,e){var n=l.redo();d(t,n).then(function(e){f(t),i(t)})}),Et(Sx.zoom(),function(e,t){t=t.event.direction;g.zoom(e,t)}),Et(Sx.back(),function(e,t){var n;e=m(n=e),d(n,e).then(function(e){f(n)}),(0,t.event.swap)(),g.hideCrop()}),Et(Sx.apply(),function(e,t){l.applyTempState(function(){m(e),(0,t.event.swap)()})}),Et(Sx.transform(),function(e,t){return c(e,t.event.transform,W)}),Et(Sx.tempTransform(),function(e,t){var n;n=e,e=t.event.transform,t=l.getTempState().blob,r(n,t,e,function(e){return l.addTempState(e)},W)}),Et(Sx.transformApply(),function(e,t){var n,o;n=e,o=t.event.transform,e=t.event.swap,t=l.getBlobState().blob,r(n,t,o,function(e){e=l.addBlobState(e);return m(n),e},e)}),Et(Sx.swap(),function(t,e){p.updateButtonUndoStates(t,!1,!1);var n=e.event.transform,o=e.event.swap;n.fold(function(){o()},function(e){c(t,e,o)})})]),Dy()])}}function Vx(e){return!vo(e,"items")}function Hx(e,t){function n(e){return{dom:{tag:"td",innerHtml:t.translate(e)}}}function o(e){return{dom:{tag:"tr"},components:S(e,n)}}var r;return{dom:{tag:"table",classes:["tox-dialog__table"]},components:[(r=e.header,{dom:{tag:"thead"},components:[{dom:{tag:"tr"},components:S(r,function(e){return{dom:{tag:"th",innerHtml:t.translate(e)}}})}]}),(e=e.cells,{dom:{tag:"tbody"},components:S(e,o)})],behaviours:gc([pv.config({}),Fd.config({})])}}function zx(n,t){var e=n.label.map(function(e){return iv(e,t)}),o=[Ug.config({disabled:function(){return n.disabled||t.isDisabled()}}),op(),Rd.config({mode:"execution",useEnter:!0!==n.multiline,useControlEnter:!0===n.multiline,execute:function(e){return xt(e,Sv),G.some(!0)}}),id("textfield-change",[Et(Lr(),function(e,t){wt(e,yv,{name:n.name})}),Et($r(),function(e,t){wt(e,yv,{name:n.name})})]),pv.config({})],r=n.validation.map(function(n){return Wv.config({getRoot:function(e){return Vt(e.element)},invalidClass:"tox-invalid",validator:{validate:function(e){var t=El.getValue(e),e=n.validator(t);return zv(!0===e?ce.value(t):ce.error(e))},validateOnLoad:n.validateOnLoad}})}).toArray(),i=n.placeholder.fold(q({}),function(e){return{placeholder:t.translate(e)}}),u=n.inputMode.fold(q({}),function(e){return{inputmode:e}}),u=A(A({},i),u),u=gv.parts.field({tag:!0===n.multiline?"textarea":"input",inputAttributes:u,inputClasses:[n.classname],inputBehaviours:gc(B([o,r])),selectOnFocus:!1,factory:Tv}),o=(n.flex?["tox-form__group--stretched"]:[]).concat(n.maximized?["tox-form-group--maximize"]:[]),r=[Ug.config({disabled:function(){return n.disabled||t.isDisabled()},onDisabled:function(e){gv.getField(e).each(Ug.disable)},onEnabled:function(e){gv.getField(e).each(Ug.enable)}}),op()];return rv(e,u,o,r)}function jx(e,t,n){n=El.getValue(n),El.setValue(t,n),R1(t)}function Ux(e,t){var n=e.element,o=Wn(n),e=n.dom;"number"!==Zt(n,"type")&&t(e,o)}function Wx(e,t,o){if(e.selectsOver){var n=El.getValue(t),r=e.getDisplayText(n),n=El.getValue(o);return 0===e.getDisplayText(n).indexOf(r)?G.some(function(){var n;jx(0,t,o),n=r.length,Ux(t,function(e,t){return e.setSelectionRange(n,t.length)})}):G.none()}return G.none()}function qx(e){return F1(Hv(e))}function Gx(e){return{type:"menuitem",value:e.url,text:e.title,meta:{attach:e.attach},onAction:function(){}}}function $x(e,t){return{type:"menuitem",value:t,text:e,meta:{attach:void 0},onAction:function(){}}}function Xx(e,t){return n=e,t=C(t,function(e){return e.type===n}),S(t,Gx);var n}function Yx(e,t){var n=e.toLowerCase();return C(t,function(e){var t=(void 0!==e.meta&&void 0!==e.meta.text?e.meta:e).text;return at(t.toLowerCase(),n)||at(e.value.toLowerCase(),n)})}function Kx(n,e,o){var r=void 0!==(e=El.getValue(e)).meta.text?e.meta.text:e.value;return o.getLinkInformation().fold(function(){return[]},function(e){var t,t=Yx(r,(t=o.getHistory(n),S(t,function(e){return $x(e,e)})));return"file"===n?(e=[t,Yx(r,Xx("header",e.targets)),Yx(r,B([G.from(e.anchorTop).map(function(e){return $x("<top>",e)}).toArray(),Xx("anchor",e.targets),G.from(e.anchorBottom).map(function(e){return $x("<bottom>",e)}).toArray()]))],O(e,function(e,t){return 0===e.length||0===t.length?e.concat(t):e.concat(L1,t)},[])):t})}function Jx(r,t,n){function i(e){e=El.getValue(e),n.addToHistory(e.value,r.filetype)}var e,o,u,a,c=t.shared.providers,s=gv.parts.field({factory:I1,dismissOnBlur:!0,inputClasses:["tox-textfield"],sandboxClasses:["tox-dialog__popups"],inputAttributes:{"aria-errormessage":V1,type:"url"},minChars:0,responseTime:0,fetch:function(e){e=Kx(r.filetype,e,n),e=Y0(e,dg.BUBBLE_TO_SANDBOX,t,!1);return zv(e)},getHotspot:function(e){return p.getOpt(e)},onSetValue:function(e,t){e.hasConfigured(Wv)&&Wv.run(e).get(W)},typeaheadBehaviours:gc(B([n.getValidationHandler().map(function(o){return Wv.config({getRoot:function(e){return Vt(e.element)},invalidClass:"tox-control-wrap--status-invalid",notify:{onInvalid:function(e,t){f.getOpt(e).each(function(e){Qt(e.element,"title",c.translate(t))})}},validator:{validate:function(e){var t=El.getValue(e);return P1(function(n){o({type:r.filetype,url:t.value},function(e){var t;"invalid"===e.status?(t=ce.error(e.message),n(t)):(e=ce.value(e.message),n(e))})})},validateOnLoad:!1}})}).toArray(),[Ug.config({disabled:function(){return r.disabled||c.isDisabled()}}),pv.config({}),id("urlinput-events",B(["file"===r.filetype?[Et(Lr(),function(e){wt(e,yv,{name:r.name})})]:[],[Et(Vr(),function(e){wt(e,yv,{name:r.name}),i(e)}),Et($r(),function(e){wt(e,yv,{name:r.name}),i(e)})]]))]])),eventOrder:((d={})[Lr()]=["streaming","urlinput-events","invalidating"],d),model:{getDisplayText:function(e){return e.value},selectsOver:!1,populateFromBrowse:!1},markers:{openClass:"tox-textfield--popup-open"},lazySink:t.shared.getSink,parts:{menu:Lm(0,0,"normal")},onExecute:function(e,t,n){wt(t,Sv,{})},onItemExecute:function(e,t,n,o){i(e),wt(e,yv,{name:r.name})}}),l=r.label.map(function(e){return iv(e,c)}),f=Ed((e="invalid",o=G.some(V1),void 0===a&&(a=e),{dom:{tag:"div",classes:["tox-icon","tox-control-wrap__status-icon-"+e],innerHtml:Dd(u=void 0===(u="warning")?e:u,c.icons),attributes:A({title:c.translate(a),"aria-live":"polite"},o.fold(function(){return{}},function(e){return{id:e}}))}})),d=Ed({dom:{tag:"div",classes:["tox-control-wrap__status-icon-wrap"]},components:[f.asSpec()]}),m=n.getUrlPicker(r.filetype),g=un("browser.url.event"),p=Ed({dom:{tag:"div",classes:["tox-control-wrap"]},components:[s,d.asSpec()],behaviours:gc([Ug.config({disabled:function(){return r.disabled||c.isDisabled()}})])}),h=Ed(ox({name:r.name,icon:G.some("browse"),text:r.label.getOr(""),disabled:r.disabled,primary:!1,borderless:!0},function(e){return xt(e,g)},c,[],["tox-browse-url"]));return gv.sketch({dom:bv([]),components:l.toArray().concat([{dom:{tag:"div",classes:["tox-form__controls-h-stack"]},components:B([[p.asSpec()],m.map(function(){return h.asSpec()}).toArray()])}]),fieldBehaviours:gc([Ug.config({disabled:function(){return r.disabled||c.isDisabled()},onDisabled:function(e){gv.getField(e).each(Ug.disable),h.getOpt(e).each(Ug.disable)},onEnabled:function(e){gv.getField(e).each(Ug.enable),h.getOpt(e).each(Ug.enable)}}),op(),id("url-input-events",[Et(g,function(o){lf.getCurrent(o).each(function(t){var e=El.getValue(t),n=A({fieldname:r.name},e);m.each(function(e){e(n).get(function(e){El.setValue(t,e),wt(o,yv,{name:r.name})})})})})])])})}function Qx(r){return function(t,n,o){return ho(n,"name").fold(function(){return r(n,o)},function(e){return t.field(e,r(n,o))})}}function Zx(t,e,n){var o=wo(n,{shared:{interpreter:function(e){return j1(t,e,o)}}});return j1(t,e,o)}function ew(e,t,n){var o=Pa(-12,12,U1),r={maxHeightFunction:Oc()};return function(){return n()?{anchor:"node",root:Nn(e()),node:G.from(e()),bubble:o,layouts:{onRtl:function(){return[_d]},onLtr:function(){return[Od]}},overrides:r}:{anchor:"hotspot",hotspot:t(),bubble:o,layouts:{onRtl:function(){return[oa]},onLtr:function(){return[ra]}},overrides:r}}}function tw(e,t,n){return function(){return n()?{anchor:"node",root:Nn(e()),node:G.from(e()),layouts:{onRtl:function(){return[em]},onLtr:function(){return[em]}}}:{anchor:"hotspot",hotspot:t(),layouts:{onRtl:function(){return[fc]},onLtr:function(){return[fc]}}}}}function nw(e,t,n){function o(){return ir.fromDom(e.getBody())}function r(){return ir.fromDom(e.getContentAreaContainer())}function i(){return s||!n()}var u,a,c,s=Jg(e);return{inlineDialog:ew(r,t,i),banner:tw(r,t,i),cursor:(a=e,function(){return{anchor:"selection",root:c(),getSelection:function(){var e=a.selection.getRng();return G.some(Hc.range(ir.fromDom(e.startContainer),e.startOffset,ir.fromDom(e.endContainer),e.endOffset))}}}),node:(u=c=o,function(e){return{anchor:"node",root:u(),node:e}})}}function ow(e){return{colorPicker:function(e,t){hh(r)(e,t)},hasCustomColors:function(){return eh(o)},getColors:function(){return th(n)},getColorCols:(t=n=o=r=e,function(){return rh(t)})};var t,n,o,r}function rw(t,e){function n(e){oe(e,function(e){t.formatter.has(e.name)||t.formatter.register(e.name,e.format)})}var o=q1(e);return t.formatter?n(o.customFormats):t.on("init",function(){n(o.customFormats)}),o.formats}function iw(t){return G.from(t.getParam("style_formats")).filter(X).map(function(e){e=rw(t,e);return t.getParam("style_formats_merge",!1,"boolean")?W1.concat(e):e}).getOr(W1)}function uw(e,t,n){return n={type:"formatter",isSelected:t(e.format),getStylePreview:n(e.format)},wo(e,n)}function aw(r,e,i,u){var a=function(e){return S(e,function(e){var t,n=lo(e);if(he(e,"items")){var o=a(e.items);return wo(wo(e,{type:"submenu"}),{getStyleItems:function(){return o}})}return he(e,"format")?uw(e,i,u):1===n.length&&ne(n,"title")?wo(e,{type:"separator"}):(n=U((t=e).name)?t.name:un(t.title),e={type:"formatter",format:e="custom-"+n,isSelected:i(e),getStylePreview:u(e)},e=wo(t,e),r.formatter.register(n,e),e)})};return a(e)}function cw(n){function o(e){return function(){return n.formatter.match(e)}}function r(t){return function(){var e=n.formatter.get(t);return void 0!==e?G.some({tag:0<e.length&&(e[0].inline||e[0].block)||"div",styles:n.dom.parseStyle(n.formatter.getCssText(t))}):G.none()}}var i=function(e){var t=e.items;return void 0!==t&&0<t.length?T(t,i):[e.format]},u=it([]),a=it([]),c=it([]),s=it([]),l=it(!1);return n.on("PreInit",function(e){var t=iw(n),t=aw(n,t,o,r);u.set(t),a.set(T(t,i))}),n.on("addStyleModifications",function(e){var t=aw(n,e.items,o,r);c.set(t),l.set(e.replace),s.set(T(t,i))}),{getData:function(){var e=l.get()?[]:u.get(),t=c.get();return e.concat(t)},getFlattenedKeys:function(){var e=l.get()?[]:a.get(),t=s.get();return e.concat(t)}}}function sw(e,t,n,o,r){return{type:e,title:t,url:n,level:o,attach:r}}function lw(e){return e.innerText||e.textContent}function fw(e){return(t=e)&&"A"===t.nodeName&&void 0!==(t.id||t.name)&&Y1(e);var t}function dw(e){return e&&/^(H[1-6])$/.test(e.nodeName)}function mw(e){return dw(e)&&Y1(e)}function gw(e){var t,n=e.id||un("h");return sw("header",lw(e),"#"+n,dw(t=e)?parseInt(t.nodeName.substr(1),10):0,function(){e.id=n})}function pw(e){var t=e.id||e.name,e=lw(e);return sw("anchor",e||"#"+t,"#"+t,0,W)}function hw(e){var t;return t="h1,h2,h3,h4,h5,h6,a:not([href])",S(Wc(ir.fromDom(e),t),function(e){return e.dom})}function vw(e){return 0<G1(e.title).length}function bw(e){return U(e)&&/^https?/.test(e)}function yw(e){return $(e)&&ge(e,function(e){return!(X(e=e)&&e.length<=5&&D(e,bw))}).isNone()}function xw(){var e,t=Jp.getItem(J1);if(null===t)return{};try{e=JSON.parse(t)}catch(e){if(e instanceof SyntaxError)return console.log("Local storage "+J1+" was not valid JSON",e),{};throw e}return yw(e)?e:(console.log("Local storage "+J1+" was not valid format",e),{})}function ww(e){var t=xw();return Object.prototype.hasOwnProperty.call(t,e)?t[e]:[]}function Cw(t,e){var n,o;bw(t)&&(n=xw(),o=Object.prototype.hasOwnProperty.call(n,e)?n[e]:[],o=C(o,function(e){return e!==t}),n[e]=[t].concat(o).slice(0,5),function(e){if(!yw(e))throw new Error("Bad format for history:\n"+JSON.stringify(e));Jp.setItem(J1,JSON.stringify(e))}(n))}function Sw(e){return!!e}function kw(e){return de(My.makeMap(e,/[, ]/),Sw)}function Ow(e){return G.from(e.getParam("file_picker_callback")).filter(J)}function _w(e,t){var n,o,r,i=(i=e,n=G.some(i.getParam("file_picker_types")).filter(Sw),o=G.some(i.getParam("file_browser_callback_types")).filter(Sw),r=n.or(o).map(kw),Ow(i).fold(function(){return!1},function(e){return r.fold(function(){return!0},function(e){return 0<lo(e).length&&e})}));return Y(i)?i?Ow(e):G.none():i[t]?Ow(e):G.none()}function Ew(e){return G.from(e).filter(U).getOrUndefined()}function Tw(n){return{getHistory:ww,addToHistory:Cw,getLinkInformation:function(){return!1===(e=n).getParam("typeahead_urls")?G.none():G.some({targets:K1(e.getBody()),anchorTop:Ew(e.getParam("anchor_top","#top")),anchorBottom:Ew(e.getParam("anchor_bottom","#bottom"))});var e},getValidationHandler:function(){return e=n,G.from(void 0===(e=(t=e).getParam("file_picker_validator_handler",void 0,"function"))?t.getParam("filepicker_validator_handler",void 0,"function"):e);var e,t},getUrlPicker:function(e){return _w(r=n,i=e).map(function(o){return function(t){return Hv(function(n){var e=A({filetype:i,fieldname:t.fieldname},G.from(t.meta).getOr({}));o.call(r,function(e,t){if(!U(e))throw new Error("Expected value to be string");if(void 0!==t&&!$(t))throw new Error("Expected meta to be a object");n({value:e,meta:t})},t.value,e)})}});var r,i}}}function Dw(e,t,n){var o,r,i=it(!1),u={isPositionedAtTop:function(){return"top"===o.get()},getDockingMode:(o=it(Yg(t)?"bottom":"top")).get,setDockingMode:o.set},a={shared:{providers:{icons:function(){return t.ui.registry.getAll().icons},menuItems:function(){return t.ui.registry.getAll().menuItems},translate:Vg.translate,isDisabled:function(){return t.mode.isReadOnly()||t.ui.isDisabled()},getSetting:t.getParam.bind(t)},interpreter:function(e){return j1(z1,e,a)},anchors:nw(t,n,u.isPositionedAtTop),header:u,getSink:function(){return ce.value(e)}},urlinput:Tw(t),styleselect:cw(t),colorinput:ow(t),dialog:{isDraggableModal:(r=t,function(){return r.getParam("draggable_modal",!1,"boolean")})},isContextMenuOpen:function(){return i.get()},setContextMenuState:function(e){return i.set(e)}};return a}function Aw(e,t,n){return{within:e,extra:t,withinWidth:n}}function Bw(e,t,o){var n,r=(n=function(e,t){var n=o(e);return G.some({element:e,start:t,finish:t+n,width:n})},O(e,function(t,e){return n(e,t.len).fold(q(t),function(e){return{len:e.finish,list:t.list.concat([e])}})},{len:0,list:[]}).list),i=C(r,function(e){return e.finish<=t}),e=k(i,function(e,t){return e+t.width},0);return{within:i,extra:r.slice(i.length),withinWidth:e}}function Nw(e){return S(e,function(e){return e.element})}function Rw(e,t,n,o){var r=(u=function(e,t,n){n=Bw(t,e,n);return 0===n.extra.length?G.some(n):G.none()}(e,t,n).getOrThunk(function(){return Bw(t,e-n(o),n)})).within,i=u.extra,u=u.withinWidth;return 1===i.length&&i[0].width<=n(o)?function(e,t,n){t=Nw(e.concat(t));return Aw(t,[],n)}(r,i,u):1<=i.length?function(e,t,n,o){n=Nw(e).concat([n]);return Aw(n,Nw(t),o)}(r,i,o,u):(u=u,Aw(Nw(r),[],u))}function Mw(e,t){t=S(t,function(e){return au(e)}),eC.setGroups(e,t)}function Iw(e,t,n){var o=$s(e,t,"primary"),r=qv.getCoupled(e,"overflowGroup");Fn(o.element,"visibility","hidden");var i=t.builtGroups.get().concat([r]),e=P(i,function(t){return Ca(t.element).bind(function(e){return t.getSystem().getByDom(e).toOptional()})});n([]),Mw(o,i),i=mu(o.element),0===(t=Rw(i,t.builtGroups.get(),function(e){return mu(e.element)},r)).extra.length?(Id.remove(o,r),n([])):(Mw(o,t.within),n(t.extra)),jn(o.element,"visibility"),Un(o.element),e.each(Fd.focus)}function Fw(e,t){e=qv.getCoupled(e,"toolbarSandbox"),wl.isOpen(e)?wl.close(e):wl.open(e,t.toolbar())}function Pw(e,t,n,o){var r=n.getBounds.map(function(e){return e()}),n=n.lazySink(e).getOrDie();ml.positionWithinBounds(n,{anchor:"hotspot",hotspot:e,layouts:o,overrides:{maxWidthFunction:Q1()}},t,r)}function Lw(e,t,n,o,r){eC.setGroups(t,r),Pw(e,t,n,o),Vd.on(e)}function Vw(e){return S(e,function(e){return au(e)})}function Hw(e,n,o){Iw(e,o,function(t){o.overflowGroups.set(t),n.getOpt(e).each(function(e){tC.setGroups(e,Vw(t))})})}function zw(t,e){return e.getAnimationRoot.fold(function(){return t.element},function(e){return e(t)})}function jw(e){return e.dimension.property}function Uw(e,t){return e.dimension.getDimension(t)}function Ww(e,t){e=zw(e,t),Dn(e,[t.shrinkingClass,t.growingClass])}function qw(e,t){_n(e.element,t.openClass),kn(e.element,t.closedClass),Fn(e.element,jw(t),"0px"),Un(e.element)}function Gw(e,t){_n(e.element,t.closedClass),kn(e.element,t.openClass),jn(e.element,jw(t))}function $w(e,t,n,o){n.setCollapsed(),Fn(e.element,jw(t),Uw(t,e.element)),Un(e.element),Ww(e,t),qw(e,t),t.onStartShrink(e),t.onShrunk(e)}function Xw(e,t,n,o){o=o.getOrThunk(function(){return Uw(t,e.element)}),n.setCollapsed(),Fn(e.element,jw(t),o),Un(e.element),o=zw(e,t),_n(o,t.growingClass),kn(o,t.shrinkingClass),qw(e,t),t.onStartShrink(e)}function Yw(e,t,n){var o=Uw(t,e.element);("0px"===o?$w:Xw)(e,t,n,G.some(o))}function Kw(e,t,n){var o=zw(e,t),r=En(o,t.shrinkingClass),i=Uw(t,e.element);Gw(e,t);var u=Uw(t,e.element);(r?function(){Fn(e.element,jw(t),i),Un(e.element)}:function(){qw(e,t)})(),_n(o,t.shrinkingClass),kn(o,t.growingClass),Gw(e,t),Fn(e.element,jw(t),u),n.setExpanded(),t.onStartGrow(e)}function Jw(e,t,n){return e=zw(e,t),!0===En(e,t.growingClass)}function Qw(e,t,n){return e=zw(e,t),!0===En(e,t.shrinkingClass)}function Zw(t,n){Gs(t,n,"overflow-button").bind(function(){return Gs(t,n,"overflow")}).each(function(e){iC(t,n),rC.toggleGrow(e)})}function e1(e){var t=e.title.fold(function(){return{}},function(e){return{attributes:{title:e}}});return{dom:A({tag:"div",classes:["tox-toolbar__group"]},t),components:[nC.parts.items({})],items:e.items,markers:{itemSelector:"*:not(.tox-split-button) > .tox-tbtn:not([disabled]), .tox-split-button:not([disabled]), .tox-toolbar-nav-js:not([disabled])"},tgroupBehaviours:gc([pv.config({}),Fd.config({})])}}function t1(e){return nC.sketch(e1(e))}function n1(n,e){var t=bi(function(e){var t=S(n.initGroups,t1);eC.setGroups(e,t)});return gc([Pp(n.providers.isDisabled),op(),Rd.config({mode:e,onEscape:n.onEscape,selector:".tox-toolbar__group"}),id("toolbar-events",[t])])}function o1(e){var t=e.cyclicKeying?"cyclic":"acyclic";return{uid:e.uid,dom:{tag:"div",classes:["tox-toolbar-overlord"]},parts:{"overflow-group":e1({title:G.none(),items:[]}),"overflow-button":ex({name:"more",icon:G.some("more-drawer"),disabled:!1,tooltip:G.some("More..."),primary:!1,borderless:!1},G.none(),e.providers)},splitToolbarBehaviours:n1(e,t)}}function r1(o){var e=o1(o),t=oC.parts.primary({dom:{tag:"div",classes:["tox-toolbar__primary"]}});return oC.sketch(A(A({},e),{lazySink:o.getSink,getOverflowBounds:function(){var e=o.moreDrawerData.lazyHeader().element,t=ku(e),n=Pt(e),e=ku(n),n=Math.max(n.dom.scrollHeight,e.height);return Cu(t.x+4,e.y,t.width-8,n)},parts:A(A({},e.parts),{overflow:{dom:{tag:"div",classes:["tox-toolbar__overflow"],attributes:o.attributes}}}),components:[t],markers:{overflowToggledClass:"tox-tbtn--enabled"}}))}function i1(e){var t=uC.parts.primary({dom:{tag:"div",classes:["tox-toolbar__primary"]}}),n=uC.parts.overflow({dom:{tag:"div",classes:["tox-toolbar__overflow"]}}),e=o1(e);return uC.sketch(A(A({},e),{components:[t,n],markers:{openClass:"tox-toolbar__overflow--open",closedClass:"tox-toolbar__overflow--closed",growingClass:"tox-toolbar__overflow--growing",shrinkingClass:"tox-toolbar__overflow--shrinking",overflowToggledClass:"tox-tbtn--enabled"},onOpened:function(e){e.getSystem().broadcastOn([aC()],{type:"opened"})},onClosed:function(e){e.getSystem().broadcastOn([aC()],{type:"closed"})}}))}function u1(e){var t=e.cyclicKeying?"cyclic":"acyclic";return eC.sketch({uid:e.uid,dom:{tag:"div",classes:["tox-toolbar"].concat(e.type===fg.scrolling?["tox-toolbar--scrolling"]:[])},components:[eC.parts.groups({})],toolbarBehaviours:n1(e,t)})}function a1(e){return Fe("menubutton",sC,e)}function c1(t){return{isDisabled:function(){return Ug.isDisabled(t)},setDisabled:function(e){return Ug.set(t,e)}}}function s1(t){return{setActive:function(e){Vd.set(t,e)},isActive:function(){return Vd.isOn(t)},isDisabled:function(){return Ug.isDisabled(t)},setDisabled:function(e){return Ug.set(t,e)}}}function l1(e,t){return e.map(function(e){return{"aria-label":t.translate(e),title:t.translate(e)}}).getOr({})}function f1(t,n,e,o,r,i){function u(e){return Vg.isRtl()&&ne(gC,e)?e+"-rtl":e}var a=Vg.isRtl()&&t.exists(function(e){return ne(pC,e)});return{dom:{tag:"button",classes:["tox-tbtn"].concat(n.isSome()?["tox-tbtn--select"]:[]).concat(a?["tox-tbtn__icon-rtl"]:[]),attributes:l1(e,i)},components:ap([t.map(function(e){return j0(u(e),i.icons)}),n.map(function(e){return W0(e,"tox-tbtn",i)})]),eventOrder:((e={})[Dr()]=["focusing","alloy.base.behaviour","common-button-display-events"],e),buttonBehaviours:gc([Pp(i.isDisabled),op(),id("common-button-display-events",[Et(Dr(),function(e,t){t.event.prevent(),xt(e,mC)})])].concat(o.map(function(e){return fC.config({channel:e,initialData:{icon:t,text:n},renderComponents:function(e,t){return ap([e.icon.map(function(e){return j0(u(e),i.icons)}),e.text.map(function(e){return W0(e,"tox-tbtn",i)})])}})}).toArray()).concat(r.getOr([])))}}function d1(e,t,n){var o,r=it(W),i=f1(e.icon,e.text,e.tooltip,G.none(),G.none(),n);return om.sketch({dom:i.dom,components:i.components,eventOrder:vx,buttonBehaviours:gc([id("toolbar-button-events",[(o={onAction:e.onAction,getApi:t.getApi},wi(function(t,e){rp(o,t)(function(e){wt(t,hx,{buttonApi:e}),o.onAction(e)})})),ip(t,r),up(t,r)]),Pp(function(){return e.disabled||n.isDisabled()}),op()].concat(t.toolbarButtonBehaviours))})}function m1(t,e){function n(n){return{isDisabled:function(){return Ug.isDisabled(n)},setDisabled:function(e){return Ug.set(n,e)},setIconFill:function(e,t){Vu(n.element,'svg path[id="'+e+'"], rect[id="'+e+'"]').each(function(e){Qt(e,"fill",t)})},setIconStroke:function(e,t){Vu(n.element,'svg path[id="'+e+'"], rect[id="'+e+'"]').each(function(e){Qt(e,"stroke",t)})},setActive:function(t){Qt(n.element,"aria-pressed",t),Vu(n.element,"span").each(function(e){n.getSystem().getByDom(e).each(function(e){return Vd.set(e,t)})})},isActive:function(){return Vu(n.element,"span").exists(function(e){return n.getSystem().getByDom(e).exists(Vd.isOn)})}}}var o,r,i,u=un("channel-update-split-dropdown-display"),a=it(W),c={getApi:n,onSetup:t.onSetup};return dC.sketch({dom:{tag:"div",classes:["tox-split-button"],attributes:A({"aria-pressed":!1},l1(t.tooltip,e.providers))},onExecute:function(e){t.onAction(n(e))},onItemExecute:function(e,t,n){},splitDropdownBehaviours:gc([Fp(e.providers.isDisabled),op(),id("split-dropdown-events",[Et(mC,Fd.focus),ip(c,a),up(c,a)]),my.config({})]),eventOrder:((a={})[ui()]=["alloy.base.behaviour","split-dropdown-events"],a),toggleClass:"tox-tbtn--enabled",lazySink:e.getSink,fetch:(o=n,r=t,i=e.providers,function(t){return Hv(function(e){return r.fetch(e)}).map(function(e){return G.from(Mh(wo(fh(un("menu-value"),e,function(e){r.onItemAction(o(t),e)},r.columns,r.presets,dg.CLOSE_ON_EXECUTE,r.select.getOr(function(){return!1}),i),{movement:dh(r.columns,r.presets),menuBehaviours:Rg("auto"!==r.columns?[]:[bi(function(n,e){Gm(n,4,Im(r.presets)).each(function(e){var t=e.numRows,e=e.numColumns;Rd.setGridSize(n,t,e)})})])})))})}),parts:{menu:Lm(0,t.columns,t.presets)},components:[dC.parts.button(f1(t.icon,t.text,G.none(),G.some(u),G.some([Vd.config({toggleClass:"tox-tbtn--enabled",toggleOnExecute:!1})]),e.providers)),dC.parts.arrow({dom:{tag:"button",classes:["tox-tbtn","tox-split-button__chevron"],innerHtml:Dd("chevron-down",e.providers.icons)},buttonBehaviours:gc([Fp(e.providers.isDisabled),op()])}),dC.parts["aria-descriptor"]({text:e.providers.translate("To open the popup, press Shift+Enter")})]})}function g1(o,r){return Et(hx,function(e,t){var n,e=o.get(e),e=(n=e,{hide:function(){return xt(n,Zr())},getValue:function(){return El.getValue(n)}});r.onAction(e,t.event.buttonApi)})}function p1(e,t,n){var o,r,i,u={backstage:{shared:{providers:n}}};return"contextformtogglebutton"===t.type?(o=e,i=u,(n=(r=t).original).primary,n=f(n,["primary"]),n=Pe(ym(A(A({},n),{type:"togglebutton",onAction:function(){}}))),vC(n,i.backstage.shared.providers,[g1(o,r)])):(r=e,e=u,(t=(u=t).original).primary,t=f(t,["primary"]),t=Pe(bm(A(A({},t),{type:"button",onAction:function(){}}))),hC(t,e.backstage.shared.providers,[g1(r,u)]))}function h1(e,t){var n,o,r,i,u=e.label.fold(function(){return{}},function(e){return{"aria-label":e}}),u=Ed(Tv.sketch({inputClasses:["tox-toolbar-textfield","tox-toolbar-nav-js"],data:e.initValue(),inputAttributes:u,selectOnFocus:!0,inputBehaviours:gc([Rd.config({mode:"special",onEnter:function(e){return a.findPrimary(e).map(function(e){return Ct(e),!0})},onLeft:function(e,t){return t.cut(),G.none()},onRight:function(e,t){return t.cut(),G.none()}})])})),a=(n=u,o=e.commands,r=t,i=S(o,function(e){return Ed(p1(n,e,r))}),{asSpecs:function(){return S(i,function(e){return e.asSpec()})},findPrimary:function(n){return P(o,function(e,t){return e.primary?G.from(i[t]).bind(function(e){return e.getOpt(n)}).filter(p(Ug.isDisabled)):G.none()})}});return[{title:G.none(),items:[u.asSpec()]},{title:G.none(),items:a.asSpecs()}]}function v1(e,t){var n,o=xu(window),r=Su(ir.fromDom(e.getContentAreaContainer())),i=cg(e)||sg(e)||qg(e),u=(a=(a=r,u=o,n=Math.max(u.x,a.x),a=a.right-n,u=u.width-(n-u.x),{x:n,width:Math.min(a,u)})).x,a=a.width;return e.inline&&!i?Cu(u,o.y,a,o.height):(t=(o=function(e,t,n,o){var r=ir.fromDom(e.getContainer()),i=Vu(r,".tox-editor-header").getOr(r),i=Su(i),t=i.y>=t.bottom,t=o&&!t;if(e.inline&&t)return{y:Math.max(i.bottom,n.y),bottom:n.bottom};if(e.inline&&!t)return{y:n.y,bottom:Math.min(i.y,n.bottom)};r=Su(r);return t?{y:Math.max(i.bottom,n.y),bottom:Math.min(r.bottom,n.bottom)}:{y:Math.max(r.y,n.y),bottom:Math.min(i.y,n.bottom)}}(e,r,o,t.header.isPositionedAtTop())).y,o=o.bottom,Cu(u,t,a,o-t))}function b1(t,e){return e=C(e,function(e){return e.predicate(t.dom)}),{contextToolbars:(e=w(e,function(e){return"contexttoolbar"===e.type})).pass,contextForms:e.fail}}function y1(e){if(e.length<=1)return e;function t(t){return C(e,function(e){return e.position===t})}var n=function(t){return b(e,function(e){return e.position===t})},o=n("selection"),r=n("node");if(o||r){if(r&&o){n=t("node"),r=S(t("selection"),function(e){return A(A({},e),{position:"node"})});return n.concat(r)}return t(o?"selection":"node")}return t("line")}function x1(e){return e.length<=1?e:t("selection").orThunk(function(){return t("node")}).orThunk(function(){return t("line")}).map(function(e){return e.position}).fold(function(){return[]},function(t){return C(e,function(e){return e.position===t})});function t(t){return _(e,function(e){return e.position===t})}}function w1(n,e){function r(e){return dt(e,t)}var t=ir.fromDom(e.getBody()),i=ir.fromDom(e.selection.getNode());return r(e=i)||gt(t,e)?function(e,t,n){t=b1(e,t);if(0<t.contextForms.length)return G.some({elem:e,toolbars:[t.contextForms[0]]});n=b1(e,n);if(0<n.contextForms.length)return G.some({elem:e,toolbars:[n.contextForms[0]]});if(0<t.contextToolbars.length||0<n.contextToolbars.length){n=y1(t.contextToolbars.concat(n.contextToolbars));return G.some({elem:e,toolbars:n})}return G.none()}(i,n.inNodeScope,n.inEditorScope).orThunk(function(){return o=n,(e=r)(t=i)?G.none():ht(t,function(e){var t=b1(e,o.inNodeScope),n=t.contextToolbars,t=t.contextForms,n=0<t.length?t:x1(n);return 0<n.length?G.some({elem:e,toolbars:n}):G.none()},e);var e,t,o}):G.none()}function C1(n,r){function o(t,n){var o=Pe(Fe("ContextForm",Rm,n));(e[t]=o).launch.map(function(e){c["form:"+t]=A(A({},n.launch),{type:"contextformtogglebutton"===e.type?"togglebutton":"button",onAction:function(){r(o)}})}),("editor"===o.scope?a:u).push(o),s[t]=o}function i(t,n){Fe("ContextToolbar",Mm,n).each(function(e){("editor"===n.scope?a:u).push(e),s[t]=e})}var e={},u=[],a=[],c={},s={},t=lo(n);return oe(t,function(e){var t=n[e];"contextform"===t.type?o(e,t):"contexttoolbar"===t.type&&i(e,t)}),{forms:e,inNodeScope:u,inEditorScope:a,lookupTable:s,formNavigators:c}}function S1(e,i,u){function r(e,t,n,o){var r=i.shared.providers.translate(e.title);return"separator"===e.type?G.some({type:"separator",text:r}):"submenu"!==e.type?G.some(A({type:"togglemenuitem",text:r,icon:e.icon,active:e.isSelected(o),disabled:n,onAction:u.onAction(e)},e.getStylePreview().fold(function(){return{}},function(e){return{meta:{style:e}}}))):(n=T(e.getStyleItems(),function(e){return c(e,t,o)}),0===t&&n.length<=0?G.none():G.some({type:"nestedmenuitem",text:r,disabled:n.length<=0,getSubmenuItems:function(){return T(e.getStyleItems(),function(e){return c(e,t,o)})}}))}function a(e){var t=u.getCurrentValue(),n=u.shouldHide?0:1;return T(e,function(e){return c(e,n,t)})}var c=function(e,t,n){var o="formatter"===e.type&&u.isInvalid(e);return 0===t?o?[]:r(e,t,!1,n).toArray():r(e,t,o,n).toArray()};return{validateItems:a,getFetch:function(o,r){return function(e,t){var n=r(),n=a(n);t(Y0(n,dg.CLOSE_ON_EXECUTE,o,!1))}}}}function k1(e,t,n){var o=n.dataset,r="basic"===o.type?function(){return S(o.data,function(e){return uw(e,n.isSelectedFor,n.getPreviewFor)})}:o.getData;return{items:S1(0,t,n),getStyleItems:r}}function O1(o,e,t){var n=(r=k1(0,e,t)).items,r=r.getStyleItems;return q0({text:t.icon.isSome()?G.none():G.some(""),icon:t.icon,tooltip:G.from(t.tooltip),role:G.none(),fetch:n.getFetch(e,r),onSetup:function(n){return t.setInitialValue.each(function(e){return e(n.getComponent())}),t.nodeChangeHandler.map(function(e){var t=e(n.getComponent());return o.on("NodeChange",t),function(){o.off("NodeChange",t)}}).getOr(W)},getApi:function(e){return{getComponent:function(){return e}}},columns:1,presets:"normal",classes:t.icon.isSome()?[]:["bespoke"],dropdownBehaviours:[]},"tox-tbtn",e.shared)}var _1,E1,T1="data-value",D1=function(t,n,e,o){return S(e,function(e){return Vx(e)?{type:"togglemenuitem",text:e.text,value:e.value,active:e.value===o,onAction:function(){El.setValue(t,e.value),wt(t,yv,{name:n}),Fd.focus(t)}}:{type:"nestedmenuitem",text:e.text,getSubmenuItems:function(){return D1(t,n,e.items,o)}}})},A1=function(e,t){return P(e,function(e){return Vx(e)?Ul(e.value===t,e):A1(e.items,t)})},B1=zl({name:"HtmlSelect",configFields:[ze("options"),Wr("selectBehaviours",[Fd,El]),Ze("selectClasses",[]),Ze("selectAttributes",{}),Xe("data")],factory:function(n,e){var t=S(n.options,function(e){return{dom:{tag:"option",value:e.value,innerHtml:e.text}}}),o=n.data.map(function(e){return To("initialValue",e)}).getOr({});return{uid:n.uid,dom:{tag:"select",classes:n.selectClasses,attributes:n.selectAttributes},components:t,behaviours:Rs(n.selectBehaviours,[Fd.config({}),El.config({store:A({mode:"manual",getValue:function(e){return Wn(e.element)},setValue:function(e,t){_(n.options,function(e){return e.value===t}).isSome()&&qn(e.element,t)}},o)})])}}}),t=Object.freeze({__proto__:null,events:function(e,t){var n=e.stream.streams.setup(e,t);return vi([Et(e.event,n),yi(function(){return t.cancel()})].concat(e.cancelEvent.map(function(e){return[Et(e,function(){return t.cancel()})]}).getOr([])))}}),pr=function(e){var t=it(null);return qi({readState:function(){return{timer:null!==t.get()?"set":"unset"}},setTimer:function(e){t.set(e)},cancel:function(){var e=t.get();null!==e&&e.cancel()}})},Uv=Object.freeze({__proto__:null,throttle:pr,init:function(e){return e.stream.streams.state(e)}}),Yi=[je("stream",Ve("mode",{throttle:[ze("delay"),Ze("stopEvent",!0),$u("streams",{setup:function(e,t){var n=e.stream,o=am(e.onStream,n.delay);return t.setTimer(o),function(e,t){o.throttle(e,t),n.stopEvent&&t.stop()}},state:pr})]})),Ze("event","input"),Xe("cancelEvent"),Qa("onStream")],N1=ya({fields:Yi,name:"streaming",active:t,state:Uv}),R1=function(e){Ux(e,function(e,t){return e.setSelectionRange(t.length,t.length)})},M1=q("alloy.typeahead.itemexecute"),Ur=q([Xe("lazySink"),ze("fetch"),Ze("minChars",5),Ze("responseTime",1e3),Ka("onOpen"),Ze("getHotspot",G.some),Ze("getAnchorOverrides",q({})),Ze("layouts",G.none()),Ze("eventOrder",{}),ot("model",{},[Ze("getDisplayText",function(e){return void 0!==e.meta&&void 0!==e.meta.text?e.meta.text:e.value}),Ze("selectsOver",!0),Ze("populateFromBrowse",!0)]),Ka("onSetValue"),Ja("onExecute"),Ka("onItemExecute"),Ze("inputClasses",[]),Ze("inputAttributes",{}),Ze("inputStyles",{}),Ze("matchWidth",!0),Ze("useMinWidth",!1),Ze("dismissOnBlur",!0),Ya(["openClass"]),Xe("initialData"),Wr("typeaheadBehaviours",[Fd,El,N1,Rd,Vd,qv]),Fo("previewing",function(){return it(!0)})].concat(gr()).concat(Ri())),pr=q([xo({schema:[Xa()],name:"menu",overrides:function(o){return{fakeFocus:!0,onHighlight:function(t,n){o.previewing.get()?t.getSystem().getByUid(o.uid).each(function(e){Wx(o.model,e,n).fold(function(){return hf.dehighlight(t,n)},function(e){return e()})}):t.getSystem().getByUid(o.uid).each(function(e){o.model.populateFromBrowse&&jx(o.model,e,n)}),o.previewing.set(!1)},onExecute:function(e,t){return e.getSystem().getByUid(o.uid).toOptional().map(function(e){return wt(e,M1(),{item:t}),!0})},onHover:function(e,t){o.previewing.set(!1),e.getSystem().getByUid(o.uid).each(function(e){o.model.populateFromBrowse&&jx(o.model,e,t)})}}}})]),I1=yc({name:"Typeahead",configFields:Ur(),partFields:pr(),factory:function(r,e,t,i){function n(e,t,n){r.previewing.set(!1);var o=qv.getCoupled(e,"sandbox");wl.isOpen(o)?lf.getCurrent(o).each(function(e){hf.getHighlighted(e).fold(function(){n(e)},function(){kt(o,e.element,"keydown",t)})}):Xv(r,u(e),e,o,i,function(e){lf.getCurrent(e).each(n)},Iv.HighlightFirst).get(W)}var o=av(r),u=function(n){return function(e){return e.map(function(e){var t=pe(e.menus),t=T(t,function(e){return C(e.items,function(e){return"item"===e.type})});return El.getState(n).update(S(t,function(e){return e.data})),e})}},a=[Fd.config({}),El.config({onSetValue:r.onSetValue,store:A({mode:"dataset",getDataKey:function(e){return Wn(e.element)},getFallbackEntry:function(e){return{value:e,meta:{}}},setValue:function(e,t){qn(e.element,r.model.getDisplayText(t))}},r.initialData.map(function(e){return To("initialValue",e)}).getOr({}))}),N1.config({stream:{mode:"throttle",delay:r.responseTime,stopEvent:!1},onStream:function(e,t){var n,o=qv.getCoupled(e,"sandbox");Fd.isFocused(e)&&Wn(e.element).length>=r.minChars&&(n=lf.getCurrent(o).bind(function(e){return hf.getHighlighted(e).map(El.getValue)}),r.previewing.set(!0),Xv(r,u(e),e,o,i,function(e){lf.getCurrent(o).each(function(e){n.fold(function(){r.model.selectsOver&&hf.highlightFirst(e)},function(t){hf.highlightBy(e,function(e){return El.getValue(e).value===t.value}),hf.getHighlighted(e).orThunk(function(){return hf.highlightFirst(e),G.none()})})})},Iv.HighlightFirst).get(W))},cancelEvent:ei()}),Rd.config({mode:"special",onDown:function(e,t){return n(e,t,hf.highlightFirst),G.some(!0)},onEscape:function(e){e=qv.getCoupled(e,"sandbox");return wl.isOpen(e)?(wl.close(e),G.some(!0)):G.none()},onUp:function(e,t){return n(e,t,hf.highlightLast),G.some(!0)},onEnter:function(t){var e=qv.getCoupled(t,"sandbox"),n=wl.isOpen(e);if(n&&!r.previewing.get())return lf.getCurrent(e).bind(function(e){return hf.getHighlighted(e)}).map(function(e){return wt(t,M1(),{item:e}),!0});var o=El.getValue(t);return xt(t,ei()),r.onExecute(e,t,o),n&&wl.close(e),G.some(!0)}}),Vd.config({toggleClass:r.markers.openClass,aria:{mode:"expanded"}}),qv.config({others:{sandbox:function(e){return Zv(r,e,{onOpen:function(){return Vd.on(e)},onClose:function(){return Vd.off(e)}})}}}),id("typeaheadevents",[wi(function(e){var t=W;Kv(r,u(e),e,i,t,Iv.HighlightFirst).get(W)}),Et(M1(),function(e,t){var n=qv.getCoupled(e,"sandbox");jx(r.model,e,t.event.item),xt(e,ei()),r.onItemExecute(e,n,t.event.item,El.getValue(e)),wl.close(n),R1(e)})].concat(r.dismissOnBlur?[Et(Gr(),function(e){e=qv.getCoupled(e,"sandbox");Ca(e.element).isNone()&&wl.close(e)})]:[]))];return{uid:r.uid,dom:cv(wo(r,{inputAttributes:{role:"combobox","aria-autocomplete":"list","aria-haspopup":"true"}})),behaviours:A(A({},o),Rs(r.typeaheadBehaviours,a)),eventOrder:r.eventOrder}}}),F1=function(i){return A(A({},i),{toCached:function(){return F1(i.toCached())},bindFuture:function(t){return F1(i.bind(function(e){return e.fold(function(e){return zv(ce.error(e))},function(e){return t(e)})}))},bindResult:function(t){return F1(i.map(function(e){return e.bind(t)}))},mapResult:function(t){return F1(i.map(function(e){return e.map(t)}))},mapError:function(t){return F1(i.map(function(e){return e.mapError(t)}))},foldResult:function(t,n){return i.map(function(e){return e.fold(t,n)})},withTimeout:function(e,r){return F1(Hv(function(t){var n=!1,o=setTimeout(function(){n=!0,t(ce.error(r()))},e);i.get(function(e){n||(clearTimeout(o),t(e))})}))}})},Yi=function(e){return F1(zv(ce.value(e)))},P1=qx,L1={type:"separator"},V1=un("aria-invalid"),H1={bar:Qx(function(e,t){return t=t.shared,{dom:{tag:"div",classes:["tox-bar","tox-form__controls-h-stack"]},components:S(e.items,t.interpreter)}}),collection:Qx(function(e,t){return uv(e,t.shared.providers)}),alertbanner:Qx(function(e,t){return n=e,t=t.shared.providers,mv.sketch({dom:{tag:"div",attributes:{role:"alert"},classes:["tox-notification","tox-notification--in","tox-notification--"+n.level]},components:[{dom:{tag:"div",classes:["tox-notification__icon"]},components:[om.sketch({dom:{tag:"button",classes:["tox-button","tox-button--naked","tox-button--icon"],innerHtml:Dd(n.icon,t.icons),attributes:{title:t.translate(n.iconTooltip)}},action:function(e){wt(e,Cv,{name:"alert-banner",value:n.url})}})]},{dom:{tag:"div",classes:["tox-notification__body"],innerHtml:t.translate(n.text)}}]});var n}),input:Qx(function(e,t){return e=e,t=t.shared.providers,zx({name:e.name,multiline:!1,label:e.label,inputMode:e.inputMode,placeholder:e.placeholder,flex:!1,disabled:e.disabled,classname:"tox-textfield",validation:G.none(),maximized:e.maximized},t)}),textarea:Qx(function(e,t){return e=e,t=t.shared.providers,zx({name:e.name,multiline:!0,label:e.label,inputMode:G.none(),placeholder:e.placeholder,flex:!0,disabled:e.disabled,classname:"tox-textarea",validation:G.none(),maximized:e.maximized},t)}),label:Qx(function(e,t){return n=e,e=t.shared,t={dom:{tag:"label",innerHtml:e.providers.translate(n.label),classes:["tox-label"]}},e=S(n.items,e.interpreter),{dom:{tag:"div",classes:["tox-form__group"]},components:[t].concat(e),behaviours:gc([Dy(),Id.config({}),Ly(G.none()),Rd.config({mode:"acyclic"})])};var n}),iframe:(_1=function(e,t){return ly(e,t.shared.providers)},function(e,t,n){t=wo(t,{source:"dynamic"});return Qx(_1)(e,t,n)}),button:Qx(function(e,t){return ux(e,t.shared.providers)}),checkbox:Qx(function(e,t){return n=e,o=t.shared.providers,r=El.config({store:{mode:"manual",getValue:function(e){return e.element.dom.checked},setValue:function(e,t){e.element.dom.checked=t}}}),e=function(e){return e.element.dom.click(),G.some(!0)},t=gv.parts.field({factory:{sketch:l},dom:{tag:"input",classes:["tox-checkbox__input"],attributes:{type:"checkbox"}},behaviours:gc([Dy(),Ug.config({disabled:function(){return n.disabled||o.isDisabled()}}),pv.config({}),Fd.config({}),r,Rd.config({mode:"special",onEnter:e,onSpace:e,stopSpaceKeyup:!0}),id("checkbox-events",[Et(Vr(),function(e,t){wt(e,yv,{name:n.name})})])])}),r=gv.parts.label({dom:{tag:"span",classes:["tox-checkbox__label"],innerHtml:o.translate(n.label)},behaviours:gc([my.config({})])}),e=Ed({dom:{tag:"div",classes:["tox-checkbox__icons"]},components:[(e=function(e){return{dom:{tag:"span",classes:["tox-icon","tox-checkbox-icon__"+e],innerHtml:Dd("checked"===e?"selected":"unselected",o.icons)}}})("checked"),e("unchecked")]}),gv.sketch({dom:{tag:"label",classes:["tox-checkbox"]},components:[t,e.asSpec(),r],fieldBehaviours:gc([Ug.config({disabled:function(){return n.disabled||o.isDisabled()},disableClass:"tox-checkbox--disabled",onDisabled:function(e){gv.getField(e).each(Ug.disable)},onEnabled:function(e){gv.getField(e).each(Ug.enable)}}),op()])});var n,o,r}),colorinput:Qx(function(e,t){return tb(e,t.shared,t.colorinput)}),colorpicker:Qx(function(e){var t=function(e){return"tox-"+e},t=ey(ty,t),o=Ed(t.sketch({dom:{tag:"div",classes:["tox-color-picker-container"],attributes:{role:"presentation"}},onValidHex:function(e){wt(e,Cv,{name:"hex-valid",value:!0})},onInvalidHex:function(e){wt(e,Cv,{name:"hex-valid",value:!1})}}));return{dom:{tag:"div"},components:[o.asSpec()],behaviours:gc([El.config({store:{mode:"manual",getValue:function(e){e=o.get(e);return lf.getCurrent(e).bind(function(e){return El.getValue(e).hex}).map(function(e){return"#"+e}).getOr("")},setValue:function(e,t){var n=/^#([a-fA-F0-9]{3}(?:[a-fA-F0-9]{3})?)/.exec(t),e=o.get(e);lf.getCurrent(e).fold(function(){console.log("Can not find form")},function(e){El.setValue(e,{hex:G.from(n[1]).getOr("")}),ky.getField(e,"hex").each(function(e){xt(e,Lr())})})}}}),Dy()])}}),dropzone:Qx(function(e,t){return ry(e,t.shared.providers)}),grid:Qx(function(e,t){return t=t.shared,{dom:{tag:"div",classes:["tox-form__grid","tox-form__grid--"+e.columns+"col"]},components:S(e.items,t.interpreter)}}),listbox:Qx(function(e,t){return n=e,r=(o=t).shared.providers,i=re(n.items).filter(Vx),e=n.label.map(function(e){return iv(e,r)}),t={dom:{tag:"div",classes:["tox-listboxfield"]},components:[gv.parts.field({dom:{},factory:{sketch:function(e){return q0({uid:e.uid,text:i.map(function(e){return e.text}),icon:G.none(),tooltip:n.label,role:G.none(),fetch:function(e,t){e=D1(e,n.name,n.items,El.getValue(e));t(Y0(e,dg.CLOSE_ON_EXECUTE,o,!1))},onSetup:q(W),getApi:q({}),columns:1,presets:"normal",classes:[],dropdownBehaviours:[pv.config({}),El.config({store:{mode:"manual",initialValue:i.map(function(e){return e.value}).getOr(""),getValue:function(e){return Zt(e.element,T1)},setValue:function(t,e){A1(n.items,e).each(function(e){Qt(t.element,T1,e.value),wt(t,bx,{text:e.text})})}}})]},"tox-listbox",o.shared)}}})]},gv.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:B([e.toArray(),[t]]),fieldBehaviours:gc([Ug.config({disabled:q(n.disabled),onDisabled:function(e){gv.getField(e).each(Ug.disable)},onEnabled:function(e){gv.getField(e).each(Ug.enable)}})])});var n,o,r,i}),selectbox:Qx(function(e,t){return n=e,o=t.shared.providers,r=S(n.items,function(e){return{text:o.translate(e.text),value:e.value}}),e=n.label.map(function(e){return iv(e,o)}),t=gv.parts.field({dom:{},selectAttributes:{size:n.size},options:r,factory:B1,selectBehaviours:gc([Ug.config({disabled:function(){return n.disabled||o.isDisabled()}}),pv.config({}),id("selectbox-change",[Et(Vr(),function(e,t){wt(e,yv,{name:n.name})})])])}),r=1<n.size?G.none():G.some({dom:{tag:"div",classes:["tox-selectfield__icon-js"],innerHtml:Dd("chevron-down",o.icons)}}),r={dom:{tag:"div",classes:["tox-selectfield"]},components:B([[t],r.toArray()])},gv.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:B([e.toArray(),[r]]),fieldBehaviours:gc([Ug.config({disabled:function(){return n.disabled||o.isDisabled()},onDisabled:function(e){gv.getField(e).each(Ug.disable)},onEnabled:function(e){gv.getField(e).each(Ug.enable)}}),op()])});var n,o,r}),sizeinput:Qx(function(e,t){return fx(e,t.shared.providers)}),urlinput:Qx(function(e,t){return Jx(e,t,t.urlinput)}),customeditor:Qx(function(n){var o=it(G.none()),t=Ed({dom:{tag:n.tag}}),r=it(G.none());return{dom:{tag:"div",classes:["tox-custom-editor"]},behaviours:gc([id("custom-editor-events",[bi(function(e){t.getOpt(e).each(function(t){(Object.prototype.hasOwnProperty.call(n,"init")?n.init(t.element.dom):Ry.load(n.scriptId,n.scriptUrl).then(function(e){return e(t.element.dom,n.settings)})).then(function(t){r.get().each(function(e){t.setValue(e)}),r.set(G.none()),o.set(G.some(t))})})})]),El.config({store:{mode:"manual",getValue:function(){return o.get().fold(function(){return r.get().getOr("")},function(e){return e.getValue()})},setValue:function(e,t){o.get().fold(function(){r.set(G.some(t))},function(e){return e.setValue(t)})}}}),Dy()]),components:[t.asSpec()]}}),htmlpanel:Qx(function(e){return"presentation"===e.presets?mv.sketch({dom:{tag:"div",classes:["tox-form__group"],innerHtml:e.html}}):mv.sketch({dom:{tag:"div",classes:["tox-form__group"],innerHtml:e.html,attributes:{role:"document"}},containerBehaviours:gc([pv.config({}),Fd.config({})])})}),imagetools:Qx(function(e,t){return Lx(e,t.shared.providers)}),table:Qx(function(e,t){return Hx(e,t.shared.providers)}),panel:Qx(function(e,t){return{dom:{tag:"div",classes:e.classes},components:S(e.items,t.shared.interpreter)}})},z1={field:function(e,t){return t}},j1=function(t,n,o){return ho(H1,n.type).fold(function(){return console.error('Unknown factory type "'+n.type+'", defaulting to container: ',n),n},function(e){return e(t,n,o)})},U1={valignCentre:[],alignCentre:[],alignLeft:[],alignRight:[],right:[],left:[],bottom:[],top:[]},W1=[{title:"Headings",items:[{title:"Heading 1",format:"h1"},{title:"Heading 2",format:"h2"},{title:"Heading 3",format:"h3"},{title:"Heading 4",format:"h4"},{title:"Heading 5",format:"h5"},{title:"Heading 6",format:"h6"}]},{title:"Inline",items:[{title:"Bold",format:"bold"},{title:"Italic",format:"italic"},{title:"Underline",format:"underline"},{title:"Strikethrough",format:"strikethrough"},{title:"Superscript",format:"superscript"},{title:"Subscript",format:"subscript"},{title:"Code",format:"code"}]},{title:"Blocks",items:[{title:"Paragraph",format:"p"},{title:"Blockquote",format:"blockquote"},{title:"Div",format:"div"},{title:"Pre",format:"pre"}]},{title:"Align",items:[{title:"Left",format:"alignleft"},{title:"Center",format:"aligncenter"},{title:"Right",format:"alignright"},{title:"Justify",format:"alignjustify"}]}],q1=function(e){return O(e,function(e,t){if(vo(t,"items")){var n=q1(t.items);return{customFormats:e.customFormats.concat(n.customFormats),formats:e.formats.concat([{title:t.title,items:n.formats}])}}if(vo(t,"inline")||vo(t,"block")||vo(t,"selector")){n="custom-"+(U(t.name)?t.name:t.title.toLowerCase());return{customFormats:e.customFormats.concat([{name:n,format:t}]),formats:e.formats.concat([{title:t.title,format:n,icon:t.icon}])}}return A(A({},e),{formats:e.formats.concat(t)})},{customFormats:[],formats:[]})},G1=My.trim,t=function(t){return function(e){if(e&&1===e.nodeType){if(e.contentEditable===t)return!0;if(e.getAttribute("data-mce-contenteditable")===t)return!0}return!1}},$1=t("true"),X1=t("false"),Y1=function(e){return function(e){for(;e=e.parentNode;){var t=e.contentEditable;if(t&&"inherit"!==t)return $1(e)}return!1}(e)&&!X1(e)},K1=function(e){e=hw(e);return C(S(C(e,mw),gw).concat(S(C(e,fw),pw)),vw)},J1="tinymce-url-history",Q1=q(function(e,t){!function(e,t){t=Au.max(e,t,["margin-left","border-left-width","padding-left","padding-right","border-right-width","margin-right"]);Fn(e,"max-width",t+"px")}(e,Math.floor(t))}),Z1="contexttoolbar-hide",Uv=q([ze("dom"),Ze("shell",!0),Wr("toolbarBehaviours",[Id])]),gr=q([Pl({name:"groups",overrides:function(){return{behaviours:gc([Id.config({})])}}})]),eC=yc({name:"Toolbar",configFields:Uv(),partFields:gr(),factory:function(t,e,n,o){var r=function(e){return t.shell?G.some(e):Gs(e,t,"groups")},e=t.shell?{behaviours:[Id.config({})],components:[]}:{behaviours:[],components:e};return{uid:t.uid,dom:t.dom,components:e.components,behaviours:Rs(t.toolbarBehaviours,e.behaviours),apis:{setGroups:function(e,t){r(e).fold(function(){throw console.error("Toolbar was defined to not be a shell, but no groups container was specified in components"),new Error("Toolbar was defined to not be a shell, but no groups container was specified in components")},function(e){Id.set(e,t)})}},domModification:{attributes:{role:"group"}}}},apis:{setGroups:function(e,t,n){e.setGroups(t,n)}}}),Ur=q([Wr("splitToolbarBehaviours",[qv]),Fo("builtGroups",function(){return it([])})]),pr=q([Ya(["overflowToggledClass"]),Zo("getOverflowBounds"),ze("lazySink"),Fo("overflowGroups",function(){return it([])})].concat(Ur())),Yi=q([Fl({factory:eC,schema:Uv(),name:"primary"}),xo({schema:Uv(),name:"overflow"}),xo({name:"overflow-button"}),xo({name:"overflow-group"})]),t=q([Ya(["toggledClass"]),ze("lazySink"),Qo("fetch"),Zo("getBounds"),Qe("fireDismissalEventInstead",[Ze("event",ci())]),qo()]),gr=q([xo({name:"button",overrides:function(e){return{dom:{attributes:{"aria-haspopup":"true"}},buttonBehaviours:gc([Vd.config({toggleClass:e.markers.toggledClass,aria:{mode:"expanded"},toggleOnExecute:!1})])}}}),xo({factory:eC,schema:Uv(),name:"toolbar",overrides:function(t){return{toolbarBehaviours:gc([Rd.config({mode:"cyclic",onEscape:function(e){return Gs(e,t,"button").each(Fd.focus),G.none()}})])}}})]),tC=yc({name:"FloatingToolbarButton",factory:function(u,e,a,t){return A(A({},om.sketch(A(A({},t.button()),{action:function(e){Fw(e,t)},buttonBehaviours:Dl({dump:t.button().buttonBehaviours},[qv.config({others:{toolbarSandbox:function(e){return o=e,n=a,r=u,{dom:{tag:"div",attributes:{id:(i=zu()).id}},behaviours:gc([Rd.config({mode:"special",onEscape:function(e){return wl.close(e),G.some(!0)}}),wl.config({onOpen:function(e,t){r.fetch().get(function(e){Lw(o,t,r,n.layouts,e),i.link(o.element),Rd.focusIn(t)})},onClose:function(){Vd.off(o),Fd.focus(o),i.unlink(o.element)},isPartOf:function(e,t,n){return Wu(t,n)||Wu(o,n)},getAttachPoint:function(){return r.lazySink(o).getOrDie()}}),bc.config({channels:A(A({},Ts(A({isExtraPart:c},r.fireDismissalEventInstead.map(function(e){return{fireEventInstead:{event:e.event}}}).getOr({})))),Ds({doReposition:function(){wl.getState(qv.getCoupled(o,"toolbarSandbox")).each(function(e){Pw(o,e,r,n.layouts)})}}))})])};var o,n,r,i}}})])}))),{apis:{setGroups:function(t,n){wl.getState(qv.getCoupled(t,"toolbarSandbox")).each(function(e){Lw(t,e,u,a.layouts,n)})},reposition:function(t){wl.getState(qv.getCoupled(t,"toolbarSandbox")).each(function(e){Pw(t,e,u,a.layouts)})},toggle:function(e){Fw(e,t)},getToolbar:function(e){return wl.getState(qv.getCoupled(e,"toolbarSandbox"))},isOpen:function(e){return wl.isOpen(qv.getCoupled(e,"toolbarSandbox"))}}})},configFields:t(),partFields:gr(),apis:{setGroups:function(e,t,n){e.setGroups(t,n)},reposition:function(e,t){e.reposition(t)},toggle:function(e,t){e.toggle(t)},getToolbar:function(e,t){return e.getToolbar(t)},isOpen:function(e,t){return e.isOpen(t)}}}),t=q([ze("items"),Ya(["itemSelector"]),Wr("tgroupBehaviours",[Rd])]),gr=q([kr({name:"items",unit:"item"})]),nC=yc({name:"ToolbarGroup",configFields:t(),partFields:gr(),factory:function(e,t,n,o){return{uid:e.uid,dom:e.dom,components:t,behaviours:Rs(e.tgroupBehaviours,[Rd.config({mode:"flow",selector:e.markers.itemSelector})]),domModification:{attributes:{role:"toolbar"}}}}}),oC=yc({name:"SplitFloatingToolbar",configFields:pr(),partFields:Yi(),factory:function(n,e,t,o){var r=Ed(tC.sketch({fetch:function(){return Hv(function(e){e(Vw(n.overflowGroups.get()))})},layouts:{onLtr:function(){return[ra,oa]},onRtl:function(){return[oa,ra]},onBottomLtr:function(){return[ua,ia]},onBottomRtl:function(){return[ia,ua]}},getBounds:t.getOverflowBounds,lazySink:n.lazySink,fireDismissalEventInstead:{},markers:{toggledClass:n.markers.overflowToggledClass},parts:{button:o["overflow-button"](),toolbar:o.overflow()}}));return{uid:n.uid,dom:n.dom,components:e,behaviours:Rs(n.splitToolbarBehaviours,[qv.config({others:{overflowGroup:function(){return nC.sketch(A(A({},o["overflow-group"]()),{items:[r.asSpec()]}))}}})]),apis:{setGroups:function(e,t){n.builtGroups.set(S(t,e.getSystem().build)),Hw(e,r,n)},refresh:function(e){return Hw(e,r,n)},toggle:function(e){r.getOpt(e).each(function(e){tC.toggle(e)})},isOpen:function(e){return r.getOpt(e).map(tC.isOpen).getOr(!1)},reposition:function(e){r.getOpt(e).each(function(e){tC.reposition(e)})},getOverflow:function(e){return r.getOpt(e).bind(tC.getToolbar)}},domModification:{attributes:{role:"group"}}}},apis:{setGroups:function(e,t,n){e.setGroups(t,n)},refresh:function(e,t){e.refresh(t)},reposition:function(e,t){e.reposition(t)},toggle:function(e,t){e.toggle(t)},isOpen:function(e,t){return e.isOpen(t)},getOverflow:function(e,t){return e.getOverflow(t)}}}),gr=Object.freeze({__proto__:null,refresh:function(e,t,n){n.isExpanded()&&(jn(e.element,jw(t)),n=Uw(t,e.element),Fn(e.element,jw(t),n))},grow:function(e,t,n){n.isExpanded()||Kw(e,t,n)},shrink:function(e,t,n){n.isExpanded()&&Yw(e,t,n)},immediateShrink:function(e,t,n){n.isExpanded()&&$w(e,t,n,G.none())},hasGrown:function(e,t,n){return n.isExpanded()},hasShrunk:function(e,t,n){return n.isCollapsed()},isGrowing:Jw,isShrinking:Qw,isTransitioning:function(e,t,n){return!0===Jw(e,t)||!0===Qw(e,t)},toggleGrow:function(e,t,n){(n.isExpanded()?Yw:Kw)(e,t,n)},disableTransitions:Ww}),pr=Object.freeze({__proto__:null,exhibit:function(e,t,n){var o=t.expanded;return dn(o?{classes:[t.openClass],styles:{}}:{classes:[t.closedClass],styles:To(t.dimension.property,"0px")})},events:function(n,o){return vi([Rt(zr(),function(e,t){t.event.raw.propertyName===n.dimension.property&&(Ww(e,n),o.isExpanded()&&jn(e.element,n.dimension.property),(o.isExpanded()?n.onGrown:n.onShrunk)(e))})])}}),Yi=[ze("closedClass"),ze("openClass"),ze("shrinkingClass"),ze("growingClass"),Xe("getAnimationRoot"),Ka("onShrunk"),Ka("onStartShrink"),Ka("onGrown"),Ka("onStartGrow"),Ze("expanded",!1),je("dimension",Ve("property",{width:[$u("property","width"),$u("getDimension",function(e){return mu(e)+"px"})],height:[$u("property","height"),$u("getDimension",function(e){return su(e)+"px"})]}))],rC=ya({fields:Yi,name:"sliding",active:pr,apis:gr,state:Object.freeze({__proto__:null,init:function(e){var t=it(e.expanded);return qi({isExpanded:function(){return!0===t.get()},isCollapsed:function(){return!1===t.get()},setCollapsed:m(t.set,!1),setExpanded:m(t.set,!0),readState:function(){return"expanded: "+t.get()}})}})}),Ur=q([Ya(["closedClass","openClass","shrinkingClass","growingClass","overflowToggledClass"]),Ka("onOpened"),Ka("onClosed")].concat(Ur())),Uv=q([Fl({factory:eC,schema:Uv(),name:"primary"}),Fl({factory:eC,schema:Uv(),name:"overflow",overrides:function(t){return{toolbarBehaviours:gc([rC.config({dimension:{property:"height"},closedClass:t.markers.closedClass,openClass:t.markers.openClass,shrinkingClass:t.markers.shrinkingClass,growingClass:t.markers.growingClass,onShrunk:function(e){Gs(e,t,"overflow-button").each(function(e){Vd.off(e),Fd.focus(e)}),t.onClosed(e)},onGrown:function(e){Rd.focusIn(e),t.onOpened(e)},onStartGrow:function(e){Gs(e,t,"overflow-button").each(Vd.on)}}),Rd.config({mode:"acyclic",onEscape:function(e){return Gs(e,t,"overflow-button").each(Fd.focus),G.some(!0)}})])}}}),xo({name:"overflow-button",overrides:function(e){return{buttonBehaviours:gc([Vd.config({toggleClass:e.markers.overflowToggledClass,aria:{mode:"pressed"},toggleOnExecute:!1})])}}}),xo({name:"overflow-group"})]),iC=function(e,n){Gs(e,n,"overflow").each(function(t){Iw(e,n,function(e){e=S(e,function(e){return au(e)});eC.setGroups(t,e)}),Gs(e,n,"overflow-button").each(function(e){rC.hasGrown(t)&&Vd.on(e)}),rC.refresh(t)})},uC=yc({name:"SplitSlidingToolbar",configFields:Ur(),partFields:Uv(),factory:function(n,e,t,o){var r="alloy.toolbar.toggle";return{uid:n.uid,dom:n.dom,components:e,behaviours:Rs(n.splitToolbarBehaviours,[qv.config({others:{overflowGroup:function(t){return nC.sketch(A(A({},o["overflow-group"]()),{items:[om.sketch(A(A({},o["overflow-button"]()),{action:function(e){xt(t,r)}}))]}))}}}),id("toolbar-toggle-events",[Et(r,function(e){Zw(e,n)})])]),apis:{setGroups:function(e,t){!function(e,t){e=S(t,e.getSystem().build);n.builtGroups.set(e)}(e,t),iC(e,n)},refresh:function(e){return iC(e,n)},toggle:function(e){return Zw(e,n)},isOpen:function(e){return Gs(e,n,"overflow").map(rC.hasGrown).getOr(!1)}},domModification:{attributes:{role:"group"}}}},apis:{setGroups:function(e,t,n){e.setGroups(t,n)},refresh:function(e,t){e.refresh(t)},toggle:function(e,t){e.toggle(t)},isOpen:function(e,t){return e.isOpen(t)}}}),aC=q(un("toolbar-height-change")),cC=No([Ue("type"),je("items",Ro([Vo([Ue("name"),$e("items",$o)]),$o]))].concat(Mi)),Uv=[Je("text"),Je("tooltip"),Je("icon"),Qo("fetch"),nt("onSetup",function(){return W})],sC=No(h([Ue("type")],Uv)),lC=No([Ue("type"),Je("tooltip"),Je("icon"),Je("text"),Zo("select"),Qo("fetch"),nt("onSetup",function(){return W}),tr("presets","normal",["normal","color","listpreview"]),Ze("columns",1),Qo("onAction"),Qo("onItemAction")]),Mi=Object.freeze({__proto__:null,events:function(o,r){function i(t,n){o.updateState.each(function(e){e=e(t,n);r.set(e)}),o.renderComponents.each(function(e){e=e(n,r.get()),e=S(e,t.getSystem().build);bs(t,e)})}return vi([Et(Xr(),function(e,t){var n=t;n.universal||(t=o.channel,ne(n.channels,t)&&i(e,n.data))}),bi(function(t,e){o.initialData.each(function(e){i(t,e)})})])}}),Uv=Object.freeze({__proto__:null,getState:function(e,t,n){return n}}),Zo=[ze("channel"),Xe("renderComponents"),Xe("updateState"),Xe("initialData")],fC=ya({fields:Zo,name:"reflecting",active:Mi,apis:Uv,state:Object.freeze({__proto__:null,init:function(){var t=it(G.none());return{readState:function(){return t.get().fold(function(){return"none"},function(e){return e})},get:function(){return t.get()},set:function(e){return t.set(e)},clear:function(){return t.set(G.none())}}}})}),qo=q([ze("toggleClass"),ze("fetch"),Qa("onExecute"),Ze("getHotspot",G.some),Ze("getAnchorOverrides",q({})),qo(),Qa("onItemExecute"),Xe("lazySink"),ze("dom"),Ka("onOpen"),Wr("splitDropdownBehaviours",[qv,Rd,Fd]),Ze("matchWidth",!1),Ze("useMinWidth",!1),Ze("eventOrder",{}),Xe("role")].concat(Ri())),Qa=Fl({factory:om,schema:[ze("dom")],name:"arrow",defaults:function(){return{buttonBehaviours:gc([Fd.revoke()])}},overrides:function(t){return{dom:{tag:"span",attributes:{role:"presentation"}},action:function(e){e.getSystem().getByUid(t.uid).each(Ct)},buttonBehaviours:gc([Vd.config({toggleOnExecute:!1,toggleClass:t.toggleClass})])}}}),Ri=Fl({factory:om,schema:[ze("dom")],name:"button",defaults:function(){return{buttonBehaviours:gc([Fd.revoke()])}},overrides:function(n){return{dom:{tag:"span",attributes:{role:"presentation"}},action:function(t){t.getSystem().getByUid(n.uid).each(function(e){n.onExecute(e,t)})}}}}),Ri=q([Qa,Ri,Pl({factory:{sketch:function(e){return{uid:e.uid,dom:{tag:"span",styles:{display:"none"},attributes:{"aria-hidden":"true"},innerHtml:e.text}}}},schema:[ze("text")],name:"aria-descriptor"}),xo({schema:[Xa()],name:"menu",defaults:function(o){return{onExecute:function(t,n){t.getSystem().getByUid(o.uid).each(function(e){o.onItemExecute(e,t,n)})}}}}),si()]),dC=yc({name:"SplitDropdown",configFields:qo(),partFields:Ri(),factory:function(o,e,t,n){function r(e){lf.getCurrent(e).each(function(e){hf.highlightFirst(e),Rd.focusIn(e)})}function i(e){Kv(o,function(e){return e},e,n,r,Iv.HighlightFirst).get(W)}function u(e){return e=$s(e,o,"button"),Ct(e),G.some(!0)}var a=A(A({},vi([bi(function(n,e){Gs(n,o,"aria-descriptor").each(function(e){var t=un("aria");Qt(e.element,"id",t),Qt(n.element,"aria-describedby",t)})})])),gd(G.some(i))),c={repositionMenus:function(e){Vd.isOn(e)&&eb(e)}};return{uid:o.uid,dom:o.dom,components:e,apis:c,eventOrder:A(A({},o.eventOrder),((c={})[Yr()]=["disabling","toggling","alloy.base.behaviour"],c)),events:a,behaviours:Rs(o.splitDropdownBehaviours,[qv.config({others:{sandbox:function(e){var t=$s(e,o,"arrow");return Zv(o,e,{onOpen:function(){Vd.on(t),Vd.on(e)},onClose:function(){Vd.off(t),Vd.off(e)}})}}}),Rd.config({mode:"special",onSpace:u,onEnter:u,onDown:function(e){return i(e),G.some(!0)}}),Fd.config({}),Vd.config({toggleOnExecute:!1,aria:{mode:"expanded"}})]),domModification:{attributes:{role:o.role.getOr("button"),"aria-haspopup":!0}}}},apis:{repositionMenus:function(e,t){return e.repositionMenus(t)}}}),mC=un("focus-button"),gC=["checklist","ordered-list"],pC=["indent","outdent","table-insert-column-after","table-insert-column-before","unordered-list"],hC=function(e,t,n){return d1(e,{toolbarButtonBehaviours:[].concat(0<n.length?[id("toolbarButtonWith",n)]:[]),getApi:c1,onSetup:e.onSetup},t)},vC=function(e,t,n){return wo(d1(e,{toolbarButtonBehaviours:[Id.config({}),Vd.config({toggleClass:"tox-tbtn--enabled",aria:{mode:"pressed"},toggleOnExecute:!1})].concat(0<n.length?[id("toolbarToggleButtonWith",n)]:[]),getApi:s1,onSetup:e.onSetup},t))},bC=h1,yC=un("forward-slide"),xC=un("backward-slide"),wC=un("change-slide-event"),CC="tox-pop--resizing";(Xa=E1=E1||{})[Xa.SemiColon=0]="SemiColon",Xa[Xa.Space=1]="Space";function SC(e,t,n,o){return{type:"basic",data:(n=n=e.getParam(t,n,"string"),n=o===E1.SemiColon?n.replace(/;$/,"").split(";"):n.split(" "),S(n,function(e){var t=e,n=e,e=e.split("=");return 1<e.length&&(t=e[0],n=e[1]),{title:t,format:n}}))}}function kC(n){function t(e){var t=_(PS,function(e){return n.formatter.match(e.format)}).fold(function(){return"left"},function(e){return e.title.toLowerCase()});wt(e,yx,{icon:"align-"+t})}var e=G.some(function(e){return function(){return t(e)}}),o=G.some(t),r={type:"basic",data:PS};return{tooltip:"Align",icon:G.some("align-left"),isSelectedFor:function(e){return function(){return n.formatter.match(e)}},getCurrentValue:G.none,getPreviewFor:function(e){return function(){return G.none()}},onAction:function(t){return function(){return _(PS,function(e){return e.format===t.format}).each(function(e){return n.execCommand(e.command)})}},setInitialValue:o,nodeChangeHandler:e,dataset:r,shouldHide:!1,isInvalid:function(e){return!n.formatter.canApply(e.format)}}}function OC(e){return e=e.split(/\s*,\s*/),S(e,function(e){return e.replace(/^['"]+|['"]+$/g,"")})}function _C(r){function i(){function t(e){return e?OC(e)[0]:""}var e=r.queryCommandValue("FontName"),n=u.data,o=e?e.toLowerCase():"";return{matchOpt:_(n,function(e){e=e.format;return e.toLowerCase()===o||t(e).toLowerCase()===t(o).toLowerCase()}).orThunk(function(){return 0===(e=o).indexOf("-apple-system")&&(t=OC(e.toLowerCase()),D(LS,function(e){return-1<t.indexOf(e.toLowerCase())}))?G.from({title:"System Font",format:o}):G.none();var e,t}),font:e}}function t(e){var t=i(),n=t.matchOpt,o=t.font,n=n.fold(function(){return o},function(e){return e.title});wt(e,bx,{text:n})}var e=G.some(function(e){return function(){return t(e)}}),n=G.some(t),u=SC(r,"font_formats","Andale Mono=andale mono,monospace;Arial=arial,helvetica,sans-serif;Arial Black=arial black,sans-serif;Book Antiqua=book antiqua,palatino,serif;Comic Sans MS=comic sans ms,sans-serif;Courier New=courier new,courier,monospace;Georgia=georgia,palatino,serif;Helvetica=helvetica,arial,sans-serif;Impact=impact,sans-serif;Symbol=symbol;Tahoma=tahoma,arial,helvetica,sans-serif;Terminal=terminal,monaco,monospace;Times New Roman=times new roman,times,serif;Trebuchet MS=trebuchet ms,geneva,sans-serif;Verdana=verdana,geneva,sans-serif;Webdings=webdings;Wingdings=wingdings,zapf dingbats",E1.SemiColon);return{tooltip:"Fonts",icon:G.none(),isSelectedFor:function(t){return function(e){return e.exists(function(e){return e.format===t})}},getCurrentValue:function(){return i().matchOpt},getPreviewFor:function(e){return function(){return G.some({tag:"div",styles:-1===e.indexOf("dings")?{"font-family":e}:{}})}},onAction:function(e){return function(){r.undoManager.transact(function(){r.focus(),r.execCommand("FontName",!1,e.format)})}},setInitialValue:n,nodeChangeHandler:e,dataset:u,shouldHide:!1,isInvalid:function(){return!1}}}function EC(e,t){return/[0-9.]+px$/.test(e)?function(e,t){t=Math.pow(10,t);return Math.round(e*t)/t}(72*parseInt(e,10)/96,t||0)+"pt":ho(HS,e).getOr(e)}function TC(n){function r(){var o=G.none(),r=u.data,i=n.queryCommandValue("FontSize");if(i)for(var e=function(e){var t=EC(i,e),n=ho(VS,t).getOr("");o=_(r,function(e){return e.format===i||e.format===t||e.format===n})},t=3;o.isNone()&&0<=t;t--)e(t);return{matchOpt:o,size:i}}function t(e){var t=r(),n=t.matchOpt,o=t.size,n=n.fold(function(){return o},function(e){return e.title});wt(e,bx,{text:n})}var e=q(G.none),o=G.some(function(e){return function(){return t(e)}}),i=G.some(t),u=SC(n,"fontsize_formats","8pt 10pt 12pt 14pt 18pt 24pt 36pt",E1.Space);return{tooltip:"Font sizes",icon:G.none(),isSelectedFor:function(t){return function(e){return e.exists(function(e){return e.format===t})}},getPreviewFor:e,getCurrentValue:function(){return r().matchOpt},onAction:function(e){return function(){n.undoManager.transact(function(){n.focus(),n.execCommand("FontSize",!1,e.format)})}},setInitialValue:i,nodeChangeHandler:o,dataset:u,shouldHide:!1,isInvalid:function(){return!1}}}function DC(e,t){var n=t(),t=S(n,function(e){return e.format});return G.from(e.formatter.closest(t)).bind(function(t){return _(n,function(e){return e.format===t})}).orThunk(function(){return Ul(e.formatter.match("p"),{title:"Paragraph",format:"p"})})}function AC(e){function t(){return n.get().each(e)}var n=it(G.none());return{clear:function(){t(),n.set(G.none())},isSet:function(){return n.get().isSome()},set:function(e){t(),n.set(G.some(e))}}}function BC(){return AC(function(e){return e.destroy()})}function NC(){return AC(function(e){return e.unbind()})}function RC(o,r){return function(t){function e(){t.setActive(o.formatter.match(r));var e=o.formatter.formatChanged(r,t.setActive);n.set(e)}var n=NC();return o.initialized?e():o.on("init",e),n.clear}}function MC(t){return function(e){return function(){t.undoManager.transact(function(){t.focus(),t.execCommand("mceToggleFormat",!1,e.format)})}}}function IC(n){function t(e){var t=DC(n,function(){return r.data}).fold(function(){return"Paragraph"},function(e){return e.title});wt(e,bx,{text:t})}var e=G.some(function(e){return function(){return t(e)}}),o=G.some(t),r=SC(n,"block_formats","Paragraph=p;Heading 1=h1;Heading 2=h2;Heading 3=h3;Heading 4=h4;Heading 5=h5;Heading 6=h6;Preformatted=pre",E1.SemiColon);return{tooltip:"Blocks",icon:G.none(),isSelectedFor:function(e){return function(){return n.formatter.match(e)}},getCurrentValue:G.none,getPreviewFor:function(t){return function(){var e=n.formatter.get(t);return G.some({tag:0<e.length&&(e[0].inline||e[0].block)||"div",styles:n.dom.parseStyle(n.formatter.getCssText(t))})}},onAction:MC(n),setInitialValue:o,nodeChangeHandler:e,dataset:r,shouldHide:!1,isInvalid:function(e){return!n.formatter.canApply(e.format)}}}function FC(r,e){function t(e){var n=function(e){var t=e.items;return void 0!==t&&0<t.length?T(t,n):[{title:e.title,format:e.format}]},t=T(iw(r),n),o=DC(r,function(){return t}).fold(function(){return"Paragraph"},function(e){return e.title});wt(e,bx,{text:o})}var n=G.some(function(e){return function(){return t(e)}}),o=G.some(t);return{tooltip:"Formats",icon:G.none(),isSelectedFor:function(e){return function(){return r.formatter.match(e)}},getCurrentValue:G.none,getPreviewFor:function(t){return function(){var e=r.formatter.get(t);return void 0!==e?G.some({tag:0<e.length&&(e[0].inline||e[0].block)||"div",styles:r.dom.parseStyle(r.formatter.getCssText(t))}):G.none()}},onAction:MC(r),setInitialValue:o,nodeChangeHandler:n,shouldHide:r.getParam("style_formats_autohide",!1,"boolean"),isInvalid:function(e){return!r.formatter.canApply(e.format)},dataset:e}}function PC(e){var n,t=e.toolbar,e=e.buttons;return!1===t?[]:void 0===t||!0===t?(n=e,e=S(zS,function(e){var t=C(e.items,function(e){return vo(n,e)||vo(US,e)});return{name:e.name,items:t}}),C(e,function(e){return 0<e.items.length})):U(t)?function(e){e=e.split("|");return S(e,function(e){return{items:e.trim().split(" ")}})}(t):d(t,function(e){return vo(e,"name")&&vo(e,"items")})?t:(console.error("Toolbar type should be string, string[], boolean or ToolbarGroup[]"),[])}function LC(r,t,i,u,a,e){return ho(t,i.toLowerCase()).orThunk(function(){return e.bind(function(e){return P(e,function(e){return ho(t,e+i.toLowerCase())})})}).fold(function(){return ho(US,i.toLowerCase()).map(function(e){return e(r,a)}).orThunk(function(){return G.none()})},function(e){return"grouptoolbarbutton"!==e.type||u?(n=a,o=r,ho(jS,(t=e).type).fold(function(){return console.error("skipping button defined by",t),G.none()},function(e){return G.some(e(t,n,o))})):(console.warn("Ignoring the '"+i+"' toolbar button. Group toolbar buttons are only supported when using floating toolbar mode and cannot be nested."),G.none());var t,n,o})}function VC(r,e,n,i){function u(){return v1(r,i.backstage.shared)}function a(){if(f()&&i.backstage.isContextMenuOpen())return 1;var e,t,n=(e=g.get().filter(function(e){return eu(ir.fromDom(e))}).map(function(e){return e.getBoundingClientRect()}).getOrThunk(function(){return r.selection.getRng().getBoundingClientRect()}),t=r.inline?vu().top:ku(ir.fromDom(r.getBody())).y,{y:e.top+t,bottom:e.bottom+t}),o=u();return e=n.y,t=n.bottom,n=o.y,o=o.bottom,!(Math.max(e,n)<=Math.min(t,o))}function t(){Zd.hide(d)}function o(){m.get().each(function(e){var t=d.element;jn(t,"display"),a()?Fn(t,"display","none"):ml.positionWithinBounds(n,e,d,G.some(u()))})}function c(e){return{dom:{tag:"div",classes:["tox-pop__dialog"]},components:[e],behaviours:gc([Rd.config({mode:"acyclic"}),id("pop-dialog-wrap-events",[bi(function(e){r.shortcuts.add("ctrl+F9","focus statusbar",function(){return Rd.focusIn(e)})}),yi(function(e){r.shortcuts.remove("ctrl+F9")})])])}}var s,l,f=Cr().deviceType.isTouch,d=uu((s={sink:n,onEscape:function(){return r.focus(),G.some(!0)}},l=it([]),Zd.sketch({dom:{tag:"div",classes:["tox-pop"]},fireDismissalEventInstead:{event:"doNotDismissYet"},onShow:function(e){l.set([]),Zd.getContent(e).each(function(e){jn(e.element,"visibility")}),_n(e.element,CC),jn(e.element,"width")},inlineBehaviours:gc([id("context-toolbar-events",[Rt(zr(),function(e,t){_n(e.element,CC),jn(e.element,"width")}),Et(wC,function(t,n){jn(t.element,"width");var e=mu(t.element);Zd.setContent(t,n.event.contents),kn(t.element,CC);var o=mu(t.element);Fn(t.element,"width",e+"px"),Zd.getContent(t).each(function(e){n.event.focus.bind(function(e){return xa(e),Ca(t.element)}).orThunk(function(){return Rd.focusIn(e),wa()})}),nm.setTimeout(function(){Fn(t.element,"width",o+"px")},0)}),Et(yC,function(e,t){Zd.getContent(e).each(function(e){l.set(l.get().concat([{bar:e,focus:wa()}]))}),wt(e,wC,{contents:t.event.forwardContents,focus:G.none()})}),Et(xC,function(t,e){F(l.get()).each(function(e){l.set(l.get().slice(0,l.get().length-1)),wt(t,wC,{contents:au(e.bar),focus:e.focus})})})]),Rd.config({mode:"special",onEscape:function(t){return F(l.get()).fold(function(){return s.onEscape()},function(e){return xt(t,xC),G.some(!0)})}})]),lazySink:function(){return ce.value(s.sink)}}))),m=it(G.none()),g=it(G.none()),p=it(null),h=ve(function(){return C1(e,function(e){e=v([e]);wt(d,yC,{forwardContents:c(e)})})}),v=function(e){var t=r.ui.registry.getAll().buttons,n=h(),o=A(A({},t),n.formNavigators),n=Gg(r)===fg.scrolling?fg.scrolling:fg.default,e=B(S(e,function(e){return"contexttoolbar"===e.type?WS(r,{buttons:o,toolbar:e.items,allowToolbarGroups:!1},i,G.some(["form:"])):(t=i.backstage.shared.providers,bC(e,t));var t}));return u1({type:n,uid:un("context-toolbar"),initGroups:e,onEscape:G.none,cyclicKeying:!0,providers:i.backstage.shared.providers})};function b(e,t){return t="node"===e?i.backstage.shared.anchors.node(t):i.backstage.shared.anchors.cursor(),wo(t,(t=e,e=f(),"line"===t?{bubble:Pa(12,0,qS),layouts:{onLtr:function(){return[aa]},onRtl:function(){return[ca]}},overrides:GS}:{bubble:Pa(0,12,qS),layouts:e?XS:$S,overrides:GS}))}function y(){var e;r.hasFocus()&&(e=h(),w1(e,r).fold(function(){m.set(G.none()),Zd.hide(d)},function(e){w(e.toolbars,G.some(e.elem.dom))}))}function x(e){C(),p.set(e)}r.on("contexttoolbar-show",function(t){var e=h();ho(e.lookupTable,t.toolbarKey).each(function(e){w([e],t.target===r?G.none():G.some(t)),Zd.getContent(d).each(Rd.focusIn)})});var w=function(e,t){var n,o;C(),f()&&i.backstage.isContextMenuOpen()||(n=v(e),o=t.map(ir.fromDom),o=b(e[0].position,o),m.set(G.some(o)),g.set(t),t=d.element,jn(t,"display"),Zd.showWithinBounds(d,o,c(n),function(){return G.some(u())}),a()&&Fn(t,"display","none"))},C=function(){var e=p.get();null!==e&&(nm.clearTimeout(e),p.set(null))};r.on("init",function(){r.on(Z1,t),r.on("ScrollContent ScrollWindow longpress",o),r.on("click keyup focus SetContent ObjectResized ResizeEditor",function(){x(nm.setEditorTimeout(r,y,0))}),r.on("focusout",function(e){nm.setEditorTimeout(r,function(){Ca(n.element).isNone()&&Ca(d.element).isNone()&&(m.set(G.none()),Zd.hide(d))},0)}),r.on("SwitchMode",function(){r.mode.isReadOnly()&&(m.set(G.none()),Zd.hide(d))}),r.on("NodeChange",function(e){Ca(d.element).fold(function(){x(nm.setEditorTimeout(r,y,0))},function(e){})})})}function HC(e,o,r){function t(t,n){oe([o,r],function(e){e.broadcastEvent(t,n)})}function n(t,n){oe([o,r],function(e){e.broadcastOn([t],n)})}function i(e){return n(Cl(),{target:e.target})}function u(e){return n(Cl(),{target:ir.fromDom(e.target)})}function a(e){0===e.button&&n(kl(),{target:ir.fromDom(e.target)})}function c(e){return t(ri(),Hh(e))}function s(e){n(Sl(),{}),t(ii(),Hh(e))}function l(){return n(Sl(),{})}var f=Ih(ir.fromDom(document),"touchstart",i),d=Ih(ir.fromDom(document),"touchmove",function(e){return t(ni(),e)}),m=Ih(ir.fromDom(document),"touchend",function(e){return t(oi(),e)}),g=Ih(ir.fromDom(document),"mousedown",i),p=Ih(ir.fromDom(document),"mouseup",function(e){0===e.raw.button&&n(kl(),{target:e.target})});e.on("PostRender",function(){e.on("click",u),e.on("tap",u),e.on("mouseup",a),e.on("ScrollWindow",c),e.on("ResizeWindow",s),e.on("ResizeEditor",l)}),e.on("remove",function(){e.off("click",u),e.off("tap",u),e.off("mouseup",a),e.off("ScrollWindow",c),e.off("ResizeWindow",s),e.off("ResizeEditor",l),g.unbind(),f.unbind(),d.unbind(),m.unbind(),p.unbind()}),e.on("detach",function(){ks(o),ks(r),o.destroy(),r.destroy()})}function zC(e){return(Hn(e,"position").is("fixed")?G.none():Ht(e)).orThunk(function(){var t=ir.fromTag("span");return Vt(e).bind(function(e){Ti(e,t);e=Ht(t);return Di(t),e})})}function jC(e){return zC(e).map(du).getOrThunk(function(){return Tu(0,0)})}function UC(e,t){var n=e.element;kn(n,t.transitionClass),_n(n,t.fadeOutClass),kn(n,t.fadeInClass),t.onShow(e)}function WC(e,t){var n=e.element;kn(n,t.transitionClass),_n(n,t.fadeInClass),kn(n,t.fadeOutClass),t.onHide(e)}function qC(e,t,n){return D(e,function(e){switch(e){case"bottom":return t.bottom<=n.bottom;case"top":return t.y>=n.y}})}function GC(t,e){return e.getInitialPosition().map(function(e){return Cu(e.bounds.x,e.bounds.y,mu(t),su(t))})}function $C(e,t,n){n.setInitialPosition(G.some({style:function(e){var t={},n=e.dom;if(An(n))for(var o=0;o<n.style.length;o++){var r=n.style.item(o);t[r]=n.style[r]}return t}(e),position:Vn(e,"position")||"static",bounds:t}))}function XC(n,o,r){return r.getInitialPosition().bind(function(e){switch(r.setInitialPosition(G.none()),e.position){case"static":return G.some(ZS.static());case"absolute":var t=zC(n).map(Su).getOrThunk(function(){return Su(tu())});return G.some(ZS.absolute(ka("absolute",ho(e.style,"left").map(function(e){return o.x-t.x}),ho(e.style,"top").map(function(e){return o.y-t.y}),ho(e.style,"right").map(function(e){return t.right-o.right}),ho(e.style,"bottom").map(function(e){return t.bottom-o.bottom}))));default:return G.none()}})}function YC(e,t,n){var o,r,i,e=e.element;return Hn(e,"position").is("fixed")?(r=t,GC(o=e,i=n).filter(function(e){return qC(i.getModes(),e,r)}).bind(function(e){return XC(o,e,i)})):function(e,t,n){var o=Su(e);if(qC(n.getModes(),o,t))return G.none();$C(e,o,n);var r=Ou(),e=o.x-r.x,n=t.y-r.y,r=r.bottom-t.bottom,t=o.y<=t.y;return G.some(ZS.fixed(ka("fixed",G.some(e),t?G.some(n):G.none(),G.none(),t?G.none():G.some(r))))}(e,t,n)}function KC(t,e){oe(["left","right","top","bottom","position"],function(e){return jn(t.element,e)}),e.onUndocked(t)}function JC(e,t,n){Oa(e.element,n),("fixed"===n.position?t.onDocked:t.onUndocked)(e)}function QC(o,e,r,i,u){void 0===u&&(u=!1),e.contextual.each(function(n){n.lazyContext(o).each(function(e){var t,t=(t=i,(e=e).y<t.bottom&&e.bottom>t.y);t!==r.isVisible()&&(r.setVisible(t),u&&!t?(Tn(o.element,[n.fadeOutClass]),n.onHide(o)):(t?UC:WC)(o,n))})})}function ZC(t,n,e){var o,r,i=t.element;e.setDocked(!1),o=e,r=t.element,GC(r,o).bind(function(e){return XC(r,e,o)}).each(function(e){e.fold(function(){return KC(t,n)},function(e){return JC(t,n,e)},W)}),e.setVisible(!0),n.contextual.each(function(e){Dn(i,[e.fadeInClass,e.fadeOutClass,e.transitionClass]),e.onShow(t)}),ek(t,n,e)}function eS(e,t,n){n.isDocked()&&ZC(e,t,n)}function tS(o){var r=o.element;Vt(r).each(function(e){var t,n="padding-"+tk.getModes(o)[0];tk.isDocked(o)?(t=mu(e),Fn(r,"width",t+"px"),Fn(e,n,lu(t=r)+(parseInt(Vn(t,"margin-top"),10)||0)+(parseInt(Vn(t,"margin-bottom"),10)||0)+"px")):(jn(r,"width"),jn(e,n))})}function nS(e,t){t?(_n(e,nk.fadeOutClass),Tn(e,[nk.transitionClass,nk.fadeInClass])):(_n(e,nk.fadeInClass),Tn(e,[nk.fadeOutClass,nk.transitionClass]))}function oS(e,t){e=ir.fromDom(e.getContainer()),t?(kn(e,ok),_n(e,rk)):(kn(e,rk),_n(e,ok))}function rS(i,e){function n(t){o().each(function(e){return t(e.element)})}function t(e){i.inline||tS(e),oS(i,tk.isDocked(e)),e.getSystem().broadcastOn([Sl()],{}),o().each(function(e){return e.getSystem().broadcastOn([Sl()],{})})}var u=it(G.none()),o=e.getSink,r=i.inline?[]:[bc.config({channels:((r={})[aC()]={onReceive:tS},r)})];return h([Fd.config({}),tk.config({contextual:A({lazyContext:function(e){var t=lu(e.element),n=i.inline?i.getContentAreaContainer():i.getContainer(),o=Su(ir.fromDom(n)),r=o.height-t,t=o.y+(n="top",ne(tk.getModes(e),n)?0:t);return G.some(Cu(o.x,t,o.width,r))},onShow:function(){n(function(e){return nS(e,!0)})},onShown:function(r){n(function(e){return Dn(e,[nk.transitionClass,nk.fadeInClass])}),u.get().each(function(e){var t,n,o;t=r.element,o=It(n=e),wa(o).filter(function(e){return!dt(n,e)}).filter(function(e){return dt(e,ir.fromDom(o.dom.body))||gt(t,e)}).each(function(){return xa(n)}),u.set(G.none())})},onHide:function(e){var t;u.set((e=e.element,t=o,Ca(e).orThunk(function(){return t().toOptional().bind(function(e){return Ca(e.element)})}))),n(function(e){return nS(e,!1)})},onHidden:function(){n(function(e){return Dn(e,[nk.transitionClass])})}},nk),modes:[e.header.getDockingMode()],onDocked:t,onUndocked:t})],r)}function iS(e){return"<alloy.field."+e+">"}function uS(e){return{element:function(){return e.element.dom}}}function aS(n,o){var r=S(lo(o),function(e){var t=o[e],t=Pe(Fe("sidebar",lk,t));return{name:e,getApi:uS,onSetup:t.onSetup,onShow:t.onShow,onHide:t.onHide}});return S(r,function(e){var t=it(W);return n.slot(e.name,{dom:{tag:"div",classes:["tox-sidebar__pane"]},behaviours:Rg([ip(e,t),up(e,t),Et(fi(),function(t,e){var n=e.event;_(r,function(e){return e.name===n.name}).each(function(e){(n.visible?e.onShow:e.onHide)(e.getApi(t))})})])})})}function cS(e,n){lf.getCurrent(e).each(function(e){return Id.set(e,[(t=n,sk.sketch(function(e){return{dom:{tag:"div",classes:["tox-sidebar__pane-container"]},components:aS(e,t),slotBehaviours:Rg([bi(function(e){return sk.hideAllSlots(e)})])}}))]);var t})}function sS(e){return lf.getCurrent(e).bind(function(e){return rC.isGrowing(e)||rC.hasGrown(e)?lf.getCurrent(e).bind(function(t){return _(sk.getSlotNames(t),function(e){return sk.isShowing(t,e)})}):G.none()})}function lS(e){var t=ir.fromHtml(e),n=zt(t),o=function(e){e=void 0!==e.dom.attributes?e.dom.attributes:[];return O(e,function(e,t){return"class"===t.name?e:A(A({},e),((e={})[t.name]=t.value,e))},{})}(t),e=Array.prototype.slice.call(t.dom.classList,0),n=0===n.length?{}:{innerHtml:Yt(t)};return A({tag:Mt(t),classes:e,attributes:o},n)}function fS(e,t,n){var o=e.element;!0===t?(Id.set(e,[{dom:{tag:"div",attributes:{"aria-label":n.translate("Loading...")},classes:["tox-throbber__busy-spinner"]},components:[{dom:lS('<div class="tox-spinner"><div></div><div></div><div></div></div>')}],behaviours:gc([Rd.config({mode:"special",onTab:function(){return G.some(!0)},onShiftTab:function(){return G.some(!0)}}),Fd.config({})])}]),jn(o,"display"),nn(o,"aria-hidden")):(Id.set(e,[]),Fn(o,"display","none"),Qt(o,"aria-hidden","true"))}function dS(n,t,o){function r(e){e!==i.get()&&(fS(t(),e,o.providers),i.set(e))}var i=it(!1),u=it(G.none());n.on("ProgressState",function(e){var t;u.get().each(nm.clearTimeout),Q(e.time)?(t=nm.setEditorTimeout(n,function(){return r(e.state)},e.time),u.set(G.some(t))):(r(e.state),u.set(G.none()))})}function mS(e){return"string"==typeof e?e.split(" "):e}function gS(r,i){var u=A(A({},gk),i.menus),t=0<lo(i.menus).length,e=void 0===i.menubar||!0===i.menubar?mS("file edit view insert format tools table help"):mS(!1===i.menubar?"":i.menubar),e=C(e,function(e){return t&&i.menus.hasOwnProperty(e)&&i.menus[e].hasOwnProperty("items")||gk.hasOwnProperty(e)}),e=S(e,function(e){var t,n,o,e=u[e];return t={title:e.title,items:mS(e.items)},n=i,o=r.getParam("removed_menuitems","").split(/[ ,]/),{text:t.title,getItems:function(){return T(t.items,function(e){var t=e.toLowerCase();return 0===t.trim().length||b(o,function(e){return e===t})?[]:"separator"===t||"|"===t?[{type:"separator"}]:n.menuItems[t]?[n.menuItems[t]]:[]})}}});return C(e,function(e){return 0<e.getItems().length&&b(e.getItems(),function(e){return"separator"!==e.type})})}function pS(e){function t(){e._skinLoaded=!0,e.fire("SkinLoaded")}return function(){e.initialized?t():e.on("init",t)}}function hS(t,n){return function(){return e={message:n},t.fire("SkinLoadError",e);var e}}function vS(n,o,r){return new km(function(e,t){r.load(o,e,t),n.on("remove",function(){return r.unload(o)})})}function bS(e,t){var n;return(n=ir.fromDom(e.getElement()),Qi(n).isSome())?vS(e,t+"/skin.shadowdom.min.css",Lg.DOM.styleSheetLoader):km.resolve()}function yS(t,e,n,o){var r=e.outerContainer,e=n.toolbar,i=n.buttons;d(e,U)?(e=e.map(function(e){e={toolbar:e,buttons:i,allowToolbarGroups:n.allowToolbarGroups};return WS(t,e,{backstage:o},G.none())}),mk.setToolbars(r,e)):mk.setToolbar(r,WS(t,n,{backstage:o},G.none()))}function xS(n,e){function t(){var e=a.get();e.left===i.innerWidth&&e.top===i.innerHeight||(a.set(Tu(i.innerWidth,i.innerHeight)),Bp(n))}function o(e){return n.fire("ScrollContent",e)}var r=n.dom,i=n.getWin(),u=n.getDoc().documentElement,a=it(Tu(i.innerWidth,i.innerHeight)),c=it(Tu(u.offsetWidth,u.offsetHeight)),u=function(){var e=n.getDoc().documentElement,t=c.get();t.left===e.offsetWidth&&t.top===e.offsetHeight||(c.set(Tu(e.offsetWidth,e.offsetHeight)),Bp(n))};r.bind(i,"resize",t),r.bind(i,"scroll",o);var s=Fh(ir.fromDom(n.getBody()),"load",u),l=e.uiMothership.element;n.on("hide",function(){Fn(l,"display","none")}),n.on("show",function(){jn(l,"display")}),n.on("NodeChange",u),n.on("remove",function(){s.unbind(),r.unbind(i,"resize",t),r.unbind(i,"scroll",o),i=null})}function wS(e){return/^[0-9\.]+(|px)$/i.test(""+e)?G.some(parseInt(""+e,10)):G.none()}function CS(e){return Q(e)?e+"px":e}function SS(t,e,n){return e=e.filter(function(e){return t<e}),n=n.filter(function(e){return e<t}),e.or(n).getOr(t)}function kS(e){var t,n,o,r;return(n=ng(t=e),o=ig(t),r=ag(t),wS(n).map(function(e){return SS(e,o,r)})).getOr(ng(e))}function OS(e){var t=og(e),n=rg(e),o=ug(e);return wS(t).map(function(e){return SS(e,n,o)})}function _S(r,i,e,t,o){function u(){return y.get()&&!r.removed}function a(e){return b?e.fold(function(){return 0},function(e){return 1<e.components().length?su(e.components()[1].element):0}):0}function c(){l.broadcastOn([Sl()],{})}function s(e){var t,n;void 0===e&&(e=!1),u()&&(m||(t=p.getOrThunk(function(){var e=wS(Vn(tu(),"margin-left")).getOr(0);return mu(tu())-du(i).left+e}),Fn(o.get().element,"max-width",t+"px")),b&&mk.refreshToolbar(f),m||(n=mk.getToolbar(f),t=a(n),n=Su(i),t=v()?Math.max(n.y-su(o.get().element)+t,0):n.bottom,Pn(f.element,{position:"absolute",top:Math.round(t)+"px",left:Math.round(n.x)+"px"})),g&&(n=o.get(),e?tk.reset(n):tk.refresh(n)),c())}function n(e){var t,n;void 0===e&&(e=!0),!m&&g&&u()&&(t=h.getDockingMode(),(n=function(e){switch(Xg(r)){case $g.auto:var t=mk.getToolbar(f),n=a(t),o=su(e.element)-n,t=Su(i);if(t.y>o)return"top";n=Pt(i),n=Math.max(n.dom.scrollHeight,su(n));return t.bottom<n-o||Ou().bottom<t.bottom-o?"bottom":"top";case $g.bottom:return"bottom";default:$g.top;return"top"}}(o.get()))!==t&&(function(e){var t=o.get();tk.setModes(t,[e]),h.setDockingMode(e);e=v()?Ha.TopToBottom:Ha.BottomToTop;Qt(t.element,Fc,e)}(n),e&&s(!0)))}var l=e.uiMothership,f=e.outerContainer,d=Lg.DOM,m=Jg(r),g=ep(r),p=ug(r).or(OS(r)),h=t.shared.header,v=h.isPositionedAtTop,b=(t=Gg(r))===fg.sliding||t===fg.floating,y=it(!1);return{isVisible:u,isPositionedAtTop:v,show:function(){y.set(!0),Fn(f.element,"display","flex"),d.addClass(r.getBody(),"mce-edit-focus"),jn(l.element,"display"),n(!1),s()},hide:function(){y.set(!1),e.outerContainer&&(Fn(f.element,"display","none"),d.removeClass(r.getBody(),"mce-edit-focus")),Fn(l.element,"display","none")},update:s,updateMode:n,repositionPopups:c}}function ES(e,t){return e=Su(e),{pos:t?e.y:e.bottom,bounds:e}}function TS(i,u,a,e){function t(e){var t=(o=ES(u,a.isPositionedAtTop())).pos,n=o.bounds,o=(r=c.get()).pos,r=r.bounds,r=n.height!==r.height||n.width!==r.width;c.set({pos:t,bounds:n}),r&&Bp(i,e),a.isVisible()&&(o!==t?a.update(!0):r&&(a.updateMode(),a.repositionPopups()))}var c=it(ES(u,a.isPositionedAtTop()));e||(i.on("activate",a.show),i.on("deactivate",a.hide)),i.on("SkinLoaded ResizeWindow",function(){return a.update(!0)}),i.on("NodeChange keydown",function(e){nm.requestAnimationFrame(function(){return t(e)})}),i.on("ScrollWindow",function(){return a.updateMode()});var n=NC();n.set(Fh(ir.fromDom(i.getBody()),"load",t)),i.on("remove",function(){n.clear()})}function DS(e,t){var n,o,r,i,u,a,c,s;n=k1(0,a=t,kC(r=e)),r.ui.registry.addNestedMenuItem("align",{text:a.shared.providers.translate("Align"),getSubmenuItems:function(){return n.items.validateItems(n.getStyleItems())}}),o=k1(0,i=t,_C(r=e)),r.ui.registry.addNestedMenuItem("fontformats",{text:i.shared.providers.translate("Fonts"),getSubmenuItems:function(){return o.items.validateItems(o.getStyleItems())}}),a=e,i=A({type:"advanced"},(r=t).styleselect),u=k1(0,r,FC(a,i)),a.ui.registry.addNestedMenuItem("formats",{text:"Formats",getSubmenuItems:function(){return u.items.validateItems(u.getStyleItems())}}),c=k1(0,t,IC(a=e)),a.ui.registry.addNestedMenuItem("blockformats",{text:"Blocks",getSubmenuItems:function(){return c.items.validateItems(c.getStyleItems())}}),s=k1(0,t,TC(e=e)),e.ui.registry.addNestedMenuItem("fontsizes",{text:"Font sizes",getSubmenuItems:function(){return s.items.validateItems(s.getStyleItems())}})}function AS(e,t){return function(){e.execCommand("mceToggleFormat",!1,t)}}function BS(e){var t,n;!function(n){My.each([{name:"bold",text:"Bold",icon:"bold"},{name:"italic",text:"Italic",icon:"italic"},{name:"underline",text:"Underline",icon:"underline"},{name:"strikethrough",text:"Strikethrough",icon:"strike-through"},{name:"subscript",text:"Subscript",icon:"subscript"},{name:"superscript",text:"Superscript",icon:"superscript"}],function(e,t){n.ui.registry.addToggleButton(e.name,{tooltip:e.text,icon:e.icon,onSetup:RC(n,e.name),onAction:AS(n,e.name)})});for(var e=1;e<=6;e++){var t="h"+e;n.ui.registry.addToggleButton(t,{text:t.toUpperCase(),tooltip:"Heading "+e,onSetup:RC(n,t),onAction:AS(n,t)})}}(e),t=e,My.each([{name:"cut",text:"Cut",action:"Cut",icon:"cut"},{name:"copy",text:"Copy",action:"Copy",icon:"copy"},{name:"paste",text:"Paste",action:"Paste",icon:"paste"},{name:"help",text:"Help",action:"mceHelp",icon:"help"},{name:"selectall",text:"Select all",action:"SelectAll",icon:"select-all"},{name:"newdocument",text:"New document",action:"mceNewDocument",icon:"new-document"},{name:"removeformat",text:"Clear formatting",action:"RemoveFormat",icon:"remove-formatting"},{name:"remove",text:"Remove",action:"Delete",icon:"remove"}],function(e){t.ui.registry.addButton(e.name,{tooltip:e.text,icon:e.icon,onAction:function(){return t.execCommand(e.action)}})}),n=e,My.each([{name:"blockquote",text:"Blockquote",action:"mceBlockQuote",icon:"quote"}],function(e){n.ui.registry.addToggleButton(e.name,{tooltip:e.text,icon:e.icon,onAction:function(){return n.execCommand(e.action)},onSetup:RC(n,e.name)})})}function NS(e){var t;BS(e),t=e,My.each([{name:"bold",text:"Bold",action:"Bold",icon:"bold",shortcut:"Meta+B"},{name:"italic",text:"Italic",action:"Italic",icon:"italic",shortcut:"Meta+I"},{name:"underline",text:"Underline",action:"Underline",icon:"underline",shortcut:"Meta+U"},{name:"strikethrough",text:"Strikethrough",action:"Strikethrough",icon:"strike-through",shortcut:""},{name:"subscript",text:"Subscript",action:"Subscript",icon:"subscript",shortcut:""},{name:"superscript",text:"Superscript",action:"Superscript",icon:"superscript",shortcut:""},{name:"removeformat",text:"Clear formatting",action:"RemoveFormat",icon:"remove-formatting",shortcut:""},{name:"newdocument",text:"New document",action:"mceNewDocument",icon:"new-document",shortcut:""},{name:"cut",text:"Cut",action:"Cut",icon:"cut",shortcut:"Meta+X"},{name:"copy",text:"Copy",action:"Copy",icon:"copy",shortcut:"Meta+C"},{name:"paste",text:"Paste",action:"Paste",icon:"paste",shortcut:"Meta+V"},{name:"selectall",text:"Select all",action:"SelectAll",icon:"select-all",shortcut:"Meta+A"}],function(e){t.ui.registry.addMenuItem(e.name,{text:e.text,icon:e.icon,shortcut:e.shortcut,onAction:function(){return t.execCommand(e.action)}})}),t.ui.registry.addMenuItem("codeformat",{text:"Code",icon:"sourcecode",onAction:AS(t,"code")})}function RS(e,t,n){function o(){return!!t.undoManager&&t.undoManager[n]()}function r(){e.setDisabled(t.mode.isReadOnly()||!o())}return e.setDisabled(!o()),t.on("Undo Redo AddUndo TypingUndo ClearUndos SwitchMode",r),function(){return t.off("Undo Redo AddUndo TypingUndo ClearUndos SwitchMode",r)}}function MS(e){var t,n;(t=e).ui.registry.addMenuItem("undo",{text:"Undo",icon:"undo",shortcut:"Meta+Z",onSetup:function(e){return RS(e,t,"hasUndo")},onAction:function(){return t.execCommand("undo")}}),t.ui.registry.addMenuItem("redo",{text:"Redo",icon:"redo",shortcut:"Meta+Y",onSetup:function(e){return RS(e,t,"hasRedo")},onAction:function(){return t.execCommand("redo")}}),(n=e).ui.registry.addButton("undo",{tooltip:"Undo",icon:"undo",onSetup:function(e){return RS(e,n,"hasUndo")},onAction:function(){return n.execCommand("undo")}}),n.ui.registry.addButton("redo",{tooltip:"Redo",icon:"redo",onSetup:function(e){return RS(e,n,"hasRedo")},onAction:function(){return n.execCommand("redo")}})}function IS(t,e){function n(e){t.setActive(e.hasVisual)}return t.setActive(e.hasVisual),e.on("VisualAid",n),function(){return e.off("VisualAid",n)}}function FS(e){var t,n;(t=e).ui.registry.addButton("visualaid",{tooltip:"Visual aids",text:"Visual aids",onAction:function(){return t.execCommand("mceToggleVisualAid")}}),(n=e).ui.registry.addToggleMenuItem("visualaid",{text:"Visual aids",onSetup:function(e){return IS(e,n)},onAction:function(){n.execCommand("mceToggleVisualAid")}})}var PS=[{title:"Left",icon:"align-left",format:"alignleft",command:"JustifyLeft"},{title:"Center",icon:"align-center",format:"aligncenter",command:"JustifyCenter"},{title:"Right",icon:"align-right",format:"alignright",command:"JustifyRight"},{title:"Justify",icon:"align-justify",format:"alignjustify",command:"JustifyFull"}],LS=["-apple-system","Segoe UI","Roboto","Helvetica Neue","sans-serif"],VS={"8pt":"1","10pt":"2","12pt":"3","14pt":"4","18pt":"5","24pt":"6","36pt":"7"},HS={"xx-small":"7pt","x-small":"8pt",small:"10pt",medium:"12pt",large:"14pt","x-large":"18pt","xx-large":"24pt"},zS=[{name:"history",items:["undo","redo"]},{name:"styles",items:["styleselect"]},{name:"formatting",items:["bold","italic"]},{name:"alignment",items:["alignleft","aligncenter","alignright","alignjustify"]},{name:"indentation",items:["outdent","indent"]},{name:"permanent pen",items:["permanentpen"]},{name:"comments",items:["addcomment"]}],si=function(o,r){return function(e,t,n){e=o(e).mapError(function(e){return jo(e)}).getOrDie();return r(e,t,n)}},jS={button:si(bm,function(e,t){return t=t.backstage.shared.providers,hC(e,t,[])}),togglebutton:si(ym,function(e,t){return t=t.backstage.shared.providers,vC(e,t,[])}),menubutton:si(a1,function(e,t){return J0(e,"tox-tbtn",t.backstage,G.none())}),splitbutton:si(function(e){return Fe("SplitButton",lC,e)},function(e,t){return m1(e,t.backstage.shared)}),grouptoolbarbutton:si(function(e){return Fe("GroupToolbarButton",cC,e)},function(e,t,n){var o=n.ui.registry.getAll().buttons,r=((r={})[Fc]=t.backstage.shared.header.isPositionedAtTop()?Ha.TopToBottom:Ha.BottomToTop,r);if(Gg(n)!==fg.floating)throw new Error("Toolbar groups are only supported when using floating toolbar mode");return function(t,e,n,o){e=e.shared;return tC.sketch({lazySink:e.getSink,fetch:function(){return Hv(function(e){e(S(n(t.items),t1))})},markers:{toggledClass:"tox-tbtn--enabled"},parts:{button:f1(t.icon,t.text,t.tooltip,G.none(),G.none(),e.providers),toolbar:{dom:{tag:"div",classes:["tox-toolbar__overflow"],attributes:o}}}})}(e,t.backstage,function(e){return WS(n,{buttons:o,toolbar:e,allowToolbarGroups:!1},t,G.none())},r)}),styleSelectButton:function(e,t){return n=e,e=t.backstage,t=A({type:"advanced"},e.styleselect),O1(n,e,FC(n,t));var n},fontsizeSelectButton:function(e,t){return t=t.backstage,O1(e,t,TC(e))},fontSelectButton:function(e,t){return t=t.backstage,O1(e,t,_C(e))},formatButton:function(e,t){return t=t.backstage,O1(e,t,IC(e))},alignMenuButton:function(e,t){return t=t.backstage,O1(e,t,kC(e))}},US={styleselect:jS.styleSelectButton,fontsizeselect:jS.fontsizeSelectButton,fontselect:jS.fontSelectButton,formatselect:jS.formatButton,align:jS.alignMenuButton},WS=function(n,o,r,i){var e=PC(o),e=S(e,function(e){var t=T(e.items,function(e){return 0===e.trim().length?[]:LC(n,o.buttons,e,o.allowToolbarGroups,r,i).toArray()});return{title:G.from(n.translate(e.name)),items:t}});return C(e,function(e){return 0<e.items.length})},qS={valignCentre:[],alignCentre:[],alignLeft:["tox-pop--align-left"],alignRight:["tox-pop--align-right"],right:["tox-pop--right"],left:["tox-pop--left"],bottom:["tox-pop--bottom"],top:["tox-pop--top"]},GS={maxHeightFunction:Oc(),maxWidthFunction:Q1()},$S={onLtr:function(){return[lc,fc,ia,oa,ua,ra,em,tm,Od,Sd,_d,kd]},onRtl:function(){return[lc,fc,ua,ra,ia,oa,em,tm,_d,kd,Od,Sd]}},XS={onLtr:function(){return[fc,oa,ra,ia,ua,lc,em,tm,Od,Sd,_d,kd]},onRtl:function(){return[fc,ra,oa,ua,ia,lc,em,tm,_d,kd,Od,Sd]}},YS=$a,qo=tc,Ri=q([Ze("shell",!1),ze("makeItem"),Ze("setupItem",W),Tl("listBehaviours",[Id])]),Xa=Pl({name:"items",overrides:function(){return{behaviours:gc([Id.config({})])}}}),si=q([Xa]),KS=yc({name:q("CustomList")(),configFields:Ri(),partFields:si(),factory:function(u,e,t,n){var e=u.shell?{behaviours:[Id.config({})],components:[]}:{behaviours:[],components:e},o=function(e){return u.shell?G.some(e):Gs(e,u,"items")};return{uid:u.uid,dom:u.dom,components:e.components,behaviours:Rs(u.listBehaviours,e.behaviours),apis:{setItems:function(r,i){o(r).fold(function(){throw console.error("Custom List was defined to not be a shell, but no item container was specified in components"),new Error("Custom List was defined to not be a shell, but no item container was specified in components")},function(t){var e=Id.contents(t),n=i.length,o=n-e.length,o=0<o?y(o,function(){return u.makeItem()}):[],n=e.slice(n);oe(n,function(e){return Id.remove(t,e)}),oe(o,function(e){return Id.append(t,e)});o=Id.contents(t);oe(o,function(e,t){u.setupItem(r,e,i[t],t)})})}}}},apis:{setItems:function(e,t,n){e.setItems(t,n)}}}),$a=W,tc=c,JS=q([]),QS=Object.freeze({__proto__:null,setup:$a,isDocked:tc,getBehaviours:JS}),ZS=bo([{static:[]},{absolute:["positionCss"]},{fixed:["positionCss"]}]),ek=function(e,t,n){var o,r,i,u,a;e.getSystem().isConnected()&&(o=e,i=n,u=(r=t).lazyViewport(o),(a=i.isDocked())&&QC(o,r,i,u),YC(o,u,i).each(function(e){i.setDocked(!a),e.fold(function(){return KC(o,r)},function(e){return JC(o,r,e)},function(e){QC(o,r,i,u,!0),JC(o,r,e)})}))},Xa=Object.freeze({__proto__:null,refresh:ek,reset:eS,isDocked:function(e,t,n){return n.isDocked()},getModes:function(e,t,n){return n.getModes()},setModes:function(e,t,n,o){return n.setModes(o)}}),Ri=Object.freeze({__proto__:null,events:function(o,r){return vi([Rt(zr(),function(t,n){o.contextual.each(function(e){En(t.element,e.transitionClass)&&(Dn(t.element,[e.transitionClass,e.fadeInClass]),(r.isVisible()?e.onShown:e.onHidden)(t)),n.stop()})}),Et(ri(),function(e,t){ek(e,o,r)}),Et(ii(),function(e,t){eS(e,o,r)})])}}),si=[Qe("contextual",[Ue("fadeInClass"),Ue("fadeOutClass"),Ue("transitionClass"),Qo("lazyContext"),Ka("onShow"),Ka("onShown"),Ka("onHide"),Ka("onHidden")]),nt("lazyViewport",Ou),or("modes",["top","bottom"],$o),Ka("onDocked"),Ka("onUndocked")],tk=ya({fields:si,name:"docking",active:Ri,apis:Xa,state:Object.freeze({__proto__:null,init:function(e){var t=it(!1),n=it(!0),o=it(G.none()),r=it(e.modes);return qi({isDocked:t.get,setDocked:t.set,getInitialPosition:o.get,setInitialPosition:o.set,isVisible:n.get,setVisible:n.set,getModes:r.get,setModes:r.set,readState:function(){return"docked:  "+t.get()+", visible: "+n.get()+", modes: "+r.get().join(",")}})}})}),nk={fadeInClass:"tox-editor-dock-fadein",fadeOutClass:"tox-editor-dock-fadeout",transitionClass:"tox-editor-dock-transition"},ok="tox-tinymce--toolbar-sticky-on",rk="tox-tinymce--toolbar-sticky-off",ik=Object.freeze({__proto__:null,setup:function(e,t,n){e.inline||(t.header.isPositionedAtTop()||e.on("ResizeEditor",function(){n().each(tk.reset)}),e.on("ResizeWindow ResizeEditor",function(){n().each(tS)}),e.on("SkinLoaded",function(){n().each(function(e){tk.isDocked(e)?tk.reset(e):tk.refresh(e)})}),e.on("FullscreenStateChanged",function(){n().each(tk.reset)})),e.on("AfterScrollIntoView",function(f){n().each(function(e){tk.refresh(e);var t,n,o,r,i,u,a,c,s,l=e.element;Rf(l)&&(t=f,o=It(n=l),r=o.dom.defaultView.innerHeight,i=vu(o),u=ir.fromDom(t.elm),a=ku(u),c=su(u),s=a.y,e=s+c,l=du(n),t=su(n),u=l.top,a=u+t,n=Math.abs(u-i.top)<2,l=Math.abs(a-(i.top+r))<2,n&&s<a?bu(i.left,s-t,o):l&&u<e&&bu(i.left,s-r+c+t,o))})}),e.on("PostRender",function(){oS(e,!1)})},isDocked:function(e){return e().map(tk.isDocked).getOr(!1)},getBehaviours:rS}),uk=zl({factory:function(t,n){var e={focus:Rd.focusIn,setMenus:function(e,t){t=S(t,function(t){var e={type:"menubutton",text:t.text,fetch:function(e){e(t.getItems())}},e=a1(e).mapError(function(e){return jo(e)}).getOrDie();return J0(e,"tox-mbtn",n.backstage,G.some("menuitem"))});Id.set(e,t)}};return{uid:t.uid,dom:t.dom,components:[],behaviours:gc([Id.config({}),id("menubar-events",[bi(function(e){t.onSetup(e)}),Et(Rr(),function(n,e){Vu(n.element,".tox-mbtn--active").each(function(t){Hu(e.event.target,".tox-mbtn").each(function(e){dt(t,e)||n.getSystem().getByDom(t).each(function(t){n.getSystem().getByDom(e).each(function(e){dy.expand(e),dy.close(t),Fd.focus(e)})})})})}),Et(li(),function(n,e){e.event.prevFocus.bind(function(e){return n.getSystem().getByDom(e).toOptional()}).each(function(t){e.event.newFocus.bind(function(e){return n.getSystem().getByDom(e).toOptional()}).each(function(e){dy.isOpen(t)&&(dy.expand(e),dy.close(t))})})})]),Rd.config({mode:"flow",selector:".tox-mbtn",onEscape:function(e){return t.onEscape(e),G.some(!0)}}),pv.config({})]),apis:e,domModification:{attributes:{role:"menubar"}}}},name:"silver.Menubar",configFields:[ze("dom"),ze("uid"),ze("onEscape"),ze("backstage"),Ze("onSetup",W)],apis:{focus:function(e,t){e.focus(t)},setMenus:function(e,t,n){e.setMenus(t,n)}}}),ak=[Wr("slotBehaviours",[])],ck=function(r,e){function t(e){return Ks(r)}function o(e,t){return"true"!==Zt(e.element,"aria-hidden")}var n,i=function(n,o){return function(e,t){return Gs(e,r,t).map(function(e){return n(e,t)}).getOr(o)}},u=i(o,!1),a=i(function(e,t){var n;o(e)&&(n=e.element,Fn(n,"display","none"),Qt(n,"aria-hidden","true"),wt(e,fi(),{name:t,visible:!1}))}),c=(n=a,function(t,e){oe(e,function(e){return n(t,e)})}),i=i(function(e,t){var n;o(e)||(n=e.element,jn(n,"display"),nn(n,"aria-hidden"),wt(e,fi(),{name:t,visible:!0}))});return{uid:r.uid,dom:r.dom,components:e,behaviours:r.slotBehaviours.dump,apis:{getSlotNames:t,getSlot:function(e,t){return Gs(e,r,t)},isShowing:u,hideSlot:a,hideAllSlots:function(e){return c(e,t())},showSlot:i}}},$a=de({getSlotNames:function(e,t){return e.getSlotNames(t)},getSlot:function(e,t,n){return e.getSlot(t,n)},isShowing:function(e,t,n){return e.isShowing(t,n)},hideSlot:function(e,t,n){return e.hideSlot(t,n)},hideAllSlots:function(e,t){return e.hideAllSlots(t)},showSlot:function(e,t,n){return e.showSlot(t,n)}},ln),sk=A(A({},$a),{sketch:function(e){var n,t=(n=[],{slot:function(e,t){return n.push(e),zs("container",iS(e),t)},record:function(){return n}}),e=e(t),t=t.record(),t=S(t,function(e){return Fl({name:e,pname:iS(e)})});return tl("container",ak,t,ck,e)}}),lk=No([Je("icon"),Je("tooltip"),nt("onShow",W),nt("onHide",W),nt("onSetup",function(){return W})]),fk=un("FixSizeEvent"),dk=un("AutoSizeEvent"),tc=qo.optional({factory:uk,name:"menubar",schema:[ze("backstage")]}),or=qo.optional({factory:{sketch:function(e){return KS.sketch({uid:e.uid,dom:e.dom,listBehaviours:gc([Rd.config({mode:"acyclic",selector:".tox-toolbar"})]),makeItem:function(){return u1({type:e.type,uid:un("multiple-toolbar-item"),cyclicKeying:!1,initGroups:[],providers:e.providers,onEscape:function(){return e.onEscape(),G.some(!0)}})},setupItem:function(e,t,n,o){eC.setGroups(t,n)},shell:!0})}},name:"multiple-toolbar",schema:[ze("dom"),ze("onEscape")]}),si=qo.optional({factory:{sketch:function(e){var t;return((t=e).type===fg.sliding?i1:t.type===fg.floating?r1:u1)({type:e.type,uid:e.uid,onEscape:function(){return e.onEscape(),G.some(!0)},cyclicKeying:!1,initGroups:[],getSink:e.getSink,providers:e.providers,moreDrawerData:{lazyToolbar:e.lazyToolbar,lazyMoreButton:e.lazyMoreButton,lazyHeader:e.lazyHeader},attributes:e.attributes})}},name:"toolbar",schema:[ze("dom"),ze("onEscape"),ze("getSink")]}),Ri=qo.optional({factory:{sketch:function(e){var t=e.editor,n=e.sticky?rS:JS;return{uid:e.uid,dom:e.dom,components:e.components,behaviours:gc(n(t,e.sharedBackstage))}}},name:"header",schema:[ze("dom")]}),Xa=qo.optional({name:"socket",schema:[ze("dom")]}),$a=qo.optional({factory:{sketch:function(e){return{uid:e.uid,dom:{tag:"div",classes:["tox-sidebar"],attributes:{role:"complementary"}},components:[{dom:{tag:"div",classes:["tox-sidebar__slider"]},components:[],behaviours:gc([pv.config({}),Fd.config({}),rC.config({dimension:{property:"width"},closedClass:"tox-sidebar--sliding-closed",openClass:"tox-sidebar--sliding-open",shrinkingClass:"tox-sidebar--sliding-shrinking",growingClass:"tox-sidebar--sliding-growing",onShrunk:function(e){lf.getCurrent(e).each(sk.hideAllSlots),xt(e,dk)},onGrown:function(e){xt(e,dk)},onStartGrow:function(e){wt(e,fk,{width:Hn(e.element,"width").getOr("")})},onStartShrink:function(e){wt(e,fk,{width:mu(e.element)+"px"})}}),Id.config({}),lf.config({find:function(e){e=Id.contents(e);return re(e)}})])}],behaviours:gc([By(0),id("sidebar-sliding-events",[Et(fk,function(e,t){Fn(e.element,"width",t.event.width)}),Et(dk,function(e,t){jn(e.element,"width")})])])}}},name:"sidebar",schema:[ze("dom")]}),qo=qo.optional({factory:{sketch:function(e){return{uid:e.uid,dom:{tag:"div",attributes:{"aria-hidden":"true"},classes:["tox-throbber"],styles:{display:"none"}},behaviours:gc([Id.config({})]),components:[]}}},name:"throbber",schema:[ze("dom")]}),mk=yc({name:"OuterContainer",factory:function(n,e,t){return{uid:n.uid,dom:n.dom,components:e,apis:{getSocket:function(e){return YS.getPart(e,n,"socket")},setSidebar:function(e,t){YS.getPart(e,n,"sidebar").each(function(e){return cS(e,t)})},toggleSidebar:function(e,t){YS.getPart(e,n,"sidebar").each(function(e){var n;n=t,lf.getCurrent(e).each(function(t){lf.getCurrent(t).each(function(e){rC.hasGrown(t)?sk.isShowing(e,n)?rC.shrink(t):(sk.hideAllSlots(e),sk.showSlot(e,n)):(sk.hideAllSlots(e),sk.showSlot(e,n),rC.grow(t))})})})},whichSidebar:function(e){return YS.getPart(e,n,"sidebar").bind(sS).getOrNull()},getHeader:function(e){return YS.getPart(e,n,"header")},getToolbar:function(e){return YS.getPart(e,n,"toolbar")},setToolbar:function(e,t){YS.getPart(e,n,"toolbar").each(function(e){e.getApis().setGroups(e,t)})},setToolbars:function(e,t){YS.getPart(e,n,"multiple-toolbar").each(function(e){KS.setItems(e,t)})},refreshToolbar:function(e){YS.getPart(e,n,"toolbar").each(function(e){return e.getApis().refresh(e)})},toggleToolbarDrawer:function(e){YS.getPart(e,n,"toolbar").each(function(t){var e,n;e=t.getApis().toggle,n=function(e){return e(t)},null!=e?G.some(n(e)):G.none()})},isToolbarDrawerToggled:function(e){return YS.getPart(e,n,"toolbar").bind(function(t){return G.from(t.getApis().isOpen).map(function(e){return e(t)})}).getOr(!1)},getThrobber:function(e){return YS.getPart(e,n,"throbber")},focusToolbar:function(e){YS.getPart(e,n,"toolbar").orThunk(function(){return YS.getPart(e,n,"multiple-toolbar")}).each(function(e){Rd.focusIn(e)})},setMenubar:function(e,t){YS.getPart(e,n,"menubar").each(function(e){uk.setMenus(e,t)})},focusMenubar:function(e){YS.getPart(e,n,"menubar").each(function(e){uk.focus(e)})}},behaviours:n.behaviours}},configFields:[ze("dom"),ze("behaviours")],partFields:[Ri,tc,si,or,Xa,$a,qo],apis:{getSocket:function(e,t){return e.getSocket(t)},setSidebar:function(e,t,n){e.setSidebar(t,n)},toggleSidebar:function(e,t,n){e.toggleSidebar(t,n)},whichSidebar:function(e,t){return e.whichSidebar(t)},getHeader:function(e,t){return e.getHeader(t)},getToolbar:function(e,t){return e.getToolbar(t)},setToolbar:function(e,t,n){n=S(n,t1);e.setToolbar(t,n)},setToolbars:function(e,t,n){n=S(n,function(e){return S(e,t1)});e.setToolbars(t,n)},refreshToolbar:function(e,t){return e.refreshToolbar(t)},toggleToolbarDrawer:function(e,t){e.toggleToolbarDrawer(t)},isToolbarDrawerToggled:function(e,t){return e.isToolbarDrawerToggled(t)},getThrobber:function(e,t){return e.getThrobber(t)},setMenubar:function(e,t,n){e.setMenubar(t,n)},focusMenubar:function(e,t){e.focusMenubar(t)},focusToolbar:function(e,t){e.focusToolbar(t)}}}),gk={file:{title:"File",items:"newdocument restoredraft | preview | export print | deleteallconversations"},edit:{title:"Edit",items:"undo redo | cut copy paste pastetext | selectall | searchreplace"},view:{title:"View",items:"code | visualaid visualchars visualblocks | spellchecker | preview fullscreen | showcomments"},insert:{title:"Insert",items:"image link media addcomment pageembed template codesample inserttable | charmap emoticons hr | pagebreak nonbreaking anchor toc | insertdatetime"},format:{title:"Format",items:"bold italic underline strikethrough superscript subscript codeformat | formats blockformats fontformats fontsizes align lineheight | forecolor backcolor | removeformat"},tools:{title:"Tools",items:"spellchecker spellcheckerlanguage | a11ycheck code wordcount"},table:{title:"Table",items:"inserttable | cell row column | advtablesort | tableprops deletetable"},help:{title:"Help",items:"help"}},tc=function(e,t){var n,o,r,r=(o=(n=t).getParam("skin"),r=n.getParam("skin_url"),!1!==o&&(o=o||"oxide",r=r?n.documentBaseURI.toAbsolute(r):Wg.baseURL+"/skins/ui/"+o),r);r&&t.contentCSS.push(r+(e?"/content.inline":"/content")+".min.css"),!1===t.getParam("skin")==!1&&U(r)?km.all([vS(t,r+"/skin.min.css",t.ui.styleSheetLoader),bS(t,r)]).then(pS(t),hS(t,"Skin could not be loaded")):pS(t)()},pk=m(tc,!1),hk=m(tc,!0),si=Cr(),vk=si.os.isiOS()&&si.os.version.major<=12,bk=Object.freeze({__proto__:null,render:function(n,t,e,o,r){var i=it(0),u=t.outerContainer;pk(n);var a=ir.fromDom(r.targetNode),c=Nn(Ji(a));r=t.mothership,vl(a,r,Wt),Ss(c,t.uiMothership),n.on("PostRender",function(){yS(n,t,e,o),i.set(n.getWin().innerWidth),mk.setMenubar(u,gS(n,e)),mk.setSidebar(u,e.sidebar),xS(n,t)});var s,l,f,c=mk.getSocket(u).getOrDie("Could not find expected socket element");vk&&(Pn(c.element,{overflow:"scroll","-webkit-overflow-scrolling":"touch"}),s=function(){n.fire("ScrollContent")},l=20,f=null,d={cancel:function(){null!==f&&(clearTimeout(f),f=null)},throttle:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];null===f&&(f=setTimeout(function(){s.apply(null,e),f=null},l))}},d=Ih(c.element,"scroll",d.throttle),n.on("remove",d.unbind)),np(n,t),n.addCommand("ToggleSidebar",function(e,t){mk.toggleSidebar(u,t),n.fire("ToggleSidebar")}),n.addQueryValueHandler("ToggleSidebar",function(){return mk.whichSidebar(u)});var d=Gg(n);return d!==fg.sliding&&d!==fg.floating||n.on("ResizeWindow ResizeEditor ResizeContent",function(){var e=n.getWin().innerWidth;e!==i.get()&&(mk.refreshToolbar(t.outerContainer),i.set(e))}),{iframeContainer:c.element.dom,editorContainer:u.element.dom,api:{enable:function(){tp(t,!1)},disable:function(){tp(t,!0)},isDisabled:function(){return Ug.isDisabled(u)}}}}}),yk=Object.freeze({__proto__:null,render:function(t,n,o,r,e){var i=n.mothership,u=n.uiMothership,a=n.outerContainer,c=it(null),s=ir.fromDom(e.targetNode),l=_S(t,s,n,r,c),f=t.getParam("toolbar_persist",!1,"boolean");hk(t);function d(){var e;c.get()?l.show():(c.set(mk.getHeader(a).getOrDie()),e=Qg(t),Ss(e,i),Ss(e,u),yS(t,n,o,r),mk.setMenubar(a,gS(t,o)),l.show(),TS(t,s,l,f),t.nodeChanged())}return t.on("show",d),t.on("hide",l.hide),f||(t.on("focus",d),t.on("blur",l.hide)),t.on("init",function(){(t.hasFocus()||f)&&d()}),np(t,n),{editorContainer:a.element.dom,api:{show:function(){l.show()},hide:function(){l.hide()},enable:function(){tp(n,!1)},disable:function(){tp(n,!0)},isDisabled:function(){return Ug.isDisabled(a)}}}}}),xk={unsupportedLength:["em","ex","cap","ch","ic","rem","lh","rlh","vw","vh","vi","vb","vmin","vmax","cm","mm","Q","in","pc","pt","px"],fixed:["px","pt"],relative:["%"],empty:[""]},wk=(Xa=["Infinity",(or="[0-9]+")+"\\."+Ck(or)+Ck(Xa="[eE][+-]?[0-9]+"),"\\."+or+Ck(Xa),or+Ck(Xa)].join("|"),new RegExp("^("+("[+-]?(?:"+Xa+")")+")(.*)$"));function Ck(e){return"(?:"+e+")?"}function Sk(e,o){return G.from(wk.exec(e)).bind(function(e){var t,n=Number(e[1]),e=e[2];return t=e,b(o,function(e){return b(xk[e],function(e){return t===e})})?G.some({value:n,unit:e}):G.none()})}function kk(e){return Sk(e,["fixed","relative","empty"]).map(function(e){return e.value+e.unit}).getOr(e)}function Ok(o){function r(){var e=kk(o.queryCommandValue("LineHeight"));G.from(u.get(e)).fold(function(){return a.clear()},function(e){a.set({destroy:function(){e.setActive(!1)}}),e.setActive(!0)})}var i=o.getParam("lineheight_formats","1 1.1 1.2 1.3 1.4 1.5 2","string").split(" "),u=new Map,a=BC();return o.on("nodeChange",r),S(i,function(t,n){return{type:"togglemenuitem",text:t,onSetup:function(e){return u.set(kk(t),e),n+1===i.length&&r(),function(){0===n&&(o.off("nodeChange",r),a.clear())}},onAction:function(){return o.execCommand("LineHeight",!1,t)}}})}function _k(e){var t,n;(t=e).ui.registry.addNestedMenuItem("lineheight",{type:"nestedmenuitem",text:"Line height",getSubmenuItems:function(){return Ok(t)}}),(n=e).ui.registry.addMenuButton("lineheight",{tooltip:"Line height",icon:"line-height",fetch:function(e){return e(Ok(n))}})}function Ek(e,t){var n;!function(t){My.each([{name:"alignleft",text:"Align left",cmd:"JustifyLeft",icon:"align-left"},{name:"aligncenter",text:"Align center",cmd:"JustifyCenter",icon:"align-center"},{name:"alignright",text:"Align right",cmd:"JustifyRight",icon:"align-right"},{name:"alignjustify",text:"Justify",cmd:"JustifyFull",icon:"align-justify"}],function(e){t.ui.registry.addToggleButton(e.name,{tooltip:e.text,onAction:function(){return t.execCommand(e.cmd)},icon:e.icon,onSetup:RC(t,e.name)})});var e="alignnone",n="No alignment",o="JustifyNone",r="align-none";t.ui.registry.addButton(e,{tooltip:n,onAction:function(){return t.execCommand(o)},icon:r})}(e),NS(e),DS(e,t),MS(e),function(e){oh(e);var t=it(null),n=it(null);sh(e,"forecolor","forecolor","Text color",t),sh(e,"backcolor","hilitecolor","Background color",n),lh(e,"forecolor","forecolor","Text color"),lh(e,"backcolor","hilitecolor","Background color")}(e),FS(e),(n=e).ui.registry.addButton("outdent",{tooltip:"Decrease indent",icon:"outdent",onSetup:function(e){return function(e,t){e.setDisabled(!t.queryCommandState("outdent"));function n(){e.setDisabled(!t.queryCommandState("outdent"))}return t.on("NodeChange",n),function(){return t.off("NodeChange",n)}}(e,n)},onAction:function(){return n.execCommand("outdent")}}),n.ui.registry.addButton("indent",{tooltip:"Increase indent",icon:"indent",onAction:function(){return n.execCommand("indent")}}),_k(e)}function Tk(e,t){return{anchor:"makeshift",x:e,y:t}}function Dk(e){return"longpress"===e.type||0===e.type.indexOf("touch")}function Ak(e,t){var n=Lg.DOM.getPos(e);return e=n.x,n=n.y,Tk(t.x+e,t.y+n)}function Bk(e,t){return"contextmenu"===t.type||"longpress"===t.type?e.inline?function(e){if(Dk(e)){var t=e.touches[0];return Tk(t.pageX,t.pageY)}return Tk(e.pageX,e.pageY)}(t):Ak(e.getContentAreaContainer(),function(e){if(Dk(e)){var t=e.touches[0];return Tk(t.clientX,t.clientY)}return Tk(e.clientX,e.clientY)}(t)):yO(e)}function Nk(e){return{anchor:"node",node:G.some(ir.fromDom(e.selection.getNode())),root:ir.fromDom(e.getBody())}}function Rk(e,t,n,o,r,i){var n=n(),u=i?Nk(e):Bk(e,t);Y0(n,dg.CLOSE_ON_EXECUTE,o,!1).map(function(e){t.preventDefault(),Zd.showMenuAt(r,u,{menu:{markers:Pm("normal")},data:e})})}function Mk(e){function t(){nm.setEditorTimeout(e,function(){e.selection.setRng(n)},10),i()}var n=e.selection.getRng();function o(e){e.preventDefault(),e.stopImmediatePropagation()}function r(){return i()}e.once("touchend",t),e.on("mousedown",o,!0),e.once("longpresscancel",r);var i=function(){e.off("touchend",t),e.off("longpresscancel",r),e.off("mousedown",o)}}function Ik(t,n,e,o,r,i,u){var a,c=i?Nk(t):(a=t,i=n,A({bubble:Pa(0,12,wO),layouts:xO,overrides:{maxWidthFunction:Q1(),maxHeightFunction:Oc()}},Bk(a,i)));Y0(e,dg.CLOSE_ON_EXECUTE,o,!0).map(function(e){n.preventDefault(),Zd.showMenuWithinBounds(r,c,{menu:{markers:Pm("normal"),highlightImmediately:u},data:e,type:"horizontal"},function(){return G.some(v1(t,o.shared))}),t.fire(Z1)})}function Fk(t,n,o,r,i,u){function e(){var e=o();Ik(t,n,e,r,i,u,!(f||s||l&&d))}var a,c=Cr(),s=c.os.isiOS(),l=c.os.isOSX(),f=c.os.isAndroid(),d=c.deviceType.isTouch();!l&&!s||u?(f&&!u&&t.selection.setCursorLocation(n.target,0),e()):(a=function(){Mk(t),e()},!function(e,t){var n=e.selection;if(n.isCollapsed()||t.touches.length<1)return!1;var o=t.touches[0],n=n.getRng();return Yc(e.getWin(),Hc.domRange(n)).exists(function(e){return e.left<=o.clientX&&e.right>=o.clientX&&e.top<=o.clientY&&e.bottom>=o.clientY})}(t,n)?(t.once("selectionchange",a),t.once("touchend",function(){return t.off("selectionchange",a)})):a())}function Pk(e){return"string"==typeof e?e.split(/[ ,]/):e}function Lk(e){return e.getParam("contextmenu_never_use_native",!1,"boolean")}function Vk(e){return t="contextmenu",n="link linkchecker image imagetools table spellchecker configurepermanentpen",o=(e=e).ui.registry.getAll().contextMenus,G.from(e.getParam(t)).map(Pk).getOrThunk(function(){return C(Pk(n),function(e){return vo(o,e)})});var t,n,o}function Hk(e){return U(e)?"|"===e:"separator"===e.type}function zk(e,t){if(0===t.length)return e;var n=F(e).filter(function(e){return!Hk(e)}).fold(function(){return[]},function(e){return[CO]});return e.concat(n).concat(t).concat([CO])}function jk(e,t){return"longpress"!==t.type&&(2!==t.button||t.target===e.getBody()&&""===t.pointerType)}function Uk(e,t){return jk(e,t)?e.selection.getStart(!0):t.target}function Wk(r,e,t){function n(e){return Zd.hide(u)}function o(o){var e;Lk(r)&&o.preventDefault(),e=r,o.ctrlKey&&!Lk(e)||!1===r.getParam("contextmenu")||(e=function(e,t){var n=e.getParam("contextmenu_avoid_overlap","","string");if(jk(e,t))return!0;if(n){t=Uk(e,t);return Ph(ir.fromDom(t),n)}return!1}(r,o),(i()?Fk:Rk)(r,o,function(){var e=Uk(r,o),t=r.ui.registry.getAll(),n=Vk(r);return function(o,e,r){e=O(e,function(e,t){if(vo(o,t)){var n=o[t].update(r);if(U(n))return zk(e,n.split(" "));if(0<n.length){n=S(n,SO);return zk(e,n)}return e}return e.concat([t])},[]);return 0<e.length&&Hk(e[e.length-1])&&e.pop(),e}(t.contextMenus,n,e)},t,u,e))}var i=Cr().deviceType.isTouch,u=uu(Zd.sketch({dom:{tag:"div"},lazySink:e,onEscape:function(){return r.focus()},onShow:function(){return t.setContextMenuState(!0)},onHide:function(){return t.setContextMenuState(!1)},fireDismissalEventInstead:{},inlineBehaviours:gc([id("dismissContextMenu",[Et(ci(),function(e,t){wl.close(e),r.focus()})])])}));r.on("init",function(){var e="ResizeEditor ScrollContent ScrollWindow longpresscancel"+(i()?"":" ResizeWindow");r.on(e,n),r.on("longpress contextmenu",o)})}function qk(t){return function(e){return e.translate(-t.left,-t.top)}}function Gk(t){return function(e){return e.translate(t.left,t.top)}}function $k(n){return function(e,t){return O(n,function(e,t){return t(e)},Tu(e,t))}}function Xk(e,t,n){return e.fold($k([Gk(n),qk(t)]),$k([qk(t)]),$k([]))}function Yk(e,t,n){return e.fold($k([Gk(n)]),$k([]),$k([Gk(t)]))}function Kk(e,t,n){return e.fold($k([]),$k([qk(n)]),$k([Gk(t),qk(n)]))}function Jk(e,t,n){return e=e.fold(function(e,t){return{position:G.some("absolute"),left:G.some(e+"px"),top:G.some(t+"px")}},function(e,t){return{position:G.some("absolute"),left:G.some(e-n.left+"px"),top:G.some(t-n.top+"px")}},function(e,t){return{position:G.some("fixed"),left:G.some(e+"px"),top:G.some(t+"px")}}),A({right:G.none(),bottom:G.none()},e)}function Qk(e,i,u,a){function t(o,r){return function(e,t){var n=o(i,u,a);return r(e.getOr(n.left),t.getOr(n.top))}}return e.fold(t(Kk,kO),t(Yk,OO),t(Xk,_O))}function Zk(e,t){return t=Zt(e,t),K(t)?NaN:parseInt(t,10)}function eO(e,t,n,o){return r=t,e=(t=e).element,t=Zk(e,r.leftAttr),r=Zk(e,r.topAttr),(isNaN(t)||isNaN(r)?G.none():G.some(Tu(t,r))).fold(function(){return n},function(e){return _O(e.left+o.left,e.top+o.top)});var r}function tO(e,t,n,o,r,i){var n=eO(e,t,n,o),o=(t.mustSnap?EO:TO)(e,t,n,r,i),u=Xk(n,r,i);return function(e,t,n){e=e.element;Qt(e,t.leftAttr,n.left+"px"),Qt(e,t.topAttr,n.top+"px")}(e,t,u),o.fold(function(){return{coord:_O(u.left,u.top),extra:G.none()}},function(e){return{coord:e.output,extra:e.extra}})}function nO(e,t){!function(e,t){e=e.element;nn(e,t.leftAttr),nn(e,t.topAttr)}(e,t)}function oO(e,n,o,r){return P(e,function(e){var t=e.sensor;return function(e,t,n,o,r,i){e=Yk(e,r,i),i=Yk(t,r,i);return Math.abs(e.left-i.left)<=n&&Math.abs(e.top-i.top)<=o}(n,t,e.range.left,e.range.top,o,r)?G.some({output:Qk(e.output,n,o,r),extra:e.extra}):G.none()})}function rO(e,t){var n;e.getSystem().addToGui(t),Vt((n=t).element).filter(Si).each(function(t){Hn(t,"z-index").each(function(e){Qt(t,DO,e)}),Fn(t,"z-index",Vn(n.element,"z-index"))})}function iO(e){Vt(e.element).filter(Si).each(function(t){en(t,DO).fold(function(){return jn(t,"z-index")},function(e){return Fn(t,"z-index",e)}),nn(t,DO)}),e.getSystem().removeFromGui(e)}function uO(e,t,n){return e.getSystem().build(mv.sketch({dom:{styles:{left:"0px",top:"0px",width:"100%",height:"100%",position:"fixed","z-index":"1000000000000000"},classes:[t]},events:n}))}function aO(t){return e=Hn(t,"left"),n=Hn(t,"top"),o=Hn(t,"position"),r=function(e,t,n){return("fixed"===n?_O:kO)(parseInt(e,10),parseInt(t,10))},(e.isSome()&&n.isSome()&&o.isSome()?G.some(r(e.getOrDie(),n.getOrDie(),o.getOrDie())):G.none()).getOrThunk(function(){var e=du(t);return OO(e.left,e.top)});var e,n,o,r}function cO(n,e,r,i,u,a,t){var o,c,s,l,f,d=e.fold(function(){var n,o,e=(n=a.left,o=a.top,r.fold(function(e,t){return kO(e+n,t+o)},function(e,t){return OO(e+n,t+o)},function(e,t){return _O(e+n,t+o)})),e=Xk(e,i,u);return _O(e.left,e.top)},function(t){var e=tO(n,t,r,a,i,u);return e.extra.each(function(e){t.onSensor(n,e)}),e.coord});return o=d,c=i,s=u,e=(l=t).bounds,d=Yk(o,c,s),t=Da(d.left,e.x,e.x+e.width-l.width),l=Da(d.top,e.y,e.y+e.height-l.height),f=OO(t,l),o.fold(function(){var e=Kk(f,c,s);return kO(e.left,e.top)},function(){return f},function(){var e=Xk(f,c,s);return _O(e.left,e.top)})}function sO(e,t){return{bounds:e.getBounds(),height:lu(t.element),width:gu(t.element)}}function lO(c,s,e,t,n){var n=e.update(t,n),l=e.getStartData().getOrThunk(function(){return sO(s,c)});n.each(function(e){var t,n,o,r,i,u,a;t=c,o=l,r=e,a=(n=s).getTarget(t.element),n.repositionTarget&&(u=It(t.element),i=vu(u),e=jC(a),u=aO(a),o=cO(t,n.snaps,u,i,e,r,o),e=Jk(o,0,e),Ln(a,e)),n.onDrag(t,a,r)})}function fO(t,e,n,o){e.each(iO),n.snaps.each(function(e){nO(t,e)}),e=n.getTarget(t.element),o.reset(),n.onDrop(t,e)}function dO(i,u,a){return[Et(Dr(),function(t,e){var n,o,r;0===e.event.raw.button&&(e.stop(),e={drop:e=function(){return fO(t,G.some(o),i,u)},delayDrop:(n=zh(e,200)).schedule,forceDrop:e,move:function(e){n.cancel(),lO(t,i,u,AO,e)}},o=uO(t,i.blockerClass,(r=e,vi([Et(Dr(),r.forceDrop),Et(Nr(),r.drop),Et(Ar(),function(e,t){r.move(t.event)}),Et(Br(),r.delayDrop)]))),a(t),rO(t,o))})]}function mO(r,i,u){var a=it(G.none());return[Et(Or(),function(t,e){e.stop();var n,e=function(){fO(t,a.get(),r,i),a.set(G.none())},o=uO(t,r.blockerClass,(n={drop:e,delayDrop:function(){},forceDrop:e,move:function(e){lO(t,r,i,BO,e)}},vi([Et(Or(),n.forceDrop),Et(Er(),n.drop),Et(Tr(),n.drop),Et(_r(),function(e,t){n.move(t.event)})])));a.set(G.some(o));u(t),rO(t,o)}),Et(_r(),function(e,t){t.stop(),lO(e,r,i,BO,t.event)}),Et(Er(),function(e,t){t.stop(),fO(e,a.get(),r,i),a.set(G.none())}),Et(Tr(),function(e){fO(e,a.get(),r,i),a.set(G.none())})]}function gO(e,o,r,i,t,n){return e.fold(function(){return NO.snap({sensor:OO(r-20,i-20),range:Tu(t,n),output:OO(G.some(r),G.some(i)),extra:{td:o}})},function(e){var t=r-20,n=i-20,e=e.element.dom.getBoundingClientRect();return NO.snap({sensor:OO(t,n),range:Tu(40,40),output:OO(G.some(r-e.width/2),G.some(i-e.height/2)),extra:{td:o}})})}function pO(e,r,i){return{getSnapPoints:e,leftAttr:"data-drag-left",topAttr:"data-drag-top",onSensor:function(e,t){var n,o=t.td;t=r.get(),n=o,t.exists(function(e){return dt(e,n)})||(r.set(G.some(o)),i(o))},mustSnap:!0}}function hO(e){return Ed(om.sketch({dom:{tag:"div",classes:["tox-selector"]},buttonBehaviours:gc([NO.config({mode:"mouseOrTouch",blockerClass:"blocker",snaps:e}),my.config({})]),eventOrder:{mousedown:["dragging","alloy.base.behaviour"],touchstart:["dragging","alloy.base.behaviour"]}}))}function vO(i,n){function t(e){var t=ku(e);return gO(g.getOpt(n),e,t.x,t.y,t.width,t.height)}function o(e){var t=ku(e);return gO(p.getOpt(n),e,t.right,t.bottom,t.width,t.height)}function r(e,t,n,o){n=n(t),NO.snapTo(e,n),function(e,t,n,o){var r=t.dom.getBoundingClientRect();jn(e.element,"display");t=Lt(ir.fromDom(i.getBody())).dom.innerHeight,n=n(r),t=o(r,t);(n||t)&&Fn(e.element,"display","none")}(e,t,function(e){return e[o]<0},function(e,t){return e[o]>t})}function u(e){return r(h,e,t,"top")}function a(e){return r(v,e,o,"bottom")}var c=it([]),s=it([]),e=it(!1),l=it(G.none()),f=it(G.none()),d=pO(function(){return S(c.get(),t)},l,function(t){f.get().each(function(e){i.fire("TableSelectorChange",{start:t,finish:e})})}),m=pO(function(){return S(s.get(),o)},f,function(t){l.get().each(function(e){i.fire("TableSelectorChange",{start:e,finish:t})})}),g=hO(d),p=hO(m),h=uu(g.asSpec()),v=uu(p.asSpec());Cr().deviceType.isTouch()&&(i.on("TableSelectionChange",function(t){e.get()||(ys(n,h),ys(n,v),e.set(!0)),l.set(G.some(t.start)),f.set(G.some(t.finish)),t.otherCells.each(function(e){c.set(e.upOrLeftCells),s.set(e.downOrRightCells),u(t.start),a(t.finish)})}),i.on("ResizeEditor ResizeWindow ScrollContent",function(){l.get().each(u),f.get().each(a)}),i.on("TableSelectionClear",function(){e.get()&&(ws(h),ws(v),e.set(!1)),l.set(G.none()),f.set(G.none())}))}var bO,yO=function(e){return{anchor:"selection",root:ir.fromDom(e.selection.getNode())}},xO={onLtr:function(){return[fc,oa,ra,ia,ua,lc,em,tm,Od,Sd,_d,kd]},onRtl:function(){return[fc,ra,oa,ua,ia,lc,em,tm,_d,kd,Od,Sd]}},wO={valignCentre:[],alignCentre:[],alignLeft:["tox-pop--align-left"],alignRight:["tox-pop--align-right"],right:["tox-pop--right"],left:["tox-pop--left"],bottom:["tox-pop--bottom"],top:["tox-pop--top"]},CO={type:"separator"},SO=function(t){if(U(t))return t;switch(t.type){case"separator":return CO;case"submenu":return{type:"nestedmenuitem",text:t.text,icon:t.icon,getSubmenuItems:function(){var e=t.getSubmenuItems();return U(e)?e:S(e,SO)}};default:return{type:"menuitem",text:t.text,icon:t.icon,onAction:(e=t.onAction,function(){return e()})}}var e},$a=bo([{offset:["x","y"]},{absolute:["x","y"]},{fixed:["x","y"]}]),kO=$a.offset,OO=$a.absolute,_O=$a.fixed,EO=function(e,t,r,i,u){var n=t.getSnapPoints(e);return oO(n,r,i,u).orThunk(function(){return O(n,function(t,n){var e=n.sensor,o=function(e,t,n,o){e=Yk(e,n,o),n=Yk(t,n,o),o=Math.abs(e.left-n.left),n=Math.abs(e.top-n.top);return Tu(o,n)}(r,e,(n.range.left,n.range.top,i),u);return t.deltas.fold(function(){return{deltas:G.some(o),snap:G.some(n)}},function(e){return(o.left+o.top)/2<=(e.left+e.top)/2?{deltas:G.some(o),snap:G.some(n)}:t})},{deltas:G.none(),snap:G.none()}).snap.map(function(e){return{output:Qk(e.output,r,i,u),extra:e.extra}})})},TO=function(e,t,n,o,r){e=t.getSnapPoints(e);return oO(e,n,o,r)},qo=Object.freeze({__proto__:null,snapTo:function(e,t,n,o){var r=t.getTarget(e.element);t.repositionTarget&&(t=It(e.element),e=vu(t),t=jC(r),o={coord:Qk((o=o).output,o.output,e,t),extra:o.extra},t=Jk(o.coord,0,t),Ln(r,t))}}),DO="data-initial-z-index",tc=Qe("snaps",[ze("getSnapPoints"),Ka("onSensor"),ze("leftAttr"),ze("topAttr"),Ze("lazyViewport",Ou),Ze("mustSnap",!1)]),si=[Ze("useFixed",c),ze("blockerClass"),Ze("getTarget",l),Ze("onDrag",W),Ze("repositionTarget",!0),Ze("onDrop",W),nt("getBounds",Ou),tc],or=function(e){return function(t,n){function o(e){n.setStartData(sO(t,e))}return vi(h([Et(ri(),function(e){n.getStartData().each(function(){return o(e)})})],e(t,n,o)))}},AO=Object.freeze({__proto__:null,getData:function(e){return G.from(Tu(e.x,e.y))},getDelta:function(e,t){return Tu(t.left-e.left,t.top-e.top)}}),Xa=h(si,[$u("dragger",{handlers:or(dO)})]),BO=Object.freeze({__proto__:null,getData:function(e){e=e.raw.touches;return 1===e.length?function(e){e=e[0];return G.some(Tu(e.clientX,e.clientY))}(e):G.none()},getDelta:function(e,t){return Tu(t.left-e.left,t.top-e.top)}}),bo=h(si,[$u("dragger",{handlers:or(mO)})]),$a=h(si,[$u("dragger",{handlers:or(function(e,t,n){return h(dO(e,t,n),mO(e,t,n))})})]),NO=z({branchKey:"mode",branches:Object.freeze({__proto__:null,mouse:Xa,touch:bo,mouseOrTouch:$a}),name:"dragging",active:{events:function(e,t){return e.dragger.handlers(e,t)}},extra:{snap:function(e){return{sensor:e.sensor,range:e.range,output:e.output,extra:G.from(e.extra)}}},state:Object.freeze({__proto__:null,init:function(){var r=G.none(),t=G.none(),e=q({});return qi({readState:e,reset:function(){r=G.none(),t=G.none()},update:function(o,e){return o.getData(e).bind(function(e){return t=o,n=e,e=r.map(function(e){return t.getDelta(e,n)}),r=G.some(n),e;var t,n})},getStartData:function(){return t},setStartData:function(e){t=G.some(e)}})}}),apis:qo});(tc=bO=bO||{})[tc.None=0]="None",tc[tc.Both=1]="Both",tc[tc.Vertical=2]="Vertical";function RO(e,t,n){var o,r,i,u,a=ir.fromDom(e.getContainer()),n=(o=e,r=t,i=n,u=su(a),t=mu(a),(n={}).height=SS(u+r.top,ig(o),ag(o)),i===bO.Both&&(n.width=SS(t+r.left,rg(o),ug(o))),n);mo(n,function(e,t){return Fn(a,t,CS(e))}),e.fire("ResizeEditor")}function MO(i,o,r){return o.delimiter||(o.delimiter="»"),{dom:{tag:"div",classes:["tox-statusbar__path"],attributes:{role:"navigation"}},behaviours:gc([Rd.config({mode:"flow",selector:"div[role=button]"}),Ug.config({disabled:r.isDisabled}),op(),pv.config({}),Id.config({}),id("elementPathEvents",[bi(function(t,e){i.shortcuts.add("alt+F11","focus statusbar elementpath",function(){return Rd.focusIn(t)}),i.on("NodeChange",function(e){var n,e=function(e){for(var t=[],n=e.length;0<n--;){var o=e[n];if(1===o.nodeType&&!function(e){if(1===e.nodeType){if("BR"===e.nodeName||e.getAttribute("data-mce-bogus"))return!0;if("bookmark"===e.getAttribute("data-mce-type"))return!0}return!1}(o)){var r=i.fire("ResolveName",{name:o.nodeName.toLowerCase(),target:o});if(r.isDefaultPrevented()||t.push({name:r.name,element:o}),r.isPropagationStopped())break}}return t}(e.parents);0<e.length?Id.set(t,(e=S((e=e)||[],function(t,e){return om.sketch({dom:{tag:"div",classes:["tox-statusbar__path-item"],attributes:{role:"button","data-index":e,"tab-index":-1,"aria-level":e+1},innerHtml:t.name},action:function(e){i.focus(),i.selection.select(t.element),i.nodeChanged()},buttonBehaviours:gc([Ip(r.isDisabled),op()])})}),n={dom:{tag:"div",classes:["tox-statusbar__path-divider"],attributes:{"aria-hidden":!0},innerHtml:" "+o.delimiter+" "}},O(e.slice(1),function(e,t){return e.push(n),e.push(t),e},[e[0]]))):Id.set(t,[])})})])]),components:[]}}function IO(e,o){function r(e,t,n){return Id.set(e,[Qn(o.translate(["{0} "+n,t[n]]))])}var t;return om.sketch({dom:{tag:"button",classes:["tox-statusbar__wordcount"]},components:[],buttonBehaviours:gc([Ip(o.isDisabled),op(),pv.config({}),Id.config({}),El.config({store:{mode:"memory",initialValue:{mode:"words",count:{words:0,characters:0}}}}),id("wordcount-events",[wi(function(e){var t=El.getValue(e),n="words"===t.mode?"characters":"words";El.setValue(e,{mode:n,count:t.count}),r(e,t.count,n)}),bi(function(n){e.on("wordCountUpdate",function(e){var t=El.getValue(n).mode;El.setValue(n,{mode:t,count:e.wordCount}),r(n,e.wordCount,t)})})])]),eventOrder:((t={})[Yr()]=["disabling","alloy.base.behaviour","wordcount-events"],t)})}function FO(o,n){var e,t,r,i;return{dom:{tag:"div",classes:["tox-statusbar"]},components:(i=function(){var e,t=[];return o.getParam("elementpath",!0,"boolean")&&t.push(MO(o,{},n)),o.hasPlugin("wordcount")&&t.push(IO(o,n)),o.getParam("branding",!0,"boolean")&&t.push({dom:{tag:"span",classes:["tox-statusbar__branding"],innerHtml:'<a href="https://www.tiny.cloud/?utm_campaign=editor_referral&amp;utm_medium=poweredby&amp;utm_source=tinymce&amp;utm_content=v5" rel="noopener" target="_blank" tabindex="-1" aria-label="'+(e=Vg.translate(["Powered by {0}","Tiny"]))+'">'+e+"</a>"}}),0<t.length?[{dom:{tag:"div",classes:["tox-statusbar__text-container"]},components:t}]:[]}(),t=!(e=o).hasPlugin("autoresize"),(t=!1===(t=e.getParam("resize",t))?bO.None:"both"===t?bO.Both:bO.Vertical)!==bO.None&&i.push((r=t,{dom:{tag:"div",classes:["tox-statusbar__resize-handle"],attributes:{title:n.translate("Resize"),"aria-hidden":"true"},innerHtml:Dd("resize-handle",n.icons)},behaviours:gc([NO.config({mode:"mouse",repositionTarget:!1,onDrag:function(e,t,n){RO(o,n,r)},blockerClass:"tox-blocker"})])})),i)}}function PO(a){function c(){return n.bind(mk.getHeader)}function e(){Fn(T.element,"width",document.body.clientWidth+"px")}function s(){return ce.value(p)}function l(){return n.bind(function(e){return mk.getThrobber(e)}).getOrDie("Could not find throbber element")}var t=a.inline,f=t?yk:bk,d=ep(a)?ik:QS,n=G.none(),o=(C=Cr()).browser.isIE()?["tox-platform-ie"]:[],r=C.deviceType.isTouch()?["tox-platform-touch"]:[],i=Yg(a),u=Qg(a),m=Vg.isRtl()?{attributes:{dir:"rtl"}}:{},g={attributes:((S={})[Fc]=i?Ha.BottomToTop:Ha.TopToBottom,S)},p=uu((k=dt(tu(),u)&&"grid"===Vn(u,"display"),w={dom:A({tag:"div",classes:["tox","tox-silver-sink","tox-tinymce-aux"].concat(o).concat(r)},m),behaviours:gc([ml.config({useFixed:function(){return d.isDocked(c)}})])},O={dom:{styles:{width:document.body.clientWidth+"px"}},events:vi([Et(ii(),e)])},wo(w,k?O:{}))),h=Ed({dom:{tag:"div",classes:["tox-anchorbar"]}}),v=Dw(p,a,function(){return n.bind(function(e){return h.getOpt(e)}).getOrDie("Could not find a anchor bar element")}),b=mk.parts.menubar({dom:{tag:"div",classes:["tox-menubar"]},backstage:v,onEscape:function(){a.focus()}}),y=Gg(a),x=mk.parts.toolbar(A({dom:{tag:"div",classes:["tox-toolbar"]},getSink:s,providers:v.shared.providers,onEscape:function(){a.focus()},type:y,lazyToolbar:function(){return n.bind(function(e){return mk.getToolbar(e)}).getOrDie("Could not find more toolbar element")},lazyHeader:function(){return c().getOrDie("Could not find header element")}},g)),u=mk.parts["multiple-toolbar"]({dom:{tag:"div",classes:["tox-toolbar-overlord"]},providers:v.shared.providers,onEscape:function(){a.focus()},type:y}),m=mk.parts.socket({dom:{tag:"div",classes:["tox-edit-area"]}}),w=mk.parts.sidebar({dom:{tag:"div",classes:["tox-sidebar"]}}),C=mk.parts.throbber({dom:{tag:"div",classes:["tox-throbber"]},backstage:v}),S=a.getParam("statusbar",!0,"boolean")&&!t?G.some(FO(a,v.shared.providers)):G.none(),m={dom:{tag:"div",classes:["tox-sidebar-wrap"]},components:[m,w]},k=qg(a),O=sg(a),w=cg(a),b=mk.parts.header({dom:A({tag:"div",classes:["tox-editor-header"]},g),components:B([w?[b]:[],k?[u]:O?[x]:[],Jg(a)?[]:[h.asSpec()]]),sticky:ep(a),editor:a,sharedBackstage:v.shared}),b=B([i?[]:[b],t?[]:[m],i?[b]:[]]),b=B([[{dom:{tag:"div",classes:["tox-editor-container"]},components:b}],t?[]:S.toArray(),[C]]),S=Zg(a),C=A(A({role:"application"},Vg.isRtl()?{dir:"rtl"}:{}),S?{"aria-hidden":"true"}:{}),_=uu(mk.sketch({dom:{tag:"div",classes:["tox","tox-tinymce"].concat(t?["tox-tinymce-inline"]:[]).concat(i?["tox-tinymce--toolbar-bottom"]:[]).concat(r).concat(o),styles:A({visibility:"hidden"},S?{opacity:"0",border:"0"}:{}),attributes:C},components:b,behaviours:gc([op(),Ug.config({disableClass:"tox-tinymce--disabled"}),Rd.config({mode:"cyclic",selector:".tox-menubar, .tox-toolbar, .tox-toolbar__primary, .tox-toolbar__overflow--open, .tox-sidebar__overflow--open, .tox-statusbar__path, .tox-statusbar__wordcount, .tox-statusbar__branding a"})])})),n=G.some(_);a.shortcuts.add("alt+F9","focus menubar",function(){mk.focusMenubar(_)}),a.shortcuts.add("alt+F10","focus toolbar",function(){mk.focusToolbar(_)}),a.addCommand("ToggleToolbarDrawer",function(){mk.toggleToolbarDrawer(_)}),a.addQueryStateHandler("ToggleToolbarDrawer",function(){return mk.isToolbarDrawerToggled(_)});var E=ov(_),T=ov(p);function D(){var e=CS(kS(a)),t=CS(OS(t=a).getOr(og(t)));return a.inline||(zn("div","width",t)&&Fn(_.element,"width",t),zn("div","height",e)?Fn(_.element,"height",e):Fn(_.element,"height","200px")),e}return HC(a,E,T),{mothership:E,uiMothership:T,backstage:v,renderUI:function(){var o,r;d.setup(a,v.shared,c),Ek(a,v),Wk(a,s,v),r=(o=a).ui.registry.getAll().sidebars,oe(lo(r),function(t){function n(){return G.from(o.queryCommandValue("ToggleSidebar")).is(t)}var e=r[t];o.ui.registry.addToggleButton(t,{icon:e.icon,tooltip:e.tooltip,onAction:function(e){o.execCommand("ToggleSidebar",!1,t),e.setActive(n())},onSetup:function(e){function t(){return e.setActive(n())}return o.on("ToggleSidebar",t),function(){o.off("ToggleSidebar",t)}}})}),dS(a,l,v.shared),de(a.getParam("toolbar_groups",{},"object"),function(e,t){a.ui.registry.addGroupToolbarButton(t,e)});var e=a.ui.registry.getAll(),t=e.buttons,n=e.menuItems,i=e.contextToolbars,u=e.sidebars,e=lg(a),t={menuItems:n,menus:function(e){e=e.getParam("menu");return e?de(e,function(e){return A(A({},e),{items:e.items})}):{}}(a),menubar:a.getParam("menubar"),toolbar:e.getOrThunk(function(){return a.getParam("toolbar",!0)}),allowToolbarGroups:y===fg.floating,buttons:t,sidebar:u};VC(a,i,p,{backstage:v}),vO(a,p);u=a.getElement(),i=D();return f.render(a,{mothership:E,uiMothership:T,outerContainer:_},t,v,{targetNode:u,height:i})},getUi:function(){return{channels:{broadcastAll:T.broadcast,broadcastOn:T.broadcastOn,register:function(){}}}}}}function LO(e){return[Ue("type"),je("columns",Go),e]}function VO(t){return Po("items","items",ko(),Be(Ie(function(e){return Fe("Checking item of "+t,K_,e).fold(function(e){return ce.error(jo(e))},function(e){return ce.value(e)})})))}function HO(e){return U(e.type)&&U(e.name)}function zO(e){return e=C(tE(e),HO),e=T(e,function(t){return G.from(nE[t.type]).fold(function(){return[]},function(e){return[je(t.name,e)]})}),No(e)}function jO(e){return{internalDialog:Pe(Fe("dialog",Q_,e)),dataValidator:zO(e),initialData:e.initialData}}function UO(e){var n=[],o={};return mo(e,function(e,t){e.fold(function(){n.push(t)},function(e){o[t]=e})}),0<n.length?ce.error(n):ce.value(o)}function WO(e,t){Fn(e,"height",t+"px"),Cr().browser.isIE()?jn(e,"flex-basis"):Fn(e,"flex-basis",t+"px")}function qO(e,a,t){Lu(e,'[role="dialog"]').each(function(u){Vu(u,'[role="tablist"]').each(function(i){t.get().map(function(e){return Fn(a,"height","0"),Fn(a,"flex-basis","0"),Math.min(e,(n=a,o=i,r=Pt(t=u).dom,e=Lu(t,".tox-dialog-wrap").getOr(t),e="fixed"===Vn(e,"position")?Math.max(r.clientHeight,window.innerHeight):Math.max(r.offsetHeight,r.scrollHeight),r=su(n),n=n.dom.offsetLeft>=o.dom.offsetLeft+mu(o)?Math.max(su(o),r):r,o=parseInt(Vn(t,"margin-top"),10)||0,r=parseInt(Vn(t,"margin-bottom"),10)||0,e-(su(t)+o+r-n)));var t,n,o,r}).each(function(e){WO(a,e)})})})}function GO(e){return Vu(e,'[role="tabpanel"]')}function $O(i){var u;return{smartTabHeight:(u=it(G.none()),{extraEvents:[bi(function(e){var o=e.element;GO(o).each(function(t){var n;Fn(t,"visibility","hidden"),e.getSystem().getByDom(t).toOptional().each(function(e){var n,o,r,e=(o=t,r=e,S(n=i,function(e,t){Id.set(r,n[t].view());t=o.dom.getBoundingClientRect();return Id.set(r,[]),t.height})),e=re(M(e,function(e,t){return t<e?-1:e<t?1:0}));u.set(e)}),qO(o,t,u),jn(t,"visibility"),n=e,re(i).each(function(e){return iE.showTab(n,e.value)}),nm.requestAnimationFrame(function(){qO(o,t,u)})})}),Et(ii(),function(e){var t=e.element;GO(t).each(function(e){qO(t,e,u)})}),Et(Ev,function(e,t){var r=e.element;GO(r).each(function(t){var e=wa();Fn(t,"visibility","hidden");var n=Hn(t,"height").map(function(e){return parseInt(e,10)});jn(t,"height"),jn(t,"flex-basis");var o=t.dom.getBoundingClientRect().height;n.forall(function(e){return e<o})?(u.set(G.from(o)),qO(r,t,u)):n.each(function(e){WO(t,e)}),jn(t,"visibility"),e.each(xa)})})],selectFirst:!1}),naiveTabHeight:{extraEvents:[],selectFirst:!0}}}function XO(e,n){function o(e){var t=El.getValue(e),e=UO(t).getOr({}),t=i.get(),e=wo(t,e);i.set(e)}function r(e){var t=i.get();El.setValue(e,t)}var i=it({}),u=it(null),t=S(e.tabs,function(e){return{value:e.name,dom:{tag:"div",classes:["tox-dialog__body-nav-item"],innerHtml:n.shared.providers.translate(e.title)},view:function(){return[ky.sketch(function(t){return{dom:{tag:"div",classes:["tox-form"]},components:S(e.items,function(e){return Zx(t,e,n)}),formBehaviours:gc([Rd.config({mode:"acyclic",useTabstopAt:p(sy)}),id("TabView.form.events",[bi(r),yi(o)]),bc.config({channels:we([{key:uE,value:{onReceive:o}},{key:aE,value:{onReceive:r}}])})])}})]}}}),e=$O(t).smartTabHeight;return iE.sketch({dom:{tag:"div",classes:["tox-dialog__body"]},onChangeTab:function(e,t,n){t=El.getValue(t);wt(e,_v,{name:t,oldName:u.get()}),u.set(t)},tabs:t,components:[iE.parts.tabbar({dom:{tag:"div",classes:["tox-dialog__body-nav"]},components:[rE.parts.tabs({})],markers:{tabClass:"tox-tab",selectedClass:"tox-dialog__body-nav-item--active"},tabbarBehaviours:gc([pv.config({})])}),iE.parts.tabview({dom:{tag:"div",classes:["tox-dialog__body-content"]}})],selectFirst:e.selectFirst,tabSectionBehaviours:gc([id("tabpanel",e.extraEvents),Rd.config({mode:"acyclic"}),lf.config({find:function(e){return re(iE.getViewItems(e))}}),El.config({store:{mode:"manual",getValue:function(e){return e.getSystem().broadcastOn([uE],{}),i.get()},setValue:function(e,t){i.set(t),e.getSystem().broadcastOn([aE],{})}}})])})}function YO(e,t,r,n){return{dom:{tag:"div",classes:["tox-dialog__content-js"],attributes:A(A({},t.map(function(e){return{id:e}}).getOr({})),n?{"aria-live":"polite"}:{})},components:[],behaviours:gc([By(0),fC.config({channel:lE,updateState:function(e,t){return G.some({isTabPanel:function(){return"tabpanel"===t.body.type}})},renderComponents:function(e){return"tabpanel"!==e.body.type?[(n=e.body,o=r,{dom:{tag:"div",classes:["tox-dialog__body"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-content"]},components:[(t=Ed(ky.sketch(function(t){return{dom:{tag:"div",classes:["tox-form"].concat(n.classes)},components:S(n.items,function(e){return Zx(t,e,o)})}}))).asSpec()]}],behaviours:gc([Rd.config({mode:"acyclic",useTabstopAt:p(sy)}),Ay(t),Fy(t,{postprocess:function(e){return UO(e).fold(function(e){return console.error(e),{}},function(e){return e})}})])})]:[XO(e.body,r)];var n,o,t},initialData:e})])}}function KO(e,t){return{dom:{tag:"div",styles:{display:"none"},classes:["tox-dialog__header"]},components:[e,t]}}function JO(e,t){return T_.parts.close(om.sketch({dom:{tag:"button",classes:["tox-button","tox-button--icon","tox-button--naked"],attributes:{type:"button","aria-label":t.translate("Close")}},action:e,buttonBehaviours:gc([pv.config({})])}))}function QO(){return T_.parts.title({dom:{tag:"div",classes:["tox-dialog__title"],innerHtml:"",styles:{display:"none"}}})}function ZO(e,t){return T_.parts.body({dom:{tag:"div",classes:["tox-dialog__body"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-content"]},components:[{dom:lS("<p>"+t.translate(e)+"</p>")}]}]})}function e_(e){return T_.parts.footer({dom:{tag:"div",classes:["tox-dialog__footer"]},components:e})}function t_(e,t){return[mv.sketch({dom:{tag:"div",classes:["tox-dialog__footer-start"]},components:e}),mv.sketch({dom:{tag:"div",classes:["tox-dialog__footer-end"]},components:t})]}function n_(t){var e="tox-dialog",n=e+"-wrap",o=n+"__backdrop",r=e+"__disable-scroll";return T_.sketch({lazySink:t.lazySink,onEscape:function(e){return t.onEscape(e),G.some(!0)},useTabstopAt:function(e){return!sy(e)},dom:{tag:"div",classes:[e].concat(t.extraClasses),styles:A({position:"relative"},t.extraStyles)},components:h([t.header,t.body],t.footer.toArray()),parts:{blocker:{dom:lS('<div class="'+n+'"></div>'),components:[{dom:{tag:"div",classes:mE?[o,o+"--opaque"]:[o]}}]}},dragBlockClass:n,modalBehaviours:gc(h([Fd.config({}),id("dialog-events",t.dialogEvents.concat([Rt(Mr(),function(e,t){Rd.focusIn(e)})])),id("scroll-lock",[bi(function(){kn(tu(),r)}),yi(function(){_n(tu(),r)})])],t.extraBehaviours)),eventOrder:A(((n={})[Yr()]=["dialog-events"],n[ui()]=["scroll-lock","dialog-events","alloy.base.behaviour"],n[ai()]=["alloy.base.behaviour","dialog-events","scroll-lock"],n),t.eventOrder)})}function o_(e){return om.sketch({dom:{tag:"button",classes:["tox-button","tox-button--icon","tox-button--naked"],attributes:{type:"button","aria-label":e.translate("Close"),title:e.translate("Close")}},components:[{dom:{tag:"div",classes:["tox-icon"],innerHtml:Dd("close",e.icons)}}],action:function(e){xt(e,wv)}})}function r_(e,t,n){function o(e){return[Qn(n.translate(e.title))]}return{dom:{tag:"div",classes:["tox-dialog__title"],attributes:A({},t.map(function(e){return{id:e}}).getOr({}))},components:o(e),behaviours:gc([fC.config({channel:sE,renderComponents:o})])}}function i_(){return{dom:lS('<div class="tox-dialog__draghandle"></div>')}}function u_(e,t){return n={title:t.shared.providers.translate(e),draggable:t.dialog.isDraggableModal()},o=t.shared.providers,e=T_.parts.title(r_(n,G.none(),o)),t=T_.parts.draghandle(i_()),o=T_.parts.close(o_(o)),o=[e].concat(n.draggable?[t]:[]).concat([o]),mv.sketch({dom:lS('<div class="tox-dialog__header"></div>'),components:o});var n,o}function a_(e,t){return{dom:{tag:"div",classes:["tox-dialog__busy-spinner"],attributes:{"aria-label":e},styles:{left:"0px",right:"0px",bottom:"0px",top:"0px",position:"absolute"}},behaviours:t,components:[{dom:lS('<div class="tox-spinner"><div></div><div></div><div></div></div>')}]}}function c_(e,t){return{onClose:function(){return t.closeWindow()},onBlock:function(n){T_.setBusy(e(),function(e,t){return a_(n.message,t)})},onUnblock:function(){T_.setIdle(e())}}}function s_(e,t,n,o){return uu(n_(A(A({},e),{lazySink:o.shared.getSink,extraBehaviours:h([fC.config({channel:cE,updateState:function(e,t){return G.some(t)},initialData:t}),Vy({})],e.extraBehaviours),onEscape:function(e){xt(e,wv)},dialogEvents:n,eventOrder:((n={})[Xr()]=[fC.name(),bc.name()],n[ui()]=["scroll-lock",fC.name(),"messages","dialog-events","alloy.base.behaviour"],n[ai()]=["alloy.base.behaviour","dialog-events","messages",fC.name(),"scroll-lock"],n)})))}function l_(e){return S(e,function(e){return"menu"===e.type?(n=S((t=e).items,function(e){var t=it(!1);return A(A({},e),{storage:t})}),A(A({},t),{items:n})):e;var t,n})}function f_(e){return O(e,function(e,t){return"menu"!==t.type?e:O(t.items,function(e,t){return e[t.name]=t.storage,e},e)},{})}function d_(e,n){return[Bt(Mr(),cy),e(xv,function(e,t){n.onClose(),t.onClose()}),e(wv,function(e,t,n,o){t.onCancel(e),xt(o,xv)}),Et(Ov,function(e,t){return n.onUnblock()}),Et(kv,function(e,t){return n.onBlock(t.event)})]}function m_(e,t){var n=t.map(function(e){return e.footerButtons}).getOr([]),t=w(n,function(e){return"start"===e.align});return[(n=function(e,t){return mv.sketch({dom:{tag:"div",classes:["tox-dialog__footer-"+e]},components:S(t,function(e){return e.memento.asSpec()})})})("start",t.pass),n("end",t.fail)]}function g_(e,n){return{dom:lS('<div class="tox-dialog__footer"></div>'),components:[],behaviours:gc([fC.config({channel:fE,initialData:e,updateState:function(e,t){var r=S(t.buttons,function(e){var t=Ed(ix(e,e.type,n));return{name:e.name,align:e.align,memento:t}});return G.some({lookupByName:function(e,t){return n=e,o=t,_(r,function(e){return e.name===o}).bind(function(e){return e.memento.getOpt(n)});var n,o},footerButtons:r})},renderComponents:m_})])}}function p_(e,t){return T_.parts.footer(g_(e,t))}function h_(t,n){if(t.getRoot().getSystem().isConnected()){var o=lf.getCurrent(t.getFormWrapper()).getOr(t.getFormWrapper());return ky.getField(o,n).fold(function(){var e=t.getFooter();return fC.getState(e).get().bind(function(e){return e.lookupByName(o,n)})},function(e){return G.some(e)})}return G.none()}function v_(i,o,u){function e(e){var t=i.getRoot();t.getSystem().isConnected()&&e(t)}var a={getData:function(){var e=i.getRoot(),t=e.getSystem().isConnected()?i.getFormWrapper():e,e=El.getValue(t),t=de(u,function(e){return e.get()});return A(A({},e),t)},setData:function(r){e(function(e){var t=a.getData(),n=A(A({},t),r),o=function(e,t){e=e.getRoot();return fC.getState(e).get().map(function(e){return Pe(Fe("data",e.dataValidator,t))}).getOr(t)}(i,n),t=i.getFormWrapper();El.setValue(t,o),mo(u,function(e,t){vo(n,t)&&e.set(n[t])})})},disable:function(e){h_(i,e).each(Ug.disable)},enable:function(e){h_(i,e).each(Ug.enable)},focus:function(e){h_(i,e).each(Fd.focus)},block:function(t){if(!U(t))throw new Error("The dialogInstanceAPI.block function should be passed a blocking message of type string as an argument");e(function(e){wt(e,kv,{message:t})})},unblock:function(){e(function(e){xt(e,Ov)})},showTab:function(n){e(function(e){var t=i.getBody();fC.getState(t).get().exists(function(e){return e.isTabPanel()})&&lf.getCurrent(t).each(function(e){iE.showTab(e,n)})})},redial:function(n){e(function(e){var t=o(n);e.getSystem().broadcastOn([cE],t),e.getSystem().broadcastOn([sE],t.internalDialog),e.getSystem().broadcastOn([lE],t.internalDialog),e.getSystem().broadcastOn([fE],t.internalDialog),a.setData(t.initialData)})},close:function(){e(function(e){xt(e,xv)})}};return a}function b_(e,t,n){var o=u_(e.internalDialog.title,n),r=function(e,t){t=YO(e,G.none(),t,!1);return T_.parts.body(t)}({body:e.internalDialog.body},n),i=l_(e.internalDialog.buttons),u=f_(i),a=p_({buttons:i},n),c=pE(function(){return l},c_(function(){return s},t),n.shared.getSink),i=function(e){switch(e){case"large":return["tox-dialog--width-lg"];case"medium":return["tox-dialog--width-md"];default:return[]}}(e.internalDialog.size),i={header:o,body:r,footer:G.some(a),extraClasses:i,extraBehaviours:[],extraStyles:{}},s=s_(i,e,c,n),l=v_({getRoot:function(){return s},getBody:function(){return T_.getBody(s)},getFooter:function(){return T_.getFooter(s)},getFormWrapper:function(){var e=T_.getBody(s);return lf.getCurrent(e).getOr(e)}},t.redial,u);return{dialog:s,instanceApi:l}}function y_(e,t,n,o){var r,i=un("dialog-label"),u=un("dialog-content"),a=Ed((a={title:e.internalDialog.title,draggable:!0},r=i,s=n.shared.providers,mv.sketch({dom:lS('<div class="tox-dialog__header"></div>'),components:[r_(a,G.some(r),s),i_(),o_(s)],containerBehaviours:gc([NO.config({mode:"mouse",blockerClass:"blocker",getTarget:function(e){return Hu(e,'[role="dialog"]').getOrDie()},snaps:{getSnapPoints:function(){return[]},leftAttr:"data-drag-left",topAttr:"data-drag-top"}})])}))),c=Ed((r={body:e.internalDialog.body},s=n,o=o,YO(r,G.some(u),s,o))),s=l_(e.internalDialog.buttons),o=f_(s),l=Ed(hE({buttons:s},n)),s=pE(function(){return d},{onBlock:function(n){E_.block(f,function(e,t){return a_(n.message,t)})},onUnblock:function(){E_.unblock(f)},onClose:function(){return t.closeWindow()}},n.shared.getSink),f=uu({dom:{tag:"div",classes:["tox-dialog","tox-dialog-inline"],attributes:((n={role:"dialog"})["aria-labelledby"]=i,n["aria-describedby"]=""+u,n)},eventOrder:((n={})[Xr()]=[fC.name(),bc.name()],n[Yr()]=["execute-on-form"],n[ui()]=["reflecting","execute-on-form"],n),behaviours:gc([Rd.config({mode:"cyclic",onEscape:function(e){return xt(e,xv),G.some(!0)},useTabstopAt:function(e){return!sy(e)&&("button"!==Mt(e)||"disabled"!==Zt(e,"disabled"))}}),fC.config({channel:cE,updateState:function(e,t){return G.some(t)},initialData:e}),Fd.config({}),id("execute-on-form",s.concat([Rt(Mr(),function(e,t){Rd.focusIn(e)})])),E_.config({getRoot:function(){return G.some(f)}}),Id.config({}),Vy({})]),components:[a.asSpec(),c.asSpec(),l.asSpec()]}),d=v_({getRoot:function(){return f},getFooter:function(){return l.get(f)},getBody:function(){return c.get(f)},getFormWrapper:function(){var e=c.get(f);return lf.getCurrent(e).getOr(e)}},t.redial,o);return{dialog:f,instanceApi:d}}function x_(t){function e(e){t.getSystem().isConnected()&&e(t)}return{block:function(t){if(!U(t))throw new Error("The urlDialogInstanceAPI.block function should be passed a blocking message of type string as an argument");e(function(e){wt(e,kv,{message:t})})},unblock:function(){e(function(e){xt(e,Ov)})},close:function(){e(function(e){xt(e,xv)})},sendMessage:function(t){e(function(e){e.getSystem().broadcastOn([dE],t)})}}}function w_(e){return $(e)&&-1!==bE.indexOf(e.mceAction)}function C_(n,e,o,t){var r=u_(n.title,t),i=function(e){e={dom:{tag:"div",classes:["tox-dialog__content-js"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-iframe"]},components:[uy({dom:{tag:"iframe",attributes:{src:e.url}},behaviours:gc([pv.config({}),Fd.config({})])})]}],behaviours:gc([Rd.config({mode:"acyclic",useTabstopAt:p(sy)})])};return T_.parts.body(e)}(n),u=n.buttons.bind(function(e){return 0===e.length?G.none():G.some(p_({buttons:e},t))}),a=gE(function(){return g},c_(function(){return m},e)),c=A(A({},n.height.fold(function(){return{}},function(e){return{height:e+"px","max-height":e+"px"}})),n.width.fold(function(){return{}},function(e){return{width:e+"px","max-width":e+"px"}})),s=n.width.isNone()&&n.height.isNone()?["tox-dialog--width-lg"]:[],l=new vE(n.url,{base_uri:new vE(window.location.href)}),f=l.protocol+"://"+l.host+(l.port?":"+l.port:""),d=it(G.none()),e=[id("messages",[bi(function(){var e=Ih(ir.fromDom(window),"message",function(e){var t;l.isSameOrigin(new vE(e.raw.origin))&&(t=e.raw.data,w_(t)?function(e,t,n){switch(n.mceAction){case"insertContent":e.insertContent(n.content);break;case"setContent":e.setContent(n.content);break;case"execCommand":var o=!!Y(n.ui)&&n.ui;e.execCommand(n.cmd,o,n.value);break;case"close":t.close();break;case"block":t.block(n.message);break;case"unblock":t.unblock()}}(o,g,t):!w_(e=t)&&$(e)&&vo(e,"mceAction")&&n.onMessage(g,t))});d.set(G.some(e))}),yi(function(){d.get().each(function(e){return e.unbind()})})]),bc.config({channels:((e={})[dE]={onReceive:function(e,t){Vu(e.element,"iframe").each(function(e){e.dom.contentWindow.postMessage(t,f)})}},e)})],m=s_({header:r,body:i,footer:u,extraClasses:s,extraBehaviours:e,extraStyles:c},n,a,t),g=x_(m);return{dialog:m,instanceApi:g}}function S_(c){var s=c.backstage.shared;return{open:function(e,t){function n(e){T_.hide(a),t(e)}var o=Ed(ix({name:"yes",text:"Yes",primary:!0,align:"end",disabled:!1,icon:G.none()},"submit",c.backstage)),r=ix({name:"no",text:"No",primary:!1,align:"end",disabled:!1,icon:G.none()},"cancel",c.backstage),i=QO(),u=JO(function(){return n(!1)},s.providers),a=uu(n_({lazySink:function(){return s.getSink()},header:KO(i,u),body:ZO(e,s.providers),footer:G.some(e_(t_([],[r,o.asSpec()]))),onEscape:function(){return n(!1)},extraClasses:["tox-confirm-dialog"],extraBehaviours:[],extraStyles:{},dialogEvents:[Et(wv,function(){return n(!1)}),Et(Sv,function(){return n(!0)})],eventOrder:{}}));T_.show(a);o=o.get(a);Fd.focus(o)}}}function k_(e){var a,c,d=e.backstage,m=e.editor,g=ep(m),n=(c=(a=e).backstage.shared,{open:function(e,t){function n(){T_.hide(u),t()}var o=Ed(ix({name:"close-alert",text:"OK",primary:!0,align:"end",disabled:!1,icon:G.none()},"cancel",a.backstage)),r=QO(),i=JO(n,c.providers),u=uu(n_({lazySink:function(){return c.getSink()},header:KO(r,i),body:ZO(e,c.providers),footer:G.some(e_(t_([],[o.asSpec()]))),onEscape:n,extraClasses:["tox-alert-dialog"],extraBehaviours:[],extraStyles:{},dialogEvents:[Et(wv,n)],eventOrder:{}}));T_.show(u);o=o.get(u);Fd.focus(o)}}),o=S_(e),r=function(e,n){return oE.openUrl(function(e){var t=C_(e,{closeWindow:function(){T_.hide(t.dialog),n(t.instanceApi)}},m,d);return T_.show(t.dialog),t.instanceApi},e)},i=function(e,r){return oE.open(function(e,t,n){var t=t,o=b_({dataValidator:n,initialData:t,internalDialog:e},{redial:oE.redial,closeWindow:function(){T_.hide(o.dialog),r(o.instanceApi)}},d);return T_.show(o.dialog),o.instanceApi.setData(t),o.instanceApi},e)},u=function(e,s,l,f){return oE.open(function(e,t,n){function o(){return a.on(function(e){Zd.reposition(e),tk.refresh(e)})}var r,i,u=Pe(Fe("data",n,t)),a=(r=it(G.none()),{clear:function(){return r.set(G.none())},set:function(e){return r.set(G.some(e))},isSet:function(){return r.get().isSome()},on:function(e){return r.get().each(e)}}),t=d.shared.header.isPositionedAtTop(),c=y_({dataValidator:n,initialData:u,internalDialog:e},{redial:oE.redial,closeWindow:function(){a.on(Zd.hide),m.off("ResizeEditor",o),a.clear(),l(c.instanceApi)}},d,f),e=uu(Zd.sketch(A(A({lazySink:d.shared.getSink,dom:{tag:"div",classes:[]},fireDismissalEventInstead:{}},t?{}:{fireRepositionEventInstead:{}}),{inlineBehaviours:gc(h([id("window-manager-inline-events",[Et(ci(),function(e,t){xt(c.dialog,wv)})])],(i=m,e=t,g&&e?[]:[tk.config({contextual:{lazyContext:function(){return G.some(Su(ir.fromDom(i.getContentAreaContainer())))},fadeInClass:"tox-dialog-dock-fadein",fadeOutClass:"tox-dialog-dock-fadeout",transitionClass:"tox-dialog-dock-transition"},modes:["top"]})]))),isExtraPart:function(e,t){return Ph(t=t,".tox-alert-dialog")||Ph(t,".tox-confirm-dialog")}})));return a.set(e),Zd.showWithin(e,s,au(c.dialog),G.some(tu())),g&&t||(tk.refresh(e),m.on("ResizeEditor",o)),c.instanceApi.setData(u),Rd.focusIn(c.dialog),c.instanceApi},e)};return{open:function(e,t,n){return void 0!==t&&"toolbar"===t.inline?u(e,d.shared.anchors.inlineDialog(),n,t.ariaAttrs):void 0!==t&&"cursor"===t.inline?u(e,d.shared.anchors.cursor(),n,t.ariaAttrs):i(e,n)},openUrl:function(e,t){return r(e,t)},alert:function(e,t){n.open(e,function(){t()})},close:function(e){e.close()},confirm:function(e,t){o.open(e,function(e){t(e)})}}}var O_,__,si=q([ze("lazySink"),Xe("dragBlockClass"),nt("getBounds",Ou),Ze("useTabstopAt",v),Ze("eventOrder",{}),Wr("modalBehaviours",[Rd]),Ja("onExecute"),Za("onEscape")]),or={sketch:l},z=q([Pl({name:"draghandle",overrides:function(e,t){return{behaviours:gc([NO.config({mode:"mouse",getTarget:function(e){return Lu(e,'[role="dialog"]').getOr(e)},blockerClass:e.dragBlockClass.getOrDie(new Error("The drag blocker class was not specified for a dialog with a drag handle: \n"+JSON.stringify(t,null,2)).message),getBounds:e.getDragBounds})])}}}),Fl({schema:[ze("dom")],name:"title"}),Fl({factory:or,schema:[ze("dom")],name:"close"}),Fl({factory:or,schema:[ze("dom")],name:"body"}),Pl({factory:or,schema:[ze("dom")],name:"footer"}),xo({factory:{sketch:function(e,t){return A(A({},e),{dom:t.dom,components:t.components})}},schema:[Ze("dom",{tag:"div",styles:{position:"fixed",left:"0px",top:"0px",right:"0px",bottom:"0px"}}),Ze("components",[])],name:"blocker"})]),Xa=Object.freeze({__proto__:null,block:function(e,t,n,o){Qt(e.element,"aria-busy",!0);var r=t.getRoot(e).getOr(e),i=gc([Rd.config({mode:"special",onTab:function(){return G.some(!0)},onShiftTab:function(){return G.some(!0)}}),Fd.config({})]),i=o(r,i),u=r.getSystem().build(i);Id.append(r,au(u)),u.hasConfigured(Rd)&&Rd.focusIn(u),n.isBlocked()||t.onBlock(e),n.blockWith(function(){return Id.remove(r,u)})},unblock:function(e,t,n){nn(e.element,"aria-busy"),n.isBlocked()&&t.onUnblock(e),n.clear()}}),bo=[nt("getRoot",G.none),Ka("onBlock"),Ka("onUnblock")],E_=ya({fields:bo,name:"blocking",apis:Xa,state:Object.freeze({__proto__:null,init:function(){var t=BC();return qi({readState:t.isSet,blockWith:function(e){t.set({destroy:e})},clear:t.clear,isBlocked:t.isSet})}})}),T_=yc({name:"ModalDialog",configFields:si(),partFields:z(),factory:function(i,e,t,o){var r=it(G.none()),n=un("modal-events"),u=A(A({},i.eventOrder),((u={})[ui()]=[n].concat(i.eventOrder["alloy.system.attached"]||[]),u));return{uid:i.uid,dom:i.dom,components:e,apis:{show:function(e){r.set(G.some(e));var t=i.lazySink(e).getOrDie(),n=o.blocker(),n=t.getSystem().build(A(A({},n),{components:n.components.concat([au(e)]),behaviours:gc([Fd.config({}),id("dialog-blocker-events",[Rt(Mr(),function(){Rd.focusIn(e)})])])}));ys(t,n),Rd.focusIn(e)},hide:function(t){r.set(G.none()),Vt(t.element).each(function(e){t.getSystem().getByDom(e).each(function(e){ws(e)})})},getBody:function(e){return $s(e,i,"body")},getFooter:function(e){return $s(e,i,"footer")},setIdle:function(e){E_.unblock(e)},setBusy:function(e,t){E_.block(e,t)}},eventOrder:u,domModification:{attributes:{role:"dialog","aria-modal":"true"}},behaviours:Rs(i.modalBehaviours,[Id.config({}),Rd.config({mode:"cyclic",onEnter:i.onExecute,onEscape:i.onEscape,useTabstopAt:i.useTabstopAt}),E_.config({getRoot:r.get}),id(n,[bi(function(e){var t,n,o,r;t=e.element,n=$s(e,i,"title").element,o=en(t,"id").fold(function(){var e=un("dialog-label");return Qt(n,"id",e),e},l),Qt(t,"aria-labelledby",o),o=e.element,r=$s(e,i,"body").element,e=G.from(Zt(o,"id")).fold(function(){var e=un("dialog-describe");return Qt(r,"id",e),e},l),Qt(o,"aria-describedby",e)})])])}},apis:{show:function(e,t){e.show(t)},hide:function(e,t){e.hide(t)},getBody:function(e,t){return e.getBody(t)},getFooter:function(e,t){return e.getFooter(t)},setBusy:function(e,t,n){e.setBusy(t,n)},setIdle:function(e,t){e.setIdle(t)}}}),$a=No([Ue("type"),Ue("name")].concat(Ci)),qo=Xo,tc=[Po("name","name",_o(function(){return un("button-name")}),$o),Je("icon"),tr("align","end",["start","end"]),nr("primary",!1),nr("disabled",!1)],Ja=h(tc,[Ue("text")]),Za=h([We("type",["submit","cancel","custom"])],Ja),or=h([We("type",["menu"]),Je("text"),Je("tooltip"),Je("icon"),$e("items",$a)],tc),xo=Ve("type",{submit:Za,cancel:Za,custom:Za,menu:or}),bo=[Ue("type"),Ue("text"),We("level",["info","warn","error","success"]),Ue("icon"),Ze("url","")],D_=No(bo),Xa=[Ue("type"),Ue("text"),nr("disabled",!1),nr("primary",!1),Po("name","name",_o(function(){return un("button-name")}),$o),Je("icon"),nr("borderless",!1)],A_=No(Xa),si=[Ue("type"),Ue("name"),Ue("label"),nr("disabled",!1)],B_=No(si),z=Xo,Ci=[Ue("type"),Ue("name")],$a=Ci.concat([Je("label")]),tc=$a.concat([Ze("columns","auto")]),N_=No(tc),Za=Vo([Ue("value"),Ue("text"),Ue("icon")]),R_=No($a),or=$o,M_=No($a),bo=$o,I_=Ci.concat([tt("tag","textarea"),Ue("scriptId"),Ue("scriptUrl"),et("settings",void 0,Jo)]),F_=Ci.concat([tt("tag","textarea"),Qo("init")]),P_=Ie(function(e){return Fe("customeditor.old",Ae(F_),e).orThunk(function(){return Fe("customeditor.new",Ae(I_),e)})}),Xa=$o,L_=No($a),si=Be(Lo),tc=[Ue("type"),Ue("html"),tr("presets","presentation",["presentation","document"])],V_=No(tc),Vo=$a.concat([nr("sandboxed",!0)]),H_=No(Vo),Ci=$o,Qo=$a.concat([je("currentState",No([ze("blob"),Ue("url")]))]),z_=No(Qo),tc=$a.concat([Je("inputMode"),Je("placeholder"),nr("maximized",!1),nr("disabled",!1)]),j_=No(tc),Vo=$o,Qo=[Ue("text"),Ue("value")],tc=[Ue("text"),$e("items",(O_=function(){return U_},__=ve(function(){return O_()}),{extract:function(e,t,n){return __().extract(e,t,n)},toString:function(){return __().toString()}}))],U_=Ro([No(Qo),No(tc)]),Ro=$a.concat([$e("items",U_),nr("disabled",!1)]),W_=No(Ro),Qo=$o,tc=$a.concat([Ge("items",[Ue("text"),Ue("value")]),er("size",1),nr("disabled",!1)]),q_=No(tc),Ro=$o,er=$a.concat([nr("constrain",!0),nr("disabled",!1)]),G_=No(er),tc=No([Ue("width"),Ue("height")]),er=[Ue("type"),$e("header",$o),$e("cells",Be($o))],$_=No(er),nr=$a.concat([Je("placeholder"),nr("maximized",!1),nr("disabled",!1)]),X_=No(nr),nr=$o,tr=$a.concat([tr("filetype","file",["image","media","file"]),Ze("disabled",!1)]),Y_=No(tr),tr=No([Ue("value"),Ze("meta",{})]),K_=Ho(function(){return Uo("type",{alertbanner:D_,bar:No((e=VO("bar"),[Ue("type"),e])),button:A_,checkbox:B_,colorinput:R_,colorpicker:M_,dropzone:L_,grid:No(LO(VO("grid"))),iframe:H_,input:j_,listbox:W_,selectbox:q_,sizeinput:G_,textarea:X_,urlinput:Y_,customeditor:P_,htmlpanel:V_,imagetools:z_,collection:N_,label:No((e=VO("label"),[Ue("type"),Ue("label"),e])),table:$_,panel:J_});var e}),Ho=[Ue("type"),Ze("classes",[]),$e("items",K_)],J_=No(Ho),_o=[Po("name","name",_o(function(){return un("tab-name")}),$o),Ue("title"),$e("items",K_)],_o=[Ue("type"),Ge("tabs",_o)],_o=No(_o),Ja=Ja,xo=xo,Q_=No([Ue("title"),je("body",Uo("type",{panel:J_,tabpanel:_o})),tt("size","normal"),$e("buttons",xo),Ze("initialData",{}),nt("onAction",W),nt("onChange",W),nt("onSubmit",W),nt("onClose",W),nt("onCancel",W),Ze("onTabChange",W)]),Z_=No(h([We("type",["cancel","custom"])],Ja)),eE=No([Ue("title"),Ue("url"),Ke("height"),Ke("width"),Ye("buttons",Be(Z_)),nt("onAction",W),nt("onCancel",W),nt("onClose",W),nt("onMessage",W)]),tE=function(e){return $(e)?[e].concat(T(pe(e),tE)):X(e)?T(e,tE):[]},nE={checkbox:z,colorinput:or,colorpicker:bo,dropzone:si,input:Vo,iframe:Ci,sizeinput:tc,selectbox:Ro,listbox:Qo,size:tc,textarea:nr,urlinput:tr,customeditor:Xa,collection:Za,togglemenuitem:qo},oE={open:function(e,t){t=jO(t);return e(t.internalDialog,t.initialData,t.dataValidator)},openUrl:function(e,t){return e(Pe(Fe("dialog",eE,t)))},redial:jO},qo=zl({name:"TabButton",configFields:[Ze("uid",void 0),ze("value"),Po("dom","dom",Eo(function(){return{attributes:{role:"tab",id:un("aria"),"aria-selected":"false"}}}),Wo()),Xe("action"),Ze("domModification",{}),Wr("tabButtonBehaviours",[Fd,Rd,El]),ze("view")],factory:function(e,t){return{uid:e.uid,dom:e.dom,components:e.components,events:gd(e.action),behaviours:Rs(e.tabButtonBehaviours,[Fd.config({}),Rd.config({mode:"execution",useSpace:!0,useEnter:!0}),El.config({store:{mode:"memory",initialValue:e.value}})]),domModification:e.domModification}}}),Ya=q([ze("tabs"),ze("dom"),Ze("clickToDismiss",!1),Wr("tabbarBehaviours",[hf,Rd]),Ya(["tabClass","selectedClass"])]),qo=kr({factory:qo,name:"tabs",unit:"tab",overrides:function(o){function r(e,t){hf.dehighlight(e,t),wt(e,mi(),{tabbar:e,button:t})}function i(e,t){hf.highlight(e,t),wt(e,di(),{tabbar:e,button:t})}return{action:function(e){var t=e.getSystem().getByUid(o.uid).getOrDie(),n=hf.isHighlighted(t,e);(n&&o.clickToDismiss?r:n?W:i)(t,e)},domModification:{classes:[o.markers.tabClass]}}}}),qo=q([qo]),rE=yc({name:"Tabbar",configFields:Ya(),partFields:qo(),factory:function(e,t,n,o){return{uid:e.uid,dom:e.dom,components:t,"debug.sketcher":"Tabbar",domModification:{attributes:{role:"tablist"}},behaviours:Rs(e.tabbarBehaviours,[hf.config({highlightClass:e.markers.selectedClass,itemClass:e.markers.tabClass,onHighlight:function(e,t){Qt(t.element,"aria-selected","true")},onDehighlight:function(e,t){Qt(t.element,"aria-selected","false")}}),Rd.config({mode:"flow",getInitial:function(e){return hf.getHighlighted(e).map(function(e){return e.element})},selector:"."+e.markers.tabClass,executeOnMove:!0})])}}}),qo=zl({name:"Tabview",configFields:[Wr("tabviewBehaviours",[Id])],factory:function(e,t){return{uid:e.uid,dom:e.dom,behaviours:Rs(e.tabviewBehaviours,[Id.config({})]),domModification:{attributes:{role:"tabpanel"}}}}}),Ka=q([Ze("selectFirst",!0),Ka("onChangeTab"),Ka("onDismissTab"),Ze("tabs",[]),Wr("tabSectionBehaviours",[])]),Wr=Fl({factory:rE,schema:[ze("dom"),qe("markers",[ze("tabClass"),ze("selectedClass")])],name:"tabbar",defaults:function(e){return{tabs:e.tabs}}}),qo=Fl({factory:qo,name:"tabview"}),qo=q([Wr,qo]),iE=yc({name:"TabSection",configFields:Ka(),partFields:qo(),factory:function(r,e,t,n){function o(e,t){Gs(e,r,"tabbar").each(function(e){t(e).each(Ct)})}return{uid:r.uid,dom:r.dom,components:e,behaviours:r.tabSectionBehaviours.dump,events:vi(B([r.selectFirst?[bi(function(e,t){o(e,hf.getFirst)})]:[],[Et(di(),function(e,t){var n,o,t=t.event.button;n=t,o=El.getValue(n),Gs(n,r,"tabview").each(function(t){_(r.tabs,function(e){return e.value===o}).each(function(e){e=e.view();en(n.element,"id").each(function(e){Qt(t.element,"aria-labelledby",e)}),Id.set(t,e),r.onChangeTab(t,n,e)})})}),Et(mi(),function(e,t){t=t.event.button;r.onDismissTab(e,t)})]])),apis:{getViewItems:function(e){return Gs(e,r,"tabview").map(function(e){return Id.contents(e)}).getOr([])},showTab:function(e,n){o(e,function(t){var e=hf.getCandidates(t);return _(e,function(e){return El.getValue(e)===n}).filter(function(e){return!hf.isHighlighted(t,e)})})}}}},apis:{getViewItems:function(e,t){return e.getViewItems(t)},showTab:function(e,t,n){e.showTab(t,n)}}}),uE="send-data-to-section",aE="send-data-to-view",cE=un("update-dialog"),sE=un("update-title"),lE=un("update-body"),fE=un("update-footer"),dE=un("body-send-message"),mE=Vp.deviceType.isTouch(),gE=function(i,e){function t(e,r){return Et(e,function(n,o){u(n,function(e,t){r(i(),e,o.event,n)})})}var u=function(t,n){fC.getState(t).get().each(function(e){n(e,t)})};return h(d_(t,e),[t(Cv,function(e,t,n){t.onAction(e,{name:n.name})})])},pE=function(i,e,c){function t(e,r){return Et(e,function(n,o){u(n,function(e,t){r(i(),e,o.event,n)})})}var u=function(t,n){fC.getState(t).get().each(function(e){n(e.internalDialog,t)})};return h(d_(t,e),[t(Sv,function(e,t){return t.onSubmit(e)}),t(yv,function(e,t,n){t.onChange(e,{name:n.name})}),t(Cv,function(e,t,n,o){function r(){return Rd.focusIn(o)}function i(e){return tn(e,"disabled")||en(e,"aria-disabled").exists(function(e){return"true"===e})}var u=Ji(o.element),a=wa(u);t.onAction(e,{name:n.name,value:n.value}),wa(u).fold(r,function(t){i(t)||a.exists(function(e){return gt(t,e)&&i(e)})?r():c().toOptional().filter(function(e){return!gt(e.element,t)}).each(r)})}),t(_v,function(e,t,n){t.onTabChange(e,{newTabName:n.name,oldTabName:n.oldName})}),yi(function(e){var t=i();El.setValue(e,t.getData())})])},hE=g_,vE=tinymce.util.Tools.resolve("tinymce.util.URI"),bE=["insertContent","setContent","execCommand","close","block","unblock"];e.add("silver",function(e){var t=PO(e),n=t.uiMothership,o=t.backstage,r=t.renderUI,t=t.getUi;Lh(e,o.shared);e=k_({editor:e,backstage:o});return{renderUI:r,getWindowManagerImpl:q(e),getNotificationManagerImpl:function(){return um(0,{backstage:o},n)},ui:t()}})}(),function(){"use strict";var y=function(){return(y=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)};function o(e,t){var n={};for(r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var o=0,r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]]);return n}function u(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;for(var o=Array(e),r=0,t=0;t<n;t++)for(var i=arguments[t],u=0,a=i.length;u<a;u++,r++)o[r]=i[u];return o}function v(){}function i(n,o){return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return n(o.apply(null,e))}}function b(e){return function(){return e}}function h(e){return e}function x(o){for(var r=[],e=1;e<arguments.length;e++)r[e-1]=arguments[e];return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=r.concat(e);return o.apply(null,n)}}function d(t){return function(e){return!t(e)}}function a(e){return function(){throw new Error(e)}}function r(e){return e()}function s(n){var o,r=!1;return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return r||(r=!0,o=n.apply(null,e)),o}}var c=b(!1),w=b(!0),e=function(){return l},l={fold:function(e,t){return e()},is:c,isSome:c,isNone:w,getOr:f,getOrThunk:n,getOrDie:function(e){throw new Error(e||"error: getOrDie called on none.")},getOrNull:b(null),getOrUndefined:b(void 0),or:f,orThunk:n,map:e,each:v,bind:e,exists:c,forall:w,filter:e,equals:t,equals_:t,toArray:function(){return[]},toString:b("none()")};function t(e){return e.isNone()}function n(e){return e()}function f(e){return e}function m(e){return!(null==e)}function C(e,t){return-1<Ue.call(e,t)}function g(e,t){for(var n=0,o=e.length;n<o;n++)if(t(e[n],n))return!0;return!1}function S(e,t){for(var n=e.length,o=new Array(n),r=0;r<n;r++){var i=e[r];o[r]=t(i,r)}return o}function k(e,t){for(var n=0,o=e.length;n<o;n++)t(e[n],n)}function O(e,t){for(var n=[],o=0,r=e.length;o<r;o++){var i=e[o];t(i,o)&&n.push(i)}return n}function p(e,t,n){return function(e,t){for(var n=e.length-1;0<=n;n--)t(e[n],n)}(e,function(e){n=t(n,e)}),n}function _(e,t,n){return k(e,function(e){n=t(n,e)}),n}function E(e,t){return function(e,t,n){for(var o=0,r=e.length;o<r;o++){var i=e[o];if(t(i,o))return Re.some(i);if(n(i,o))break}return Re.none()}(e,t,c)}function T(e,t){for(var n=0,o=e.length;n<o;n++)if(t(e[n],n))return Re.some(n);return Re.none()}function D(e){for(var t=[],n=0,o=e.length;n<o;++n){if(!Le(e[n]))throw new Error("Arr.flatten item "+n+" was not an array, input: "+e);We.apply(t,e[n])}return t}function A(e,t){return D(S(e,t))}function B(e,t){for(var n=0,o=e.length;n<o;++n)if(!0!==t(e[n],n))return!1;return!0}function N(e){return(e=je.call(e,0)).reverse(),e}function R(e,t){return O(e,function(e){return!C(t,e)})}function M(e){return[e]}function I(e){return t=e,(e=0)<=e&&e<t.length?Re.some(t[e]):Re.none();var t}function F(e,t){for(var n=0;n<e.length;n++){var o=t(e[n],n);if(o.isSome())return o}return Re.none()}function P(e,t){var n=String(t).toLowerCase();return E(e,function(e){return e.search(n)})}function L(e,t){return-1!==e.indexOf(t)}function V(e){return window.matchMedia(e).matches}function H(e,t){Vt(e,e.element,t,{})}function z(e,t,n){Vt(e,e.element,t,n)}function j(e){H(e,Dt())}function U(e,t,n){Vt(e,t,n,{})}function W(e,t){if(1!==(e=e.dom).nodeType)return!1;if(void 0!==e.matches)return e.matches(t);if(void 0!==e.msMatchesSelector)return e.msMatchesSelector(t);if(void 0!==e.webkitMatchesSelector)return e.webkitMatchesSelector(t);if(void 0!==e.mozMatchesSelector)return e.mozMatchesSelector(t);throw new Error("Browser lacks native selectors")}function q(e){return 1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType||0===e.childElementCount}function G(e,t){return t=void 0===t?document:t.dom,q(t)?[]:S(t.querySelectorAll(e),zt.fromDom)}function $(e,t){return t=void 0===t?document:t.dom,q(t)?Re.none():Re.from(t.querySelector(e)).map(zt.fromDom)}function X(e,t){return e.dom===t.dom}function Y(e){return e.dom.nodeName.toLowerCase()}function K(e){return zt.fromDom(e.dom.ownerDocument)}function J(e){return qt(e)?e:K(e)}function Q(e){return Re.from(e.dom.parentNode).map(zt.fromDom)}function Z(e,t){return e=e.dom.childNodes,Re.from(e[t]).map(zt.fromDom)}function ee(t,n){Q(t).each(function(e){e.dom.insertBefore(n.dom,t.dom)})}function te(e,t){Re.from(e.dom.nextSibling).map(zt.fromDom).fold(function(){Q(e).each(function(e){Xt(e,t)})},function(e){ee(e,t)})}function ne(t,n){Z(t,0).fold(function(){Xt(t,n)},function(e){t.dom.insertBefore(n.dom,e.dom)})}function oe(t,e){k(e,function(e){Xt(t,e)})}function re(e){e.dom.textContent="",k($t(e),function(e){Yt(e)})}function ie(e){return e=Qt(e),Gt(e)?Re.some(e):Re.none()}function ue(e){return zt.fromDom(e.dom.host)}function ae(){return tn(zt.fromDom(document))}function ce(e,t){Xt(e.element,t.element)}function se(t,e){var n,o=t.components();k((n=t).components(),function(e){return Yt(e.element)}),re(n.element),n.syncComponents(),o=R(o,e),k(o,function(e){nn(e),t.getSystem().removeFromWorld(e)}),k(e,function(e){e.getSystem().isConnected()?ce(t,e):(t.getSystem().addToWorld(e),ce(t,e),en(t.element)&&on(e)),t.syncComponents()})}function le(t){var e,n=Q(t.element).bind(function(e){return t.getSystem().getByDom(e).toOptional()});nn(e=t),Yt(e.element),e.getSystem().removeFromWorld(e),n.each(function(e){e.syncComponents()})}function fe(e,n){return ln(e,function(e,t){return{k:t,v:n(e,t)}})}function de(e,t){var n,o,r,i,u={};return n=t,i=u,o=function(e,t){i[t]=e},r=v,sn(e,function(e,t){(n(e,t)?o:r)(e,t)}),u}function me(e,t){return mn(e,t)&&void 0!==e[t]&&null!==e[t]}function ge(e,t,n){if(!(Fe(n)||Ve(n)||ze(n)))throw console.error("Invalid call to Attribute.set. Key ",t,":: Value ",n,":: Element ",e),new Error("Attribute value was not simple");e.setAttribute(t,n+"")}function pe(e,t,n){ge(e.dom,t,n)}function he(e,t){var n=e.dom;sn(t,function(e,t){ge(n,t,e)})}function ve(e,t){return null===(t=e.dom.getAttribute(t))?void 0:t}function be(e,t){return Re.from(ve(e,t))}function ye(e,t){return!(!(e=e.dom)||!e.hasAttribute)&&e.hasAttribute(t)}function xe(e,t){e.dom.removeAttribute(t)}function we(e,t){return void 0===(t=ve(e,t))||""===t?[]:t.split(" ")}function Ce(e){return void 0!==e.dom.classList}function Se(e,t){return function(e,t,n){n=we(e,t).concat([n]);return pe(e,t,n.join(" ")),!0}(e,"class",t)}function ke(e,t){return o=t,0<(e=O(we(n=e,t="class"),function(e){return e!==o})).length?pe(n,t,e.join(" ")):xe(n,t),0;var n,o}function Oe(e,t){Ce(e)?e.dom.classList.add(t):Se(e,t)}function _e(e){0===(Ce(e)?e.dom.classList:we(e,"class")).length&&xe(e,"class")}function Ee(e,t){Ce(e)?e.dom.classList.remove(t):ke(e,t),_e(e)}function Te(e,t){return Ce(e)&&e.dom.classList.contains(t)}function De(e,t,n){Ee(e,n),Oe(e,t)}var Ae,Be,Ne=function(n){function e(){return r}function t(e){return e(n)}var o=b(n),r={fold:function(e,t){return t(n)},is:function(e){return n===e},isSome:w,isNone:c,getOr:o,getOrThunk:o,getOrDie:o,getOrNull:o,getOrUndefined:o,or:e,orThunk:e,map:function(e){return Ne(e(n))},each:function(e){e(n)},bind:t,exists:t,forall:t,filter:function(e){return e(n)?r:l},toArray:function(){return[n]},toString:function(){return"some("+n+")"},equals:function(e){return e.is(n)},equals_:function(e,t){return e.fold(c,function(e){return t(n,e)})}};return r},Re={some:Ne,none:e,from:function(e){return null==e?l:Ne(e)}},Me=function(n){return function(e){return e=typeof(t=e),(null===t?"null":"object"==e&&(Array.prototype.isPrototypeOf(t)||t.constructor&&"Array"===t.constructor.name)?"array":"object"==e&&(String.prototype.isPrototypeOf(t)||t.constructor&&"String"===t.constructor.name)?"string":e)===n;var t}},Ie=function(t){return function(e){return typeof e===t}},Fe=Me("string"),Pe=Me("object"),Le=Me("array"),Ve=Ie("boolean"),He=Ie("function"),ze=Ie("number"),je=Array.prototype.slice,Ue=Array.prototype.indexOf,We=Array.prototype.push,qe=function(){return Ge(0,0)},Ge=function(e,t){return{major:e,minor:t}},$e={nu:Ge,detect:function(e,t){t=String(t).toLowerCase();return 0===e.length?qe():function(e,t){var n=function(e,t){for(var n=0;n<e.length;n++){var o=e[n];if(o.test(t))return o}}(e,t);if(!n)return{major:0,minor:0};e=function(e){return Number(t.replace(n,"$"+e))};return Ge(e(1),e(2))}(e,t)},unknown:qe},Xe=function(e,n){return P(e,n).map(function(e){var t=$e.detect(e.versionRegexes,n);return{current:e.name,version:t}})},Ye=function(e,n){return P(e,n).map(function(e){var t=$e.detect(e.versionRegexes,n);return{current:e.name,version:t}})},Ke=(Ae=/^\s+|\s+$/g,function(e){return e.replace(Ae,"")}),Je=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,Qe=function(t){return function(e){return L(e,t)}},Ze=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(e){return L(e,"edge/")&&L(e,"chrome")&&L(e,"safari")&&L(e,"applewebkit")}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,Je],search:function(e){return L(e,"chrome")&&!L(e,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(e){return L(e,"msie")||L(e,"trident")}},{name:"Opera",versionRegexes:[Je,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:Qe("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:Qe("firefox")},{name:"Safari",versionRegexes:[Je,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(e){return(L(e,"safari")||L(e,"mobile/"))&&L(e,"applewebkit")}}],et=[{name:"Windows",search:Qe("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(e){return L(e,"iphone")||L(e,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:Qe("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:Qe("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:Qe("linux"),versionRegexes:[]},{name:"Solaris",search:Qe("sunos"),versionRegexes:[]},{name:"FreeBSD",search:Qe("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:Qe("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],tt={browsers:b(Ze),oses:b(et)},nt=function(e){var t=e.current,n=e.version,e=function(e){return function(){return t===e}};return{current:t,version:n,isEdge:e("Edge"),isChrome:e("Chrome"),isIE:e("IE"),isOpera:e("Opera"),isFirefox:e("Firefox"),isSafari:e("Safari")}},ot={unknown:function(){return nt({current:void 0,version:$e.unknown()})},nu:nt,edge:b("Edge"),chrome:b("Chrome"),ie:b("IE"),opera:b("Opera"),firefox:b("Firefox"),safari:b("Safari")},rt=function(e){var t=e.current,n=e.version,e=function(e){return function(){return t===e}};return{current:t,version:n,isWindows:e("Windows"),isiOS:e("iOS"),isAndroid:e("Android"),isOSX:e("OSX"),isLinux:e("Linux"),isSolaris:e("Solaris"),isFreeBSD:e("FreeBSD"),isChromeOS:e("ChromeOS")}},it={unknown:function(){return rt({current:void 0,version:$e.unknown()})},nu:rt,windows:b("Windows"),ios:b("iOS"),android:b("Android"),linux:b("Linux"),osx:b("OSX"),solaris:b("Solaris"),freebsd:b("FreeBSD"),chromeos:b("ChromeOS")},ut=function(e,t){var n,o,r=tt.browsers(),i=tt.oses(),u=Xe(r,e).fold(ot.unknown,ot.nu),a=Ye(i,e).fold(it.unknown,it.nu);return{browser:u,os:a,deviceType:(n=u,o=e,r=t,u=(i=a).isiOS()&&!0===/ipad/i.test(o),e=i.isiOS()&&!u,t=i.isiOS()||i.isAndroid(),a=t||r("(pointer:coarse)"),r=u||!e&&t&&r("(min-device-width:768px)"),t=e||t&&!r,o=n.isSafari()&&i.isiOS()&&!1===/safari/i.test(o),{isiPad:b(u),isiPhone:b(e),isTablet:b(r),isPhone:b(t),isTouch:b(a),isAndroid:i.isAndroid,isiOS:i.isiOS,isWebView:b(o),isDesktop:b(!t&&!r&&!o)})}},at=s(function(){return ut(navigator.userAgent,V)}),ct=b,st=ct("touchstart"),lt=ct("touchmove"),ft=ct("touchend"),dt=ct("mousedown"),mt=ct("mousemove"),gt=ct("mouseup"),pt=ct("mouseover"),ht=ct("keydown"),vt=ct("keyup"),bt=ct("input"),yt=ct("change"),xt=ct("click"),wt=ct("transitionend"),Ct=ct("selectstart"),St=function(e){return b("alloy."+e)},kt={tap:St("tap")},Ot=St("focus"),_t=St("blur.post"),Et=St("paste.post"),Tt=St("receive"),Dt=St("execute"),At=St("focus.item"),Bt=kt.tap,Nt=St("longpress"),Rt=St("system.init"),Mt=St("system.attached"),It=St("system.detached"),Ft=St("focusmanager.shifted"),Pt=St("highlight"),Lt=St("dehighlight"),Vt=function(e,t,n,o){o=y({target:t},o);e.getSystem().triggerEvent(n,t,o)},Ht=function(e){if(null==e)throw new Error("Node cannot be null or undefined");return{dom:e}},zt={fromHtml:function(e,t){t=(t||document).createElement("div");if(t.innerHTML=e,!t.hasChildNodes()||1<t.childNodes.length)throw console.error("HTML does not have a single root node",e),new Error("HTML must have a single root node");return Ht(t.childNodes[0])},fromTag:function(e,t){e=(t||document).createElement(e);return Ht(e)},fromText:function(e,t){e=(t||document).createTextNode(e);return Ht(e)},fromDom:Ht,fromPoint:function(e,t,n){return Re.from(e.dom.elementFromPoint(t,n)).map(Ht)}},jt=("undefined"!=typeof window||Function("return this;")(),function(t){return function(e){return e.dom.nodeType===t}}),Ut=jt(1),Wt=jt(3),qt=jt(9),Gt=jt(11),$t=function(e){return S(e.dom.childNodes,zt.fromDom)},Xt=function(e,t){e.dom.appendChild(t.dom)},Yt=function(e){e=e.dom;null!==e.parentNode&&e.parentNode.removeChild(e)},Kt=He(Element.prototype.attachShadow)&&He(Node.prototype.getRootNode),Jt=b(Kt),Qt=Kt?function(e){return zt.fromDom(e.dom.getRootNode())}:J,Zt=function(e){return m(e.dom.shadowRoot)},en=function(e){var t=Wt(e)?e.dom.parentNode:e.dom;if(null==t||null===t.ownerDocument)return!1;var n,o,r=t.ownerDocument;return ie(zt.fromDom(t)).fold(function(){return r.body.contains(t)},(n=en,o=ue,function(e){return n(o(e))}))},tn=function(e){e=e.dom.body;if(null==e)throw new Error("Body is not available yet");return zt.fromDom(e)},nn=function(e){H(e,It());e=e.components();k(e,nn)},on=function(e){var t=e.components();k(t,on),H(e,Mt())},rn=function(e,t,n){e.getSystem().addToWorld(t),n(e.element,t.element),en(e.element)&&on(t),e.syncComponents()},un=function(e,t,n){n(e,t.element);e=$t(t.element);k(e,function(e){t.getByDom(e).each(on)})},an=Object.keys,cn=Object.hasOwnProperty,sn=function(e,t){for(var n=an(e),o=0,r=n.length;o<r;o++){var i=n[o];t(e[i],i)}},ln=function(e,n){var o={};return sn(e,function(e,t){t=n(e,t);o[t.k]=t.v}),o},fn=function(e,n){var o=[];return sn(e,function(e,t){o.push(n(e,t))}),o},dn=function(e,t){return mn(e,t)?Re.from(e[t]):Re.none()},mn=function(e,t){return cn.call(e,t)},gn=Object.freeze({__proto__:null,toAlpha:function(e,t,n){De(e.element,t.alpha,t.omega)},toOmega:function(e,t,n){De(e.element,t.omega,t.alpha)},isAlpha:function(e,t,n){return Te(e.element,t.alpha)},isOmega:function(e,t,n){return Te(e.element,t.omega)},clear:function(e,t,n){Ee(e.element,t.alpha),Ee(e.element,t.omega)}}),pn=function(n){return{is:function(e){return n===e},isValue:w,isError:c,getOr:b(n),getOrThunk:b(n),getOrDie:b(n),or:function(e){return pn(n)},orThunk:function(e){return pn(n)},fold:function(e,t){return t(n)},map:function(e){return pn(e(n))},mapError:function(e){return pn(n)},each:function(e){e(n)},bind:function(e){return e(n)},exists:function(e){return e(n)},forall:function(e){return e(n)},toOptional:function(){return Re.some(n)}}},hn=function(n){return{is:c,isValue:c,isError:w,getOr:h,getOrThunk:function(e){return e()},getOrDie:function(){return a(String(n))()},or:function(e){return e},orThunk:function(e){return e()},fold:function(e,t){return e(n)},map:function(e){return hn(n)},mapError:function(e){return hn(e(n))},each:v,bind:function(e){return hn(n)},exists:c,forall:w,toOptional:Re.none}},vn={value:pn,error:hn,fromOption:function(e,t){return e.fold(function(){return hn(t)},pn)}};(mi=Be=Be||{})[mi.Error=0]="Error",mi[mi.Value=1]="Value";function bn(e,t,n){return e.stype===Be.Error?t(e.serror):n(e.svalue)}function yn(e){return{stype:Be.Value,svalue:e}}function xn(e){return{stype:Be.Error,serror:e}}function wn(e){return Uo.defaultedThunk(b(e))}function Cn(e,t){var n={};return n[e]=t,n}function Sn(e,t){return n=t,o={},sn(e,function(e,t){C(n,t)||(o[t]=e)}),o;var n,o}function kn(e){return t={},k(e,function(e){t[e.key]=e.value}),t;var t}function On(e,t){var n,o,r;return 0<(r=(n=[],o=[],k(e,function(e){e.fold(function(e){n.push(e)},function(e){o.push(e)})}),{errors:n,values:o})).errors.length?(e=r.errors,vn.error(D(e))):(t=t,0===(r=r.values).length?vn.value(t):vn.value(zo(t,jo.apply(void 0,r))))}function _n(e){return i(Ro,D)(e)}function En(e){return Pe(e)&&100<an(e).length?" removed due to size":JSON.stringify(e,null,2)}function Tn(e,t){return Ro([{path:e,getErrorInfo:t}])}function Dn(n,o,r){return dn(o,r).fold(function(){return e=r,t=o,Tn(n,function(){return'Could not find valid *strict* value for "'+e+'" in '+En(t)});var e,t},Bo)}function An(e,t,n){return t=dn(e,t).fold(function(){return n(e)},h),Bo(t)}function Bn(u,a,e,c){return e.fold(function(n,t,e,o){function r(e){return e=o.extract(u.concat([n]),c,e),Fo(e,function(e){return Cn(t,c(e))})}function i(e){return e.fold(function(){var e=Cn(t,c(Re.none()));return Bo(e)},function(e){e=o.extract(u.concat([n]),c,e);return Fo(e,function(e){return Cn(t,c(Re.some(e)))})})}return e.fold(function(){return Mo(Dn(u,a,n),r)},function(e){return Mo(An(a,n,e),r)},function(){return Mo(Bo(dn(a,n)),i)},function(e){return Mo(function(t,e,n){e=dn(t,e).map(function(e){return!0===e?n(t):e});return Bo(e)}(a,n,e),i)},function(e){var t=e(a),e=Fo(An(a,n,b({})),function(e){return zo(t,e)});return Mo(e,r)})},function(e,t){t=t(a);return Bo(Cn(e,c(t)))})}function Nn(o){return{extract:function(n,e,t){return Io(o(t,e),function(e){return t=e,Tn(n,function(){return t});var t})},toString:function(){return"val"}}}function Rn(e){var i=Qo(e),u=p(e,function(t,e){return e.fold(function(e){return zo(t,Xo(e,!0))},b(t))},{});return{extract:function(e,t,n){var o,r=Ve(n)?[]:an(de(n,function(e){return null!=e})),r=O(r,function(e){return!me(u,e)});return 0===r.length?i.extract(e,t,n):(o=r,Tn(e,function(){return"There are unsupported fields: ["+o.join(", ")+"] specified"}))},toString:i.toString}}function Mn(n,r){function i(e,t){return r=Nn(n),function(n,o,e){e=S(e,function(e,t){return r.extract(n.concat(["["+t+"]"]),o,e)});return Ko(e)}(e,h,t);var r}return{extract:function(t,n,o){var e=an(o),e=i(t,e);return Mo(e,function(e){e=S(e,function(e){return Jo.field(e,e,Wo(),r)});return Qo(e).extract(t,n,o)})},toString:function(){return"setOf("+r.toString()+")"}}}function In(n,t,o,r,i){return dn(r,i).fold(function(){return e=r,t=i,Tn(n,function(){return'The chosen schema: "'+t+'" did not exist in branches: '+En(e)});var e,t},function(e){return e.extract(n.concat(["branch: "+i]),t,o)})}function Fn(r,i){return{extract:function(t,n,o){return dn(o,r).fold(function(){return e=r,Tn(t,function(){return'Choice schema did not contain choice key: "'+e+'"'});var e},function(e){return In(t,n,o,i,e)})},toString:function(){return"chooseOn("+r+"). Possible values: "+an(i)}}}function Pn(t){return Nn(function(e){return t(e).fold(Ro,Bo)})}function Ln(e,t,n){return Ao(function(e,t,n,o){n=t.extract([e],n,o);return Po(n,function(e){return{input:o,errors:e}})}(e,t,h,n))}function Vn(e){return e.fold(function(e){throw new Error(rr(e))},h)}function Hn(e,t,n){return Vn(Ln(e,t,n))}function zn(e,t){return Fn(e,fe(t,Qo))}function jn(e){return tr(e,e,Wo(),Zo())}function Un(e,t){return tr(e,e,Wo(),t)}function Wn(e,t){return tr(e,e,Wo(),Qo(t))}function qn(e){return tr(e,e,qo(),Zo())}function Gn(e,t){return tr(e,e,qo(),t)}function $n(e,t){return Gn(e,Qo(t))}function Xn(e,t){return Gn(e,Rn(t))}function Yn(e,t){return tr(e,e,wn(t),Zo())}function Kn(e,t,n){return tr(e,e,wn(t),n)}function Jn(e,t){return er(e,t)}function Qn(e){return He(e)?e:c}function Zn(e,t){return X(e.element,t.event.target)}function eo(e){if(!me(e,"can")&&!me(e,"abort")&&!me(e,"run"))throw new Error("EventHandler defined by: "+JSON.stringify(e,null,2)+" does not have can, abort, or run!");return Hn("Extracting event.handler",Rn([Yn("can",w),Yn("abort",c),Yn("run",v)]),e)}function to(n){var t,o,r,i,e=(o=function(e){return e.can},function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return _(t,function(e,t){return e&&o(t).apply(void 0,n)},!0)}),u=(r=t=n,i=function(e){return e.abort},function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return _(r,function(e,t){return e||i(t).apply(void 0,n)},!1)});return eo({can:e,abort:u,run:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];k(n,function(e){e.run.apply(void 0,t)})}})}function no(e,t){return{key:e,value:eo({abort:t})}}function oo(e,t){return{key:e,value:eo({run:t})}}function ro(e,n,o){return{key:e,value:eo({run:function(e,t){n.apply(void 0,[e,t].concat(o))}})}}function io(e){return function(n){return{key:e,value:eo({run:function(e,t){Zn(e,t)&&n(e,t)}})}}}function uo(i,t){return oo(i,function(e,r){e.getSystem().getByUid(t).each(function(e){var t,n,o;t=e.element,n=i,o=r,e.getSystem().triggerEvent(n,t,o.event)})})}function ao(e,t,n){return n=t.partUids[n],uo(e,n)}function co(e){return oo(e,function(e,t){t.cut()})}function so(e,t){var n=e.toString(),o=n.indexOf(")")+1,r=n.indexOf("("),i=n.substring(r+1,o-1).split(/,\s*/);return e.toFunctionAnnotation=function(){return{name:t,parameters:gr(i)}},e}function lo(e){return{classes:void 0!==e.classes?e.classes:[],attributes:void 0!==e.attributes?e.attributes:{},styles:void 0!==e.styles?e.styles:{}}}function fo(n,o,r){return dr(function(e,t){r(e,n,o)})}function mo(r,i,u){var e,t,n,o,a,c;return e=function(n){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];var o=[n].concat(e);return n.config({name:b(r)}).fold(function(){throw new Error("We could not find any behaviour configuration for: "+r+". Using API: "+u)},function(e){var t=Array.prototype.slice.call(o,1);return i.apply(void 0,[n,e.config,e.state].concat(t))})},t=u,o=(n=i).toString(),a=o.indexOf(")")+1,n=o.indexOf("("),c=o.substring(n+1,a-1).split(/,\s*/),e.toFunctionAnnotation=function(){return{name:t,parameters:gr(c.slice(0,1).concat(c.slice(3)))}},e}function go(e){return{key:e,value:void 0}}function po(e){var t,n,o,r,i,u=Hn("Creating behaviour: "+e.name,yr,e);return t=u.fields,n=u.name,o=u.active,r=u.apis,i=u.extra,e=u.state,u=Rn(t),t=$n(n,[Xn("config",t)]),pr(u,t,n,o,r,i,e)}function ho(e){var t=e;return{get:function(){return t},set:function(e){t=e}}}function vo(e){return e.dom.focus()}function bo(e){return e.dom.blur()}function yo(e){return void 0===e&&(e=zt.fromDom(document)),Re.from(e.dom.activeElement).map(zt.fromDom)}function xo(t){return yo(Qt(t)).filter(function(e){return t.dom.contains(e.dom)})}function wo(e){return e.dom.innerHTML}function Co(e,t){var n=K(e).dom,o=zt.fromDom(n.createDocumentFragment()),n=function(e,t){t=(t||document).createElement("div");return t.innerHTML=e,$t(zt.fromDom(t))}(t,n);oe(o,n),re(e),Xt(e,o)}function So(e){return t=!1,zt.fromDom(e.dom.cloneNode(t));var t}function ko(e){var t=So(e);return e=t,t=zt.fromTag("div"),e=zt.fromDom(e.dom.cloneNode(!0)),Xt(t,e),wo(t)}var Oo,_o,Eo,To,Do=function(e){return e.fold(xn,yn)},Ao=function(e){return bn(e,vn.error,vn.value)},Bo=yn,No=function(e){var t=[],n=[];return k(e,function(e){bn(e,function(e){return n.push(e)},function(e){return t.push(e)})}),{values:t,errors:n}},Ro=xn,Mo=function(e,t){return e.stype===Be.Value?t(e.svalue):e},Io=function(e,t){return e.stype===Be.Error?t(e.serror):e},Fo=function(e,t){return e.stype===Be.Value?{stype:Be.Value,svalue:t(e.svalue)}:e},Po=function(e,t){return e.stype===Be.Error?{stype:Be.Error,serror:t(e.serror)}:e},Lo=function(u){if(!Le(u))throw new Error("cases must be an array");if(0===u.length)throw new Error("there must be at least one case");var a=[],n={};return k(u,function(e,o){var t=an(e);if(1!==t.length)throw new Error("one and only one name per case");var r=t[0],i=e[r];if(void 0!==n[r])throw new Error("duplicate key detected:"+r);if("cata"===r)throw new Error("cannot have a case named cata (sorry)");if(!Le(i))throw new Error("case arguments must be an array");a.push(r),n[r]=function(){var e=arguments.length;if(e!==i.length)throw new Error("Wrong number of arguments to case "+r+". Expected "+i.length+" ("+i+"), got "+e);for(var n=new Array(e),t=0;t<n.length;t++)n[t]=arguments[t];return{fold:function(){if(arguments.length!==u.length)throw new Error("Wrong number of arguments to fold. Expected "+u.length+", got "+arguments.length);return arguments[o].apply(null,n)},match:function(e){var t=an(e);if(a.length!==t.length)throw new Error("Wrong number of arguments to match. Expected: "+a.join(",")+"\nActual: "+t.join(","));if(!B(a,function(e){return C(t,e)}))throw new Error("Not all branches were specified when using match. Specified: "+t.join(", ")+"\nRequired: "+a.join(", "));return e[r].apply(null,n)},log:function(e){console.log(e,{constructors:a,constructor:r,params:n})}}}}),n},Vo=Object.prototype.hasOwnProperty,Ho=function(u){return function(){for(var e=new Array(arguments.length),t=0;t<e.length;t++)e[t]=arguments[t];if(0===e.length)throw new Error("Can't merge zero objects");for(var n={},o=0;o<e.length;o++){var r,i=e[o];for(r in i)Vo.call(i,r)&&(n[r]=u(n[r],i[r]))}return n}},zo=Ho(function(e,t){return Pe(e)&&Pe(t)?zo(e,t):t}),jo=Ho(function(e,t){return t}),Uo=Lo([{strict:[]},{defaultedThunk:["fallbackThunk"]},{asOption:[]},{asDefaultedOptionThunk:["fallbackThunk"]},{mergeWithThunk:["baseThunk"]}]),Wo=Uo.strict,qo=Uo.asOption,Go=Uo.defaultedThunk,$o=(Uo.asDefaultedOptionThunk,Uo.mergeWithThunk),Xo=(Lo([{bothErrors:["error1","error2"]},{firstError:["error1","value2"]},{secondError:["value1","error2"]},{bothValues:["value1","value2"]}]),Cn),Yo=function(e,t){e=No(e);return 0<e.errors.length?_n(e.errors):(e=e.values,t=t,0<e.length?Bo(zo(t,jo.apply(void 0,e))):Bo(t))},Ko=function(e){e=No(e);return 0<e.errors.length?_n(e.errors):Bo(e.values)},Jo=Lo([{field:["key","okey","presence","prop"]},{state:["okey","instantiator"]}]),Qo=function(o){return{extract:function(e,t,n){return function(t,n,e,o){e=S(e,function(e){return Bn(t,n,e,o)});return Yo(e,{})}(e,n,o,t)},toString:function(){return"obj{\n"+S(o,function(e){return e.fold(function(e,t,n,o){return e+" -> "+o.toString()},function(e,t){return"state("+e+")"})}).join("\n")+"}"}}},Zo=b(Nn(Bo)),er=Jo.state,tr=Jo.field,nr=Nn(Bo),or=function(t,e){return Mn(function(e){return Do(t(e))},e)},rr=function(e){return"Errors: \n"+function(e){e=10<e.length?e.slice(0,10).concat([{path:[],getErrorInfo:function(){return"... (only showing first ten failures)"}}]):e;return S(e,function(e){return"Failed path: ("+e.path.join(" > ")+")\n"+e.getErrorInfo()})}(e.errors).join("\n")+"\n\nInput object: "+En(e.input)},ir=b(nr),ur=(Oo=He,_o="function",Nn(function(e){var t=typeof e;return Oo(e)?Bo(e):Ro("Expected type: "+_o+" but got: "+t)})),ar=[jn("alpha"),jn("omega")],cr=function(e,t,n){var o=t(e),r=Qn(n);return o.orThunk(function(){return r(e)?Re.none():function(e,t,n){for(var o=e.dom,r=Qn(n);o.parentNode;){var o=o.parentNode,i=zt.fromDom(o),u=t(i);if(u.isSome())return u;if(r(i))break}return Re.none()}(e,t,r)})},sr=kn,lr=io(Mt()),fr=io(It()),dr=io(Rt()),mr=(Eo=Dt(),function(e){return oo(Eo,e)}),gr=function(e){return S(e,function(e){return o=n="/*",n=(t=t=e).length-n.length,""===o||t.length>=o.length&&t.substr(n,n+o.length)===o?e.substring(0,e.length-"/*".length):e;var t,n,o})},pr=function(n,e,o,r,t,i,u){function a(e){return me(e,o)?e[o]():Re.none()}var t=fe(t,function(e,t){return mo(o,e,t)}),i=fe(i,so),c=y(y(y({},i),t),{revoke:x(go,o),config:function(e){var t=Hn(o+"-config",n,e);return{key:o,value:{config:t,me:c,configAsRaw:s(function(){return Hn(o+"-config",n,e)}),initialConfig:e,state:u}}},schema:function(){return e},exhibit:function(e,n){return a(e).bind(function(t){return dn(r,"exhibit").map(function(e){return e(n,t.config,t.state)})}).getOr(lo({}))},name:function(){return o},handlers:function(e){return a(e).map(function(e){return dn(r,"events").getOr(function(){return{}})(e.config,e.state)}).getOr({})}});return c},hr={init:function(){return vr({readState:function(){return"No State required"}})}},vr=function(e){return e},br=kn,yr=Rn([jn("fields"),jn("name"),Yn("active",{}),Yn("apis",{}),Yn("state",hr),Yn("extra",{})]),xr=Rn([jn("branchKey"),jn("branches"),jn("name"),Yn("active",{}),Yn("apis",{}),Yn("state",hr),Yn("extra",{})]),wr=b(void 0),Cr=po({fields:ar,name:"swapping",apis:gn}),Sr=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),kr=tinymce.util.Tools.resolve("tinymce.ThemeManager"),Or=[{title:"Headings",items:[{title:"Heading 1",format:"h1"},{title:"Heading 2",format:"h2"},{title:"Heading 3",format:"h3"},{title:"Heading 4",format:"h4"},{title:"Heading 5",format:"h5"},{title:"Heading 6",format:"h6"}]},{title:"Inline",items:[{title:"Bold",icon:"bold",format:"bold"},{title:"Italic",icon:"italic",format:"italic"},{title:"Underline",icon:"underline",format:"underline"},{title:"Strikethrough",icon:"strikethrough",format:"strikethrough"},{title:"Superscript",icon:"superscript",format:"superscript"},{title:"Subscript",icon:"subscript",format:"subscript"},{title:"Code",icon:"code",format:"code"}]},{title:"Blocks",items:[{title:"Paragraph",format:"p"},{title:"Blockquote",format:"blockquote"},{title:"Div",format:"div"},{title:"Pre",format:"pre"}]},{title:"Alignment",items:[{title:"Left",icon:"alignleft",format:"alignleft"},{title:"Center",icon:"aligncenter",format:"aligncenter"},{title:"Right",icon:"alignright",format:"alignright"},{title:"Justify",icon:"alignjustify",format:"alignjustify"}]}],_r=["undo","bold","italic","link","image","bullist","styleselect"],Er="formatChanged",Tr="orientationChanged",Dr="dropupDismissed",Ar=Object.freeze({__proto__:null,events:function(u){return sr([oo(Tt(),function(o,e){var t,r=u.channels,n=an(r),i=e,n=(n=n,(t=i).universal?n:O(n,function(e){return C(t.channels,e)}));k(n,function(e){var t=r[e],n=t.schema,n=Hn("channel["+e+"] data\nReceiver: "+ko(o.element),n,i.data);t.onReceive(o,n)})})])}});(e=To=To||{})[e.STOP=0]="STOP",e[e.NORMAL=1]="NORMAL",e[e.LOGGING=2]="LOGGING";function Br(t,e,n){var o,r,i,u;switch(dn(ti.get(),t).orThunk(function(){var e=an(ti.get());return F(e,function(e){return-1<t.indexOf(e)?Re.some(ti.get()[e]):Re.none()})}).getOr(To.NORMAL)){case To.NORMAL:return n(oi());case To.LOGGING:var a=(o=t,r=e,i=[],u=(new Date).getTime(),{logEventCut:function(e,t,n){i.push({outcome:"cut",target:t,purpose:n})},logEventStopped:function(e,t,n){i.push({outcome:"stopped",target:t,purpose:n})},logNoParent:function(e,t,n){i.push({outcome:"no-parent",target:t,purpose:n})},logEventNoHandlers:function(e,t){i.push({outcome:"no-handlers-left",target:t})},logEventResponse:function(e,t,n){i.push({outcome:"response",purpose:n,target:t})},write:function(){var e=(new Date).getTime();C(["mousemove","mouseover","mouseout",Rt()],o)||console.log(o,{event:o,time:e-u,target:r.dom,sequence:S(i,function(e){return C(["cut","stopped","response"],e.outcome)?"{"+e.purpose+"} "+e.outcome+" at ("+ko(e.target)+")":e.outcome})})}}),c=n(a);return a.write(),c;case To.STOP:return!0}}function Nr(e,t,n){return function(){var e=new Error;if(void 0===e.stack)return;e=e.stack.split("\n");E(e,function(t){return 0<t.indexOf("alloy")&&!g(ni,function(e){return-1<t.indexOf(e)})}).getOr("unknown")}(),tr(t,t,n,Pn(function(n){return vn.value(function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return n.apply(void 0,e)})}))}function Rr(e,t){return Jn(e,b(t))}function Mr(e){return Jn(e,h)}function Ir(e,t,n){(t=t.aria).update(e,t,n.get())}function Fr(t,e,n){e.toggleClass.each(function(e){(n.get()?Oe:Ee)(t.element,e)})}function Pr(e,t,n){ci(e,t,n,!n.get())}function Lr(e,t,n){n.set(!0),Fr(e,t,n),Ir(e,t,n)}function Vr(e,t,n){n.set(!1),Fr(e,t,n),Ir(e,t,n)}function Hr(e,t,n){ci(e,t,n,t.selected)}function zr(n,o){return ai.config({channels:Xo(Er,{onReceive:function(e,t){t.command===n&&o(e,t.state)}})})}function jr(e){return ai.config({channels:Xo(Tr,{onReceive:e})})}function Ur(e,t){return{key:e,value:{onReceive:t}}}function Wr(){function e(e,t){t.stop(),j(e)}return[oo(xt(),e),oo(Bt(),e),co(st()),co(dt())]}function qr(e,t){t.ignore||(vo(e.element),t.onFocus(e))}function Gr(e){return void 0!==e.style&&He(e.style.getPropertyValue)}function $r(e,t,n){if(!Fe(n))throw console.error("Invalid call to CSS.set. Property ",t,":: Value ",n,":: Element ",e),new Error("CSS value must be a string: "+n);Gr(e)&&e.style.setProperty(t,n)}function Xr(e,t,n){e=e.dom,$r(e,t,n)}function Yr(e,t){var n=e.dom;sn(t,function(e,t){$r(n,t,e)})}function Kr(e,t){var n=e.dom,o=window.getComputedStyle(n).getPropertyValue(t);return""!==o||en(e)?o:pi(n,t)}function Jr(e,t){return e=e.dom,t=pi(e,t),Re.from(t).filter(function(e){return 0<e.length})}function Qr(e,t){var n=e.dom;t=t,Gr(n=n)&&n.style.removeProperty(t),be(e,"style").map(Ke).is("")&&xe(e,"style")}function Zr(e){return e.dom.offsetWidth}var ei,ti=ho({}),ni=["alloy/data/Fields","alloy/debugging/Debugging"],oi=b({logEventCut:v,logEventStopped:v,logNoParent:v,logEventNoHandlers:v,logEventResponse:v,write:v}),ri=b([jn("menu"),jn("selectedMenu")]),ii=b([jn("item"),jn("selectedItem")]),ui=(b(Qo(ii().concat(ri()))),b(Qo(ii()))),Me=Wn("initSize",[jn("numColumns"),jn("numRows")]),Ie=function(e){return Nr(0,e,wn(v))},Je=function(e){return Nr(0,e,wn(Re.none))},Qe=function(e){return Nr(0,e,Wo())},Ze=function(e){return Nr(0,e,Wo())},et=b(Me),ct=[Un("channels",or(vn.value,Rn([Qe("onReceive"),Yn("schema",ir())])))],ai=po({fields:ct,name:"receiving",active:Ar}),ci=function(e,t,n,o){(o?Lr:Vr)(e,t,n)},kt=Object.freeze({__proto__:null,onLoad:Hr,toggle:Pr,isOn:function(e,t,n){return n.get()},on:Lr,off:Vr,set:ci}),St=Object.freeze({__proto__:null,exhibit:function(){return lo({})},events:function(e,t){var n,o,r,i=(n=e,o=t,r=Pr,mr(function(e){r(e,n,o)})),t=fo(e,t,Hr);return sr(D([e.toggleOnExecute?[i]:[],[t]]))}}),si=function(e,t,n){pe(e.element,"aria-expanded",n)},jt=[Yn("selected",!1),qn("toggleClass"),Yn("toggleOnExecute",!0),Kn("aria",{mode:"none"},zn("mode",{pressed:[Yn("syncWithExpanded",!1),Rr("update",function(e,t,n){pe(e.element,"aria-pressed",n),t.syncWithExpanded&&si(e,t,n)})],checked:[Rr("update",function(e,t,n){pe(e.element,"aria-checked",n)})],expanded:[Rr("update",si)],selected:[Rr("update",function(e,t,n){pe(e.element,"aria-selected",n)})],none:[Rr("update",v)]}))],li=po({fields:jt,name:"toggling",active:St,apis:kt,state:(ei=!1,{init:function(){var t=ho(ei);return{get:function(){return t.get()},set:function(e){return t.set(e)},clear:function(){return t.set(ei)},readState:function(){return t.get()}}}})}),fi="tinymce-mobile",di=function(e){return fi+"-"+e},Kt=Object.freeze({__proto__:null,focus:qr,blur:function(e,t){t.ignore||bo(e.element)},isFocused:function(e){return t=e.element,e=Qt(t).dom,t.dom===e.activeElement;var t}}),mi=Object.freeze({__proto__:null,exhibit:function(e,t){t=t.ignore?{}:{attributes:{tabindex:"-1"}};return lo(t)},events:function(n){return sr([oo(Ot(),function(e,t){qr(e,n),t.stop()})].concat(n.stopMousedown?[oo(dt(),function(e,t){t.event.prevent()})]:[]))}}),Ho=[Ie("onFocus"),Yn("stopMousedown",!1),Yn("ignore",!1)],gi=po({fields:Ho,name:"focusing",active:mi,apis:Kt}),pi=function(e,t){return Gr(e)?e.style.getPropertyValue(t):""};function hi(n,o){function e(e){var t=o(e);if(t<=0||null===t){e=Kr(e,n);return parseFloat(e)||0}return t}function r(n,e){return _(e,function(e,t){t=Kr(n,t),t=void 0===t?0:parseInt(t,10);return isNaN(t)?e:e+t},0)}return{set:function(e,t){if(!ze(t)&&!t.match(/^[0-9]+$/))throw new Error(n+".set accepts only positive integer values. Value was "+t);e=e.dom;Gr(e)&&(e.style[n]=t+"px")},get:e,getOuter:e,aggregate:r,max:function(e,t,n){n=r(e,n);return n<t?t-n:0}}}function vi(e){return wi.get(e)}function bi(e,t,n){return O(function(e,t){for(var n=He(t)?t:c,o=e.dom,r=[];null!==o.parentNode&&void 0!==o.parentNode;){var i=o.parentNode,u=zt.fromDom(i);if(r.push(u),!0===n(u))break;o=i}return r}(e,n),t)}function yi(e,t){return O(Q(n=e).map($t).map(function(e){return O(e,function(e){return!X(n,e)})}).getOr([]),t);var n}function xi(e,t){return G(t,e)}var wi=hi("height",function(e){var t=e.dom;return en(e)?t.getBoundingClientRect().height:t.offsetHeight});function Ci(e,t,n,o,r){return e(n,o)?Re.some(n):He(r)&&r(n)?Re.none():t(n,o,r)}function Si(e,t,n){for(var o=e.dom,r=He(n)?n:c;o.parentNode;){var o=o.parentNode,i=zt.fromDom(o);if(t(i))return Re.some(i);if(r(i))break}return Re.none()}function ki(e,t,n){return Si(e,function(e){return W(e,t)},n)}function Oi(e,t){return $(t,e)}function _i(e,t,n){return Ci(W,ki,e,t,n)}function Ei(e,t,n){var o=N(e.slice(0,t)),t=N(e.slice(t+1));return E(o.concat(t),n)}function Ti(e,t,n){return t=N(e.slice(0,t)),E(t,n)}function Di(e,t,n){var o=e.slice(0,t),t=e.slice(t+1);return E(t.concat(o),n)}function Ai(e,t,n){return t=e.slice(t+1),E(t,n)}function Bi(t){return function(e){e=e.raw;return C(t,e.which)}}function Ni(e){return function(t){return B(e,function(e){return e(t)})}}function Ri(e){return!0===e.raw.shiftKey}function Mi(e){return!0===e.raw.ctrlKey}function Ii(e,t){return{matches:e,classification:t}}function Fi(e,t,n,o){return o<(t=e+t)?n:t<n?o:t}function Pi(e,t,n){return Math.min(Math.max(e,t),n)}function Li(e){for(var t=[],n=function(e){t.push(e)},o=0;o<e.length;o++)e[o].each(n);return t}function Vi(n,o,e,r){var t=xi(n.element,"."+o.highlightClass);k(t,function(t){g(r,function(e){return e.element===t})||(Ee(t,o.highlightClass),n.getSystem().getByDom(t).each(function(e){o.onDehighlight(n,e),H(e,Lt())}))})}function Hi(e,t,n,o){Vi(e,t,0,[o]),nu(e,t,n,o)||(Oe(o.element,t.highlightClass),t.onHighlight(e,o),H(o,Pt()))}function zi(t,n,e,o){var r=xi(t.element,"."+n.itemClass);return T(r,function(e){return Te(e,n.highlightClass)}).bind(function(e){e=Fi(e,o,0,r.length-1);return t.getSystem().getByDom(r[e]).toOptional()})}function ji(e,t,n){t.exists(function(t){return n.exists(function(e){return X(e,t)})})||z(e,Ft(),{prevFocus:t,newFocus:n})}function Ui(){function o(e){return xo(e.element)}return{get:o,set:function(e,t){var n=o(e);e.getSystem().triggerFocus(t,e.element);t=o(e);ji(e,n,t)}}}function Wi(){function o(e){return au.getHighlighted(e).map(function(e){return e.element})}return{get:o,set:function(t,e){var n=o(t);t.getSystem().getByDom(e).fold(v,function(e){au.highlight(t,e)});e=o(t);ji(t,n,e)}}}var qi,Gi=[8],$i=[9],Xi=[13],Yi=[27],Ki=[32],Ji=[37],Qi=[38],Zi=[39],eu=[40],tu=d(Ri),nu=function(e,t,n,o){return Te(o.element,t.highlightClass)},ou=function(e,t,n,o){t=xi(e.element,"."+t.itemClass);return Re.from(t[o]).fold(function(){return vn.error("No element found with index "+o)},e.getSystem().getByDom)},ru=function(t,e,n){return Oi(t.element,"."+e.itemClass).bind(function(e){return t.getSystem().getByDom(e).toOptional()})},iu=function(t,e,n){e=xi(t.element,"."+e.itemClass);return(0<e.length?Re.some(e[e.length-1]):Re.none()).bind(function(e){return t.getSystem().getByDom(e).toOptional()})},uu=function(t,e,n){e=xi(t.element,"."+e.itemClass);return Li(S(e,function(e){return t.getSystem().getByDom(e).toOptional()}))},nr=Object.freeze({__proto__:null,dehighlightAll:function(e,t,n){return Vi(e,t,0,[])},dehighlight:function(e,t,n,o){nu(e,t,n,o)&&(Ee(o.element,t.highlightClass),t.onDehighlight(e,o),H(o,Lt()))},highlight:Hi,highlightFirst:function(t,n,o){ru(t,n).each(function(e){Hi(t,n,o,e)})},highlightLast:function(t,n,o){iu(t,n).each(function(e){Hi(t,n,o,e)})},highlightAt:function(t,n,o,e){ou(t,n,o,e).fold(function(e){throw new Error(e)},function(e){Hi(t,n,o,e)})},highlightBy:function(t,n,o,e){var r=uu(t,n);E(r,e).each(function(e){Hi(t,n,o,e)})},isHighlighted:nu,getHighlighted:function(t,e,n){return Oi(t.element,"."+e.highlightClass).bind(function(e){return t.getSystem().getByDom(e).toOptional()})},getFirst:ru,getLast:iu,getPrevious:function(e,t,n){return zi(e,t,0,-1)},getNext:function(e,t,n){return zi(e,t,0,1)},getCandidates:uu}),ar=[jn("highlightClass"),jn("itemClass"),Ie("onHighlight"),Ie("onDehighlight")],au=po({fields:ar,name:"highlighting",apis:nr});(gn=qi=qi||{}).OnFocusMode="onFocus",gn.OnEnterOrSpaceMode="onEnterOrSpace",gn.OnApiMode="onApi";function cu(e,t,n,o,a){function c(t,n,e,o,r){var i,e=e(t,n,o,r);return i=n.event,E(e,function(e){return e.matches(i)}).map(function(e){return e.classification}).bind(function(e){return e(t,n,o,r)})}var r={schema:function(){return e.concat([Yn("focusManager",Ui()),Kn("focusInside","onFocus",Pn(function(e){return C(["onFocus","onEnterOrSpace","onApi"],e)?vn.value(e):vn.error("Invalid value for focusInside")})),Rr("handler",r),Rr("state",t),Rr("sendFocusIn",a)])},processKey:c,toEvents:function(i,u){var e=i.focusInside!==qi.OnFocusMode?Re.none():a(i).map(function(n){return oo(Ot(),function(e,t){n(e,i,u),t.stop()})}),t=[oo(ht(),function(o,r){c(o,r,n,i,u).fold(function(){var t,n,e;t=o,n=r,e=Bi(Ki.concat(Xi))(n.event),i.focusInside===qi.OnEnterOrSpaceMode&&e&&Zn(t,n)&&a(i).each(function(e){e(t,i,u),n.stop()})},function(e){r.stop()})}),oo(vt(),function(e,t){c(e,t,o,i,u).each(function(e){t.stop()})})];return sr(e.toArray().concat(t))}};return r}function su(e){return"input"===Y(e)&&"radio"!==ve(e,"type")||"textarea"===Y(e)}function lu(e,t){return Re.some(!0)}function fu(e,t,n){return n.execute(e,t,e.element)}function du(t,n){return function(e){return"rtl"===fa(e)?n:t}}function mu(i){return function(e,t,n,o){var r=i(e.element);return da(r,e,t,n,o)}}function gu(e,t){return t=du(e,t),mu(t)}function pu(e,t){return e=du(t,e),mu(e)}function hu(e){return!((e=e.dom).offsetWidth<=0&&e.offsetHeight<=0)}function vu(e,t,n){var o,n=xi(e,n),n=O(n,hu);return T(o=n,function(e){return X(e,t)}).map(function(e){return{index:e,candidates:o}})}function bu(e,t){return T(e,function(e){return X(t,e)})}function yu(t,e,n,o){return o(Math.floor(e/n),e%n).bind(function(e){e=e.row*n+e.column;return 0<=e&&e<t.length?Re.some(t[e]):Re.none()})}function xu(o,e,r,i,u){return yu(o,e,i,function(e,t){var n=e===r-1?o.length-e*i:i,n=Fi(t,u,0,n-1);return Re.some({row:e,column:n})})}function wu(o,e,r,i,u){return yu(o,e,i,function(e,t){var n=Fi(e,u,0,r-1),e=n===r-1?o.length-n*i:i,e=Pi(t,0,e-1);return Re.some({row:n,column:e})})}function Cu(t,n,e){Oi(t.element,n.selector).each(function(e){n.focusManager.set(t,e)})}function Su(e,t,n,r){var i=function(e,t,n){var o=Fi(t,r,0,n.length-1);return o===e?Re.none():(t=n[o],"button"===Y(t)&&"disabled"===ve(t,"disabled")?i(e,o,n):Re.from(n[o]))};return vu(e,n,t).bind(function(e){var t=e.index,e=e.candidates;return i(t,t,e)})}function ku(t,n,o){return(r=o).focusManager.get(t).bind(function(e){return _i(e,r.selector)}).bind(function(e){return o.execute(t,n,e)});var r}function Ou(t,n,e){n.getInitial(t).orThunk(function(){return Oi(t.element,n.selector)}).each(function(e){n.focusManager.set(t,e)})}function _u(e,t,n){return Su(e,n.selector,t,-1)}function Eu(e,t,n){return Su(e,n.selector,t,1)}function Tu(r){return function(e,t,n,o){return r(e,t,n,o).bind(function(){return n.executeOnMove?ku(e,t,n):Re.some(!0)})}}function Du(e,t,n){return n.onEscape(e,t)}function Au(e,t,n){return Re.from(e[t]).bind(function(e){return Re.from(e[n]).map(function(e){return{rowIndex:t,columnIndex:n,cell:e}})})}function Bu(e,t,n,o){var r=e[t].length,r=Fi(n,o,0,r-1);return Au(e,t,r)}function Nu(e,t,n,o){return n=Fi(n,o,0,e.length-1),o=e[n].length,o=Pi(t,0,o-1),Au(e,n,o)}function Ru(e,t,n,o){var r=e[t].length,r=Pi(n+o,0,r-1);return Au(e,t,r)}function Mu(e,t,n,o){return n=Pi(n+o,0,e.length-1),o=e[n].length,o=Pi(t,0,o-1),Au(e,n,o)}function Iu(t,n,e){n.previousSelector(t).orThunk(function(){var e=n.selectors;return Oi(t.element,e.cell)}).each(function(e){n.focusManager.set(t,e)})}function Fu(t,n,e){Oi(t.element,n.selector).each(function(e){n.focusManager.set(t,e)})}function Pu(e,t,n){return Su(e,n.selector,t,-1)}function Lu(e,t,n){return Su(e,n.selector,t,1)}function Vu(e,t){return y(y({},e.dump),br(t))}function Hu(e){return mn(e,"uiType")}function zu(e,t,n,o){return Hu(n)&&n.uiType===ka?(i=n,u=o,(r=e).exists(function(e){return e!==i.owner})?Oa.single(!0,b(i)):dn(u,i.name).fold(function(){throw new Error("Unknown placeholder component: "+i.name+"\nKnown: ["+an(u)+"]\nNamespace: "+r.getOr("none")+"\nSpec: "+JSON.stringify(i,null,2))},function(e){return e.replace()})):Oa.single(!1,b(n));var r,i,u}function ju(t,n,e,o){var r,i,u,o=fe(o,function(e,t){return o=e,r=!1,{name:b(n=t),required:function(){return o.fold(function(e,t){return e},function(e,t){return e})},used:function(){return r},replace:function(){if(r)throw new Error("Trying to use the same placeholder more than once: "+n);return r=!0,o}};var n,o,r}),e=(r=t,i=n,u=o,A(e,function(e){return _a(r,i,e,u)}));return sn(o,function(e){if(!1===e.used()&&e.required())throw new Error("Placeholder: "+e.name()+" was not found in components list\nNamespace: "+t.getOr("none")+"\nComponents: "+JSON.stringify(n.components,null,2))}),e}function Uu(e){var t=(new Date).getTime();return e+"_"+Math.floor(1e9*Math.random())+ ++Aa+String(t)}function Wu(e){function t(e){return e.name}return e.fold(t,t,t,t)}function qu(e,t,n,o){return zo(t.defaults(e,n,o),n,{uid:e.partUids[t.name]},t.overrides(e,n,o))}function Gu(r,e){var t={};return k(e,function(e){e.fold(Re.some,Re.none,Re.some,Re.some).each(function(n){var o=Ma(r,n.pname);t[n.name]=function(e){var t=Hn("Part: "+n.name+" in "+r,Qo(n.schema),e);return y(y({},o),{config:e,validated:t})}})}),t}function $u(e,t,n){return o=t,i={},r={},k(n,function(e){e.fold(function(o){i[o.pname]=Ea(!0,function(e,t,n){return o.factory.sketch(qu(e,o,t,n))})},function(e){var t=o.parts[e.name];r[e.name]=b(e.factory.sketch(qu(o,e,t[Ra()]),t))},function(o){i[o.pname]=Ea(!1,function(e,t,n){return o.factory.sketch(qu(e,o,t,n))})},function(r){i[r.pname]=Ta(!0,function(t,e,n){var o=t[r.name];return S(o,function(e){return r.factory.sketch(zo(r.defaults(t,e,n),e,r.overrides(t,e)))})})})}),{internals:b(i),externals:b(r)};var o,i,r}function Xu(e,t,n){return ju(Re.some(e),t,t.components,n)}function Yu(e,t,n){return n=t.partUids[n],e.getSystem().getByUid(n).toOptional()}function Ku(e,t,n){return Yu(e,t,n).getOrDie("Could not find part: "+n)}function Ju(t,e){return e=S(e,Wu),kn(S(e,function(e){return{key:e,value:t+"-"+e}}))}function Qu(t){return tr("partUids","partUids",$o(function(e){return Ju(e.uid,t)}),ir())}function Zu(e){return Xo(Ia,e)}function ea(o){return e=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return o.apply(void 0,u([e.getApis(),e],t))},n=(t=o).toString(),r=n.indexOf(")")+1,t=n.indexOf("("),i=n.substring(t+1,r-1).split(/,\s*/),e.toFunctionAnnotation=function(){return{name:"OVERRIDE",parameters:gr(i.slice(1))}},e;var e,t,n,r,i}function ta(e,t,n,o,r){return r=r,r=(0<(o=o).length?[Wn("parts",o)]:[]).concat([jn("uid"),Yn("dom",{}),Yn("components",[]),Mr("originalSpec"),Yn("debug.sketcher",{})]).concat(r),Hn(e+" [SpecSchema]",Rn(r.concat(t)),n)}function na(e,t,n,o,r){var i=za(r),u=A(n,function(e){return e.fold(Re.none,Re.some,Re.none,Re.none).map(function(e){return Wn(e.name,e.schema.concat([Mr(Ra())]))}).toArray()}),r=Qu(n),r=ta(e,t,i,u,[r]),n=$u(0,r,n);return o(r,Xu(e,r,n.internals()),i,n.externals())}var oa,ra,ia,ua,aa,ca,sa,e=function(e){function i(e,t){return e=e.visibilitySelector.bind(function(e){return _i(t,e)}).getOr(t),0<vi(e)}function t(t,n,e){!function(e,t){e=xi(e.element,t.selector),e=O(e,function(e){return i(t,e)});return Re.from(e[t.firstTabstop])}(t,n).each(function(e){n.focusManager.set(t,e)})}function u(t,e,n,o,r){return r(e,n,function(e){return i(t=o,e=e)&&t.useTabstopAt(e);var t}).fold(function(){return o.cyclic?Re.some(!0):Re.none()},function(e){return o.focusManager.set(t,e),Re.some(!0)})}function r(t,e,n,o){var r,i=xi(t.element,n.selector);return(r=n).focusManager.get(t).bind(function(e){return _i(e,r.selector)}).bind(function(e){return T(i,x(X,e)).bind(function(e){return u(t,i,e,n,o)})})}var n=[qn("onEscape"),qn("onEnter"),Yn("selector",'[data-alloy-tabstop="true"]:not(:disabled)'),Yn("firstTabstop",0),Yn("useTabstopAt",w),qn("visibilitySelector")].concat([e]),o=b([Ii(Ni([Ri,Bi($i)]),function(e,t,n){var o=n.cyclic?Ei:Ti;return r(e,0,n,o)}),Ii(Bi($i),function(e,t,n){var o=n.cyclic?Di:Ai;return r(e,0,n,o)}),Ii(Bi(Yi),function(t,n,e){return e.onEscape.bind(function(e){return e(t,n)})}),Ii(Ni([tu,Bi(Xi)]),function(t,n,e){return e.onEnter.bind(function(e){return e(t,n)})})]),e=b([]);return cu(n,hr.init,o,e,function(){return Re.some(t)})},Me=e(Jn("cyclic",c)),ct=e(Jn("cyclic",w)),Ar=function(e,t,n){return su(n)&&Bi(Ki)(t.event)?Re.none():(U(e,n,Dt()),Re.some(!0))},jt=[Yn("execute",Ar),Yn("useSpace",!1),Yn("useEnter",!0),Yn("useControlEnter",!1),Yn("useDown",!1)],St=cu(jt,hr.init,function(e,t,n,o){var r=n.useSpace&&!su(e.element)?Ki:[],i=n.useEnter?Xi:[],e=n.useDown?eu:[],e=r.concat(i).concat(e);return[Ii(Bi(e),fu)].concat(n.useControlEnter?[Ii(Ni([Mi,Bi(Xi)]),fu)]:[])},function(e,t,n,o){return n.useSpace&&!su(e.element)?[Ii(Bi(Ki),lu)]:[]},function(){return Re.none()}),kt=function(){var n=ho(Re.none());return vr({readState:function(){return n.get().map(function(e){return{numRows:String(e.numRows),numColumns:String(e.numColumns)}}).getOr({numRows:"?",numColumns:"?"})},setGridSize:function(e,t){n.set(Re.some({numRows:e,numColumns:t}))},getNumRows:function(){return n.get().map(function(e){return e.numRows})},getNumColumns:function(){return n.get().map(function(e){return e.numColumns})}})},la=Object.freeze({__proto__:null,flatgrid:kt,init:function(e){return e.state(e)}}),fa=function(e){return"rtl"===Kr(e,"direction")?"rtl":"ltr"},Ho=function(r){return function(e,t,n,o){return da(r,e,t,n,o)}},da=function(t,n,e,o,r){return o.focusManager.get(n).bind(function(e){return t(n.element,e,o,r)}).map(function(e){return o.focusManager.set(n,e),!0})},mi=Ho,Kt=Ho,ma=Ho,ar=[jn("selector"),Yn("execute",Ar),Je("onEscape"),Yn("captureTab",!1),et()],nr=function(r){return function(e,t,n,o){return vu(e,t,n.selector).bind(function(e){return r(e.candidates,e.index,o.getNumRows().getOr(n.initSize.numRows),o.getNumColumns().getOr(n.initSize.numColumns))})}},gn=function(e,t,n){return n.captureTab?Re.some(!0):Re.none()},e=nr(function(e,t,n,o){return xu(e,t,n,o,-1)}),jt=nr(function(e,t,n,o){return xu(e,t,n,o,1)}),Ho=nr(function(e,t,n,o){return wu(e,t,n,o,-1)}),nr=nr(function(e,t,n,o){return wu(e,t,n,o,1)}),e=b([Ii(Bi(Ji),gu(e,jt)),Ii(Bi(Zi),pu(e,jt)),Ii(Bi(Qi),mi(Ho)),Ii(Bi(eu),Kt(nr)),Ii(Ni([Ri,Bi($i)]),gn),Ii(Ni([tu,Bi($i)]),gn),Ii(Bi(Yi),function(e,t,n){return n.onEscape(e,t)}),Ii(Bi(Ki.concat(Xi)),function(t,n,o,e){return(r=o).focusManager.get(t).bind(function(e){return _i(e,r.selector)}).bind(function(e){return o.execute(t,n,e)});var r})]),jt=b([Ii(Bi(Ki),lu)]),Ho=cu(ar,kt,e,jt,function(){return Re.some(Cu)}),nr=[jn("selector"),Yn("getInitial",Re.none),Yn("execute",Ar),Je("onEscape"),Yn("executeOnMove",!1),Yn("allowVertical",!0)],gn=b([Ii(Bi(Ki),lu)]),ar=cu(nr,hr.init,function(e,t,n,o){var r=Ji.concat(n.allowVertical?Qi:[]),n=Zi.concat(n.allowVertical?eu:[]);return[Ii(Bi(r),Tu(gu(_u,Eu))),Ii(Bi(n),Tu(pu(_u,Eu))),Ii(Bi(Xi),ku),Ii(Bi(Ki),ku),Ii(Bi(Yi),Du)]},gn,function(){return Re.some(Ou)}),kt=[Wn("selectors",[jn("row"),jn("cell")]),Yn("cycles",!0),Yn("previousSelector",Re.none),Yn("execute",Ar)],e=function(e,t){return function(n,o,i){var u=i.cycles?e:t;return _i(o,i.selectors.row).bind(function(e){var t=xi(e,i.selectors.cell);return bu(t,o).bind(function(o){var r=xi(n,i.selectors.row);return bu(r,e).bind(function(e){var t,n=(t=i,S(r,function(e){return xi(e,t.selectors.cell)}));return u(n,e,o).map(function(e){return e.cell})})})})}},jt=e(function(e,t,n){return Bu(e,t,n,-1)},function(e,t,n){return Ru(e,t,n,-1)}),nr=e(function(e,t,n){return Bu(e,t,n,1)},function(e,t,n){return Ru(e,t,n,1)}),gn=e(function(e,t,n){return Nu(e,n,t,-1)},function(e,t,n){return Mu(e,n,t,-1)}),e=e(function(e,t,n){return Nu(e,n,t,1)},function(e,t,n){return Mu(e,n,t,1)}),nr=b([Ii(Bi(Ji),gu(jt,nr)),Ii(Bi(Zi),pu(jt,nr)),Ii(Bi(Qi),mi(gn)),Ii(Bi(eu),Kt(e)),Ii(Bi(Ki.concat(Xi)),function(t,n,o){return xo(t.element).bind(function(e){return o.execute(t,n,e)})})]),mi=b([Ii(Bi(Ki),lu)]),gn=cu(kt,hr.init,nr,mi,function(){return Re.some(Iu)}),Kt=[jn("selector"),Yn("execute",Ar),Yn("moveOnTab",!1)],e=function(t,n,o){return o.focusManager.get(t).bind(function(e){return o.execute(t,n,e)})},kt=b([Ii(Bi(Qi),ma(Pu)),Ii(Bi(eu),ma(Lu)),Ii(Ni([Ri,Bi($i)]),function(e,t,n,o){return n.moveOnTab?ma(Pu)(e,t,n,o):Re.none()}),Ii(Ni([tu,Bi($i)]),function(e,t,n,o){return n.moveOnTab?ma(Lu)(e,t,n,o):Re.none()}),Ii(Bi(Xi),e),Ii(Bi(Ki),e)]),nr=b([Ii(Bi(Ki),lu)]),mi=cu(Kt,hr.init,kt,nr,function(){return Re.some(Fu)}),Ar=[Je("onSpace"),Je("onEnter"),Je("onShiftEnter"),Je("onLeft"),Je("onRight"),Je("onTab"),Je("onShiftTab"),Je("onUp"),Je("onDown"),Je("onEscape"),Yn("stopSpaceKeyup",!1),qn("focusIn")],e=cu(Ar,hr.init,function(e,t,n){return[Ii(Bi(Ki),n.onSpace),Ii(Ni([tu,Bi(Xi)]),n.onEnter),Ii(Ni([Ri,Bi(Xi)]),n.onShiftEnter),Ii(Ni([Ri,Bi($i)]),n.onShiftTab),Ii(Ni([tu,Bi($i)]),n.onTab),Ii(Bi(Qi),n.onUp),Ii(Bi(eu),n.onDown),Ii(Bi(Ji),n.onLeft),Ii(Bi(Zi),n.onRight),Ii(Bi(Ki),n.onSpace),Ii(Bi(Yi),n.onEscape)]},function(e,t,n){return n.stopSpaceKeyup?[Ii(Bi(Ki),lu)]:[]},function(e){return e.focusIn}),ga=Me.schema(),pa=ct.schema(),ha=ar.schema(),va=Ho.schema(),ba=gn.schema(),ya=St.schema(),xa=mi.schema(),wa=e.schema(),Ca=(sa=Hn("Creating behaviour: "+(oa={branchKey:"mode",branches:Object.freeze({__proto__:null,acyclic:ga,cyclic:pa,flow:ha,flatgrid:va,matrix:ba,execution:ya,menu:xa,special:wa}),name:"keying",active:{events:function(e,t){return e.handler.toEvents(e,t)}},apis:{focusIn:function(t,n,o){n.sendFocusIn(n).fold(function(){t.getSystem().triggerFocus(t.element,t.element)},function(e){e(t,n,o)})},setGridSize:function(e,t,n,o,r){me(n,"setGridSize")?n.setGridSize(o,r):console.error("Layout does not support setGridSize")}},state:la}).name,xr,oa),ra=zn(sa.branchKey,sa.branches),ia=sa.name,ua=sa.active,aa=sa.apis,ca=sa.extra,oa=sa.state,ra=$n(ia,[Gn("config",sa=ra)]),pr(sa,ra,ia,ua,aa,ca,oa)),Kt=function(o,e){return t=o,n={},e=S(e,function(e){return t=e.name(),n="Cannot configure "+e.name()+" for "+o,tr(t,t,qo(),Nn(function(e){return Ro("The field: "+t+" is forbidden. "+n)}));var t,n}).concat([Jn("dump",h)]),Kn(t,n,Qo(e));var t,n},nr=Kt,Sa=Vu,ka="placeholder",Oa=Lo([{single:["required","valueThunk"]},{multiple:["required","valueThunks"]}]),_a=function(o,r,i,u){return zu(o,0,i,u).fold(function(e,t){var n=Hu(i)?t(r,i.config,i.validated):t(r),t=dn(n,"components").getOr([]),t=A(t,function(e){return _a(o,r,e,u)});return[y(y({},n),{components:t})]},function(e,t){if(Hu(i)){var n=t(r,i.config,i.validated);return i.validated.preprocess.getOr(h)(n)}return t(r)})},Ea=Oa.single,Ta=Oa.multiple,Da=b(ka),Aa=0,Je=Lo([{required:["data"]},{external:["data"]},{optional:["data"]},{group:["data"]}]),Ar=Yn("factory",{sketch:h}),Me=Yn("schema",[]),ct=jn("name"),ar=tr("pname","pname",Go(function(e){return"<alloy."+Uu(e.name)+">"}),ir()),Ho=er("schema",function(){return[qn("preprocess")]}),gn=Yn("defaults",b({})),St=Yn("overrides",b({})),mi=Qo([Ar,Me,ct,ar,gn,St]),e=Qo([Ar,Me,ct,gn,St]),kt=Qo([Ar,Me,ct,ar,gn,St]),Go=Qo([Ar,Ho,ct,jn("unit"),ar,gn,St]),Me=function(t,n){return function(e){e=Hn("Converting part type",n,e);return t(e)}},Ba=Me(Je.required,mi),Na=(Me(Je.external,e),Me(Je.optional,kt)),Ar=Me(Je.group,Go),Ra=b("entirety"),Ma=function(e,t){return{uiType:Da(),owner:e,name:t}},Ia=Uu("alloy-premade"),Ho=b("alloy-id-"),ct=b("data-alloy-id"),Fa=Ho(),Pa=ct(),La=function(e,t){Object.defineProperty(e.dom,Pa,{value:t,writable:!0})},Va=function(e){e=Ut(e)?e.dom[Pa]:null;return Re.from(e)},Ha=Uu,za=function(e){return mn(e,"uid")?e:y(y({},e),{uid:Ha("uid")})};function ja(e){var t=zt.fromHtml(e),n=$t(t),o=function(e){e=void 0!==e.dom.attributes?e.dom.attributes:[];return _(e,function(e,t){return"class"===t.name?e:y(y({},e),((e={})[t.name]=t.value,e))},{})}(t),e=Array.prototype.slice.call(t.dom.classList,0),n=0===n.length?{}:{innerHtml:wo(t)};return y({tag:Y(t),classes:e,attributes:o},n)}function Ua(e){var n,e=(n={prefix:fi},e.replace(/\$\{([^{}]*)\}/g,function(e,t){t=n[t];return function(e){e=typeof e;return"string"==e||"number"==e}(t)?t.toString():e}));return ja(e)}function Wa(e){return{dom:Ua(e)}}function qa(e){return br([li.config({toggleClass:di("toolbar-button-selected"),toggleOnExecute:!1,aria:{mode:"pressed"}}),zr(e,function(e,t){(t?li.on:li.off)(e)})])}function Ga(e,t,n,o){return n=qa(n),ls(t,o,n,e)}function $a(e,t){return t=t.ui.registry.getAll().icons,Re.from(t[e]).fold(function(){return Ua('<span class="${prefix}-toolbar-button ${prefix}-toolbar-group-item ${prefix}-icon-'+e+' ${prefix}-icon"></span>')},function(e){return Ua('<span class="${prefix}-toolbar-button ${prefix}-toolbar-group-item">'+e+"</span>")})}function Xa(e,t,n){t.store.manager.onLoad(e,t,n)}function Ya(e,t,n){t.store.manager.onUnload(e,t,n)}function Ka(e,t,n,o){var r=t.store;n.update([o]),r.setValue(e,o),t.onSetValue(e,o)}function Ja(e,t){return ds.set(e,t)}function Qa(e){return ds.get(e)}function Za(e){return-1===(e=e.event.raw).type.indexOf("touch")?void 0!==e.clientX?Re.some(e).map(function(e){return gs(e.clientX,e.clientY)}):Re.none():void 0!==e.touches&&1===e.touches.length?Re.some(e.touches[0]).map(function(e){return gs(e.clientX,e.clientY)}):Re.none()}function ec(e){return e.model.minX}function tc(e){return e.model.minY}function nc(e){return e.model.minX-1}function oc(e){return e.model.minY-1}function rc(e){return e.model.maxX}function ic(e){return e.model.maxY}function uc(e){return e.model.maxX+1}function ac(e){return e.model.maxY+1}function cc(e,t,n){return t(e)-n(e)}function sc(e){return cc(e,rc,ec)}function lc(e){return cc(e,ic,tc)}function fc(e){return sc(e)/2}function dc(e){return lc(e)/2}function mc(e){return e.stepSize}function gc(e){return e.snapToGrid}function pc(e){return e.snapStart}function hc(e){return e.rounded}function vc(e,t){return void 0!==e[t+"-edge"]}function bc(e){return vc(e,"left")}function yc(e){return vc(e,"right")}function xc(e){return vc(e,"top")}function wc(e){return vc(e,"bottom")}function Cc(e){return e.model.value.get()}function Sc(e,t){return{x:e,y:t}}function kc(e,t){z(e,ps(),{value:t})}function Oc(e,t,n,o){return e<t?e:n<e?n:e===t?t-1:Math.max(t,e-o)}function _c(e,t,n,o){return n<e?e:e<t?t:e===n?n+1:Math.min(n,e+o)}function Ec(e,t,n){return Math.max(t,Math.min(n,e))}function Tc(e){var t=e.min,n=e.max,o=e.range,r=e.value,i=e.step,u=e.snap,a=e.snapStart,c=e.rounded,s=e.hasMinEdge,l=e.hasMaxEdge,f=e.minBound,d=e.maxBound,e=e.screenRange,s=s?t-1:t,l=l?n+1:n;if(r<f)return s;if(d<r)return l;var m,g,p,h,f=(f=f,Math.min(d,Math.max(r,f))-f),l=Ec(f/e*o+t,s,l);return u&&t<=l&&l<=n?(m=l,g=t,p=n,h=i,a.fold(function(){var e=Math.round((m-g)/h)*h;return Ec(g+e,g-1,p+1)},function(e){var t=Math.round((m-e)%h/h),n=Math.floor((m-e)/h),o=Math.floor((p-e)/h),t=Math.min(o,n+t);return Math.max(e,e+t*h)})):c?Math.round(l):l}function Dc(e){var t=e.min,n=e.max,o=e.range,r=e.value,i=e.hasMinEdge,u=e.hasMaxEdge,a=e.maxBound,c=e.maxOffset,s=e.centerMinEdge,e=e.centerMaxEdge;return r<t?i?0:s:n<r?u?a:e:(r-t)/o*c}function Ac(e){return e.element.dom.getBoundingClientRect()}function Bc(e){return Ac(e).left}function Nc(e){return Ac(e).right}function Rc(e){return Ac(e).top}function Mc(e){return Ac(e).bottom}function Ic(e){return Ac(e).width}function Fc(e){return Ac(e).height}function Pc(e,t){return e=Ac(e),t=Ac(t),(e.left+e.right)/2-t.left}function Lc(e,t){return e=Ac(e),t=Ac(t),(e.top+e.bottom)/2-t.top}function Vc(e,t){z(e,ps(),{value:t})}function Hc(e,t,n){return e={min:ec(t),max:rc(t),range:sc(t),value:n,step:mc(t),snap:gc(t),snapStart:pc(t),rounded:hc(t),hasMinEdge:bc(t),hasMaxEdge:yc(t),minBound:Bc(e),maxBound:Nc(e),screenRange:Ic(e)},Tc(e)}function zc(e,t,n,o,r,i){var u,a,o=(a=i,i=n,n=o,o=r,r=Ic(u=t),n=n.bind(function(e){return Re.some(Pc(e,u))}).getOr(0),o=o.bind(function(e){return Re.some(Pc(e,u))}).getOr(r),o={min:ec(a),max:rc(a),range:sc(a),value:i,hasMinEdge:bc(a),hasMaxEdge:yc(a),minBound:Bc(u),minOffset:0,maxBound:Nc(u),maxOffset:r,centerMinEdge:n,centerMaxEdge:o},Dc(o));return Bc(t)-Bc(e)+o}function jc(e,t){z(e,ps(),{value:t})}function Uc(e,t,n){return e={min:tc(t),max:ic(t),range:lc(t),value:n,step:mc(t),snap:gc(t),snapStart:pc(t),rounded:hc(t),hasMinEdge:xc(t),hasMaxEdge:wc(t),minBound:Rc(e),maxBound:Mc(e),screenRange:Fc(e)},Tc(e)}function Wc(e,t,n,o,r,i){var u,a,o=(a=i,i=n,n=o,o=r,r=Fc(u=t),n=n.bind(function(e){return Re.some(Lc(e,u))}).getOr(0),o=o.bind(function(e){return Re.some(Lc(e,u))}).getOr(r),o={min:tc(a),max:ic(a),range:lc(a),value:i,hasMinEdge:xc(a),hasMaxEdge:wc(a),minBound:Rc(u),minOffset:0,maxBound:Mc(u),maxOffset:r,centerMinEdge:n,centerMaxEdge:o},Dc(o));return Rc(t)-Rc(e)+o}function qc(e,t){z(e,ps(),{value:t})}function Gc(e,t){return{x:e,y:t}}function $c(t,n,o,e){return ls(n,function(){var e=o();t.setContextToolbar([{label:n+" group",items:e}])},{},e)}function Xc(o){function r(e){return e<0?"black":360<e?"white":"hsl("+e+", 100%, 50%)"}return vs.sketch({dom:Ua('<div class="${prefix}-slider ${prefix}-hue-slider-container"></div>'),components:[vs.parts["left-edge"](Wa('<div class="${prefix}-hue-slider-black"></div>')),vs.parts.spectrum({dom:Ua('<div class="${prefix}-slider-gradient-container"></div>'),components:[Wa('<div class="${prefix}-slider-gradient"></div>')],behaviours:br([li.config({toggleClass:di("thumb-active")})])}),vs.parts["right-edge"](Wa('<div class="${prefix}-hue-slider-white"></div>')),vs.parts.thumb({dom:Ua('<div class="${prefix}-slider-thumb"></div>'),behaviours:br([li.config({toggleClass:di("thumb-active")})])})],onChange:function(e,t,n){n=r(n.x());Xr(t.element,"background-color",n),o.onChange(e,t,n)},onDragStart:function(e,t){li.on(t)},onDragEnd:function(e,t){li.off(t)},onInit:function(e,t,n,o){o=r(o.x());Xr(t.element,"background-color",o)},stepSize:10,model:{mode:"x",minX:0,maxX:360,getInitialValue:function(){return{x:o.getInitialValue()}}},sliderBehaviours:br([jr(vs.refresh)])})}function Yc(e,o){var t={onChange:function(e,t,n){o.undoManager.transact(function(){o.formatter.apply("forecolor",{value:n}),o.nodeChanged()})},getInitialValue:function(){return-1}};return $c(e,"color-levels",function(){return[Xc(t)]},o)}function Kc(t,e){return(Ut(e)?Re.some(e):Q(e).filter(Ut)).map(function(e){return Ci(function(e,t){return t(e)},Si,e,function(e){return Jr(e,"font-size").isSome()},t).bind(function(e){return Jr(e,"font-size")}).getOrThunk(function(){return Kr(e,"font-size")})}).getOr("")}function Jc(e){var t=e.selection.getStart(),t=zt.fromDom(t),n=zt.fromDom(e.getBody()),o=Kc(function(e){return X(n,e)},t);return E(bs,function(e){return o===e}).getOr("medium")}function Qc(e){var t,e=Jc(e);return t=e,T(bs,function(e){return e===t}).getOr(2)}function Zc(n,e){Re.from(bs[e]).each(function(e){var t;t=e,Jc(e=n)!==t&&e.execCommand("fontSize",!1,t)})}function es(e){var r=Hn("SizeSlider",ys,e);return vs.sketch({dom:{tag:"div",classes:[di("slider-"+r.category+"-size-container"),di("slider"),di("slider-size-container")]},onChange:function(e,t,n){var o=n.x();0<=(n=o)&&n<r.sizes.length&&r.onChange(o)},onDragStart:function(e,t){li.on(t)},onDragEnd:function(e,t){li.off(t)},model:{mode:"x",minX:0,maxX:r.sizes.length-1,getInitialValue:function(){return{x:r.getInitialValue()}}},stepSize:1,snapToGrid:!0,sliderBehaviours:br([jr(vs.refresh)]),components:[vs.parts.spectrum({dom:Ua('<div class="${prefix}-slider-size-container"></div>'),components:[Wa('<div class="${prefix}-slider-size-line"></div>')]}),vs.parts.thumb({dom:Ua('<div class="${prefix}-slider-thumb"></div>'),behaviours:br([li.config({toggleClass:di("thumb-active")})])})]})}function ts(e){return[Wa('<span class="${prefix}-toolbar-button ${prefix}-icon-small-font ${prefix}-icon"></span>'),es({onChange:e.onChange,sizes:xs,category:"font",getInitialValue:e.getInitialValue}),Wa('<span class="${prefix}-toolbar-button ${prefix}-icon-large-font ${prefix}-icon"></span>')]}function ns(e){var t=void 0!==e.uid&&me(e,"uid")?e.uid:Ha("memento");return{get:function(e){return e.getSystem().getByUid(t).getOrDie()},getOpt:function(e){return e.getSystem().getByUid(t).toOptional()},asSpec:function(){return y(y({},e),{uid:t})}}}var os,rs,is,us=Rn([jn("name"),jn("factory"),jn("configFields"),Yn("apis",{}),Yn("extraApis",{})]),as=Rn([jn("name"),jn("factory"),jn("configFields"),jn("partFields"),Yn("apis",{}),Yn("extraApis",{})]),ar=function(e){var t=Hn("Sketcher for "+e.name,us,e),n=fe(t.apis,ea),e=fe(t.extraApis,so);return y(y({name:t.name,configFields:t.configFields,sketch:function(e){return function(e,t,n,o){o=za(o);return n(ta(e,t,o,[],[]),o)}(t.name,t.configFields,t.factory,e)}},n),e)},gn=function(e){var t=Hn("Sketcher for "+e.name,as,e),n=Gu(t.name,t.partFields),o=fe(t.apis,ea),e=fe(t.extraApis,so);return y(y({name:t.name,partFields:t.partFields,configFields:t.configFields,sketch:function(e){return na(t.name,t.configFields,t.partFields,t.factory,e)},parts:n},o),e)},cs=ar({name:"Button",factory:function(e){function n(t){return dn(e.dom,"attributes").bind(function(e){return dn(e,t)})}var t,t=(t=e.action,sr(D([t.map(function(n){return mr(function(e,t){n(e),t.stop()})}).toArray(),Wr()]))),o=e.dom.tag;return{uid:e.uid,dom:e.dom,components:e.components,events:t,behaviours:Sa(e.buttonBehaviours,[gi.config({}),Ca.config({mode:"execution",useSpace:!0,useEnter:!0})]),domModification:{attributes:function(){if("button"!==o)return{role:n("role").getOr("button")};var e=n("type").getOr("button"),t=n("role").map(function(e){return{role:e}}).getOr({});return y({type:e},t)}()},eventOrder:e.eventOrder}},configFields:[Yn("uid",void 0),jn("dom"),Yn("components",[]),nr("buttonBehaviours",[gi,Ca]),qn("action"),qn("role"),Yn("eventOrder",{})]}),ss=po({fields:[],name:"unselecting",active:Object.freeze({__proto__:null,events:function(){return sr([no(Ct(),w)])},exhibit:function(){return lo({styles:{"-webkit-user-select":"none","user-select":"none","-ms-user-select":"none","-moz-user-select":"-moz-none"},attributes:{unselectable:"on"}})}})}),ls=function(e,t,n,o){return cs.sketch({dom:$a(e,o),action:t,buttonBehaviours:zo(br([ss.config({})]),n)})},St=Na({schema:[jn("dom")],name:"label"}),mi=function(t){return Na({name:t+"-edge",overrides:function(e){return e.model.manager.edgeActions[t].fold(function(){return{}},function(o){return{events:sr([ro(st(),function(e,t,n){return o(e,n)},[e]),ro(dt(),function(e,t,n){return o(e,n)},[e]),ro(mt(),function(e,t,n){n.mouseIsDown.get()&&o(e,n)},[e])])}})}})},e=mi("top-left"),kt=mi("top"),Me=mi("top-right"),Je=mi("right"),Go=mi("bottom-right"),Ho=mi("bottom"),ct=mi("bottom-left"),St=[St,mi("left"),Je,kt,Ho,e,Me,ct,Go,Ba({name:"thumb",defaults:b({dom:{styles:{position:"absolute"}}}),overrides:function(e){return{events:sr([ao(st(),e,"spectrum"),ao(lt(),e,"spectrum"),ao(ft(),e,"spectrum"),ao(dt(),e,"spectrum"),ao(mt(),e,"spectrum"),ao(gt(),e,"spectrum")])}}}),Ba({schema:[er("mouseIsDown",function(){return ho(!1)})],name:"spectrum",overrides:function(n){function o(t,e){return r.getValueFromEvent(e).map(function(e){return r.setValueFrom(t,n,e)})}var r=n.model.manager;return{behaviours:br([Ca.config({mode:"special",onLeft:function(e){return r.onLeft(e,n)},onRight:function(e){return r.onRight(e,n)},onUp:function(e){return r.onUp(e,n)},onDown:function(e){return r.onDown(e,n)}}),gi.config({})]),events:sr([oo(st(),o),oo(lt(),o),oo(dt(),o),oo(mt(),function(e,t){n.mouseIsDown.get()&&o(e,t)})])}}})],mi=Object.freeze({__proto__:null,onLoad:Xa,onUnload:Ya,setValue:function(e,t,n,o){t.store.manager.setValue(e,t,n,o)},getValue:function(e,t,n){return t.store.manager.getValue(e,t,n)},getState:function(e,t,n){return n}}),Je=Object.freeze({__proto__:null,events:function(n,o){var e=n.resetOnDom?[lr(function(e,t){Xa(e,n,o)}),fr(function(e,t){Ya(e,n,o)})]:[fo(n,o,Xa)];return sr(e)}}),kt=function(){var e=ho(null);return vr({set:e.set,get:e.get,isNotSet:function(){return null===e.get()},clear:function(){e.set(null)},readState:function(){return{mode:"memory",value:e.get()}}})},Ho=function(){var i=ho({}),u=ho({});return vr({readState:function(){return{mode:"dataset",dataByValue:i.get(),dataByText:u.get()}},lookup:function(e){return dn(i.get(),e).orThunk(function(){return dn(u.get(),e)})},update:function(e){var t=i.get(),n=u.get(),o={},r={};k(e,function(t){o[t.value]=t,dn(t,"meta").each(function(e){dn(e,"text").each(function(e){r[e]=t})})}),i.set(y(y({},t),o)),u.set(y(y({},n),r))},clear:function(){i.set({}),u.set({})}})},e=Object.freeze({__proto__:null,memory:kt,dataset:Ho,manual:function(){return vr({readState:function(){}})},init:function(e){return e.store.manager.state(e)}}),Me=[qn("initialValue"),jn("getFallbackEntry"),jn("getDataKey"),jn("setValue"),Rr("manager",{setValue:Ka,getValue:function(e,t,n){var o=t.store,r=o.getDataKey(e);return n.lookup(r).fold(function(){return o.getFallbackEntry(r)},function(e){return e})},onLoad:function(t,n,o){n.store.initialValue.each(function(e){Ka(t,n,o,e)})},onUnload:function(e,t,n){n.clear()},state:Ho})],ct=[jn("getValue"),Yn("setValue",v),qn("initialValue"),Rr("manager",{setValue:function(e,t,n,o){t.store.setValue(e,o),t.onSetValue(e,o)},getValue:function(e,t,n){return t.store.getValue(e)},onLoad:function(t,n,e){n.store.initialValue.each(function(e){n.store.setValue(t,e)})},onUnload:v,state:hr.init})],Go=[qn("initialValue"),Rr("manager",{setValue:function(e,t,n,o){n.set(o),t.onSetValue(e,o)},getValue:function(e,t,n){return n.get()},onLoad:function(e,t,n){t.store.initialValue.each(function(e){n.isNotSet()&&n.set(e)})},onUnload:function(e,t,n){n.clear()},state:kt})],Ho=[Kn("store",{mode:"memory"},zn("mode",{memory:Go,manual:ct,dataset:Me})),Ie("onSetValue"),Yn("resetOnDom",!1)],fs=po({fields:Ho,name:"representing",active:Je,apis:mi,extra:{setValueFrom:function(e,t){t=fs.getValue(t);fs.setValue(e,t)}},state:e}),ds=hi("width",function(e){return e.dom.offsetWidth}),ms=function(n,o){return{left:n,top:o,translate:function(e,t){return ms(n+e,o+t)}}},gs=ms,ps=b("slider.change.value"),kt=function(n){return function(e,t){return function(e,t,n){n=(0<e?_c:Oc)(Cc(n).x,ec(n),rc(n),mc(n));return Vc(t,{x:n}),Re.some(n)}(n,e,t).map(function(){return!0})}},Go=kt(-1),ct=kt(1),Me=Re.none,Ho=Re.none,Je={"top-left":Re.none(),top:Re.none(),"top-right":Re.none(),right:Re.some(function(e,t){kc(e,{x:uc(t)})}),"bottom-right":Re.none(),bottom:Re.none(),"bottom-left":Re.none(),left:Re.some(function(e,t){kc(e,{x:nc(t)})})},mi=Object.freeze({__proto__:null,setValueFrom:function(e,t,n){n=Hc(e,t,n);return Vc(e,{x:n}),n},setToMin:function(e,t){t=ec(t);Vc(e,{x:t})},setToMax:function(e,t){t=rc(t);Vc(e,{x:t})},findValueOfOffset:Hc,getValueFromEvent:function(e){return Za(e).map(function(e){return e.left})},findPositionOfValue:zc,setPositionFromValue:function(e,t,n,o){var r=Cc(n),e=zc(e,o.getSpectrum(e),r.x,o.getLeftEdge(e),o.getRightEdge(e),n),n=Qa(t.element)/2;Xr(t.element,"left",e-n+"px")},onLeft:Go,onRight:ct,onUp:Me,onDown:Ho,edgeActions:Je}),e=function(n){return function(e,t){return function(e,t,n){n=(0<e?_c:Oc)(Cc(n).y,tc(n),ic(n),mc(n));return jc(t,{y:n}),Re.some(n)}(n,e,t).map(function(){return!0})}},kt=Re.none,Go=Re.none,ct=e(-1),Me=e(1),Ho={"top-left":Re.none(),top:Re.some(function(e,t){kc(e,{y:oc(t)})}),"top-right":Re.none(),right:Re.none(),"bottom-right":Re.none(),bottom:Re.some(function(e,t){kc(e,{y:ac(t)})}),"bottom-left":Re.none(),left:Re.none()},Je=Object.freeze({__proto__:null,setValueFrom:function(e,t,n){n=Uc(e,t,n);return jc(e,{y:n}),n},setToMin:function(e,t){t=tc(t);jc(e,{y:t})},setToMax:function(e,t){t=ic(t);jc(e,{y:t})},findValueOfOffset:Uc,getValueFromEvent:function(e){return Za(e).map(function(e){return e.top})},findPositionOfValue:Wc,setPositionFromValue:function(e,t,n,o){var r=Cc(n),e=Wc(e,o.getSpectrum(e),r.y,o.getTopEdge(e),o.getBottomEdge(e),n),n=vi(t.element)/2;Xr(t.element,"top",e-n+"px")},onLeft:kt,onRight:Go,onUp:ct,onDown:Me,edgeActions:Ho}),e=function(i,u){return function(e,t){return o=e,r=t,e=0<(n=i)?_c:Oc,n=(t=u)?Cc(r).x:e(Cc(r).x,ec(r),rc(r),mc(r)),r=t?e(Cc(r).y,tc(r),ic(r),mc(r)):Cc(r).y,qc(o,Gc(n,r)),Re.some(n).map(function(){return!0});var n,o,r}},kt=Za,Go=e(-1,!1),ct=e(1,!1),Me=e(-1,!0),Ho=e(1,!0),e={"top-left":Re.some(function(e,t){kc(e,Sc(nc(t),oc(t)))}),top:Re.some(function(e,t){kc(e,Sc(fc(t),oc(t)))}),"top-right":Re.some(function(e,t){kc(e,Sc(uc(t),oc(t)))}),right:Re.some(function(e,t){kc(e,Sc(uc(t),dc(t)))}),"bottom-right":Re.some(function(e,t){kc(e,Sc(uc(t),ac(t)))}),bottom:Re.some(function(e,t){kc(e,Sc(fc(t),ac(t)))}),"bottom-left":Re.some(function(e,t){kc(e,Sc(nc(t),ac(t)))}),left:Re.some(function(e,t){kc(e,Sc(nc(t),dc(t)))})},e=Object.freeze({__proto__:null,setValueFrom:function(e,t,n){var o=Hc(e,t,n.left),n=Uc(e,t,n.top),n=Gc(o,n);return qc(e,n),n},setToMin:function(e,t){var n=ec(t),t=tc(t);qc(e,Gc(n,t))},setToMax:function(e,t){var n=rc(t),t=ic(t);qc(e,Gc(n,t))},getValueFromEvent:kt,setPositionFromValue:function(e,t,n,o){var r=Cc(n),i=zc(e,o.getSpectrum(e),r.x,o.getLeftEdge(e),o.getRightEdge(e),n),o=Wc(e,o.getSpectrum(e),r.y,o.getTopEdge(e),o.getBottomEdge(e),n),e=Qa(t.element)/2,n=vi(t.element)/2;Xr(t.element,"left",i-e+"px"),Xr(t.element,"top",o-n+"px")},onLeft:Go,onRight:ct,onUp:Me,onDown:Ho,edgeActions:e}),Je=[Yn("stepSize",1),Yn("onChange",v),Yn("onChoose",v),Yn("onInit",v),Yn("onDragStart",v),Yn("onDragEnd",v),Yn("snapToGrid",!1),Yn("rounded",!0),qn("snapStart"),Un("model",zn("mode",{x:[Yn("minX",0),Yn("maxX",100),er("value",function(e){return ho(e.mode.minX)}),jn("getInitialValue"),Rr("manager",mi)],y:[Yn("minY",0),Yn("maxY",100),er("value",function(e){return ho(e.mode.minY)}),jn("getInitialValue"),Rr("manager",Je)],xy:[Yn("minX",0),Yn("maxX",100),Yn("minY",0),Yn("maxY",100),er("value",function(e){return ho({x:e.mode.minX,y:e.mode.minY})}),jn("getInitialValue"),Rr("manager",e)]})),Kt("sliderBehaviours",[Ca,fs]),er("mouseIsDown",function(){return ho(!1)})],hs=b("mouse.released"),vs=gn({name:"Slider",configFields:Je,partFields:St,factory:function(r,e,t,n){function i(e){return Ku(e,r,"thumb")}function u(e){return Ku(e,r,"spectrum")}function o(e){return Yu(e,r,"left-edge")}function a(e){return Yu(e,r,"right-edge")}function c(e){return Yu(e,r,"top-edge")}function s(e){return Yu(e,r,"bottom-edge")}function l(e,t){h.setPositionFromValue(e,t,r,{getLeftEdge:o,getRightEdge:a,getTopEdge:c,getBottomEdge:s,getSpectrum:u})}function f(e,t){p.value.set(t);var n=i(e);return l(e,n),r.onChange(e,n,t),Re.some(!0)}function d(n){var e=r.mouseIsDown.get();r.mouseIsDown.set(!1),e&&Yu(n,r,"thumb").each(function(e){var t=p.value.get();r.onChoose(n,e,t)})}function m(e,t){t.stop(),r.mouseIsDown.set(!0),r.onDragStart(e,i(e))}function g(e,t){t.stop(),r.onDragEnd(e,i(e)),d(e)}var p=r.model,h=p.manager;return{uid:r.uid,dom:r.dom,components:e,behaviours:Vu(r.sliderBehaviours,[Ca.config({mode:"special",focusIn:function(e){return Yu(e,r,"spectrum").map(Ca.focusIn).map(w)}}),fs.config({store:{mode:"manual",getValue:function(e){return p.value.get()}}}),ai.config({channels:((e={})[hs()]={onReceive:d},e)})]),events:sr([oo(ps(),function(e,t){f(e,t.event.value)}),lr(function(e,t){var n=p.getInitialValue();p.value.set(n);var o=i(e);l(e,o);n=u(e);r.onInit(e,o,n,p.value.get())}),oo(st(),m),oo(ft(),g),oo(dt(),m),oo(gt(),g)]),apis:{resetToMin:function(e){h.setToMin(e,r)},resetToMax:function(e){h.setToMax(e,r)},changeValue:f,refresh:l},domModification:{styles:{position:"relative"}}}},apis:{resetToMin:function(e,t){e.resetToMin(t)},resetToMax:function(e,t){e.resetToMax(t)},refresh:function(e,t){e.refresh(t)}}}),bs=["9px","10px","11px","12px","14px","16px","18px","20px","24px","32px","36px"],e=b(bs),ys=Rn([jn("getInitialValue"),jn("onChange"),jn("category"),jn("sizes")]),xs=e(),ws=window.Promise||(os=window,rs=Cs.immediateFn||"function"==typeof os.setImmediate&&os.setImmediate||function(e){setTimeout(e,1)},is=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},Cs.prototype.catch=function(e){return this.then(null,e)},Cs.prototype.then=function(n,o){var r=this;return new Cs(function(e,t){ks.call(r,new Ts(n,o,e,t))})},Cs.all=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var a=Array.prototype.slice.call(1===e.length&&is(e[0])?e[0]:e);return new Cs(function(r,i){if(0===a.length)return r([]);var u=a.length;for(var e=0;e<a.length;e++)!function t(n,e){try{if(e&&("object"==typeof e||"function"==typeof e)){var o=e.then;if("function"==typeof o)return void o.call(e,function(e){t(n,e)},i)}a[n]=e,0==--u&&r(a)}catch(e){i(e)}}(e,a[e])})},Cs.resolve=function(t){return t&&"object"==typeof t&&t.constructor===Cs?t:new Cs(function(e){e(t)})},Cs.reject=function(n){return new Cs(function(e,t){t(n)})},Cs.race=function(r){return new Cs(function(e,t){for(var n=0,o=r;n<o.length;n++)o[n].then(e,t)})},Cs);function Cs(e){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");this._state=null,this._value=null,this._deferreds=[],Ds(e,Ss(Os,this),Ss(_s,this))}function Ss(e,t){return function(){return e.apply(t,arguments)}}function ks(n){var o=this;null!==this._state?rs(function(){var e,t=o._state?n.onFulfilled:n.onRejected;if(null!==t){try{e=t(o._value)}catch(e){return void n.reject(e)}n.resolve(e)}else(o._state?n.resolve:n.reject)(o._value)}):this._deferreds.push(n)}function Os(e){try{if(e===this)throw new TypeError("A promise cannot be resolved with itself.");if(e&&("object"==typeof e||"function"==typeof e)){var t=e.then;if("function"==typeof t)return void Ds(Ss(t,e),Ss(Os,this),Ss(_s,this))}this._state=!0,this._value=e,Es.call(this)}catch(e){_s.call(this,e)}}function _s(e){this._state=!1,this._value=e,Es.call(this)}function Es(){for(var e=0,t=this._deferreds;e<t.length;e++){var n=t[e];ks.call(this,n)}this._deferreds=[]}function Ts(e,t,n,o){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.resolve=n,this.reject=o}function Ds(e,t,n){var o=!1;try{e(function(e){o||(o=!0,t(e))},function(e){o||(o=!0,n(e))})}catch(e){if(o)return;o=!0,n(e)}}function As(e){return n=e,new ws(function(e){var t=new FileReader;t.onloadend=function(){e(t.result)},t.readAsDataURL(n)}).then(function(e){return e.split(",")[1]});var n}function Bs(n){var t=ns({dom:{tag:"input",attributes:{accept:"image/*",type:"file",title:""},styles:{visibility:"hidden",position:"absolute"}},events:sr([co(xt()),oo(yt(),function(e,t){!function(e){e=e.event.raw,e=e.target.files||e.dataTransfer.files;return Re.from(e[0])}(t).each(function(e){var o,r;o=n,Zl(r=e).then(function(n){o.undoManager.transact(function(){var e=o.editorUpload.blobCache,t=e.create(Uu("mceu"),r,n);e.add(t);t=o.dom.createHTML("img",{src:t.blobUri()});o.insertContent(t)})})})})])});return cs.sketch({dom:$a("image",n),components:[t.asSpec()],action:function(e){t.get(e).element.dom.click()}})}function Ns(e){return e.dom.textContent}function Rs(e){return 0<e.length}function Ms(e){return null==e?"":e}function Is(e){return ef(e).fold(function(){return{url:"",text:e.selection.getContent({format:"text"}),title:"",target:"",link:Re.none()}},function(e){return n=Ns(t=e),o=ve(t,"href"),r=ve(t,"title"),e=ve(t,"target"),{url:Ms(o),text:n!==o?Ms(n):"",title:Ms(r),target:Ms(e),link:Re.some(t)};var t,n,o,r})}function Fs(t,n,e){return e.text.toOptional().filter(Rs).fold(function(){return ve(e=t,"href")===Ns(e)?Re.some(n):Re.none();var e},Re.some)}function Ps(r,i){i.url.toOptional().filter(Rs).fold(function(){var t;t=r,i.link.bind(h).each(function(e){t.execCommand("unlink")})},function(n){var e,t,o=(e=i,(t={}).href=n,e.title.toOptional().filter(Rs).each(function(e){t.title=e}),e.target.toOptional().filter(Rs).each(function(e){t.target=e}),t);i.link.bind(h).fold(function(){var e=i.text.toOptional().filter(Rs).getOr(n);r.insertContent(r.dom.createHTML("a",o,r.dom.encode(e)))},function(t){var e=Fs(t,n,i);he(t,o),e.each(function(e){t.dom.textContent=e})})})}function Ls(e,t){var n=t.selection.getRng();e(),t.selection.setRng(n)}function Vs(e,t){return{key:e,value:{config:{},me:function(e,t){t=sr(t);return po({fields:[jn("enabled")],name:e,active:{events:b(t)}})}(e,t),configAsRaw:b({}),initialConfig:{},state:hr}}}function Hs(e){return e.dom.value}function zs(e,t){if(void 0===t)throw new Error("Value.set was undefined");e.dom.value=t}function js(e){return y(y({},br([gi.config({onFocus:e.selectOnFocus?function(e){var t=e.element,e=Hs(t);t.dom.setSelectionRange(0,e.length)}:v})])),Vu(e.inputBehaviours,[fs.config({store:y(y({mode:"manual"},e.data.map(function(e){return{initialValue:e}}).getOr({})),{getValue:function(e){return Hs(e.element)},setValue:function(e,t){Hs(e.element)!==t&&zs(e.element,t)}}),onSetValue:e.onSetValue})]))}function Us(e,t){var n=ns(uf.sketch({inputAttributes:{placeholder:cf.translate(t)},onSetValue:function(e,t){H(e,bt())},inputBehaviours:br([nf.config({find:Re.some}),af.config({}),Ca.config({mode:"execution"})]),selectOnFocus:!1})),t=ns(cs.sketch({dom:Ua('<button class="${prefix}-input-container-x ${prefix}-icon-cancel-circle ${prefix}-icon"></button>'),action:function(e){e=n.get(e);fs.setValue(e,"")}}));return{name:e,spec:of.sketch({dom:Ua('<div class="${prefix}-input-container"></div>'),components:[n.asSpec(),t.asSpec()],containerBehaviours:br([li.config({toggleClass:di("input-container-empty")}),nf.config({find:function(e){return Re.some(n.get(e))}}),Vs("input-clearing",[oo(bt(),function(e){var t=n.get(e);(0<fs.getValue(t).length?li.off:li.on)(e)})])])})}}function Ws(e,t,n){(t.disabled()?lf:ff)(e,t)}function qs(e,t){return!0===t.useNative&&C(sf,Y(e.element))}function Gs(e){pe(e.element,"disabled","disabled")}function $s(e){xe(e.element,"disabled")}function Xs(e){pe(e.element,"aria-disabled","true")}function Ys(e){pe(e.element,"aria-disabled","false")}function Ks(e,t){return qs(e,t)?ye(e.element,"disabled"):"true"===ve(e.element,"aria-disabled")}function Js(e){return"<alloy.field."+e+">"}function Qs(){function t(){return n.get().each(function(e){return e.destroy()})}var n=ho(Re.none());return{clear:function(){t(),n.set(Re.none())},isSet:function(){return n.get().isSome()},set:function(e){t(),n.set(Re.some(e))},run:function(e){return n.get().each(e)}}}function Zs(){var t=ho(Re.none());return{clear:function(){return t.set(Re.none())},set:function(e){return t.set(Re.some(e))},isSet:function(){return t.get().isSome()},on:function(e){return t.get().each(e)}}}function el(e){function o(t,e,n){return cs.sketch({dom:Ua('<span class="${prefix}-icon-'+e+' ${prefix}-icon"></span>'),action:function(e){z(e,u,{direction:t})},buttonBehaviours:br([df.config({disableClass:di("toolbar-navigation-disabled"),disabled:function(){return!n}})])})}function r(e,o){var r=xi(e.element,"."+di("serialised-dialog-screen"));Oi(e.element,"."+di("serialised-dialog-chain")).each(function(n){0<=a.state.currentScreen.get()+o&&a.state.currentScreen.get()+o<r.length&&(Jr(n,"left").each(function(e){var t=parseInt(e,10),e=Qa(r[0]);Xr(n,"left",t-o*e+"px")}),a.state.currentScreen.set(a.state.currentScreen.get()+o))})}function i(n){var e=xi(n.element,"input");Re.from(e[a.state.currentScreen.get()]).each(function(e){n.getSystem().getByDom(e).each(function(e){var t;t=n,e=e.element,t.getSystem().triggerFocus(e,t.element)})}),e=s.get(n),au.highlightAt(e,a.state.currentScreen.get())}var u="navigateEvent",t=Qo([jn("fields"),Yn("maxFieldIndex",e.fields.length-1),jn("onExecute"),jn("getInitialValue"),er("state",function(){return{dialogSwipeState:Zs(),currentScreen:ho(0)}})]),a=Hn("SerialisedDialog",t,e),c=ns(pf(function(n){return{dom:Ua('<div class="${prefix}-serialised-dialog"></div>'),components:[of.sketch({dom:Ua('<div class="${prefix}-serialised-dialog-chain" style="left: 0px; position: absolute;"></div>'),components:S(a.fields,function(e,t){return t<=a.maxFieldIndex?of.sketch({dom:Ua('<div class="${prefix}-serialised-dialog-screen"></div>'),components:[o(-1,"previous",0<t),n.field(e.name,e.spec),o(1,"next",t<a.maxFieldIndex)]}):n.field(e.name,e.spec)})})],formBehaviours:br([jr(function(e,t){var n;n=t,Oi(e.element,"."+di("serialised-dialog-chain")).each(function(e){Xr(e,"left",-a.state.currentScreen.get()*n.width+"px")})}),Ca.config({mode:"special",focusIn:function(e,t){i(e)},onTab:function(e,t){return r(e,1),Re.some(!0)},onShiftTab:function(e,t){return r(e,-1),Re.some(!0)}}),Vs("form-events",[lr(function(t,e){a.state.currentScreen.set(0),a.state.dialogSwipeState.clear();var n=s.get(t);au.highlightFirst(n),a.getInitialValue(t).each(function(e){fs.setValue(t,e)})}),mr(a.onExecute),oo(wt(),function(e,t){"left"===t.event.raw.propertyName&&i(e)}),oo(u,function(e,t){t=t.event.direction;r(e,t)})])])}})),s=ns({dom:Ua('<div class="${prefix}-dot-container"></div>'),behaviours:br([au.config({highlightClass:di("dot-active"),itemClass:di("dot-item")})]),components:A(a.fields,function(e,t){return t<=a.maxFieldIndex?[Wa('<div class="${prefix}-dot-item ${prefix}-icon-full-dot ${prefix}-icon"></div>')]:[]})});return{dom:Ua('<div class="${prefix}-serializer-wrapper"></div>'),components:[c.asSpec(),s.asSpec()],behaviours:br([Ca.config({mode:"special",focusIn:function(e){e=c.get(e);Ca.focusIn(e)}}),Vs("serializer-wrapper-events",[oo(st(),function(e,t){t=t.event;a.state.dialogSwipeState.set({xValue:t.raw.touches[0].clientX,points:[]})}),oo(lt(),function(e,t){var n=t.event;a.state.dialogSwipeState.on(function(e){t.event.prevent(),a.state.dialogSwipeState.set(function(e,t){if(t===e.xValue)return e;var n=0<t-e.xValue?1:-1,o={direction:n,xValue:t};return{xValue:t,points:(0===e.points.length?[]:e.points[e.points.length-1].direction===n?e.points.slice(0,e.points.length-1):e.points).concat([o])}}(e,n.raw.touches[0].clientX))})}),oo(ft(),function(n,e){a.state.dialogSwipeState.on(function(e){var t=c.get(n),e=-1*function(e){if(0===e.points.length)return 0;var t=e.points[0].direction,e=e.points[e.points.length-1].direction;return-1===t&&-1===e?-1:1===t&&1===e?1:0}(e);r(t,e)})})])])}}function tl(n,o){return Ga(o,"link","link",function(){var e,t=hf(n,o);n.setContextToolbar(t),e=o,t=function(){n.focusToolbar()},(tf.os.isAndroid()?Ls:r)(t,e),ef(o).each(function(e){o.selection.select(e.dom)})})}function nl(t){function e(e){return function(){throw new Error("The component must be in a context to send: "+e+(t?"\n"+ko(t().element)+" is not in context.":""))}}return{debugInfo:b("fake"),triggerEvent:e("triggerEvent"),triggerFocus:e("triggerFocus"),triggerEscape:e("triggerEscape"),build:e("build"),addToWorld:e("addToWorld"),removeFromWorld:e("removeFromWorld"),addToGui:e("addToGui"),removeFromGui:e("removeFromGui"),getByUid:e("getByUid"),getByDom:e("getByDom"),broadcast:e("broadcast"),broadcastOn:e("broadcastOn"),broadcastEvent:e("broadcastEvent"),isConnected:c}}function ol(e,r){var i={};return sn(e,function(e,o){sn(e,function(e,t){var n=dn(i,t).getOr([]);i[t]=n.concat([r(o,e)])})}),i}function rl(t,e,n,o){var r=y({},e);function i(e){return p(e,function(e,t){return y(y({},t.modification),e)},{})}k(n,function(e){r[e.name()]=e.exhibit(t,o)});var u=ol(r,function(e,t){return{name:e,modification:t}}),e=p(u.classes,function(e,t){return t.modification.concat(e)},[]),n=i(u.attributes),u=i(u.styles);return lo({classes:e,attributes:n,styles:u})}function il(r,i,e,u){try{var t=function(e,t){e=je.call(e,0);return e.sort(t),e}(e,function(e,t){var n=e[i],o=t[i],e=u.indexOf(n),t=u.indexOf(o);if(-1===e)throw new Error("The ordering for "+r+" does not have an entry for "+n+".\nOrder specified: "+JSON.stringify(u,null,2));if(-1===t)throw new Error("The ordering for "+r+" does not have an entry for "+o+".\nOrder specified: "+JSON.stringify(u,null,2));return e<t?-1:t<e?1:0});return vn.value(t)}catch(e){return vn.error([e])}}function ul(e){return e.cHandler}function al(e,t){return{name:e,handler:t}}function cl(e,t,n){var o,r,t=y(y({},n),(o=e,r={},k(t,function(e){r[e.name()]=e.handlers(o)}),r));return ol(t,al)}function sl(e){var r=He(e=e)?{can:b(!0),abort:b(!1),run:e}:e;return function(e,t){for(var n=[],o=2;o<arguments.length;o++)n[o-2]=arguments[o];e=[e,t].concat(n);r.abort.apply(void 0,e)?t.stop():r.can.apply(void 0,e)&&r.run.apply(void 0,e)}}function ll(e,t,n){return(t=t[n])?il("Event: "+n,"name",e,t).map(function(e){e=S(e,function(e){return e.handler});return to(e)}):vn.error(["The event ("+n+') has more than one behaviour that listens to it.\nWhen this occurs, you must specify an event ordering for the behaviours in your spec (e.g. [ "listing", "toggling" ]).\nThe behaviours that can trigger it are: '+JSON.stringify(S(e,function(e){return e.name}),null,2)])}function fl(e){var t;return Ln("custom.definition",Qo([tr("dom","dom",Wo(),Qo([jn("tag"),Yn("styles",{}),Yn("classes",[]),Yn("attributes",{}),qn("value"),qn("innerHtml")])),jn("components"),jn("uid"),Yn("events",{}),Yn("apis",{}),tr("eventOrder","eventOrder",((t={})[Dt()]=["disabling",Cf,"toggling","typeaheadevents"],t[Ot()]=[Cf,"focusing","keying"],t[Rt()]=[Cf,"disabling","toggling","representing"],t[bt()]=[Cf,"representing","streaming","invalidating"],t[It()]=[Cf,"representing","item-events","tooltipping"],t[dt()]=["focusing",Cf,"item-type-events"],t[st()]=["focusing",Cf,"item-type-events"],t[pt()]=["item-type-events","tooltipping"],t[Tt()]=["receiving","reflecting","tooltipping"],t=t,Uo.mergeWithThunk(b(t))),ir()),qn("domModification")]),e)}function dl(t,e){k(e,function(e){Oe(t,e)})}function ml(t,e){k(e,function(e){Ee(t,e)})}function gl(e,t){return n=e,t=S(e=t,function(e){return $n(e.name(),[jn("config"),Yn("state",hr)])}),t=Ln("component.behaviours",Qo(t),n.behaviours).fold(function(e){throw new Error(rr(e)+"\nComplete spec:\n"+JSON.stringify(n,null,2))},function(e){return e}),{list:e,data:fe(t,function(e){var t=e.map(function(e){return{config:e.config,state:e.state.init(e.config)}});return function(){return t}})};var n}function pl(e){var t,n=(t=dn(n=e,"behaviours").getOr({}),n=O(an(t),function(e){return void 0!==t[e]}),S(n,function(e){return t[e].me}));return gl(e,n)}function hl(e,t,n){var o=y(y({},(o=e).dom),{uid:o.uid,domChildren:S(o.components,function(e){return e.element})}),e=e.domModification.fold(function(){return lo({})},lo);return e=e=0<t.length?rl(n,{"alloy.base.modification":e},t,o):e,y(y({},o=o),{attributes:y(y({},o.attributes),e.attributes),styles:y(y({},o.styles),e.styles),classes:o.classes.concat(e.classes)})}function vl(e,t,n){var o={"alloy.base.behaviour":e.events};return function(e,t,n,o){o=cl(e,n,o);return wf(o,t)}(n,e.eventOrder,t,o).getOrDie()}function bl(n){function e(){return s}var t=ho(yf),o=Vn(fl(n)),r=pl(n),i=r.list,u=r.data,a=function(e){var t=zt.fromTag(e.tag);he(t,e.attributes),dl(t,e.classes),Yr(t,e.styles),e.innerHtml.each(function(e){return Co(t,e)});var n=e.domChildren;return oe(t,n),e.value.each(function(e){zs(t,e)}),e.uid,La(t,e.uid),t}(hl(o,i,u)),i=vl(o,i,u),c=ho(o.components),s={getSystem:t.get,config:function(e){var t=u;return(He(t[e.name()])?t[e.name()]:function(){throw new Error("Could not find "+e.name()+" in "+JSON.stringify(n,null,2))})()},hasConfigured:function(e){return He(u[e.name()])},spec:n,readState:function(e){return u[e]().map(function(e){return e.state.readState()}).getOr("not enabled")},getApis:function(){return o.apis},connect:function(e){t.set(e)},disconnect:function(){t.set(nl(e))},element:a,syncComponents:function(){var e=$t(a),e=A(e,function(e){return t.get().getByDom(e).fold(function(){return[]},function(e){return[e]})});c.set(e)},components:c.get,events:i};return s}function yl(e){var t=(n=bf(e)).events,n=function(e){e=dn(e,"components").getOr([]);return S(e,Of)}(e=o(n,["events"])),n=y(y({},e),{events:y(y({},vf),t),components:n});return vn.value(bl(n))}function xl(e){return e=zt.fromText(e),Sf({element:e})}function wl(e){(xo(e.element).isNone()||gi.isFocused(e))&&(gi.isFocused(e)||gi.focus(e),z(e,Ef,{item:e}))}function Cl(e){z(e,Tf,{item:e})}function Sl(){return"item-widget"}function kl(e,n){var o=Qt(n),t=yo(o).bind(function(t){function e(e){return X(t,e)}var o,r;return e(n)?Re.some(n):(o=e,(r=function(e){for(var t=0;t<e.childNodes.length;t++){var n=zt.fromDom(e.childNodes[t]);if(o(n))return Re.some(n);n=r(e.childNodes[t]);if(n.isSome())return n}return Re.none()})(n.dom))}),e=e(n);return t.each(function(t){yo(o).filter(function(e){return X(e,t)}).fold(function(){vo(t)},v)}),e}function Ol(e,t,n,o){o=e.getSystem().build(o),rn(e,o,n)}function _l(e,t,n,o){e=If(e),E(e,function(e){return X(o.element,e.element)}).each(le)}function El(t,e,n,r,o){var i=If(t);return Re.from(i[r]).map(function(e){return _l(t,0,0,e),o.each(function(e){Ol(t,0,function(e,t){var n,o;o=t,Z(n=e,r).fold(function(){Xt(n,o)},function(e){ee(e,o)})},e)}),e})}function Tl(e,t){var n={};sn(e,function(e,t){k(e,function(e){n[e]=t})});var o=t,r=ln(t,function(e,t){return{k:e,v:t}}),i=fe(r,function(e,t){return[t].concat(Pf(n,o,r,t))});return fe(n,function(e){return dn(i,e).getOr([e])})}function Dl(e,t,n,o){return dn(t.routes,o.start).bind(function(e){return dn(e,o.destination)})}function Al(t,n,e){var o,r,i;i=e,Uf(o=t,r=n).bind(function(e){return jf(o,r,i,e)}).each(function(e){e=e.transition;Ee(t.element,e.transitionClass),xe(t.element,n.destinationAttr)})}function Bl(e,t,n,o){Al(e,t,n),ye(e.element,t.stateAttr)&&ve(e.element,t.stateAttr)!==o&&t.onFinish(e,o),pe(e.element,t.stateAttr,o)}function Nl(e){Oe(e,qf)}function Rl(e){Ee(e,qf)}function Ml(e){return dn(e,"format").getOr(e.title)}function Il(o){var n,r,e,t=(n=o.formats,r=function(){return i},t=Xf("Styles",[].concat(S(n.items,function(e){return $f(Ml(e),e.title,e.isSelected(),e.getPreview(),me(n.expansions,Ml(e)))})),r,!1),e=fe(n.menus,function(e,t){e=S(e,function(e){return $f(Ml(e),e.title,void 0!==e.isSelected&&e.isSelected(),void 0!==e.getPreview?e.getPreview():"",me(n.expansions,Ml(e)))});return Xf(t,e,r,!0)}),t=zo(e,Xo("styles",t)),{tmenu:zf.tieredData("styles",t,n.expansions)}),i=ns(zf.sketch({dom:{tag:"div",classes:[di("styles-menu")]},components:[],fakeFocus:!0,stayInDom:!0,onExecute:function(e,t){var n=fs.getValue(t);return o.handle(t,n.value),Re.none()},onEscape:function(){return Re.none()},onOpenMenu:function(e,t){e=Qa(e.element);Ja(t.element,e),Wf.jumpTo(t,"current")},onOpenSubmenu:function(e,t,n){var o=Qa(e.element),t=ki(t.element,'[role="menu"]').getOrDie("hacky"),t=e.getSystem().getByDom(t).getOrDie();Ja(n.element,o),Wf.progressTo(t,"before"),Wf.jumpTo(n,"after"),Wf.progressTo(n,"current")},onCollapseMenu:function(e,t,n){t=ki(t.element,'[role="menu"]').getOrDie("hacky"),t=e.getSystem().getByDom(t).getOrDie();Wf.progressTo(t,"after"),Wf.progressTo(n,"current")},navigateOnHover:!1,highlightImmediately:!0,data:t.tmenu,markers:{backgroundMenu:di("styles-background-menu"),menu:di("styles-menu"),selectedMenu:di("styles-selected-menu"),item:di("styles-item"),selectedItem:di("styles-selected-item")}}));return i.asSpec()}function Fl(e){return me(e,"items")?(n=zo(Sn(t=e,["items"]),{menu:!0}),o=Yf(t.items),{item:n,menus:zo(o.menus,Xo(t.title,o.items)),expansions:zo(o.expansions,Xo(t.title,t.title))}):{item:e,menus:{},expansions:{}};var t,n,o}function Pl(n){function o(e){return function(){return n.formatter.match(e)}}function r(e){return function(){return n.formatter.getCssText(e)}}var i=function(e){return S(e,function(e){if(me(e,"items")){var t=i(e.items);return zo(zo(e,{isSelected:c,getPreview:b("")}),{items:t})}return me(e,"format")?zo(e,{isSelected:o(e.format),getPreview:r(e.format)}):(e=Uu((t=e).title),t=zo(t,{format:e,isSelected:o(e),getPreview:r(e)}),n.formatter.register(e,t),t)})};return i(n.getParam("style_formats",Or,"array"))}function Ll(n,e,o){var t,r,e=(t=n,e=(r=function(e){return A(e,function(e){return void 0===e.items?!me(e,"format")||t.formatter.canApply(e.format)?[e]:[]:0<r(e.items).length?[e]:[]})})(e=e),Yf(e));return Il({formats:e,handle:function(e,t){n.undoManager.transact(function(){li.isOn(e)?n.formatter.remove(t):n.formatter.apply(t)}),o()}})}function Vl(e){return 0<(e=e.replace(/\|/g," ").trim()).length?e.split(/\s+/):[]}function Hl(e){return e=e.getParam("toolbar",_r,"array"),(Le(e)?Kf:Vl)(e)}function zl(n,r){function t(){return Ll(r,m,function(){r.fire("scrollIntoView")})}var e=function(e,t,n){return function(){return Ga(r,e,t,n)}},o=(d=function(n){return function(){return ls(t=n,function(){e.execCommand(t)},{},e=r);var e,t}})("undo"),i=d("redo"),u=(f=function(o){return function(){return e=r,n=qa(t=o),ls(t,function(){e.execCommand(t)},n,e);var e,t,n}})("bold"),a=f("italic"),c=f("underline"),s=d("removeformat"),l=e("unlink","link",function(){r.execCommand("unlink",null,!1)}),f=e("unordered-list","ul",function(){r.execCommand("InsertUnorderedList",null,!1)}),d=e("ordered-list","ol",function(){r.execCommand("InsertOrderedList",null,!1)}),m=Pl(r);return{undo:(e=function(e,t){return{isSupported:function(){var t=r.ui.registry.getAll().buttons;return e.forall(function(e){return me(t,e)})},sketch:t}})(Re.none(),o),redo:e(Re.none(),i),bold:e(Re.none(),u),italic:e(Re.none(),a),underline:e(Re.none(),c),removeformat:e(Re.none(),s),link:e(Re.none(),function(){return tl(n,r)}),unlink:e(Re.none(),l),image:e(Re.none(),function(){return Bs(r)}),bullist:e(Re.some("bullist"),f),numlist:e(Re.some("numlist"),d),fontsizeselect:e(Re.none(),function(){return e={onChange:function(e){Zc(t,e)},getInitialValue:function(){return Qc(t)}},$c(n,"font-size",function(){return ts(e)},t=r);var t,e}),forecolor:e(Re.none(),function(){return Yc(n,r)}),styleselect:e(Re.none(),function(){return ls("style-formats",function(e){r.fire("toReading"),n.dropup.appear(t,li.on,e)},br([li.config({toggleClass:di("toolbar-button-selected"),toggleOnExecute:!1,aria:{mode:"pressed"}}),ai.config({channels:kn([Ur(Tr,li.off),Ur(Dr,li.off)])})]),r)})}}function jl(e){function t(){return e.stopPropagation()}function n(){return e.preventDefault()}var o=zt.fromDom(function(e){if(Jt()&&m(e.target)){var t=zt.fromDom(e.target);if(Ut(t)&&Zt(t)&&e.composed&&e.composedPath){t=e.composedPath();if(t)return I(t)}}return Re.from(e.target)}(e).getOr(e.target)),r=i(n,t);return{target:o,x:e.clientX,y:e.clientY,stop:t,prevent:n,kill:r,raw:e}}function Ul(e,t,n,o,r){var i,u,o=(i=n,u=o,function(e){i(e)&&u(jl(e))});return e.dom.addEventListener(t,o,r),{unbind:x(Jf,e,t,o,r)}}function Wl(e,t,n){return Ul(e,t,Qf,n,!1)}function ql(e,t,n){return Ul(e,t,Qf,n,!0)}function Gl(e){return e=e.matchMedia("(orientation: portrait)").matches,{isPortrait:b(e)}}function $l(o,t){var e=zt.fromDom(o),r=null,n=Wl(e,"orientationchange",function(){Zf.clearInterval(r);var e=Gl(o);t.onChange(e),i(function(){t.onReady(e)})}),i=function(e){Zf.clearInterval(r);var t=o.innerHeight,n=0;r=Zf.setInterval(function(){t!==o.innerHeight?(Zf.clearInterval(r),e(Re.some(o.innerHeight))):20<n&&(Zf.clearInterval(r),e(Re.none())),n++},50)};return{onAdjustment:i,destroy:function(){n.unbind()}}}function Xl(e,t,n){var o,r,e=e.document.createRange();return o=e,t.fold(function(e){o.setStartBefore(e.dom)},function(e,t){o.setStart(e.dom,t)},function(e){o.setStartAfter(e.dom)}),r=e,n.fold(function(e){r.setEndBefore(e.dom)},function(e,t){r.setEnd(e.dom,t)},function(e){r.setEndAfter(e.dom)}),e}function Yl(e,t,n,o,r){return(e=e.document.createRange()).setStart(t.dom,n),e.setEnd(o.dom,r),e}function Kl(e){return{left:e.left,top:e.top,right:e.right,bottom:e.bottom,width:e.width,height:e.height}}function Jl(e,t,n){return t(zt.fromDom(n.startContainer),n.startOffset,zt.fromDom(n.endContainer),n.endOffset)}function Ql(e,t){var r,n,t=(r=e,t.match({domRange:function(e){return{ltr:b(e),rtl:Re.none}},relative:function(e,t){return{ltr:s(function(){return Xl(r,e,t)}),rtl:s(function(){return Re.some(Xl(r,t,e))})}},exact:function(e,t,n,o){return{ltr:s(function(){return Yl(r,e,t,n,o)}),rtl:s(function(){return Re.some(Yl(r,n,o,e,t))})}}}));return(n=(t=t).ltr()).collapsed?t.rtl().filter(function(e){return!1===e.collapsed}).map(function(e){return ed.rtl(zt.fromDom(e.endContainer),e.endOffset,zt.fromDom(e.startContainer),e.startOffset)}).getOrThunk(function(){return Jl(0,ed.ltr,n)}):Jl(0,ed.ltr,n)}var Zl=As,ef=function(e){e=zt.fromDom(e.selection.getStart());return _i(e,"a")},tf=at(),Je=Object.freeze({__proto__:null,getCurrent:function(e,t,n){return t.find(e)}}),St=[jn("find")],nf=po({fields:St,name:"composing",apis:Je}),of=ar({name:"Container",factory:function(e){var t=e.dom,n=t.attributes,t=o(t,["attributes"]);return{uid:e.uid,dom:y({tag:"div",attributes:y({role:"presentation"},n)},t),components:e.components,behaviours:e.containerBehaviours.dump,events:e.events,domModification:e.domModification,eventOrder:e.eventOrder}},configFields:[Yn("components",[]),Kt("containerBehaviours",[]),Yn("events",{}),Yn("domModification",{}),Yn("eventOrder",{})]}),rf=ar({name:"DataField",factory:function(n){return{uid:n.uid,dom:n.dom,behaviours:Sa(n.dataBehaviours,[fs.config({store:{mode:"memory",initialValue:n.getInitialValue()}}),nf.config({find:Re.some})]),events:sr([lr(function(e,t){fs.setValue(e,n.getInitialValue())})])}},configFields:[jn("uid"),jn("dom"),jn("getInitialValue"),nr("dataBehaviours",[fs,nf])]}),e=b([qn("data"),Yn("inputAttributes",{}),Yn("inputStyles",{}),Yn("tag","input"),Yn("inputClasses",[]),Ie("onSetValue"),Yn("styles",{}),Yn("eventOrder",{}),Kt("inputBehaviours",[fs,gi]),Yn("selectOnFocus",!0)]),uf=ar({name:"Input",configFields:e(),factory:function(e,t){return{uid:e.uid,dom:{tag:(n=e).tag,attributes:y({type:"text"},n.inputAttributes),styles:n.inputStyles,classes:n.inputClasses},components:[],behaviours:js(e),eventOrder:e.eventOrder};var n}}),St=Object.freeze({__proto__:null,exhibit:function(e,t){return lo({attributes:kn([{key:t.tabAttr,value:"true"}])})}}),Je=[Yn("tabAttr","data-alloy-tabstop")],af=po({fields:Je,name:"tabstopping",active:St}),cf=tinymce.util.Tools.resolve("tinymce.util.I18n"),sf=["input","button","textarea","select"],lf=function(t,e,n){e.disableClass.each(function(e){Oe(t.element,e)}),(qs(t,e)?Gs:Xs)(t),e.onDisabled(t)},ff=function(t,e,n){e.disableClass.each(function(e){Ee(t.element,e)}),(qs(t,e)?$s:Ys)(t),e.onEnabled(t)},e=Object.freeze({__proto__:null,enable:ff,disable:lf,isDisabled:Ks,onLoad:Ws,set:function(e,t,n,o){(o?lf:ff)(e,t)}}),Je=Object.freeze({__proto__:null,exhibit:function(e,t){return lo({classes:t.disabled()?t.disableClass.toArray():[]})},events:function(n,e){return sr([no(Dt(),function(e,t){return Ks(e,n)}),fo(n,e,Ws)])}}),St=[Kn("disabled",c,ur),Yn("useNative",!0),qn("disableClass"),Ie("onDisabled"),Ie("onEnabled")],df=po({fields:St,name:"disabling",active:Je,apis:e}),mf=[Kt("formBehaviours",[fs])],gf=function(o,e){return{uid:o.uid,dom:o.dom,components:e,behaviours:Vu(o.formBehaviours,[fs.config({store:{mode:"manual",getValue:function(e){var t,n,t=(t=o,n=e.getSystem(),fe(t.partUids,function(e,t){return b(n.getByUid(e))}));return fe(t,function(e,o){return e().bind(function(e){var t,n=nf.getCurrent(e);return n=n,t=new Error("Cannot find a current component to extract the value from for form part '"+o+"': "+ko(e.element)),n.fold(function(){return vn.error(t)},vn.value)}).map(fs.getValue)})},setValue:function(n,e){sn(e,function(t,e){Yu(n,o,e).each(function(e){nf.getCurrent(e).each(function(e){fs.setValue(e,t)})})})}}})]),apis:{getField:function(e,t){return Yu(e,o,t).bind(nf.getCurrent)}}}},pf=(ea(function(e,t,n){return e.getField(t,n)}),function(e){var o,t=(o=[],{field:function(e,t){return o.push(e),n="form",e=Js(e),t=t,{uiType:Da(),owner:n,name:e,config:t,validated:{}};var n},record:function(){return o}}),e=e(t),t=t.record(),t=S(t,function(e){return Ba({name:e,pname:Js(e)})});return na("form",mf,t,gf,e)}),hf=s(function(n,o){return[{label:"the link group",items:[el({fields:[Us("url","Type or paste URL"),Us("text","Link text"),Us("title","Link title"),Us("target","Link target"),{name:"link",spec:rf.sketch({dom:{tag:"span",styles:{display:"none"}},getInitialValue:function(){return Re.none()}})}],maxFieldIndex:["url","text","title","target"].length-1,getInitialValue:function(){return Re.some(Is(o))},onExecute:function(e,t){e=fs.getValue(e);Ps(o,e),n.restoreToolbar(),o.focus()}})]}]}),Je=sr([{key:Ot(),value:eo({can:function(e,t){var n=t.event,o=n.originator,r=n.target;return t=r,!(X(n=o,e.element)&&!X(n,t))||(console.warn(Ot()+" did not get interpreted by the desired target. \nOriginator: "+ko(o)+"\nTarget: "+ko(r)+"\nCheck the "+Ot()+" event handlers"),!1)}})}]),vf=Object.freeze({__proto__:null,events:Je}),bf=h,yf=nl(),xf=function(e,t){return{cHandler:x.apply(void 0,[e.handler].concat(t)),purpose:e.purpose}},wf=function(e,r){e=fn(e,function(n,o){return(1===n.length?vn.value(n[0].handler):ll(n,r,o)).map(function(e){var t=sl(e),e=1<n.length?O(r[o],function(t){return g(n,function(e){return e.name===t})}).join(" > "):n[0].name;return Xo(o,{handler:t,purpose:e})})});return On(e,{})},Cf="alloy.base.behaviour",Sf=function(e){var t=Hn("external.component",Rn([jn("element"),qn("uid")]),e),n=ho(nl());t.uid.each(function(e){La(t.element,e)});var o={getSystem:n.get,config:Re.none,hasConfigured:c,connect:function(e){n.set(e)},disconnect:function(){n.set(nl(function(){return o}))},getApis:function(){return{}},element:t.element,spec:e,readState:b("No state"),syncComponents:v,components:b([]),events:{}};return Zu(o)},kf=Ha,Of=function(t){return dn(t,Ia).fold(function(){var e=t.hasOwnProperty("uid")?t:y({uid:kf("")},t);return yl(e).getOrDie()},function(e){return e})},_f=Zu,Ef="alloy.item-hover",Tf="alloy.item-focus",Df=b(Ef),Af=b(Tf),e=[jn("data"),jn("components"),jn("dom"),Yn("hasSubmenu",!1),qn("toggling"),nr("itemBehaviours",[li,gi,Ca,fs]),Yn("ignoreFocus",!1),Yn("domModification",{}),Rr("builder",function(e){return{dom:e.dom,domModification:y(y({},e.domModification),{attributes:y(y(y({role:e.toggling.isSome()?"menuitemcheckbox":"menuitem"},e.domModification.attributes),{"aria-haspopup":e.hasSubmenu}),e.hasSubmenu?{"aria-expanded":!1}:{})}),behaviours:Sa(e.itemBehaviours,[e.toggling.fold(li.revoke,function(e){return li.config(y({aria:{mode:"checked"}},e))}),gi.config({ignore:e.ignoreFocus,stopMousedown:e.ignoreFocus,onFocus:function(e){Cl(e)}}),Ca.config({mode:"execution"}),fs.config({store:{mode:"memory",initialValue:e.data}}),Vs("item-type-events",u(Wr(),[oo(pt(),wl),oo(At(),gi.focus)]))]),components:e.components,eventOrder:e.eventOrder}}),Yn("eventOrder",{})],Je=[jn("dom"),jn("components"),Rr("builder",function(e){return{dom:e.dom,components:e.components,events:sr([(e=At(),oo(e,function(e,t){t.stop()}))])}})],Bf=b([Ba({name:"widget",overrides:function(t){return{behaviours:br([fs.config({store:{mode:"manual",getValue:function(e){return t.data},setValue:function(){}}})])}}})]),nr=[jn("uid"),jn("data"),jn("components"),jn("dom"),Yn("autofocus",!1),Yn("ignoreFocus",!1),nr("widgetBehaviours",[fs,gi,Ca]),Yn("domModification",{}),Qu(Bf()),Rr("builder",function(n){function o(e){return Yu(e,n,"widget").map(function(e){return Ca.focusIn(e),e})}var e=$u(0,n,Bf()),t=Xu(Sl(),n,e.internals()),e=function(e,t){return su(t.event.target)||n.autofocus&&t.setSource(e.element),Re.none()};return{dom:n.dom,components:t,domModification:n.domModification,events:sr([mr(function(e,t){o(e).each(function(e){t.stop()})}),oo(pt(),wl),oo(At(),function(e,t){n.autofocus?o(e):gi.focus(e)})]),behaviours:Sa(n.widgetBehaviours,[fs.config({store:{mode:"memory",initialValue:n.data}}),gi.config({ignore:n.ignoreFocus,onFocus:function(e){Cl(e)}}),Ca.config({mode:"special",focusIn:n.autofocus?function(e){o(e)}:wr(),onLeft:e,onRight:e,onEscape:function(e,t){return gi.isFocused(e)||n.autofocus?(n.autofocus&&t.setSource(e.element),Re.none()):(gi.focus(e),Re.some(!0))}})])}})],Nf=zn("type",{widget:nr,item:e,separator:Je}),Je=b([Ar({factory:{sketch:function(e){e=Hn("menu.spec item",Nf,e);return e.builder(e)}},name:"items",unit:"item",defaults:function(e,t){return t.hasOwnProperty("uid")?t:y(y({},t),{uid:Ha("item")})},overrides:function(e,t){return{type:t.type,ignoreFocus:e.fakeFocus,domModification:{classes:[e.markers.item]}}}})]),et=b([jn("value"),jn("items"),jn("dom"),jn("components"),Yn("eventOrder",{}),Kt("menuBehaviours",[au,fs,nf,Ca]),Kn("movement",{mode:"menu",moveOnTab:!0},zn("mode",{grid:[et(),Rr("config",function(e,t){return{mode:"flatgrid",selector:"."+e.markers.item,initSize:{numColumns:t.initSize.numColumns,numRows:t.initSize.numRows},focusManager:e.focusManager}})],matrix:[Rr("config",function(e,t){return{mode:"matrix",selectors:{row:t.rowSelector,cell:"."+e.markers.item},focusManager:e.focusManager}}),jn("rowSelector")],menu:[Yn("moveOnTab",!0),Rr("config",function(e,t){return{mode:"menu",selector:"."+e.markers.item,moveOnTab:t.moveOnTab,focusManager:e.focusManager}})]})),Un("markers",ui()),Yn("fakeFocus",!1),Yn("focusManager",Ui()),Ie("onHighlight")]),Rf=b("alloy.menu-focus"),Mf=gn({name:"Menu",configFields:et(),partFields:Je(),factory:function(e,t,n,o){return{uid:e.uid,dom:e.dom,markers:e.markers,behaviours:Vu(e.menuBehaviours,[au.config({highlightClass:e.markers.selectedItem,itemClass:e.markers.item,onHighlight:e.onHighlight}),fs.config({store:{mode:"memory",initialValue:e.value}}),nf.config({find:Re.some}),Ca.config(e.movement.config(e,e.movement))]),events:sr([oo(Af(),function(t,n){var e=n.event;t.getSystem().getByDom(e.target).each(function(e){au.highlight(t,e),n.stop(),z(t,Rf(),{menu:t,item:e})})}),oo(Df(),function(e,t){t=t.event.item;au.highlight(e,t)})]),components:t,eventOrder:e.eventOrder,domModification:{attributes:{role:"menu"}}}}}),If=function(e,t){return e.components()},Ff=po({fields:[],name:"replacing",apis:Object.freeze({__proto__:null,append:function(e,t,n,o){Ol(e,0,Xt,o)},prepend:function(e,t,n,o){Ol(e,0,ne,o)},remove:_l,replaceAt:El,replaceBy:function(t,e,n,o,r){var i=If(t);return T(i,o).bind(function(e){return El(t,0,0,e,r)})},set:function(t,e,n,o){kl(function(){var e=S(o,t.getSystem().build);se(t,e)},t.element)},contents:If})}),Pf=function(n,o,r,e){return dn(r,e).bind(function(e){return dn(n,e).bind(function(e){var t=Pf(n,o,r,e);return Re.some([e].concat(t))})}).getOr([])},Lf=function(e){return"prepared"===e.type?Re.some(e.menu):Re.none()},Vf={init:function(){function a(n){return function(e,t){for(var n=an(e),o=0,r=n.length;o<r;o++){var i=n[o],u=e[i];if(t(u,i,e))return Re.some(u)}return Re.none()}(r.get(),function(e,t){return e===n})}var r=ho({}),i=ho({}),c=ho({}),s=ho(Re.none()),u=ho({}),l=function(e){return t(e).bind(Lf)},t=function(e){return dn(i.get(),e)},n=function(e){return dn(r.get(),e)};return{setMenuBuilt:function(e,t){var n;i.set(y(y({},i.get()),((n={})[e]={type:"prepared",menu:t},n)))},setContents:function(e,t,n,o){s.set(Re.some(e)),r.set(n),i.set(t),u.set(o);n=Tl(o,n);c.set(n)},expand:function(n){return dn(r.get(),n).map(function(e){var t=dn(c.get(),n).getOr([]);return[e].concat(t)})},refresh:function(e){return dn(c.get(),e)},collapse:function(e){return dn(c.get(),e).bind(function(e){return 1<e.length?Re.some(e.slice(1)):Re.none()})},lookupMenu:t,lookupItem:n,otherMenus:function(e){var t=u.get();return R(an(t),e)},getPrimary:function(){return s.get().bind(l)},getMenus:function(){return i.get()},clear:function(){r.set({}),i.set({}),c.set({}),s.set(Re.none())},isClear:function(){return s.get().isNone()},getTriggeringPath:function(e,u){var t=O(n(e).toArray(),function(e){return l(e).isSome()});return dn(c.get(),e).bind(function(e){var i=N(t.concat(e));return function(e){for(var t=[],n=0;n<e.length;n++){var o=e[n];if(!o.isSome())return Re.none();t.push(o.getOrDie())}return Re.some(t)}(A(i,function(e,t){return n=e,o=u,r=i.slice(0,t+1),l(n).bind(function(t){return a(n).bind(function(e){return o(e).map(function(e){return{triggeredMenu:t,triggeringItem:e,triggeringPath:r}})})}).fold(function(){return s.get().is(e)?[]:[Re.none()]},function(e){return[Re.some(e)]});var n,o,r}))})}}},extractPreparedMenu:Lf},Hf=b("collapse-item"),zf=ar({name:"TieredMenu",configFields:[Ze("onExecute"),Ze("onEscape"),Qe("onOpenMenu"),Qe("onOpenSubmenu"),Ie("onRepositionMenu"),Ie("onCollapseMenu"),Yn("highlightImmediately",!0),Wn("data",[jn("primary"),jn("menus"),jn("expansions")]),Yn("fakeFocus",!1),Ie("onHighlight"),Ie("onHover"),Wn("markers",[jn("backgroundMenu")].concat(ri()).concat(ii())),jn("dom"),Yn("navigateOnHover",!0),Yn("stayInDom",!1),Kt("tmenuBehaviours",[Ca,au,nf,Ff]),Yn("eventOrder",{})],apis:{collapseMenu:function(e,t){e.collapseMenu(t)},highlightPrimary:function(e,t){e.highlightPrimary(t)},repositionMenus:function(e,t){e.repositionMenus(t)}},factory:function(u,e){function n(e){var o,r,e=(o=e,r=u.data.primary,t=u.data.menus,fe(t,function(e,t){function n(){return Mf.sketch(y(y({},e),{value:t,markers:u.markers,fakeFocus:u.fakeFocus,onHighlight:u.onHighlight,focusManager:(u.fakeFocus?Wi:Ui)()}))}return t===r?{type:"prepared",menu:o.getSystem().build(n())}:{type:"notbuilt",nbMenu:n}})),t=g();return m.setContents(u.data.primary,e,u.data.expansions,t),m.getPrimary()}function a(e){return fs.getValue(e).value}function i(t,e){au.highlight(t,e),au.getHighlighted(e).orThunk(function(){return au.getFirst(e)}).each(function(e){U(t,e.element,At())})}function c(t,e){return Li(S(e,function(e){return t.lookupMenu(e).bind(function(e){return"prepared"===e.type?Re.some(e.menu):Re.none()})}))}function s(t,e,n){n=c(e,e.otherMenus(n)),k(n,function(e){ml(e.element,[u.markers.backgroundMenu]),u.stayInDom||Ff.remove(t,e)})}function l(e,n){var t,e=(t=e,o.get().getOrThunk(function(){var n={},e=xi(t.element,"."+u.markers.item),e=O(e,function(e){return"true"===ve(e,"aria-haspopup")});return k(e,function(e){t.getSystem().getByDom(e).each(function(e){var t=a(e);n[t]=e})}),o.set(Re.some(n)),n}));sn(e,function(e,t){t=C(n,t);pe(e.element,"aria-expanded",t)})}function f(n,o,r){return Re.from(r[0]).bind(function(e){return o.lookupMenu(e).bind(function(e){if("notbuilt"===e.type)return Re.none();var t=e.menu,e=c(o,r.slice(1));return k(e,function(e){Oe(e.element,u.markers.backgroundMenu)}),en(t.element)||Ff.append(n,_f(t)),ml(t.element,[u.markers.backgroundMenu]),i(n,t),s(n,o,r),Re.some(t)})})}var d,o=ho(Re.none()),m=Vf.init(),g=function(e){return fe(u.data.menus,function(e,t){return A(e.items,function(e){return"separator"===e.type?[]:[e.data.value]})})};(b=d=d||{})[b.HighlightSubmenu=0]="HighlightSubmenu",b[b.HighlightParent=1]="HighlightParent";function r(o,r,i){void 0===i&&(i=d.HighlightSubmenu);var e=a(r);return m.expand(e).bind(function(n){return l(o,n),Re.from(n[0]).bind(function(t){return m.lookupMenu(t).bind(function(e){e=function(e,t,n){if("notbuilt"!==n.type)return n.menu;n=e.getSystem().build(n.nbMenu());return m.setMenuBuilt(t,n),n}(o,t,e);return en(e.element)||Ff.append(o,_f(e)),u.onOpenSubmenu(o,r,e,N(n)),i===d.HighlightSubmenu?(au.highlightFirst(e),f(o,m,n)):(au.dehighlightAll(e),Re.some(r))})})})}function p(t,n){var e=a(n);return m.collapse(e).bind(function(e){return l(t,e),f(t,m,e).map(function(e){return u.onCollapseMenu(t,n,e),e})})}function t(n){return function(t,e){return _i(e.getSource(),"."+u.markers.item).bind(function(e){return t.getSystem().getByDom(e).toOptional().bind(function(e){return n(t,e).map(function(){return!0})})})}}function h(e){return au.getHighlighted(e).bind(au.getHighlighted)}var v=sr([oo(Rf(),function(t,n){var e=n.event.item;m.lookupItem(a(e)).each(function(){var e=n.event.menu;au.highlight(t,e);e=a(n.event.item);m.refresh(e).each(function(e){return s(t,m,e)})})}),mr(function(t,e){e=e.event.target;t.getSystem().getByDom(e).each(function(e){0===a(e).indexOf("collapse-item")&&p(t,e),r(t,e,d.HighlightSubmenu).fold(function(){u.onExecute(t,e)},function(){})})}),lr(function(t,e){n(t).each(function(e){Ff.append(t,_f(e)),u.onOpenMenu(t,e),u.highlightImmediately&&i(t,e)})})].concat(u.navigateOnHover?[oo(Df(),function(e,t){t=t.event.item;!function(t,e){e=a(e);m.refresh(e).bind(function(e){return l(t,e),f(t,m,e)})}(e,t),r(e,t,d.HighlightParent),u.onHover(e,t)})]:[])),b={collapseMenu:function(t){h(t).each(function(e){p(t,e)})},highlightPrimary:function(t){m.getPrimary().each(function(e){i(t,e)})},repositionMenus:function(n){m.getPrimary().bind(function(t){return h(n).bind(function(e){var t=a(e),e=(e=m.getMenus(),fn(e,function(e){return e})),n=Li(S(e,Vf.extractPreparedMenu));return m.getTriggeringPath(t,function(e){return t=e,F(n,function(e){if(!e.getSystem().isConnected())return Re.none();e=au.getCandidates(e);return E(e,function(e){return a(e)===t})});var t})}).map(function(e){return{primary:t,triggeringPath:e}})}).fold(function(){Re.from(n.components()[0]).filter(function(e){return"menu"===ve(e.element,"role")}).each(function(e){u.onRepositionMenu(n,e,[])})},function(e){var t=e.primary,e=e.triggeringPath;u.onRepositionMenu(n,t,e)})}};return{uid:u.uid,dom:u.dom,markers:u.markers,behaviours:Vu(u.tmenuBehaviours,[Ca.config({mode:"special",onRight:t(function(e,t){return su(t.element)?Re.none():r(e,t,d.HighlightSubmenu)}),onLeft:t(function(e,t){return su(t.element)?Re.none():p(e,t)}),onEscape:t(function(e,t){return p(e,t).orThunk(function(){return u.onEscape(e,t).map(function(){return e})})}),focusIn:function(t,e){m.getPrimary().each(function(e){U(t,e.element,At())})}}),au.config({highlightClass:u.markers.selectedMenu,itemClass:u.markers.menu}),nf.config({find:function(e){return au.getHighlighted(e)}}),Ff.config({})]),eventOrder:u.eventOrder,apis:b,events:v}},extraApis:{tieredData:function(e,t,n){return{primary:e,menus:t,expansions:n}},singleData:function(e,t){return{primary:e,menus:Xo(e,t),expansions:{}}},collapseItem:function(e){return{value:Uu(Hf()),meta:{text:e}}}}}),jf=function(e,t,n,o){return Dl(0,t,0,o).bind(function(t){return t.transition.map(function(e){return{transition:e,route:t}})})},Uf=function(t,n,e){var o=t.element;return be(o,n.destinationAttr).map(function(e){return{start:ve(t.element,n.stateAttr),destination:e}})},Ze=Object.freeze({__proto__:null,findRoute:Dl,disableTransition:Al,getCurrentRoute:Uf,jumpTo:Bl,progressTo:function(t,n,o,r){var i,u;u=n,ye((i=t).element,u.destinationAttr)&&(be(i.element,u.destinationAttr).each(function(e){pe(i.element,u.stateAttr,e)}),xe(i.element,u.destinationAttr));var e,e=(e=r,{start:ve(t.element,n.stateAttr),destination:e});jf(t,n,o,e).fold(function(){Bl(t,n,o,r)},function(e){Al(t,n,o);e=e.transition;Oe(t.element,e.transitionClass),pe(t.element,n.destinationAttr,r)})},getState:function(e,t,n){return be(e.element,t.stateAttr)}}),Qe=Object.freeze({__proto__:null,events:function(r,i){return sr([oo(wt(),function(n,e){var o=e.event.raw;Uf(n,r).each(function(t){Dl(0,r,0,t).each(function(e){e.transition.each(function(e){o.propertyName===e.property&&(Bl(n,r,i,t.destination),r.onTransition(n,t))})})})}),lr(function(e,t){Bl(e,r,i,r.initialState)})])}}),or=[Yn("destinationAttr","data-transitioning-destination"),Yn("stateAttr","data-transitioning-state"),jn("initialState"),Ie("onTransition"),Ie("onFinish"),Un("routes",or(vn.value,or(vn.value,Rn([Xn("transition",[jn("property"),jn("transitionClass")])]))))],Wf=po({fields:or,name:"transitioning",active:Qe,apis:Ze,extra:{createRoutes:function(e){var n={};return sn(e,function(e,t){t=t.split("<->");n[t[0]]=Xo(t[1],e),n[t[1]]=Xo(t[0],e)}),n},createBistate:function(e,t,n){return kn([{key:e,value:Xo(t,n)},{key:t,value:Xo(e,n)}])},createTristate:function(e,t,n,o){return kn([{key:e,value:kn([{key:t,value:o},{key:n,value:o}])},{key:t,value:kn([{key:e,value:o},{key:n,value:o}])},{key:n,value:kn([{key:e,value:o},{key:t,value:o}])}])}}}),qf=di("scrollable"),Gf=qf,$f=function(e,t,n,o,r){return{data:{value:e,text:t},type:"item",dom:{tag:"div",classes:r?[di("styles-item-is-menu")]:[]},toggling:{toggleOnExecute:!1,toggleClass:di("format-matches"),selected:n},itemBehaviours:br(r?[]:[zr(e,function(e,t){(t?li.on:li.off)(e)})]),components:[{dom:{tag:"div",attributes:{style:o},innerHtml:t}}]}},Xf=function(e,t,n,o){return{value:e,dom:{tag:"div"},components:[cs.sketch({dom:{tag:"div",classes:[di("styles-collapser")]},components:o?[{dom:{tag:"span",classes:[di("styles-collapse-icon")]}},xl(e)]:[xl(e)],action:function(e){o&&(e=n().get(e),zf.collapseMenu(e))}}),{dom:{tag:"div",classes:[di("styles-menu-items-container")]},components:[Mf.parts.items({})],behaviours:br([Vs("adhoc-scrollable-menu",[lr(function(e,t){Xr(e.element,"overflow-y","auto"),Xr(e.element,"-webkit-overflow-scrolling","touch"),Nl(e.element)}),fr(function(e){Qr(e.element,"overflow-y"),Qr(e.element,"-webkit-overflow-scrolling"),Rl(e.element)})])])}],items:t,menuBehaviours:br([Wf.config({initialState:"after",routes:Wf.createTristate("before","current","after",{transition:{property:"transform",transitionClass:"transitioning"}})})])}},Yf=function(e){return p(e,function(e,t){t=Fl(t);return{menus:zo(e.menus,t.menus),items:[t.item].concat(e.items),expansions:zo(e.expansions,t.expansions)}},{menus:{},expansions:{},items:[]})},Kf=function(e){return A(e,function(e){return(Le(e)?Kf:Vl)(e)})},Jf=function(e,t,n,o){e.dom.removeEventListener(t,n,o)},Qf=w,Zf=tinymce.util.Tools.resolve("tinymce.util.Delay"),ed=Lo([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]),td=(ed.ltr,ed.rtl,function(e,t,n,o){return{start:e,soffset:t,finish:n,foffset:o}});function nd(e){return"img"===Y(e)?1:_d.getOption(e).fold(function(){return $t(e).length},function(e){return e.length})}function od(e,t){var n=Y(e);return"input"===n?Ed.after(e):C(["br","img"],n)?0===t?Ed.before(e):Ed.after(e):Ed.on(e,t)}function rd(e,t,n,o){var r,i,u,a,c=(i=t,u=n,a=o,(c=K(r=e).dom.createRange()).setStart(r.dom,i),c.setEnd(u.dom,a),c),o=X(e,n)&&t===o;return c.collapsed&&!o}function id(e){return Re.from(e.getSelection())}function ud(e,t,n,o,r){var i,r=Yl(e,t,n,o,r);i=r,id(e).each(function(e){e.removeAllRanges(),e.addRange(i)})}function ad(c,e){return Ql(c,e).match({ltr:function(e,t,n,o){ud(c,e,t,n,o)},rtl:function(r,i,u,a){id(c).each(function(e){if(e.setBaseAndExtent)e.setBaseAndExtent(r.dom,i,u.dom,a);else if(e.extend)try{n=u,o=a,(t=e).collapse(r.dom,i),t.extend(n.dom,o)}catch(e){ud(c,u,a,r,i)}else ud(c,u,a,r,i);var t,n,o})}})}function cd(e,t,n,o,r){r=function(e,t,n,o){t=od(e,t),o=od(n,o);return Dd.relative(t,o)}(t,n,o,r),ad(e,r)}function sd(e){if(0<e.rangeCount){var t=e.getRangeAt(0),e=e.getRangeAt(e.rangeCount-1);return Re.some(td(zt.fromDom(t.startContainer),t.startOffset,zt.fromDom(e.endContainer),e.endOffset))}return Re.none()}function ld(e){if(null===e.anchorNode||null===e.focusNode)return sd(e);var t=zt.fromDom(e.anchorNode),n=zt.fromDom(e.focusNode);return rd(t,e.anchorOffset,n,e.focusOffset)?Re.some(td(t,e.anchorOffset,n,e.focusOffset)):sd(e)}function fd(e){return id(e).filter(function(e){return 0<e.rangeCount}).bind(ld)}function dd(e,t){var i,e=Ql(i=e,t).match({ltr:function(e,t,n,o){var r=i.document.createRange();return r.setStart(e.dom,t),r.setEnd(n.dom,o),r},rtl:function(e,t,n,o){var r=i.document.createRange();return r.setStart(n.dom,o),r.setEnd(e.dom,t),r}});return 0<(t=0<(e=(t=e).getClientRects()).length?e[0]:t.getBoundingClientRect()).width||0<t.height?Re.some(t).map(Kl):Re.none()}function md(e){return Re.from(e.dom.contentWindow)}function gd(e){return md(e).bind(fd)}function pd(e){return e.getFrame()}function hd(e,t,n,o){return e[n].getOrThunk(function(){return function(e){return Wl(t,o,e)}})}function vd(a){var c=pd(a);return Re.some(zt.fromDom(c.dom.contentWindow.document.body)).bind(function(u){return Re.some(zt.fromDom(c.dom.contentWindow.document)).bind(function(i){return md(c).map(function(r){var e=zt.fromDom(i.dom.documentElement),t=a.getCursorBox.getOrThunk(function(){return function(){return fd(r).map(function(e){return Dd.exact(e.start,e.soffset,e.finish,e.foffset)}).bind(function(e){return dd(r,e).orThunk(function(){return fd(r).filter(function(e){return X(e.start,e.finish)&&e.soffset===e.foffset}).bind(function(e){e=e.start.dom.getBoundingClientRect();return 0<e.width||0<e.height?Re.some(e):Re.none()})})})}}),n=a.setSelection.getOrThunk(function(){return function(e,t,n,o){cd(r,e,t,n,o)}}),o=a.clearSelection.getOrThunk(function(){return function(){id(r).each(function(e){return e.removeAllRanges()})}});return{body:u,doc:i,win:r,html:e,getSelection:x(gd,c),setSelection:n,clearSelection:o,frame:c,onKeyup:hd(a,i,"onKeyup","keyup"),onNodeChanged:hd(a,i,"onNodeChanged","SelectionChange"),onDomChanged:a.onDomChanged,onScrollToCursor:a.onScrollToCursor,onScrollToElement:a.onScrollToElement,onToReading:a.onToReading,onToEditing:a.onToEditing,onToolbarScrollStart:a.onToolbarScrollStart,onTouchContent:a.onTouchContent,onTapContent:a.onTapContent,onTouchToolstrip:a.onTouchToolstrip,getCursorBox:t}})})})}function bd(){var t=$("head").getOrDie(),e=$('meta[name="viewport"]').getOrThunk(function(){var e=zt.fromTag("meta");return pe(e,"name","viewport"),Xt(t,e),e}),n=ve(e,"content");return{maximize:function(){pe(e,"content","width=device-width, initial-scale=1.0, user-scalable=no, maximum-scale=1.0")},restore:function(){null!=n&&0<n.length?pe(e,"content",n):pe(e,"content","user-scalable=yes")}}}function yd(e,t){function n(n){return function(e){var t=ve(e,"style"),t=void 0===t?"no-styles":t.trim();t===n||(pe(e,Bd,t),pe(e,"style",n))}}var o,r=(o="*",bi(e,function(e){return W(e,o)},i)),i=A(r,function(e){return t="*",yi(e,function(e){return W(e,t)});var t}),t=function(e){e=Kr(e,"background-color");return void 0!==e&&""!==e?"background-color:"+e+"!important":"background-color:rgb(255,255,255)!important;"}(t);k(i,n("display:none!important;")),k(r,n(Nd+Rd+t)),n((!0===Md?"":Nd)+Rd+t)(e)}function xd(){var e=G("["+Bd+"]");k(e,function(e){var t=ve(e,Bd);"no-styles"!==t?pe(e,"style",t):xe(e,"style"),xe(e,Bd)})}var wd,Cd,Sd,kd,Od,_d=(wd=Wt,Cd="text",{get:function(e){if(!wd(e))throw new Error("Can only get "+Cd+" value of a "+Cd+" node");return Sd(e).getOr("")},getOption:Sd=function(e){return wd(e)?Re.from(e.dom.nodeValue):Re.none()},set:function(e,t){if(!wd(e))throw new Error("Can only set raw "+Cd+" value of a "+Cd+" node");e.dom.nodeValue=t}}),Qe=Lo([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),Ed={before:Qe.before,on:Qe.on,after:Qe.after,cata:function(e,t,n,o){return e.fold(t,n,o)},getStart:function(e){return e.fold(h,h,h)}},Td=Lo([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),Dd={domRange:Td.domRange,relative:Td.relative,exact:Td.exact,exactFromRange:function(e){return Td.exact(e.start,e.soffset,e.finish,e.foffset)},getWin:function(e){e=e.match({domRange:function(e){return zt.fromDom(e.startContainer)},relative:function(e,t){return Ed.getStart(e)},exact:function(e,t,n,o){return e}});return zt.fromDom(J(e).dom.defaultView)},range:td},Ad=(kd="getWin",Od=md,function(t){return t[kd].getOrThunk(function(){var e=pd(t);return function(){return Od(e)}})()}),Bd="data-ephox-mobile-fullscreen-style",Nd="position:absolute!important;",Rd="top:0!important;left:0!important;margin:0!important;padding:0!important;width:100%!important;height:100%!important;overflow:visible!important;",Md=at().os.isAndroid();function Id(e){return void 0===(e=e.raw).touches||1!==e.touches.length?Re.none():Re.some(e.touches[0])}function Fd(n){var o,r,i,u=ho(Re.none()),a=ho(!1),c=(o=function(e){n.triggerEvent(Nt(),e),a.set(!0)},r=400,i=null,{cancel:function(){null!==i&&(clearTimeout(i),i=null)},schedule:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];i=setTimeout(function(){o.apply(null,e),i=null},r)}}),s=kn([{key:st(),value:function(t){return Id(t).each(function(e){c.cancel();e={x:e.clientX,y:e.clientY,target:t.target};c.schedule(t),a.set(!1),u.set(Re.some(e))}),Re.none()}},{key:lt(),value:function(e){return c.cancel(),Id(e).each(function(o){u.get().each(function(e){var t,n;t=o,n=e,e=Math.abs(t.clientX-n.x),n=Math.abs(t.clientY-n.y),(5<e||5<n)&&u.set(Re.none())})}),Re.none()}},{key:ft(),value:function(t){c.cancel();return u.get().filter(function(e){return X(e.target,t.target)}).map(function(e){return a.get()?(t.prevent(),!1):n.triggerEvent(Bt(),t)})}}]);return{fireIfReady:function(t,e){return dn(s,e).bind(function(e){return e(t)})}}}function Pd(n){var t=Fd({triggerEvent:function(e,t){n.onTapContent(t)}});return{fireTouchstart:function(e){t.fireIfReady(e,"touchstart")},onTouchend:function(){return Wl(n.body,"touchend",function(e){t.fireIfReady(e,"touchend")})},onTouchmove:function(){return Wl(n.body,"touchmove",function(e){t.fireIfReady(e,"touchmove")})}}}function Ld(n,t,o){function r(e){return!X(e.start,e.finish)||e.soffset!==e.foffset}function e(){var e=n.doc.dom.hasFocus()&&n.getSelection().exists(r);o.getByDom(t).each(!0===(e||yo(u).filter(function(e){return"input"===Y(e)}).exists(function(e){return e.dom.selectionStart!==e.dom.selectionEnd}))?li.on:li.off)}var i=Pd(n),u=K(t),a=[Wl(n.body,"touchstart",function(e){n.onTouchContent(),i.fireTouchstart(e)}),i.onTouchmove(),i.onTouchend(),Wl(t,"touchstart",function(e){n.onTouchToolstrip()}),n.onToReading(function(){bo(n.body)}),n.onToEditing(v),n.onScrollToCursor(function(e){e.preventDefault(),n.getCursorBox().each(function(e){var t=n.win,e=e.top>t.innerHeight||e.bottom>t.innerHeight?e.bottom-t.innerHeight+50:0;0!=e&&t.scrollTo(t.pageXOffset,t.pageYOffset+e)})})].concat(!0==Sm?[]:[Wl(zt.fromDom(n.win),"blur",function(){o.getByDom(t).each(li.off)}),Wl(u,"select",e),Wl(n.doc,"selectionchange",e)]);return{destroy:function(){k(a,function(e){e.unbind()})}}}function Vd(e,t){return t=parseInt(ve(e,t),10),isNaN(t)?0:t}function Hd(e){return y(y({},e),{width:2})}function zd(e){return{left:e.left,top:e.top,right:e.right,bottom:e.bottom,width:e.width,height:e.height}}function jd(e){return void 0!==(e=e.getSelection())&&0<e.rangeCount?function(t){if(t.collapsed){var n=zt.fromDom(t.startContainer);return Q(n).bind(function(e){e=Dd.exact(n,t.startOffset,e,nd(e));return dd(t.startContainer.ownerDocument.defaultView,e).map(Hd).map(M)}).getOr([])}return S(t.getClientRects(),zd)}(e.getRangeAt(0)):[]}function Ud(e){e.focus();var t=zt.fromDom(e.document.body);(yo().exists(function(e){return C(["input","textarea"],Y(e))})?function(e){Zf.setTimeout(function(){e()},0)}:r)(function(){yo().each(bo),vo(t)})}function Wd(e,t){pe(e,km,t)}function qd(e){return{top:e.top,bottom:e.top+e.height}}function Gd(e,t){return t=Vd(t,km),(e=e.innerHeight)<t?Re.some(t-e):Re.none()}function $d(e,r){var t=zt.fromDom(r.document.body),n=Wl(zt.fromDom(e),"resize",function(){Gd(e,t).each(function(o){!function(e){e=jd(e);return 0<e.length?Re.some(e[0]).map(qd):Re.none()}(r).each(function(e){var t,n,t=(t=r,n=o,(e=e).top>t.innerHeight||e.bottom>t.innerHeight?Math.min(n,e.bottom-t.innerHeight+50):0);0!==t&&r.scrollTo(r.pageXOffset,r.pageYOffset+t)})}),Wd(t,e.innerHeight)});return Wd(t,e.innerHeight),{toEditing:function(){Ud(r)},destroy:function(){n.unbind()}}}function Xd(n,o){var r=null;return{cancel:function(){null!==r&&(clearTimeout(r),r=null)},throttle:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];null!==r&&clearTimeout(r),r=setTimeout(function(){n.apply(null,e),r=null},o)}}}function Yd(e,t){var n,o,r,i=ns(of.sketch({dom:Ua('<div aria-hidden="true" class="${prefix}-mask-tap-icon"></div>'),containerBehaviours:br([li.config({toggleClass:di("mask-tap-icon-selected"),toggleOnExecute:!1})])})),u=(n=e,o=200,r=null,{cancel:function(){null!==r&&(clearTimeout(r),r=null)},throttle:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];null===r&&(r=setTimeout(function(){n.apply(null,e),r=null},o))}});return of.sketch({dom:Ua('<div class="${prefix}-disabled-mask"></div>'),components:[of.sketch({dom:Ua('<div class="${prefix}-content-container"></div>'),components:[cs.sketch({dom:Ua('<div class="${prefix}-content-tap-section"></div>'),components:[i.asSpec()],action:function(e){u.throttle()},buttonBehaviours:br([li.config({toggleClass:di("mask-tap-icon-selected")})])})]})]})}function Kd(e){var t=Hn("Getting AndroidWebapp schema",Om,e);Xr(t.toolstrip,"width","100%");var n=Of(Yd(function(){t.setReadOnly(t.readOnlyOnInit()),c.enter()},t.translate));t.alloy.add(n),e={show:function(){t.alloy.add(n)},hide:function(){t.alloy.remove(n)}},Xt(t.container,n.element);var o,r,i,u,a,c=(o=t,r=e,i=bd(),u=Qs(),a=Qs(),{enter:function(){r.hide(),Oe(o.container,di("fullscreen-maximized")),Oe(o.container,di("android-maximized")),i.maximize(),Oe(o.body,di("android-scroll-reload")),u.set($d(o.win,Ad(o.editor).getOrDie("no"))),vd(o.editor).each(function(e){yd(o.container,e.body),a.set(Ld(e,o.toolstrip,o.alloy))})},exit:function(){i.restore(),r.show(),Ee(o.container,di("fullscreen-maximized")),Ee(o.container,di("android-maximized")),xd(),Ee(o.body,di("android-scroll-reload")),a.clear(),u.clear()}});return{setReadOnly:t.setReadOnly,refreshStructure:v,enter:c.enter,exit:c.exit,destroy:v}}function Jd(e){return"true"===ve(e,Tm)?0<(t=e).dom.scrollLeft||function(e){e.dom.scrollLeft=1;var t=0!==e.dom.scrollLeft;return e.dom.scrollLeft=0,t}(t):0<(e=e).dom.scrollTop||function(e){e.dom.scrollTop=1;var t=0!==e.dom.scrollTop;return e.dom.scrollTop=0,t}(e);var t}function Qd(){function t(e){var t=!0===e.scrollable?"${prefix}-toolbar-scrollable-group":"";return{dom:Ua('<div aria-label="'+e.label+'" class="${prefix}-toolbar-group '+t+'"></div>'),tgroupBehaviours:br([Vs("adhoc-scrollable-toolbar",!0===e.scrollable?[dr(function(e,t){var n;Xr(e.element,"overflow-x","auto"),n=e.element,pe(n,Tm,"true"),Nl(e.element)})]:[])]),components:[of.sketch({components:[Em.parts.items({})]})],markers:{itemSelector:"."+di("toolbar-group-item")},items:e.items}}function n(){_m.setGroups(o,r.get()),li.off(o)}var o=Of(_m.sketch({dom:Ua('<div class="${prefix}-toolbar"></div>'),components:[_m.parts.groups({})],toolbarBehaviours:br([li.config({toggleClass:di("context-toolbar"),toggleOnExecute:!1,aria:{mode:"none"}}),Ca.config({mode:"cyclic"})]),shell:!0})),e=Of(of.sketch({dom:{classes:[di("toolstrip")]},components:[_f(o)],containerBehaviours:br([li.config({toggleClass:di("android-selection-context-toolbar"),toggleOnExecute:!1})])})),r=ho([]);return{wrapper:e,toolbar:o,createGroups:function(e){return S(e,i(Em.sketch,t))},setGroups:function(e){r.set(e),n()},setContextToolbar:function(e){li.on(o),_m.setGroups(o,e)},restoreToolbar:function(){li.isOn(o)&&n()},refresh:function(){},focus:function(){Ca.focusIn(o)}}}function Zd(e){return Of(cs.sketch({dom:Ua('<div class="${prefix}-mask-edit-icon ${prefix}-icon"></div>'),action:function(){e.run(function(e){e.setReadOnly(!1)})}}))}function em(){return Of(of.sketch({dom:Ua('<div class="${prefix}-editor-socket"></div>'),components:[],containerBehaviours:br([Ff.config({})])}))}function tm(e,t){Ff.append(e,_f(t))}function nm(e,t){Ff.remove(e,t)}function om(e,t,n,o){(!0===n?Cr.toAlpha:Cr.toOmega)(o),(n?tm:nm)(e,t)}function rm(t,e){return e.getAnimationRoot.fold(function(){return t.element},function(e){return e(t)})}function im(e){return e.dimension.property}function um(e,t){return e.dimension.getDimension(t)}function am(e,t){e=rm(e,t),ml(e,[t.shrinkingClass,t.growingClass])}function cm(e,t){Ee(e.element,t.openClass),Oe(e.element,t.closedClass),Xr(e.element,im(t),"0px"),Zr(e.element)}function sm(e,t){Ee(e.element,t.closedClass),Oe(e.element,t.openClass),Qr(e.element,im(t))}function lm(e,t,n,o){n.setCollapsed(),Xr(e.element,im(t),um(t,e.element)),Zr(e.element),am(e,t),cm(e,t),t.onStartShrink(e),t.onShrunk(e)}function fm(e,t,n,o){o=o.getOrThunk(function(){return um(t,e.element)}),n.setCollapsed(),Xr(e.element,im(t),o),Zr(e.element),o=rm(e,t),Ee(o,t.growingClass),Oe(o,t.shrinkingClass),cm(e,t),t.onStartShrink(e)}function dm(e,t,n){var o=um(t,e.element);("0px"===o?lm:fm)(e,t,n,Re.some(o))}function mm(e,t,n){var o=rm(e,t),r=Te(o,t.shrinkingClass),i=um(t,e.element);sm(e,t);var u=um(t,e.element);(r?function(){Xr(e.element,im(t),i),Zr(e.element)}:function(){cm(e,t)})(),Ee(o,t.shrinkingClass),Oe(o,t.growingClass),sm(e,t),Xr(e.element,im(t),u),n.setExpanded(),t.onStartGrow(e)}function gm(e,t,n){return e=rm(e,t),!0===Te(e,t.growingClass)}function pm(e,t,n){return e=rm(e,t),!0===Te(e,t.shrinkingClass)}function hm(t,n){var o=Of(of.sketch({dom:{tag:"div",classes:[di("dropup")]},components:[],containerBehaviours:br([Ff.config({}),Dm.config({closedClass:di("dropup-closed"),openClass:di("dropup-open"),shrinkingClass:di("dropup-shrinking"),growingClass:di("dropup-growing"),dimension:{property:"height"},onShrunk:function(e){t(),n(),Ff.set(e,[])},onGrown:function(e){t(),n()}}),jr(function(e,t){r(v)})])})),r=function(e){window.requestAnimationFrame(function(){e(),Dm.shrink(o)})};return{appear:function(e,t,n){!0===Dm.hasShrunk(o)&&!1===Dm.isTransitioning(o)&&window.requestAnimationFrame(function(){t(n),Ff.set(o,[e()]),Dm.grow(o)})},disappear:r,component:o,element:o.element}}function vm(e){var t;return e.raw.which===Gi[0]&&!C(["input","textarea"],Y(e.target))&&(e=e.target,!_i(e,'[contenteditable="true"]',t).isSome())}function bm(){return at().browser.isFirefox()}function ym(t,e){var n,o=Hn("Getting GUI events settings",Am,e),r=Fd(o),i=S(["touchstart","touchmove","touchend","touchcancel","gesturestart","mousedown","mouseup","mouseover","mousemove","mouseout","click"].concat(["selectstart","input","contextmenu","change","transitionend","drag","dragstart","dragend","dragenter","dragleave","dragover","drop","keyup"]),function(e){return Wl(t,e,function(t){r.fireIfReady(t,e).each(function(e){e&&t.kill()}),o.triggerEvent(e,t)&&t.kill()})}),u=ho(Re.none()),a=Wl(t,"paste",function(t){r.fireIfReady(t,"paste").each(function(e){e&&t.kill()}),o.triggerEvent("paste",t)&&t.kill(),u.set(Re.some(setTimeout(function(){o.triggerEvent(Et(),t)},0)))}),c=Wl(t,"keydown",function(e){o.triggerEvent("keydown",e)?e.kill():!0===o.stopBackspace&&vm(e)&&e.prevent()}),s=(n=t,e=function(e){o.triggerEvent("focusin",e)&&e.kill()},bm()?ql(n,"focus",e):Wl(n,"focusin",e)),l=ho(Re.none()),f=(n=t,e=function(e){o.triggerEvent("focusout",e)&&e.kill(),l.set(Re.some(setTimeout(function(){o.triggerEvent(_t(),e)},0)))},bm()?ql(n,"blur",e):Wl(n,"focusout",e));return{unbind:function(){k(i,function(e){e.unbind()}),c.unbind(),s.unbind(),f.unbind(),a.unbind(),u.get().each(clearTimeout),l.get().each(clearTimeout)}}}function xm(e,t){return t=dn(e,"target").getOr(t),ho(t)}function wm(e,o,t,n,r,i){var u,a,e=e(o,n),c=(u=ho(!1),a=ho(!1),{stop:function(){u.set(!0)},cut:function(){a.set(!0)},isStopped:u.get,isCut:a.get,event:t,setSource:r.set,getSource:r.get});return e.fold(function(){return i.logEventNoHandlers(o,n),Bm.complete()},function(t){var n=t.descHandler;return ul(n)(c),c.isStopped()?(i.logEventStopped(o,t.element,n.purpose),Bm.stopped()):c.isCut()?(i.logEventCut(o,t.element,n.purpose),Bm.complete()):Q(t.element).fold(function(){return i.logNoParent(o,t.element,n.purpose),Bm.complete()},function(e){return i.logEventResponse(o,t.element,n.purpose),Bm.resume(e)})})}function Cm(e,t,n){var o,r=(o=ho(!1),{stop:function(){o.set(!0)},cut:v,isStopped:o.get,isCut:c,event:t,setSource:a("Cannot set source of a broadcasted event"),getSource:a("Cannot get source of a broadcasted event")});return k(e,function(e){e=e.descHandler;ul(e)(r)}),r.isStopped()}var Sm=6<=at().os.version.major,km="data-"+di("last-outer-height"),Ze=b({unbind:v}),Om=Qo([Wn("editor",[jn("getFrame"),qn("getBody"),qn("getDoc"),qn("getWin"),qn("getSelection"),qn("setSelection"),qn("clearSelection"),qn("cursorSaver"),qn("onKeyup"),qn("onNodeChanged"),qn("getCursorBox"),jn("onDomChanged"),Yn("onTouchContent",v),Yn("onTapContent",v),Yn("onTouchToolstrip",v),Yn("onScrollToCursor",Ze),Yn("onScrollToElement",Ze),Yn("onToEditing",Ze),Yn("onToReading",Ze),Yn("onToolbarScrollStart",h)]),jn("socket"),jn("toolstrip"),jn("dropup"),jn("toolbar"),jn("container"),jn("alloy"),er("win",function(e){return K(e.socket).dom.defaultView}),er("body",function(e){return zt.fromDom(e.socket.dom.ownerDocument.body)}),Yn("translate",h),Yn("setReadOnly",v),Yn("readOnlyOnInit",w)]),Qe=b([jn("dom"),Yn("shell",!0),Kt("toolbarBehaviours",[Ff])]),Ze=b([Na({name:"groups",overrides:function(){return{behaviours:br([Ff.config({})])}}})]),_m=gn({name:"Toolbar",configFields:Qe(),partFields:Ze(),factory:function(t,e,n,o){var r=function(e){return t.shell?Re.some(e):Yu(e,t,"groups")},e=t.shell?{behaviours:[Ff.config({})],components:[]}:{behaviours:[],components:e};return{uid:t.uid,dom:t.dom,components:e.components,behaviours:Vu(t.toolbarBehaviours,e.behaviours),apis:{setGroups:function(e,t){r(e).fold(function(){throw console.error("Toolbar was defined to not be a shell, but no groups container was specified in components"),new Error("Toolbar was defined to not be a shell, but no groups container was specified in components")},function(e){Ff.set(e,t)})}},domModification:{attributes:{role:"group"}}}},apis:{setGroups:function(e,t,n){e.setGroups(t,n)}}}),Kt=b([jn("items"),Wn("markers",S(["itemSelector"],jn)),Kt("tgroupBehaviours",[Ca])]),Ar=b([Ar({name:"items",unit:"item"})]),Em=gn({name:"ToolbarGroup",configFields:Kt(),partFields:Ar(),factory:function(e,t,n,o){return{uid:e.uid,dom:e.dom,components:t,behaviours:Vu(e.tgroupBehaviours,[Ca.config({mode:"flow",selector:e.markers.itemSelector})]),domModification:{attributes:{role:"toolbar"}}}}}),Tm="data-"+di("horizontal-scroll"),Kt=Object.freeze({__proto__:null,refresh:function(e,t,n){n.isExpanded()&&(Qr(e.element,im(t)),n=um(t,e.element),Xr(e.element,im(t),n))},grow:function(e,t,n){n.isExpanded()||mm(e,t,n)},shrink:function(e,t,n){n.isExpanded()&&dm(e,t,n)},immediateShrink:function(e,t,n){n.isExpanded()&&lm(e,t,n,Re.none())},hasGrown:function(e,t,n){return n.isExpanded()},hasShrunk:function(e,t,n){return n.isCollapsed()},isGrowing:gm,isShrinking:pm,isTransitioning:function(e,t,n){return!0===gm(e,t)||!0===pm(e,t)},toggleGrow:function(e,t,n){(n.isExpanded()?dm:mm)(e,t,n)},disableTransitions:am}),Ar=Object.freeze({__proto__:null,exhibit:function(e,t,n){var o=t.expanded;return lo(o?{classes:[t.openClass],styles:{}}:{classes:[t.closedClass],styles:Xo(t.dimension.property,"0px")})},events:function(n,o){return sr([(e=wt(),io(e)(function(e,t){t.event.raw.propertyName===n.dimension.property&&(am(e,n),o.isExpanded()&&Qr(e.element,n.dimension.property),(o.isExpanded()?n.onGrown:n.onShrunk)(e))}))]);var e}}),Ie=[jn("closedClass"),jn("openClass"),jn("shrinkingClass"),jn("growingClass"),qn("getAnimationRoot"),Ie("onShrunk"),Ie("onStartShrink"),Ie("onGrown"),Ie("onStartGrow"),Yn("expanded",!1),Un("dimension",zn("property",{width:[Rr("property","width"),Rr("getDimension",function(e){return Qa(e)+"px"})],height:[Rr("property","height"),Rr("getDimension",function(e){return vi(e)+"px"})]}))],Dm=po({fields:Ie,name:"sliding",active:Ar,apis:Kt,state:Object.freeze({__proto__:null,init:function(e){var t=ho(e.expanded);return vr({isExpanded:function(){return!0===t.get()},isCollapsed:function(){return!1===t.get()},setCollapsed:x(t.set,!1),setExpanded:x(t.set,!0),readState:function(){return"expanded: "+t.get()}})}})}),Am=Rn([Un("triggerEvent",ur),Yn("stopBackspace",!0)]),Bm=Lo([{stopped:[]},{resume:["element"]},{complete:[]}]),Nm=function(t,n,o,e,r,i){return wm(t,n,o,e,r,i).fold(function(){return!0},function(e){return Nm(t,n,o,e,r,i)},function(){return!1})},Rm=function(e,t,n,o,r){var i=xm(n,o);return Nm(e,t,n,o,i,r)},Mm=function(e,t){return{element:e,descHandler:t}},Im=function(e,t){return{id:e,descHandler:t}};function Fm(){var i={};return{registerId:function(o,r,e){sn(e,function(e,t){var n=void 0!==i[t]?i[t]:{};n[r]=xf(e,o),i[t]=n})},unregisterId:function(n){sn(i,function(e,t){e.hasOwnProperty(n)&&delete e[n]})},filterByType:function(e){return dn(i,e).map(function(e){return fn(e,function(e,t){return Im(t,e)})}).getOr([])},find:function(e,t,n){var r=dn(i,t);return cr(n,function(e){return n=r,Va(o=e).fold(function(){return Re.none()},function(t){return n.bind(function(e){return dn(e,t)}).map(function(e){return Mm(o,e)})});var n,o},e)}}}function Pm(){function n(e){var t=e.element;return Va(t).fold(function(){return function(e,t){e=Uu(Fa+e);return La(t,e),e}("uid-",e.element)},function(e){return e})}var o=Fm(),r={},i=function(e){Va(e.element).each(function(e){delete r[e],o.unregisterId(e)})};return{find:function(e,t,n){return o.find(e,t,n)},filter:function(e){return o.filterByType(e)},register:function(e){var t=n(e);me(r,t)&&function(e,t){var n=r[t];if(n!==e)throw new Error('The tagId "'+t+'" is already used by: '+ko(n.element)+"\nCannot use it for: "+ko(e.element)+"\nThe conflicting element is"+(en(n.element)?" ":" not ")+"already in the DOM");i(e)}(e,t),o.registerId([e],t,e.events),r[t]=e},unregister:i,getById:function(e){return dn(r,e)}}}var Lm=function(n){function o(t){return Q(n.element).fold(function(){return!0},function(e){return X(t,e)})}function c(e,t){return i.find(o,e,t)}function r(t){var e=i.filter(Tt());k(e,function(e){e=e.descHandler;ul(e)(t)})}var i=Pm(),e=ym(n.element,{triggerEvent:function(t,n){return Br(t,n.target,function(e){return Rm(c,t,n,n.target,e)})}}),u={debugInfo:b("real"),triggerEvent:function(t,n,o){Br(t,n,function(e){return Rm(c,t,o,n,e)})},triggerFocus:function(u,a){Va(u).fold(function(){vo(u)},function(e){Br(Ot(),u,function(e){var t,n,o,r,i;return t=c,n=Ot(),i=e,e=xm(o={originator:a,kill:v,prevent:v,target:u},r=u),wm(t,n,o,r,e,i),!1})})},triggerEscape:function(e,t){u.triggerEvent("keydown",e.element,t.event)},getByUid:function(e){return g(e)},getByDom:function(e){return p(e)},build:Of,addToGui:function(e){s(e)},removeFromGui:function(e){l(e)},addToWorld:function(e){t(e)},removeFromWorld:function(e){a(e)},broadcast:function(e){f(e)},broadcastOn:function(e,t){d(e,t)},broadcastEvent:function(e,t){m(e,t)},isConnected:w},t=function(e){e.connect(u),Wt(e.element)||(i.register(e),k(e.components(),t),u.triggerEvent(Rt(),e.element,{target:e.element}))},a=function(e){Wt(e.element)||(k(e.components(),a),i.unregister(e)),e.disconnect()},s=function(e){rn(n,e,Xt)},l=function(e){le(e)},f=function(e){r({universal:!0,data:e})},d=function(e,t){r({universal:!1,channels:e,data:t})},m=function(e,t){e=i.filter(e);return Cm(e,t)},g=function(e){return i.getById(e).fold(function(){return vn.error(new Error('Could not find component with uid: "'+e+'" in system.'))},vn.value)},p=function(e){e=Va(e).getOr("not found");return g(e)};return t(n),{root:n,element:n.element,destroy:function(){e.unbind(),Yt(n.element)},add:s,remove:l,getByUid:g,getByDom:p,addToWorld:t,removeFromWorld:a,broadcast:f,broadcastOn:d,broadcastEvent:m}},Vm=di("readonly-mode"),Hm=di("edit-mode");function zm(e){e=Of(of.sketch({dom:{classes:[di("outer-container")].concat(e.classes)},containerBehaviours:br([Cr.config({alpha:Vm,omega:Hm})])}));return Lm(e)}function jm(e,t){var n=zt.fromTag("input");Yr(n,{opacity:"0",position:"absolute",top:"-1000px",left:"-1000px"}),Xt(e,n),vo(n),t(n),Yt(n)}function Um(e){var t,n=e.getSelection();0<n.rangeCount&&(t=n.getRangeAt(0),(e=e.document.createRange()).setStart(t.startContainer,t.startOffset),e.setEnd(t.endContainer,t.endOffset),n.removeAllRanges(),n.addRange(e))}function Wm(e,t){yo().each(function(e){X(e,t)||bo(e)}),e.focus(),vo(zt.fromDom(e.document.body)),Um(e)}function qm(e,t,n,o){function r(){Wm(t,o)}var i=Wl(n,"keydown",function(e){C(["input","textarea"],Y(e.target))||r()});return{toReading:function(){jm(e,bo)},toEditing:r,onToolbarTouch:function(){},destroy:function(){i.unbind()}}}function Gm(n,o,r,i,e){function u(){o.run(function(e){e.refreshSelection()})}function t(e,t){var n=e-i.dom.scrollTop;o.run(function(e){e.scrollIntoView(n,n+t)})}function a(){o.run(function(e){e.clearSelection()})}function c(){n.getCursorBox().each(function(e){t(e.top,e.height)}),o.run(function(e){e.syncHeight()})}var s=Pd(n),l=Xd(c,300),f=[n.onKeyup(function(){a(),l.throttle()}),n.onNodeChanged(u),n.onDomChanged(l.throttle),n.onDomChanged(u),n.onScrollToCursor(function(e){e.preventDefault(),l.throttle()}),n.onScrollToElement(function(e){e.element,t(o,i)}),n.onToEditing(function(){o.run(function(e){e.toEditing()})}),n.onToReading(function(){o.run(function(e){e.toReading()})}),Wl(n.doc,"touchend",function(e){X(n.html,e.target)||X(n.body,e.target)}),Wl(r,"transitionend",function(e){var t;"height"===e.raw.propertyName&&(t=vi(r),o.run(function(e){e.setViewportOffset(t)}),u(),c())}),ql(r,"touchstart",function(e){var t;o.run(function(e){e.highlightSelection()}),t=e,o.run(function(e){e.onToolbarTouch(t)}),n.onTouchToolstrip()}),Wl(n.body,"touchstart",function(e){a(),n.onTouchContent(),s.fireTouchstart(e)}),s.onTouchmove(),s.onTouchend(),Wl(n.body,"click",function(e){e.kill()}),Wl(r,"touchmove",function(){n.onToolbarScrollStart()})];return{destroy:function(){k(f,function(e){e.unbind()})}}}function $m(t,n){var e=t.document,o=zt.fromTag("div");Oe(o,di("unfocused-selections")),Xt(zt.fromDom(e.documentElement),o);function r(e){var t=zt.fromTag("span");return dl(t,[di("layer-editor"),di("unfocused-selection")]),Yr(t,{left:e.left+"px",top:e.top+"px",width:e.width+"px",height:e.height+"px"}),t}var i=Wl(o,"touchstart",function(e){e.prevent(),Wm(t,n),u()}),u=function(){re(o)};return{update:function(){u();var e=jd(t),e=S(e,r);oe(o,e)},isActive:function(){return 0<$t(o).length},destroy:function(){i.unbind(),Yt(o)},clear:u}}var Xm,Ym,Km,Jm,Ar={},Kt={exports:Ar};Ym=Ar,Km=Kt,Jm=Xm=void 0,function(e){"object"==typeof Ym&&void 0!==Km?Km.exports=e():"function"==typeof Xm&&Xm.amd?Xm([],e):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).EphoxContactWrapper=e()}(function(){return function o(r,i,u){function a(t,e){if(!i[t]){if(!r[t]){var n="function"==typeof Jm&&Jm;if(!e&&n)return n(t,!0);if(c)return c(t,!0);throw(n=new Error("Cannot find module '"+t+"'")).code="MODULE_NOT_FOUND",n}n=i[t]={exports:{}},r[t][0].call(n.exports,function(e){return a(r[t][1][e]||e)},n,n.exports,o,r,i,u)}return i[t].exports}for(var c="function"==typeof Jm&&Jm,e=0;e<u.length;e++)a(u[e]);return a}({1:[function(e,t,n){var o,r,t=t.exports={};function i(){throw new Error("setTimeout has not been defined")}function u(){throw new Error("clearTimeout has not been defined")}function a(t){if(o===setTimeout)return setTimeout(t,0);if((o===i||!o)&&setTimeout)return o=setTimeout,setTimeout(t,0);try{return o(t,0)}catch(e){try{return o.call(null,t,0)}catch(e){return o.call(this,t,0)}}}!function(){try{o="function"==typeof setTimeout?setTimeout:i}catch(e){o=i}try{r="function"==typeof clearTimeout?clearTimeout:u}catch(e){r=u}}();var c,s=[],l=!1,f=-1;function d(){l&&c&&(l=!1,c.length?s=c.concat(s):f=-1,s.length&&m())}function m(){if(!l){var e=a(d);l=!0;for(var t=s.length;t;){for(c=s,s=[];++f<t;)c&&c[f].run();f=-1,t=s.length}c=null,l=!1,function(t){if(r===clearTimeout)return clearTimeout(t);if((r===u||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(t);try{r(t)}catch(e){try{return r.call(null,t)}catch(e){return r.call(this,t)}}}(e)}}function g(e,t){this.fun=e,this.array=t}function p(){}t.nextTick=function(e){var t=new Array(arguments.length-1);if(1<arguments.length)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];s.push(new g(e,t)),1!==s.length||l||a(m)},g.prototype.run=function(){this.fun.apply(null,this.array)},t.title="browser",t.browser=!0,t.env={},t.argv=[],t.version="",t.versions={},t.on=p,t.addListener=p,t.once=p,t.off=p,t.removeListener=p,t.removeAllListeners=p,t.emit=p,t.prependListener=p,t.prependOnceListener=p,t.listeners=function(e){return[]},t.binding=function(e){throw new Error("process.binding is not supported")},t.cwd=function(){return"/"},t.chdir=function(e){throw new Error("process.chdir is not supported")},t.umask=function(){return 0}},{}],2:[function(e,f,t){!function(t){function o(){}function i(e){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],l(e,this)}function r(n,o){for(;3===n._state;)n=n._value;0!==n._state?(n._handled=!0,i._immediateFn(function(){var e,t=1===n._state?o.onFulfilled:o.onRejected;if(null!==t){try{e=t(n._value)}catch(e){return void a(o.promise,e)}u(o.promise,e)}else(1===n._state?u:a)(o.promise,n._value)})):n._deferreds.push(o)}function u(t,e){try{if(e===t)throw new TypeError("A promise cannot be resolved with itself.");if(e&&("object"==typeof e||"function"==typeof e)){var n=e.then;if(e instanceof i)return t._state=3,t._value=e,void c(t);if("function"==typeof n)return void l((o=n,r=e,function(){o.apply(r,arguments)}),t)}t._state=1,t._value=e,c(t)}catch(e){a(t,e)}var o,r}function a(e,t){e._state=2,e._value=t,c(e)}function c(e){2===e._state&&0===e._deferreds.length&&i._immediateFn(function(){e._handled||i._unhandledRejectionFn(e._value)});for(var t=0,n=e._deferreds.length;t<n;t++)r(e,e._deferreds[t]);e._deferreds=null}function s(e,t,n){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.promise=n}function l(e,t){var n=!1;try{e(function(e){n||(n=!0,u(t,e))},function(e){n||(n=!0,a(t,e))})}catch(e){if(n)return;n=!0,a(t,e)}}var e,n;e=this,n=setTimeout,i.prototype.catch=function(e){return this.then(null,e)},i.prototype.then=function(e,t){var n=new this.constructor(o);return r(this,new s(e,t,n)),n},i.all=function(e){var a=Array.prototype.slice.call(e);return new i(function(r,i){if(0===a.length)return r([]);var u=a.length;for(var e=0;e<a.length;e++)!function t(n,e){try{if(e&&("object"==typeof e||"function"==typeof e)){var o=e.then;if("function"==typeof o)return void o.call(e,function(e){t(n,e)},i)}a[n]=e,0==--u&&r(a)}catch(e){i(e)}}(e,a[e])})},i.resolve=function(t){return t&&"object"==typeof t&&t.constructor===i?t:new i(function(e){e(t)})},i.reject=function(n){return new i(function(e,t){t(n)})},i.race=function(r){return new i(function(e,t){for(var n=0,o=r.length;n<o;n++)r[n].then(e,t)})},i._immediateFn="function"==typeof t?function(e){t(e)}:function(e){n(e,0)},i._unhandledRejectionFn=function(e){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",e)},i._setImmediateFn=function(e){i._immediateFn=e},i._setUnhandledRejectionFn=function(e){i._unhandledRejectionFn=e},void 0!==f&&f.exports?f.exports=i:e.Promise||(e.Promise=i)}.call(this,e("timers").setImmediate)},{timers:3}],3:[function(c,e,s){!function(e,t){var o=c("process/browser.js").nextTick,n=Function.prototype.apply,r=Array.prototype.slice,i={},u=0;function a(e,t){this._id=e,this._clearFn=t}s.setTimeout=function(){return new a(n.call(setTimeout,window,arguments),clearTimeout)},s.setInterval=function(){return new a(n.call(setInterval,window,arguments),clearInterval)},s.clearTimeout=s.clearInterval=function(e){e.close()},a.prototype.unref=a.prototype.ref=function(){},a.prototype.close=function(){this._clearFn.call(window,this._id)},s.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},s.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},s._unrefActive=s.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;0<=t&&(e._idleTimeoutId=setTimeout(function(){e._onTimeout&&e._onTimeout()},t))},s.setImmediate="function"==typeof e?e:function(e){var t=u++,n=!(arguments.length<2)&&r.call(arguments,1);return i[t]=!0,o(function(){i[t]&&(n?e.apply(null,n):e.call(null),s.clearImmediate(t))}),t},s.clearImmediate="function"==typeof t?t:function(e){delete i[e]}}.call(this,c("timers").setImmediate,c("timers").clearImmediate)},{"process/browser.js":1,timers:3}],4:[function(e,t,n){var o=e("promise-polyfill"),e="undefined"!=typeof window?window:Function("return this;")();t.exports={boltExport:e.Promise||o}},{"promise-polyfill":2}]},{},[4])(4)});function Qm(e){setTimeout(function(){throw e},0)}function Zm(n,o){return F([{width:320,height:480,keyboard:{portrait:300,landscape:240}},{width:320,height:568,keyboard:{portrait:300,landscape:240}},{width:375,height:667,keyboard:{portrait:305,landscape:240}},{width:414,height:736,keyboard:{portrait:320,landscape:240}},{width:768,height:1024,keyboard:{portrait:320,landscape:400}},{width:1024,height:1366,keyboard:{portrait:380,landscape:460}}],function(e){return t=n<=e.width&&o<=e.height,e=e.keyboard,t?Re.some(e):Re.none();var t}).getOr({portrait:o/5,landscape:n/4})}function eg(e){var t=Gl(e).isPortrait(),n=Zm(e.screen.width,e.screen.height),n=t?n.portrait:n.landscape;return(t?e.screen.height:e.screen.width)-e.innerHeight>n?0:n}function tg(e,t){var n=K(e).dom.defaultView;return vi(e)+vi(t)-eg(n)}function ng(e,t,n){var o=tg(t,n),o=vi(t)+vi(n)-o;Xr(e,"padding-bottom",o+"px")}function og(e){return Vd(e,Cg)}function rg(e,t){var n=ve(e,Sg);return wg.fixed(e,n,t)}function ig(e,t){return wg.scroller(e,t)}function ug(e){var t=og(e);return("true"===ve(e,kg)?ig:rg)(e,t)}function ag(e,t,n){var o=K(e).dom.defaultView.innerHeight;return pe(e,Og,o+"px"),o-t-n}function cg(n,o,r,i){function t(){var e,t;f&&(e=vi(r),t=vi(i),t=ag(n,e,t),pe(n,Cg,e+"px"),Xr(n,"height",t+"px"),ng(o,n,i))}var u=K(n).dom.defaultView,e=function(e){var t=ve(e,"style");Yr(e,{position:"absolute",top:"0px"}),pe(e,Cg,"0px"),pe(e,Sg,"top");return{restore:function(){pe(e,"style",t||""),xe(e,Cg),xe(e,Sg)}}}(r),a=vi(r),c=vi(i),s=function(e,t,n){var o=ve(n,"style");Nl(n),Yr(n,{position:"absolute",height:t+"px",width:"100%",top:e+"px"}),pe(n,Cg,e+"px"),pe(n,kg,"true"),pe(n,Sg,"top");return{restore:function(){Rl(n),pe(n,"style",o||""),xe(n,Cg),xe(n,kg),xe(n,Sg)}}}(a,ag(n,a,c),n),l=function(e){var t=ve(e,"style");Yr(e,{position:"absolute",bottom:"0px"}),pe(e,Cg,"0px"),pe(e,Sg,"bottom");return{restore:function(){pe(e,"style",t||""),xe(e,Cg),xe(e,Sg)}}}(i),f=!0,c=function(){var e=u.innerHeight;return Vd(n,Og)<e};return ng(o,n,i),{setViewportOffset:function(e){pe(n,Cg,e+"px"),t()},isExpanding:c,isShrinking:d(c),refresh:t,restore:function(){f=!1,e.restore(),s.restore(),l.restore()}}}function sg(e){return e=Jr(e,"top").getOr("0"),parseInt(e,10)}function lg(e){return parseInt(e.dom.scrollTop,10)}function fg(o,r){return yg(function(e){var t=x(lg,o);pe(o,Eg,t());var n=Math.abs(r-t()),n=Math.ceil(n/10);_g.animate(t,r,n,function(e,t){Vd(o,Eg)!==o.dom.scrollTop?t(o.dom.scrollTop):(o.dom.scrollTop=e,pe(o,Eg,e))},function(){o.dom.scrollTop=r,pe(o,Eg,r),e(r)},10)})}function dg(r,i){return yg(function(e){function t(e){Xr(r,"top",e+"px")}var n=x(sg,r),o=Math.abs(i-n()),o=Math.ceil(o/10);_g.animate(n,i,o,t,function(){t(i),e(i)},10)})}function mg(e,t){t=t+og(e)+"px",Xr(e,"top",t)}var gg,pg=Kt.exports.boltExport,hg=function(e){var n=Re.none(),t=[],o=function(e){r()?u(e):t.push(e)},r=function(){return n.isSome()},i=function(e){k(e,u)},u=function(t){n.each(function(e){setTimeout(function(){t(e)},0)})};return e(function(e){r()||(n=Re.some(e),i(t),t=[])}),{get:o,map:function(n){return hg(function(t){o(function(e){t(n(e))})})},isReady:r}},vg={nu:hg,pure:function(t){return hg(function(e){e(t)})}},bg=function(n){function e(e){n().then(e,Qm)}return{map:function(e){return bg(function(){return n().then(e)})},bind:function(t){return bg(function(){return n().then(function(e){return t(e).toPromise()})})},anonBind:function(e){return bg(function(){return n().then(function(){return e.toPromise()})})},toLazy:function(){return vg.nu(e)},toCached:function(){var e=null;return bg(function(){return e=null===e?n():e})},toPromise:n,get:e}},yg=function(e){return bg(function(){return new pg(e)})},xg=function(e){return bg(function(){return pg.resolve(e)})},wg=Lo([{fixed:["element","property","offsetY"]},{scroller:["element","offsetY"]}]),Cg="data-"+di("position-y-fixed"),Sg="data-"+di("y-property"),kg="data-"+di("scrolling"),Og="data-"+di("last-window-height"),_g=(gg=null,{animate:function(r,i,u,a,t,e){function c(e){s=!0,t(e)}var s=!1;Zf.clearInterval(gg);function l(e){Zf.clearInterval(gg),c(e)}gg=Zf.setInterval(function(){var e,t,n,o=r();e=o,t=i,n=u,(Math.abs(e-t)<=n?Re.none():e<t?Re.some(e+n):Re.some(e-n)).fold(function(){Zf.clearInterval(gg),c(i)},function(e){var t;a(e,l),s||((t=r())!==e||Math.abs(t-i)>Math.abs(o-i))&&(Zf.clearInterval(gg),c(i))})},e)}}),Eg="data-"+di("last-scroll-top");function Tg(u,e){return e(function(o){var r=[],i=0;0===u.length?o([]):k(u,function(e,t){var n;e.get((n=t,function(e){r[n]=e,++i>=u.length&&o(r)}))})})}function Dg(e,t,n){var o,r,i,t=t+n,n=Jr(e,"top").getOr(n),n=t-parseInt(n,10),n=e.dom.scrollTop+n;return o=e,r=n,i=t,yg(function(e){var t=x(lg,o);_g.animate(t,r,15,function(e){o.dom.scrollTop=e,Xr(o,"top",sg(o)+15+"px")},function(){o.dom.scrollTop=r,Xr(o,"top",i+"px"),e(r)},10)})}function Ag(e,o){return e.fold(function(e,t,n){return Xr(e,t,o+(n=n)+"px"),xg(n)},function(e,t){return Dg(e,o,t)})}function Bg(e,t){return e=function(e){e=xi(e,"["+Cg+"]");return S(e,ug)}(e),e=S(e,function(e){return Ag(e,t)}),Tg(e,yg)}function Ng(i,u,e,n,t,o){var r,a,c=(r=function(e){return n=u,o=e,r=K(t=i).dom.defaultView,yg(function(e){mg(t,o),mg(n,o),r.scrollTo(0,o),e(o)});var t,n,o,r},a=ho(vg.pure({})),{start:function(t){var e=vg.nu(function(e){return r(t).get(e)});a.set(e)},idle:function(e){a.get().get(function(){e()})}}),s=Xd(function(){c.idle(function(){Bg(e,n.pageYOffset).get(function(){var e;(e=jd(o),Re.from(e[0]).bind(function(e){var t=e.top-u.dom.scrollTop;return t>n.innerHeight+5||t<-5?Re.some({top:t,bottom:t+e.height}):Re.none()})).each(function(e){u.dom.scrollTop=u.dom.scrollTop+e.top}),c.start(0),t.refresh()})})},1e3),l=Wl(zt.fromDom(n),"scroll",function(){n.pageYOffset<0||s.throttle()});return Bg(e,n.pageYOffset).get(h),{unbind:l.unbind}}function Rg(e){var n=e.cWin,t=e.ceBody,o=e.socket,r=e.toolstrip,i=e.contentElement,u=e.keyboardType,a=e.outerWindow,c=e.dropup,e=e.outerBody,s=cg(o,t,r,c),l=u(e,n,ae(),i),f=$l(a,{onChange:v,onReady:s.refresh});f.onAdjustment(function(){s.refresh()});var d=Wl(zt.fromDom(a),"resize",function(){s.isExpanding()&&s.refresh()}),m=Ng(r,o,e,a,s,n),g=$m(n,i),p=function(){g.clear()};return{toEditing:function(){l.toEditing(),p()},toReading:function(){l.toReading()},onToolbarTouch:function(e){l.onToolbarTouch()},refreshSelection:function(){g.isActive()&&g.update()},clearSelection:p,highlightSelection:function(){g.update()},scrollIntoView:function(e,t){!function(e,t,n,o,r){n=tg(t,n),e=x(Um,e);n<o||n<r?fg(t,t.dom.scrollTop-n+r).get(e):o<0&&fg(t,t.dom.scrollTop+o).get(e)}(n,o,c,e,t)},updateToolbarPadding:v,setViewportOffset:function(e){s.setViewportOffset(e),dg(o,e).get(h)},syncHeight:function(){Xr(i,"height",i.dom.contentWindow.document.body.scrollHeight+"px")},refreshStructure:s.refresh,destroy:function(){s.restore(),f.destroy(),m.unbind(),d.unbind(),l.destroy(),g.destroy(),jm(ae(),bo)}}}function Mg(o,e){var r=bd(),i=Zs(),u=Zs(),a=Qs(),c=Qs();return{enter:function(){e.hide();var n=zt.fromDom(document);vd(o.editor).each(function(e){var t;i.set({socketHeight:Jr(o.socket,"height"),iframeHeight:Jr(e.frame,"height"),outerScroll:document.body.scrollTop}),u.set({exclusives:(t="."+Gf,Wl(n,"touchmove",function(e){_i(e.target,t).filter(Jd).fold(function(){e.prevent()},v)}))}),Oe(o.container,di("fullscreen-maximized")),yd(o.container,e.body),r.maximize(),Xr(o.socket,"overflow","scroll"),Xr(o.socket,"-webkit-overflow-scrolling","touch"),vo(e.body),a.set(Rg({cWin:e.win,ceBody:e.body,socket:o.socket,toolstrip:o.toolstrip,dropup:o.dropup.element,contentElement:e.frame,outerBody:o.body,outerWindow:o.win,keyboardType:qm})),a.run(function(e){e.syncHeight()}),c.set(Gm(e,a,o.toolstrip,o.socket,o.dropup))})},refreshStructure:function(){a.run(function(e){e.refreshStructure()})},exit:function(){r.restore(),c.clear(),a.clear(),e.show(),i.on(function(e){e.socketHeight.each(function(e){Xr(o.socket,"height",e)}),e.iframeHeight.each(function(e){Xr(o.editor.getFrame(),"height",e)}),document.body.scrollTop=e.scrollTop}),i.clear(),u.on(function(e){e.exclusives.unbind()}),u.clear(),Ee(o.container,di("fullscreen-maximized")),xd(),Rl(o.toolbar),Qr(o.socket,"overflow"),Qr(o.socket,"-webkit-overflow-scrolling"),bo(o.editor.getFrame()),vd(o.editor).each(function(e){e.clearSelection()})}}}function Ig(e){var t=zm({classes:[di("ios-container")]}),n=Qd(),o=Qs(),r=Zd(o),i=em(),e=hm(function(){o.run(function(e){e.refreshStructure()})},e);t.add(n.wrapper),t.add(i),t.add(e.component);return{system:t,element:t.element,init:function(e){o.set(function(e){var t=Hn("Getting IosWebapp schema",Om,e);Xr(t.toolstrip,"width","100%"),Xr(t.container,"position","relative");var n=Of(Yd(function(){t.setReadOnly(t.readOnlyOnInit()),o.enter()},t.translate));t.alloy.add(n);var e={show:function(){t.alloy.add(n)},hide:function(){t.alloy.remove(n)}},o=Mg(t,e);return{setReadOnly:t.setReadOnly,refreshStructure:o.refreshStructure,enter:o.enter,exit:o.exit,destroy:v}}(e))},exit:function(){o.run(function(e){Ff.remove(i,r),e.exit()})},setToolbarGroups:function(e){e=n.createGroups(e);n.setGroups(e)},setContextToolbar:function(e){e=n.createGroups(e);n.setContextToolbar(e)},focusToolbar:function(){n.focus()},restoreToolbar:function(){n.restoreToolbar()},updateMode:function(e){om(i,r,e,t.root)},socket:i,dropup:e}}function Fg(e,t,n){e.system.broadcastOn([Er],{command:t,state:n})}function Pg(t){return function(){function e(){t._skinLoaded=!0,t.fire("SkinLoaded")}t.initialized?e():t.on("init",e)}}var Lg=tinymce.util.Tools.resolve("tinymce.EditorManager");kr.add("mobile",function(h){return{getNotificationManagerImpl:function(){return{open:b({progressBar:{value:v},close:v,text:v,getEl:b(null),moveTo:v,moveRel:v,settings:{}}),close:v,reposition:v,getArgs:b({})}},renderUI:function(){var e,t=h.getElement(),n=function(e){e=Re.from(e.getParam("skin_url")).fold(function(){return Lg.baseURL+"/skins/ui/oxide"},function(e){return e});return{content:e+"/content.mobile.min.css",ui:e+"/skin.mobile.min.css"}}(h);!1===h.getParam("skin")==!1?(e=Sr.DOM.styleSheetLoader,h.contentCSS.push(n.content),e.load(n.ui,Pg(h)),h.on("remove",function(){return e.unload(n.ui)})):Pg(h)();var o,r,i,u,a,c=function(){h.fire("ScrollIntoView")},d=at().os.isAndroid()?(s=c,o=zm({classes:[di("android-container")]}),r=Qd(),i=Qs(),u=Zd(i),a=em(),s=hm(v,s),o.add(r.wrapper),o.add(a),o.add(s.component),{system:o,element:o.element,init:function(e){i.set(Kd(e))},exit:function(){i.run(function(e){e.exit(),Ff.remove(a,u)})},setToolbarGroups:function(e){e=r.createGroups(e);r.setGroups(e)},setContextToolbar:function(e){e=r.createGroups(e);r.setContextToolbar(e)},focusToolbar:function(){r.focus()},restoreToolbar:function(){r.restoreToolbar()},updateMode:function(e){om(a,u,e,o.root)},socket:a,dropup:s}):Ig(c),s=zt.fromDom(t);c=d.system,un(s,c,te);function m(e,t,n,o){!1===o&&h.selection.collapse(),n=f(e,t,n),d.setToolbarGroups(!0===o?n.readOnly:n.main),h.setMode(!0===o?"readonly":"design"),h.fire(!0===o?"toReading":"toEditing"),d.updateMode(o)}function g(e,t){return h.on(e,t),{unbind:function(){h.off(e)}}}var l=t.ownerDocument.defaultView,p=$l(l,{onChange:function(){var e,t,n;d.system.broadcastOn([Tr],{width:(e=l,t=at().os.isiOS(),n=Gl(e).isPortrait(),t&&!n?e.screen.height:e.screen.width)})},onReady:v}),f=function(e,t,n){e=e.get();return{readOnly:e.backToMask.concat(t.get()),main:e.backToMask.concat(n.get())}};return h.on("init",function(){d.init({editor:{getFrame:function(){return zt.fromDom(h.contentAreaContainer.querySelector("iframe"))},onDomChanged:function(){return{unbind:v}},onToReading:function(e){return g("toReading",e)},onToEditing:function(e){return g("toEditing",e)},onScrollToCursor:function(t){h.on("ScrollIntoView",function(e){t(e)});return{unbind:function(){h.off("ScrollIntoView"),p.destroy()}}},onTouchToolstrip:function(){t()},onTouchContent:function(){var e=zt.fromDom(h.editorContainer.querySelector("."+di("toolbar")));xo(e).bind(function(e){return d.system.getByDom(e).toOptional()}).each(j),d.restoreToolbar(),t()},onTapContent:function(e){var t=e.target;"img"===Y(t)?(h.selection.select(t.dom),e.kill()):"a"===Y(t)&&d.system.getByDom(zt.fromDom(h.editorContainer)).each(function(e){Cr.isAlpha(e)&&function(e){var t=document.createElement("a");t.target="_blank",t.href=e.href,t.rel="noreferrer noopener";e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),document.body.appendChild(t),t.dispatchEvent(e),document.body.removeChild(t)}(t.dom)})}},container:zt.fromDom(h.editorContainer),socket:zt.fromDom(h.contentAreaContainer),toolstrip:zt.fromDom(h.editorContainer.querySelector("."+di("toolstrip"))),toolbar:zt.fromDom(h.editorContainer.querySelector("."+di("toolbar"))),dropup:d.dropup,alloy:d.system,translate:v,setReadOnly:function(e){m(f,l,s,e)},readOnlyOnInit:function(){return!1}});var n,o,r,e,t=function(){d.dropup.disappear(function(){d.system.broadcastOn([Dr],{})})},i={label:"The first group",scrollable:!1,items:[ls("back",function(){h.selection.collapse(),d.exit()},{},h)]},u={label:"Back to read only",scrollable:!1,items:[ls("readonly-back",function(){m(f,l,s,!0)},{},h)]},a=zl(d,h),a=(n=a,c=Hl(c=h),o={},A(c,function(e){var t=!me(o,e)&&me(n,e)&&n[e].isSupported()?[n[e].sketch()]:[];return o[e]=!0,t})),c={label:"The extra group",scrollable:!1,items:[]},s=ho([{label:"the action group",scrollable:!0,items:a},c]),l=ho([{label:"The read only mode group",scrollable:!0,items:[]},c]),f=ho({backToMask:[i],backToReadOnly:[u]});r=d,u=an((e=h).formatter.get()),k(u,function(t){e.formatter.formatChanged(t,function(e){Fg(r,t,e)})}),k(["ul","ol"],function(n){e.selection.selectorChanged(n,function(e,t){Fg(r,n,e)})})}),h.on("remove",function(){d.exit()}),h.on("detach",function(){var t,e;t=d.system,e=$t(t.element),k(e,function(e){t.getByDom(e).each(nn)}),Yt(t.element),d.system.destroy()}),{iframeContainer:d.socket.element.dom,editorContainer:d.element.dom}}}})}();