!function(e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).Uppy=e()}(function(){var n,r,e=function(t){var n;return function(e){return n||t(n={exports:{},parent:e},n.exports),n.exports}},i=e(function(e,t){var o=cu("socket.io-client");e.exports=t=n;var s=t.managers={};function n(e,t){"object"==typeof e&&(t=e,e=void 0),t=t||{};var n=du(e),r=n.source,i=n.id,e=n.path,e=s[i]&&e in s[i].nsps,i=t.forceNew||t["force new connection"]||!1===t.multiplex||e?(o("ignoring socket cache for %s",r),Zl(r,t)):(s[i]||(o("new io instance for %s",r),s[i]=Zl(r,t)),s[i]);return n.query&&!t.query&&(t.query=n.query),i.socket(n.path,t)}t.protocol=Cu.protocol,t.connect=n,t.Manager=Zl,t.Socket=Xl}),a=e(function(e,t){}),t=e(function(e,F){!function(e){!function(){"use strict";function i(e){if(2147483647<e)throw new RangeError('The value "'+e+'" is invalid for option "size"');e=new Uint8Array(e);return e.__proto__=p.prototype,e}function p(e,t,n){if("number"!=typeof e)return r(e,t,n);if("string"==typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return s(e)}function r(e,t,n){if("string"==typeof e)return function(e,t){if(!p.isEncoding(t="string"!=typeof t||""===t?"utf8":t))throw new TypeError("Unknown encoding: "+t);var n=0|l(e,t),r=i(n),t=r.write(e,t);return r=t!==n?r.slice(0,t):r}(e,t);if(ArrayBuffer.isView(e))return a(e);if(null==e)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(P(e,ArrayBuffer)||e&&P(e.buffer,ArrayBuffer))return function(e,t,n){if(t<0||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(n||0))throw new RangeError('"length" is outside of buffer bounds');return(n=void 0===t&&void 0===n?new Uint8Array(e):void 0===n?new Uint8Array(e,t):new Uint8Array(e,t,n)).__proto__=p.prototype,n}(e,t,n);if("number"==typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');var r=e.valueOf&&e.valueOf();if(null!=r&&r!==e)return p.from(r,t,n);r=function(e){if(p.isBuffer(e)){var t=0|u(e.length),n=i(t);return 0===n.length||e.copy(n,0,0,t),n}return void 0!==e.length?"number"!=typeof e.length||C(e.length)?i(0):a(e):"Buffer"===e.type&&Array.isArray(e.data)?a(e.data):void 0}(e);if(r)return r;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return p.from(e[Symbol.toPrimitive]("string"),t,n);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function o(e){if("number"!=typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function s(e){return o(e),i(e<0?0:0|u(e))}function a(e){for(var t=e.length<0?0:0|u(e.length),n=i(t),r=0;r<t;r+=1)n[r]=255&e[r];return n}function u(e){if(2147483647<=e)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+2147483647..toString(16)+" bytes");return 0|e}function l(e,t){if(p.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||P(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);var n=e.length,r=2<arguments.length&&!0===arguments[2];if(!r&&0===n)return 0;for(var i=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":return _(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return S(e).length;default:if(i)return r?-1:_(e).length;t=(""+t).toLowerCase(),i=!0}}function n(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function c(e,t,n,r,i){if(0===e.length)return-1;if("string"==typeof n?(r=n,n=0):2147483647<n?n=2147483647:n<-2147483648&&(n=-2147483648),(n=(n=C(n=+n)?i?0:e.length-1:n)<0?e.length+n:n)>=e.length){if(i)return-1;n=e.length-1}else if(n<0){if(!i)return-1;n=0}if("string"==typeof t&&(t=p.from(t,r)),p.isBuffer(t))return 0===t.length?-1:d(e,t,n,r,i);if("number"==typeof t)return t&=255,"function"==typeof Uint8Array.prototype.indexOf?(i?Uint8Array.prototype.indexOf:Uint8Array.prototype.lastIndexOf).call(e,t,n):d(e,[t],n,r,i);throw new TypeError("val must be string, number or Buffer")}function d(e,t,n,r,i){var o=1,s=e.length,a=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;s/=o=2,a/=2,n/=2}function u(e,t){return 1===o?e[t]:e.readUInt16BE(t*o)}if(i)for(var l=-1,c=n;c<s;c++)if(u(e,c)===u(t,-1===l?0:c-l)){if(c-(l=-1===l?c:l)+1===a)return l*o}else-1!==l&&(c-=c-l),l=-1;else for(c=n=s<n+a?s-a:n;0<=c;c--){for(var p=!0,d=0;d<a;d++)if(u(e,c+d)!==u(t,d)){p=!1;break}if(p)return c}return-1}function h(e,t,n,r){return k(function(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,r)}function f(e,t,n){n=Math.min(e.length,n);for(var r=[],i=t;i<n;){var o,s,a,u,l=e[i],c=null,p=239<l?4:223<l?3:191<l?2:1;if(i+p<=n)switch(p){case 1:l<128&&(c=l);break;case 2:128==(192&(o=e[i+1]))&&127<(u=(31&l)<<6|63&o)&&(c=u);break;case 3:o=e[i+1],s=e[i+2],128==(192&o)&&128==(192&s)&&2047<(u=(15&l)<<12|(63&o)<<6|63&s)&&(u<55296||57343<u)&&(c=u);break;case 4:o=e[i+1],s=e[i+2],a=e[i+3],128==(192&o)&&128==(192&s)&&128==(192&a)&&65535<(u=(15&l)<<18|(63&o)<<12|(63&s)<<6|63&a)&&u<1114112&&(c=u)}null===c?(c=65533,p=1):65535<c&&(c-=65536,r.push(c>>>10&1023|55296),c=56320|1023&c),r.push(c),i+=p}return function(e){var t=e.length;if(t<=y)return String.fromCharCode.apply(String,e);for(var n="",r=0;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=y));return n}(r)}F.Buffer=p,F.INSPECT_MAX_BYTES=50,(p.TYPED_ARRAY_SUPPORT=function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()}catch(e){return!1}}())||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(p.prototype,"parent",{enumerable:!0,get:function(){if(p.isBuffer(this))return this.buffer}}),Object.defineProperty(p.prototype,"offset",{enumerable:!0,get:function(){if(p.isBuffer(this))return this.byteOffset}}),"undefined"!=typeof Symbol&&null!=Symbol.species&&p[Symbol.species]===p&&Object.defineProperty(p,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),p.poolSize=8192,p.from=r,p.prototype.__proto__=Uint8Array.prototype,p.__proto__=Uint8Array,p.alloc=function(e,t,n){return t=t,n=n,o(e=e),!(e<=0)&&void 0!==t?"string"==typeof n?i(e).fill(t,n):i(e).fill(t):i(e)},p.allocUnsafe=s,p.allocUnsafeSlow=s,p.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==p.prototype},p.compare=function(e,t){if(P(e,Uint8Array)&&(e=p.from(e,e.offset,e.byteLength)),P(t,Uint8Array)&&(t=p.from(t,t.offset,t.byteLength)),!p.isBuffer(e)||!p.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;for(var n=e.length,r=t.length,i=0,o=Math.min(n,r);i<o;++i)if(e[i]!==t[i]){n=e[i],r=t[i];break}return n<r?-1:r<n?1:0},p.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},p.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return p.alloc(0);if(void 0===t)for(i=t=0;i<e.length;++i)t+=e[i].length;for(var n=p.allocUnsafe(t),r=0,i=0;i<e.length;++i){var o=e[i];if(P(o,Uint8Array)&&(o=p.from(o)),!p.isBuffer(o))throw new TypeError('"list" argument must be an Array of Buffers');o.copy(n,r),r+=o.length}return n},p.byteLength=l,p.prototype._isBuffer=!0,p.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)n(this,t,t+1);return this},p.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)n(this,t,t+3),n(this,t+1,t+2);return this},p.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)n(this,t,t+7),n(this,t+1,t+6),n(this,t+2,t+5),n(this,t+3,t+4);return this},p.prototype.toString=function(){var e=this.length;return 0===e?"":0===arguments.length?f(this,0,e):function(e,t,n){var r,i,o,s=!1;if((t=void 0===t||t<0?0:t)>this.length)return"";if((n=void 0===n||n>this.length?this.length:n)<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e=e||"utf8";;)switch(e){case"hex":return function(e,t,n){var r,i=e.length;(!n||n<0||i<n)&&(n=i);for(var o="",s=t=!t||t<0?0:t;s<n;++s)o+=(r=e[s])<16?"0"+r.toString(16):r.toString(16);return o}(this,t,n);case"utf8":case"utf-8":return f(this,t,n);case"ascii":return function(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;i<n;++i)r+=String.fromCharCode(127&e[i]);return r}(this,t,n);case"latin1":case"binary":return function(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;i<n;++i)r+=String.fromCharCode(e[i]);return r}(this,t,n);case"base64":return r=this,o=n,0===(i=t)&&o===r.length?Pr.fromByteArray(r):Pr.fromByteArray(r.slice(i,o));case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return function(e,t,n){for(var r=e.slice(t,n),i="",o=0;o<r.length;o+=2)i+=String.fromCharCode(r[o]+256*r[o+1]);return i}(this,t,n);default:if(s)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),s=!0}}.apply(this,arguments)},p.prototype.toLocaleString=p.prototype.toString,p.prototype.equals=function(e){if(!p.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===p.compare(this,e)},p.prototype.inspect=function(){var e="",t=F.INSPECT_MAX_BYTES,e=this.toString("hex",0,t).replace(/(.{2})/g,"$1 ").trim();return this.length>t&&(e+=" ... "),"<Buffer "+e+">"},p.prototype.compare=function(e,t,n,r,i){if(P(e,Uint8Array)&&(e=p.from(e,e.offset,e.byteLength)),!p.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===n&&(n=e?e.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),(t=void 0===t?0:t)<0||n>e.length||r<0||i>this.length)throw new RangeError("out of range index");if(i<=r&&n<=t)return 0;if(i<=r)return-1;if(n<=t)return 1;if(this===e)return 0;for(var o=(i>>>=0)-(r>>>=0),s=(n>>>=0)-(t>>>=0),a=Math.min(o,s),u=this.slice(r,i),l=e.slice(t,n),c=0;c<a;++c)if(u[c]!==l[c]){o=u[c],s=l[c];break}return o<s?-1:s<o?1:0},p.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},p.prototype.indexOf=function(e,t,n){return c(this,e,t,n,!0)},p.prototype.lastIndexOf=function(e,t,n){return c(this,e,t,n,!1)},p.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)r=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(n)?(n>>>=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var i=this.length-t;if((void 0===n||i<n)&&(n=i),0<e.length&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r=r||"utf8";for(var o,s,a,u,l,c,p=!1;;)switch(r){case"hex":return function(e,t,n,r){n=Number(n)||0;var i=e.length-n;(!r||(r=Number(r))>i)&&(r=i),(i=t.length)/2<r&&(r=i/2);for(var o=0;o<r;++o){var s=parseInt(t.substr(2*o,2),16);if(C(s))return o;e[n+o]=s}return o}(this,e,t,n);case"utf8":case"utf-8":return l=t,c=n,k(_(e,(u=this).length-l),u,l,c);case"ascii":return h(this,e,t,n);case"latin1":case"binary":return h(this,e,t,n);case"base64":return o=this,s=t,a=n,k(S(e),o,s,a);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return o=t,s=n,k(function(e,t){for(var n,r,i=[],o=0;o<e.length&&!((t-=2)<0);++o)r=(n=e.charCodeAt(o))>>8,i.push(n%256),i.push(r);return i}(e,(a=this).length-o),a,o,s);default:if(p)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),p=!0}},p.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var y=4096;function g(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(n<e+t)throw new RangeError("Trying to access beyond buffer length")}function m(e,t,n,r,i,o){if(!p.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(i<t||t<o)throw new RangeError('"value" argument is out of bounds');if(n+r>e.length)throw new RangeError("Index out of range")}function v(e,t,n,r){if(n+r>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function b(e,t,n,r,i){return t=+t,n>>>=0,i||v(e,0,n,4),Tr.write(e,t,n,r,23,4),n+4}function w(e,t,n,r,i){return t=+t,n>>>=0,i||v(e,0,n,8),Tr.write(e,t,n,r,52,8),n+8}p.prototype.slice=function(e,t){var n=this.length;(e=~~e)<0?(e+=n)<0&&(e=0):n<e&&(e=n),(t=void 0===t?n:~~t)<0?(t+=n)<0&&(t=0):n<t&&(t=n),t<e&&(t=e);t=this.subarray(e,t);return t.__proto__=p.prototype,t},p.prototype.readUIntLE=function(e,t,n){e>>>=0,t>>>=0,n||g(e,t,this.length);for(var r=this[e],i=1,o=0;++o<t&&(i*=256);)r+=this[e+o]*i;return r},p.prototype.readUIntBE=function(e,t,n){e>>>=0,t>>>=0,n||g(e,t,this.length);for(var r=this[e+--t],i=1;0<t&&(i*=256);)r+=this[e+--t]*i;return r},p.prototype.readUInt8=function(e,t){return e>>>=0,t||g(e,1,this.length),this[e]},p.prototype.readUInt16LE=function(e,t){return e>>>=0,t||g(e,2,this.length),this[e]|this[e+1]<<8},p.prototype.readUInt16BE=function(e,t){return e>>>=0,t||g(e,2,this.length),this[e]<<8|this[e+1]},p.prototype.readUInt32LE=function(e,t){return e>>>=0,t||g(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},p.prototype.readUInt32BE=function(e,t){return e>>>=0,t||g(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},p.prototype.readIntLE=function(e,t,n){e>>>=0,t>>>=0,n||g(e,t,this.length);for(var r=this[e],i=1,o=0;++o<t&&(i*=256);)r+=this[e+o]*i;return r>=(i*=128)&&(r-=Math.pow(2,8*t)),r},p.prototype.readIntBE=function(e,t,n){e>>>=0,t>>>=0,n||g(e,t,this.length);for(var r=t,i=1,o=this[e+--r];0<r&&(i*=256);)o+=this[e+--r]*i;return o>=(i*=128)&&(o-=Math.pow(2,8*t)),o},p.prototype.readInt8=function(e,t){return e>>>=0,t||g(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},p.prototype.readInt16LE=function(e,t){e>>>=0,t||g(e,2,this.length);e=this[e]|this[e+1]<<8;return 32768&e?4294901760|e:e},p.prototype.readInt16BE=function(e,t){e>>>=0,t||g(e,2,this.length);e=this[e+1]|this[e]<<8;return 32768&e?4294901760|e:e},p.prototype.readInt32LE=function(e,t){return e>>>=0,t||g(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},p.prototype.readInt32BE=function(e,t){return e>>>=0,t||g(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},p.prototype.readFloatLE=function(e,t){return e>>>=0,t||g(e,4,this.length),Tr.read(this,e,!0,23,4)},p.prototype.readFloatBE=function(e,t){return e>>>=0,t||g(e,4,this.length),Tr.read(this,e,!1,23,4)},p.prototype.readDoubleLE=function(e,t){return e>>>=0,t||g(e,8,this.length),Tr.read(this,e,!0,52,8)},p.prototype.readDoubleBE=function(e,t){return e>>>=0,t||g(e,8,this.length),Tr.read(this,e,!1,52,8)},p.prototype.writeUIntLE=function(e,t,n,r){e=+e,t>>>=0,n>>>=0,r||m(this,e,t,n,Math.pow(2,8*n)-1,0);var i=1,o=0;for(this[t]=255&e;++o<n&&(i*=256);)this[t+o]=e/i&255;return t+n},p.prototype.writeUIntBE=function(e,t,n,r){e=+e,t>>>=0,n>>>=0,r||m(this,e,t,n,Math.pow(2,8*n)-1,0);var i=n-1,o=1;for(this[t+i]=255&e;0<=--i&&(o*=256);)this[t+i]=e/o&255;return t+n},p.prototype.writeUInt8=function(e,t,n){return e=+e,t>>>=0,n||m(this,e,t,1,255,0),this[t]=255&e,t+1},p.prototype.writeUInt16LE=function(e,t,n){return e=+e,t>>>=0,n||m(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},p.prototype.writeUInt16BE=function(e,t,n){return e=+e,t>>>=0,n||m(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},p.prototype.writeUInt32LE=function(e,t,n){return e=+e,t>>>=0,n||m(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},p.prototype.writeUInt32BE=function(e,t,n){return e=+e,t>>>=0,n||m(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},p.prototype.writeIntLE=function(e,t,n,r){e=+e,t>>>=0,r||m(this,e,t,n,(r=Math.pow(2,8*n-1))-1,-r);var i=0,o=1,s=0;for(this[t]=255&e;++i<n&&(o*=256);)e<0&&0===s&&0!==this[t+i-1]&&(s=1),this[t+i]=(e/o>>0)-s&255;return t+n},p.prototype.writeIntBE=function(e,t,n,r){e=+e,t>>>=0,r||m(this,e,t,n,(r=Math.pow(2,8*n-1))-1,-r);var i=n-1,o=1,s=0;for(this[t+i]=255&e;0<=--i&&(o*=256);)e<0&&0===s&&0!==this[t+i+1]&&(s=1),this[t+i]=(e/o>>0)-s&255;return t+n},p.prototype.writeInt8=function(e,t,n){return e=+e,t>>>=0,n||m(this,e,t,1,127,-128),this[t]=255&(e=e<0?255+e+1:e),t+1},p.prototype.writeInt16LE=function(e,t,n){return e=+e,t>>>=0,n||m(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},p.prototype.writeInt16BE=function(e,t,n){return e=+e,t>>>=0,n||m(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},p.prototype.writeInt32LE=function(e,t,n){return e=+e,t>>>=0,n||m(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},p.prototype.writeInt32BE=function(e,t,n){return e=+e,t>>>=0,n||m(this,e,t,4,2147483647,-2147483648),this[t]=(e=e<0?4294967295+e+1:e)>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},p.prototype.writeFloatLE=function(e,t,n){return b(this,e,t,!0,n)},p.prototype.writeFloatBE=function(e,t,n){return b(this,e,t,!1,n)},p.prototype.writeDoubleLE=function(e,t,n){return w(this,e,t,!0,n)},p.prototype.writeDoubleBE=function(e,t,n){return w(this,e,t,!1,n)},p.prototype.copy=function(e,t,n,r){if(!p.isBuffer(e))throw new TypeError("argument should be a Buffer");if(n=n||0,r||0===r||(r=this.length),t>=e.length&&(t=e.length),(r=0<r&&r<n?n:r)===n)return 0;if(0===e.length||0===this.length)return 0;if((t=t||0)<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length);var i=(r=e.length-t<r-n?e.length-t+n:r)-n;if(this===e&&"function"==typeof Uint8Array.prototype.copyWithin)this.copyWithin(t,n,r);else if(this===e&&n<t&&t<r)for(var o=i-1;0<=o;--o)e[o+t]=this[o+n];else Uint8Array.prototype.set.call(e,this.subarray(n,r),t);return i},p.prototype.fill=function(e,t,n,r){if("string"==typeof e){if("string"==typeof t?(r=t,t=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!p.isEncoding(r))throw new TypeError("Unknown encoding: "+r);var i;1===e.length&&(i=e.charCodeAt(0),("utf8"===r&&i<128||"latin1"===r)&&(e=i))}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;var o;if(t>>>=0,n=void 0===n?this.length:n>>>0,"number"==typeof(e=e||0))for(o=t;o<n;++o)this[o]=e;else{var s=p.isBuffer(e)?e:p.from(e,r),a=s.length;if(0===a)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(o=0;o<n-t;++o)this[o+t]=s[o%a]}return this};var t=/[^+/0-9A-Za-z-_]/g;function _(e,t){var n;t=t||1/0;for(var r=e.length,i=null,o=[],s=0;s<r;++s){if(55295<(n=e.charCodeAt(s))&&n<57344){if(!i){if(56319<n){-1<(t-=3)&&o.push(239,191,189);continue}if(s+1===r){-1<(t-=3)&&o.push(239,191,189);continue}i=n;continue}if(n<56320){-1<(t-=3)&&o.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&-1<(t-=3)&&o.push(239,191,189);if(i=null,n<128){if(--t<0)break;o.push(n)}else if(n<2048){if((t-=2)<0)break;o.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;o.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return o}function S(e){return Pr.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(t,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function k(e,t,n,r){for(var i=0;i<r&&!(i+n>=t.length||i>=e.length);++i)t[i+n]=e[i];return i}function P(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function C(e){return e!=e}}.call(this)}.call(this,t({}).Buffer)}),o=tl={};function s(){throw new Error("setTimeout has not been defined")}function u(){throw new Error("clearTimeout has not been defined")}function l(t){if(n===setTimeout)return setTimeout(t,0);if((n===s||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:s}catch(e){n=s}try{r="function"==typeof clearTimeout?clearTimeout:u}catch(e){r=u}}();var c,p=[],d=!1,h=-1;function f(){d&&c&&(d=!1,c.length?p=c.concat(p):h=-1,p.length&&y())}function y(){if(!d){var e=l(f);d=!0;for(var t=p.length;t;){for(c=p,p=[];++h<t;)c&&c[h].run();h=-1,t=p.length}c=null,d=!1,function(t){if(r===clearTimeout)return clearTimeout(t);if((r===u||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(t);try{r(t)}catch(e){try{return r.call(null,t)}catch(e){return r.call(this,t)}}}(e)}}function g(e,t){this.fun=e,this.array=t}function m(){}o.nextTick=function(e){var t=new Array(arguments.length-1);if(1<arguments.length)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];p.push(new g(e,t)),1!==p.length||d||l(y)},g.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=m,o.addListener=m,o.once=m,o.off=m,o.removeListener=m,o.removeAllListeners=m,o.emit=m,o.prependListener=m,o.prependOnceListener=m,o.listeners=function(e){return[]},o.binding=function(e){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(e){throw new Error("process.chdir is not supported")},o.umask=function(){return 0};var v={exports:{}};!function(B,I){!function(){var e,t;e=this,t=function(){"use strict";function u(e){return"function"==typeof e}var n=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},r=0,t=void 0,i=void 0,a=function(e,t){p[r]=e,p[r+1]=t,2===(r+=2)&&(i?i(d):g())},e="undefined"!=typeof window?window:void 0,o=e||{},s=o.MutationObserver||o.WebKitMutationObserver,l="undefined"==typeof self&&void 0!==B&&"[object process]"==={}.toString.call(B),o="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel;function c(){var e=setTimeout;return function(){return e(d,1)}}var p=new Array(1e3);function d(){for(var e=0;e<r;e+=2)(0,p[e])(p[e+1]),p[e]=void 0,p[e+1]=void 0;r=0}var h,f,y,g=void 0;function m(e,t){var n=this,r=new this.constructor(w);void 0===r[b]&&U(r);var i,o=n._state;return o?(i=arguments[o-1],a(function(){return E(o,r,i,n._result)})):F(n,r,e,t),r}function v(e){if(e&&"object"==typeof e&&e.constructor===this)return e;var t=new this(w);return S(t,e),t}var g=l?function(){return B.nextTick(d)}:s?(f=0,s=new s(d),y=document.createTextNode(""),s.observe(y,{characterData:!0}),function(){y.data=f=++f%2}):o?((h=new MessageChannel).port1.onmessage=d,function(){return h.port2.postMessage(0)}):(void 0===e?function(){try{var e=Function("return this")().require("vertx");return void 0!==(t=e.runOnLoop||e.runOnContext)?function(){t(d)}:c()}catch(e){return c()}}:c)(),b=Math.random().toString(36).substring(2);function w(){}function _(e,t,n){var i,o,r,s;t.constructor===e.constructor&&n===m&&t.constructor.resolve===v?(r=e,1===(s=t)._state?P(r,s._result):2===s._state?C(r,s._result):F(s,void 0,function(e){return S(r,e)},function(e){return C(r,e)})):void 0!==n&&u(n)?(i=t,o=n,a(function(n){var r=!1,e=function(e,t){try{e.call(t,function(e){r||(r=!0,(i!==e?S:P)(n,e))},function(e){r||(r=!0,C(n,e))})}catch(e){return e}}(o,i,n._label);!r&&e&&(r=!0,C(n,e))},e)):P(e,t)}function S(t,e){if(t===e)C(t,new TypeError("You cannot resolve a promise with itself"));else if(n=typeof e,null===e||"object"!=n&&"function"!=n)P(t,e);else{n=void 0;try{n=e.then}catch(e){return void C(t,e)}_(t,e,n)}var n}function k(e){e._onerror&&e._onerror(e._result),A(e)}function P(e,t){void 0===e._state&&(e._result=t,e._state=1,0!==e._subscribers.length&&a(A,e))}function C(e,t){void 0===e._state&&(e._state=2,e._result=t,a(k,e))}function F(e,t,n,r){var i=e._subscribers,o=i.length;e._onerror=null,i[o]=t,i[o+1]=n,i[o+2]=r,0===o&&e._state&&a(A,e)}function A(e){var t=e._subscribers,n=e._state;if(0!==t.length){for(var r,i=void 0,o=e._result,s=0;s<t.length;s+=3)r=t[s],i=t[s+n],r?E(n,r,i,o):i(o);e._subscribers.length=0}}function E(e,t,n,r){var i=u(n),o=void 0,s=void 0,a=!0;if(i){try{o=n(r)}catch(e){a=!1,s=e}if(t===o)return void C(t,new TypeError("A promises callback cannot return that same promise."))}else o=r;void 0!==t._state||(i&&a?S(t,o):!1===a?C(t,s):1===e?P(t,o):2===e&&C(t,o))}var O=0;function U(e){e[b]=O++,e._state=void 0,e._result=void 0,e._subscribers=[]}var R=(D.prototype._enumerate=function(e){for(var t=0;void 0===this._state&&t<e.length;t++)this._eachEntry(e[t],t)},D.prototype._eachEntry=function(t,e){var n=this._instanceConstructor,r=n.resolve;if(r===v){var i,o=void 0,s=void 0,a=!1;try{o=t.then}catch(e){a=!0,s=e}o===m&&void 0!==t._state?this._settledAt(t._state,e,t._result):"function"!=typeof o?(this._remaining--,this._result[e]=t):n===T?(i=new n(w),a?C(i,s):_(i,t,o),this._willSettleAt(i,e)):this._willSettleAt(new n(function(e){return e(t)}),e)}else this._willSettleAt(r(t),e)},D.prototype._settledAt=function(e,t,n){var r=this.promise;void 0===r._state&&(this._remaining--,2===e?C(r,n):this._result[t]=n),0===this._remaining&&P(r,this._result)},D.prototype._willSettleAt=function(e,t){var n=this;F(e,void 0,function(e){return n._settledAt(1,t,e)},function(e){return n._settledAt(2,t,e)})},D),T=(x.prototype.catch=function(e){return this.then(null,e)},x.prototype.finally=function(t){var n=this.constructor;return u(t)?this.then(function(e){return n.resolve(t()).then(function(){return e})},function(e){return n.resolve(t()).then(function(){throw e})}):this.then(t,t)},x);function x(e){this[b]=O++,this._result=this._state=void 0,this._subscribers=[],w!==e&&("function"!=typeof e&&function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof x?function(t,e){try{e(function(e){S(t,e)},function(e){C(t,e)})}catch(e){C(t,e)}}(this,e):function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}())}function D(e,t){this._instanceConstructor=e,this.promise=new e(w),this.promise[b]||U(this.promise),n(t)?(this.length=t.length,this._remaining=t.length,this._result=new Array(this.length),0===this.length?P(this.promise,this._result):(this.length=this.length||0,this._enumerate(t),0===this._remaining&&P(this.promise,this._result))):C(this.promise,new Error("Array Methods must be provided an Array"))}return T.prototype.then=m,T.all=function(e){return new R(this,e).promise},T.race=function(i){var o=this;return n(i)?new o(function(e,t){for(var n=i.length,r=0;r<n;r++)o.resolve(i[r]).then(e,t)}):new o(function(e,t){return t(new TypeError("You must pass an array to race."))})},T.resolve=v,T.reject=function(e){var t=new this(w);return C(t,e),t},T._setScheduler=function(e){i=e},T._setAsap=function(e){a=e},T._asap=a,T.polyfill=function(){var e=void 0;if(void 0!==I)e=I;else if("undefined"!=typeof self)e=self;else try{e=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}var t=e.Promise;if(t){var n=null;try{n=Object.prototype.toString.call(t.resolve())}catch(e){}if("[object Promise]"===n&&!t.cast)return}e.Promise=T},T.Promise=T},"object"==typeof v.exports?v.exports=t():e.ES6Promise=t()}.call(this)}.call(this,tl,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{}),(v=v.exports).polyfill();var b=function(a){"use strict";var t,n,r="URLSearchParams"in self,i="Symbol"in self&&"iterator"in Symbol,u="FileReader"in self&&"Blob"in self&&function(){try{return new Blob,!0}catch(e){return!1}}(),o="FormData"in self,s="ArrayBuffer"in self;function l(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(e))throw new TypeError("Invalid character in header field name");return e.toLowerCase()}function c(e){return e="string"!=typeof e?String(e):e}function e(t){var e={next:function(){var e=t.shift();return{done:void 0===e,value:e}}};return i&&(e[Symbol.iterator]=function(){return e}),e}function p(t){this.map={},t instanceof p?t.forEach(function(e,t){this.append(t,e)},this):Array.isArray(t)?t.forEach(function(e){this.append(e[0],e[1])},this):t&&Object.getOwnPropertyNames(t).forEach(function(e){this.append(e,t[e])},this)}function d(e){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}function h(n){return new Promise(function(e,t){n.onload=function(){e(n.result)},n.onerror=function(){t(n.error)}})}function f(e){var t=new FileReader,n=h(t);return t.readAsArrayBuffer(e),n}function y(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function g(){return this.bodyUsed=!1,this._initBody=function(e){var t;(this._bodyInit=e)?"string"==typeof e?this._bodyText=e:u&&Blob.prototype.isPrototypeOf(e)?this._bodyBlob=e:o&&FormData.prototype.isPrototypeOf(e)?this._bodyFormData=e:r&&URLSearchParams.prototype.isPrototypeOf(e)?this._bodyText=e.toString():s&&u&&(t=e)&&DataView.prototype.isPrototypeOf(t)?(this._bodyArrayBuffer=y(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):s&&(ArrayBuffer.prototype.isPrototypeOf(e)||n(e))?this._bodyArrayBuffer=y(e):this._bodyText=e=Object.prototype.toString.call(e):this._bodyText="",this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):r&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},u&&(this.blob=function(){var e=d(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?d(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(f)}),this.text=function(){var e,t,n=d(this);if(n)return n;if(this._bodyBlob)return e=this._bodyBlob,n=h(t=new FileReader),t.readAsText(e),n;if(this._bodyArrayBuffer)return Promise.resolve(function(e){for(var t=new Uint8Array(e),n=new Array(t.length),r=0;r<t.length;r++)n[r]=String.fromCharCode(t[r]);return n.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},o&&(this.formData=function(){return this.text().then(b)}),this.json=function(){return this.text().then(JSON.parse)},this}s&&(t=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],n=ArrayBuffer.isView||function(e){return e&&-1<t.indexOf(Object.prototype.toString.call(e))}),p.prototype.append=function(e,t){e=l(e),t=c(t);var n=this.map[e];this.map[e]=n?n+", "+t:t},p.prototype.delete=function(e){delete this.map[l(e)]},p.prototype.get=function(e){return e=l(e),this.has(e)?this.map[e]:null},p.prototype.has=function(e){return this.map.hasOwnProperty(l(e))},p.prototype.set=function(e,t){this.map[l(e)]=c(t)},p.prototype.forEach=function(e,t){for(var n in this.map)this.map.hasOwnProperty(n)&&e.call(t,this.map[n],n,this)},p.prototype.keys=function(){var n=[];return this.forEach(function(e,t){n.push(t)}),e(n)},p.prototype.values=function(){var t=[];return this.forEach(function(e){t.push(e)}),e(t)},p.prototype.entries=function(){var n=[];return this.forEach(function(e,t){n.push([t,e])}),e(n)},i&&(p.prototype[Symbol.iterator]=p.prototype.entries);var m=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function v(e,t){var n,r=(t=t||{}).body;if(e instanceof v){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new p(e.headers)),this.method=e.method,this.mode=e.mode,this.signal=e.signal,r||null==e._bodyInit||(r=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=t.credentials||this.credentials||"same-origin",!t.headers&&this.headers||(this.headers=new p(t.headers)),this.method=(e=(n=t.method||this.method||"GET").toUpperCase(),-1<m.indexOf(e)?e:n),this.mode=t.mode||this.mode||null,this.signal=t.signal||this.signal,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&r)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(r)}function b(e){var n=new FormData;return e.trim().split("&").forEach(function(e){var t;e&&(e=(t=e.split("=")).shift().replace(/\+/g," "),t=t.join("=").replace(/\+/g," "),n.append(decodeURIComponent(e),decodeURIComponent(t)))}),n}function w(e,t){t=t||{},this.type="default",this.status=void 0===t.status?200:t.status,this.ok=200<=this.status&&this.status<300,this.statusText="statusText"in t?t.statusText:"OK",this.headers=new p(t.headers),this.url=t.url||"",this._initBody(e)}v.prototype.clone=function(){return new v(this,{body:this._bodyInit})},g.call(v.prototype),g.call(w.prototype),w.prototype.clone=function(){return new w(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new p(this.headers),url:this.url})},w.error=function(){var e=new w(null,{status:0,statusText:""});return e.type="error",e};var _=[301,302,303,307,308];w.redirect=function(e,t){if(-1===_.indexOf(t))throw new RangeError("Invalid status code");return new w(null,{status:t,headers:{location:e}})},a.DOMException=self.DOMException;try{new a.DOMException}catch(e){a.DOMException=function(e,t){this.message=e,this.name=t;e=Error(e);this.stack=e.stack},a.DOMException.prototype=Object.create(Error.prototype),a.DOMException.prototype.constructor=a.DOMException}function S(o,s){return new Promise(function(r,e){var t=new v(o,s);if(t.signal&&t.signal.aborted)return e(new a.DOMException("Aborted","AbortError"));var i=new XMLHttpRequest;function n(){i.abort()}i.onload=function(){var n,e={status:i.status,statusText:i.statusText,headers:(t=i.getAllResponseHeaders()||"",n=new p,t.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach(function(e){var t=e.split(":"),e=t.shift().trim();e&&(t=t.join(":").trim(),n.append(e,t))}),n)};e.url="responseURL"in i?i.responseURL:e.headers.get("X-Request-URL");var t="response"in i?i.response:i.responseText;r(new w(t,e))},i.onerror=function(){e(new TypeError("Network request failed"))},i.ontimeout=function(){e(new TypeError("Network request failed"))},i.onabort=function(){e(new a.DOMException("Aborted","AbortError"))},i.open(t.method,t.url,!0),"include"===t.credentials?i.withCredentials=!0:"omit"===t.credentials&&(i.withCredentials=!1),"responseType"in i&&u&&(i.responseType="blob"),t.headers.forEach(function(e,t){i.setRequestHeader(t,e)}),t.signal&&(t.signal.addEventListener("abort",n),i.onreadystatechange=function(){4===i.readyState&&t.signal.removeEventListener("abort",n)}),i.send(void 0===t._bodyInit?null:t._bodyInit)})}S.polyfill=!0,self.fetch||(self.fetch=S,self.Headers=p,self.Request=v,self.Response=w),a.Headers=p,a.Request=v,a.Response=w,a.fetch=S,Object.defineProperty(a,"__esModule",{value:!0})};"object"==typeof(_={exports:{}}).exports?b(_.exports):b(this.WHATWGFetch={});function w(e,t){return Object.prototype.hasOwnProperty.call(e,t)}var _=_.exports;function S(){return(S=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,r=arguments[t];for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function k(){var r={},u=r._fns={};return r.emit=function(e,t,n,r,i,o,s){var a=function(e){for(var t=u[e]||[],n=e.indexOf(":"),r=-1===n?[e]:[e.substring(0,n),e.substring(n+1)],i=Object.keys(u),o=0,s=i.length;o<s;o++){var a=i[o];if("*"===a&&(t=t.concat(u[a])),2===r.length&&r[0]===a){t=t.concat(u[a]);break}}return t}(e);a.length&&function(e,t,n){for(var r=0,i=t.length;r<i&&t[r];r++)t[r].event=e,t[r].apply(t[r],n)}(e,a,[t,n,r,i,o,s])},r.on=function(e,t){u[e]||(u[e]=[]),u[e].push(t)},r.once=function(t,n){this.on(t,function e(){n.apply(this,arguments),r.off(t,e)})},r.off=function(e,t){var n=[];if(e&&t)for(var r=this._fns[e],i=0,o=r?r.length:0;i<o;i++)r[i]!==t&&n.push(r[i]);n.length?this._fns[e]=n:delete this._fns[e]},r}var P,C=((Mt=T.prototype)._apply=function(e){var t;e&&e.strings&&(t=this.locale,this.locale=S({},t,{strings:S({},t.strings,e.strings)}),this.locale.pluralize=e.pluralize||t.pluralize)},Mt.interpolate=function(e,t){var n,r,i=String.prototype,o=i.split,s=i.replace,a=/\$/g,u=[e];for(n in t)"_"!==n&&w(t,n)&&("string"==typeof(r=t[n])&&(r=s.call(t[n],a,"$$$$")),u=function(e,t,r){var i=[];return e.forEach(function(e){return"string"!=typeof e?i.push(e):void o.call(e,t).forEach(function(e,t,n){""!==e&&i.push(e),t<n.length-1&&i.push(r)})}),i}(u,new RegExp("%\\{"+n+"\\}","g"),r));return u},Mt.translate=function(e,t){return this.translateArray(e,t).join("")},Mt.translateArray=function(e,t){if(!w(this.locale.strings,e))throw new Error("missing string: "+e);var n=this.locale.strings[e];if("object"!=typeof n)return this.interpolate(n,t);if(t&&void 0!==t.smart_count){e=this.locale.pluralize(t.smart_count);return this.interpolate(n[e],t)}throw new Error("Attempted to use a string with plural forms, but no value was given for %{smart_count}")},T),F=function(e,t){e="000000000"+e;return e.substr(e.length-t)},A="object"==typeof window?window:self,E=Object.keys(A).length,O=F(((navigator.mimeTypes?navigator.mimeTypes.length:0)+navigator.userAgent.length).toString(36)+E.toString(36),4),U=function(){return O},R="undefined"!=typeof window&&(window.crypto||window.msCrypto)||"undefined"!=typeof self&&self.crypto;function T(e){var t=this;this.locale={strings:{},pluralize:function(e){return 1===e?0:1}},Array.isArray(e)?e.forEach(function(e){return t._apply(e)}):this._apply(e)}var x=R?(P=Math.pow(2,32)-1,function(){return Math.abs(R.getRandomValues(new Uint32Array(1))[0]/P)}):Math.random,D={},B=0,I=Math.pow(36,4);function j(){return F((x()*I<<0).toString(36),4)}function M(){return B=B<I?B:0,++B-1}function L(){return"c"+(new Date).getTime().toString(36)+F(M().toString(36),4)+U()+(j()+j())}L.slug=function(){var e=(new Date).getTime().toString(36),t=M().toString(36).slice(-4),n=U().slice(0,1)+U().slice(-1),r=j().slice(-2);return e.slice(-2)+t+n+r},L.isCuid=function(e){return"string"==typeof e&&!!e.startsWith("c")},L.isSlug=function(e){if("string"!=typeof e)return!1;e=e.length;return 7<=e&&e<=10},L.fingerprint=U;var D=L,N={};!function(l){!function(){function v(){return n.Date.now()}var r=/^\s+|\s+$/g,i=/^[-+]0x[0-9a-f]+$/i,o=/^0b[01]+$/i,s=/^0o[0-7]+$/i,a=parseInt,e="object"==typeof l&&l&&l.Object===Object&&l,t="object"==typeof self&&self&&self.Object===Object&&self,n=e||t||Function("return this")(),u=Object.prototype.toString,b=Math.max,w=Math.min;function _(e){var t=typeof e;return e&&("object"==t||"function"==t)}function S(e){if("number"==typeof e)return e;if("symbol"==typeof(t=e)||t&&"object"==typeof t&&"[object Symbol]"==u.call(t))return NaN;var t;if("string"!=typeof(e=_(e)?_(n="function"==typeof e.valueOf?e.valueOf():e)?n+"":n:e))return 0===e?e:+e;e=e.replace(r,"");var n=o.test(e);return n||s.test(e)?a(e.slice(2),n?2:8):i.test(e)?NaN:+e}N=function(e,t,n){var r=!0,i=!0;if("function"!=typeof e)throw new TypeError("Expected a function");return _(n)&&(r="leading"in n?!!n.leading:r,i="trailing"in n?!!n.trailing:i),function(r,n,e){var i,o,s,a,u,l,c=0,p=!1,d=!1,t=!0;if("function"!=typeof r)throw new TypeError("Expected a function");function h(e){var t=i,n=o;return i=o=void 0,c=e,a=r.apply(n,t)}function f(e){var t=e-l;return void 0===l||n<=t||t<0||d&&s<=e-c}function y(){var e,t=v();if(f(t))return g(t);u=setTimeout(y,(e=n-(t-l),d?w(e,s-(t-c)):e))}function g(e){return u=void 0,t&&i?h(e):(i=o=void 0,a)}function m(){var e=v(),t=f(e);if(i=arguments,o=this,l=e,t){if(void 0===u)return c=t=l,u=setTimeout(y,n),p?h(t):a;if(d)return u=setTimeout(y,n),h(l)}return void 0===u&&(u=setTimeout(y,n)),a}return n=S(n)||0,_(e)&&(p=!!e.leading,s=(d="maxWait"in e)?b(S(e.maxWait)||0,n):s,t="trailing"in e?!!e.trailing:t),m.cancel=function(){void 0!==u&&clearTimeout(u),i=l=o=u=void(c=0)},m.flush=function(){return void 0===u?a:g(v())},m}(e,t,{leading:r,maxWait:t,trailing:i})}}.call(this)}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});function z(e){if("number"!=typeof e||isNaN(e))throw new TypeError("Expected a number, got "+typeof e);var t=e<0,n=["B","KB","MB","GB","TB","PB","EB","ZB","YB"];if((e=t?-e:e)<1)return(t?"-":"")+e+" B";var r=Math.min(Math.floor(Math.log(e)/Math.log(1024)),n.length-1);return e=Number(e/Math.pow(1024,r)),r=n[r],10<=e||e%1==0?(t?"-":"")+e.toFixed(0)+" "+r:(t?"-":"")+e.toFixed(1)+" "+r}function q(e,t){this.text=e=e||"",this.hasWild=~e.indexOf("*"),this.separator=t,this.parts=e.split(t)}q.prototype.match=function(e){var t,n,r=!0,i=this.parts,o=i.length;if("string"==typeof e||e instanceof String)if(this.hasWild||this.text==e){for(n=(e||"").split(this.separator),t=0;r&&t<o;t++)"*"!==i[t]&&(r=t<n.length&&i[t]===n[t]);r=r&&n}else r=!1;else if("function"==typeof e.splice)for(r=[],t=e.length;t--;)this.match(e[t])&&(r[r.length]=e[t]);else if("object"==typeof e)for(var s in r={},e)this.match(s)&&(r[s]=e[s]);return r};var H=function(e,t,n){n=new q(e,n||/[\/\.]/);return void 0!==t?n.match(t):n},V=/[\/\+\.]/;function W(){return(W=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,r=arguments[t];for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}var X=((yn=G.prototype).getState=function(){return this.state},yn.setState=function(e){var t=W({},this.state),n=W({},this.state,e);this.state=n,this._publish(t,n,e)},yn.subscribe=function(e){var t=this;return this.callbacks.push(e),function(){t.callbacks.splice(t.callbacks.indexOf(e),1)}},yn._publish=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.callbacks.forEach(function(e){e.apply(void 0,t)})},G);function G(){this.state={},this.callbacks=[]}X.VERSION="1.2.4";function K(e){var t=e.lastIndexOf(".");return-1===t||t===e.length-1?{name:e,extension:void 0}:{name:e.slice(0,t),extension:e.slice(t+1)}}function $(e){var t=(t=e.name?K(e.name).extension:null)?t.toLowerCase():null;return e.type||(t&&J[t]?J[t]:"application/octet-stream")}var Y=function(){return new X},J={md:"text/markdown",markdown:"text/markdown",mp4:"video/mp4",mp3:"audio/mp3",svg:"image/svg+xml",jpg:"image/jpeg",png:"image/png",gif:"image/gif",heic:"image/heic",heif:"image/heif",yaml:"text/yaml",yml:"text/yaml",csv:"text/csv",tsv:"text/tab-separated-values",tab:"text/tab-separated-values",avi:"video/x-msvideo",mks:"video/x-matroska",mkv:"video/x-matroska",mov:"video/quicktime",doc:"application/msword",docm:"application/vnd.ms-word.document.macroenabled.12",docx:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",dot:"application/msword",dotm:"application/vnd.ms-word.template.macroenabled.12",dotx:"application/vnd.openxmlformats-officedocument.wordprocessingml.template",xla:"application/vnd.ms-excel",xlam:"application/vnd.ms-excel.addin.macroenabled.12",xlc:"application/vnd.ms-excel",xlf:"application/x-xliff+xml",xlm:"application/vnd.ms-excel",xls:"application/vnd.ms-excel",xlsb:"application/vnd.ms-excel.sheet.binary.macroenabled.12",xlsm:"application/vnd.ms-excel.sheet.macroenabled.12",xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",xlt:"application/vnd.ms-excel",xltm:"application/vnd.ms-excel.template.macroenabled.12",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template",xlw:"application/vnd.ms-excel",txt:"text/plain",text:"text/plain",conf:"text/plain",log:"text/plain",pdf:"application/pdf"};function Q(e){var t="";return e.replace(/[^A-Z0-9]/gi,function(e){return t+="-"+e.charCodeAt(0).toString(32),"/"})+t}function Z(e){var t="uppy";return"string"==typeof e.name&&(t+="-"+Q(e.name.toLowerCase())),void 0!==e.type&&(t+="-"+e.type),e.meta&&"string"==typeof e.meta.relativePath&&(t+="-"+Q(e.meta.relativePath.toLowerCase())),void 0!==e.data.size&&(t+="-"+e.data.size),void 0!==e.data.lastModified&&(t+="-"+e.data.lastModified),t}function ee(e){return 2!==e.length?0+e:e}function te(){var e=new Date;return ee(e.getHours().toString())+":"+ee(e.getMinutes().toString())+":"+ee(e.getSeconds().toString())}var ne={debug:function(){},warn:function(){},error:function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return(e=console).error.apply(e,["[Uppy] ["+te()+"]"].concat(n))}},re={debug:function(){for(var e=console.debug||console.log,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];e.call.apply(e,[console,"[Uppy] ["+te()+"]"].concat(n))},warn:function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return(e=console).warn.apply(e,["[Uppy] ["+te()+"]"].concat(n))},error:function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return(e=console).error.apply(e,["[Uppy] ["+te()+"]"].concat(n))}},ie={exports:{}};!function(){"use strict";function u(){}function n(e,t){for(var n,r,i,o=p,s=arguments.length;2<s--;)c.push(arguments[s]);for(t&&null!=t.children&&(c.length||c.push(t.children),delete t.children);c.length;)if((r=c.pop())&&void 0!==r.pop)for(s=r.length;s--;)c.push(r[s]);else"boolean"==typeof r&&(r=null),(i="function"!=typeof e)&&(null==r?r="":"number"==typeof r?r=String(r):"string"!=typeof r&&(i=!1)),i&&n?o[o.length-1]+=r:o===p?o=[r]:o.push(r),n=i;var a=new u;return a.nodeName=e,a.children=o,a.attributes=null==t?void 0:t,a.key=null==t?void 0:t.key,void 0!==T.vnode&&T.vnode(a),a}function _(e,t){for(var n in t)e[n]=t[n];return e}function o(e){!e.__d&&(e.__d=!0)&&1==f.push(e)&&(T.debounceRendering||r)(t)}function t(){var e,t=f;for(f=[];e=t.pop();)e.__d&&C(e)}function F(e,t){return e.__n===t||e.nodeName.toLowerCase()===t.toLowerCase()}function S(e){var t=_({},e.attributes);t.children=e.children;var n=e.nodeName.defaultProps;if(void 0!==n)for(var r in n)void 0===t[r]&&(t[r]=n[r]);return t}function A(e){var t=e.parentNode;t&&t.removeChild(e)}function d(e,t,n,r,i){if("key"!==(t="className"===t?"class":t))if("ref"===t)n&&n(null),r&&r(e);else if("class"!==t||i)if("style"===t){if(r&&"string"!=typeof r&&"string"!=typeof n||(e.style.cssText=r||""),r&&"object"==typeof r){if("string"!=typeof n)for(var o in n)o in r||(e.style[o]="");for(var o in r)e.style[o]="number"==typeof r[o]&&!1===h.test(o)?r[o]+"px":r[o]}}else{var s;"dangerouslySetInnerHTML"===t?r&&(e.innerHTML=r.__html||""):"o"==t[0]&&"n"==t[1]?(s=t!==(t=t.replace(/Capture$/,"")),t=t.toLowerCase().substring(2),r?n||e.addEventListener(t,a,s):e.removeEventListener(t,a,s),(e.__l||(e.__l={}))[t]=r):"list"!==t&&"type"!==t&&!i&&t in e?(function(e,t,n){try{e[t]=n}catch(e){}}(e,t,null==r?"":r),null!=r&&!1!==r||e.removeAttribute(t)):(i=i&&t!==(t=t.replace(/^xlink:?/,"")),null==r||!1===r?i?e.removeAttributeNS("http://www.w3.org/1999/xlink",t.toLowerCase()):e.removeAttribute(t):"function"!=typeof r&&(i?e.setAttributeNS("http://www.w3.org/1999/xlink",t.toLowerCase(),r):e.setAttribute(t,r)))}else e.className=r||""}function a(e){return this.__l[e.type](T.event&&T.event(e)||e)}function k(){for(var e;e=x.pop();)T.afterMount&&T.afterMount(e),e.componentDidMount&&e.componentDidMount()}function P(e,t,n,r,i,o){D++||(y=null!=i&&void 0!==i.ownerSVGElement,g=null!=e&&!("__preactattr_"in e));r=function C(e,t,n,r,i){var o=e,s=y;if("string"==typeof(t=null==t||"boolean"==typeof t?"":t)||"number"==typeof t)return e&&void 0!==e.splitText&&e.parentNode&&(!e._component||i)?e.nodeValue!=t&&(e.nodeValue=t):(o=document.createTextNode(t),e&&(e.parentNode&&e.parentNode.replaceChild(o,e),E(e,!0))),o.__preactattr_=!0,o;i=t.nodeName;if("function"==typeof i)return function(e,t,n,r){for(var i=e&&e._component,o=i,s=e,a=i&&e._componentConstructor===t.nodeName,u=a,l=S(t);i&&!u&&(i=i.__u);)u=i.constructor===t.nodeName;return i&&u&&(!r||i._component)?(U(i,l,3,n,r),e=i.base):(o&&!a&&(R(o),e=s=null),i=O(t.nodeName,l,n),e&&!i.__b&&(i.__b=e,s=null),U(i,l,1,n,r),e=i.base,s&&e!==s&&(s._component=null,E(s,!1))),e}(e,t,n,r);if(y="svg"===i||"foreignObject"!==i&&y,i=String(i),(!e||!F(e,i))&&(a=i,(l=y?document.createElementNS("http://www.w3.org/2000/svg",a):document.createElement(a)).__n=a,o=l,e)){for(;e.firstChild;)o.appendChild(e.firstChild);e.parentNode&&e.parentNode.replaceChild(o,e),E(e,!0)}var a=o.firstChild,u=o.__preactattr_,l=t.children;if(null==u)for(var u=o.__preactattr_={},c=o.attributes,p=c.length;p--;)u[c[p].name]=c[p].value;return!g&&l&&1===l.length&&"string"==typeof l[0]&&null!=a&&void 0!==a.splitText&&null==a.nextSibling?a.nodeValue!=l[0]&&(a.nodeValue=l[0]):(l&&l.length||null!=a)&&function(e,t,n,r,i){var o,s,a,u,l,c,p,d=e.childNodes,h=[],f={},y=0,g=0,m=d.length,v=0,b=t?t.length:0;if(0!==m)for(var w=0;w<m;w++){var _=d[w],S=_.__preactattr_;null!=(k=b&&S?_._component?_._component.__k:S.key:null)?(y++,f[k]=_):(S||(void 0!==_.splitText?!i||_.nodeValue.trim():i))&&(h[v++]=_)}if(0!==b)for(w=0;w<b;w++){var k,P=null;if(null!=(k=(u=t[w]).key))y&&void 0!==f[k]&&(P=f[k],f[k]=void 0,y--);else if(!P&&g<v)for(o=g;o<v;o++)if(void 0!==h[o]&&(l=s=h[o],p=i,"string"==typeof(c=u)||"number"==typeof c?void 0!==l.splitText:"string"==typeof c.nodeName?!l._componentConstructor&&F(l,c.nodeName):p||l._componentConstructor===c.nodeName)){P=s,h[o]=void 0,o===v-1&&v--,o===g&&g++;break}P=C(P,u,n,r),a=d[w],P&&P!==e&&P!==a&&(null==a?e.appendChild(P):P===a.nextSibling?A(a):e.insertBefore(P,a))}if(y)for(var w in f)void 0!==f[w]&&E(f[w],!1);for(;g<=v;)void 0!==(P=h[v--])&&E(P,!1)}(o,l,n,r,g||null!=u.dangerouslySetInnerHTML),function(e,t,n){for(var r in n)t&&null!=t[r]||null==n[r]||d(e,r,n[r],n[r]=void 0,y);for(r in t)"children"===r||"innerHTML"===r||r in n&&t[r]===("value"===r||"checked"===r?e:n)[r]||d(e,r,n[r],n[r]=t[r],y)}(o,t.attributes,u),y=s,o}(e,t,n,r,o);return i&&r.parentNode!==i&&i.appendChild(r),--D||(g=!1,o||k()),r}function E(e,t){var n=e._component;n?R(n):(null!=e.__preactattr_&&e.__preactattr_.ref&&e.__preactattr_.ref(null),!1!==t&&null!=e.__preactattr_||A(e),i(e))}function i(e){for(e=e.lastChild;e;){var t=e.previousSibling;E(e,!0),e=t}}function O(e,t,n){var r,i=m[e.name];if(e.prototype&&e.prototype.render?(r=new e(t,n),l.call(r,t,n)):((r=new l(t,n)).constructor=e,r.render=s),i)for(var o=i.length;o--;)if(i[o].constructor===e){r.__b=i[o].__b,i.splice(o,1);break}return r}function s(e,t,n){return this.constructor(e,n)}function U(e,t,n,r,i){e.__x||(e.__x=!0,(e.__r=t.ref)&&delete t.ref,(e.__k=t.key)&&delete t.key,!e.base||i?e.componentWillMount&&e.componentWillMount():e.componentWillReceiveProps&&e.componentWillReceiveProps(t,r),r&&r!==e.context&&(e.__c||(e.__c=e.context),e.context=r),e.__p||(e.__p=e.props),e.props=t,e.__x=!1,0!==n&&(1!==n&&!1===T.syncComponentUpdates&&e.base?o(e):C(e,1,i)),e.__r&&e.__r(e))}function C(e,t,n,r){if(!e.__x){var i,o=e.props,s=e.state,a=e.context,u=e.__p||o,l=e.__s||s,c=e.__c||a,p=e.base,d=e.__b,h=p||d,f=e._component,y=!1;if(p&&(e.props=u,e.state=l,e.context=c,2!==t&&e.shouldComponentUpdate&&!1===e.shouldComponentUpdate(o,s,a)?y=!0:e.componentWillUpdate&&e.componentWillUpdate(o,s,a),e.props=o,e.state=s,e.context=a),e.__p=e.__s=e.__c=e.__b=null,e.__d=!1,!y){o=e.render(o,s,a),e.getChildContext&&(a=_(_({},a),e.getChildContext()));var g,m,v,s=o&&o.nodeName;if("function"==typeof s?(v=S(o),(i=f)&&i.constructor===s&&v.key==i.__k?U(i,v,1,a,!1):(g=i,e._component=i=O(s,v,a),i.__b=i.__b||d,i.__u=e,U(i,v,0,a,!1),C(i,1,n,!0)),m=i.base):(v=h,(g=f)&&(v=e._component=null),!h&&1!==t||(v&&(v._component=null),m=P(v,o,a,n||!p,h&&h.parentNode,!0))),!h||m===h||i===f||(f=h.parentNode)&&m!==f&&(f.replaceChild(m,h),g||(h._component=null,E(h,!1))),g&&R(g),(e.base=m)&&!r){for(var b=e,w=e;w=w.__u;)(b=w).base=m;m._component=b,m._componentConstructor=b.constructor}}if(!p||n?x.unshift(e):y||(e.componentDidUpdate&&e.componentDidUpdate(u,l,c),T.afterUpdate&&T.afterUpdate(e)),null!=e.__h)for(;e.__h.length;)e.__h.pop().call(e);D||r||k()}}function R(e){T.beforeUnmount&&T.beforeUnmount(e);var t=e.base;e.__x=!0,e.componentWillUnmount&&e.componentWillUnmount(),e.base=null;var n,r=e._component;r?R(r):t&&(t.__preactattr_&&t.__preactattr_.ref&&t.__preactattr_.ref(null),A(e.__b=t),r=(n=e).constructor.name,(m[r]||(m[r]=[])).push(n),i(t)),e.__r&&e.__r(null)}function l(e,t){this.__d=!0,this.context=t,this.props=e,this.state=this.state||{}}var T={},c=[],p=[],r="function"==typeof Promise?Promise.resolve().then.bind(Promise.resolve()):setTimeout,h=/acit|ex(?:s|g|n|p|$)|rph|ows|mnc|ntw|ine[ch]|zoo|^ord/i,f=[],x=[],D=0,y=!1,g=!1,m={};_(l.prototype,{setState:function(e,t){var n=this.state;this.__s||(this.__s=_({},n)),_(n,"function"==typeof e?e(n,this.props):e),t&&(this.__h=this.__h||[]).push(t),o(this)},forceUpdate:function(e){e&&(this.__h=this.__h||[]).push(e),C(this,2)},render:function(){}}),ie.exports={h:n,createElement:n,cloneElement:function(e,t){return n(e.nodeName,_(_({},e.attributes),t),2<arguments.length?[].slice.call(arguments,2):e.children)},Component:l,render:function(e,t,n){return P(n,e,{},!1,t,!1)},rerender:t,options:T}}();function oe(e){return e&&"object"==typeof e&&e.nodeType===Node.ELEMENT_NODE}function se(e,t){return void 0===t&&(t=document),"string"==typeof e?t.querySelector(e):oe(e)?e:void 0}ie=ie.exports;function ae(){return(ae=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,r=arguments[t];for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}var ue,le=((Ni=ce.prototype).getPluginState=function(){return this.uppy.getState().plugins[this.id]||{}},Ni.setPluginState=function(e){var t,n=this.uppy.getState().plugins;this.uppy.setState({plugins:ae({},n,((t={})[this.id]=ae({},n[this.id],e),t))})},Ni.setOptions=function(e){this.opts=ae({},this.opts,e),this.setPluginState()},Ni.update=function(e){void 0!==this.el&&this._updateUI&&this._updateUI(e)},Ni.afterUpdate=function(){},Ni.onMount=function(){},Ni.mount=function(e,t){var r,i,o,n,s,a=this,u=t.id,l=se(e);if(l)return this.isTargetDOMEl=!0,this.rerender=function(e){a.uppy.getPlugin(a.id)&&(a.el=ie.render(a.render(e),l,a.el),a.afterUpdate())},this._updateUI=(r=this.rerender,i=null,function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return o=t,i=i||Promise.resolve().then(function(){return i=null,r.apply(void 0,o)})}),this.uppy.log("Installing "+u+" to a DOM element '"+e+"'"),this.opts.replaceTargetContent&&(l.innerHTML=""),this.el=ie.render(this.render(this.uppy.getState()),l),this.onMount(),this.el;if("object"==typeof e&&e instanceof ce?n=e:"function"==typeof e&&(s=e,this.uppy.iteratePlugins(function(e){if(e instanceof s)return n=e,!1})),n)return this.uppy.log("Installing "+u+" to "+n.id),this.parent=n,this.el=n.addTarget(t),this.onMount(),this.el;this.uppy.log("Not installing "+u);u="Invalid target option given to "+u+".";throw new Error(u+="function"==typeof e?" The given target is not a Plugin class. Please check that you're not specifying a React Component instead of a plugin. If you are using @uppy/* packages directly, make sure you have only 1 version of @uppy/core installed: run `npm ls @uppy/core` on the command line and verify that all the versions match and are deduped correctly.":"If you meant to target an HTML element, please make sure that the element exists. Check that the <script> tag initializing Uppy is right before the closing </body> tag at the end of the page. (see https://github.com/transloadit/uppy/issues/1042)\n\nIf you meant to target a plugin, please confirm that your `import` statements or `require` calls are correct.")},Ni.render=function(e){throw new Error("Extend the render method to add your plugin to a DOM element")},Ni.addTarget=function(e){throw new Error("Extend the addTarget method to add your plugin to another plugin's target")},Ni.unmount=function(){this.isTargetDOMEl&&this.el&&this.el.parentNode&&this.el.parentNode.removeChild(this.el)},Ni.install=function(){},Ni.uninstall=function(){this.unmount()},ce);function ce(e,t){this.uppy=e,this.opts=t||{},this.update=this.update.bind(this),this.mount=this.mount.bind(this),this.install=this.install.bind(this),this.uninstall=this.uninstall.bind(this)}function pe(){return(pe=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,r=arguments[t];for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function de(e){var n="function"==typeof Map?new Map:void 0;return(de=function(e){if(null===e||-1===Function.toString.call(e).indexOf("[native code]"))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==n){if(n.has(e))return n.get(e);n.set(e,t)}function t(){return he(e,arguments,ye(this).constructor)}return t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),fe(t,e)})(e)}function he(e,t,n){return(he=function(){if("undefined"!=typeof Reflect&&Reflect.construct&&!Reflect.construct.sham){if("function"==typeof Proxy)return 1;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),1}catch(e){return}}}()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);r=new(Function.bind.apply(e,r));return n&&fe(r,n.prototype),r}).apply(null,arguments)}function fe(e,t){return(fe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ye(e){return(ye=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var ge,me=ne,ve=re,be=(ge=de(Error),pa=ge,(ha=Se).prototype=Object.create(pa.prototype),(ha.prototype.constructor=ha).__proto__=pa,Se),we=((Ls=_e.prototype).on=function(e,t){return this.emitter.on(e,t),this},Ls.off=function(e,t){return this.emitter.off(e,t),this},Ls.updateAll=function(t){this.iteratePlugins(function(e){e.update(t)})},Ls.setState=function(e){this.store.setState(e)},Ls.getState=function(){return this.store.getState()},Ls.setFileState=function(e,t){var n;if(!this.getState().files[e])throw new Error("Cant set state for "+e+" (the file could have been removed)");this.setState({files:pe({},this.getState().files,((n={})[e]=pe({},this.getState().files[e],t),n))})},Ls.i18nInit=function(){this.translator=new C([this.defaultLocale,this.opts.locale]),this.locale=this.translator.locale,this.i18n=this.translator.translate.bind(this.translator),this.i18nArray=this.translator.translateArray.bind(this.translator)},Ls.setOptions=function(e){this.opts=pe({},this.opts,e,{restrictions:pe({},this.opts.restrictions,e&&e.restrictions)}),e.meta&&this.setMeta(e.meta),this.i18nInit(),e.locale&&this.iteratePlugins(function(e){e.setOptions()}),this.setState()},Ls.resetProgress=function(){var n={percentage:0,bytesUploaded:0,uploadComplete:!1,uploadStarted:null},r=pe({},this.getState().files),i={};Object.keys(r).forEach(function(e){var t=pe({},r[e]);t.progress=pe({},t.progress,n),i[e]=t}),this.setState({files:i,totalProgress:0}),this.emit("reset-progress")},Ls.addPreProcessor=function(e){this.preProcessors.push(e)},Ls.removePreProcessor=function(e){e=this.preProcessors.indexOf(e);-1!==e&&this.preProcessors.splice(e,1)},Ls.addPostProcessor=function(e){this.postProcessors.push(e)},Ls.removePostProcessor=function(e){e=this.postProcessors.indexOf(e);-1!==e&&this.postProcessors.splice(e,1)},Ls.addUploader=function(e){this.uploaders.push(e)},Ls.removeUploader=function(e){e=this.uploaders.indexOf(e);-1!==e&&this.uploaders.splice(e,1)},Ls.setMeta=function(t){var e=pe({},this.getState().meta,t),n=pe({},this.getState().files);Object.keys(n).forEach(function(e){n[e]=pe({},n[e],{meta:pe({},n[e].meta,t)})}),this.log("Adding metadata:"),this.log(t),this.setState({meta:e,files:n})},Ls.setFileMeta=function(e,t){var n=pe({},this.getState().files);n[e]?(t=pe({},n[e].meta,t),n[e]=pe({},n[e],{meta:t}),this.setState({files:n})):this.log("Was trying to set metadata for a file that has been removed: ",e)},Ls.getFile=function(e){return this.getState().files[e]},Ls.getFiles=function(){var t=this.getState().files;return Object.keys(t).map(function(e){return t[e]})},Ls.validateRestrictions=function(e,t){try{return this._checkRestrictions(e,t),{result:!0}}catch(e){return{result:!1,reason:e.message}}},Ls._checkRestrictions=function(r,e){void 0===e&&(e=this.getFiles());var t=this.opts.restrictions,n=t.maxFileSize,i=t.minFileSize,o=t.maxTotalFileSize,s=t.maxNumberOfFiles,t=t.allowedFileTypes;if(s&&e.length+1>s)throw new be(""+this.i18n("youCanOnlyUploadX",{smart_count:s}));if(t&&!t.some(function(e){return-1<e.indexOf("/")?!!r.type&&(n=r.type.replace(/;.*?$/,""),e?t(e.split(";")[0]):t):!("."!==e[0]||!r.extension)&&r.extension.toLowerCase()===e.substr(1).toLowerCase();function t(e){e=H(e,n,V);return e&&2<=e.length}var n})){t=t.join(", ");throw new be(this.i18n("youCanOnlyUploadFileTypes",{types:t}))}if(o&&null!=r.size){var a=0;if(a+=r.size,e.forEach(function(e){a+=e.size}),o<a)throw new be(this.i18n("exceedsSize2",{backwardsCompat:this.i18n("exceedsSize"),size:z(o)}))}if(n&&null!=r.size&&r.size>n)throw new be(this.i18n("exceedsSize2",{backwardsCompat:this.i18n("exceedsSize"),size:z(n)}));if(i&&null!=r.size&&r.size<i)throw new be(this.i18n("inferiorSize",{size:z(i)}))},Ls._checkMinNumberOfFiles=function(e){var t=this.opts.restrictions.minNumberOfFiles;if(Object.keys(e).length<t)throw new be(""+this.i18n("youHaveToAtLeastSelectX",{smart_count:t}))},Ls._showOrLogErrorAndThrow=function(e,t){var n=void 0===t?{}:t,r=n.showInformer,i=void 0===r||r,o=n.file,s=void 0===o?null:o,t=n.throwErr,r=void 0===t||t,o="object"==typeof e?e.message:e,n="object"==typeof e&&e.details?e.details:"",t=o;if(n&&(t+=" "+n),e.isRestriction?(this.log(t),this.emit("restriction-failed",s,e)):this.log(t,"error"),i&&this.info({message:o,details:n},"error",this.opts.infoTimeout),r)throw"object"==typeof e?e:new Error(e)},Ls._assertNewUploadAllowed=function(e){!1===this.getState().allowNewUpload&&this._showOrLogErrorAndThrow(new be(this.i18n("noNewAlreadyUploading")),{file:e})},Ls._checkAndCreateFileStateObject=function(t,n){var e=$(n);n.type=e;var r=this.opts.onBeforeFileAdded(n,t);!1===r&&this._showOrLogErrorAndThrow(new be("Cannot add the file because onBeforeFileAdded returned false."),{showInformer:!1,file:n});var i=(n="object"==typeof r&&r?r:n).name||("image"===e.split("/")[0]?e.split("/")[0]+"."+e.split("/")[1]:"noname"),o=K(i).extension,s=n.isRemote||!1,a=Z(n);t[a]&&this._showOrLogErrorAndThrow(new be(this.i18n("noDuplicates",{fileName:i})),{file:n});var u=n.meta||{};u.name=i,u.type=e;r=isFinite(n.data.size)?n.data.size:null,n={source:n.source||"",id:a,name:i,extension:o||"",meta:pe({},this.getState().meta,u),type:e,data:n.data,progress:{percentage:0,bytesUploaded:0,bytesTotal:r,uploadComplete:!1,uploadStarted:null},size:r,isRemote:s,remote:n.remote||"",preview:n.preview};try{var l=Object.keys(t).map(function(e){return t[e]});this._checkRestrictions(n,l)}catch(e){this._showOrLogErrorAndThrow(e,{file:n})}return n},Ls._startIfAutoProceed=function(){var t=this;this.opts.autoProceed&&!this.scheduledAutoProceed&&(this.scheduledAutoProceed=setTimeout(function(){t.scheduledAutoProceed=null,t.upload().catch(function(e){e.isRestriction||t.log(e.stack||e.message||e)})},4))},Ls.addFile=function(e){this._assertNewUploadAllowed(e);var t=this.getState().files,e=this._checkAndCreateFileStateObject(t,e);return this.setState({files:pe({},t,((t={})[e.id]=e,t))}),this.emit("file-added",e),this.log("Added file: "+e.name+", "+e.id+", mime type: "+e.type),this._startIfAutoProceed(),e.id},Ls.addFiles=function(e){var t=this;this._assertNewUploadAllowed();for(var n=pe({},this.getState().files),r=[],i=[],o=0;o<e.length;o++)try{var s=this._checkAndCreateFileStateObject(n,e[o]);r.push(s),n[s.id]=s}catch(u){u.isRestriction||i.push(u)}if(this.setState({files:n}),r.forEach(function(e){t.emit("file-added",e)}),5<r.length?this.log("Added batch of "+r.length+" files"):Object.keys(r).forEach(function(e){t.log("Added file: "+r[e].name+"\n id: "+r[e].id+"\n type: "+r[e].type)}),0<r.length&&this._startIfAutoProceed(),0<i.length){var a="Multiple errors occurred while adding files:\n";i.forEach(function(e){a+="\n * "+e.message}),this.info({message:this.i18n("addBulkFilesFailed",{smart_count:i.length}),details:a},"error",this.opts.infoTimeout);var u=new Error(a);throw u.errors=i,u}},Ls.removeFiles=function(e,t){var n=this,r=this.getState(),i=r.files,o=r.currentUploads,s=pe({},i),a=pe({},o),u=Object.create(null);function l(e){return void 0===u[e]}e.forEach(function(e){i[e]&&(u[e]=i[e],delete s[e])});var c=[];Object.keys(a).forEach(function(e){var t=o[e].fileIDs.filter(l);0!==t.length?a[e]=pe({},o[e],{fileIDs:t}):c.push(e)}),c.forEach(function(e){delete a[e]});e={currentUploads:a,files:s};0===Object.keys(s).length&&(e.allowNewUpload=!0,e.error=null),this.setState(e),this._calculateTotalProgress();e=Object.keys(u);e.forEach(function(e){n.emit("file-removed",u[e],t)}),5<e.length?this.log("Removed "+e.length+" files"):this.log("Removed files: "+e.join(", "))},Ls.removeFile=function(e,t){this.removeFiles([e],t=void 0===t?null:t)},Ls.pauseResume=function(e){if(this.getState().capabilities.resumableUploads&&!this.getFile(e).uploadComplete){var t=!this.getFile(e).isPaused;return this.setFileState(e,{isPaused:t}),this.emit("upload-pause",e,t),t}},Ls.pauseAll=function(){var n=pe({},this.getState().files);Object.keys(n).filter(function(e){return!n[e].progress.uploadComplete&&n[e].progress.uploadStarted}).forEach(function(e){var t=pe({},n[e],{isPaused:!0});n[e]=t}),this.setState({files:n}),this.emit("pause-all")},Ls.resumeAll=function(){var n=pe({},this.getState().files);Object.keys(n).filter(function(e){return!n[e].progress.uploadComplete&&n[e].progress.uploadStarted}).forEach(function(e){var t=pe({},n[e],{isPaused:!1,error:null});n[e]=t}),this.setState({files:n}),this.emit("resume-all")},Ls.retryAll=function(){var n=pe({},this.getState().files),e=Object.keys(n).filter(function(e){return n[e].error});if(e.forEach(function(e){var t=pe({},n[e],{isPaused:!1,error:null});n[e]=t}),this.setState({files:n,error:null}),this.emit("retry-all",e),0===e.length)return Promise.resolve({successful:[],failed:[]});e=this._createUpload(e,{forceAllowNewUpload:!0});return this._runUpload(e)},Ls.cancelAll=function(){this.emit("cancel-all");var e=this.getState().files,e=Object.keys(e);e.length&&this.removeFiles(e,"cancel-all"),this.setState({totalProgress:0,error:null})},Ls.retryUpload=function(e){this.setFileState(e,{error:null,isPaused:!1}),this.emit("upload-retry",e);e=this._createUpload([e],{forceAllowNewUpload:!0});return this._runUpload(e)},Ls.reset=function(){this.cancelAll()},Ls._calculateProgress=function(e,t){var n;this.getFile(e.id)?(n=isFinite(t.bytesTotal)&&0<t.bytesTotal,this.setFileState(e.id,{progress:pe({},this.getFile(e.id).progress,{bytesUploaded:t.bytesUploaded,bytesTotal:t.bytesTotal,percentage:n?Math.round(t.bytesUploaded/t.bytesTotal*100):0})}),this._calculateTotalProgress()):this.log("Not setting progress for a file that has been removed: "+e.id)},Ls._calculateTotalProgress=function(){var e=this.getFiles().filter(function(e){return e.progress.uploadStarted||e.progress.preprocess||e.progress.postprocess});if(0===e.length)return this.emit("progress",0),void this.setState({totalProgress:0});var t,n,r,i=e.filter(function(e){return null!=e.progress.bytesTotal}),o=e.filter(function(e){return null==e.progress.bytesTotal});0!==i.length?(r=i.reduce(function(e,t){return e+t.progress.bytesTotal},0),r+=(t=r/i.length)*o.length,n=0,i.forEach(function(e){n+=e.progress.bytesUploaded}),o.forEach(function(e){n+=t*(e.progress.percentage||0)/100}),r=0===r?0:Math.round(n/r*100),this.setState({totalProgress:r=100<r?100:r}),this.emit("progress",r)):(e=100*e.length,o=o.reduce(function(e,t){return e+t.progress.percentage},0),e=Math.round(o/e*100),this.setState({totalProgress:e}))},Ls._addListeners=function(){var i=this;this.on("error",function(e){var t="Unknown error";e.message&&(t=e.message),e.details&&(t+=" "+e.details),i.setState({error:t})}),this.on("upload-error",function(e,t,n){var r="Unknown error";t.message&&(r=t.message),t.details&&(r+=" "+t.details),i.setFileState(e.id,{error:r,response:n}),i.setState({error:t.message}),"object"==typeof t&&t.message?((n=new Error(t.message)).details=t.message,t.details&&(n.details+=" "+t.details),n.message=i.i18n("failedToUpload",{file:e.name}),i._showOrLogErrorAndThrow(n,{throwErr:!1})):i._showOrLogErrorAndThrow(t,{throwErr:!1})}),this.on("upload",function(){i.setState({error:null})}),this.on("upload-started",function(e,t){i.getFile(e.id)?i.setFileState(e.id,{progress:{uploadStarted:Date.now(),uploadComplete:!1,percentage:0,bytesUploaded:0,bytesTotal:e.size}}):i.log("Not setting progress for a file that has been removed: "+e.id)}),this.on("upload-progress",this._calculateProgress),this.on("upload-success",function(e,t){var n;i.getFile(e.id)?(n=i.getFile(e.id).progress,i.setFileState(e.id,{progress:pe({},n,{postprocess:0<i.postProcessors.length?{mode:"indeterminate"}:null,uploadComplete:!0,percentage:100,bytesUploaded:n.bytesTotal}),response:t,uploadURL:t.uploadURL,isPaused:!1}),i._calculateTotalProgress()):i.log("Not setting progress for a file that has been removed: "+e.id)}),this.on("preprocess-progress",function(e,t){i.getFile(e.id)?i.setFileState(e.id,{progress:pe({},i.getFile(e.id).progress,{preprocess:t})}):i.log("Not setting progress for a file that has been removed: "+e.id)}),this.on("preprocess-complete",function(e){var t;i.getFile(e.id)?((t=pe({},i.getState().files))[e.id]=pe({},t[e.id],{progress:pe({},t[e.id].progress)}),delete t[e.id].progress.preprocess,i.setState({files:t})):i.log("Not setting progress for a file that has been removed: "+e.id)}),this.on("postprocess-progress",function(e,t){i.getFile(e.id)?i.setFileState(e.id,{progress:pe({},i.getState().files[e.id].progress,{postprocess:t})}):i.log("Not setting progress for a file that has been removed: "+e.id)}),this.on("postprocess-complete",function(e){var t;i.getFile(e.id)?((t=pe({},i.getState().files))[e.id]=pe({},t[e.id],{progress:pe({},t[e.id].progress)}),delete t[e.id].progress.postprocess,i.setState({files:t})):i.log("Not setting progress for a file that has been removed: "+e.id)}),this.on("restored",function(){i._calculateTotalProgress()}),"undefined"!=typeof window&&window.addEventListener&&(window.addEventListener("online",function(){return i.updateOnlineStatus()}),window.addEventListener("offline",function(){return i.updateOnlineStatus()}),setTimeout(function(){return i.updateOnlineStatus()},3e3))},Ls.updateOnlineStatus=function(){void 0===window.navigator.onLine||window.navigator.onLine?(this.emit("is-online"),this.wasOffline&&(this.emit("back-online"),this.info(this.i18n("connectedToInternet"),"success",3e3),this.wasOffline=!1)):(this.emit("is-offline"),this.info(this.i18n("noInternetConnection"),"error",0),this.wasOffline=!0)},Ls.getID=function(){return this.opts.id},Ls.use=function(e,t){if("function"!=typeof e)throw new TypeError("Expected a plugin class, but got "+(null===e?"null":typeof e)+". Please verify that the plugin was imported and spelled correctly.");var n=new e(this,t),r=n.id;if(this.plugins[n.type]=this.plugins[n.type]||[],!r)throw new Error("Your plugin must have an id");if(!n.type)throw new Error("Your plugin must have a type");t=this.getPlugin(r);if(t){t="Already found a plugin named '"+t.id+"'. Tried to use: '"+r+"'.\nUppy plugins must have unique `id` options. See https://uppy.io/docs/plugins/#id.";throw new Error(t)}return e.VERSION&&this.log("Using "+r+" v"+e.VERSION),this.plugins[n.type].push(n),n.install(),this},Ls.getPlugin=function(t){var n=null;return this.iteratePlugins(function(e){if(e.id===t)return n=e,!1}),n},Ls.iteratePlugins=function(t){var n=this;Object.keys(this.plugins).forEach(function(e){n.plugins[e].forEach(t)})},Ls.removePlugin=function(e){this.log("Removing plugin "+e.id),this.emit("plugin-remove",e),e.uninstall&&e.uninstall();var t=this.plugins[e.type].slice(),n=t.indexOf(e);-1!==n&&(t.splice(n,1),this.plugins[e.type]=t);t=this.getState();delete t.plugins[e.id],this.setState(t)},Ls.close=function(){var t=this;this.log("Closing Uppy instance "+this.opts.id+": removing all files and uninstalling plugins"),this.reset(),this._storeUnsubscribe(),this.iteratePlugins(function(e){t.removePlugin(e)})},Ls.info=function(e,t,n){void 0===n&&(n=3e3);var r="object"==typeof e;this.setState({info:{isHidden:!1,type:t=void 0===t?"info":t,message:r?e.message:e,details:r?e.details:null}}),this.emit("info-visible"),clearTimeout(this.infoTimeoutID),this.infoTimeoutID=0!==n?setTimeout(this.hideInfo,n):void 0},Ls.hideInfo=function(){var e=pe({},this.getState().info,{isHidden:!0});this.setState({info:e}),this.emit("info-hidden")},Ls.log=function(e,t){var n=this.opts.logger;switch(t){case"error":n.error(e);break;case"warning":n.warn(e);break;default:n.debug(e)}},Ls.run=function(){return this.log("Calling run() is no longer necessary.","warning"),this},Ls.restore=function(e){return this.log('Core: attempting to restore upload "'+e+'"'),this.getState().currentUploads[e]?this._runUpload(e):(this._removeUpload(e),Promise.reject(new Error("Nonexistent upload")))},Ls._createUpload=function(e,t){var n=(t=void 0===t?{}:t).forceAllowNewUpload,r=void 0!==n&&n,t=this.getState(),n=t.allowNewUpload,t=t.currentUploads;if(!n&&!r)throw new Error("Cannot create a new upload: already uploading.");r=D();return this.emit("upload",{id:r,fileIDs:e}),this.setState({allowNewUpload:!1!==this.opts.allowMultipleUploads,currentUploads:pe({},t,((t={})[r]={fileIDs:e,step:0,result:{}},t))}),r},Ls._getUpload=function(e){return this.getState().currentUploads[e]},Ls.addResultData=function(e,t){var n;this._getUpload(e)?(t=pe({},(n=this.getState().currentUploads)[e],{result:pe({},n[e].result,t)}),this.setState({currentUploads:pe({},n,((n={})[e]=t,n))})):this.log("Not setting result for an upload that has been removed: "+e)},Ls._removeUpload=function(e){var t=pe({},this.getState().currentUploads);delete t[e],this.setState({currentUploads:t})},Ls._runUpload=function(i){var o=this,e=this.getState().currentUploads[i].step,t=[].concat(this.preProcessors,this.uploaders,this.postProcessors),s=Promise.resolve();return t.forEach(function(n,r){r<e||(s=s.then(function(){var e=o.getState().currentUploads,t=e[i];if(t){t=pe({},t,{step:r});return o.setState({currentUploads:pe({},e,((e={})[i]=t,e))}),n(t.fileIDs,i)}}).then(function(e){return null}))}),s.catch(function(e){o.emit("error",e,i),o._removeUpload(i)}),s.then(function(){var e,t=o.getState().currentUploads[i];t&&(t=(e=t.fileIDs.map(function(e){return o.getFile(e)})).filter(function(e){return!e.error}),e=e.filter(function(e){return e.error}),o.addResultData(i,{successful:t,failed:e,uploadID:i}))}).then(function(){var e=o.getState().currentUploads;if(e[i]){e=e[i].result;return o.emit("complete",e),o._removeUpload(i),e}}).then(function(e){return null==e&&o.log("Not setting result for an upload that has been removed: "+i),e})},Ls.upload=function(){var o=this;this.plugins.uploader||this.log("No uploader type plugins are used","warning");var t=this.getState().files,e=this.opts.onBeforeUpload(t);return!1===e?Promise.reject(new Error("Not starting the upload because onBeforeUpload returned false")):(e&&"object"==typeof e&&(t=e,this.setState({files:t})),Promise.resolve().then(function(){return o._checkMinNumberOfFiles(t)}).catch(function(e){o._showOrLogErrorAndThrow(e)}).then(function(){var n=o.getState().currentUploads,r=Object.keys(n).reduce(function(e,t){return e.concat(n[t].fileIDs)},[]),i=[];Object.keys(t).forEach(function(e){var t=o.getFile(e);t.progress.uploadStarted||-1!==r.indexOf(e)||i.push(t.id)});var e=o._createUpload(i);return o._runUpload(e)}).catch(function(e){o._showOrLogErrorAndThrow(e,{showInformer:!1})}))},function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(_e.prototype,[{key:"state",get:function(){return this.getState()}}]),_e);function _e(e){var r=this,t={id:"uppy",autoProceed:!(this.defaultLocale={strings:{addBulkFilesFailed:{0:"Failed to add %{smart_count} file due to an internal error",1:"Failed to add %{smart_count} files due to internal errors"},youCanOnlyUploadX:{0:"You can only upload %{smart_count} file",1:"You can only upload %{smart_count} files"},youHaveToAtLeastSelectX:{0:"You have to select at least %{smart_count} file",1:"You have to select at least %{smart_count} files"},exceedsSize2:"%{backwardsCompat} %{size}",exceedsSize:"This file exceeds maximum allowed size of",inferiorSize:"This file is smaller than the allowed size of %{size}",youCanOnlyUploadFileTypes:"You can only upload: %{types}",noNewAlreadyUploading:"Cannot add new files: already uploading",noDuplicates:"Cannot add the duplicate file '%{fileName}', it already exists",companionError:"Connection with Companion failed",companionUnauthorizeHint:"To unauthorize to your %{provider} account, please go to %{url}",failedToUpload:"Failed to upload %{file}",noInternetConnection:"No Internet connection",connectedToInternet:"Connected to the Internet",noFilesFound:"You have no files or folders here",selectX:{0:"Select %{smart_count}",1:"Select %{smart_count}"},selectAllFilesFromFolderNamed:"Select all files from folder %{name}",unselectAllFilesFromFolderNamed:"Unselect all files from folder %{name}",selectFileNamed:"Select file %{name}",unselectFileNamed:"Unselect file %{name}",openFolderNamed:"Open folder %{name}",cancel:"Cancel",logOut:"Log out",filter:"Filter",resetFilter:"Reset filter",loading:"Loading...",authenticateWithTitle:"Please authenticate with %{pluginName} to select files",authenticateWith:"Connect to %{pluginName}",searchImages:"Search for images",enterTextToSearch:"Enter text to search for images",backToSearch:"Back to Search",emptyFolderAdded:"No files were added from empty folder",folderAdded:{0:"Added %{smart_count} file from %{folder}",1:"Added %{smart_count} files from %{folder}"}}}),allowMultipleUploads:!0,debug:!1,restrictions:{maxFileSize:null,minFileSize:null,maxTotalFileSize:null,maxNumberOfFiles:null,minNumberOfFiles:null,allowedFileTypes:null},meta:{},onBeforeFileAdded:function(e,t){return e},onBeforeUpload:function(e){return e},store:Y(),logger:me,infoTimeout:5e3};if(this.opts=pe({},t,e,{restrictions:pe({},t.restrictions,e&&e.restrictions)}),e&&e.logger&&e.debug?this.log("You are using a custom `logger`, but also set `debug: true`, which uses built-in logger to output logs to console. Ignoring `debug: true` and using your custom `logger`.","warning"):e&&e.debug&&(this.opts.logger=ve),this.log("Using Core v"+this.constructor.VERSION),this.opts.restrictions.allowedFileTypes&&null!==this.opts.restrictions.allowedFileTypes&&!Array.isArray(this.opts.restrictions.allowedFileTypes))throw new TypeError("`restrictions.allowedFileTypes` must be an array");this.i18nInit(),this.plugins={},this.getState=this.getState.bind(this),this.getPlugin=this.getPlugin.bind(this),this.setFileMeta=this.setFileMeta.bind(this),this.setFileState=this.setFileState.bind(this),this.log=this.log.bind(this),this.info=this.info.bind(this),this.hideInfo=this.hideInfo.bind(this),this.addFile=this.addFile.bind(this),this.removeFile=this.removeFile.bind(this),this.pauseResume=this.pauseResume.bind(this),this.validateRestrictions=this.validateRestrictions.bind(this),this._calculateProgress=N(this._calculateProgress.bind(this),500,{leading:!0,trailing:!0}),this.updateOnlineStatus=this.updateOnlineStatus.bind(this),this.resetProgress=this.resetProgress.bind(this),this.pauseAll=this.pauseAll.bind(this),this.resumeAll=this.resumeAll.bind(this),this.retryAll=this.retryAll.bind(this),this.cancelAll=this.cancelAll.bind(this),this.retryUpload=this.retryUpload.bind(this),this.upload=this.upload.bind(this),this.emitter=k(),this.on=this.on.bind(this),this.off=this.off.bind(this),this.once=this.emitter.once.bind(this.emitter),this.emit=this.emitter.emit.bind(this.emitter),this.preProcessors=[],this.uploaders=[],this.postProcessors=[],this.store=this.opts.store,this.setState({plugins:{},files:{},currentUploads:{},allowNewUpload:!0,capabilities:{uploadProgress:function(e){if(!(e=null==e?"undefined"!=typeof navigator?navigator.userAgent:null:e))return!0;var t=/Edge\/(\d+\.\d+)/.exec(e);if(!t)return!0;e=t[1].split("."),t=e[0],e=e[1],t=parseInt(t,10),e=parseInt(e,10);return t<15||15===t&&e<15063||18<t||18===t&&18218<=e}(),individualCancellation:!0,resumableUploads:!1},totalProgress:0,meta:pe({},this.opts.meta),info:{isHidden:!0,type:"info",message:""}}),this._storeUnsubscribe=this.store.subscribe(function(e,t,n){r.emit("state-update",e,t,n),r.updateAll(t)}),this.opts.debug&&"undefined"!=typeof window&&(window[this.opts.id]=this),this._addListeners()}function Se(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return(e=ge.call.apply(ge,[this].concat(n))||this).isRestriction=!0,e}function ke(e){var n="function"==typeof Map?new Map:void 0;return(ke=function(e){if(null===e||-1===Function.toString.call(e).indexOf("[native code]"))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==n){if(n.has(e))return n.get(e);n.set(e,t)}function t(){return Pe(e,arguments,Fe(this).constructor)}return t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),Ce(t,e)})(e)}function Pe(e,t,n){return(Pe=function(){if("undefined"!=typeof Reflect&&Reflect.construct&&!Reflect.construct.sham){if("function"==typeof Proxy)return 1;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),1}catch(e){return}}}()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);r=new(Function.bind.apply(e,r));return n&&Ce(r,n.prototype),r}).apply(null,arguments)}function Ce(e,t){return(Ce=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Fe(e){return(Fe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}we.VERSION="1.14.2",(ue=function(e){return new we(e)}).Uppy=we,ue.Plugin=le,ue.debugLogger=ve;var Ae,Ee=(Ae=ke(Error),ps=Ae,(_i=Oe).prototype=Object.create(ps.prototype),(_i.prototype.constructor=_i).__proto__=ps,Oe);function Oe(){var e;return(e=Ae.call(this,"Authorization required")||this).name="AuthError",e.isAuthError=!0,e}function Ue(e){var n="function"==typeof Map?new Map:void 0;return(Ue=function(e){if(null===e||-1===Function.toString.call(e).indexOf("[native code]"))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==n){if(n.has(e))return n.get(e);n.set(e,t)}function t(){return Re(e,arguments,xe(this).constructor)}return t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),Te(t,e)})(e)}function Re(e,t,n){return(Re=function(){if("undefined"!=typeof Reflect&&Reflect.construct&&!Reflect.construct.sham){if("function"==typeof Proxy)return 1;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),1}catch(e){return}}}()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);r=new(Function.bind.apply(e,r));return n&&Te(r,n.prototype),r}).apply(null,arguments)}function Te(e,t){return(Te=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function xe(e){return(xe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function De(){return fetch.apply(void 0,arguments).catch(function(e){throw"AbortError"===e.name?e:new Ie(e)})}var Be,Ie=(Be=Ue(Error),ds=Be,(Xr=je).prototype=Object.create(ds.prototype),(Xr.prototype.constructor=Xr).__proto__=ds,je);function je(e,t){return void 0===t&&(t=null),(e=Be.call(this,"This looks like a network error, the endpoint might be blocked by an internet provider or a firewall.\n\nSource error: ["+e+"]")||this).isNetworkError=!0,e.request=t,e}function Me(){return(Me=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,r=arguments[t];for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}var Le=((Fi=ze.prototype).headers=function(){var e=this.opts.companionHeaders||this.opts.serverHeaders||{};return Promise.resolve(Me({},this.defaultHeaders,e))},Fi._getPostResponseFunc=function(t){var n=this;return function(e){return t?e:n.onReceiveResponse(e)}},Fi.onReceiveResponse=function(e){var t=this.uppy.getState().companion||{},n=this.opts.companionUrl,r=e.headers;return r.has("i-am")&&r.get("i-am")!==t[n]&&this.uppy.setState({companion:Me({},t,((t={})[n]=r.get("i-am"),t))}),e},Fi._getUrl=function(e){return/^(https?:|)\/\//.test(e)?e:this.hostname+"/"+e},Fi._json=function(e){if(401===e.status)throw new Ee;if(e.status<200||300<e.status){var t="Failed request with status: "+e.status+". "+e.statusText;return e.json().then(function(e){throw t=e.message?t+" message: "+e.message:t,t=e.requestId?t+" request-Id: "+e.requestId:t,new Error(t)}).catch(function(){throw new Error(t)})}return e.json()},Fi.preflight=function(e){var t=this;return this.preflightDone?Promise.resolve(this.allowedHeaders.slice()):fetch(this._getUrl(e),{method:"OPTIONS"}).then(function(e){return e.headers.has("access-control-allow-headers")&&(t.allowedHeaders=e.headers.get("access-control-allow-headers").split(",").map(function(e){return e.trim().toLowerCase()})),t.preflightDone=!0,t.allowedHeaders.slice()}).catch(function(e){return t.uppy.log("[CompanionClient] unable to make preflight request "+e,"warning"),t.preflightDone=!0,t.allowedHeaders.slice()})},Fi.preflightAndHeaders=function(e){var r=this;return Promise.all([this.preflight(e),this.headers()]).then(function(e){var t=e[0],n=e[1];return Object.keys(n).forEach(function(e){-1===t.indexOf(e.toLowerCase())&&(r.uppy.log("[CompanionClient] excluding unallowed header "+e),delete n[e])}),n})},Fi.get=function(t,e){var n=this;return this.preflightAndHeaders(t).then(function(e){return De(n._getUrl(t),{method:"get",headers:e,credentials:"same-origin"})}).then(this._getPostResponseFunc(e)).then(function(e){return n._json(e)}).catch(function(e){return e=e.isAuthError?e:new Error("Could not get "+n._getUrl(t)+". "+e),Promise.reject(e)})},Fi.post=function(t,n,e){var r=this;return this.preflightAndHeaders(t).then(function(e){return De(r._getUrl(t),{method:"post",headers:e,credentials:"same-origin",body:JSON.stringify(n)})}).then(this._getPostResponseFunc(e)).then(function(e){return r._json(e)}).catch(function(e){return e=e.isAuthError?e:new Error("Could not post "+r._getUrl(t)+". "+e),Promise.reject(e)})},Fi.delete=function(t,n,e){var r=this;return this.preflightAndHeaders(t).then(function(e){return De(r.hostname+"/"+t,{method:"delete",headers:e,credentials:"same-origin",body:n?JSON.stringify(n):null})}).then(this._getPostResponseFunc(e)).then(function(e){return r._json(e)}).catch(function(e){return e=e.isAuthError?e:new Error("Could not delete "+r._getUrl(t)+". "+e),Promise.reject(e)})},function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(ze.prototype,[{key:"hostname",get:function(){var e=this.uppy.getState().companion,t=this.opts.companionUrl;return(e&&e[t]?e[t]:t).replace(/\/$/,"")}},{key:"defaultHeaders",get:function(){return{Accept:"application/json","Content-Type":"application/json","Uppy-Versions":"@uppy/companion-client="+ze.VERSION}}}]),ze.VERSION="1.6.1",ze),Ne={};function ze(e,t){this.uppy=e,this.opts=t,this.onReceiveResponse=this.onReceiveResponse.bind(this),this.allowedHeaders=["accept","content-type","uppy-auth-token"],this.preflightDone=!1}function qe(){return(qe=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,r=arguments[t];for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}Ne.setItem=function(t,n){return new Promise(function(e){localStorage.setItem(t,n),e()})},Ne.getItem=function(e){return Promise.resolve(localStorage.getItem(e))},Ne.removeItem=function(t){return new Promise(function(e){localStorage.removeItem(t),e()})};function He(e){return $e("span",null,$e("button",{type:"button",class:"uppy-u-reset",onclick:e.getFolder},e.title),e.isLast?"":" / ")}var Ve,We={RequestClient:Le,Provider:function(r){var e;function t(e,t){return(e=r.call(this,e,t)||this).provider=t.provider,e.id=e.provider,e.name=e.opts.name||e.id.split("-").map(function(e){return e.charAt(0).toUpperCase()+e.slice(1)}).join(" "),e.pluginId=e.opts.pluginId,e.tokenKey="companion-"+e.pluginId+"-auth-token",e}n=r,(e=t).prototype=Object.create(n.prototype),(e.prototype.constructor=e).__proto__=n;var n=t.prototype;return n.headers=function(){return Promise.all([r.prototype.headers.call(this),this.getAuthToken()]).then(function(e){return qe({},e[0],{"uppy-auth-token":e[1]})})},n.onReceiveResponse=function(e){e=r.prototype.onReceiveResponse.call(this,e);var t=this.uppy.getPlugin(this.pluginId),n=t.getPluginState().authenticated?401!==e.status:e.status<400;return t.setPluginState({authenticated:n}),e},n.setAuthToken=function(e){return this.uppy.getPlugin(this.pluginId).storage.setItem(this.tokenKey,e)},n.getAuthToken=function(){return this.uppy.getPlugin(this.pluginId).storage.getItem(this.tokenKey)},n.authUrl=function(){return this.hostname+"/"+this.id+"/connect"},n.fileUrl=function(e){return this.hostname+"/"+this.id+"/get/"+e},n.list=function(e){return this.get(this.id+"/list/"+(e||""))},n.logout=function(){var t=this;return this.get(this.id+"/logout").then(function(e){return Promise.all([e,t.uppy.getPlugin(t.pluginId).storage.removeItem(t.tokenKey)])}).then(function(e){return e[0]})},t.initPlugin=function(e,t,n){if(e.type="acquirer",e.files=[],n&&(e.opts=qe({},n,t)),t.serverUrl||t.serverPattern)throw new Error("`serverUrl` and `serverPattern` have been renamed to `companionUrl` and `companionAllowedHosts` respectively in the 0.30.5 release. Please consult the docs (for example, https://uppy.io/docs/instagram/ for the Instagram plugin) and use the updated options.`");if(t.companionAllowedHosts){n=t.companionAllowedHosts;if(!("string"==typeof n||Array.isArray(n)||n instanceof RegExp))throw new TypeError(e.id+': the option "companionAllowedHosts" must be one of string, Array, RegExp');e.opts.companionAllowedHosts=n}else/^(?!https?:\/\/).*$/i.test(t.companionUrl)?e.opts.companionAllowedHosts="https://"+t.companionUrl.replace(/^\/\//,""):e.opts.companionAllowedHosts=t.companionUrl;e.storage=e.opts.storage||Ne},t}(Le),SearchProvider:function(n){var e;function t(e,t){return(e=n.call(this,e,t)||this).provider=t.provider,e.id=e.provider,e.name=e.opts.name||e.id.split("-").map(function(e){return e.charAt(0).toUpperCase()+e.slice(1)}).join(" "),e.pluginId=e.opts.pluginId,e}r=n,(e=t).prototype=Object.create(r.prototype),(e.prototype.constructor=e).__proto__=r;var r=t.prototype;return r.fileUrl=function(e){return this.hostname+"/search/"+this.id+"/get/"+e},r.search=function(e,t){return t=t?"&"+t:"",this.get("search/"+this.id+"/list?q="+encodeURIComponent(e)+t)},t}(Le),Socket:((Ss=Qe.prototype).open=function(){var n=this;this.socket=new WebSocket(this.opts.target),this.socket.onopen=function(e){for(n.isOpen=!0;0<n._queued.length&&n.isOpen;){var t=n._queued[0];n.send(t.action,t.payload),n._queued=n._queued.slice(1)}},this.socket.onclose=function(e){n.isOpen=!1},this.socket.onmessage=this._handleMessage},Ss.close=function(){this.socket&&this.socket.close()},Ss.send=function(e,t){this.isOpen?this.socket.send(JSON.stringify({action:e,payload:t})):this._queued.push({action:e,payload:t})},Ss.on=function(e,t){this.emitter.on(e,t)},Ss.emit=function(e,t){this.emitter.emit(e,t)},Ss.once=function(e,t){this.emitter.once(e,t)},Ss._handleMessage=function(e){try{var t=JSON.parse(e.data);this.emit(t.action,t.payload)}catch(e){console.log(e)}},Qe)},Xe=ie.h,Ge=(Ve=ie.Component,oi=Ve,(Ri=Je).prototype=Object.create(oi.prototype),(Ri.prototype.constructor=Ri).__proto__=oi,Je.prototype.render=function(){var e=Xe("span",{class:"uppy-Provider-authTitleName"},this.props.pluginName,Xe("br",null));return Xe("div",{class:"uppy-Provider-auth"},Xe("div",{class:"uppy-Provider-authIcon"},this.props.pluginIcon()),Xe("div",{class:"uppy-Provider-authTitle"},this.props.i18nArray("authenticateWithTitle",{pluginName:e})),Xe("button",{type:"button",class:"uppy-u-reset uppy-c-btn uppy-c-btn-primary uppy-Provider-authBtn",onclick:this.props.handleAuth,"data-uppy-super-focusable":!0},this.props.i18nArray("authenticateWith",{pluginName:this.props.pluginName})))},Je),Ke=ie.h,$e=ie.h,Ye={exports:{}};function Je(){return Ve.apply(this,arguments)||this}function Qe(e){this.opts=e,this._queued=[],this.isOpen=!1,this.emitter=k(),this._handleMessage=this._handleMessage.bind(this),this.close=this.close.bind(this),this.emit=this.emit.bind(this),this.on=this.on.bind(this),this.once=this.once.bind(this),this.send=this.send.bind(this),e&&!1===e.autoOpen||this.open()}!function(){"use strict";var s={}.hasOwnProperty;function a(){for(var e=[],t=0;t<arguments.length;t++){var n=arguments[t];if(n){var r=typeof n;if("string"==r||"number"==r)e.push(n);else if(Array.isArray(n)&&n.length){var i=a.apply(null,n);i&&e.push(i)}else if("object"==r)for(var o in n)s.call(n,o)&&n[o]&&e.push(o)}}return e.join(" ")}Ye.exports?(a.default=a,Ye.exports=a):window.classNames=a}();var Ye=Ye.exports,Ze=ie.h,et=function(t){var e;function n(e){return(e=t.call(this,e)||this).preventEnterPress=e.preventEnterPress.bind(function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)),e}r=t,(e=n).prototype=Object.create(r.prototype),(e.prototype.constructor=e).__proto__=r;var r=n.prototype;return r.preventEnterPress=function(e){13===e.keyCode&&(e.stopPropagation(),e.preventDefault())},r.render=function(){var t=this;return Ze("div",{class:"uppy-ProviderBrowser-search"},Ze("input",{class:"uppy-u-reset uppy-ProviderBrowser-searchInput",type:"text",placeholder:this.props.i18n("filter"),"aria-label":this.props.i18n("filter"),onkeyup:this.preventEnterPress,onkeydown:this.preventEnterPress,onkeypress:this.preventEnterPress,oninput:function(e){return t.props.filterQuery(e)},value:this.props.filterInput}),Ze("svg",{"aria-hidden":"true",focusable:"false",class:"uppy-c-icon uppy-ProviderBrowser-searchIcon",width:"12",height:"12",viewBox:"0 0 12 12"},Ze("path",{d:"M8.638 7.99l3.172 3.172a.492.492 0 1 1-.697.697L7.91 8.656a4.977 4.977 0 0 1-2.983.983C2.206 9.639 0 7.481 0 4.819 0 2.158 2.206 0 4.927 0c2.721 0 4.927 2.158 4.927 4.82a4.74 4.74 0 0 1-1.216 3.17zm-3.71.685c2.176 0 3.94-1.726 3.94-3.856 0-2.129-1.764-3.855-3.94-3.855C2.75.964.984 2.69.984 4.819c0 2.13 1.765 3.856 3.942 3.856z"})),this.props.filterInput&&Ze("button",{class:"uppy-u-reset uppy-ProviderBrowser-searchClose",type:"button","aria-label":this.props.i18n("resetFilter"),title:this.props.i18n("resetFilter"),onclick:this.props.filterQuery},Ze("svg",{"aria-hidden":"true",focusable:"false",class:"uppy-c-icon",viewBox:"0 0 19 19"},Ze("path",{d:"M17.318 17.232L9.94 9.854 9.586 9.5l-.354.354-7.378 7.378h.707l-.62-.62v.706L9.318 9.94l.354-.354-.354-.354L1.94 1.854v.707l.62-.62h-.706l7.378 7.378.354.354.354-.354 7.378-7.378h-.707l.622.62v-.706L9.854 9.232l-.354.354.354.354 7.378 7.378.708-.707-7.38-7.378v.708l7.38-7.38.353-.353-.353-.353-.622-.622-.353-.353-.354.352-7.378 7.38h.708L2.56 1.23 2.208.88l-.353.353-.622.62-.353.355.352.353 7.38 7.38v-.708l-7.38 7.38-.353.353.352.353.622.622.353.353.354-.353 7.38-7.38h-.708l7.38 7.38z"}))))},n}(ie.Component);function tt(){return(tt=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,r=arguments[t];for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function nt(e){return tt({},e,{type:e.mimeType,extension:e.name?K(e.name).extension:null})}var rt=ie.h;function it(){return rt("svg",{"aria-hidden":"true",focusable:"false",class:"uppy-c-icon",width:11,height:14.5,viewBox:"0 0 44 58"},rt("path",{d:"M27.437.517a1 1 0 0 0-.094.03H4.25C2.037.548.217 2.368.217 4.58v48.405c0 2.212 1.82 4.03 4.03 4.03H39.03c2.21 0 4.03-1.818 4.03-4.03V15.61a1 1 0 0 0-.03-.28 1 1 0 0 0 0-.093 1 1 0 0 0-.03-.032 1 1 0 0 0 0-.03 1 1 0 0 0-.032-.063 1 1 0 0 0-.03-.063 1 1 0 0 0-.032 0 1 1 0 0 0-.03-.063 1 1 0 0 0-.032-.03 1 1 0 0 0-.03-.063 1 1 0 0 0-.063-.062l-14.593-14a1 1 0 0 0-.062-.062A1 1 0 0 0 28 .708a1 1 0 0 0-.374-.157 1 1 0 0 0-.156 0 1 1 0 0 0-.03-.03l-.003-.003zM4.25 2.547h22.218v9.97c0 2.21 1.82 4.03 4.03 4.03h10.564v36.438a2.02 2.02 0 0 1-2.032 2.032H4.25c-1.13 0-2.032-.9-2.032-2.032V4.58c0-1.13.902-2.032 2.03-2.032zm24.218 1.345l10.375 9.937.75.718H30.5c-1.13 0-2.032-.9-2.032-2.03V3.89z"}))}function ot(){return rt("svg",{"aria-hidden":"true",focusable:"false",class:"uppy-c-icon",style:{minWidth:16,marginRight:3},viewBox:"0 0 276.157 276.157"},rt("path",{d:"M273.08 101.378c-3.3-4.65-8.86-7.32-15.254-7.32h-24.34V67.59c0-10.2-8.3-18.5-18.5-18.5h-85.322c-3.63 0-9.295-2.875-11.436-5.805l-6.386-8.735c-4.982-6.814-15.104-11.954-23.546-11.954H58.73c-9.292 0-18.638 6.608-21.737 15.372l-2.033 5.752c-.958 2.71-4.72 5.37-7.596 5.37H18.5C8.3 49.09 0 57.39 0 67.59v167.07c0 .886.16 1.73.443 2.52.152 3.306 1.18 6.424 3.053 9.064 3.3 4.652 8.86 7.32 15.255 7.32h188.487c11.395 0 23.27-8.425 27.035-19.18l40.677-116.188c2.11-6.035 1.43-12.164-1.87-16.816zM18.5 64.088h8.864c9.295 0 18.64-6.607 21.738-15.37l2.032-5.75c.96-2.712 4.722-5.373 7.597-5.373h29.565c3.63 0 9.295 2.876 11.437 5.806l6.386 8.735c4.982 6.815 15.104 11.954 23.546 11.954h85.322c1.898 0 3.5 1.602 3.5 3.5v26.47H69.34c-11.395 0-23.27 8.423-27.035 19.178L15 191.23V67.59c0-1.898 1.603-3.5 3.5-3.5zm242.29 49.15l-40.676 116.188c-1.674 4.78-7.812 9.135-12.877 9.135H18.75c-1.447 0-2.576-.372-3.02-.997-.442-.625-.422-1.814.057-3.18l40.677-116.19c1.674-4.78 7.812-9.134 12.877-9.134h188.487c1.448 0 2.577.372 3.02.997.443.625.423 1.814-.056 3.18z"}))}function st(){return rt("svg",{"aria-hidden":"true",focusable:"false",style:{width:16,marginRight:4},viewBox:"0 0 58 58"},rt("path",{d:"M36.537 28.156l-11-7a1.005 1.005 0 0 0-1.02-.033C24.2 21.3 24 21.635 24 22v14a1 1 0 0 0 1.537.844l11-7a1.002 1.002 0 0 0 0-1.688zM26 34.18V23.82L34.137 29 26 34.18z"}),rt("path",{d:"M57 6H1a1 1 0 0 0-1 1v44a1 1 0 0 0 1 1h56a1 1 0 0 0 1-1V7a1 1 0 0 0-1-1zM10 28H2v-9h8v9zm-8 2h8v9H2v-9zm10 10V8h34v42H12V40zm44-12h-8v-9h8v9zm-8 2h8v9h-8v-9zm8-22v9h-8V8h8zM2 8h8v9H2V8zm0 42v-9h8v9H2zm54 0h-8v-9h8v9z"}))}function at(e){if(null!==e.itemIconString)switch(e.itemIconString){case"file":return rt(it,null);case"folder":return rt(ot,null);case"video":return rt(st,null);default:return rt("img",{src:e.itemIconString})}}function ut(e){return ct("li",{class:e.className,title:e.isDisabled?e.restrictionReason:null},ct("div",{"aria-hidden":!0,class:"uppy-ProviderBrowserItem-fakeCheckbox "+(e.isChecked?"uppy-ProviderBrowserItem-fakeCheckbox--is-checked":"")}),ct("button",{type:"button",class:"uppy-u-reset uppy-ProviderBrowserItem-inner",onclick:e.toggleCheckbox,role:"option","aria-label":e.isChecked?e.i18n("unselectFileNamed",{name:e.title}):e.i18n("selectFileNamed",{name:e.title}),"aria-selected":e.isChecked,"aria-disabled":e.isDisabled,disabled:e.isDisabled,"data-uppy-super-focusable":!0},e.itemIconEl,e.showTitles&&e.title))}function lt(e){return pt("li",{class:e.className,title:e.isDisabled?e.restrictionReason:null},pt("button",{type:"button",class:"uppy-u-reset uppy-ProviderBrowserItem-fakeCheckbox "+(e.isChecked?"uppy-ProviderBrowserItem-fakeCheckbox--is-checked":""),onClick:e.toggleCheckbox,id:e.id,role:"option","aria-label":"folder"===(t=e).type?t.isChecked?t.i18n("unselectAllFilesFromFolderNamed",{name:t.title}):t.i18n("selectAllFilesFromFolderNamed",{name:t.title}):t.isChecked?t.i18n("unselectFileNamed",{name:t.title}):t.i18n("selectFileNamed",{name:t.title}),"aria-selected":e.isChecked,"aria-disabled":e.isDisabled,disabled:e.isDisabled,"data-uppy-super-focusable":!0}),"file"===e.type?pt("label",{for:e.id,class:"uppy-u-reset uppy-ProviderBrowserItem-inner"},pt("div",{class:"uppy-ProviderBrowserItem-iconWrap"},e.itemIconEl),e.showTitles&&e.title):pt("button",{type:"button",class:"uppy-u-reset uppy-ProviderBrowserItem-inner",onclick:e.handleFolderClick,"aria-label":e.i18n("openFolderNamed",{name:e.title})},pt("div",{class:"uppy-ProviderBrowserItem-iconWrap"},e.itemIconEl),e.showTitles&&pt("span",null,e.title)));var t}var ct=ie.h,pt=ie.h;function dt(){return(dt=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,r=arguments[t];for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function ht(e){var t=e.getItemIcon(),n=Ye("uppy-ProviderBrowserItem",{"uppy-ProviderBrowserItem--selected":e.isChecked},{"uppy-ProviderBrowserItem--disabled":e.isDisabled},{"uppy-ProviderBrowserItem--noPreview":"video"===t}),r=ft(at,{itemIconString:t});switch(e.viewType){case"grid":return ft(ut,dt({},e,{className:n,itemIconEl:r}));case"list":return ft(lt,dt({},e,{className:n,itemIconEl:r}));default:throw new Error("There is no such type "+e.viewType)}}var ft=ie.h;function yt(){return(yt=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,r=arguments[t];for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function gt(t,n){return{id:t.id,title:t.name,getItemIcon:function(){return t.icon},isChecked:n.isChecked(t),toggleCheckbox:function(e){return n.toggleCheckbox(e,t)},columns:n.columns,showTitles:n.showTitles,viewType:n.viewType,i18n:n.i18n}}function mt(r){return r.folders.length||r.files.length?bt("div",{class:"uppy-ProviderBrowser-body"},bt("ul",{class:"uppy-ProviderBrowser-list",onscroll:r.handleScroll,role:"listbox",tabindex:"-1"},r.folders.map(function(e){return ht(yt({},gt(e,r),{type:"folder",isDisabled:!!r.isChecked(e)&&r.isChecked(e).loading,handleFolderClick:function(){return r.handleFolderClick(e)}}))}),r.files.map(function(e){var t=r.validateRestrictions(nt(e),[].concat(r.uppyFiles,r.currentSelection)),n=gt(e,r),e=t.reason;return ht(yt({},n,{type:"file",isDisabled:!t.result&&!n.isChecked,restrictionReason:e}))}))):bt("div",{class:"uppy-Provider-empty"},r.i18n("noFilesFound"))}function vt(e){return wt("div",{class:"uppy-ProviderBrowser-footer"},wt("button",{class:"uppy-u-reset uppy-c-btn uppy-c-btn-primary",onclick:e.done},e.i18n("selectX",{smart_count:e.selected})),wt("button",{class:"uppy-u-reset uppy-c-btn uppy-c-btn-link",onclick:e.cancel},e.i18n("cancel")))}var bt=ie.h,wt=ie.h;function _t(){return(_t=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,r=arguments[t];for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function St(e){var t=e.currentSelection,n=e.folders,r=e.files,i=e.uppyFiles,o=e.filterItems,s=n,a=r;return""!==e.filterInput&&(s=o(n),a=o(r)),r=t.length,Ct("div",{class:Ye("uppy-ProviderBrowser","uppy-ProviderBrowser-viewType--"+e.viewType)},Ct("div",{class:"uppy-ProviderBrowser-header"},Ct("div",{class:Ye("uppy-ProviderBrowser-headerBar",!e.showBreadcrumbs&&"uppy-ProviderBrowser-headerBar--simple")},e.headerComponent)),e.showFilter&&Ct(et,e),Ct(mt,{columns:[{name:"Name",key:"title"}],folders:s,files:a,sortByTitle:e.sortByTitle,sortByDate:e.sortByDate,isChecked:e.isChecked,handleFolderClick:e.getNextFolder,toggleCheckbox:e.toggleCheckbox,handleScroll:e.handleScroll,title:e.title,showTitles:e.showTitles,i18n:e.i18n,viewType:e.viewType,validateRestrictions:e.validateRestrictions,uppyFiles:i,currentSelection:t}),0<r&&Ct(vt,_t({selected:r},e)))}function kt(e){return Ft("div",{class:"uppy-Provider-loading"},Ft("span",null,e.i18n("loading")))}function Pt(e){return e&&(e=e.split("/")[1],!!/^(jpe?g|gif|png|svg|svg\+xml|bmp|webp|avif)$/.test(e))}var Ct=ie.h,Ft=ie.h,At=((e=Ot.prototype).filterItems=function(e){var t=this.plugin.getPluginState();return t.filterInput&&""!==t.filterInput?e.filter(function(e){return-1!==e.name.toLowerCase().indexOf(t.filterInput.toLowerCase())}):e},e.toggleCheckbox=function(e,t){var i=this;e.stopPropagation(),e.preventDefault(),e.currentTarget.focus();var n,r=this.plugin.getPluginState(),o=r.folders,r=r.files,r=this.filterItems(o.concat(r));this.lastCheckbox&&e.shiftKey?(n=(n=(n=r.indexOf(this.lastCheckbox))<(e=r.indexOf(t))?r.slice(n,e+1):r.slice(e,n+1)).reduce(function(e,t){var n=i.plugin.uppy,r=n.validateRestrictions(nt(t),[].concat(n.getFiles(),e));return r.result?[].concat(e,[t]):(n.info({message:r.reason},"error",n.opts.infoTimeout),e)}),this.plugin.setPluginState({currentSelection:n})):(this.lastCheckbox=t,n=this.plugin.getPluginState().currentSelection,this.isChecked(t)?this.plugin.setPluginState({currentSelection:n.filter(function(e){return e.id!==t.id})}):this.plugin.setPluginState({currentSelection:n.concat([t])}))},e.isChecked=function(t){return this.plugin.getPluginState().currentSelection.some(function(e){return e.id===t.id})},e.loaderWrapper=function(e,t,n){var r=this;e.then(function(e){r.plugin.setPluginState({loading:!1}),t(e)}).catch(function(e){r.plugin.setPluginState({loading:!1}),n(e)}),this.plugin.setPluginState({loading:!0})},Ot),Et=function(e){var t;function n(){return e.apply(this,arguments)||this}r=e,(t=n).prototype=Object.create(r.prototype),(t.prototype.constructor=t).__proto__=r;var r=n.prototype;return r.componentWillUnmount=function(){this.props.onUnmount()},r.render=function(){return this.props.children[0]},n}(ie.Component);function Ot(e){this.plugin=e,this.filterItems=this.filterItems.bind(this),this.toggleCheckbox=this.toggleCheckbox.bind(this),this.isChecked=this.isChecked.bind(this),this.loaderWrapper=this.loaderWrapper.bind(this)}function Ut(){return(Ut=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,r=arguments[t];for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function Rt(e){function t(){n.value&&e.search(n.value)}var n;return xt("div",{class:"uppy-SearchProvider"},xt("input",{class:"uppy-u-reset uppy-c-textInput uppy-SearchProvider-input",type:"text","aria-label":e.i18n("enterTextToSearch"),placeholder:e.i18n("enterTextToSearch"),onkeyup:function(e){13===e.keyCode&&t()},ref:function(e){n=e},"data-uppy-super-focusable":!0}),xt("button",{class:"uppy-u-reset uppy-c-btn uppy-c-btn-primary uppy-SearchProvider-searchButton",type:"button",onclick:t},e.i18n("searchImages")))}var Tt=ie.h,b=((o=Bt.prototype).tearDown=function(){},o._updateFilesAndFolders=function(e,t,n){this.nextPagePath=e.nextPagePath,e.items.forEach(function(e){(e.isFolder?n:t).push(e)}),this.plugin.setPluginState({folders:n,files:t})},o.preFirstRender=function(){this.plugin.setPluginState({didFirstRender:!0}),this.plugin.onFirstRender()},o.getFolder=function(r,i){var o=this;return this._sharedHandler.loaderWrapper(this.provider.list(r),function(e){var t=o.plugin.getPluginState(),n=function(e){for(var t,n=0;n<e.length;n++)if(t=e[n],r===t.id)return n;return-1}(t.directories),t=-1!==n?t.directories.slice(0,n+1):t.directories.concat([{id:r,title:i}]);o.username=e.username||o.username,o._updateFilesAndFolders(e,[],[]),o.plugin.setPluginState({directories:t})},this.handleError)},o.getNextFolder=function(e){this.getFolder(e.requestPath,e.name),this.lastCheckbox=void 0},o.addFile=function(e){var t={id:this.providerFileToId(e),source:this.plugin.id,data:e,name:e.name||e.id,type:e.mimeType,isRemote:!0,body:{fileId:e.id},remote:{companionUrl:this.plugin.opts.companionUrl,url:""+this.provider.fileUrl(e.requestPath),body:{fileId:e.id},providerOptions:this.provider.opts}},n=$(t);n&&Pt(n)&&(t.preview=e.thumbnail),this.plugin.uppy.log("Adding remote file");try{return this.plugin.uppy.addFile(t),!0}catch(e){return e.isRestriction||this.plugin.uppy.log(e),!1}},o.logout=function(){var t=this;this.provider.logout().then(function(e){e.ok&&(e.revoked||(e=t.plugin.uppy.i18n("companionUnauthorizeHint",{provider:t.plugin.title,url:e.manual_revoke_url}),t.plugin.uppy.info(e,"info",7e3)),t.plugin.setPluginState({authenticated:!1,files:[],folders:[],directories:[]}))}).catch(this.handleError)},o.filterQuery=function(e){var t=this.plugin.getPluginState();this.plugin.setPluginState(Ut({},t,{filterInput:e?e.target.value:""}))},o.sortByTitle=function(){var e=Ut({},this.plugin.getPluginState()),t=e.files,n=e.folders,r=e.sorting,t=t.sort(function(e,t){return"titleDescending"===r?t.name.localeCompare(e.name):e.name.localeCompare(t.name)}),n=n.sort(function(e,t){return"titleDescending"===r?t.name.localeCompare(e.name):e.name.localeCompare(t.name)});this.plugin.setPluginState(Ut({},e,{files:t,folders:n,sorting:"titleDescending"===r?"titleAscending":"titleDescending"}))},o.sortByDate=function(){var e=Ut({},this.plugin.getPluginState()),t=e.files,n=e.folders,r=e.sorting,t=t.sort(function(e,t){e=new Date(e.modifiedDate),t=new Date(t.modifiedDate);return"dateDescending"===r?t<e?-1:e<t?1:0:t<e?1:e<t?-1:0}),n=n.sort(function(e,t){e=new Date(e.modifiedDate),t=new Date(t.modifiedDate);return"dateDescending"===r?t<e?-1:e<t?1:0:t<e?1:e<t?-1:0});this.plugin.setPluginState(Ut({},e,{files:t,folders:n,sorting:"dateDescending"===r?"dateAscending":"dateDescending"}))},o.sortBySize=function(){var e=Ut({},this.plugin.getPluginState()),t=e.files,n=e.sorting;t.length&&this.plugin.getItemData(t[0]).size&&(t=t.sort(function(e,t){e=e.size,t=t.size;return"sizeDescending"===n?t<e?-1:e<t?1:0:t<e?1:e<t?-1:0}),this.plugin.setPluginState(Ut({},e,{files:t,sorting:"sizeDescending"===n?"sizeAscending":"sizeDescending"})))},o.addFolder=function(r){var i=this,o=this.providerFileToId(r),s=Ut({},this.plugin.getPluginState().selectedFolders);if(!(o in s&&s[o].loading))return s[o]={loading:!0,files:[]},this.plugin.setPluginState({selectedFolders:Ut({},s)}),this.listAllFiles(r.requestPath).then(function(e){var t=0;e.forEach(function(e){i.addFile(e)&&t++});var n=e.map(i.providerFileToId);s[o]={loading:!1,files:n},i.plugin.setPluginState({selectedFolders:s}),e=e.length?i.plugin.uppy.i18n("folderAdded",{smart_count:t,folder:r.name}):i.plugin.uppy.i18n("emptyFolderAdded"),i.plugin.uppy.info(e)}).catch(function(e){var t=Ut({},i.plugin.getPluginState().selectedFolders);delete t[o],i.plugin.setPluginState({selectedFolders:t}),i.handleError(e)})},o.providerFileToId=function(e){return Z({data:e,name:e.name||e.id,type:e.mimeType})},o.handleAuth=function(){var r=this,e=btoa(JSON.stringify({origin:"origin"in location?location.origin:location.protocol+"//"+location.hostname+(location.port?":"+location.port:"")})),t=encodeURIComponent("@uppy/provider-views="+Bt.VERSION),t=this.provider.authUrl()+"?state="+e+"&uppyVersions="+t,i=window.open(t,"_blank");window.addEventListener("message",function e(t){var n;r._isOriginAllowed(t.origin,r.plugin.opts.companionAllowedHosts)&&t.source===i?(n="string"==typeof t.data?JSON.parse(t.data):t.data).token?(i.close(),window.removeEventListener("message",e),r.provider.setAuthToken(n.token),r.preFirstRender()):r.plugin.uppy.log("did not receive token from auth window"):r.plugin.uppy.log("rejecting event from "+t.origin+" vs allowed pattern "+r.plugin.opts.companionAllowedHosts)})},o._isOriginAllowed=function(t,e){function n(e){return"string"==typeof e?new RegExp("^"+e+"$"):e instanceof RegExp?e:void 0}return(Array.isArray(e)?e.map(n):[n(e)]).filter(function(e){return null!=e}).some(function(e){return e.test(t)||e.test(t+"/")})},o.handleError=function(e){var t,n=this.plugin.uppy;n.log(e.toString()),e.isAuthError||(t=n.i18n("companionError"),n.info({message:t,details:e.toString()},"error",5e3))},o.handleScroll=function(e){var r=this,t=e.target.scrollHeight-(e.target.scrollTop+e.target.offsetHeight),e=this.nextPagePath||null;t<50&&e&&!this._isHandlingScroll&&(this.provider.list(e).then(function(e){var t=r.plugin.getPluginState(),n=t.files,t=t.folders;r._updateFilesAndFolders(e,n,t)}).catch(this.handleError).then(function(){r._isHandlingScroll=!1}),this._isHandlingScroll=!0)},o.listAllFiles=function(e,r){var i=this;return r=(r=void 0===r?null:r)||[],new Promise(function(t,n){i.provider.list(e).then(function(e){e.items.forEach(function(e){e.isFolder?i.addFolder(e):r.push(e)});e=e.nextPagePath||null;return e?i.listAllFiles(e,r).then(function(e){return t(e)}).catch(function(e){return n(e)}):t(r)}).catch(function(e){return n(e)})})},o.donePicking=function(){var t=this,e=this.plugin.getPluginState().currentSelection.map(function(e){return e.isFolder?t.addFolder(e):t.addFile(e)});this._sharedHandler.loaderWrapper(Promise.all(e),function(){t.clearSelection()},function(){})},o.cancelPicking=function(){this.clearSelection();var e=this.plugin.uppy.getPlugin("Dashboard");e&&e.hideAllPanels()},o.clearSelection=function(){this.plugin.setPluginState({currentSelection:[]})},o.render=function(e,t){void 0===t&&(t={});var n=this.plugin.getPluginState(),r=n.authenticated;if(n.didFirstRender||this.preFirstRender(),this.plugin.getPluginState().loading)return Tt(Et,{onUnmount:this.clearSelection},Tt(kt,{i18n:this.plugin.uppy.i18n}));if(!r)return Tt(Et,{onUnmount:this.clearSelection},Tt(Ge,{pluginName:this.plugin.title,pluginIcon:this.plugin.icon,handleAuth:this.handleAuth,i18n:this.plugin.uppy.i18n,i18nArray:this.plugin.uppy.i18nArray}));var i,n=Ut({},this.opts,t),r={showBreadcrumbs:n.showBreadcrumbs,getFolder:this.getFolder,directories:this.plugin.getPluginState().directories,pluginIcon:this.plugin.icon,title:this.plugin.title,logout:this.logout,username:this.username,i18n:this.plugin.uppy.i18n},n=Ut({},this.plugin.getPluginState(),{username:this.username,getNextFolder:this.getNextFolder,getFolder:this.getFolder,filterItems:this._sharedHandler.filterItems,filterQuery:this.filterQuery,sortByTitle:this.sortByTitle,sortByDate:this.sortByDate,logout:this.logout,isChecked:this._sharedHandler.isChecked,toggleCheckbox:this._sharedHandler.toggleCheckbox,handleScroll:this.handleScroll,listAllFiles:this.listAllFiles,done:this.donePicking,cancel:this.cancelPicking,headerComponent:(t=[],(r=r).showBreadcrumbs&&t.push((i={getFolder:r.getFolder,directories:r.directories,breadcrumbsIcon:r.pluginIcon&&r.pluginIcon(),title:r.title},$e("div",{class:"uppy-Provider-breadcrumbs"},$e("div",{class:"uppy-Provider-breadcrumbsIcon"},i.breadcrumbsIcon),i.directories.map(function(e,t){return $e(He,{key:e.id,getFolder:function(){return i.getFolder(e.id)},title:(0===t?i:e).title,isLast:t+1===i.directories.length})})))),t.push((r={logout:r.logout,username:r.username,i18n:r.i18n},[Ke("span",{class:"uppy-ProviderBrowser-user",key:"username"},r.username),Ke("button",{type:"button",onclick:r.logout,class:"uppy-u-reset uppy-ProviderBrowser-userLogout",key:"logout"},r.i18n("logOut"))])),t),title:this.plugin.title,viewType:n.viewType,showTitles:n.showTitles,showFilter:n.showFilter,showBreadcrumbs:n.showBreadcrumbs,pluginIcon:this.plugin.icon,i18n:this.plugin.uppy.i18n,uppyFiles:this.plugin.uppy.getFiles(),validateRestrictions:this.plugin.uppy.validateRestrictions});return Tt(Et,{onUnmount:this.clearSelection},Tt(St,n))},Bt.VERSION="1.9.1",Bt),xt=ie.h,Dt=ie.h;function Bt(e,t){this.plugin=e,this.provider=t.provider,this._sharedHandler=new At(e),this.opts=Ut({},{viewType:"list",showTitles:!0,showFilter:!0,showBreadcrumbs:!0},t),this.addFile=this.addFile.bind(this),this.filterQuery=this.filterQuery.bind(this),this.getFolder=this.getFolder.bind(this),this.getNextFolder=this.getNextFolder.bind(this),this.logout=this.logout.bind(this),this.preFirstRender=this.preFirstRender.bind(this),this.handleAuth=this.handleAuth.bind(this),this.sortByTitle=this.sortByTitle.bind(this),this.sortByDate=this.sortByDate.bind(this),this.handleError=this.handleError.bind(this),this.handleScroll=this.handleScroll.bind(this),this.listAllFiles=this.listAllFiles.bind(this),this.donePicking=this.donePicking.bind(this),this.cancelPicking=this.cancelPicking.bind(this),this.clearSelection=this.clearSelection.bind(this),this.render=this.render.bind(this),this.clearSelection(),this.plugin.setPluginState({authenticated:!1,files:[],folders:[],directories:[],filterInput:"",isSearchVisible:!1})}function It(){return(It=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,r=arguments[t];for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}var jt=ie.h,Mt={ProviderViews:b,SearchProviderViews:((_=Lt.prototype).tearDown=function(){},_._updateFilesAndInputMode=function(e,t){this.nextPageQuery=e.nextPageQuery,this._searchTerm=e.searchedFor,e.items.forEach(function(e){t.push(e)}),this.plugin.setPluginState({isInputMode:!1,files:t})},_.preFirstRender=function(){this.plugin.setPluginState({didFirstRender:!0}),this.plugin.onFirstRender()},_.search=function(e){var t=this;if(!e||e!==this._searchTerm)return this._sharedHandler.loaderWrapper(this.provider.search(e),function(e){t._updateFilesAndInputMode(e,[])},this.handleError);this.plugin.setPluginState({isInputMode:!1})},_.triggerSearchInput=function(){this.plugin.setPluginState({isInputMode:!0})},_.addFile=function(e){var t={id:this.providerFileToId(e),source:this.plugin.id,data:e,name:e.name||e.id,type:e.mimeType,isRemote:!0,body:{fileId:e.id},remote:{companionUrl:this.plugin.opts.companionUrl,url:""+this.provider.fileUrl(e.requestPath),body:{fileId:e.id},providerOptions:It({},this.provider.opts,{provider:null})}},n=$(t);n&&Pt(n)&&(t.preview=e.thumbnail),this.plugin.uppy.log("Adding remote file");try{this.plugin.uppy.addFile(t)}catch(e){e.isRestriction||this.plugin.uppy.log(e)}},_.providerFileToId=function(e){return Z({data:e,name:e.name||e.id,type:e.mimeType})},_.handleError=function(e){var t=this.plugin.uppy;t.log(e.toString());var n=t.i18n("companionError");t.info({message:n,details:e.toString()},"error",5e3)},_.handleScroll=function(e){var n=this,t=e.target.scrollHeight-(e.target.scrollTop+e.target.offsetHeight),e=this.nextPageQuery||null;t<50&&e&&!this._isHandlingScroll&&(this.provider.search(this._searchTerm,e).then(function(e){var t=n.plugin.getPluginState().files;n._updateFilesAndInputMode(e,t)}).catch(this.handleError).then(function(){n._isHandlingScroll=!1}),this._isHandlingScroll=!0)},_.donePicking=function(){var t=this,e=this.plugin.getPluginState().currentSelection.map(function(e){return t.addFile(e)});this._sharedHandler.loaderWrapper(Promise.all(e),function(){t.clearSelection()},function(){})},_.cancelPicking=function(){this.clearSelection();var e=this.plugin.uppy.getPlugin("Dashboard");e&&e.hideAllPanels()},_.clearSelection=function(){this.plugin.setPluginState({currentSelection:[]})},_.render=function(e,t){void 0===t&&(t={});var n=this.plugin.getPluginState(),r=n.didFirstRender,n=n.isInputMode;if(r||this.preFirstRender(),this.plugin.getPluginState().loading)return jt(Et,{onUnmount:this.clearSelection},jt(kt,{i18n:this.plugin.uppy.i18n}));if(n)return jt(Et,{onUnmount:this.clearSelection},jt(Rt,{search:this.search,i18n:this.plugin.uppy.i18n}));n=It({},this.opts,t),n=It({},this.plugin.getPluginState(),{isChecked:this._sharedHandler.isChecked,toggleCheckbox:this._sharedHandler.toggleCheckbox,handleScroll:this.handleScroll,done:this.donePicking,cancel:this.cancelPicking,headerComponent:(t={triggerSearchInput:this.triggerSearchInput,i18n:this.plugin.uppy.i18n},Dt("button",{type:"button",onclick:t.triggerSearchInput,class:"uppy-u-reset uppy-ProviderBrowser-userLogout"},t.i18n("backToSearch"))),title:this.plugin.title,viewType:n.viewType,showTitles:n.showTitles,showFilter:n.showFilter,showBreadcrumbs:n.showBreadcrumbs,pluginIcon:this.plugin.icon,i18n:this.plugin.uppy.i18n,uppyFiles:this.plugin.uppy.getFiles(),validateRestrictions:this.plugin.uppy.validateRestrictions});return jt(Et,{onUnmount:this.clearSelection},jt(St,n))},Lt.VERSION="1.9.1",Lt)};function Lt(e,t){this.plugin=e,this.provider=t.provider,this._sharedHandler=new At(e),this.opts=It({},{viewType:"grid",showTitles:!1,showFilter:!1,showBreadcrumbs:!1},t),this.search=this.search.bind(this),this.triggerSearchInput=this.triggerSearchInput.bind(this),this.addFile=this.addFile.bind(this),this.preFirstRender=this.preFirstRender.bind(this),this.handleError=this.handleError.bind(this),this.handleScroll=this.handleScroll.bind(this),this.donePicking=this.donePicking.bind(this),this.cancelPicking=this.cancelPicking.bind(this),this.clearSelection=this.clearSelection.bind(this),this.render=this.render.bind(this),this.clearSelection(),this.plugin.setPluginState({isInputMode:!0,files:[],folders:[],directories:[],filterInput:"",isSearchVisible:!1})}function Nt(){return(Nt=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,r=arguments[t];for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}var zt=((A=qt.prototype).setState=function(e){this._store.dispatch({type:"uppy/STATE_UPDATE",id:this._id,payload:e})},A.getState=function(){return this._selector(this._store.getState())},A.subscribe=function(o){var s=this,a=this.getState();return this._store.subscribe(function(){var t,n,e,r,i=s.getState();a!==i&&(t=a,n=i,e=Object.keys(n),r={},e.forEach(function(e){t[e]!==n[e]&&(r[e]=n[e])}),o(a,i,r),a=i)})},qt);function qt(e){var t;this._store=e.store,this._id=e.id||D(),this._selector=e.selector||(t=this._id,function(e){return e.uppy[t]}),this.setState({})}zt.VERSION="1.2.4",(E=function(e){return new zt(e)}).STATE_UPDATE="uppy/STATE_UPDATE",E.reducer=function(e,t){if(void 0===e&&(e={}),"uppy/STATE_UPDATE"!==t.type)return e;var n=Nt({},e[t.id],t.payload);return Nt({},e,((e={})[t.id]=n,e))},E.middleware=function(){return function(){return function(t){return function(e){t(e)}}}};function Ht(e){var t={color:"#838999",icon:Xt("svg",{"aria-hidden":"true",focusable:"false",class:"uppy-c-icon",width:"25",height:"25",viewBox:"0 0 25 25"},Xt("g",{fill:"#A7AFB7","fill-rule":"nonzero"},Xt("path",{d:"M5.5 22a.5.5 0 0 1-.5-.5v-18a.5.5 0 0 1 .5-.5h10.719a.5.5 0 0 1 .367.16l3.281 3.556a.5.5 0 0 1 .133.339V21.5a.5.5 0 0 1-.5.5h-14zm.5-1h13V7.25L16 4H6v17z"}),Xt("path",{d:"M15 4v3a1 1 0 0 0 1 1h3V7h-3V4h-1z"})))};if(!e)return t;var n=e.split("/")[0],e=e.split("/")[1];return"text"===n?{color:"#5a5e69",icon:Xt("svg",{"aria-hidden":"true",focusable:"false",class:"uppy-c-icon",width:"25",height:"25",viewBox:"0 0 25 25"},Xt("path",{d:"M4.5 7h13a.5.5 0 1 1 0 1h-13a.5.5 0 0 1 0-1zm0 3h15a.5.5 0 1 1 0 1h-15a.5.5 0 1 1 0-1zm0 3h15a.5.5 0 1 1 0 1h-15a.5.5 0 1 1 0-1zm0 3h10a.5.5 0 1 1 0 1h-10a.5.5 0 1 1 0-1z",fill:"#5A5E69","fill-rule":"nonzero"}))}:"image"===n?{color:"#686de0",icon:Xt("svg",{"aria-hidden":"true",focusable:"false",width:"25",height:"25",viewBox:"0 0 25 25"},Xt("g",{fill:"#686DE0","fill-rule":"evenodd"},Xt("path",{d:"M5 7v10h15V7H5zm0-1h15a1 1 0 0 1 1 1v10a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1z","fill-rule":"nonzero"}),Xt("path",{d:"M6.35 17.172l4.994-5.026a.5.5 0 0 1 .707 0l2.16 2.16 3.505-3.505a.5.5 0 0 1 .707 0l2.336 2.31-.707.72-1.983-1.97-3.505 3.505a.5.5 0 0 1-.707 0l-2.16-2.159-3.938 3.939-1.409.026z","fill-rule":"nonzero"}),Xt("circle",{cx:"7.5",cy:"9.5",r:"1.5"})))}:"audio"===n?{color:"#068dbb",icon:Xt("svg",{"aria-hidden":"true",focusable:"false",class:"uppy-c-icon",width:"25",height:"25",viewBox:"0 0 25 25"},Xt("path",{d:"M9.5 18.64c0 1.14-1.145 2-2.5 2s-2.5-.86-2.5-2c0-1.14 1.145-2 2.5-2 .557 0 1.079.145 1.5.396V7.25a.5.5 0 0 1 .379-.485l9-2.25A.5.5 0 0 1 18.5 5v11.64c0 1.14-1.145 2-2.5 2s-2.5-.86-2.5-2c0-1.14 1.145-2 2.5-2 .557 0 1.079.145 1.5.396V8.67l-8 2v7.97zm8-11v-2l-8 2v2l8-2zM7 19.64c.855 0 1.5-.484 1.5-1s-.645-1-1.5-1-1.5.484-1.5 1 .645 1 1.5 1zm9-2c.855 0 1.5-.484 1.5-1s-.645-1-1.5-1-1.5.484-1.5 1 .645 1 1.5 1z",fill:"#049BCF","fill-rule":"nonzero"}))}:"video"===n?{color:"#19af67",icon:Xt("svg",{"aria-hidden":"true",focusable:"false",class:"uppy-c-icon",width:"25",height:"25",viewBox:"0 0 25 25"},Xt("path",{d:"M16 11.834l4.486-2.691A1 1 0 0 1 22 10v6a1 1 0 0 1-1.514.857L16 14.167V17a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1V9a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v2.834zM15 9H5v8h10V9zm1 4l5 3v-6l-5 3z",fill:"#19AF67","fill-rule":"nonzero"}))}:"application"===n&&"pdf"===e?{color:"#e25149",icon:Xt("svg",{"aria-hidden":"true",focusable:"false",class:"uppy-c-icon",width:"25",height:"25",viewBox:"0 0 25 25"},Xt("path",{d:"M9.766 8.295c-.691-1.843-.539-3.401.747-3.726 1.643-.414 2.505.938 2.39 3.299-.039.79-.194 1.662-.537 3.148.324.49.66.967 1.055 1.51.17.231.382.488.629.757 1.866-.128 3.653.114 4.918.655 1.487.635 2.192 1.685 1.614 2.84-.566 1.133-1.839 1.084-3.416.249-1.141-.604-2.457-1.634-3.51-2.707a13.467 13.467 0 0 0-2.238.426c-1.392 4.051-4.534 6.453-5.707 4.572-.986-1.58 1.38-4.206 4.914-5.375.097-.322.185-.656.264-1.001.08-.353.306-1.31.407-1.737-.678-1.059-1.2-2.031-1.53-2.91zm2.098 4.87c-.033.144-.068.287-.104.427l.033-.01-.012.038a14.065 14.065 0 0 1 1.02-.197l-.032-.033.052-.004a7.902 7.902 0 0 1-.208-.271c-.197-.27-.38-.526-.555-.775l-.006.028-.002-.003c-.076.323-.148.632-.186.8zm5.77 2.978c1.143.605 1.832.632 2.054.187.26-.519-.087-1.034-1.113-1.473-.911-.39-2.175-.608-3.55-.608.845.766 1.787 1.459 2.609 1.894zM6.559 18.789c.14.223.693.16 1.425-.413.827-.648 1.61-1.747 2.208-3.206-2.563 1.064-4.102 2.867-3.633 3.62zm5.345-10.97c.088-1.793-.351-2.48-1.146-2.28-.473.119-.564 1.05-.056 2.405.213.566.52 1.188.908 1.859.18-.858.268-1.453.294-1.984z",fill:"#E2514A","fill-rule":"nonzero"}))}:"application"===n&&-1!==["zip","x-7z-compressed","x-rar-compressed","x-gtar","x-apple-diskimage","x-diskcopy"].indexOf(e)?{color:"#00C469",icon:Xt("svg",{"aria-hidden":"true",focusable:"false",width:"25",height:"25",viewBox:"0 0 25 25"},Xt("path",{d:"M10.45 2.05h1.05a.5.5 0 0 1 .5.5v.024a.5.5 0 0 1-.5.5h-1.05a.5.5 0 0 1-.5-.5V2.55a.5.5 0 0 1 .5-.5zm2.05 1.024h1.05a.5.5 0 0 1 .5.5V3.6a.5.5 0 0 1-.5.5H12.5a.5.5 0 0 1-.5-.5v-.025a.5.5 0 0 1 .5-.5v-.001zM10.45 0h1.05a.5.5 0 0 1 .5.5v.025a.5.5 0 0 1-.5.5h-1.05a.5.5 0 0 1-.5-.5V.5a.5.5 0 0 1 .5-.5zm2.05 1.025h1.05a.5.5 0 0 1 .5.5v.024a.5.5 0 0 1-.5.5H12.5a.5.5 0 0 1-.5-.5v-.024a.5.5 0 0 1 .5-.5zm-2.05 3.074h1.05a.5.5 0 0 1 .5.5v.025a.5.5 0 0 1-.5.5h-1.05a.5.5 0 0 1-.5-.5v-.025a.5.5 0 0 1 .5-.5zm2.05 1.025h1.05a.5.5 0 0 1 .5.5v.024a.5.5 0 0 1-.5.5H12.5a.5.5 0 0 1-.5-.5v-.024a.5.5 0 0 1 .5-.5zm-2.05 1.024h1.05a.5.5 0 0 1 .5.5v.025a.5.5 0 0 1-.5.5h-1.05a.5.5 0 0 1-.5-.5v-.025a.5.5 0 0 1 .5-.5zm2.05 1.025h1.05a.5.5 0 0 1 .5.5v.025a.5.5 0 0 1-.5.5H12.5a.5.5 0 0 1-.5-.5v-.025a.5.5 0 0 1 .5-.5zm-2.05 1.025h1.05a.5.5 0 0 1 .5.5v.025a.5.5 0 0 1-.5.5h-1.05a.5.5 0 0 1-.5-.5v-.025a.5.5 0 0 1 .5-.5zm2.05 1.025h1.05a.5.5 0 0 1 .5.5v.024a.5.5 0 0 1-.5.5H12.5a.5.5 0 0 1-.5-.5v-.024a.5.5 0 0 1 .5-.5zm-1.656 3.074l-.82 5.946c.52.302 1.174.458 1.976.458.803 0 1.455-.156 1.975-.458l-.82-5.946h-2.311zm0-1.025h2.312c.512 0 .946.378 1.015.885l.82 5.946c.056.412-.142.817-.501 1.026-.686.398-1.515.597-2.49.597-.974 0-1.804-.199-2.49-.597a1.025 1.025 0 0 1-.5-1.026l.819-5.946c.07-.507.503-.885 1.015-.885zm.545 6.6a.5.5 0 0 1-.397-.561l.143-.999a.5.5 0 0 1 .495-.429h.74a.5.5 0 0 1 .495.43l.143.998a.5.5 0 0 1-.397.561c-.404.08-.819.08-1.222 0z",fill:"#00C469","fill-rule":"nonzero"}))}:t}function Vt(e){var t=e.file;return t.preview?Gt("img",{class:"uppy-Dashboard-Item-previewImg",alt:t.name,src:t.preview}):(e=Ht(t.type),t=e.color,e=e.icon,Gt("div",{class:"uppy-Dashboard-Item-previewIconWrap"},Gt("span",{class:"uppy-Dashboard-Item-previewIcon",style:{color:t}},e),Gt("svg",{"aria-hidden":"true",focusable:"false",class:"uppy-Dashboard-Item-previewIconBg",width:"58",height:"76",viewBox:"0 0 58 76"},Gt("rect",{fill:"#FFF",width:"58",height:"76",rx:"3","fill-rule":"evenodd"}))))}function Wt(e){return Kt("div",{class:"uppy-Dashboard-Item-previewInnerWrap",style:{backgroundColor:Ht(e.file.type).color}},e.showLinkToFileUploadResult&&e.file.uploadURL&&Kt("a",{class:"uppy-Dashboard-Item-previewLink",href:e.file.uploadURL,rel:"noreferrer noopener",target:"_blank","aria-label":e.file.meta.name}),Kt(Vt,{file:e.file}))}var Xt=ie.h,Gt=ie.h,Kt=ie.h,$t=ie.h;function Yt(e){return e.isUploaded?e.i18n("uploadComplete"):e.error?e.i18n("retryUpload"):e.resumableUploads?e.file.isPaused?e.i18n("resumeUpload"):e.i18n("pauseUpload"):e.individualCancellation?e.i18n("cancelUpload"):""}function Jt(t){return $t("div",{class:"uppy-Dashboard-Item-progress"},$t("button",{class:"uppy-u-reset uppy-Dashboard-Item-progressIndicator",type:"button","aria-label":Yt(t),title:Yt(t),onclick:function(){var e;(e=t).isUploaded||(!e.error||e.hideRetryButton?e.resumableUploads&&!e.hidePauseResumeButton?e.pauseUpload(e.file.id):e.individualCancellation&&!e.hideCancelButton&&e.cancelUpload(e.file.id):e.retryUpload(e.file.id))}},t.children))}function Qt(e){e=e.children;return $t("svg",{"aria-hidden":"true",focusable:"false",width:"70",height:"70",viewBox:"0 0 36 36",class:"uppy-c-icon uppy-Dashboard-Item-progressIcon--circle"},e)}function Zt(e){var t=e.progress,e=2*Math.PI*15;return $t("g",null,$t("circle",{class:"uppy-Dashboard-Item-progressIcon--bg",r:"15",cx:"18",cy:"18","stroke-width":"2",fill:"none"}),$t("circle",{class:"uppy-Dashboard-Item-progressIcon--progress",r:"15",cx:"18",cy:"18",transform:"rotate(-90, 18, 18)","stroke-width":"2",fill:"none","stroke-dasharray":e,"stroke-dashoffset":e-e/100*t}))}function en(e){return e.file.progress.uploadStarted?e.isUploaded?$t("div",{class:"uppy-Dashboard-Item-progress"},$t("div",{class:"uppy-Dashboard-Item-progressIndicator"},$t(Qt,null,$t("circle",{r:"15",cx:"18",cy:"18",fill:"#1bb240"}),$t("polygon",{class:"uppy-Dashboard-Item-progressIcon--check",transform:"translate(2, 3)",points:"14 22.5 7 15.2457065 8.99985857 13.1732815 14 18.3547104 22.9729883 9 25 11.1005634"})))):e.error&&!e.hideRetryButton?$t(Jt,e,$t("svg",{"aria-hidden":"true",focusable:"false",class:"uppy-c-icon uppy-Dashboard-Item-progressIcon--retry",width:"28",height:"31",viewBox:"0 0 16 19"},$t("path",{d:"M16 11a8 8 0 1 1-8-8v2a6 6 0 1 0 6 6h2z"}),$t("path",{d:"M7.9 3H10v2H7.9z"}),$t("path",{d:"M8.536.5l3.535 3.536-1.414 1.414L7.12 1.914z"}),$t("path",{d:"M10.657 2.621l1.414 1.415L8.536 7.57 7.12 6.157z"}))):e.resumableUploads&&!e.hidePauseResumeButton?$t(Jt,e,$t(Qt,null,$t(Zt,{progress:e.file.progress.percentage}),e.file.isPaused?$t("polygon",{class:"uppy-Dashboard-Item-progressIcon--play",transform:"translate(3, 3)",points:"12 20 12 10 20 15"}):$t("g",{class:"uppy-Dashboard-Item-progressIcon--pause",transform:"translate(14.5, 13)"},$t("rect",{x:"0",y:"0",width:"2",height:"10",rx:"0"}),$t("rect",{x:"5",y:"0",width:"2",height:"10",rx:"0"})))):e.resumableUploads||!e.individualCancellation||e.hideCancelButton?$t("div",{class:"uppy-Dashboard-Item-progress"},$t("div",{class:"uppy-Dashboard-Item-progressIndicator"},$t(Qt,null,$t(Zt,{progress:e.file.progress.percentage})))):$t(Jt,e,$t(Qt,null,$t(Zt,{progress:e.file.progress.percentage}),$t("polygon",{class:"cancel",transform:"translate(2, 2)",points:"19.8856516 11.0625 16 14.9481516 12.1019737 11.0625 11.0625 12.1143484 14.9481516 16 11.0625 19.8980263 12.1019737 20.9375 16 17.0518484 19.8856516 20.9375 20.9375 19.8980263 17.0518484 16 20.9375 12"}))):null}function tn(e){var t=e.file,e=e.onClick;return t.error?rn("span",{class:"uppy-Dashboard-Item-errorDetails","aria-label":t.error,"data-microtip-position":"bottom","data-microtip-size":"medium",role:"tooltip",onclick:e},"?"):null}function nn(e){return rn("div",{class:"uppy-Dashboard-Item-fileInfo","data-uppy-file-source":e.file.source},(n=e.containerWidth<=352?35:e.containerWidth<=576?60:30,rn("div",{class:"uppy-Dashboard-Item-name",title:e.file.meta.name},function(e,t){if(e.length<=t)return e;if(t<="...".length)return e.substr(0,t);var n=t-"...".length,t=Math.ceil(n/2),n=Math.floor(n/2);return e.substr(0,t)+"..."+e.substr(e.length-n)}(e.file.meta.name,n))),rn("div",{class:"uppy-Dashboard-Item-status"},e.file.data.size&&rn("div",{class:"uppy-Dashboard-Item-statusSize"},z(e.file.data.size)),(t=e).file.source&&t.file.source!==t.id&&rn("div",{class:"uppy-Dashboard-Item-sourceIcon"},t.acquirers.map(function(e){if(e.id===t.file.source)return e=e,rn("span",{title:t.i18n("fileSource",{name:e.name})},e.icon())})),rn(tn,{file:e.file,onClick:function(){alert(e.file.error)}})));var t,n}var rn=ie.h,on=ie.h;function sn(e){var t=e.file,n=e.uploadInProgressOrComplete,r=e.metaFields,i=e.canEditFile,o=e.i18n,s=e.onClick;return!n&&r&&0<r.length||!n&&i(t)?on("button",{class:"uppy-u-reset uppy-Dashboard-Item-action uppy-Dashboard-Item-action--edit",type:"button","aria-label":o("editFile")+" "+t.meta.name,title:o("editFile"),onclick:function(){return s()}},on("svg",{"aria-hidden":"true",focusable:"false",class:"uppy-c-icon",width:"14",height:"14",viewBox:"0 0 14 14"},on("g",{"fill-rule":"evenodd"},on("path",{d:"M1.5 10.793h2.793A1 1 0 0 0 5 10.5L11.5 4a1 1 0 0 0 0-1.414L9.707.793a1 1 0 0 0-1.414 0l-6.5 6.5A1 1 0 0 0 1.5 8v2.793zm1-1V8L9 1.5l1.793 1.793-6.5 6.5H2.5z","fill-rule":"nonzero"}),on("rect",{x:"1",y:"12.293",width:"11",height:"1",rx:".5"}),on("path",{"fill-rule":"nonzero",d:"M6.793 2.5L9.5 5.207l.707-.707L7.5 1.793z"})))):null}function an(e){var t=e.i18n,n=e.onClick;return on("button",{class:"uppy-u-reset uppy-Dashboard-Item-action uppy-Dashboard-Item-action--remove",type:"button","aria-label":t("removeFile"),title:t("removeFile"),onclick:function(){return n()}},on("svg",{"aria-hidden":"true",focusable:"false",class:"uppy-c-icon",width:"18",height:"18",viewBox:"0 0 18 18"},on("path",{d:"M9 0C4.034 0 0 4.034 0 9s4.034 9 9 9 9-4.034 9-9-4.034-9-9-9z"}),on("path",{fill:"#FFF",d:"M13 12.222l-.778.778L9 9.778 5.778 13 5 12.222 8.222 9 5 5.778 5.778 5 9 8.222 12.222 5l.778.778L9.778 9z"})))}var un=function(e,t){var r=t.file.uploadURL,i=t.i18n("copyLinkToClipboardFallback");i=i||"Copy the URL below",new Promise(function(e){var t=document.createElement("textarea");t.setAttribute("style",{position:"fixed",top:0,left:0,width:"2em",height:"2em",padding:0,border:"none",outline:"none",boxShadow:"none",background:"transparent"}),t.value=r,document.body.appendChild(t),t.select();function n(){document.body.removeChild(t),window.prompt(i,r),e()}try{return document.execCommand("copy")?(document.body.removeChild(t),e()):n()}catch(e){return document.body.removeChild(t),n()}}).then(function(){t.log("Link copied to clipboard."),t.info(t.i18n("copyLinkToClipboardSuccess"),"info",3e3)}).catch(t.log).then(function(){return e.target.focus({preventScroll:!0})})};function ln(t){return on("button",{class:"uppy-u-reset uppy-Dashboard-Item-action uppy-Dashboard-Item-action--copyLink",type:"button","aria-label":t.i18n("copyLink"),title:t.i18n("copyLink"),onclick:function(e){return un(e,t)}},on("svg",{"aria-hidden":"true",focusable:"false",class:"uppy-c-icon",width:"14",height:"14",viewBox:"0 0 14 12"},on("path",{d:"M7.94 7.703a2.613 2.613 0 0 1-.626 2.681l-.852.851a2.597 2.597 0 0 1-1.849.766A2.616 2.616 0 0 1 2.764 7.54l.852-.852a2.596 2.596 0 0 1 2.69-.625L5.267 7.099a1.44 1.44 0 0 0-.833.407l-.852.851a1.458 1.458 0 0 0 1.03 2.486c.39 0 .755-.152 1.03-.426l.852-.852c.231-.231.363-.522.406-.824l1.04-1.038zm4.295-5.937A2.596 2.596 0 0 0 10.387 1c-.698 0-1.355.272-1.849.766l-.852.851a2.614 2.614 0 0 0-.624 2.688l1.036-1.036c.041-.304.173-.6.407-.833l.852-.852c.275-.275.64-.426 1.03-.426a1.458 1.458 0 0 1 1.03 2.486l-.852.851a1.442 1.442 0 0 1-.824.406l-1.04 1.04a2.596 2.596 0 0 0 2.683-.628l.851-.85a2.616 2.616 0 0 0 0-3.697zm-6.88 6.883a.577.577 0 0 0 .82 0l3.474-3.474a.579.579 0 1 0-.819-.82L5.355 7.83a.579.579 0 0 0 0 .819z"})))}function cn(e){var t=e.file,n=e.uploadInProgressOrComplete,r=e.canEditFile,i=e.metaFields,o=e.showLinkToFileUploadResult,s=e.showRemoveButton,a=e.i18n,u=e.removeFile,l=e.toggleFileCard,c=e.openFileEditor,p=e.log,d=e.info;return on("div",{className:"uppy-Dashboard-Item-actionWrapper"},on(sn,{i18n:a,file:t,uploadInProgressOrComplete:n,canEditFile:r,metaFields:i,onClick:function(){i&&0<i.length?l(t.id):c(t)}}),o&&t.uploadURL?on(ln,{file:t,i18n:a,info:d,log:p}):null,s?on(an,{i18n:a,info:e.info,log:e.log,onClick:function(){return u(t.id,"removed-by-user")}}):null)}var pn=ie.h,dn=function(e){var t;function n(){return e.apply(this,arguments)||this}r=e,(t=n).prototype=Object.create(r.prototype),(t.prototype.constructor=t).__proto__=r;var r=n.prototype;return r.shouldComponentUpdate=function(e){return!function(e,t){if(e===t)return 1;for(var n in e)if(!(n in t))return;for(var n in t)if(e[n]!==t[n])return;return 1}(this.props,e)},r.componentDidMount=function(){var e=this.props.file;e.preview||this.props.handleRequestThumbnail(e)},r.componentWillUnmount=function(){var e=this.props.file;e.preview||this.props.handleCancelThumbnail(e)},r.render=function(){var e=this.props.file,t=e.progress.preprocess||e.progress.postprocess,n=e.progress.uploadComplete&&!t&&!e.error,r=e.progress.uploadStarted||t,i=e.progress.uploadStarted&&!e.progress.uploadComplete||t,o=e.error||!1,s=(this.props.individualCancellation||!i)&&!n;n&&this.props.showRemoveButtonAfterComplete&&(s=!0);t=Ye({"uppy-Dashboard-Item":!0,"is-inprogress":i,"is-processing":t,"is-complete":n,"is-error":!!o,"is-resumable":this.props.resumableUploads,"is-noIndividualCancellation":!this.props.individualCancellation});return pn("div",{class:t,id:"uppy_"+e.id,role:this.props.role},pn("div",{class:"uppy-Dashboard-Item-preview"},pn(Wt,{file:e,showLinkToFileUploadResult:this.props.showLinkToFileUploadResult}),pn(en,{file:e,error:o,isUploaded:n,hideRetryButton:this.props.hideRetryButton,hideCancelButton:this.props.hideCancelButton,hidePauseResumeButton:this.props.hidePauseResumeButton,showRemoveButtonAfterComplete:this.props.showRemoveButtonAfterComplete,resumableUploads:this.props.resumableUploads,individualCancellation:this.props.individualCancellation,pauseUpload:this.props.pauseUpload,cancelUpload:this.props.cancelUpload,retryUpload:this.props.retryUpload,i18n:this.props.i18n})),pn("div",{class:"uppy-Dashboard-Item-fileInfoAndButtons"},pn(nn,{file:e,id:this.props.id,acquirers:this.props.acquirers,containerWidth:this.props.containerWidth,i18n:this.props.i18n}),pn(cn,{file:e,metaFields:this.props.metaFields,showLinkToFileUploadResult:this.props.showLinkToFileUploadResult,showRemoveButton:s,canEditFile:this.props.canEditFile,uploadInProgressOrComplete:r,removeFile:this.props.removeFile,toggleFileCard:this.props.toggleFileCard,openFileEditor:this.props.openFileEditor,i18n:this.props.i18n,log:this.props.log,info:this.props.info})))},n}(ie.Component);function hn(){return(hn=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,r=arguments[t];for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}var fn=ie.h,yn=ie.Component,gn={position:"relative",width:"100%",minHeight:"100%"},mn={position:"absolute",top:0,left:0,width:"100%",overflow:"visible"},vn=function(n){var e;function t(e){var t;return(t=n.call(this,e)||this).handleResize=function(){t.resize()},t.handleScroll=function(){t.setState({offset:t.base.scrollTop}),t.props.sync&&t.forceUpdate()},t.focusElement=null,t.state={offset:0,height:0},t}r=n,(e=t).prototype=Object.create(r.prototype),(e.prototype.constructor=e).__proto__=r;var r=t.prototype;return r.resize=function(){this.state.height!==this.base.offsetHeight&&this.setState({height:this.base.offsetHeight})},r.componentWillUpdate=function(){this.base.contains(document.activeElement)&&(this.focusElement=document.activeElement)},r.componentDidUpdate=function(){this.focusElement&&this.focusElement.parentNode&&document.activeElement!==this.focusElement&&this.focusElement.focus(),this.focusElement=null,this.resize()},r.componentDidMount=function(){this.resize(),window.addEventListener("resize",this.handleResize)},r.componentWillUnmount=function(){window.removeEventListener("resize",this.handleResize)},r.render=function(e){var t=e.data,n=e.rowHeight,r=e.renderRow,i=e.overscanCount,o=void 0===i?10:i,s=(e.sync,function(e,t){if(null==e)return{};for(var n,r={},i=Object.keys(e),o=0;o<i.length;o++)n=i[o],0<=t.indexOf(n)||(r[n]=e[n]);return r}(e,["data","rowHeight","renderRow","overscanCount","sync"])),i=this.state,e=i.offset,i=i.height,e=Math.floor(e/n),i=Math.floor(i/n);o&&(e=Math.max(0,e-e%o),i+=o);i=t.slice(e,e+i+4),t=hn({},gn,{height:t.length*n}),n=hn({},mn,{top:e*n});return fn("div",hn({onScroll:this.handleScroll},s),fn("div",{role:"presentation",style:t},fn("div",{role:"presentation",style:n},i.map(r))))},t}(yn);function bn(){return(bn=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,r=arguments[t];for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function wn(t){var n,r,i,e=0===t.totalFileCount,o=Ye("uppy-Dashboard-files",{"uppy-Dashboard-files--noFiles":e}),s=1===t.itemsPerRow?71:200,a={id:t.id,error:t.error,i18n:t.i18n,log:t.log,info:t.info,acquirers:t.acquirers,resumableUploads:t.resumableUploads,individualCancellation:t.individualCancellation,hideRetryButton:t.hideRetryButton,hidePauseResumeButton:t.hidePauseResumeButton,hideCancelButton:t.hideCancelButton,showLinkToFileUploadResult:t.showLinkToFileUploadResult,showRemoveButtonAfterComplete:t.showRemoveButtonAfterComplete,isWide:t.isWide,metaFields:t.metaFields,retryUpload:t.retryUpload,pauseUpload:t.pauseUpload,cancelUpload:t.cancelUpload,toggleFileCard:t.toggleFileCard,removeFile:t.removeFile,handleRequestThumbnail:t.handleRequestThumbnail,handleCancelThumbnail:t.handleCancelThumbnail},e=(e=Object.keys(t.files),n=t.itemsPerRow,r=[],i=[],e.forEach(function(e,t){i.length<n?i.push(e):(r.push(i),i=[e])}),i.length&&r.push(i),r);return Cn(vn,{class:o,role:"list",data:e,renderRow:function(e){return Cn("div",{role:"presentation",key:e[0]},e.map(function(e){return Cn(dn,bn({key:e},a,{role:"listitem",openFileEditor:t.openFileEditor,canEditFile:t.canEditFile,file:t.files[e]}))}))},rowHeight:s})}function _n(t){return En("div",{class:Ye("uppy-Dashboard-AddFilesPanel",t.className),"data-uppy-panelType":"AddFiles","aria-hidden":t.showAddFilesPanel},En("div",{class:"uppy-DashboardContent-bar"},En("div",{class:"uppy-DashboardContent-title",role:"heading","aria-level":"1"},t.i18n("addingMoreFiles")),En("button",{class:"uppy-DashboardContent-back",type:"button",onclick:function(e){return t.toggleAddFilesPanel(!1)}},t.i18n("back"))),En(An,t))}function Sn(e){var t=e.target.tagName;"INPUT"!==t&&"TEXTAREA"!==t&&e.preventDefault(),e.stopPropagation()}function kn(e){return On("div",{class:Ye("uppy-DashboardContent-panel",e.className),role:"tabpanel","data-uppy-panelType":"PickerPanel",id:"uppy-DashboardContent-panel--"+e.activePickerPanel.id,onDragOver:Sn,onDragLeave:Sn,onDrop:Sn,onPaste:Sn},On("div",{class:"uppy-DashboardContent-bar"},On("div",{class:"uppy-DashboardContent-title",role:"heading","aria-level":"1"},e.i18n("importFrom",{name:e.activePickerPanel.name})),On("button",{class:"uppy-DashboardContent-back",type:"button",onclick:e.hideAllPanels},e.i18n("done"))),On("div",{class:"uppy-DashboardContent-panelBody"},e.getPlugin(e.activePickerPanel.id).render(e.state)))}function Pn(t){var e=this.props.files[this.props.fileCardFor];return Un("div",{class:Ye("uppy-DashboardContent-panel",t.className),role:"tabpanel","data-uppy-panelType":"FileEditor",id:"uppy-DashboardContent-panel--editor"},Un("div",{class:"uppy-DashboardContent-bar"},Un("div",{class:"uppy-DashboardContent-title",role:"heading","aria-level":"1"},t.i18nArray("editing",{file:Un("span",{class:"uppy-DashboardContent-titleFile"},(e.meta||e).name)})),Un("button",{class:"uppy-DashboardContent-back",type:"button",onclick:t.hideAllPanels},t.i18n("done"))),Un("div",{class:"uppy-DashboardContent-panelBody"},t.editors.map(function(e){return t.getPlugin(e.id).render(t.state)})))}var Cn=ie.h,Fn=ie.h,An=function(r){var e;function t(){for(var s,e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return(s=r.call.apply(r,[this].concat(t))||this).triggerFileInputClick=function(){s.fileInput.click()},s.triggerFolderInputClick=function(){s.folderInput.click()},s.onFileInputChange=function(e){s.props.handleInputChange(e),e.target.value=null},s.renderHiddenInput=function(e,t){return Fn("input",{class:"uppy-Dashboard-input",hidden:!0,"aria-hidden":"true",tabindex:-1,webkitdirectory:e,type:"file",name:"files[]",multiple:1!==s.props.maxNumberOfFiles,onchange:s.onFileInputChange,accept:s.props.allowedFileTypes,ref:t})},s.renderMyDeviceAcquirer=function(){return Fn("div",{class:"uppy-DashboardTab",role:"presentation","data-uppy-acquirer-id":"MyDevice"},Fn("button",{type:"button",class:"uppy-DashboardTab-btn",role:"tab",tabindex:0,"data-uppy-super-focusable":!0,onclick:s.triggerFileInputClick},Fn("svg",{"aria-hidden":"true",focusable:"false",width:"32",height:"32",viewBox:"0 0 32 32"},Fn("g",{fill:"none","fill-rule":"evenodd"},Fn("rect",{width:"32",height:"32",rx:"16",fill:"#2275D7"}),Fn("path",{d:"M21.973 21.152H9.863l-1.108-5.087h14.464l-1.246 5.087zM9.935 11.37h3.958l.886 1.444a.673.673 0 0 0 .585.316h6.506v1.37H9.935v-3.13zm14.898 3.44a.793.793 0 0 0-.616-.31h-.978v-2.126c0-.379-.275-.613-.653-.613H15.75l-.886-1.445a.673.673 0 0 0-.585-.316H9.232c-.378 0-.667.209-.667.587V14.5h-.782a.793.793 0 0 0-.61.303.795.795 0 0 0-.155.663l1.45 6.633c.078.36.396.618.764.618h13.354c.36 0 .674-.246.76-.595l1.631-6.636a.795.795 0 0 0-.144-.675z",fill:"#FFF"}))),Fn("div",{class:"uppy-DashboardTab-name"},s.props.i18n("myDevice"))))},s.renderBrowseButton=function(e,t){var n=s.props.acquirers.length;return Fn("button",{type:"button",class:"uppy-u-reset uppy-Dashboard-browse",onclick:t,"data-uppy-super-focusable":0===n},e)},s.renderDropPasteBrowseTagline=function(){var e=s.props.acquirers.length,t=s.props.fileManagerSelectionType,n=t.charAt(0).toUpperCase()+t.slice(1),r="browse",i="browse",o="browse";if("files"===t)try{r=s.props.i18n("browse"),i=s.props.i18n("browse"),o=s.props.i18n("browse")}catch(e){}try{i=s.props.i18n("browseFiles"),o=s.props.i18n("browseFolders")}catch(e){}var r=s.renderBrowseButton(r,s.triggerFileInputClick),i=s.renderBrowseButton(i,s.triggerFileInputClick),o=s.renderBrowseButton(o,s.triggerFolderInputClick),o=0<e?s.props.i18nArray("dropPasteImport"+n,{browseFiles:i,browseFolders:o,browse:r}):s.props.i18nArray("dropPaste"+n,{browseFiles:i,browseFolders:o,browse:r});if("files"===t)try{o=0<e?s.props.i18nArray("dropPasteImport",{browse:r}):s.props.i18nArray("dropPaste",{browse:r})}catch(e){}return Fn("div",{class:"uppy-Dashboard-AddFiles-title"},o)},s.renderAcquirer=function(e){return Fn("div",{class:"uppy-DashboardTab",role:"presentation","data-uppy-acquirer-id":e.id},Fn("button",{type:"button",class:"uppy-DashboardTab-btn",role:"tab",tabindex:0,"aria-controls":"uppy-DashboardContent-panel--"+e.id,"aria-selected":s.props.activePickerPanel.id===e.id,"data-uppy-super-focusable":!0,onclick:function(){return s.props.showPanel(e.id)}},e.icon(),Fn("div",{class:"uppy-DashboardTab-name"},e.name)))},s.renderAcquirers=function(e){var t=[].concat(e),e=t.splice(e.length-2,e.length);return Fn("div",{class:"uppy-Dashboard-AddFiles-list",role:"tablist"},s.renderMyDeviceAcquirer(),t.map(function(e){return s.renderAcquirer(e)}),Fn("span",{role:"presentation",style:"white-space: nowrap;"},e.map(function(e){return s.renderAcquirer(e)})))},s}n=r,(e=t).prototype=Object.create(n.prototype),(e.prototype.constructor=e).__proto__=n;var n=t.prototype;return n.renderPoweredByUppy=function(){var e=Fn("span",null,Fn("svg",{"aria-hidden":"true",focusable:"false",class:"uppy-c-icon uppy-Dashboard-poweredByIcon",width:"11",height:"11",viewBox:"0 0 11 11"},Fn("path",{d:"M7.365 10.5l-.01-4.045h2.612L5.5.806l-4.467 5.65h2.604l.01 4.044h3.718z","fill-rule":"evenodd"})),Fn("span",{class:"uppy-Dashboard-poweredByUppy"},"Uppy")),e=this.props.i18nArray("poweredBy2",{backwardsCompat:this.props.i18n("poweredBy"),uppy:e});return Fn("a",{tabindex:"-1",href:"https://uppy.io",rel:"noreferrer noopener",target:"_blank",class:"uppy-Dashboard-poweredBy"},e)},n.render=function(){var t=this;return Fn("div",{class:"uppy-Dashboard-AddFiles"},this.renderHiddenInput(!1,function(e){t.fileInput=e}),this.renderHiddenInput(!0,function(e){t.folderInput=e}),this.renderDropPasteBrowseTagline(),0<this.props.acquirers.length&&this.renderAcquirers(this.props.acquirers),Fn("div",{class:"uppy-Dashboard-AddFiles-info"},this.props.note&&Fn("div",{class:"uppy-Dashboard-note"},this.props.note),this.props.proudlyDisplayPoweredByUppy&&this.renderPoweredByUppy(this.props)))},t}(ie.Component),En=ie.h,On=ie.h,Un=ie.h,Rn=ie.h,Tn="error",xn="waiting",Dn="preprocessing",Bn="uploading",In="postprocessing",jn="complete",Mn="paused";function Ln(e){switch(function(e,t,n,r){if(void 0===r&&(r={}),e)return Tn;if(t)return jn;if(n)return Mn;for(var i=xn,o=Object.keys(r),s=0;s<o.length;s++){var a=r[o[s]].progress;if(a.uploadStarted&&!a.uploadComplete)return Bn;a.preprocess&&i!==Bn&&(i=Dn),a.postprocess&&i!==Bn&&i!==Dn&&(i=In)}return i}(e.isAllErrored,e.isAllComplete,e.isAllPaused,e.files)){case"uploading":return e.i18n("uploadingXFiles",{smart_count:e.inProgressNotPausedFiles.length});case"preprocessing":case"postprocessing":return e.i18n("processingXFiles",{smart_count:e.processingFiles.length});case"paused":return e.i18n("uploadPaused");case"waiting":return e.i18n("xFilesSelected",{smart_count:e.newFiles.length});case"complete":return e.i18n("uploadComplete")}}function Nn(e){var t=e.allowNewUpload;return t&&e.maxNumberOfFiles&&(t=e.totalFileCount<e.maxNumberOfFiles),Rn("div",{class:"uppy-DashboardContent-bar"},e.isAllComplete||e.hideCancelButton?Rn("div",null):Rn("button",{class:"uppy-DashboardContent-back",type:"button",onclick:e.cancelAll},e.i18n("cancel")),Rn("div",{class:"uppy-DashboardContent-title",role:"heading","aria-level":"1"},Rn(Ln,e)),t?Rn("button",{class:"uppy-DashboardContent-addMore",type:"button","aria-label":e.i18n("addMoreFiles"),title:e.i18n("addMoreFiles"),onclick:function(){return e.toggleAddFilesPanel(!0)}},Rn("svg",{"aria-hidden":"true",focusable:"false",class:"uppy-c-icon",width:"15",height:"15",viewBox:"0 0 15 15"},Rn("path",{d:"M8 6.5h6a.5.5 0 0 1 .5.5v.5a.5.5 0 0 1-.5.5H8v6a.5.5 0 0 1-.5.5H7a.5.5 0 0 1-.5-.5V8h-6a.5.5 0 0 1-.5-.5V7a.5.5 0 0 1 .5-.5h6v-6A.5.5 0 0 1 7 0h.5a.5.5 0 0 1 .5.5v6z"})),Rn("span",{class:"uppy-DashboardContent-addMoreCaption"},e.i18n("addMore"))):Rn("div",null))}function zn(){return(zn=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,r=arguments[t];for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function qn(){var e=document.createElement("div");return"draggable"in e&&"ondragstart"in e&&"ondrop"in e&&"FormData"in window&&"FileReader"in window}var Hn,Vn=ie.h,Wn=(Hn=ie.Component,Ni=Hn,(ne=$n).prototype=Object.create(Ni.prototype),(ne.prototype.constructor=ne).__proto__=Ni,$n.prototype.render=function(){var e=this,t=this.props.files[this.props.fileCardFor],n=this.props.canEditFile(t);return Vn("div",{class:Ye("uppy-Dashboard-FileCard",this.props.className),"data-uppy-panelType":"FileCard",onDragOver:Sn,onDragLeave:Sn,onDrop:Sn,onPaste:Sn},Vn("div",{class:"uppy-DashboardContent-bar"},Vn("div",{class:"uppy-DashboardContent-title",role:"heading","aria-level":"1"},this.props.i18nArray("editing",{file:Vn("span",{class:"uppy-DashboardContent-titleFile"},(t.meta||t).name)})),Vn("button",{class:"uppy-DashboardContent-back",type:"button",title:this.props.i18n("finishEditingFile"),onclick:this.handleSave},this.props.i18n("done"))),Vn("div",{class:"uppy-Dashboard-FileCard-inner"},Vn("div",{class:"uppy-Dashboard-FileCard-preview",style:{backgroundColor:Ht(t.type).color}},Vn(Vt,{file:t}),n&&Vn("button",{type:"button",class:"uppy-u-reset uppy-c-btn uppy-Dashboard-FileCard-edit",onClick:function(){return e.props.openFileEditor(t)}},this.props.i18n("editFile"))),Vn("div",{class:"uppy-Dashboard-FileCard-info"},this.renderMetaFields()),Vn("div",{class:"uppy-Dashboard-FileCard-actions"},Vn("button",{class:"uppy-u-reset uppy-c-btn uppy-c-btn-primary uppy-Dashboard-FileCard-actionsBtn",type:"button",onclick:this.handleSave},this.props.i18n("saveChanges")),Vn("button",{class:"uppy-u-reset uppy-c-btn uppy-c-btn-link uppy-Dashboard-FileCard-actionsBtn",type:"button",onclick:this.handleCancel},this.props.i18n("cancel")))))},$n),Xn=ie.cloneElement,re=ie.Component,Gn="uppy-transition-slideDownUp",Kn=function(t){var e;function n(e){return(e=t.call(this,e)||this).state={cachedChildren:null,className:""},e}r=t,(e=n).prototype=Object.create(r.prototype),(e.prototype.constructor=e).__proto__=r;var r=n.prototype;return r.componentWillUpdate=function(e){var t=this,n=this.state.cachedChildren,r=e.children[0];n!==r&&(e={cachedChildren:r},r&&!n&&(e.className=Gn+"-enter",cancelAnimationFrame(this.animationFrame),clearTimeout(this.leaveTimeout),this.leaveTimeout=void 0,this.animationFrame=requestAnimationFrame(function(){t.base.getBoundingClientRect(),t.setState({className:Gn+"-enter "+Gn+"-enter-active"}),t.enterTimeout=setTimeout(function(){t.setState({className:""})},250)})),n&&!r&&void 0===this.leaveTimeout&&(e.cachedChildren=n,e.className=Gn+"-leave",cancelAnimationFrame(this.animationFrame),clearTimeout(this.enterTimeout),this.enterTimeout=void 0,this.animationFrame=requestAnimationFrame(function(){t.setState({className:Gn+"-leave "+Gn+"-leave-active"}),t.leaveTimeout=setTimeout(function(){t.setState({cachedChildren:null,className:""})},250)})),this.setState(e))},r.render=function(){var e=this.state,t=e.cachedChildren,e=e.className;return t?Xn(t,{className:Ye(e,t.attributes.className)}):null},n}(re);function $n(e){var r;(r=Hn.call(this,e)||this).saveOnEnter=function(e){13===e.keyCode&&(e.stopPropagation(),e.preventDefault(),e=r.props.files[r.props.fileCardFor],r.props.saveFileCard(r.state.formState,e.id))},r.updateMeta=function(e,t){var n;r.setState({formState:zn({},r.state.formState,((n={})[t]=e,n))})},r.handleSave=function(){var e=r.props.fileCardFor;r.props.saveFileCard(r.state.formState,e)},r.handleCancel=function(){r.props.toggleFileCard()},r.renderMetaFields=function(){var e=r.props.metaFields||[],n={text:"uppy-u-reset uppy-c-textInput uppy-Dashboard-FileCard-input"};return e.map(function(t){var e="uppy-Dashboard-FileCard-input-"+t.id;return Vn("fieldset",{key:t.id,class:"uppy-Dashboard-FileCard-fieldset"},Vn("label",{class:"uppy-Dashboard-FileCard-label",for:e},t.name),void 0!==t.render?t.render({value:r.state.formState[t.id],onChange:function(e){return r.updateMeta(e,t.id)},fieldCSSClasses:n},Vn):Vn("input",{class:n.text,id:e,type:t.type||"text",value:r.state.formState[t.id],placeholder:t.placeholder,onkeyup:r.saveOnEnter,onkeydown:r.saveOnEnter,onkeypress:r.saveOnEnter,oninput:function(e){return r.updateMeta(e.target.value,t.id)},"data-uppy-super-focusable":!0}))})};var t=r.props.files[r.props.fileCardFor],e=r.props.metaFields||[],n={};return e.forEach(function(e){n[e.id]=t.meta[e.id]||""}),r.state={formState:n},r}function Yn(){return(Yn=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,r=arguments[t];for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}var Jn=ie.h,Qn="waiting",Zn="preprocessing",er="uploading",tr="postprocessing",nr="complete";function rr(){return(rr=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,r=arguments[t];for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function ir(e){var t=Ye("uppy-u-reset","uppy-c-btn","uppy-StatusBar-actionBtn","uppy-StatusBar-actionBtn--upload",{"uppy-c-btn-primary":e.uploadState===Qn});return dr("button",{type:"button",class:t,"aria-label":e.i18n("uploadXFiles",{smart_count:e.newFiles}),onclick:e.startUpload,"data-uppy-super-focusable":!0},e.newFiles&&e.isUploadStarted?e.i18n("uploadXNewFiles",{smart_count:e.newFiles}):e.i18n("uploadXFiles",{smart_count:e.newFiles}))}function or(e){return dr("button",{type:"button",class:"uppy-u-reset uppy-c-btn uppy-StatusBar-actionBtn uppy-StatusBar-actionBtn--retry","aria-label":e.i18n("retryUpload"),onclick:e.retryAll,"data-uppy-super-focusable":!0},dr("svg",{"aria-hidden":"true",focusable:"false",class:"uppy-c-icon",width:"8",height:"10",viewBox:"0 0 8 10"},dr("path",{d:"M4 2.408a2.75 2.75 0 1 0 2.75 2.75.626.626 0 0 1 1.25.018v.023a4 4 0 1 1-4-4.041V.25a.25.25 0 0 1 .389-.208l2.299 1.533a.25.25 0 0 1 0 .416l-2.3 1.533A.25.25 0 0 1 4 3.316v-.908z"})),e.i18n("retry"))}function sr(e){return dr("button",{type:"button",class:"uppy-u-reset uppy-StatusBar-actionCircleBtn",title:e.i18n("cancel"),"aria-label":e.i18n("cancel"),onclick:e.cancelAll,"data-uppy-super-focusable":!0},dr("svg",{"aria-hidden":"true",focusable:"false",class:"uppy-c-icon",width:"16",height:"16",viewBox:"0 0 16 16"},dr("g",{fill:"none","fill-rule":"evenodd"},dr("circle",{fill:"#888",cx:"8",cy:"8",r:"8"}),dr("path",{fill:"#FFF",d:"M9.283 8l2.567 2.567-1.283 1.283L8 9.283 5.433 11.85 4.15 10.567 6.717 8 4.15 5.433 5.433 4.15 8 6.717l2.567-2.567 1.283 1.283z"}))))}function ar(e){var t=e.isAllPaused,n=(0,e.i18n)(t?"resume":"pause");return dr("button",{title:n,"aria-label":n,class:"uppy-u-reset uppy-StatusBar-actionCircleBtn",type:"button",onclick:function(){return function(e){if(!e.isAllComplete)return e.resumableUploads?e.isAllPaused?e.resumeAll():e.pauseAll():e.cancelAll()}(e)},"data-uppy-super-focusable":!0},dr("svg",{"aria-hidden":"true",focusable:"false",class:"uppy-c-icon",width:"16",height:"16",viewBox:"0 0 16 16"},dr("g",{fill:"none","fill-rule":"evenodd"},dr("circle",{fill:"#888",cx:"8",cy:"8",r:"8"}),dr("path",t?{fill:"#FFF",d:"M6 4.25L11.5 8 6 11.75z"}:{d:"M5 4.5h2v7H5v-7zm4 0h2v7H9v-7z",fill:"#FFF"}))))}function ur(e){var t=e.i18n;return dr("button",{type:"button",class:"uppy-u-reset uppy-c-btn uppy-StatusBar-actionBtn uppy-StatusBar-actionBtn--done",onClick:e.doneButtonHandler,"data-uppy-super-focusable":!0},t("done"))}function lr(){return dr("svg",{class:"uppy-StatusBar-spinner","aria-hidden":"true",focusable:"false",width:"14",height:"14"},dr("path",{d:"M13.983 6.547c-.12-2.509-1.64-4.893-3.939-5.936-2.48-1.127-5.488-.656-7.556 1.094C.524 3.367-.398 6.048.162 8.562c.556 2.495 2.46 4.52 4.94 5.183 2.932.784 5.61-.602 7.256-3.015-1.493 1.993-3.745 3.309-6.298 2.868-2.514-.434-4.578-2.349-5.153-4.84a6.226 6.226 0 0 1 2.98-6.778C6.34.586 9.74 1.1 11.373 3.493c.407.596.693 1.282.842 1.988.127.598.073 1.197.161 1.794.078.525.543 1.257 1.15.864.525-.341.49-1.05.456-1.592-.007-.15.02.3 0 0","fill-rule":"evenodd"}))}function cr(e){return dr("div",{class:"uppy-StatusBar-statusSecondary"},e.i18n("filesUploadedOfTotal",{complete:e.complete,smart_count:e.numUploads}))}function pr(e){var t=Ye("uppy-u-reset","uppy-c-btn","uppy-StatusBar-actionBtn","uppy-StatusBar-actionBtn--uploadNewlyAdded");return dr("div",{class:"uppy-StatusBar-statusSecondary"},dr("div",{class:"uppy-StatusBar-statusSecondaryHint"},e.i18n("xMoreFilesAdded",{smart_count:e.newFiles})),dr("button",{type:"button",class:t,"aria-label":e.i18n("uploadXFiles",{smart_count:e.newFiles}),onclick:e.startUpload},e.i18n("upload")))}var dr=ie.h,hr=N(function(e){var t,n,r,i=1<e.numUploads;return dr("div",{class:"uppy-StatusBar-statusSecondary"},i&&e.i18n("filesUploadedOfTotal",{complete:e.complete,smart_count:e.numUploads}),dr("span",{class:"uppy-StatusBar-additionalInfo"},i&&"  ",e.i18n("dataUploadedOfTotal",{complete:z(e.totalUploadedSize),total:z(e.totalSize)}),"  ",e.i18n("xTimeLeft",{time:(t=e.totalETA,r=t,n={hours:Math.floor(r/3600)%24,minutes:Math.floor(r/60)%60,seconds:Math.floor(r%60)},i=n.hours?n.hours+"h ":"",e=n.hours?("0"+n.minutes).substr(-2):n.minutes,t=e?e+"m":"",r=e?("0"+n.seconds).substr(-2):n.seconds,i+t+(n.hours?"":e?" "+r+"s":r+"s"))})))},500,{leading:!0,trailing:!0});function fr(){return(fr=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,r=arguments[t];for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function yr(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var gr=(pa=ha=function(r){var e;function t(e,t){var n;return(n=r.call(this,e,t)||this).startUpload=function(){return n.uppy.upload().catch(function(){})},n.id=n.opts.id||"StatusBar",n.title="StatusBar",n.type="progressindicator",n.defaultLocale={strings:{uploading:"Uploading",upload:"Upload",complete:"Complete",uploadFailed:"Upload failed",paused:"Paused",retry:"Retry",retryUpload:"Retry upload",cancel:"Cancel",pause:"Pause",resume:"Resume",done:"Done",filesUploadedOfTotal:{0:"%{complete} of %{smart_count} file uploaded",1:"%{complete} of %{smart_count} files uploaded"},dataUploadedOfTotal:"%{complete} of %{total}",xTimeLeft:"%{time} left",uploadXFiles:{0:"Upload %{smart_count} file",1:"Upload %{smart_count} files"},uploadXNewFiles:{0:"Upload +%{smart_count} file",1:"Upload +%{smart_count} files"},xMoreFilesAdded:{0:"%{smart_count} more file added",1:"%{smart_count} more files added"}}},n.opts=fr({},{target:"body",hideUploadButton:!1,hideRetryButton:!1,hidePauseResumeButton:!1,hideCancelButton:!1,showProgressDetails:!1,hideAfterFinish:!0,doneButtonHandler:null},t),n.i18nInit(),n.render=n.render.bind(yr(n)),n.install=n.install.bind(yr(n)),n}n=r,(e=t).prototype=Object.create(n.prototype),(e.prototype.constructor=e).__proto__=n;var n=t.prototype;return n.setOptions=function(e){r.prototype.setOptions.call(this,e),this.i18nInit()},n.i18nInit=function(){this.translator=new C([this.defaultLocale,this.uppy.locale,this.opts.locale]),this.i18n=this.translator.translate.bind(this.translator),this.setPluginState()},n.getTotalSpeed=function(e){var t=0;return e.forEach(function(e){t+=function(e){if(!e.bytesUploaded)return 0;var t=new Date-e.uploadStarted;return e.bytesUploaded/(t/1e3)}(e.progress)}),t},n.getTotalETA=function(e){var t=this.getTotalSpeed(e);if(0===t)return 0;e=e.reduce(function(e,t){return e+((t=t.progress).bytesTotal-t.bytesUploaded)},0);return Math.round(e/t*10)/10},n.getUploadingState=function(e,t,n){if(e)return"error";if(t)return nr;for(var r=Qn,i=Object.keys(n),o=0;o<i.length;o++){var s=n[i[o]].progress;if(s.uploadStarted&&!s.uploadComplete)return er;s.preprocess&&r!==er&&(r=Zn),s.postprocess&&r!==er&&r!==Zn&&(r=tr)}return r},n.render=function(e){var t=e.capabilities,n=e.files,r=e.allowNewUpload,i=e.totalProgress,o=e.error,s=Object.keys(n).map(function(e){return n[e]}),a=s.filter(function(e){return!e.progress.uploadStarted&&!e.progress.preprocess&&!e.progress.postprocess}),u=s.filter(function(e){return e.progress.uploadStarted}).filter(function(e){return e.isPaused}),l=s.filter(function(e){return e.progress.uploadComplete}),c=s.filter(function(e){return e.error}),p=s.filter(function(e){return!e.progress.uploadComplete&&e.progress.uploadStarted}),d=p.filter(function(e){return!e.isPaused}),h=s.filter(function(e){return e.progress.uploadStarted||e.progress.preprocess||e.progress.postprocess}),f=s.filter(function(e){return e.progress.preprocess||e.progress.postprocess}),y=this.getTotalETA(d),g=0,m=0;h.forEach(function(e){g+=e.progress.bytesTotal||0,m+=e.progress.bytesUploaded||0});d=0<h.length,f=100===i&&l.length===Object.keys(n).length&&0===f.length,c=o&&c.length===s.length,s=0!==p.length&&u.length===p.length,u=0<p.length,p=t.resumableUploads||!1,t=!1!==t.uploadProgress;return function(e){var t,n,r,i=e.newFiles,o=e.allowNewUpload,s=e.isUploadInProgress,a=e.isAllPaused,u=e.resumableUploads,l=e.error,c=e.hideUploadButton,p=e.hidePauseResumeButton,d=e.hideCancelButton,h=e.hideRetryButton,f=e.uploadState,y=e.totalProgress;f===Zn||f===tr?("determinate"===(v=(t=function(t){var n=[];Object.keys(t).forEach(function(e){e=t[e].progress;e.preprocess&&n.push(e.preprocess),e.postprocess&&n.push(e.postprocess)});var e=n[0];return{mode:e.mode,message:e.message,value:n.filter(function(e){return"determinate"===e.mode}).reduce(function(e,t,n,r){return e+t.value/r.length},0)}}(e.files)).mode)&&(y=100*t.value),m=t,g=Math.round(100*m.value),t=dr("div",{class:"uppy-StatusBar-content"},dr(lr,null),"determinate"===m.mode?g+"%  ":"",m.message)):f===nr?t=function(e){e.totalProgress;e=e.i18n;return dr("div",{class:"uppy-StatusBar-content",role:"status",title:e("complete")},dr("div",{class:"uppy-StatusBar-status"},dr("div",{class:"uppy-StatusBar-statusPrimary"},dr("svg",{"aria-hidden":"true",focusable:"false",class:"uppy-StatusBar-statusIndicator uppy-c-icon",width:"15",height:"11",viewBox:"0 0 15 11"},dr("path",{d:"M.414 5.843L1.627 4.63l3.472 3.472L13.202 0l1.212 1.213L5.1 10.528z"})),e("complete"))))}(e):f===er?(e.supportsUploadProgress||(v="indeterminate",y=null),t=function(e){if(!e.isUploadStarted||e.isAllComplete)return null;var t=e.isAllPaused?e.i18n("paused"):e.i18n("uploading"),n=e.newFiles&&e.isUploadStarted;return dr("div",{class:"uppy-StatusBar-content","aria-label":t,title:t},e.isAllPaused?null:dr(lr,null),dr("div",{class:"uppy-StatusBar-status"},dr("div",{class:"uppy-StatusBar-statusPrimary"},e.supportsUploadProgress?t+": "+e.totalProgress+"%":t),e.isAllPaused||n||!e.showProgressDetails?null:e.supportsUploadProgress?dr(hr,e):dr(cr,e),n?dr(pr,e):null))}(e)):"error"===f&&(y=void 0,n=e.error,t=dr("div",{class:"uppy-StatusBar-content",role:"alert",title:(r=e.i18n)("uploadFailed")},dr("div",{class:"uppy-StatusBar-status"},dr("div",{class:"uppy-StatusBar-statusPrimary"},dr("svg",{"aria-hidden":"true",focusable:"false",class:"uppy-StatusBar-statusIndicator uppy-c-icon",width:"11",height:"11",viewBox:"0 0 11 11"},dr("path",{d:"M4.278 5.5L0 1.222 1.222 0 5.5 4.278 9.778 0 11 1.222 6.722 5.5 11 9.778 9.778 11 5.5 6.722 1.222 11 0 9.778z"})),r("uploadFailed"))),dr("span",{class:"uppy-StatusBar-details","aria-label":n,"data-microtip-position":"top-right","data-microtip-size":"medium",role:"tooltip",onclick:function(){var e=r("uploadFailed")+" \n\n "+n;alert(e)}},"?")));var g="number"==typeof y?y:100,m=f===Qn&&e.hideUploadButton||f===Qn&&0<!e.newFiles||f===nr&&e.hideAfterFinish,c=!l&&i&&!s&&!a&&o&&!c,d=!d&&f!==Qn&&f!==nr,u=u&&!p&&f===er,p=l&&!h,l=e.doneButtonHandler&&f===nr,h="uppy-StatusBar-progress\n                           "+(v?"is-"+v:""),v=Ye({"uppy-Root":e.isTargetDOMEl},"uppy-StatusBar","is-"+f);return dr("div",{class:v,"aria-hidden":m},dr("div",{class:h,style:{width:g+"%"},role:"progressbar","aria-valuemin":"0","aria-valuemax":"100","aria-valuenow":y}),t,dr("div",{class:"uppy-StatusBar-actions"},c?dr(ir,rr({},e,{uploadState:f})):null,p?dr(or,e):null,u?dr(ar,e):null,d?dr(sr,e):null,l?dr(ur,e):null))}({error:o,uploadState:this.getUploadingState(c,f,e.files||{}),allowNewUpload:r,totalProgress:i,totalSize:g,totalUploadedSize:m,isAllComplete:f,isAllPaused:s,isAllErrored:c,isUploadStarted:d,isUploadInProgress:u,complete:l.length,newFiles:a.length,numUploads:h.length,totalETA:y,files:n,i18n:this.i18n,pauseAll:this.uppy.pauseAll,resumeAll:this.uppy.resumeAll,retryAll:this.uppy.retryAll,cancelAll:this.uppy.cancelAll,startUpload:this.startUpload,doneButtonHandler:this.opts.doneButtonHandler,resumableUploads:p,supportsUploadProgress:t,showProgressDetails:this.opts.showProgressDetails,hideUploadButton:this.opts.hideUploadButton,hideRetryButton:this.opts.hideRetryButton,hidePauseResumeButton:this.opts.hidePauseResumeButton,hideCancelButton:this.opts.hideCancelButton,hideAfterFinish:this.opts.hideAfterFinish,isTargetDOMEl:this.isTargetDOMEl})},n.install=function(){var e=this.opts.target;e&&this.mount(e,this)},n.uninstall=function(){this.unmount()},t}(ue.Plugin),ha.VERSION="1.8.0",pa);function mr(){return(mr=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,r=arguments[t];for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function vr(e,t,n){var r=e.split(",")[1];null==(e=t.mimeType||e.split(",")[0].split(":")[1].split(";")[0])&&(e="plain/text");for(var i,o=atob(r),s=[],a=0;a<o.length;a++)s.push(o.charCodeAt(a));try{i=new Uint8Array(s)}catch(e){return null}return n?new File([i],t.name||"",{type:e}):new Blob([i],{type:e})}function br(e){return 0===e.indexOf("blob:")}for(var wr,_r=ie.h,Sr=(Ls=wr=ue.Plugin,(le=Rr).prototype=Object.create(Ls.prototype),(le.prototype.constructor=le).__proto__=Ls,Rr.prototype.install=function(){var e=this.opts.target;e&&this.mount(e,this)},Rr.VERSION="1.5.13",Rr),kr=Math.log2||function(e){return Math.log(e)*Math.LOG2E},Pr={toByteArray:function(e){for(var t,n=function(e){var t=e.length;if(0<t%4)throw new Error("Invalid string. Length must be a multiple of 4");e=e.indexOf("=");return[e=-1===e?t:e,e===t?0:4-e%4]}(e),r=n[0],n=n[1],i=new Ar(3*(r+n)/4-n),o=0,s=0<n?r-4:r,a=0;a<s;a+=4)t=Fr[e.charCodeAt(a)]<<18|Fr[e.charCodeAt(a+1)]<<12|Fr[e.charCodeAt(a+2)]<<6|Fr[e.charCodeAt(a+3)],i[o++]=t>>16&255,i[o++]=t>>8&255,i[o++]=255&t;return 2===n&&(t=Fr[e.charCodeAt(a)]<<2|Fr[e.charCodeAt(a+1)]>>4,i[o++]=255&t),1===n&&(t=Fr[e.charCodeAt(a)]<<10|Fr[e.charCodeAt(a+1)]<<4|Fr[e.charCodeAt(a+2)]>>2,i[o++]=t>>8&255,i[o++]=255&t),i},fromByteArray:function(e){for(var t,n=e.length,r=n%3,i=[],o=0,s=n-r;o<s;o+=16383)i.push(function(e,t,n){for(var r,i=[],o=t;o<n;o+=3)r=(e[o]<<16&16711680)+(e[o+1]<<8&65280)+(255&e[o+2]),i.push(Cr[(r=r)>>18&63]+Cr[r>>12&63]+Cr[r>>6&63]+Cr[63&r]);return i.join("")}(e,o,s<o+16383?s:o+16383));return 1==r?(t=e[n-1],i.push(Cr[t>>2]+Cr[t<<4&63]+"==")):2==r&&(t=(e[n-2]<<8)+e[n-1],i.push(Cr[t>>10]+Cr[t>>4&63]+Cr[t<<2&63]+"=")),i.join("")}},Cr=[],Fr=[],Ar="undefined"!=typeof Uint8Array?Uint8Array:Array,Er="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Or=0,Ur=Er.length;Or<Ur;++Or)Cr[Or]=Er[Or],Fr[Er.charCodeAt(Or)]=Or;function Rr(e,t){var i;return(i=wr.call(this,e,t)||this).render=function(e){var t=e.info,e=t.isHidden,n=t.message,r=t.details;return _r("div",{class:"uppy uppy-Informer","aria-hidden":e},_r("p",{role:"alert"},n," ",r&&_r("span",{"aria-label":r,"data-microtip-position":"top-left","data-microtip-size":"medium",role:"tooltip",onclick:function(){alert(n+" \n\n "+r)},onMouseOver:function(){clearTimeout(i.uppy.infoTimeoutID)},onMouseLeave:function(){i.uppy.infoTimeoutID=setTimeout(i.uppy.hideInfo,2e3)}},"?")))},i.type="progressindicator",i.id=i.opts.id||"Informer",i.title="Informer",i.opts=mr({},{},t),i}Fr["-".charCodeAt(0)]=62,Fr["_".charCodeAt(0)]=63;var Tr={read:function(e,t,n,r,i){var o,s,a=8*i-r-1,u=(1<<a)-1,l=u>>1,c=-7,p=n?i-1:0,d=n?-1:1,n=e[t+p];for(p+=d,o=n&(1<<-c)-1,n>>=-c,c+=a;0<c;o=256*o+e[t+p],p+=d,c-=8);for(s=o&(1<<-c)-1,o>>=-c,c+=r;0<c;s=256*s+e[t+p],p+=d,c-=8);if(0===o)o=1-l;else{if(o===u)return s?NaN:1/0*(n?-1:1);s+=Math.pow(2,r),o-=l}return(n?-1:1)*s*Math.pow(2,o-r)},write:function(e,t,n,r,i,o){var s,a,u=8*o-i-1,l=(1<<u)-1,c=l>>1,p=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,d=r?0:o-1,h=r?1:-1,o=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,s=l):(s=Math.floor(Math.log(t)/Math.LN2),t*(r=Math.pow(2,-s))<1&&(s--,r*=2),2<=(t+=1<=s+c?p/r:p*Math.pow(2,1-c))*r&&(s++,r/=2),l<=s+c?(a=0,s=l):1<=s+c?(a=(t*r-1)*Math.pow(2,i),s+=c):(a=t*Math.pow(2,c-1)*Math.pow(2,i),s=0));8<=i;e[n+d]=255&a,d+=h,a/=256,i-=8);for(s=s<<i|a,u+=i;0<u;e[n+d]=255&s,d+=h,s/=256,u-=8);e[n+d-h]|=128*o}},xr={exports:{}};function Dr(){return(Dr=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,r=arguments[t];for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}(function(wt,_t,St){!function(){var e=this,t=function(t){"use strict";function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function e(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function n(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}});var r=["prototype","__proto__","caller","arguments","length","name"];Object.getOwnPropertyNames(n).forEach(function(e){-1===r.indexOf(e)&&t[e]!==n[e]&&(t[e]=n[e])}),n&&i(t,n)}function o(e){return(o=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function i(e,t){return(i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function u(e,t,n){return(u=function(){if("undefined"!=typeof Reflect&&Reflect.construct&&!Reflect.construct.sham){if("function"==typeof Proxy)return 1;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),1}catch(e){return}}}()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);r=new(Function.bind.apply(e,r));return n&&i(r,n.prototype),r}).apply(null,arguments)}function l(e){var n="function"==typeof Map?new Map:void 0;return(l=function(e){if(null===e||-1===Function.toString.call(e).indexOf("[native code]"))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==n){if(n.has(e))return n.get(e);n.set(e,t)}function t(){return u(e,arguments,o(this).constructor)}return t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),i(t,e)})(e)}function c(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function p(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?c(e):t}function d(e,t,n){return(d="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){e=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=o(e)););return e}(e,t);if(e){t=Object.getOwnPropertyDescriptor(e,t);return t.get?t.get.call(n):t.value}})(e,t,n||e)}var h=Object.values||function(e){var t,n=[];for(t in e)n.push(e[t]);return n},f=Object.entries||function(e){var t,n=[];for(t in e)n.push([t,e[t]]);return n},y=Object.assign||function(n){for(var e=arguments.length,t=new Array(1<e?e-1:0),r=1;r<e;r++)t[r-1]=arguments[r];return t.forEach(function(e){for(var t in e)n[t]=e[t]}),n},g=Object.fromEntries||function(e){var n={};return m(e).forEach(function(e){var t=e[0],e=e[1];n[t]=e}),n},m=Array.from||function(e){if(e instanceof P){var n=[];return e.forEach(function(e,t){return n.push([t,e])}),n}return Array.prototype.slice.call(e)};function v(e){return-1!==this.indexOf(e)}Array.prototype.includes||(Array.prototype.includes=v),String.prototype.includes||(String.prototype.includes=v),String.prototype.startsWith||(String.prototype.startsWith=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;return this.substring(t,t+e.length)===e}),String.prototype.endsWith||(String.prototype.endsWith=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:this.length;return this.substring(t-e.length,t)===e});function b(e){return void 0!==e}var w="undefined"!=typeof self?self:_t,_=w.fetch||function(i){var o=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return new Promise(function(e,t){var n=new XMLHttpRequest;if(n.open("get",i,!0),n.responseType="arraybuffer",n.onerror=t,o.headers)for(var r in o.headers)n.setRequestHeader(r,o.headers[r]);n.onload=function(){e({ok:200<=n.status&&n.status<300,status:n.status,arrayBuffer:function(){return Promise.resolve(n.response)}})},n.send(null)})},S=function(e){var t=[];if(Object.defineProperties(t,{size:{get:function(){return this.length}},has:{value:function(e){return-1!==this.indexOf(e)}},add:{value:function(e){this.has(e)||this.push(e)}},delete:{value:function(e){this.has(e)&&(e=this.indexOf(e),this.splice(e,1))}}}),Array.isArray(e))for(var n=0;n<e.length;n++)t.add(e[n]);return t},k=function(e){return new P(e)},P=void 0!==w.Map&&void 0!==w.Map.prototype.keys?w.Map:(e(R,[{key:"clear",value:function(){this._map={},this._keys=[]}},{key:"get",value:function(e){return this._map["map_"+e]}},{key:"set",value:function(e,t){return this._map["map_"+e]=t,this._keys.indexOf(e)<0&&this._keys.push(e),this}},{key:"has",value:function(e){return 0<=this._keys.indexOf(e)}},{key:"delete",value:function(e){var t=this._keys.indexOf(e);return!(t<0||(delete this._map["map_"+e],this._keys.splice(t,1),0))}},{key:"keys",value:function(){return this._keys.slice(0)}},{key:"values",value:function(){var t=this;return this._keys.map(function(e){return t.get(e)})}},{key:"entries",value:function(){var t=this;return this._keys.map(function(e){return[e,t.get(e)]})}},{key:"forEach",value:function(e,t){for(var n=0;n<this._keys.length;n++)e.call(t,this._map["map_"+this._keys[n]],this._keys[n],this)}},{key:"size",get:function(){return this._keys.length}}]),R),C="undefined"!=typeof self?self:_t,F="undefined"!=typeof navigator,A=F&&"undefined"==typeof HTMLImageElement,E=!(void 0===_t||void 0===wt||!wt.versions||!wt.versions.node),O=C.Buffer,U=!!O;function R(e){if(s(this,R),this.clear(),e)for(var t=0;t<e.length;t++)this.set(e[t][0],e[t][1])}function T(e){return void 0===e||(e instanceof P?0===e.size:0===h(e).filter(b).length)}function x(e){e=new Error(e);throw delete e.stack,e}function D(e){var t,t=(t=0,e.ifd0.enabled&&(t+=1024),e.exif.enabled&&(t+=2048),e.makerNote&&(t+=2048),e.userComment&&(t+=1024),e.gps.enabled&&(t+=512),e.interop.enabled&&(t+=100),e.ifd1.enabled&&(t+=1024),t+2048);return e.jfif.enabled&&(t+=50),e.xmp.enabled&&(t+=2e4),e.iptc.enabled&&(t+=14e3),e.icc.enabled&&(t+=6e3),t}var B="undefined"!=typeof TextDecoder?new TextDecoder("utf-8"):void 0,I=(e(j,null,[{key:"from",value:function(e,t){return e instanceof this&&e.le===t?e:new j(e,void 0,void 0,t)}}]),e(j,[{key:"_swapArrayBuffer",value:function(e){this._swapDataView(new DataView(e))}},{key:"_swapBuffer",value:function(e){this._swapDataView(new DataView(e.buffer,e.byteOffset,e.byteLength))}},{key:"_swapDataView",value:function(e){this.dataView=e,this.buffer=e.buffer,this.byteOffset=e.byteOffset,this.byteLength=e.byteLength}},{key:"_lengthToEnd",value:function(e){return this.byteLength-e}},{key:"set",value:function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:j;return e instanceof DataView||e instanceof j?e=new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e instanceof ArrayBuffer&&(e=new Uint8Array(e)),e instanceof Uint8Array||x("BufferView.set(): Invalid data argument."),this.toUint8().set(e,t),new n(this,t,e.byteLength)}},{key:"subarray",value:function(e,t){return new j(this,e,t=t||this._lengthToEnd(e))}},{key:"toUint8",value:function(){return new Uint8Array(this.buffer,this.byteOffset,this.byteLength)}},{key:"getUint8Array",value:function(e,t){return new Uint8Array(this.buffer,this.byteOffset+e,t)}},{key:"getString",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:this.byteLength;return t=this.getUint8Array(e,t),B?B.decode(t):U?St.from(t).toString("utf8"):decodeURIComponent(escape(String.fromCharCode.apply(null,t)))}},{key:"getUnicodeString",value:function(){for(var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:this.byteLength,n=[],r=0;r<t&&e+r<this.byteLength;r+=2)n.push(this.getUint16(e+r));return n.map(function(e){return String.fromCharCode(e)}).join("")}},{key:"getInt8",value:function(e){return this.dataView.getInt8(e)}},{key:"getUint8",value:function(e){return this.dataView.getUint8(e)}},{key:"getInt16",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:this.le;return this.dataView.getInt16(e,t)}},{key:"getInt32",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:this.le;return this.dataView.getInt32(e,t)}},{key:"getUint16",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:this.le;return this.dataView.getUint16(e,t)}},{key:"getUint32",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:this.le;return this.dataView.getUint32(e,t)}},{key:"getFloat32",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:this.le;return this.dataView.getFloat32(e,t)}},{key:"getFloat64",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:this.le;return this.dataView.getFloat64(e,t)}},{key:"getFloat",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:this.le;return this.dataView.getFloat32(e,t)}},{key:"getDouble",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:this.le;return this.dataView.getFloat64(e,t)}},{key:"getUintBytes",value:function(e,t,n){switch(t){case 1:return this.getUint8(e,n);case 2:return this.getUint16(e,n);case 4:return this.getUint32(e,n);case 8:return this.getUint64&&this.getUint64(e,n)}}},{key:"getUint",value:function(e,t,n){switch(t){case 8:return this.getUint8(e,n);case 16:return this.getUint16(e,n);case 32:return this.getUint32(e,n);case 64:return this.getUint64&&this.getUint64(e,n)}}},{key:"toString",value:function(e){return this.dataView.toString(e,this.constructor.name)}},{key:"ensureChunk",value:function(){}}]),j);function j(e){var t,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,r=2<arguments.length?arguments[2]:void 0,i=3<arguments.length?arguments[3]:void 0;s(this,j),"boolean"==typeof i&&(this.le=i),0===(e=Array.isArray(e)?new Uint8Array(e):e)?(this.byteOffset=0,this.byteLength=0):e instanceof ArrayBuffer?(void 0===r&&(r=e.byteLength-n),i=new DataView(e,n,r),this._swapDataView(i)):e instanceof Uint8Array||e instanceof DataView||e instanceof j?(void 0===r&&(r=e.byteLength-n),(n+=e.byteOffset)+r>e.byteOffset+e.byteLength&&x("Creating view outside of available memory in ArrayBuffer"),t=new DataView(e.buffer,n,r),this._swapDataView(t)):"number"==typeof e?(t=new DataView(new ArrayBuffer(e)),this._swapDataView(t)):x("Invalid input argument for BufferView: "+e)}function M(e,t){x("".concat(e," '").concat(t,"' was not loaded, try using full build of exifr."))}var L=(n(H,l(P)),e(H,[{key:"get",value:function(e,t){return this.has(e)||M(this.kind,e),t&&(e in t||(n=this.kind,r=e,x("Unknown ".concat(n," '").concat(r,"'."))),t[e].enabled||M(this.kind,e)),d(o(H.prototype),"get",this).call(this,e);var n,r}},{key:"keyList",value:function(){return m(this.keys())}}]),H),N=new L("file parser"),z=new L("segment parser"),q=new L("file reader");function H(e){var t;return s(this,H),(t=p(this,o(H).call(this))).kind=e,t}function V(n){return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];try{return Promise.resolve(n.apply(this,e))}catch(e){return Promise.reject(e)}}}function W(e,t,n){return n?t?t(e):e:(e&&e.then||(e=Promise.resolve(e)),t?e.then(t):e)}var X=V(function(r){return new Promise(function(e,t){var n=new FileReader;n.onloadend=function(){return e(n.result||new ArrayBuffer)},n.onerror=t,n.readAsArrayBuffer(r)})}),G=V(function(e){return _(e).then(function(e){return e.arrayBuffer()})}),K=V(function(e,t){return W(t(e),function(e){return new I(e)})}),$=V(function(e,t,n){var r=new(q.get(n))(e,t);return W(r.read(),function(){return r})}),Y=V(function(e,t,n,r){return q.has(n)?$(e,t,n):r?K(e,r):(x("Parser ".concat(n," is not loaded")),W())});function J(e,t){return(n=e).startsWith("data:")||1e4<n.length?$(e,t,"base64"):F?Y(e,t,"url",G):E?$(e,t,"fs"):void x("Invalid input argument");var n}var Q=(n(Z,l(P)),e(Z,[{key:"tagKeys",get:function(){return this.allKeys||(this.allKeys=m(this.keys())),this.allKeys}},{key:"tagValues",get:function(){return this.allValues||(this.allValues=m(this.values())),this.allValues}}]),Z);function Z(){return s(this,Z),p(this,o(Z).apply(this,arguments))}function ee(e,t,n){var r=new Q,i=n;Array.isArray(i)||("function"==typeof i.entries&&(i=i.entries()),i=m(i));for(var o=0;o<i.length;o++){var s=i[o],a=s[0],s=s[1];r.set(a,s)}if(Array.isArray(t)){var u=t;Array.isArray(u)||("function"==typeof u.entries&&(u=u.entries()),u=m(u));for(var l=0;l<u.length;l++){var c=u[l];e.set(c,r)}}else e.set(t,r);return r}function te(e,t,n){var r,i=e.get(t),o=n;Array.isArray(o)||("function"==typeof o.entries&&(o=o.entries()),o=m(o));for(var s=0;s<o.length;s++)r=o[s],i.set(r[0],r[1])}var ne=k(),re=k(),ie=k(),oe=["chunked","firstChunkSize","firstChunkSizeNode","firstChunkSizeBrowser","chunkSize","chunkLimit"],se=["jfif","xmp","icc","iptc","ihdr"],ae=["tiff"].concat(se),ue=["ifd0","ifd1","exif","gps","interop"],le=[].concat(ae,ue),ce=["makerNote","userComment"],pe=["translateKeys","translateValues","reviveValues","multiSegment"],de=[].concat(pe,["sanitize","mergeOutput","silentErrors"]),he=(e(we,[{key:"translate",get:function(){return this.translateKeys||this.translateValues||this.reviveValues}}]),we),fe=(n(be,he),e(be,[{key:"needed",get:function(){return this.enabled||0<this.deps.size}}]),e(be,[{key:"applyInheritables",value:function(e){var t,n,r=pe;Array.isArray(r)||("function"==typeof r.entries&&(r=r.entries()),r=m(r));for(var i=0;i<r.length;i++)void 0!==(n=e[t=r[i]])&&(this[t]=n)}},{key:"translateTagSet",value:function(e,t){if(this.dict){var n,r,i=this.dict,o=i.tagKeys,s=i.tagValues,a=e;Array.isArray(a)||("function"==typeof a.entries&&(a=a.entries()),a=m(a));for(var u=0;u<a.length;u++)"string"==typeof(n=a[u])?-1!==(r=-1===(r=s.indexOf(n))?o.indexOf(Number(n)):r)&&t.add(Number(o[r])):t.add(n)}else{var l=e;Array.isArray(l)||("function"==typeof l.entries&&(l=l.entries()),l=m(l));for(var c=0;c<l.length;c++){var p=l[c];t.add(p)}}}},{key:"finalizeFilters",value:function(){!this.enabled&&0<this.deps.size?(this.enabled=!0,ke(this.pick,this.deps)):this.enabled&&0<this.pick.size&&ke(this.pick,this.deps)}}]),be),ye={jfif:!1,tiff:!0,xmp:!1,icc:!1,iptc:!1,ifd0:!0,ifd1:!1,exif:!0,gps:!0,interop:!1,ihdr:void 0,makerNote:!1,userComment:!1,multiSegment:!1,skip:[],pick:[],translateKeys:!0,translateValues:!0,reviveValues:!0,sanitize:!0,mergeOutput:!0,silentErrors:!0,chunked:!0,firstChunkSize:void 0,firstChunkSizeNode:512,firstChunkSizeBrowser:65536,chunkSize:65536,chunkLimit:5},ge=k(),me=(n(ve,he),e(ve,null,[{key:"useCached",value:function(e){var t=ge.get(e);return void 0!==t||(t=new this(e),ge.set(e,t)),t}}]),e(ve,[{key:"setupFromUndefined",value:function(){var e,t=oe;Array.isArray(t)||("function"==typeof t.entries&&(t=t.entries()),t=m(t));for(var n=0;n<t.length;n++)this[e=t[n]]=ye[e];var r=de;Array.isArray(r)||("function"==typeof r.entries&&(r=r.entries()),r=m(r));for(var i=0;i<r.length;i++)this[e=r[i]]=ye[e];var o=ce;Array.isArray(o)||("function"==typeof o.entries&&(o=o.entries()),o=m(o));for(var s=0;s<o.length;s++)this[e=o[s]]=ye[e];var a=le;Array.isArray(a)||("function"==typeof a.entries&&(a=a.entries()),a=m(a));for(var u=0;u<a.length;u++)this[e=a[u]]=new fe(e,ye[e],void 0,this)}},{key:"setupFromTrue",value:function(){var e,t=oe;Array.isArray(t)||("function"==typeof t.entries&&(t=t.entries()),t=m(t));for(var n=0;n<t.length;n++)this[e=t[n]]=ye[e];var r=de;Array.isArray(r)||("function"==typeof r.entries&&(r=r.entries()),r=m(r));for(var i=0;i<r.length;i++)this[e=r[i]]=ye[e];var o=ce;Array.isArray(o)||("function"==typeof o.entries&&(o=o.entries()),o=m(o));for(var s=0;s<o.length;s++)this[e=o[s]]=!0;var a=le;Array.isArray(a)||("function"==typeof a.entries&&(a=a.entries()),a=m(a));for(var u=0;u<a.length;u++)this[e=a[u]]=new fe(e,!0,void 0,this)}},{key:"setupFromArray",value:function(e){var t,n=oe;Array.isArray(n)||("function"==typeof n.entries&&(n=n.entries()),n=m(n));for(var r=0;r<n.length;r++)this[t=n[r]]=ye[t];var i=de;Array.isArray(i)||("function"==typeof i.entries&&(i=i.entries()),i=m(i));for(var o=0;o<i.length;o++)this[t=i[o]]=ye[t];var s=ce;Array.isArray(s)||("function"==typeof s.entries&&(s=s.entries()),s=m(s));for(var a=0;a<s.length;a++)this[t=s[a]]=ye[t];var u=le;Array.isArray(u)||("function"==typeof u.entries&&(u=u.entries()),u=m(u));for(var l=0;l<u.length;l++)this[t=u[l]]=new fe(t,!1,void 0,this);this.setupGlobalFilters(e,void 0,ue)}},{key:"setupFromObject",value:function(e){var t;ue.ifd0=ue.ifd0||ue.image,ue.ifd1=ue.ifd1||ue.thumbnail,y(this,e);var n=oe;Array.isArray(n)||("function"==typeof n.entries&&(n=n.entries()),n=m(n));for(var r=0;r<n.length;r++)this[t=n[r]]=Se(e[t],ye[t]);var i=de;Array.isArray(i)||("function"==typeof i.entries&&(i=i.entries()),i=m(i));for(var o=0;o<i.length;o++)this[t=i[o]]=Se(e[t],ye[t]);var s=ce;Array.isArray(s)||("function"==typeof s.entries&&(s=s.entries()),s=m(s));for(var a=0;a<s.length;a++)this[t=s[a]]=Se(e[t],ye[t]);var u=ae;Array.isArray(u)||("function"==typeof u.entries&&(u=u.entries()),u=m(u));for(var l=0;l<u.length;l++)this[t=u[l]]=new fe(t,ye[t],e[t],this);var c=ue;Array.isArray(c)||("function"==typeof c.entries&&(c=c.entries()),c=m(c));for(var p=0;p<c.length;p++)this[t=c[p]]=new fe(t,ye[t],e[t],this.tiff);this.setupGlobalFilters(e.pick,e.skip,ue,le),!0===e.tiff?this.batchEnableWithBool(ue,!0):!1===e.tiff?this.batchEnableWithUserValue(ue,e):Array.isArray(e.tiff)?this.setupGlobalFilters(e.tiff,void 0,ue):"object"==typeof e.tiff&&this.setupGlobalFilters(e.tiff.pick,e.tiff.skip,ue)}},{key:"batchEnableWithBool",value:function(e,t){var n=e;Array.isArray(n)||("function"==typeof n.entries&&(n=n.entries()),n=m(n));for(var r=0;r<n.length;r++)this[n[r]].enabled=t}},{key:"batchEnableWithUserValue",value:function(e,t){var n=e;Array.isArray(n)||("function"==typeof n.entries&&(n=n.entries()),n=m(n));for(var r=0;r<n.length;r++){var i=n[r],o=t[i];this[i].enabled=!1!==o&&void 0!==o}}},{key:"setupGlobalFilters",value:function(e,t,n){if(e&&e.length){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:n;Array.isArray(r)||("function"==typeof r.entries&&(r=r.entries()),r=m(r));for(var i=0;i<r.length;i++)this[r[i]].enabled=!1;var o=_e(e,n);Array.isArray(o)||("function"==typeof o.entries&&(o=o.entries()),o=m(o));for(var s=0;s<o.length;s++){var a=o[s],u=a[0],a=a[1];ke(this[u].pick,a),this[u].enabled=!0}}else if(t&&t.length){var l=_e(t,n);Array.isArray(l)||("function"==typeof l.entries&&(l=l.entries()),l=m(l));for(var c=0;c<l.length;c++){var p=l[c],d=p[0],p=p[1];ke(this[d].skip,p)}}}},{key:"filterNestedSegmentTags",value:function(){var e=this.ifd0,t=this.exif,n=this.xmp,r=this.iptc,i=this.icc;(this.makerNote?t.deps:t.skip).add(37500),(this.userComment?t.deps:t.skip).add(37510),n.enabled||e.skip.add(700),r.enabled||e.skip.add(33723),i.enabled||e.skip.add(34675)}},{key:"traverseTiffDependencyTree",value:function(){var t=this,e=this.ifd0,n=this.exif,r=this.gps;this.interop.needed&&(n.deps.add(40965),e.deps.add(40965)),n.needed&&e.deps.add(34665),r.needed&&e.deps.add(34853),this.tiff.enabled=ue.some(function(e){return!0===t[e].enabled})||this.makerNote||this.userComment;var i=ue;Array.isArray(i)||("function"==typeof i.entries&&(i=i.entries()),i=m(i));for(var o=0;o<i.length;o++)this[i[o]].finalizeFilters()}},{key:"checkLoadedPlugins",value:function(){var e=ae;Array.isArray(e)||("function"==typeof e.entries&&(e=e.entries()),e=m(e));for(var t=0;t<e.length;t++){var n=e[t];this[n].enabled&&!z.has(n)&&M("segment parser",n)}}},{key:"onlyTiff",get:function(){var t=this;return!se.map(function(e){return t[e].enabled}).some(function(e){return!0===e})&&this.tiff.enabled}}]),ve);function ve(e){var t;return s(this,ve),t=p(this,o(ve).call(this)),!0===e?t.setupFromTrue():void 0===e?t.setupFromUndefined():Array.isArray(e)?t.setupFromArray(e):"object"==typeof e?t.setupFromObject(e):x("Invalid options argument ".concat(e)),void 0===t.firstChunkSize&&(t.firstChunkSize=F?t.firstChunkSizeBrowser:t.firstChunkSizeNode),t.mergeOutput&&(t.ifd1.enabled=!1),t.filterNestedSegmentTags(),t.traverseTiffDependencyTree(),t.checkLoadedPlugins(),t}function be(e,t,n,r){var i;return s(this,be),a(c(i=p(this,o(be).call(this))),"enabled",!1),a(c(i),"skip",S()),a(c(i),"pick",S()),a(c(i),"deps",S()),a(c(i),"translateKeys",!1),a(c(i),"translateValues",!1),a(c(i),"reviveValues",!1),i.key=e,i.enabled=t,i.parse=i.enabled,i.applyInheritables(r),i.canBeFiltered=ue.includes(e),i.canBeFiltered&&(i.dict=ne.get(e)),void 0!==n&&(Array.isArray(n)?(i.parse=i.enabled=!0,i.canBeFiltered&&0<n.length&&i.translateTagSet(n,i.pick)):"object"==typeof n?(i.enabled=!0,i.parse=!1!==n.parse,i.canBeFiltered&&(r=n.pick,e=n.skip,r&&0<r.length&&i.translateTagSet(r,i.pick),e&&0<e.length&&i.translateTagSet(e,i.skip)),i.applyInheritables(n)):!0===n||!1===n?i.parse=i.enabled=n:x("Invalid options argument: ".concat(n))),i}function we(){s(this,we)}function _e(e,t){var n,r=[],i=t;Array.isArray(i)||("function"==typeof i.entries&&(i=i.entries()),i=m(i));for(var o=0;o<i.length;o++){var s=i[o],a=[],u=ne.get(s);Array.isArray(u)||("function"==typeof u.entries&&(u=u.entries()),u=m(u));for(var l=0;l<u.length;l++)n=u[l],(e.includes(n[0])||e.includes(n[1]))&&a.push(n[0]);a.length&&r.push([s,a])}return r}function Se(e,t){return void 0!==e?e:void 0!==t?t:void 0}function ke(e,t){var n=t;Array.isArray(n)||("function"==typeof n.entries&&(n=n.entries()),n=m(n));for(var r=0;r<n.length;r++){var i=n[r];e.add(i)}}function Pe(e,t,n){return n?t?t(e):e:(e&&e.then||(e=Promise.resolve(e)),t?e.then(t):e)}function Ce(){}function Fe(e,t){if(!t)return e&&e.then?e.then(Ce):Promise.resolve()}function Ae(e,t){e=e();return e&&e.then?e.then(t):t(e)}a(me,"default",ye);var Ee,Oe=(e(Te,[{key:"setup",value:function(){if(!this.fileParser){var e=this.file,t=e.getUint16(0),n=N;Array.isArray(n)||("function"==typeof n.entries&&(n=n.entries()),n=m(n));for(var r=0;r<n.length;r++){var i=n[r],o=i[0],i=i[1];if(i.canHandle(e,t))return this.fileParser=new i(this.options,this.file,this.parsers),e[o]=!0}x("Unknown file format")}}},{key:"read",value:function(e){try{var t=this;return Pe((n=e,r=t.options,"string"==typeof n?J(n,r):F&&!A&&n instanceof HTMLImageElement?J(n.src,r):n instanceof Uint8Array||n instanceof ArrayBuffer||n instanceof DataView?new I(n):F&&n instanceof Blob?Y(n,r,"blob",X):void x("Invalid input argument")),function(e){t.file=e})}catch(e){return Promise.reject(e)}var n,r}},{key:"parse",value:function(){try{var t=this;t.setup();var n={},r=[];return Ae(function(){return t.options.silentErrors?Pe(t.doParse(n,r).catch(function(e){return r.push(e)}),function(){r.push.apply(r,t.fileParser.errors)}):Fe(t.doParse(n,r))},function(){return t.file.close&&t.file.close(),t.options.silentErrors&&0<r.length&&(n.errors=r),T(e=n)?void 0:e;var e})}catch(t){return Promise.reject(t)}}},{key:"doParse",value:function(r,i){try{var o=this;return Pe(o.fileParser.parse(),function(){var n,t,e=h(o.parsers).map((n=function(t){return Pe(t.parse(),function(e){t.assignToOutput(r,e)})},function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];try{return Promise.resolve(n.apply(this,e))}catch(e){return Promise.reject(e)}}));return o.options.silentErrors&&(t=function(e){return i.push(e)},e=e.map(function(e){return e.catch(t)})),Fe(Promise.all(e))})}catch(r){return Promise.reject(r)}}},{key:"extractThumbnail",value:function(){try{var t=this;t.setup();var n,r=t.options,i=t.file,o=z.get("tiff",r);return Ae(function(){return i.tiff?void(n={start:0,type:"tiff"}):function(){var e=function(){if(i.jpeg)return Pe(t.fileParser.getOrFindSegment("tiff"),function(e){n=e})}();if(e&&e.then)return e.then(Ce)}()},function(){if(void 0!==n)return Pe(t.fileParser.ensureSegmentChunk(n),function(e){return Pe((t.parsers.tiff=new o(e,r,i)).extractThumbnail(),function(e){return i.close&&i.close(),e})})})}catch(t){return Promise.reject(t)}}}]),Te),Ue=(Ee=function(e,t){var n=new Oe(t),t=function(){return n.parse()};return(e=!(e=n.read(e))||!e.then?Promise.resolve(e):e).then(t)},function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];try{return Promise.resolve(Ee.apply(this,e))}catch(e){return Promise.reject(e)}}),Re=Object.freeze({__proto__:null,parse:Ue,Exifr:Oe,fileParsers:N,segmentParsers:z,fileReaders:q,tagKeys:ne,tagValues:re,tagRevivers:ie,createDictionary:ee,extendDictionary:te,fetchUrlAsArrayBuffer:G,readBlobAsArrayBuffer:X,chunkedProps:oe,otherSegments:se,segments:ae,tiffBlocks:ue,segmentsAndBlocks:le,tiffExtractables:ce,inheritables:pe,allFormatters:de,Options:me});function Te(e){s(this,Te),a(this,"parsers",{}),this.options=me.useCached(e)}function xe(){}var De=(e(je,[{key:"injectSegment",value:function(e,t){this.options[e].enabled&&this.createParser(e,t)}},{key:"createParser",value:function(e,t){t=new(z.get(e))(t,this.options,this.file);return this.parsers[e]=t}},{key:"createParsers",value:function(e){var t=e;Array.isArray(t)||("function"==typeof t.entries&&(t=t.entries()),t=m(t));for(var n=0;n<t.length;n++){var r=t[n],i=r.type,o=r.chunk,r=this.options[i];r&&r.enabled&&((r=this.parsers[i])&&r.append||r||this.createParser(i,o))}}},{key:"readSegments",value:function(e){try{var t=e.map(this.ensureSegmentChunk);return(n=Promise.all(t))&&n.then?n.then(xe):Promise.resolve()}catch(e){return Promise.reject(e)}var n}}]),je),Be=(e(Ie,[{key:"normalizeInput",value:function(e){return e instanceof I?e:new I(e)}}],[{key:"findPosition",value:function(e,t){var n=e.getUint16(t+2)+2,r="function"==typeof this.headerLength?this.headerLength(e,t,n):this.headerLength,i=t+r,e=n-r;return{offset:t,length:n,headerLength:r,start:i,size:e,end:i+e}}},{key:"parse",value:function(e){return new this(e,new me(a({},this.type,1<arguments.length&&void 0!==arguments[1]?arguments[1]:{}))).parse()}}]),e(Ie,[{key:"translate",value:function(){this.canTranslate&&(this.translated=this.translateBlock(this.raw,this.type))}},{key:"translateBlock",value:function(e,t){var n=ie.get(t),r=re.get(t),i=ne.get(t),t=this.options[t],o=t.reviveValues&&!!n,s=t.translateValues&&!!r,a=t.translateKeys&&!!i,u={},l=e;Array.isArray(l)||("function"==typeof l.entries&&(l=l.entries()),l=m(l));for(var c=0;c<l.length;c++){var p=l[c],d=p[0],p=p[1];o&&n.has(d)?p=n.get(d)(p):s&&r.has(d)&&(p=this.translateValue(p,r.get(d))),u[d=a&&i.has(d)?i.get(d)||d:d]=p}return u}},{key:"translateValue",value:function(e,t){return t[e]||t.DEFAULT||e}},{key:"assignToOutput",value:function(e,t){this.assignObjectToOutput(e,this.constructor.type,t)}},{key:"assignObjectToOutput",value:function(e,t,n){if(this.globalOptions.mergeOutput)return y(e,n);e[t]?y(e[t],n):e[t]=n}},{key:"output",get:function(){return this.translated||(this.raw?g(this.raw):void 0)}}]),Ie);function Ie(e){var t=this,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},r=2<arguments.length?arguments[2]:void 0;s(this,Ie),a(this,"errors",[]),a(this,"raw",k()),a(this,"handleError",function(e){if(!t.options.silentErrors)throw e;t.errors.push(e.message)}),this.chunk=this.normalizeInput(e),this.file=r,this.type=this.constructor.type,this.globalOptions=this.options=n,this.localOptions=n[this.type],this.canTranslate=this.localOptions&&this.localOptions.translate}function je(e,t,n){var o=this;s(this,je),a(this,"errors",[]),a(this,"ensureSegmentChunk",function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];try{return Promise.resolve(function(n){var e,r=n.start,i=n.size||65536,t=function(){return n.chunk};return(e=function(){if(o.file.chunked)return function(){var e=function(){if(!o.file.available(r,i))return function(e){if(e&&e.then)return e.then(xe)}(function(e,t){try{var n=e()}catch(e){return t(e)}return n&&n.then?n.then(void 0,t):n}(function(){return t=function(e){n.chunk=e},(e=o.file.readChunk(r,i))&&e.then||(e=Promise.resolve(e)),t?e.then(t):e;var e,t},function(e){x("Couldn't read segment: ".concat(JSON.stringify(n),". ").concat(e.message))}));n.chunk=o.file.subarray(r,i)}();if(e&&e.then)return e.then(xe)}();o.file.byteLength>r+i?n.chunk=o.file.subarray(r,i):void 0===n.size?n.chunk=o.file.subarray(r):x("Segment unreachable: "+JSON.stringify(n))}())&&e.then?e.then(t):t()}.apply(this,e))}catch(e){return Promise.reject(e)}}),this.extendOptions&&this.extendOptions(e),this.options=e,this.file=t,this.parsers=n}function Me(e,t,n){return n?t?t(e):e:(e&&e.then||(e=Promise.resolve(e)),t?e.then(t):e)}function Le(){}function Ne(e,t){e=e();return e&&e.then?e.then(t):t(e)}function ze(e,t,n){if(!e.s){if(n instanceof qe){if(!n.s)return void(n.o=ze.bind(null,e,t));1&t&&(t=n.s),n=n.v}n&&n.then?n.then(ze.bind(null,e,t),ze.bind(null,e,2)):(e.s=t,e.v=n,(n=e.o)&&n(e))}}a(Be,"headerLength",4),a(Be,"type",void 0),a(Be,"multiSegment",!1),a(Be,"canHandle",function(){return!1});var qe=(He.prototype.then=function(n,r){var i=new He,e=this.s;if(e){e=1&e?n:r;if(e){try{ze(i,1,e(this.v))}catch(e){ze(i,2,e)}return i}return this}return this.o=function(e){try{var t=e.v;1&e.s?ze(i,1,n?n(t):t):r?ze(i,1,r(t)):ze(i,2,t)}catch(e){ze(i,2,e)}},i},He);function He(){}function Ve(e){return e instanceof qe&&1&e.s}var We=(n(Xe,De),e(Xe,[{key:"parse",value:function(){try{var e=this;return Me(e.findAppSegments(),function(){return Me(e.readSegments(e.appSegments),function(){e.mergeMultiSegments(),e.createParsers(e.mergedAppSegments||e.appSegments)})})}catch(e){return Promise.reject(e)}}},{key:"setupSegmentFinderArgs",value:function(e){var t=this;!0===e?(this.findAll=!0,this.wanted=S(z.keyList())):(e=void 0===e?z.keyList().filter(function(e){return t.options[e].enabled}):e.filter(function(e){return t.options[e].enabled&&z.has(e)}),this.findAll=!1,this.remaining=S(e),this.wanted=S(e)),this.unfinishedMultiSegment=!1}},{key:"findAppSegments",value:function(){var i=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,e=1<arguments.length?arguments[1]:void 0;try{var o=this;o.setupSegmentFinderArgs(e);var s=o.file,t=o.findAll,n=o.wanted,a=o.remaining;return Ne(function(){if(!t&&o.file.chunked)return t=m(n).some(function(e){var t=z.get(e),e=o.options[e];return t.multiSegment&&e.multiSegment}),function(){var e=function(){if(t)return(e=o.file.readWhole())&&e.then?e.then(Le):Promise.resolve();var e}();if(e&&e.then)return e.then(Le)}()},function(){var r=!1;if(i=o.findAppSegmentsInRange(i,s.byteLength),!o.options.onlyTiff)return function(){if(s.chunked){var n=!1;return function(t,n){for(var e;;){var r=t();if(!(r=Ve(r)?r.v:r))return i;if(r.then){e=0;break}var i=n();if(i&&i.then){if(!Ve(i)){e=1;break}i=i.s}}var o=new qe,s=ze.bind(null,o,2);return(0===e?r.then(u):1===e?i.then(a):(void 0).then(function(){(r=t())?r.then?r.then(u).then(void 0,s):u(r):ze(o,1,i)})).then(void 0,s),o;function a(e){i=e;do{if(!(r=t())||Ve(r)&&!r.v)return void ze(o,1,i);if(r.then)return void r.then(u).then(void 0,s)}while(!(i=Ve(i=n())?i.v:i)||!i.then);i.then(a).then(void 0,s)}function u(e){e?(i=n())&&i.then?i.then(a).then(void 0,s):a(i):ze(o,1,i)}}(function(){return!r&&0<a.size&&!n&&(!!s.canReadNextChunk||!!o.unfinishedMultiSegment)},function(){var e=s.nextChunkOffset,t=o.appSegments.some(function(e){return!o.file.available(e.offset||e.start,e.length||e.size)});return Ne(function(){return Me(e<i&&!t?s.readNextChunk(i):s.readNextChunk(e),function(e){n=!e})},function(){void 0===(i=o.findAppSegmentsInRange(i,s.byteLength))&&(r=!0)})})}}()})}catch(i){return Promise.reject(i)}}},{key:"findAppSegmentsInRange",value:function(e,t){t-=2;for(var n,r,i,o,s,a,u=this.file,l=this.findAll,c=this.wanted,p=this.remaining,d=this.options;e<t;e++)if(255===u.getUint8(e))if(224<=(a=n=u.getUint8(e+1))&&a<=239){if(r=u.getUint16(e+2),(s=function(e,t,n){var r=z;Array.isArray(r)||("function"==typeof r.entries&&(r=r.entries()),r=m(r));for(var i=0;i<r.length;i++){var o=r[i],s=o[0];if(o[1].canHandle(e,t,n))return s}}(u,e,r))&&c.has(s)&&(o=(i=z.get(s)).findPosition(u,e),a=d[s],o.type=s,this.appSegments.push(o),!l&&(i.multiSegment&&a.multiSegment?(this.unfinishedMultiSegment=o.chunkNumber<o.chunkCount,this.unfinishedMultiSegment||p.delete(s)):p.delete(s),0===p.size)))break;d.recordUnknownSegments&&((o=Be.findPosition(u,e)).marker=n,this.unknownSegments.push(o)),e+=r+1}else if(192===(s=n)||194===s||196===s||219===s||221===s||218===s||254===s){if(r=u.getUint16(e+2),218===n&&!1!==d.stopAfterSos)return;d.recordJpegSegments&&this.jpegSegments.push({offset:e,length:r,marker:n}),e+=r+1}return e}},{key:"mergeMultiSegments",value:function(){var e,r=this;this.appSegments.some(function(e){return e.multiSegment})&&(e=function(e){for(var t,n,r,i=k(),o=0;o<e.length;o++)n=(t=e[o]).type,i.has(n)?r=i.get(n):i.set(n,r=[]),r.push(t);return m(i)}(this.appSegments),this.mergedAppSegments=e.map(function(e){var t=e[0],n=e[1],e=z.get(t,r.options);return e.handleMultiSegments?{type:t,chunk:e.handleMultiSegments(n)}:n[0]}))}},{key:"getSegment",value:function(t){return this.appSegments.find(function(e){return e.type===t})}},{key:"getOrFindSegment",value:function(e){try{var t=this,n=t.getSegment(e);return Ne(function(){if(void 0===n)return Me(t.findAppSegments(0,[e]),function(){n=t.getSegment(e)})},function(){return n})}catch(e){return Promise.reject(e)}}}],[{key:"canHandle",value:function(e,t){return 65496===t}}]),Xe);function Xe(){var e;s(this,Xe);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return a(c(e=p(this,(e=o(Xe)).call.apply(e,[this].concat(n)))),"appSegments",[]),a(c(e),"jpegSegments",[]),a(c(e),"unknownSegments",[]),e}function Ge(){}function Ke(e,t){if(!t)return e&&e.then?e.then(Ge):Promise.resolve()}function $e(e,t){e=e();return e&&e.then?e.then(t):t(e)}a(We,"type","jpeg"),N.set("jpeg",We);var Ye=[void 0,1,1,2,4,8,1,1,2,4,8,4,8,4],Je=(n(Ze,Be),e(Ze,[{key:"parseHeader",value:function(){var e=this.chunk.getUint16();18761===e?this.le=!0:19789===e&&(this.le=!1),this.chunk.le=this.le,this.headerParsed=!0}},{key:"parseTags",value:function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:k(),r=this.options[t],i=r.pick,o=r.skip,s=0<(i=S(i)).size,a=0===o.size,u=this.chunk.getUint16(e);e+=2;for(var l=0;l<u;l++){var c=this.chunk.getUint16(e);if(s){if(i.has(c)&&(n.set(c,this.parseTag(e,c,t)),i.delete(c),0===i.size))break}else!a&&o.has(c)||n.set(c,this.parseTag(e,c,t));e+=12}return n}},{key:"parseTag",value:function(e,t,n){var r=this.chunk,i=r.getUint16(e+2),o=r.getUint32(e+4),s=Ye[i];if(s*o<=4?e+=8:e=r.getUint32(e+8),(i<1||13<i)&&x("Invalid TIFF value type. block: ".concat(n.toUpperCase(),", tag: ").concat(t.toString(16),", type: ").concat(i,", offset ").concat(e)),e>r.byteLength&&x("Invalid TIFF value offset. block: ".concat(n.toUpperCase(),", tag: ").concat(t.toString(16),", type: ").concat(i,", offset ").concat(e," is outside of chunk size ").concat(r.byteLength)),1===i)return r.getUint8Array(e,o);if(2===i)return""===(t=function(e){for(;e.endsWith("\0");)e=e.slice(0,-1);return e}(t=r.getString(e,o)).trim())?void 0:t;if(7===i)return r.getUint8Array(e,o);if(1===o)return this.parseTagValue(i,e);for(var a=new(function(){switch(i){case 1:return Uint8Array;case 3:return Uint16Array;case 4:return Uint32Array;case 5:return Array;case 6:return Int8Array;case 8:return Int16Array;case 9:return Int32Array;case 10:return Array;case 11:return Float32Array;case 12:return Float64Array;default:return Array}}())(o),u=s,l=0;l<o;l++)a[l]=this.parseTagValue(i,e),e+=u;return a}},{key:"parseTagValue",value:function(e,t){var n=this.chunk;switch(e){case 1:return n.getUint8(t);case 3:return n.getUint16(t);case 4:return n.getUint32(t);case 5:return n.getUint32(t)/n.getUint32(t+4);case 6:return n.getInt8(t);case 8:return n.getInt16(t);case 9:return n.getInt32(t);case 10:return n.getInt32(t)/n.getInt32(t+4);case 11:return n.getFloat(t);case 12:return n.getDouble(t);case 13:return n.getUint32(t);default:x("Invalid tiff type ".concat(e))}}}]),Ze,n(Qe,Ze),e(Qe,[{key:"parse",value:function(){try{var e=this;e.parseHeader();var t=e.options;return $e(function(){if(t.ifd0.enabled)return Ke(e.parseIfd0Block())},function(){return $e(function(){if(t.exif.enabled)return Ke(e.safeParse("parseExifBlock"))},function(){return $e(function(){if(t.gps.enabled)return Ke(e.safeParse("parseGpsBlock"))},function(){return $e(function(){if(t.interop.enabled)return Ke(e.safeParse("parseInteropBlock"))},function(){return $e(function(){if(t.ifd1.enabled)return Ke(e.safeParse("parseThumbnailBlock"))},function(){return e.createOutput()})})})})})}catch(e){return Promise.reject(e)}}},{key:"safeParse",value:function(e){e=this[e]();return e=void 0!==e.catch?e.catch(this.handleError):e}},{key:"findIfd0Offset",value:function(){void 0===this.ifd0Offset&&(this.ifd0Offset=this.chunk.getUint32(4))}},{key:"findIfd1Offset",value:function(){var e;void 0===this.ifd1Offset&&(this.findIfd0Offset(),e=this.chunk.getUint16(this.ifd0Offset),e=this.ifd0Offset+2+12*e,this.ifd1Offset=this.chunk.getUint32(e))}},{key:"parseBlock",value:function(e,t){var n=k();return this[t]=n,this.parseTags(e,t,n),n}},{key:"parseIfd0Block",value:function(){try{var t=this;if(t.ifd0)return;var e=t.file;return t.findIfd0Offset(),t.ifd0Offset<8&&x("Malformed EXIF data"),!e.chunked&&t.ifd0Offset>e.byteLength&&x("IFD0 offset points to outside of file.\nthis.ifd0Offset: ".concat(t.ifd0Offset,", file.byteLength: ").concat(e.byteLength)),$e(function(){if(e.tiff)return Ke(e.ensureChunk(t.ifd0Offset,D(t.options)))},function(){var e=t.parseBlock(t.ifd0Offset,"ifd0");if(0!==e.size)return t.exifOffset=e.get(34665),t.interopOffset=e.get(40965),t.gpsOffset=e.get(34853),t.xmp=e.get(700),t.iptc=e.get(33723),t.icc=e.get(34675),t.options.sanitize&&(e.delete(34665),e.delete(40965),e.delete(34853),e.delete(700),e.delete(33723),e.delete(34675)),e})}catch(t){return Promise.reject(t)}}},{key:"parseExifBlock",value:function(){try{var t=this;return t.exif?void 0:$e(function(){if(!t.ifd0)return Ke(t.parseIfd0Block())},function(){if(void 0!==t.exifOffset)return $e(function(){if(t.file.tiff)return Ke(t.file.ensureChunk(t.exifOffset,D(t.options)))},function(){var e=t.parseBlock(t.exifOffset,"exif");return t.interopOffset||(t.interopOffset=e.get(40965)),t.makerNote=e.get(37500),t.userComment=e.get(37510),t.options.sanitize&&(e.delete(40965),e.delete(37500),e.delete(37510)),t.unpack(e,41728),t.unpack(e,41729),e})})}catch(t){return Promise.reject(t)}}},{key:"unpack",value:function(e,t){var n=e.get(t);n&&1===n.length&&e.set(t,n[0])}},{key:"parseGpsBlock",value:function(){try{var t=this;return t.gps?void 0:$e(function(){if(!t.ifd0)return Ke(t.parseIfd0Block())},function(){if(void 0!==t.gpsOffset){var e=t.parseBlock(t.gpsOffset,"gps");return e&&e.has(2)&&e.has(4)&&(e.set("latitude",et.apply(void 0,e.get(2).concat([e.get(1)]))),e.set("longitude",et.apply(void 0,e.get(4).concat([e.get(3)])))),e}})}catch(t){return Promise.reject(t)}}},{key:"parseInteropBlock",value:function(){try{var e=this;return e.interop?void 0:$e(function(){if(!e.ifd0)return Ke(e.parseIfd0Block())},function(){return $e(function(){if(void 0===e.interopOffset&&!e.exif)return Ke(e.parseExifBlock())},function(){if(void 0!==e.interopOffset)return e.parseBlock(e.interopOffset,"interop")})})}catch(e){return Promise.reject(e)}}},{key:"parseThumbnailBlock",value:function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0];try{return this.ifd1||this.ifd1Parsed?void 0:this.options.mergeOutput&&!e?void 0:(this.findIfd1Offset(),0<this.ifd1Offset&&(this.parseBlock(this.ifd1Offset,"ifd1"),this.ifd1Parsed=!0),this.ifd1)}catch(e){return Promise.reject(e)}}},{key:"extractThumbnail",value:function(){try{var n=this;return n.headerParsed||n.parseHeader(),$e(function(){if(!n.ifd1Parsed)return Ke(n.parseThumbnailBlock(!0))},function(){if(void 0!==n.ifd1){var e=n.ifd1.get(513),t=n.ifd1.get(514);return n.chunk.getUint8Array(e,t)}})}catch(n){return Promise.reject(n)}}},{key:"createOutput",value:function(){var e,t,n={},r=ue;Array.isArray(r)||("function"==typeof r.entries&&(r=r.entries()),r=m(r));for(var i=0;i<r.length;i++)if(!T(t=this[e=r[i]]))if(t=this.canTranslate?this.translateBlock(t,e):g(t),this.options.mergeOutput){if("ifd1"===e)continue;y(n,t)}else n[e]=t;return this.makerNote&&(n.makerNote=this.makerNote),this.userComment&&(n.userComment=this.userComment),n}},{key:"assignToOutput",value:function(e,t){if(this.globalOptions.mergeOutput)y(e,t);else{var n=f(t);Array.isArray(n)||("function"==typeof n.entries&&(n=n.entries()),n=m(n));for(var r=0;r<n.length;r++){var i=n[r],o=i[0],i=i[1];this.assignObjectToOutput(e,o,i)}}}},{key:"image",get:function(){return this.ifd0}},{key:"thumbnail",get:function(){return this.ifd1}}],[{key:"canHandle",value:function(e,t){return 225===e.getUint8(t+1)&&1165519206===e.getUint32(t+4)&&0===e.getUint16(t+8)}}]),Qe);function Qe(){return s(this,Qe),p(this,o(Qe).apply(this,arguments))}function Ze(){return s(this,Ze),p(this,o(Ze).apply(this,arguments))}function et(e,t,n,r){n=e+t/60+n/3600;return"S"!==r&&"W"!==r||(n*=-1),n}a(Je,"type","tiff"),a(Je,"headerLength",10),z.set("tiff",Je);w=Object.freeze({__proto__:null,default:Re,parse:Ue,Exifr:Oe,fileParsers:N,segmentParsers:z,fileReaders:q,tagKeys:ne,tagValues:re,tagRevivers:ie,createDictionary:ee,extendDictionary:te,fetchUrlAsArrayBuffer:G,readBlobAsArrayBuffer:X,chunkedProps:oe,otherSegments:se,segments:ae,tiffBlocks:ue,segmentsAndBlocks:le,tiffExtractables:ce,inheritables:pe,allFormatters:de,Options:me});function tt(e,t,n){return n?t?t(e):e:(e&&e.then||(e=Promise.resolve(e)),t?e.then(t):e)}function nt(n){return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];try{return Promise.resolve(n.apply(this,e))}catch(e){return Promise.reject(e)}}}var rt,it=nt(function(e){var t=new Oe(st);return tt(t.read(e),function(){return tt(t.parse(),function(e){if(e&&e.ifd0)return e.ifd0[274]})})}),C=nt(function(e){var t=new Oe(ot);return tt(t.read(e),function(){return tt(t.parse(),function(e){if(e&&e.gps){e=e.gps;return{latitude:e.latitude,longitude:e.longitude}}})})}),L=nt(function(e){return tt(this.thumbnail(e),function(e){if(void 0!==e){e=new Blob([e]);return URL.createObjectURL(e)}})}),he=nt(function(e){var t=new Oe(at);return tt(t.read(e),function(){return tt(t.extractThumbnail(),function(e){return e&&U?O.from(e):e})})}),De={ifd0:!1,ifd1:!1,exif:!1,gps:!1,interop:!1,sanitize:!1,reviveValues:!0,translateKeys:!1,translateValues:!1,mergeOutput:!1},ot=y({},De,{firstChunkSize:4e4,gps:[1,2,3,4]}),st=y({},De,{firstChunkSize:4e4,ifd0:[274]}),at=y({},De,{tiff:!1,ifd1:!0,mergeOutput:!1}),ut={1:{dimensionSwapped:!1,scaleX:1,scaleY:1,deg:0,rad:0},2:{dimensionSwapped:!1,scaleX:-1,scaleY:1,deg:0,rad:0},3:{dimensionSwapped:!1,scaleX:1,scaleY:1,deg:180,rad:180*Math.PI/180},4:{dimensionSwapped:!1,scaleX:-1,scaleY:1,deg:180,rad:180*Math.PI/180},5:{dimensionSwapped:!0,scaleX:1,scaleY:-1,deg:90,rad:90*Math.PI/180},6:{dimensionSwapped:!0,scaleX:1,scaleY:1,deg:90,rad:90*Math.PI/180},7:{dimensionSwapped:!0,scaleX:1,scaleY:-1,deg:270,rad:270*Math.PI/180},8:{dimensionSwapped:!0,scaleX:1,scaleY:1,deg:270,rad:270*Math.PI/180}};function lt(){}t.rotateCanvas=!0,t.rotateCss=!0,"object"==typeof navigator&&(!(We=navigator.userAgent).includes("iPad")&&!We.includes("iPhone")||(Je=We.match(/OS (\d+)_(\d+)/))&&(Je[0],Re=Je[1],rt=Je[2],rt=Number(Re)+.1*Number(rt),t.rotateCanvas=rt<13.4,t.rotateCss=!1),We.includes("Chrome/")?((rt=We.match(/Chrome\/(\d+)/))[0],rt=rt[1],81<=Number(rt)&&(t.rotateCanvas=t.rotateCss=!1)):We.includes("Firefox/")&&((ct=We.match(/Firefox\/(\d+)/))[0],ct=ct[1],77<=Number(ct)&&(t.rotateCanvas=t.rotateCss=!1)));var ct=(n(ht,I),e(ht,[{key:"_tryExtend",value:function(e,t,n){0===e&&0===this.byteLength&&n?(n=new DataView(n.buffer||n,n.byteOffset,n.byteLength),this._swapDataView(n)):(t=e+t)>this.byteLength&&(t=this._extend(t).dataView,this._swapDataView(t))}},{key:"_extend",value:function(e){var t=U?O.allocUnsafe(e):new Uint8Array(e),e=new DataView(t.buffer,t.byteOffset,t.byteLength);return t.set(new Uint8Array(this.buffer,this.byteOffset,this.byteLength),0),{uintView:t,dataView:e}}},{key:"subarray",value:function(e,t){var n=2<arguments.length&&void 0!==arguments[2]&&arguments[2];return t=t||this._lengthToEnd(e),n&&this._tryExtend(e,t),this.ranges.add(e,t),d(o(ht.prototype),"subarray",this).call(this,e,t)}},{key:"set",value:function(e,t){2<arguments.length&&void 0!==arguments[2]&&arguments[2]&&this._tryExtend(t,e.byteLength,e);e=d(o(ht.prototype),"set",this).call(this,e,t);return this.ranges.add(t,e.byteLength),e}},{key:"ensureChunk",value:function(e,t){try{return this.chunked?this.ranges.available(e,t)?void 0:(n=this.readChunk(e,t))&&n.then?n.then(lt):Promise.resolve():void 0}catch(e){return Promise.reject(e)}var n}},{key:"available",value:function(e,t){return this.ranges.available(e,t)}}]),ht),pt=(e(dt,[{key:"add",value:function(t,e){var n,r=t+e,i=this.list.filter(function(e){return ft(t,e.offset,r)||ft(t,e.end,r)});0<i.length?(t=Math.min.apply(Math,[t].concat(i.map(function(e){return e.offset}))),e=(r=Math.max.apply(Math,[r].concat(i.map(function(e){return e.end}))))-t,(n=i.shift()).offset=t,n.length=e,n.end=r,this.list=this.list.filter(function(e){return!i.includes(e)})):this.list.push({offset:t,length:e,end:r})}},{key:"available",value:function(t,e){var n=t+e;return this.list.some(function(e){return e.offset<=t&&n<=e.end})}},{key:"length",get:function(){return this.list.length}}]),dt);function dt(){s(this,dt),a(this,"list",[])}function ht(){var e;s(this,ht);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return a(c(e=p(this,(e=o(ht)).call.apply(e,[this].concat(n)))),"ranges",new pt),0!==e.byteLength&&e.ranges.add(0,e.byteLength),e}function ft(e,t,n){return e<=t&&t<=n}function yt(){}function gt(e,t){if(!t)return e&&e.then?e.then(yt):Promise.resolve()}function mt(e,t,n){return n?t?t(e):e:(e&&e.then||(e=Promise.resolve(e)),t?e.then(t):e)}n(bt,ct),e(bt,[{key:"readWhole",value:function(){try{return this.chunked=!1,gt(this.readChunk(this.nextChunkOffset))}catch(e){return Promise.reject(e)}}},{key:"readChunked",value:function(){try{return this.chunked=!0,gt(this.readChunk(0,this.options.firstChunkSize))}catch(e){return Promise.reject(e)}}},{key:"readNextChunk",value:function(e){try{if(void 0===e&&(e=this.nextChunkOffset),this.fullyRead)return this.chunksRead++,!1;var t=this.options.chunkSize,n=this.readChunk(e,t),r=function(e){return!!e&&e.byteLength===t};return(n=!n||!n.then?Promise.resolve(n):n).then(r)}catch(e){return Promise.reject(e)}var n,r}},{key:"readChunk",value:function(e,t){try{return(this.chunksRead++,0===(t=this.safeWrapAddress(e,t)))?void 0:this._readChunk(e,t)}catch(e){return Promise.reject(e)}}},{key:"safeWrapAddress",value:function(e,t){return void 0!==this.size&&e+t>this.size?Math.max(0,this.size-e):t}},{key:"read",value:function(){return this.options.chunked?this.readChunked():this.readWhole()}},{key:"close",value:function(){}},{key:"nextChunkOffset",get:function(){if(0!==this.ranges.list.length)return this.ranges.list[0].length}},{key:"canReadNextChunk",get:function(){return this.chunksRead<this.options.chunkLimit}},{key:"fullyRead",get:function(){return void 0!==this.size&&this.nextChunkOffset===this.size}}]),n(vt,bt),e(vt,[{key:"readWhole",value:function(){try{var t=this;return t.chunked=!1,mt(X(t.input),function(e){t._swapArrayBuffer(e)})}catch(t){return Promise.reject(t)}}},{key:"readChunked",value:function(){return this.chunked=!0,this.size=this.input.size,d(o(vt.prototype),"readChunked",this).call(this)}},{key:"_readChunk",value:function(t,e){try{var n=this,r=e?t+e:void 0,i=n.input.slice(t,r);return mt(X(i),function(e){return n.set(e,t,!0)})}catch(t){return Promise.reject(t)}}}]),ct=vt;function vt(){return s(this,vt),p(this,o(vt).apply(this,arguments))}function bt(e,t){var n;return s(this,bt),a(c(n=p(this,o(bt).call(this,0))),"chunksRead",0),n.input=e,n.options=t,n}q.set("blob",ct),t.Exifr=Oe,t.Options=me,t.allFormatters=de,t.chunkedProps=oe,t.createDictionary=ee,t.default=w,t.disableAllOptions=De,t.extendDictionary=te,t.fetchUrlAsArrayBuffer=G,t.fileParsers=N,t.fileReaders=q,t.gps=C,t.gpsOnlyOptions=ot,t.inheritables=pe,t.orientation=it,t.orientationOnlyOptions=st,t.otherSegments=se,t.parse=Ue,t.readBlobAsArrayBuffer=X,t.rotation=function(e){return tt(it(e),function(e){return y({canvas:t.rotateCanvas,css:t.rotateCss},ut[e])})},t.rotations=ut,t.segmentParsers=z,t.segments=ae,t.segmentsAndBlocks=le,t.tagKeys=ne,t.tagRevivers=ie,t.tagValues=re,t.thumbnail=he,t.thumbnailOnlyOptions=at,t.thumbnailUrl=L,t.tiffBlocks=ue,t.tiffExtractables=ce,Object.defineProperty(t,"__esModule",{value:!0})};"object"==typeof xr.exports?t(xr.exports):t((e=e||self).exifr={})}.call(this)}).call(this,tl,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},t({}).Buffer);function Br(e){if("string"==typeof e){var t=[].slice.call(document.querySelectorAll(e));return 0<t.length?t:null}if("object"==typeof e&&oe(e))return[e]}function Ir(e,t){var i,o,n,t=void 0===(t=(void 0===t?{}:t).logDropError)?function(){}:t;return e.items&&e.items[0]&&"webkitGetAsEntry"in e.items[0]?(i=t,o=[],n=[],Mr(e.items).forEach(function(e){e=e.webkitGetAsEntry();e&&n.push(function n(r){return new Promise(function(t){r.isFile?r.file(function(e){e.relativePath=r.fullPath&&r.fullPath!=="/"+r.name?r.fullPath:null,o.push(e),t()},function(e){i(e),t()}):r.isDirectory&&function n(r,i,o,e){var s=e.onSuccess;r.readEntries(function(e){var t=[].concat(i,e);e.length?setTimeout(function(){n(r,t,o,{onSuccess:s})},0):s(t)},function(e){o(e),s(i)})}(r.createReader(),[],i,{onSuccess:function(e){e=e.map(n);Promise.all(e).then(function(){return t()})}})})}(e))}),Promise.all(n).then(function(){return o})):(e=Mr(e.files),Promise.resolve(e))}var xr=xr.exports,jr=(ps=_i=function(n){var e;function t(e,t){var r;if((r=n.call(this,e,t)||this).onFileAdded=function(e){e.preview||!Pt(e.type)||e.isRemote||r.addToQueue(e.id)},r.onCancelRequest=function(e){e=r.queue.indexOf(e.id);-1!==e&&r.queue.splice(e,1)},r.onFileRemoved=function(e){var t=r.queue.indexOf(e.id);-1!==t&&r.queue.splice(t,1),e.preview&&br(e.preview)&&URL.revokeObjectURL(e.preview)},r.onRestored=function(){var e=r.uppy.getState().files;Object.keys(e).forEach(function(e){e=r.uppy.getFile(e);e.isRestored&&(e.preview&&!br(e.preview)||r.addToQueue(e.id))})},r.waitUntilAllProcessed=function(e){e.forEach(function(e){e=r.uppy.getFile(e);r.uppy.emit("preprocess-progress",e,{mode:"indeterminate",message:r.i18n("generatingThumbnails")})});function n(){e.forEach(function(e){e=r.uppy.getFile(e);r.uppy.emit("preprocess-complete",e)})}return new Promise(function(e,t){r.queueProcessing?r.uppy.once("thumbnail:all-generated",function(){n(),e()}):(n(),e())})},r.type="modifier",r.id=r.opts.id||"ThumbnailGenerator",r.title="Thumbnail Generator",r.queue=[],r.queueProcessing=!1,r.defaultThumbnailDimension=200,r.thumbnailType=r.opts.thumbnailType||"image/jpeg",r.defaultLocale={strings:{generatingThumbnails:"Generating thumbnails..."}},r.opts=Dr({},{thumbnailWidth:null,thumbnailHeight:null,waitForThumbnailsBeforeUpload:!1,lazy:!1},t),r.opts.lazy&&r.opts.waitForThumbnailsBeforeUpload)throw new Error("ThumbnailGenerator: The `lazy` and `waitForThumbnailsBeforeUpload` options are mutually exclusive. Please ensure at most one of them is set to `true`.");return r.i18nInit(),r}r=n,(e=t).prototype=Object.create(r.prototype),(e.prototype.constructor=e).__proto__=r;var r=t.prototype;return r.setOptions=function(e){n.prototype.setOptions.call(this,e),this.i18nInit()},r.i18nInit=function(){this.translator=new C([this.defaultLocale,this.uppy.locale,this.opts.locale]),this.i18n=this.translator.translate.bind(this.translator),this.setPluginState()},r.createThumbnail=function(e,r,i){var o=this,s=URL.createObjectURL(e.data),t=new Promise(function(e,t){var n=new Image;n.src=s,n.addEventListener("load",function(){URL.revokeObjectURL(s),e(n)}),n.addEventListener("error",function(e){URL.revokeObjectURL(s),t(e.error||new Error("Could not create thumbnail"))})}),e=xr.rotation(e.data).catch(function(e){return 1});return Promise.all([t,e]).then(function(e){var t=e[0],n=e[1],e=o.getProportionalDimensions(t,r,i,n.deg),n=o.rotateImage(t,n),e=o.resizeImage(n,e.width,e.height);return o.canvasToBlob(e,o.thumbnailType,80)}).then(function(e){return URL.createObjectURL(e)})},r.getProportionalDimensions=function(e,t,n,r){var i=e.width/e.height;return 90!==r&&270!==r||(i=e.height/e.width),null!=t?{width:t,height:Math.round(t/i)}:null!=n?{width:Math.round(n*i),height:n}:{width:this.defaultThumbnailDimension,height:Math.round(this.defaultThumbnailDimension/i)}},r.protect=function(e){var t=e.width/e.height,n=Math.floor(Math.sqrt(5e6*t)),r=Math.floor(5e6/Math.sqrt(5e6*t));return 4096<n&&(n=4096,r=Math.round(n/t)),4096<r&&(r=4096,n=Math.round(t*r)),e.width>n&&((t=document.createElement("canvas")).width=n,t.height=r,t.getContext("2d").drawImage(e,0,0,n,r),e=t),e},r.resizeImage=function(e,t,n){e=this.protect(e);var r=Math.ceil(kr(e.width/t));r<1&&(r=1);for(var i=t*Math.pow(2,r-1),o=n*Math.pow(2,r-1);r--;){var s=document.createElement("canvas");s.width=i,s.height=o,s.getContext("2d").drawImage(e,0,0,i,o),e=s,i=Math.round(i/2),o=Math.round(o/2)}return e},r.rotateImage=function(e,t){var n=e.width,r=e.height;90!==t.deg&&270!==t.deg||(n=e.height,r=e.width);var i=document.createElement("canvas");i.width=n,i.height=r;var o=i.getContext("2d");return o.translate(n/2,r/2),t.canvas&&(o.rotate(t.rad),o.scale(t.scaleX,t.scaleY)),o.drawImage(e,-e.width/2,-e.height/2,e.width,e.height),i},r.canvasToBlob=function(t,n,r){try{t.getContext("2d").getImageData(0,0,1,1)}catch(e){if(18===e.code)return Promise.reject(new Error("cannot read image, probably an svg with external resources"))}return t.toBlob?new Promise(function(e){t.toBlob(e,n,r)}).then(function(e){if(null===e)throw new Error("cannot read image, probably an svg with external resources");return e}):Promise.resolve().then(function(){return vr(t.toDataURL(n,r),{})}).then(function(e){if(null===e)throw new Error("could not extract blob, probably an old browser");return e})},r.setPreviewURL=function(e,t){this.uppy.setFileState(e,{preview:t})},r.addToQueue=function(e){this.queue.push(e),!1===this.queueProcessing&&this.processQueue()},r.processQueue=function(){var e=this;if(this.queueProcessing=!0,0<this.queue.length){var t=this.uppy.getFile(this.queue.shift());return t?this.requestThumbnail(t).catch(function(e){}).then(function(){return e.processQueue()}):void this.uppy.log("[ThumbnailGenerator] file was removed before a thumbnail could be generated, but not removed from the queue. This is probably a bug","error")}this.queueProcessing=!1,this.uppy.log("[ThumbnailGenerator] Emptied thumbnail queue"),this.uppy.emit("thumbnail:all-generated")},r.requestThumbnail=function(t){var n=this;return Pt(t.type)&&!t.isRemote?this.createThumbnail(t,this.opts.thumbnailWidth,this.opts.thumbnailHeight).then(function(e){n.setPreviewURL(t.id,e),n.uppy.log("[ThumbnailGenerator] Generated thumbnail for "+t.id),n.uppy.emit("thumbnail:generated",n.uppy.getFile(t.id),e)}).catch(function(e){n.uppy.log("[ThumbnailGenerator] Failed thumbnail for "+t.id+":","warning"),n.uppy.log(e,"warning"),n.uppy.emit("thumbnail:error",n.uppy.getFile(t.id),e)}):Promise.resolve()},r.install=function(){this.uppy.on("file-removed",this.onFileRemoved),this.opts.lazy?(this.uppy.on("thumbnail:request",this.onFileAdded),this.uppy.on("thumbnail:cancel",this.onCancelRequest)):(this.uppy.on("file-added",this.onFileAdded),this.uppy.on("restored",this.onRestored)),this.opts.waitForThumbnailsBeforeUpload&&this.uppy.addPreProcessor(this.waitUntilAllProcessed)},r.uninstall=function(){this.uppy.off("file-removed",this.onFileRemoved),this.opts.lazy?(this.uppy.off("thumbnail:request",this.onFileAdded),this.uppy.off("thumbnail:cancel",this.onCancelRequest)):(this.uppy.off("file-added",this.onFileAdded),this.uppy.off("restored",this.onRestored)),this.opts.waitForThumbnailsBeforeUpload&&this.uppy.removePreProcessor(this.waitUntilAllProcessed)},t}(ue.Plugin),_i.VERSION="1.7.2",ps),Mr=function(e){return Array.prototype.slice.call(e||[],0)},Lr=function(e,t){if(t){t=e.querySelector('[data-uppy-paneltype="'+t+'"]');if(t)return t}return e},Nr=['a[href]:not([tabindex^="-"]):not([inert]):not([aria-hidden])','area[href]:not([tabindex^="-"]):not([inert]):not([aria-hidden])',"input:not([disabled]):not([inert]):not([aria-hidden])","select:not([disabled]):not([inert]):not([aria-hidden])","textarea:not([disabled]):not([inert]):not([aria-hidden])","button:not([disabled]):not([inert]):not([aria-hidden])",'iframe:not([tabindex^="-"]):not([inert]):not([aria-hidden])','object:not([tabindex^="-"]):not([inert]):not([aria-hidden])','embed:not([tabindex^="-"]):not([inert]):not([aria-hidden])','[contenteditable]:not([tabindex^="-"]):not([inert]):not([aria-hidden])','[tabindex]:not([tabindex^="-"]):not([inert]):not([aria-hidden])'];function zr(e,t){t=t[0];t&&(t.focus(),e.preventDefault())}function qr(e,t,n){var r=Lr(n,t),i=Mr(r.querySelectorAll(Nr)),n=i.indexOf(document.activeElement);r.contains(document.activeElement)?e.shiftKey&&0===n?(t=e,(r=i[i.length-1])&&(r.focus(),t.preventDefault())):e.shiftKey||n!==i.length-1||zr(e,i):zr(e,i)}var Hr={exports:{}};(function(P){!function(){var e,t;e=this,t=function(){"use strict";function s(e,t){for(var n=0,r=Object.keys(t);n<r.length;n++){var i=r[n];Object.defineProperty(e,i,{value:t[i],enumerable:!1,writable:!1,configurable:!0})}return e}function l(e){return e&&e.ownerDocument&&e.ownerDocument.defaultView||t}var r="undefined"!=typeof Map?Map:(Object.defineProperty(d.prototype,"size",{get:function(){return this.__entries__.length},enumerable:!0,configurable:!0}),d.prototype.get=function(e){e=p(this.__entries__,e),e=this.__entries__[e];return e&&e[1]},d.prototype.set=function(e,t){var n=p(this.__entries__,e);~n?this.__entries__[n][1]=t:this.__entries__.push([e,t])},d.prototype.delete=function(e){var t=this.__entries__,e=p(t,e);~e&&t.splice(e,1)},d.prototype.has=function(e){return!!~p(this.__entries__,e)},d.prototype.clear=function(){this.__entries__.splice(0)},d.prototype.forEach=function(e,t){void 0===t&&(t=null);for(var n=0,r=this.__entries__;n<r.length;n++){var i=r[n];e.call(t,i[1],i[0])}},d),n="undefined"!=typeof window&&"undefined"!=typeof document&&window.document===document,t=void 0!==P&&P.Math===Math?P:"undefined"!=typeof self&&self.Math===Math?self:"undefined"!=typeof window&&window.Math===Math?window:Function("return this")(),a="function"==typeof requestAnimationFrame?requestAnimationFrame.bind(t):function(e){return setTimeout(function(){return e(Date.now())},1e3/60)},i=["top","right","bottom","left","width","height","size","weight"],e="undefined"!=typeof MutationObserver,o=(u.prototype.addObserver=function(e){~this.observers_.indexOf(e)||this.observers_.push(e),this.connected_||this.connect_()},u.prototype.removeObserver=function(e){var t=this.observers_,e=t.indexOf(e);~e&&t.splice(e,1),!t.length&&this.connected_&&this.disconnect_()},u.prototype.refresh=function(){this.updateObservers_()&&this.refresh()},u.prototype.updateObservers_=function(){var e=this.observers_.filter(function(e){return e.gatherActive(),e.hasActive()});return e.forEach(function(e){return e.broadcastActive()}),0<e.length},u.prototype.connect_=function(){n&&!this.connected_&&(document.addEventListener("transitionend",this.onTransitionEnd_),window.addEventListener("resize",this.refresh),e?(this.mutationsObserver_=new MutationObserver(this.refresh),this.mutationsObserver_.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})):(document.addEventListener("DOMSubtreeModified",this.refresh),this.mutationEventsAdded_=!0),this.connected_=!0)},u.prototype.disconnect_=function(){n&&this.connected_&&(document.removeEventListener("transitionend",this.onTransitionEnd_),window.removeEventListener("resize",this.refresh),this.mutationsObserver_&&this.mutationsObserver_.disconnect(),this.mutationEventsAdded_&&document.removeEventListener("DOMSubtreeModified",this.refresh),this.mutationsObserver_=null,this.mutationEventsAdded_=!1,this.connected_=!1)},u.prototype.onTransitionEnd_=function(e){var e=e.propertyName,t=void 0===e?"":e;i.some(function(e){return!!~t.indexOf(e)})&&this.refresh()},u.getInstance=function(){return this.instance_||(this.instance_=new u),this.instance_},u.instance_=null,u),c=g(0,0,0,0);function u(){function e(){i&&(i=!1,r()),o&&n()}function t(){a(e)}function n(){var e=Date.now();if(i){if(e-s<2)return;o=!0}else o=!(i=!0),setTimeout(t,20);s=e}var r,i,o,s;this.connected_=!1,this.mutationEventsAdded_=!1,this.mutationsObserver_=null,this.observers_=[],this.onTransitionEnd_=this.onTransitionEnd_.bind(this),this.refresh=(r=this.refresh.bind(this),o=i=!1,s=0,n)}function p(e,n){var r=-1;return e.some(function(e,t){return e[0]===n&&(r=t,!0)}),r}function d(){this.__entries__=[]}function h(e){return parseFloat(e)||0}function f(n){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];return e.reduce(function(e,t){return e+h(n["border-"+t+"-width"])},0)}var y="undefined"!=typeof SVGGraphicsElement?function(e){return e instanceof l(e).SVGGraphicsElement}:function(e){return e instanceof l(e).SVGElement&&"function"==typeof e.getBBox};function g(e,t,n,r){return{x:e,y:t,width:n,height:r}}function m(e,t){var n,r,i,o,t=(n=t.x,r=t.y,i=t.width,o=t.height,t="undefined"!=typeof DOMRectReadOnly?DOMRectReadOnly:Object,t=Object.create(t.prototype),s(t,{x:n,y:r,width:i,height:o,top:r,right:n+i,bottom:o+r,left:n}),t);s(this,{target:e,contentRect:t})}function v(e){if(!(this instanceof v))throw new TypeError("Cannot call a class as a function.");if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");var t=o.getInstance(),t=new w(e,t,this);_.set(this,t)}var b=(k.prototype.isActive=function(){var e,t,e=(e=this.target,n?y(e)?g(0,0,(t=e.getBBox()).width,t.height):function(e){var t=e.clientWidth,n=e.clientHeight;if(!t&&!n)return c;var r=l(e).getComputedStyle(e),i=function(e){for(var t={},n=0,r=["top","right","bottom","left"];n<r.length;n++){var i=r[n],o=e["padding-"+i];t[i]=h(o)}return t}(r),o=i.left+i.right,s=i.top+i.bottom,a=h(r.width),u=h(r.height);return"border-box"===r.boxSizing&&(Math.round(a+o)!==t&&(a-=f(r,"left","right")+o),Math.round(u+s)!==n&&(u-=f(r,"top","bottom")+s)),e!==l(e).document.documentElement&&(t=Math.round(a+o)-t,n=Math.round(u+s)-n,1!==Math.abs(t)&&(a-=t),1!==Math.abs(n)&&(u-=n)),g(i.left,i.top,a,u)}(e):c);return(this.contentRect_=e).width!==this.broadcastWidth||e.height!==this.broadcastHeight},k.prototype.broadcastRect=function(){var e=this.contentRect_;return this.broadcastWidth=e.width,this.broadcastHeight=e.height,e},k),w=(S.prototype.observe=function(e){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if("undefined"!=typeof Element&&Element instanceof Object){if(!(e instanceof l(e).Element))throw new TypeError('parameter 1 is not of type "Element".');var t=this.observations_;t.has(e)||(t.set(e,new b(e)),this.controller_.addObserver(this),this.controller_.refresh())}},S.prototype.unobserve=function(e){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if("undefined"!=typeof Element&&Element instanceof Object){if(!(e instanceof l(e).Element))throw new TypeError('parameter 1 is not of type "Element".');var t=this.observations_;t.has(e)&&(t.delete(e),t.size||this.controller_.removeObserver(this))}},S.prototype.disconnect=function(){this.clearActive(),this.observations_.clear(),this.controller_.removeObserver(this)},S.prototype.gatherActive=function(){var t=this;this.clearActive(),this.observations_.forEach(function(e){e.isActive()&&t.activeObservations_.push(e)})},S.prototype.broadcastActive=function(){var e,t;this.hasActive()&&(e=this.callbackCtx_,t=this.activeObservations_.map(function(e){return new m(e.target,e.broadcastRect())}),this.callback_.call(e,t,e),this.clearActive())},S.prototype.clearActive=function(){this.activeObservations_.splice(0)},S.prototype.hasActive=function(){return 0<this.activeObservations_.length},S),_=new("undefined"!=typeof WeakMap?WeakMap:r);function S(e,t,n){if(this.activeObservations_=[],this.observations_=new r,"function"!=typeof e)throw new TypeError("The callback provided as parameter 1 is not a function.");this.callback_=e,this.controller_=t,this.callbackCtx_=n}function k(e){this.broadcastWidth=0,this.broadcastHeight=0,this.contentRect_=g(0,0,0,0),this.target=e}return["observe","unobserve","disconnect"].forEach(function(t){v.prototype[t]=function(){var e;return(e=_.get(this))[t].apply(e,arguments)}}),void 0!==t.ResizeObserver?t.ResizeObserver:v},"object"==typeof Hr.exports?Hr.exports=t():e.ResizeObserver=t()}.call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});var Hr=Hr.exports,Vr={};function Wr(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}!function(l){!function(){function v(){return n.Date.now()}var r=/^\s+|\s+$/g,i=/^[-+]0x[0-9a-f]+$/i,o=/^0b[01]+$/i,s=/^0o[0-7]+$/i,a=parseInt,e="object"==typeof l&&l&&l.Object===Object&&l,t="object"==typeof self&&self&&self.Object===Object&&self,n=e||t||Function("return this")(),u=Object.prototype.toString,b=Math.max,w=Math.min;function _(e){var t=typeof e;return e&&("object"==t||"function"==t)}function S(e){if("number"==typeof e)return e;if("symbol"==typeof(t=e)||t&&"object"==typeof t&&"[object Symbol]"==u.call(t))return NaN;var t;if("string"!=typeof(e=_(e)?_(n="function"==typeof e.valueOf?e.valueOf():e)?n+"":n:e))return 0===e?e:+e;e=e.replace(r,"");var n=o.test(e);return n||s.test(e)?a(e.slice(2),n?2:8):i.test(e)?NaN:+e}Vr=function(r,n,e){var i,o,s,a,u,l,c=0,p=!1,d=!1,t=!0;if("function"!=typeof r)throw new TypeError("Expected a function");function h(e){var t=i,n=o;return i=o=void 0,c=e,a=r.apply(n,t)}function f(e){var t=e-l;return void 0===l||n<=t||t<0||d&&s<=e-c}function y(){var e,t=v();if(f(t))return g(t);u=setTimeout(y,(e=n-(t-l),d?w(e,s-(t-c)):e))}function g(e){return u=void 0,t&&i?h(e):(i=o=void 0,a)}function m(){var e=v(),t=f(e);if(i=arguments,o=this,l=e,t){if(void 0===u)return c=t=l,u=setTimeout(y,n),p?h(t):a;if(d)return u=setTimeout(y,n),h(l)}return void 0===u&&(u=setTimeout(y,n)),a}return n=S(n)||0,_(e)&&(p=!!e.leading,s=(d="maxWait"in e)?b(S(e.maxWait)||0,n):s,t="trailing"in e?!!e.trailing:t),m.cancel=function(){void 0!==u&&clearTimeout(u),i=l=o=u=void(c=0)},m.flush=function(){return void 0===u?a:g(v())},m}}.call(this)}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});var Xr=function(n,r){var i;void 0===r&&(r=Wr);var o,s=[],a=!1;return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return a&&i===this&&r(e,s)||(o=n.apply(this,e),a=!0,i=this,s=e),o}};function Gr(){return(Gr=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,r=arguments[t];for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function Kr(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var $r=ie.h,Yr=Hr.default||Hr,Jr=Xr.default||Xr;function Qr(){var n={};return n.promise=new Promise(function(e,t){n.resolve=e,n.reject=t}),n}function Zr(){return $r("svg",{"aria-hidden":"true",focusable:"false",width:"30",height:"30",viewBox:"0 0 30 30"},$r("path",{d:"M15 30c8.284 0 15-6.716 15-15 0-8.284-6.716-15-15-15C6.716 0 0 6.716 0 15c0 8.284 6.716 15 15 15zm4.258-12.676v6.846h-8.426v-6.846H5.204l9.82-12.364 9.82 12.364H19.26z"}))}var ei,Le=(ds=ei=ue.Plugin,(Fi=ti).prototype=Object.create(ds.prototype),(Fi.prototype.constructor=Fi).__proto__=ds,ti.VERSION="1.13.1",ti);function ti(e,t){var w;(w=ei.call(this,e,t)||this).setOptions=function(e){ei.prototype.setOptions.call(Kr(w),e),w.i18nInit()},w.i18nInit=function(){w.translator=new C([w.defaultLocale,w.uppy.locale,w.opts.locale]),w.i18n=w.translator.translate.bind(w.translator),w.i18nArray=w.translator.translateArray.bind(w.translator),w.setPluginState()},w.removeTarget=function(t){var e=w.getPluginState().targets.filter(function(e){return e.id!==t.id});w.setPluginState({targets:e})},w.addTarget=function(e){var t=e.id||e.constructor.name,n=e.title||t,e=e.type;if("acquirer"===e||"progressindicator"===e||"editor"===e){n={id:t,name:n,type:e},e=w.getPluginState().targets.slice();return e.push(n),w.setPluginState({targets:e}),w.el}w.uppy.log("Dashboard: can only be targeted by plugins of types: acquirer, progressindicator, editor","error")},w.hideAllPanels=function(){var e={activePickerPanel:!1,showAddFilesPanel:!1,activeOverlayType:null,fileCardFor:null,showFileEditor:!1},t=w.getPluginState();t.activePickerPanel===e.activePickerPanel&&t.showAddFilesPanel===e.showAddFilesPanel&&t.showFileEditor===e.showFileEditor&&t.activeOverlayType===e.activeOverlayType||w.setPluginState(e)},w.showPanel=function(t){var e=w.getPluginState().targets.filter(function(e){return"acquirer"===e.type&&e.id===t})[0];w.setPluginState({activePickerPanel:e,activeOverlayType:"PickerPanel"})},w.canEditFile=function(t){var e=w.getPluginState().targets;return w._getEditors(e).some(function(e){return w.uppy.getPlugin(e.id).canEditFile(t)})},w.openFileEditor=function(t){var e=w.getPluginState().targets,e=w._getEditors(e);w.setPluginState({showFileEditor:!0,fileCardFor:t.id||null,activeOverlayType:"FileEditor"}),e.forEach(function(e){w.uppy.getPlugin(e.id).selectFile(t)})},w.openModal=function(){var e=Qr(),t=e.promise,n=e.resolve;return w.savedScrollPosition=window.pageYOffset,w.savedActiveElement=document.activeElement,w.opts.disablePageScrollWhenModalOpen&&document.body.classList.add("uppy-Dashboard-isFixed"),w.opts.animateOpenClose&&w.getPluginState().isClosing?w.el.addEventListener("animationend",function e(){w.setPluginState({isHidden:!1}),w.el.removeEventListener("animationend",e,!1),n()},!1):(w.setPluginState({isHidden:!1}),n()),w.opts.browserBackButtonClose&&w.updateBrowserHistory(),document.addEventListener("keydown",w.handleKeyDownInModal),w.uppy.emit("dashboard:modal-open"),t},w.closeModal=function(e){var t=(e=void 0===e?{}:e).manualClose,n=void 0===t||t,e=w.getPluginState(),t=e.isHidden,e=e.isClosing;if(!t&&!e){var t=Qr(),e=t.promise,r=t.resolve;return w.opts.disablePageScrollWhenModalOpen&&document.body.classList.remove("uppy-Dashboard-isFixed"),w.opts.animateOpenClose?(w.setPluginState({isClosing:!0}),w.el.addEventListener("animationend",function e(){w.setPluginState({isHidden:!0,isClosing:!1}),w.superFocus.cancel(),w.savedActiveElement.focus(),w.el.removeEventListener("animationend",e,!1),r()},!1)):(w.setPluginState({isHidden:!0}),w.superFocus.cancel(),w.savedActiveElement.focus(),r()),document.removeEventListener("keydown",w.handleKeyDownInModal),n&&w.opts.browserBackButtonClose&&history.state&&history.state[w.modalName]&&history.go(-1),w.uppy.emit("dashboard:modal-closed"),e}},w.isModalOpen=function(){return!w.getPluginState().isHidden||!1},w.requestCloseModal=function(){return w.opts.onRequestCloseModal?w.opts.onRequestCloseModal():w.closeModal()},w.setDarkModeCapability=function(e){var t=w.uppy.getState().capabilities;w.uppy.setState({capabilities:Gr({},t,{darkMode:e})})},w.handleSystemDarkModeChange=function(e){e=e.matches;w.uppy.log("[Dashboard] Dark mode is "+(e?"on":"off")),w.setDarkModeCapability(e)},w.toggleFileCard=function(e){e?w.uppy.emit("dashboard:file-edit-start"):w.uppy.emit("dashboard:file-edit-complete"),w.setPluginState({fileCardFor:e||null,activeOverlayType:e?"FileCard":null})},w.toggleAddFilesPanel=function(e){w.setPluginState({showAddFilesPanel:e,activeOverlayType:e?"AddFiles":null})},w.addFiles=function(e){e=e.map(function(e){return{source:w.id,name:e.name,type:e.type,data:e,meta:{relativePath:e.relativePath||null}}});try{w.uppy.addFiles(e)}catch(e){w.uppy.log(e)}},w.startListeningToResize=function(){w.resizeObserver=new Yr(function(e,t){var n=e[0].contentRect,e=n.width,n=n.height;w.uppy.log("[Dashboard] resized: "+e+" / "+n,"debug"),w.setPluginState({containerWidth:e,containerHeight:n,areInsidesReadyToBeVisible:!0})}),w.resizeObserver.observe(w.el.querySelector(".uppy-Dashboard-inner")),w.makeDashboardInsidesVisibleAnywayTimeout=setTimeout(function(){var e=w.getPluginState(),t=!w.opts.inline&&e.isHidden;e.areInsidesReadyToBeVisible||t||(w.uppy.log("[Dashboard] resize event didn't fire on time: defaulted to mobile layout","debug"),w.setPluginState({areInsidesReadyToBeVisible:!0}))},1e3)},w.stopListeningToResize=function(){w.resizeObserver.disconnect(),clearTimeout(w.makeDashboardInsidesVisibleAnywayTimeout)},w.recordIfFocusedOnUppyRecently=function(e){w.el.contains(e.target)?w.ifFocusedOnUppyRecently=!0:(w.ifFocusedOnUppyRecently=!1,w.superFocus.cancel())},w.updateBrowserHistory=function(){var e;history.state&&history.state[w.modalName]||history.pushState(Gr({},history.state,((e={})[w.modalName]=!0,e)),""),window.addEventListener("popstate",w.handlePopState,!1)},w.handlePopState=function(e){!w.isModalOpen()||e.state&&e.state[w.modalName]||w.closeModal({manualClose:!1}),!w.isModalOpen()&&e.state&&e.state[w.modalName]&&history.go(-1)},w.handleKeyDownInModal=function(e){var t,n;27===e.keyCode&&w.requestCloseModal(e),9===e.keyCode&&(t=e,n=w.getPluginState().activeOverlayType,e=w.el,qr(t,n,e))},w.handleClickOutside=function(){w.opts.closeModalOnClickOutside&&w.requestCloseModal()},w.handlePaste=function(t){w.uppy.iteratePlugins(function(e){"acquirer"===e.type&&e.handleRootPaste&&e.handleRootPaste(t)});var e=Mr(t.clipboardData.files);w.addFiles(e)},w.handleInputChange=function(e){e.preventDefault();e=Mr(e.target.files);w.addFiles(e)},w.handleDragOver=function(e){e.preventDefault(),e.stopPropagation(),e.dataTransfer.dropEffect="copy",clearTimeout(w.removeDragOverClassTimeout),w.setPluginState({isDraggingOver:!0})},w.handleDragLeave=function(e){e.preventDefault(),e.stopPropagation(),clearTimeout(w.removeDragOverClassTimeout),w.removeDragOverClassTimeout=setTimeout(function(){w.setPluginState({isDraggingOver:!1})},50)},w.handleDrop=function(t,e){t.preventDefault(),t.stopPropagation(),clearTimeout(w.removeDragOverClassTimeout),w.setPluginState({isDraggingOver:!1}),w.uppy.iteratePlugins(function(e){"acquirer"===e.type&&e.handleRootDrop&&e.handleRootDrop(t)});var n=!1;Ir(t.dataTransfer,{logDropError:function(e){w.uppy.log(e,"error"),n||(w.uppy.info(e.message,"error"),n=!0)}}).then(function(e){0<e.length&&(w.uppy.log("[Dashboard] Files were dropped"),w.addFiles(e))})},w.handleRequestThumbnail=function(e){w.opts.waitForThumbnailsBeforeUpload||w.uppy.emit("thumbnail:request",e)},w.handleCancelThumbnail=function(e){w.opts.waitForThumbnailsBeforeUpload||w.uppy.emit("thumbnail:cancel",e)},w.handleKeyDownInInline=function(e){var t,n;9===e.keyCode&&(t=e,n=w.getPluginState().activeOverlayType,e=w.el,null===n||qr(t,n,e))},w.handlePasteOnBody=function(e){w.el.contains(document.activeElement)&&w.handlePaste(e)},w.handleComplete=function(e){var t=e.failed;e.uploadID,w.opts.closeAfterFinish&&0===t.length&&w.requestCloseModal()},w.initEvents=function(){var e;w.opts.trigger&&!w.opts.inline&&((e=Br(w.opts.trigger))?e.forEach(function(e){return e.addEventListener("click",w.openModal)}):w.uppy.log("Dashboard modal trigger not found. Make sure `trigger` is set in Dashboard options, unless you are planning to call `dashboard.openModal()` method yourself","warning")),w.startListeningToResize(),document.addEventListener("paste",w.handlePasteOnBody),w.uppy.on("plugin-remove",w.removeTarget),w.uppy.on("file-added",w.hideAllPanels),w.uppy.on("dashboard:modal-closed",w.hideAllPanels),w.uppy.on("file-editor:complete",w.hideAllPanels),w.uppy.on("complete",w.handleComplete),document.addEventListener("focus",w.recordIfFocusedOnUppyRecently,!0),document.addEventListener("click",w.recordIfFocusedOnUppyRecently,!0),w.opts.inline&&w.el.addEventListener("keydown",w.handleKeyDownInInline)},w.removeEvents=function(){var e=Br(w.opts.trigger);!w.opts.inline&&e&&e.forEach(function(e){return e.removeEventListener("click",w.openModal)}),w.stopListeningToResize(),document.removeEventListener("paste",w.handlePasteOnBody),window.removeEventListener("popstate",w.handlePopState,!1),w.uppy.off("plugin-remove",w.removeTarget),w.uppy.off("file-added",w.hideAllPanels),w.uppy.off("dashboard:modal-closed",w.hideAllPanels),w.uppy.off("complete",w.handleComplete),document.removeEventListener("focus",w.recordIfFocusedOnUppyRecently),document.removeEventListener("click",w.recordIfFocusedOnUppyRecently),w.opts.inline&&w.el.removeEventListener("keydown",w.handleKeyDownInInline)},w.superFocusOnEachUpdate=function(){var e=w.el.contains(document.activeElement),t=document.activeElement===document.body||null===document.activeElement,n=w.uppy.getState().info.isHidden,r=!w.opts.inline;n&&(r||e||t&&w.ifFocusedOnUppyRecently)?w.superFocus(w.el,w.getPluginState().activeOverlayType):w.superFocus.cancel()},w.afterUpdate=function(){w.superFocusOnEachUpdate()},w.cancelUpload=function(e){w.uppy.removeFile(e)},w.saveFileCard=function(e,t){w.uppy.setFileMeta(t,e),w.toggleFileCard()},w._attachRenderFunctionToTarget=function(e){var t=w.uppy.getPlugin(e.id);return Gr({},e,{icon:t.icon||w.opts.defaultPickerIcon,render:t.render})},w._isTargetSupported=function(e){e=w.uppy.getPlugin(e.id);return"function"!=typeof e.isSupported||e.isSupported()},w._getAcquirers=Jr(function(e){return e.filter(function(e){return"acquirer"===e.type&&w._isTargetSupported(e)}).map(w._attachRenderFunctionToTarget)}),w._getProgressIndicators=Jr(function(e){return e.filter(function(e){return"progressindicator"===e.type}).map(w._attachRenderFunctionToTarget)}),w._getEditors=Jr(function(e){return e.filter(function(e){return"editor"===e.type}).map(w._attachRenderFunctionToTarget)}),w.render=function(e){var t=w.getPluginState(),n=e.files,r=e.capabilities,i=e.allowNewUpload,o=Object.keys(n).filter(function(e){return!n[e].progress.uploadStarted}),s=Object.keys(n).filter(function(e){return n[e].progress.uploadStarted}),a=Object.keys(n).filter(function(e){return n[e].isPaused}),u=Object.keys(n).filter(function(e){return n[e].progress.uploadComplete}),l=Object.keys(n).filter(function(e){return n[e].error}),c=Object.keys(n).filter(function(e){return!n[e].progress.uploadComplete&&n[e].progress.uploadStarted}),p=c.filter(function(e){return!n[e].isPaused}),d=Object.keys(n).filter(function(e){return n[e].progress.preprocess||n[e].progress.postprocess}),h=0<s.length,f=100===e.totalProgress&&u.length===Object.keys(n).length&&0===d.length,y=h&&l.length===s.length,g=0!==c.length&&a.length===c.length,m=w._getAcquirers(t.targets),v=w._getProgressIndicators(t.targets),b=w._getEditors(t.targets),a="auto"===w.opts.theme?r.darkMode?"dark":"light":w.opts.theme;return["files","folders","both"].indexOf(w.opts.fileManagerSelectionType)<0&&(w.opts.fileManagerSelectionType="files",console.error('Unsupported option for "fileManagerSelectionType". Using default of "'+w.opts.fileManagerSelectionType+'".')),function(t){var e=0===t.totalFileCount,n=576<t.containerWidth,r=Ye({"uppy-Root":t.isTargetDOMEl,"uppy-Dashboard":!0,"uppy-Dashboard--animateOpenClose":t.animateOpenClose,"uppy-Dashboard--isClosing":t.isClosing,"uppy-Dashboard--isDraggingOver":t.isDraggingOver,"uppy-Dashboard--modal":!t.inline,"uppy-size--md":576<t.containerWidth,"uppy-size--lg":700<t.containerWidth,"uppy-size--xl":900<t.containerWidth,"uppy-size--height-md":400<t.containerHeight,"uppy-Dashboard--isAddFilesPanelVisible":t.showAddFilesPanel,"uppy-Dashboard--isInnerWrapVisible":t.areInsidesReadyToBeVisible}),i=1;900<t.containerWidth?i=5:700<t.containerWidth?i=4:576<t.containerWidth&&(i=3);e=t.showSelectedFiles&&!e;return Jn("div",{class:r,"data-uppy-theme":t.theme,"data-uppy-num-acquirers":t.acquirers.length,"data-uppy-drag-drop-supported":qn(),"aria-hidden":t.inline?"false":t.isHidden,"aria-label":t.inline?t.i18n("dashboardTitle"):t.i18n("dashboardWindowTitle"),onpaste:t.handlePaste,onDragOver:t.handleDragOver,onDragLeave:t.handleDragLeave,onDrop:t.handleDrop},Jn("div",{class:"uppy-Dashboard-overlay",tabindex:-1,onclick:t.handleClickOutside}),Jn("div",{class:"uppy-Dashboard-inner","aria-modal":!t.inline&&"true",role:!t.inline&&"dialog",style:{width:t.inline&&t.width?t.width:"",height:t.inline&&t.height?t.height:""}},t.inline?null:Jn("button",{class:"uppy-u-reset uppy-Dashboard-close",type:"button","aria-label":t.i18n("closeModal"),title:t.i18n("closeModal"),onclick:t.closeModal},Jn("span",{"aria-hidden":"true"},"")),Jn("div",{class:"uppy-Dashboard-innerWrap"},Jn("div",{class:"uppy-Dashboard-dropFilesHereHint"},t.i18n("dropHint")),e&&Jn(Nn,t),e?Jn(wn,Yn({},t,{itemsPerRow:i})):Jn(An,Yn({},t,{isSizeMD:n})),Jn(Kn,null,t.showAddFilesPanel?Jn(_n,Yn({key:"AddFiles"},t,{isSizeMD:n})):null),Jn(Kn,null,t.fileCardFor?Jn(Wn,Yn({key:"FileCard"},t)):null),Jn(Kn,null,t.activePickerPanel?Jn(kn,Yn({key:"Picker"},t)):null),Jn(Kn,null,t.showFileEditor?Jn(Pn,Yn({key:"Editor"},t)):null),Jn("div",{class:"uppy-Dashboard-progressindicators"},t.progressindicators.map(function(e){return t.getPlugin(e.id).render(t.state)})))))}({state:e,isHidden:t.isHidden,files:n,newFiles:o,uploadStartedFiles:s,completeFiles:u,erroredFiles:l,inProgressFiles:c,inProgressNotPausedFiles:p,processingFiles:d,isUploadStarted:h,isAllComplete:f,isAllErrored:y,isAllPaused:g,totalFileCount:Object.keys(n).length,totalProgress:e.totalProgress,allowNewUpload:i,acquirers:m,theme:a,activePickerPanel:t.activePickerPanel,showFileEditor:t.showFileEditor,animateOpenClose:w.opts.animateOpenClose,isClosing:t.isClosing,getPlugin:w.uppy.getPlugin,progressindicators:v,editors:b,autoProceed:w.uppy.opts.autoProceed,id:w.id,closeModal:w.requestCloseModal,handleClickOutside:w.handleClickOutside,handleInputChange:w.handleInputChange,handlePaste:w.handlePaste,inline:w.opts.inline,showPanel:w.showPanel,hideAllPanels:w.hideAllPanels,log:w.uppy.log,i18n:w.i18n,i18nArray:w.i18nArray,removeFile:w.uppy.removeFile,uppy:w.uppy,info:w.uppy.info,note:w.opts.note,metaFields:t.metaFields,resumableUploads:r.resumableUploads||!1,individualCancellation:r.individualCancellation,isMobileDevice:r.isMobileDevice,pauseUpload:w.uppy.pauseResume,retryUpload:w.uppy.retryUpload,cancelUpload:w.cancelUpload,cancelAll:w.uppy.cancelAll,fileCardFor:t.fileCardFor,toggleFileCard:w.toggleFileCard,toggleAddFilesPanel:w.toggleAddFilesPanel,showAddFilesPanel:t.showAddFilesPanel,saveFileCard:w.saveFileCard,openFileEditor:w.openFileEditor,canEditFile:w.canEditFile,width:w.opts.width,height:w.opts.height,showLinkToFileUploadResult:w.opts.showLinkToFileUploadResult,fileManagerSelectionType:w.opts.fileManagerSelectionType,proudlyDisplayPoweredByUppy:w.opts.proudlyDisplayPoweredByUppy,hideCancelButton:w.opts.hideCancelButton,hideRetryButton:w.opts.hideRetryButton,hidePauseResumeButton:w.opts.hidePauseResumeButton,showRemoveButtonAfterComplete:w.opts.showRemoveButtonAfterComplete,containerWidth:t.containerWidth,containerHeight:t.containerHeight,areInsidesReadyToBeVisible:t.areInsidesReadyToBeVisible,isTargetDOMEl:w.isTargetDOMEl,parentElement:w.el,allowedFileTypes:w.uppy.opts.restrictions.allowedFileTypes,maxNumberOfFiles:w.uppy.opts.restrictions.maxNumberOfFiles,showSelectedFiles:w.opts.showSelectedFiles,handleRequestThumbnail:w.handleRequestThumbnail,handleCancelThumbnail:w.handleCancelThumbnail,isDraggingOver:t.isDraggingOver,handleDragOver:w.handleDragOver,handleDragLeave:w.handleDragLeave,handleDrop:w.handleDrop})},w.discoverProviderPlugins=function(){w.uppy.iteratePlugins(function(e){e&&!e.target&&e.opts&&e.opts.target===w.constructor&&w.addTarget(e)})},w.install=function(){w.setPluginState({isHidden:!0,fileCardFor:null,activeOverlayType:null,showAddFilesPanel:!1,activePickerPanel:!1,showFileEditor:!1,metaFields:w.opts.metaFields,targets:[],areInsidesReadyToBeVisible:!1,isDraggingOver:!1});var e=w.opts,t=e.inline,e=e.closeAfterFinish;if(t&&e)throw new Error("[Dashboard] `closeAfterFinish: true` cannot be used on an inline Dashboard, because an inline Dashboard cannot be closed at all. Either set `inline: false`, or disable the `closeAfterFinish` option.");w.uppy.opts.allowMultipleUploads&&e&&w.uppy.log("[Dashboard] When using `closeAfterFinish`, we recommended setting the `allowMultipleUploads` option to `false` in the Uppy constructor. See https://uppy.io/docs/uppy/#allowMultipleUploads-true","warning");e=w.opts.target;e&&w.mount(e,Kr(w)),(w.opts.plugins||[]).forEach(function(e){e=w.uppy.getPlugin(e);e&&e.mount(Kr(w),e)}),w.opts.disableStatusBar||w.uppy.use(gr,{id:w.id+":StatusBar",target:Kr(w),hideUploadButton:w.opts.hideUploadButton,hideRetryButton:w.opts.hideRetryButton,hidePauseResumeButton:w.opts.hidePauseResumeButton,hideCancelButton:w.opts.hideCancelButton,showProgressDetails:w.opts.showProgressDetails,hideAfterFinish:w.opts.hideProgressAfterFinish,locale:w.opts.locale,doneButtonHandler:w.opts.doneButtonHandler}),w.opts.disableInformer||w.uppy.use(Sr,{id:w.id+":Informer",target:Kr(w)}),w.opts.disableThumbnailGenerator||w.uppy.use(jr,{id:w.id+":ThumbnailGenerator",thumbnailWidth:w.opts.thumbnailWidth,thumbnailType:w.opts.thumbnailType,waitForThumbnailsBeforeUpload:w.opts.waitForThumbnailsBeforeUpload,lazy:!w.opts.waitForThumbnailsBeforeUpload}),w.darkModeMediaQuery="undefined"!=typeof window&&window.matchMedia?window.matchMedia("(prefers-color-scheme: dark)"):null;e=!!w.darkModeMediaQuery&&w.darkModeMediaQuery.matches;w.uppy.log("[Dashboard] Dark mode is "+(e?"on":"off")),w.setDarkModeCapability(e),"auto"===w.opts.theme&&w.darkModeMediaQuery.addListener(w.handleSystemDarkModeChange),w.discoverProviderPlugins(),w.initEvents()},w.uninstall=function(){var e,t;w.opts.disableInformer||(e=w.uppy.getPlugin(w.id+":Informer"))&&w.uppy.removePlugin(e),w.opts.disableStatusBar||(t=w.uppy.getPlugin(w.id+":StatusBar"))&&w.uppy.removePlugin(t),w.opts.disableThumbnailGenerator||(t=w.uppy.getPlugin(w.id+":ThumbnailGenerator"))&&w.uppy.removePlugin(t),(w.opts.plugins||[]).forEach(function(e){e=w.uppy.getPlugin(e);e&&e.unmount()}),"auto"===w.opts.theme&&w.darkModeMediaQuery.removeListener(w.handleSystemDarkModeChange),w.unmount(),w.removeEvents()},w.id=w.opts.id||"Dashboard",w.title="Dashboard",w.type="orchestrator",w.modalName="uppy-Dashboard-"+D();var r,e={target:"body",metaFields:[],trigger:"#uppy-select-files",inline:!(w.defaultLocale={strings:{closeModal:"Close Modal",importFrom:"Import from %{name}",addingMoreFiles:"Adding more files",addMoreFiles:"Add more files",dashboardWindowTitle:"File Uploader Window (Press escape to close)",dashboardTitle:"File Uploader",copyLinkToClipboardSuccess:"Link copied to clipboard",copyLinkToClipboardFallback:"Copy the URL below",copyLink:"Copy link",fileSource:"File source: %{name}",done:"Done",back:"Back",addMore:"Add more",removeFile:"Remove file",editFile:"Edit file",editing:"Editing %{file}",finishEditingFile:"Finish editing file",saveChanges:"Save changes",cancel:"Cancel",myDevice:"My Device",dropPasteFiles:"Drop files here, paste or %{browseFiles}",dropPasteFolders:"Drop files here, paste or %{browseFolders}",dropPasteBoth:"Drop files here, paste, %{browseFiles} or %{browseFolders}",dropPasteImportFiles:"Drop files here, paste, %{browseFiles} or import from:",dropPasteImportFolders:"Drop files here, paste, %{browseFolders} or import from:",dropPasteImportBoth:"Drop files here, paste, %{browseFiles}, %{browseFolders} or import from:",dropHint:"Drop your files here",browseFiles:"browse files",browseFolders:"browse folders",uploadComplete:"Upload complete",uploadPaused:"Upload paused",resumeUpload:"Resume upload",pauseUpload:"Pause upload",retryUpload:"Retry upload",cancelUpload:"Cancel upload",xFilesSelected:{0:"%{smart_count} file selected",1:"%{smart_count} files selected"},uploadingXFiles:{0:"Uploading %{smart_count} file",1:"Uploading %{smart_count} files"},processingXFiles:{0:"Processing %{smart_count} file",1:"Processing %{smart_count} files"},poweredBy2:"%{backwardsCompat} %{uppy}",poweredBy:"Powered by"}}),width:750,height:550,thumbnailWidth:280,thumbnailType:"image/jpeg",waitForThumbnailsBeforeUpload:!1,defaultPickerIcon:Zr,showLinkToFileUploadResult:!0,showProgressDetails:!1,hideUploadButton:!1,hideCancelButton:!1,hideRetryButton:!1,hidePauseResumeButton:!1,hideProgressAfterFinish:!1,doneButtonHandler:function(){w.uppy.reset(),w.requestCloseModal()},note:null,closeModalOnClickOutside:!1,closeAfterFinish:!1,disableStatusBar:!1,disableInformer:!1,disableThumbnailGenerator:!1,disablePageScrollWhenModalOpen:!0,animateOpenClose:!0,fileManagerSelectionType:"files",proudlyDisplayPoweredByUppy:!0,onRequestCloseModal:function(){return w.closeModal()},showSelectedFiles:!0,showRemoveButtonAfterComplete:!1,browserBackButtonClose:!1,theme:"light"};return w.opts=Gr({},e,t),w.i18nInit(),w.superFocus=(r=!1,Vr(function(e,t){var n=Lr(e,t),e=n.contains(document.activeElement);e&&r||(t=n.querySelector("[data-uppy-super-focusable]"),e&&!t||(r=t?(t.focus({preventScroll:!0}),!0):((n=n.querySelector(Nr))&&n.focus({preventScroll:!0}),!1)))},260)),w.ifFocusedOnUppyRecently=!1,w.makeDashboardInsidesVisibleAnywayTimeout=null,w.removeDragOverClassTimeout=null,w}function ni(){return(ni=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,r=arguments[t];for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function ri(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var ii=ie.h,oi=(Ri=Ss=function(n){var e;function t(e,t){return(e=n.call(this,e,t)||this).type="acquirer",e.id=e.opts.id||"DragDrop",e.title="Drag & Drop",e.defaultLocale={strings:{dropHereOr:"Drop files here or %{browse}",browse:"browse"}},e.opts=ni({},{target:null,inputName:"files[]",width:"100%",height:"100%",note:null},t),e.isDragDropSupported=qn(),e.removeDragOverClassTimeout=null,e.i18nInit(),e.onInputChange=e.onInputChange.bind(ri(e)),e.handleDragOver=e.handleDragOver.bind(ri(e)),e.handleDragLeave=e.handleDragLeave.bind(ri(e)),e.handleDrop=e.handleDrop.bind(ri(e)),e.addFiles=e.addFiles.bind(ri(e)),e.render=e.render.bind(ri(e)),e}r=n,(e=t).prototype=Object.create(r.prototype),(e.prototype.constructor=e).__proto__=r;var r=t.prototype;return r.setOptions=function(e){n.prototype.setOptions.call(this,e),this.i18nInit()},r.i18nInit=function(){this.translator=new C([this.defaultLocale,this.uppy.locale,this.opts.locale]),this.i18n=this.translator.translate.bind(this.translator),this.i18nArray=this.translator.translateArray.bind(this.translator),this.setPluginState()},r.addFiles=function(e){var t=this,e=e.map(function(e){return{source:t.id,name:e.name,type:e.type,data:e,meta:{relativePath:e.relativePath||null}}});try{this.uppy.addFiles(e)}catch(e){this.uppy.log(e)}},r.onInputChange=function(e){this.uppy.log("[DragDrop] Files selected through input");var t=Mr(e.target.files);this.addFiles(t),e.target.value=null},r.handleDrop=function(e,t){var n=this;e.preventDefault(),e.stopPropagation(),clearTimeout(this.removeDragOverClassTimeout),this.setPluginState({isDraggingOver:!1}),this.uppy.log("[DragDrop] Files were dropped"),Ir(e.dataTransfer,{logDropError:function(e){n.uppy.log(e,"error")}}).then(function(e){return n.addFiles(e)})},r.handleDragOver=function(e){e.preventDefault(),e.stopPropagation(),e.dataTransfer.dropEffect="copy",clearTimeout(this.removeDragOverClassTimeout),this.setPluginState({isDraggingOver:!0})},r.handleDragLeave=function(e){var t=this;e.preventDefault(),e.stopPropagation(),clearTimeout(this.removeDragOverClassTimeout),this.removeDragOverClassTimeout=setTimeout(function(){t.setPluginState({isDraggingOver:!1})},50)},r.renderHiddenFileInput=function(){var t=this,e=this.uppy.opts.restrictions;return ii("input",{class:"uppy-DragDrop-input",type:"file",hidden:!0,ref:function(e){t.fileInputRef=e},name:this.opts.inputName,multiple:1!==e.maxNumberOfFiles,accept:e.allowedFileTypes,onchange:this.onInputChange})},r.renderArrowSvg=function(){return ii("svg",{"aria-hidden":"true",focusable:"false",class:"uppy-c-icon uppy-DragDrop-arrow",width:"16",height:"16",viewBox:"0 0 16 16"},ii("path",{d:"M11 10V0H5v10H2l6 6 6-6h-3zm0 0","fill-rule":"evenodd"}))},r.renderLabel=function(){return ii("div",{class:"uppy-DragDrop-label"},this.i18nArray("dropHereOr",{browse:ii("span",{class:"uppy-DragDrop-browse"},this.i18n("browse"))}))},r.renderNote=function(){return ii("span",{class:"uppy-DragDrop-note"},this.opts.note)},r.render=function(e){var t=this,n="uppy-Root\n      uppy-u-reset\n      uppy-DragDrop-container\n      "+(this.isDragDropSupported?"uppy-DragDrop--isDragDropSupported":"")+"\n      "+(this.getPluginState().isDraggingOver?"uppy-DragDrop--isDraggingOver":"")+"\n    ",r={width:this.opts.width,height:this.opts.height};return ii("button",{type:"button",class:n,style:r,onClick:function(){return t.fileInputRef.click()},onDragOver:this.handleDragOver,onDragLeave:this.handleDragLeave,onDrop:this.handleDrop},this.renderHiddenFileInput(),ii("div",{class:"uppy-DragDrop-inner"},this.renderArrowSvg(),this.renderLabel(),this.renderNote()))},r.install=function(){this.setPluginState({isDraggingOver:!1});var e=this.opts.target;e&&this.mount(e,this)},r.uninstall=function(){this.unmount()},t}(ue.Plugin),Ss.VERSION="1.4.21",Ri);function si(){return(si=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,r=arguments[t];for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function ai(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var ui=ie.h,b=(o=e=function(n){var e;function t(e,t){return(e=n.call(this,e,t)||this).id=e.opts.id||"FileInput",e.title="File Input",e.type="acquirer",e.defaultLocale={strings:{chooseFiles:"Choose files"}},e.opts=si({},{target:null,pretty:!0,inputName:"files[]"},t),e.i18nInit(),e.render=e.render.bind(ai(e)),e.handleInputChange=e.handleInputChange.bind(ai(e)),e.handleClick=e.handleClick.bind(ai(e)),e}r=n,(e=t).prototype=Object.create(r.prototype),(e.prototype.constructor=e).__proto__=r;var r=t.prototype;return r.setOptions=function(e){n.prototype.setOptions.call(this,e),this.i18nInit()},r.i18nInit=function(){this.translator=new C([this.defaultLocale,this.uppy.locale,this.opts.locale]),this.i18n=this.translator.translate.bind(this.translator),this.i18nArray=this.translator.translateArray.bind(this.translator),this.setPluginState()},r.addFiles=function(e){var t=this,e=e.map(function(e){return{source:t.id,name:e.name,type:e.type,data:e}});try{this.uppy.addFiles(e)}catch(e){this.uppy.log(e)}},r.handleInputChange=function(e){this.uppy.log("[FileInput] Something selected through input...");var t=Mr(e.target.files);this.addFiles(t),e.target.value=null},r.handleClick=function(e){this.input.click()},r.render=function(e){var t=this,n=this.uppy.opts.restrictions,r=n.allowedFileTypes?n.allowedFileTypes.join(","):null;return ui("div",{class:"uppy-Root uppy-FileInput-container"},ui("input",{class:"uppy-FileInput-input",style:this.opts.pretty&&{width:"0.1px",height:"0.1px",opacity:0,overflow:"hidden",position:"absolute",zIndex:-1},type:"file",name:this.opts.inputName,onchange:this.handleInputChange,multiple:1!==n.maxNumberOfFiles,accept:r,ref:function(e){t.input=e}}),this.opts.pretty&&ui("button",{class:"uppy-FileInput-btn",type:"button",onclick:this.handleClick},this.i18n("chooseFiles")))},r.install=function(){var e=this.opts.target;e&&this.mount(e,this)},r.uninstall=function(){this.unmount()},t}(ue.Plugin),e.VERSION="1.4.19",o);function li(){return(li=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,r=arguments[t];for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}var ci=ie.h,yn=(A=_=function(n){var e;function t(e,t){return(e=n.call(this,e,t)||this).id=e.opts.id||"ProgressBar",e.title="Progress Bar",e.type="progressindicator",e.opts=li({},{target:"body",replaceTargetContent:!1,fixed:!1,hideAfterFinish:!0},t),e.render=e.render.bind(function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)),e}r=n,(e=t).prototype=Object.create(r.prototype),(e.prototype.constructor=e).__proto__=r;var r=t.prototype;return r.render=function(e){var t=e.totalProgress||0,e=(0===t||100===t)&&this.opts.hideAfterFinish;return ci("div",{class:"uppy uppy-ProgressBar",style:{position:this.opts.fixed?"fixed":"initial"},"aria-hidden":e},ci("div",{class:"uppy-ProgressBar-inner",style:{width:t+"%"}}),ci("div",{class:"uppy-ProgressBar-percentage"},t))},r.install=function(){var e=this.opts.target;e&&this.mount(e,this)},r.uninstall=function(){this.unmount()},t}(ue.Plugin),_.VERSION="1.3.21",A);function pi(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var di,hi=We.Provider,fi=Mt.ProviderViews,yi=ie.h,re=(Ni=ne=function(r){var e;function t(e,t){var n;return(n=r.call(this,e,t)||this).id=n.opts.id||"Dropbox",hi.initPlugin(pi(n),t),n.title=n.opts.title||"Dropbox",n.icon=function(){return yi("svg",{"aria-hidden":"true",focusable:"false",width:"32",height:"32",viewBox:"0 0 32 32"},yi("g",{fill:"none","fill-rule":"evenodd"},yi("rect",{fill:"#0D2481",width:"32",height:"32",rx:"16"}),yi("path",{d:"M11 8l5 3.185-5 3.186-5-3.186L11 8zm10 0l5 3.185-5 3.186-5-3.186L21 8zM6 17.556l5-3.185 5 3.185-5 3.186-5-3.186zm15-3.185l5 3.185-5 3.186-5-3.186 5-3.185zm-10 7.432l5-3.185 5 3.185-5 3.186-5-3.186z",fill:"#FFF","fill-rule":"nonzero"})))},n.provider=new hi(e,{companionUrl:n.opts.companionUrl,companionHeaders:n.opts.companionHeaders||n.opts.serverHeaders,provider:"dropbox",pluginId:n.id}),n.onFirstRender=n.onFirstRender.bind(pi(n)),n.render=n.render.bind(pi(n)),n}n=r,(e=t).prototype=Object.create(n.prototype),(e.prototype.constructor=e).__proto__=n;var n=t.prototype;return n.install=function(){this.view=new fi(this,{provider:this.provider});var e=this.opts.target;e&&this.mount(e,this)},n.uninstall=function(){this.view.tearDown(),this.unmount()},n.onFirstRender=function(){return this.view.getFolder()},n.render=function(e){return this.view.render(e)},t}(ue.Plugin),ne.VERSION="1.4.19",Ni),gi=(ha=di=Mt.ProviderViews,(pa=mi).prototype=Object.create(ha.prototype),(pa.prototype.constructor=pa).__proto__=ha,mi.prototype.toggleCheckbox=function(e,t){e.stopPropagation(),e.preventDefault(),t.custom.isTeamDrive||t.custom.isSharedDrive||di.prototype.toggleCheckbox.call(this,e,t)},mi);function mi(){return di.apply(this,arguments)||this}function vi(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var bi=We.Provider,wi=ie.h,_i=(Ls=le=function(r){var e;function t(e,t){var n;return(n=r.call(this,e,t)||this).id=n.opts.id||"GoogleDrive",n.title=n.opts.title||"Google Drive",bi.initPlugin(vi(n),t),n.title=n.opts.title||"Google Drive",n.icon=function(){return wi("svg",{"aria-hidden":"true",focusable:"false",width:"32",height:"32",viewBox:"0 0 32 32"},wi("g",{fill:"none","fill-rule":"evenodd"},wi("rect",{fill:"#4285F4",width:"32",height:"32",rx:"16"}),wi("path",{d:"M10.324 23.3l3-5.1H25l-3 5.1H10.324zM13 18.2l-3 5.1-3-5.1 5.839-9.924 2.999 5.1L13 18.2zm11.838-.276h-6L13 8h6l5.84 9.924h-.002z",fill:"#FFF"})))},n.provider=new bi(e,{companionUrl:n.opts.companionUrl,companionHeaders:n.opts.companionHeaders||n.opts.serverHeaders,provider:"drive",pluginId:n.id}),n.onFirstRender=n.onFirstRender.bind(vi(n)),n.render=n.render.bind(vi(n)),n}n=r,(e=t).prototype=Object.create(n.prototype),(e.prototype.constructor=e).__proto__=n;var n=t.prototype;return n.install=function(){this.view=new gi(this,{provider:this.provider});var e=this.opts.target;e&&this.mount(e,this)},n.uninstall=function(){this.view.tearDown(),this.unmount()},n.onFirstRender=function(){return this.view.getFolder("root","/")},n.render=function(e){return this.view.render(e)},t}(ue.Plugin),le.VERSION="1.5.19",Ls);function Si(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var ki=We.Provider,Pi=Mt.ProviderViews,Ci=ie.h,Fi=(Xr=ps=function(r){var e;function t(e,t){var n;return(n=r.call(this,e,t)||this).id=n.opts.id||"Instagram",ki.initPlugin(Si(n),t),n.title=n.opts.title||"Instagram",n.icon=function(){return Ci("svg",{"aria-hidden":"true",focusable:"false",width:"32",height:"32",viewBox:"0 0 32 32"},Ci("g",{fill:"none","fill-rule":"evenodd"},Ci("rect",{fill:"#E1306C",width:"32",height:"32",rx:"16"}),Ci("path",{d:"M16 8.622c2.403 0 2.688.009 3.637.052.877.04 1.354.187 1.67.31.392.144.745.374 1.036.673.299.29.529.644.673 1.035.123.317.27.794.31 1.671.043.95.052 1.234.052 3.637s-.009 2.688-.052 3.637c-.04.877-.187 1.354-.31 1.671a2.98 2.98 0 0 1-1.708 1.708c-.317.123-.794.27-1.671.31-.95.043-1.234.053-3.637.053s-2.688-.01-3.637-.053c-.877-.04-1.354-.187-1.671-.31a2.788 2.788 0 0 1-1.035-.673 2.788 2.788 0 0 1-.673-1.035c-.123-.317-.27-.794-.31-1.671-.043-.949-.052-1.234-.052-3.637s.009-2.688.052-3.637c.04-.877.187-1.354.31-1.67.144-.392.374-.745.673-1.036.29-.299.644-.529 1.035-.673.317-.123.794-.27 1.671-.31.95-.043 1.234-.052 3.637-.052zM16 7c-2.444 0-2.75.01-3.71.054-.959.044-1.613.196-2.185.419-.6.225-1.145.58-1.594 1.038-.458.45-.813.993-1.039 1.594-.222.572-.374 1.226-.418 2.184C7.01 13.25 7 13.556 7 16s.01 2.75.054 3.71c.044.959.196 1.613.419 2.185.226.6.58 1.145 1.038 1.594.45.458.993.813 1.594 1.038.572.223 1.227.375 2.184.419.96.044 1.267.054 3.711.054s2.75-.01 3.71-.054c.959-.044 1.613-.196 2.185-.419a4.602 4.602 0 0 0 2.632-2.632c.223-.572.375-1.226.419-2.184.044-.96.054-1.267.054-3.711s-.01-2.75-.054-3.71c-.044-.959-.196-1.613-.419-2.185A4.412 4.412 0 0 0 23.49 8.51a4.412 4.412 0 0 0-1.594-1.039c-.572-.222-1.226-.374-2.184-.418C18.75 7.01 18.444 7 16 7zm0 4.5a4.5 4.5 0 1 0 0 9 4.5 4.5 0 0 0 0-9zm0 7.421a2.921 2.921 0 1 1 0-5.842 2.921 2.921 0 0 1 0 5.842zm4.875-6.671a1.125 1.125 0 1 1 0-2.25 1.125 1.125 0 0 1 0 2.25z",fill:"#FFF"})))},n.provider=new ki(e,{companionUrl:n.opts.companionUrl,companionHeaders:n.opts.companionHeaders||n.opts.serverHeaders,provider:"instagram",pluginId:n.id}),n.onFirstRender=n.onFirstRender.bind(Si(n)),n.render=n.render.bind(Si(n)),n}n=r,(e=t).prototype=Object.create(n.prototype),(e.prototype.constructor=e).__proto__=n;var n=t.prototype;return n.install=function(){this.view=new Pi(this,{provider:this.provider,viewType:"grid",showTitles:!1,showFilter:!1,showBreadcrumbs:!1});var e=this.opts.target;e&&this.mount(e,this)},n.uninstall=function(){this.view.tearDown(),this.unmount()},n.onFirstRender=function(){this.view.getFolder("recent")},n.render=function(e){return this.view.render(e)},t}(ue.Plugin),ps.VERSION="1.4.19",Xr);function Ai(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var Ei=We.Provider,Oi=Mt.ProviderViews,Ui=ie.h,Ri=(Ss=ds=function(r){var e;function t(e,t){var n;return(n=r.call(this,e,t)||this).id=n.opts.id||"OneDrive",Ei.initPlugin(Ai(n),t),n.title=n.opts.title||"OneDrive",n.icon=function(){return Ui("svg",{"aria-hidden":"true",focusable:"false",width:"32",height:"32",viewBox:"0 0 32 32"},Ui("g",{fill:"none","fill-rule":"evenodd"},Ui("rect",{width:"32",height:"32",rx:"16",fill:"#0262C0"}),Ui("g",{fill:"#FFF","fill-rule":"nonzero"},Ui("path",{d:"M24.157 22s1.492-.205 1.79-1.655a2.624 2.624 0 0 0 .03-.878c-.22-1.64-1.988-2.01-1.988-2.01s.307-1.765-1.312-2.69c-1.62-.925-3.1 0-3.1 0S18.711 13 16.366 13c-3.016 0-3.519 3.448-3.519 3.448S10 16.618 10 19.14c0 2.523 2.597 2.86 2.597 2.86h11.56z"}),Ui("path",{d:"M9.421 19.246c0-2.197 1.606-3.159 2.871-3.472.44-1.477 1.654-3.439 4.135-3.439H16.445c1.721 0 2.79.823 3.368 1.476a3.99 3.99 0 0 1 1.147-.171h.01l.03.002C21.017 13.5 20.691 10 16.757 10c-2.69 0-3.639 2.345-3.639 2.345s-1.95-1.482-3.955.567c-1.028 1.052-.79 2.669-.79 2.669S6 15.824 6 18.412C6 20.757 8.452 21 8.452 21h1.372a3.77 3.77 0 0 1-.403-1.754z"}))))},n.provider=new Ei(e,{companionUrl:n.opts.companionUrl,companionHeaders:n.opts.companionHeaders||n.opts.serverHeaders,provider:"onedrive",pluginId:n.id}),n.onFirstRender=n.onFirstRender.bind(Ai(n)),n.render=n.render.bind(Ai(n)),n}n=r,(e=t).prototype=Object.create(n.prototype),(e.prototype.constructor=e).__proto__=n;var n=t.prototype;return n.install=function(){this.view=new Oi(this,{provider:this.provider});var e=this.opts.target;e&&this.mount(e,this)},n.uninstall=function(){this.view.tearDown(),this.unmount()},n.onFirstRender=function(){return this.view.getFolder()},n.render=function(e){return this.view.render(e)},t}(ue.Plugin),ds.VERSION="1.1.19",Ss);function Ti(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var xi=We.Provider,Di=Mt.ProviderViews,Bi=ie.h,_=(o=e=function(r){var e;function t(e,t){var n;return(n=r.call(this,e,t)||this).id=n.opts.id||"Facebook",xi.initPlugin(Ti(n),t),n.title=n.opts.title||"Facebook",n.icon=function(){return Bi("svg",{"aria-hidden":"true",focusable:"false",width:"32",height:"32",viewBox:"0 0 32 32"},Bi("g",{fill:"none","fill-rule":"evenodd"},Bi("rect",{width:"32",height:"32",rx:"16",fill:"#3C5A99"}),Bi("path",{d:"M17.842 26v-8.667h2.653l.398-3.377h-3.051v-2.157c0-.978.248-1.644 1.527-1.644H21V7.132A19.914 19.914 0 0 0 18.623 7c-2.352 0-3.963 1.574-3.963 4.465v2.49H12v3.378h2.66V26h3.182z",fill:"#FFF","fill-rule":"nonzero"})))},n.provider=new xi(e,{companionUrl:n.opts.companionUrl,companionHeaders:n.opts.companionHeaders||n.opts.serverHeaders,provider:"facebook",pluginId:n.id}),n.onFirstRender=n.onFirstRender.bind(Ti(n)),n.render=n.render.bind(Ti(n)),n}n=r,(e=t).prototype=Object.create(n.prototype),(e.prototype.constructor=e).__proto__=n;var n=t.prototype;return n.install=function(){this.view=new Di(this,{provider:this.provider});var e=this.opts.target;e&&this.mount(e,this)},n.uninstall=function(){this.view.tearDown(),this.unmount()},n.onFirstRender=function(){return this.view.getFolder()},n.render=function(e){var t={};return this.getPluginState().files.length&&!this.getPluginState().folders.length&&(t.viewType="grid",t.showFilter=!1,t.showTitles=!1),this.view.render(e,t)},t}(ue.Plugin),e.VERSION="1.1.19",o);function Ii(){return(Ii=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,r=arguments[t];for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}var ji=ie.h,Mi=We.SearchProvider,Li=Mt.SearchProviderViews,Ni=(ne=A=function(r){var e;function t(e,t){var n;if((n=r.call(this,e,t)||this).id=n.opts.id||"Unsplash",n.title=n.opts.title||"Unsplash",n.type="acquirer",n.icon=function(){return ji("svg",{viewBox:"0 0 32 32",height:"32",width:"32","aria-hidden":"true"},ji("path",{d:"M46.575 10.883v-9h12v9zm12 5h10v18h-32v-18h10v9h12z",fill:"#fff"}),ji("rect",{width:"32",height:"32",rx:"16"}),ji("path",{d:"M13 12.5V8h6v4.5zm6 2.5h5v9H8v-9h5v4.5h6z",fill:"#fff"}))},n.opts=Ii({},{},t),n.hostname=n.opts.companionUrl,!n.hostname)throw new Error("Companion hostname is required, please consult https://uppy.io/docs/companion");return n.provider=new Mi(e,{companionUrl:n.opts.companionUrl,companionHeaders:n.opts.companionHeaders,provider:"unsplash",pluginId:n.id}),n}n=r,(e=t).prototype=Object.create(n.prototype),(e.prototype.constructor=e).__proto__=n;var n=t.prototype;return n.install=function(){this.view=new Li(this,{provider:this.provider});var e=this.opts.target;e&&this.mount(e,this)},n.onFirstRender=function(){},n.render=function(e){return this.view.render(e)},n.uninstall=function(){this.unmount()},t}(ue.Plugin),A.VERSION="0.1.3",ne);function zi(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function qi(e,t,n){var r,i=Mr(e.items);switch(t){case"paste":if(i.some(function(e){return"file"===e.kind}))return;r=i.filter(function(e){return"string"===e.kind&&"text/plain"===e.type});break;case"drop":r=i.filter(function(e){return"string"===e.kind&&"text/uri-list"===e.type});break;default:throw new Error("isDropOrPaste must be either 'drop' or 'paste', but it's "+t)}r.forEach(function(e){e.getAsString(function(e){return n(e)})})}var Hi=ie.h,Vi=function(t){var e;function n(e){return(e=t.call(this,e)||this).handleKeyPress=e.handleKeyPress.bind(zi(e)),e.handleClick=e.handleClick.bind(zi(e)),e}r=t,(e=n).prototype=Object.create(r.prototype),(e.prototype.constructor=e).__proto__=r;var r=n.prototype;return r.componentDidMount=function(){this.input.value=""},r.handleKeyPress=function(e){13===e.keyCode&&this.props.addFile(this.input.value)},r.handleClick=function(){this.props.addFile(this.input.value)},r.render=function(){var t=this;return Hi("div",{class:"uppy-Url"},Hi("input",{class:"uppy-u-reset uppy-c-textInput uppy-Url-input",type:"text","aria-label":this.props.i18n("enterUrlToImport"),placeholder:this.props.i18n("enterUrlToImport"),onkeyup:this.handleKeyPress,ref:function(e){t.input=e},"data-uppy-super-focusable":!0}),Hi("button",{class:"uppy-u-reset uppy-c-btn uppy-c-btn-primary uppy-Url-importButton",type:"button",onclick:this.handleClick},this.props.i18n("import")))},n}(ie.Component);function Wi(){return(Wi=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,r=arguments[t];for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function Xi(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var Gi=ie.h,Ki=We.RequestClient;function $i(){return Gi("svg",{"aria-hidden":"true",focusable:"false",width:"32",height:"32",viewBox:"0 0 32 32"},Gi("g",{fill:"none","fill-rule":"evenodd"},Gi("rect",{fill:"#FF753E",width:"32",height:"32",rx:"16"}),Gi("path",{d:"M22.788 15.389l-2.199 2.19a3.184 3.184 0 0 1-.513.437c-.806.584-1.686.876-2.638.876a4.378 4.378 0 0 1-3.519-1.752c-.22-.292-.146-.802.147-1.021.293-.22.806-.146 1.026.146.953 1.313 2.785 1.532 4.105.583a.571.571 0 0 0 .293-.292l2.199-2.189c1.1-1.167 1.1-2.992-.073-4.086a2.976 2.976 0 0 0-4.105 0l-1.246 1.24a.71.71 0 0 1-1.026 0 .703.703 0 0 1 0-1.022l1.246-1.24a4.305 4.305 0 0 1 6.083 0c1.833 1.605 1.906 4.451.22 6.13zm-7.183 5.035l-1.246 1.24a2.976 2.976 0 0 1-4.105 0c-1.172-1.094-1.172-2.991-.073-4.086l2.2-2.19.292-.291c.66-.438 1.393-.657 2.2-.584.805.146 1.465.51 1.905 1.168.22.292.733.365 1.026.146.293-.22.367-.73.147-1.022-.733-.949-1.76-1.532-2.859-1.678-1.1-.22-2.272.073-3.225.802l-.44.438-2.199 2.19c-1.686 1.75-1.612 4.524.074 6.202.88.803 1.979 1.241 3.078 1.241 1.1 0 2.199-.438 3.079-1.24l1.246-1.241a.703.703 0 0 0 0-1.022c-.294-.292-.807-.365-1.1-.073z",fill:"#FFF","fill-rule":"nonzero"})))}function Yi(e){return e=e.replace(/;.*$/,""),Qi[e]||null}function Ji(e){return Zi("svg",{"aria-hidden":"true",focusable:"false",fill:"#0097DC",width:"66",height:"55",viewBox:"0 0 66 55"},Zi("path",{d:"M57.3 8.433c4.59 0 8.1 3.51 8.1 8.1v29.7c0 4.59-3.51 8.1-8.1 8.1H8.7c-4.59 0-8.1-3.51-8.1-8.1v-29.7c0-4.59 3.51-8.1 8.1-8.1h9.45l4.59-7.02c.54-.54 1.35-1.08 2.16-1.08h16.2c.81 0 1.62.54 2.16 1.08l4.59 7.02h9.45zM33 14.64c-8.62 0-15.393 6.773-15.393 15.393 0 8.62 6.773 15.393 15.393 15.393 8.62 0 15.393-6.773 15.393-15.393 0-8.62-6.773-15.393-15.393-15.393zM33 40c-5.648 0-9.966-4.319-9.966-9.967 0-5.647 4.318-9.966 9.966-9.966s9.966 4.319 9.966 9.966C42.966 35.681 38.648 40 33 40z","fill-rule":"evenodd"}))}var le=(ha=pa=function(r){var e;function t(e,t){var n;if((n=r.call(this,e,t)||this).id=n.opts.id||"Url",n.title=n.opts.title||"Link",n.type="acquirer",n.icon=function(){return Gi($i,null)},n.defaultLocale={strings:{import:"Import",enterUrlToImport:"Enter URL to import a file",failedToFetch:"Companion failed to fetch this URL, please make sure its correct",enterCorrectUrl:"Incorrect URL: Please make sure you are entering a direct link to a file"}},n.opts=Wi({},{},t),n.i18nInit(),n.hostname=n.opts.companionUrl,!n.hostname)throw new Error("Companion hostname is required, please consult https://uppy.io/docs/companion");return n.getMeta=n.getMeta.bind(Xi(n)),n.addFile=n.addFile.bind(Xi(n)),n.handleRootDrop=n.handleRootDrop.bind(Xi(n)),n.handleRootPaste=n.handleRootPaste.bind(Xi(n)),n.client=new Ki(e,{companionUrl:n.opts.companionUrl,companionHeaders:n.opts.companionHeaders||n.opts.serverHeaders}),n}n=r,(e=t).prototype=Object.create(n.prototype),(e.prototype.constructor=e).__proto__=n;var n=t.prototype;return n.setOptions=function(e){r.prototype.setOptions.call(this,e),this.i18nInit()},n.i18nInit=function(){this.translator=new C([this.defaultLocale,this.uppy.locale,this.opts.locale]),this.i18n=this.translator.translate.bind(this.translator),this.i18nArray=this.translator.translateArray.bind(this.translator),this.setPluginState()},n.getFileNameFromUrl=function(e){return e.substring(e.lastIndexOf("/")+1)},n.checkIfCorrectURL=function(e){if(!e)return!1;e=e.match(/^([a-z0-9]+):\/\//)[1];return"http"===e||"https"===e},n.addProtocolToURL=function(e){return/^[a-z0-9]+:\/\//.test(e)?e:"http://"+e},n.getMeta=function(e){var t=this;return this.client.post("url/meta",{url:e}).then(function(e){if(e.error)throw t.uppy.log("[URL] Error:"),t.uppy.log(e.error),new Error("Failed to fetch the file");return e})},n.addFile=function(t){var n=this;return t=this.addProtocolToURL(t),this.checkIfCorrectURL(t)?this.getMeta(t).then(function(e){return{source:n.id,name:n.getFileNameFromUrl(t),type:e.type,data:{size:e.size},isRemote:!0,body:{url:t},remote:{companionUrl:n.opts.companionUrl,url:n.hostname+"/url/get",body:{fileId:t,url:t},providerOptions:n.client.opts}}}).then(function(e){n.uppy.log("[Url] Adding remote file");try{n.uppy.addFile(e)}catch(e){e.isRestriction||n.uppy.log(e)}}).catch(function(e){n.uppy.log(e),n.uppy.info({message:n.i18n("failedToFetch"),details:e},"error",4e3)}):(this.uppy.log("[URL] Incorrect URL entered: "+t),void this.uppy.info(this.i18n("enterCorrectUrl"),"error",4e3))},n.handleRootDrop=function(e){var t=this;qi(e.dataTransfer,"drop",function(e){t.uppy.log("[URL] Adding file from dropped url: "+e),t.addFile(e)})},n.handleRootPaste=function(e){var t=this;qi(e.clipboardData,"paste",function(e){t.uppy.log("[URL] Adding file from pasted url: "+e),t.addFile(e)})},n.render=function(e){return Gi(Vi,{i18n:this.i18n,addFile:this.addFile})},n.install=function(){var e=this.opts.target;e&&this.mount(e,this)},n.uninstall=function(){this.unmount()},t}(ue.Plugin),pa.VERSION="1.5.13",ha),Qi={"audio/mp3":"mp3","audio/ogg":"ogg","audio/webm":"webm","image/gif":"gif","image/heic":"heic","image/heif":"heif","image/jpeg":"jpg","image/png":"png","image/svg+xml":"svg","video/mp4":"mp4","video/ogg":"ogv","video/quicktime":"mov","video/webm":"webm","video/x-matroska":"mkv","video/x-msvideo":"avi"},Zi=ie.h,eo=ie.h,to=ie.h,no=ie.h,ro=ie.h,io=ie.h;function oo(e,t){return-1!==e.indexOf(t)}function so(e){return uo("div",{class:"uppy-Webcam-permissons"},uo("div",{class:"uppy-Webcam-permissonsIcon"},e.icon()),uo("h1",{class:"uppy-Webcam-title"},e.hasCamera?e.i18n("allowAccessTitle"):e.i18n("noCameraTitle")),uo("p",null,e.hasCamera?e.i18n("allowAccessDescription"):e.i18n("noCameraDescription")))}var ao=function(e){var t;function n(){return e.apply(this,arguments)||this}r=e,(t=n).prototype=Object.create(r.prototype),(t.prototype.constructor=t).__proto__=r;var r=n.prototype;return r.componentDidMount=function(){this.props.onFocus()},r.componentWillUnmount=function(){this.props.onStop()},r.render=function(){var e,t,n,r,i,o,s=this.props.supportsRecording&&(oo(this.props.modes,"video-only")||oo(this.props.modes,"audio-only")||oo(this.props.modes,"video-audio")),a=oo(this.props.modes,"picture"),u=this.props.supportsRecording&&this.props.showRecordingLength,l=this.props.showVideoSourceDropdown&&this.props.videoSources&&1<this.props.videoSources.length;return io("div",{class:"uppy uppy-Webcam-container"},io("div",{class:"uppy-Webcam-videoContainer"},io("video",{class:"uppy-Webcam-video  "+(this.props.mirror?"uppy-Webcam-video--mirrored":""),autoplay:!0,muted:!0,playsinline:!0,srcObject:this.props.src||""})),io("div",{class:"uppy-Webcam-footer"},io("div",{class:"uppy-Webcam-videoSourceContainer"},l?(e=this.props,t=e.currentDeviceId,l=e.videoSources,n=e.onChangeVideoSource,ro("div",{className:"uppy-Webcam-videoSource"},ro("select",{className:"uppy-u-reset uppy-Webcam-videoSource-select",onchange:function(e){n(e.target.value)}},l.map(function(e){return ro("option",{key:e.deviceId,value:e.deviceId,selected:e.deviceId===t},e.label)})))):null),io("div",{class:"uppy-Webcam-buttonContainer"},a?(i=this.props,o=i.onSnapshot,i=i.i18n,eo("button",{class:"uppy-u-reset uppy-c-btn uppy-Webcam-button uppy-Webcam-button--picture",type:"button",title:i("takePicture"),"aria-label":i("takePicture"),onclick:o,"data-uppy-super-focusable":!0},Ji())):null," ",s?(i=this.props,o=i.recording,r=i.onStartRecording,s=i.onStopRecording,i=i.i18n,o?to("button",{class:"uppy-u-reset uppy-c-btn uppy-Webcam-button uppy-Webcam-button--video",type:"button",title:i("stopRecording"),"aria-label":i("stopRecording"),onclick:s,"data-uppy-super-focusable":!0},to("svg",{"aria-hidden":"true",focusable:"false",class:"uppy-c-icon",width:"100",height:"100",viewBox:"0 0 100 100"},to("rect",{x:"15",y:"15",width:"70",height:"70"}))):to("button",{class:"uppy-u-reset uppy-c-btn uppy-Webcam-button uppy-Webcam-button--video",type:"button",title:i("startRecording"),"aria-label":i("startRecording"),onclick:r,"data-uppy-super-focusable":!0},to("svg",{"aria-hidden":"true",focusable:"false",class:"uppy-c-icon",width:"100",height:"100",viewBox:"0 0 100 100"},to("circle",{cx:"50",cy:"50",r:"40"})))):null),io("div",{class:"uppy-Webcam-recordingLength"},u?(r=this.props,u=r.recordingLengthSeconds,r=r.i18n,u=u,u=Math.floor((u=u=u=u=u=u=u=u=u=u=u=u)/60)+":"+String(u%60).padStart(2,0),no("span",{"aria-label":r("recordingLength",{recording_length:u})},u)):null)))},n}(ie.Component),uo=ie.h;function lo(){return(lo=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,r=arguments[t];for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function co(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var po=ie.h;function ho(e){return"."===e[0]?J[e.slice(1)]:e}function fo(e){return/^video\/[^*]+$/.test(e)}function yo(e){return/^image\/[^*]+$/.test(e)}function go(){return bo("svg",{"aria-hidden":"true",focusable:"false",width:"32",height:"32",viewBox:"0 0 32 32"},bo("g",{fill:"none","fill-rule":"evenodd"},bo("rect",{fill:"#2C3E50",width:"32",height:"32",rx:"16"}),bo("path",{d:"M24.182 9H7.818C6.81 9 6 9.742 6 10.667v10c0 .916.81 1.666 1.818 1.666h4.546V24h7.272v-1.667h4.546c1 0 1.809-.75 1.809-1.666l.009-10C26 9.742 25.182 9 24.182 9zM24 21H8V11h16v10z",fill:"#FFF","fill-rule":"nonzero"}),bo("circle",{fill:"#FFF",cx:"16",cy:"16",r:"2"})))}function mo(e){var t=e.recording,n=e.onStartRecording,r=e.onStopRecording,e=e.i18n;return t?wo("button",{class:"uppy-u-reset uppy-c-btn uppy-ScreenCapture-button uppy-ScreenCapture-button--video uppy-ScreenCapture-button--stop-rec",type:"button",title:e("stopCapturing"),"aria-label":e("stopCapturing"),onclick:r,"data-uppy-super-focusable":!0},wo("svg",{"aria-hidden":"true",focusable:"false",class:"uppy-c-icon",width:"100",height:"100",viewBox:"0 0 100 100"},wo("rect",{x:"15",y:"15",width:"70",height:"70"}))):wo("button",{class:"uppy-u-reset uppy-c-btn uppy-ScreenCapture-button uppy-ScreenCapture-button--video",type:"button",title:e("startCapturing"),"aria-label":e("startCapturing"),onclick:n,"data-uppy-super-focusable":!0},wo("svg",{"aria-hidden":"true",focusable:"false",class:"uppy-c-icon",width:"100",height:"100",viewBox:"0 0 100 100"},wo("circle",{cx:"50",cy:"50",r:"40"})))}function vo(e){var t=e.recording,n=e.recordedVideo,r=e.onSubmit,e=e.i18n;return n&&!t?_o("button",{class:"uppy-u-reset uppy-c-btn uppy-ScreenCapture-button uppy-ScreenCapture-button--submit",type:"button",title:e("submitRecordedFile"),"aria-label":e("submitRecordedFile"),onclick:r,"data-uppy-super-focusable":!0},_o("svg",{"aria-hidden":"true",focusable:"false",class:"uppy-c-icon",width:"48",height:"48",viewBox:"0 0 48 48"},_o("path",{d:"M0 0h48v48h-48z",fill:"none"}),_o("path",{d:"M38.71 20.07c-1.36-6.88-7.43-12.07-14.71-12.07-5.78 0-10.79 3.28-13.3 8.07-6.01.65-10.7 5.74-10.7 11.93 0 6.63 5.37 12 12 12h26c5.52 0 10-4.48 10-10 0-5.28-4.11-9.56-9.29-9.93zm-10.71 5.93v8h-8v-8h-6l10-10 10 10h-6z"}))):null}var Xr=(ps=Ls=function(n){var e;function t(e,t){return(e=n.call(this,e,t)||this).mediaDevices=function(){if(navigator.mediaDevices&&navigator.mediaDevices.getUserMedia)return navigator.mediaDevices;var r=navigator.mozGetUserMedia||navigator.webkitGetUserMedia;return r?{getUserMedia:function(n){return new Promise(function(e,t){r.call(navigator,n,e,t)})}}:null}(),e.supportsUserMedia=!!e.mediaDevices,e.protocol=location.protocol.match(/https/i)?"https":"http",e.id=e.opts.id||"Webcam",e.title=e.opts.title||"Camera",e.type="acquirer",e.icon=function(){return po("svg",{"aria-hidden":"true",focusable:"false",width:"32",height:"32",viewBox:"0 0 32 32"},po("g",{fill:"none","fill-rule":"evenodd"},po("rect",{fill:"#03BFEF",width:"32",height:"32",rx:"16"}),po("path",{d:"M22 11c1.133 0 2 .867 2 2v7.333c0 1.134-.867 2-2 2H10c-1.133 0-2-.866-2-2V13c0-1.133.867-2 2-2h2.333l1.134-1.733C13.6 9.133 13.8 9 14 9h4c.2 0 .4.133.533.267L19.667 11H22zm-6 1.533a3.764 3.764 0 0 0-3.8 3.8c0 2.129 1.672 3.801 3.8 3.801s3.8-1.672 3.8-3.8c0-2.13-1.672-3.801-3.8-3.801zm0 6.261c-1.395 0-2.46-1.066-2.46-2.46 0-1.395 1.065-2.461 2.46-2.461s2.46 1.066 2.46 2.46c0 1.395-1.065 2.461-2.46 2.461z",fill:"#FFF","fill-rule":"nonzero"})))},e.defaultLocale={strings:{smile:"Smile!",takePicture:"Take a picture",startRecording:"Begin video recording",stopRecording:"Stop video recording",allowAccessTitle:"Please allow access to your camera",allowAccessDescription:"In order to take pictures or record video with your camera, please allow camera access for this site.",noCameraTitle:"Camera Not Available",noCameraDescription:"In order to take pictures or record video, please connect a camera device",recordingStoppedMaxSize:"Recording stopped because the file size is about to exceed the limit",recordingLength:"Recording length %{recording_length}"}},e.opts=lo({},{onBeforeSnapshot:function(){return Promise.resolve()},countdown:!1,modes:["video-audio","video-only","audio-only","picture"],mirror:!0,showVideoSourceDropdown:!1,facingMode:"user",preferredImageMimeType:null,preferredVideoMimeType:null,showRecordingLength:!1},t),e.i18nInit(),e.install=e.install.bind(co(e)),e.setPluginState=e.setPluginState.bind(co(e)),e.render=e.render.bind(co(e)),e._start=e._start.bind(co(e)),e._stop=e._stop.bind(co(e)),e._takeSnapshot=e._takeSnapshot.bind(co(e)),e._startRecording=e._startRecording.bind(co(e)),e._stopRecording=e._stopRecording.bind(co(e)),e._oneTwoThreeSmile=e._oneTwoThreeSmile.bind(co(e)),e._focus=e._focus.bind(co(e)),e._changeVideoSource=e._changeVideoSource.bind(co(e)),e.webcamActive=!1,e.opts.countdown&&(e.opts.onBeforeSnapshot=e._oneTwoThreeSmile),e.setPluginState({hasCamera:!1,cameraReady:!1,cameraError:null,recordingLengthSeconds:0,videoSources:[],currentDeviceId:null}),e}r=n,(e=t).prototype=Object.create(r.prototype),(e.prototype.constructor=e).__proto__=r;var r=t.prototype;return r.setOptions=function(e){n.prototype.setOptions.call(this,lo({},e,{videoConstraints:lo({},this.opts.videoConstraints,null==e?void 0:e.videoConstraints)})),this.i18nInit()},r.i18nInit=function(){this.translator=new C([this.defaultLocale,this.uppy.locale,this.opts.locale]),this.i18n=this.translator.translate.bind(this.translator),this.i18nArray=this.translator.translateArray.bind(this.translator),this.setPluginState()},r.hasCameraCheck=function(){return this.mediaDevices?this.mediaDevices.enumerateDevices().then(function(e){return e.some(function(e){return"videoinput"===e.kind})}):Promise.resolve(!1)},r.getConstraints=function(e){var t;void 0===e&&(e=null);var n=-1!==this.opts.modes.indexOf("video-audio")||-1!==this.opts.modes.indexOf("audio-only"),r=-1!==this.opts.modes.indexOf("video-audio")||-1!==this.opts.modes.indexOf("video-only")||-1!==this.opts.modes.indexOf("picture"),e=lo({},null!=(t=this.opts.videoConstraints)?t:{facingMode:this.opts.facingMode},e?{deviceId:e,facingMode:null}:{});return{audio:n,video:!!r&&e}},r._start=function(n){var r=this;if(void 0===n&&(n=null),!this.supportsUserMedia)return Promise.reject(new Error("Webcam access not supported"));this.webcamActive=!0;var t=this.getConstraints(n&&n.deviceId?n.deviceId:null);this.hasCameraCheck().then(function(e){return r.setPluginState({hasCamera:e}),r.mediaDevices.getUserMedia(t).then(function(e){r.stream=e;var t=null;n&&n.deviceId?e.getVideoTracks().forEach(function(e){e.getSettings().deviceId===n.deviceId&&(t=e.getSettings().deviceId)}):t=e.getVideoTracks()[0].getSettings().deviceId,r.updateVideoSources(),r.setPluginState({currentDeviceId:t,cameraReady:!0})}).catch(function(e){r.setPluginState({cameraReady:!1,cameraError:e}),r.uppy.info(e.message,"error")})})},r._getMediaRecorderOptions=function(){var e,t,n={};return MediaRecorder.isTypeSupported&&(e=this.uppy.opts.restrictions,t=[],this.opts.preferredVideoMimeType?t=[this.opts.preferredVideoMimeType]:e.allowedFileTypes&&(t=e.allowedFileTypes.map(ho).filter(fo)),0<(t=t.filter(function(e){return MediaRecorder.isTypeSupported(e)&&Yi(e)})).length&&(n.mimeType=t[0])),n},r._startRecording=function(){var r=this;this.recorder=new MediaRecorder(this.stream,this._getMediaRecorderOptions());var i=!(this.recordingChunks=[]);this.recorder.addEventListener("dataavailable",function(e){r.recordingChunks.push(e.data);var t,n=r.uppy.opts.restrictions;1<r.recordingChunks.length&&null!=n.maxFileSize&&!i&&(e=((t=r.recordingChunks.reduce(function(e,t){return e+t.size},0))-r.recordingChunks[0].size)/(r.recordingChunks.length-1)*3,t>Math.max(0,n.maxFileSize-e)&&(i=!0,r.uppy.info(r.i18n("recordingStoppedMaxSize"),"warning",4e3),r._stopRecording()))}),this.recorder.start(500),this.opts.showRecordingLength&&(this.recordingLengthTimer=setInterval(function(){var e=r.getPluginState().recordingLengthSeconds;r.setPluginState({recordingLengthSeconds:e+1})},1e3)),this.setPluginState({isRecording:!0})},r._stopRecording=function(){var n=this;return new Promise(function(e,t){n.recorder.addEventListener("stop",function(){e()}),n.recorder.stop(),n.opts.showRecordingLength&&(clearInterval(n.recordingLengthTimer),n.setPluginState({recordingLengthSeconds:0}))}).then(function(){return n.setPluginState({isRecording:!1}),n.getVideo()}).then(function(e){try{n.uppy.addFile(e)}catch(e){e.isRestriction||n.uppy.log(e)}}).then(function(){n.recordingChunks=null,n.recorder=null},function(e){throw n.recordingChunks=null,n.recorder=null,e})},r._stop=function(){this.stream&&(this.stream.getAudioTracks().forEach(function(e){e.stop()}),this.stream.getVideoTracks().forEach(function(e){e.stop()})),this.webcamActive=!1,this.stream=null},r._getVideoElement=function(){return this.el.querySelector(".uppy-Webcam-video")},r._oneTwoThreeSmile=function(){var i=this;return new Promise(function(e,t){var n=i.opts.countdown,r=setInterval(function(){return i.webcamActive?void(0<n?(i.uppy.info(n+"...","warning",800),n--):(clearInterval(r),i.uppy.info(i.i18n("smile"),"success",1500),setTimeout(function(){return e()},1500))):(clearInterval(r),i.captureInProgress=!1,t(new Error("Webcam is not active")))},1e3)})},r._takeSnapshot=function(){var t=this;this.captureInProgress||(this.captureInProgress=!0,this.opts.onBeforeSnapshot().catch(function(e){e="object"==typeof e?e.message:e;return t.uppy.info(e,"error",5e3),Promise.reject(new Error("onBeforeSnapshot: "+e))}).then(function(){return t._getImage()}).then(function(e){t.captureInProgress=!1;try{t.uppy.addFile(e)}catch(e){e.isRestriction||t.uppy.log(e)}},function(e){throw t.captureInProgress=!1,e}))},r._getImage=function(){var t=this,e=this._getVideoElement();if(!e)return Promise.reject(new Error("No video element found, likely due to the Webcam tab being closed."));var n=e.videoWidth,r=e.videoHeight,i=document.createElement("canvas");i.width=n,i.height=r,i.getContext("2d").drawImage(e,0,0);r=this.uppy.opts.restrictions,e=[];this.opts.preferredImageMimeType?e=[this.opts.preferredImageMimeType]:r.allowedFileTypes&&(e=r.allowedFileTypes.map(ho).filter(yo));var o,s,a=e[0]||"image/jpeg",e=Yi(a)||"jpg",u="cam-"+Date.now()+"."+e;return s=a,((o=i).toBlob?new Promise(function(e){o.toBlob(e,s,void 0)}):Promise.resolve().then(function(){return vr(o.toDataURL(s,void 0),{})})).then(function(e){return{source:t.id,name:u,data:new Blob([e],{type:a}),type:a}})},r.getVideo=function(){var e=this.recordingChunks[0].type,t=Yi(e);if(!t)return Promise.reject(new Error('Could not retrieve recording: Unsupported media type "'+e+'"'));var n="webcam-"+Date.now()+"."+t,t=new Blob(this.recordingChunks,{type:e}),e={source:this.id,name:n,data:new Blob([t],{type:e}),type:e};return Promise.resolve(e)},r._focus=function(){var e=this;this.opts.countdown&&setTimeout(function(){e.uppy.info(e.i18n("smile"),"success",1500)},1e3)},r._changeVideoSource=function(e){this._stop(),this._start({deviceId:e})},r.updateVideoSources=function(){var t=this;this.mediaDevices.enumerateDevices().then(function(e){t.setPluginState({videoSources:e.filter(function(e){return"videoinput"===e.kind})})})},r.render=function(){this.webcamActive||this._start();var e=this.getPluginState();return e.cameraReady&&e.hasCamera?po(ao,lo({},e,{onChangeVideoSource:this._changeVideoSource,onSnapshot:this._takeSnapshot,onStartRecording:this._startRecording,onStopRecording:this._stopRecording,onFocus:this._focus,onStop:this._stop,i18n:this.i18n,modes:this.opts.modes,showRecordingLength:this.opts.showRecordingLength,showVideoSourceDropdown:this.opts.showVideoSourceDropdown,supportsRecording:"function"==typeof MediaRecorder&&!!MediaRecorder.prototype&&"function"==typeof MediaRecorder.prototype.start,recording:e.isRecording,mirror:this.opts.mirror,src:this.stream})):po(so,{icon:Ji,i18n:this.i18n,hasCamera:e.hasCamera})},r.install=function(){var o=this;this.setPluginState({cameraReady:!1,recordingLengthSeconds:0});var e=this.opts.target;e&&this.mount(e,this),this.mediaDevices&&(this.updateVideoSources(),this.mediaDevices.ondevicechange=function(e){var t,n,r,i;o.updateVideoSources(),o.stream&&(t=!0,r=(n=o.getPluginState()).videoSources,i=n.currentDeviceId,r.forEach(function(e){i===e.deviceId&&(t=!1)}),t&&(o._stop(),o._start()))})},r.uninstall=function(){this.stream&&this._stop(),this.unmount()},t}(ue.Plugin),Ls.VERSION="1.8.1",ps),bo=ie.h,wo=ie.h,_o=ie.h;function So(){return(So=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,r=arguments[t];for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function ko(e){var t=e.streamActive,e=e.i18n;return t?Fo("div",{title:e("streamActive"),"aria-label":e("streamActive"),class:"uppy-ScreenCapture-icon--stream uppy-ScreenCapture-icon--streamActive"},Fo("svg",{"aria-hidden":"true",focusable:"false",width:"24",height:"24",viewBox:"0 0 24 24"},Fo("path",{d:"M0 0h24v24H0z",opacity:".1",fill:"none"}),Fo("path",{d:"M0 0h24v24H0z",fill:"none"}),Fo("path",{d:"M1 18v3h3c0-1.66-1.34-3-3-3zm0-4v2c2.76 0 5 2.24 5 5h2c0-3.87-3.13-7-7-7zm18-7H5v1.63c3.96 1.28 7.09 4.41 8.37 8.37H19V7zM1 10v2c4.97 0 9 4.03 9 9h2c0-6.08-4.93-11-11-11zm20-7H3c-1.1 0-2 .9-2 2v3h2V5h18v14h-7v2h7c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"}))):Fo("div",{title:e("streamPassive"),"aria-label":e("streamPassive"),class:"uppy-ScreenCapture-icon--stream"},Fo("svg",{"aria-hidden":"true",focusable:"false",width:"24",height:"24",viewBox:"0 0 24 24"},Fo("path",{d:"M0 0h24v24H0z",opacity:".1",fill:"none"}),Fo("path",{d:"M0 0h24v24H0z",fill:"none"}),Fo("path",{d:"M21 3H3c-1.1 0-2 .9-2 2v3h2V5h18v14h-7v2h7c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM1 18v3h3c0-1.66-1.34-3-3-3zm0-4v2c2.76 0 5 2.24 5 5h2c0-3.87-3.13-7-7-7zm0-4v2c4.97 0 9 4.03 9 9h2c0-6.08-4.93-11-11-11z"})))}var Po=ie.h,Co=function(t){var e;function n(e){return(e=t.call(this,e)||this).state={elapsedTime:0},e.wrapperStyle={width:"100%",height:"100%",display:"flex"},e.overlayStyle={position:"absolute",width:"100%",height:"100%",background:"black",opacity:.7},e.infoContainerStyle={marginLeft:"auto",marginRight:"auto",marginTop:"auto",marginBottom:"auto",zIndex:1,color:"white"},e.infotextStyle={marginLeft:"auto",marginRight:"auto",marginBottom:"1rem",fontSize:"1.5rem"},e.timeStyle={display:"block",fontWeight:"bold",marginLeft:"auto",marginRight:"auto",fontSize:"3rem",fontFamily:"Courier New"},e}r=t,(e=n).prototype=Object.create(r.prototype),(e.prototype.constructor=e).__proto__=r;var r=n.prototype;return r.startTimer=function(){this.timerTick(),this.timerRunning=!0},r.resetTimer=function(){clearTimeout(this.timer),this.setState({elapsedTime:0}),this.timerRunning=!1},r.timerTick=function(){var e=this;this.timer=setTimeout(function(){e.setState({elapsedTime:e.state.elapsedTime+1}),e.timerTick()},1e3)},r.fmtMSS=function(e){return(e-(e%=60))/60+(9<e?":":":0")+e},r.render=function(){var e=So({},this.props),t=e.recording,n=e.i18n,e=this.fmtMSS(this.state.elapsedTime);return t&&!this.timerRunning&&this.startTimer(),!t&&this.timerRunning&&this.resetTimer(),t?Po("div",{style:this.wrapperStyle},Po("div",{style:this.overlayStyle}),Po("div",{style:this.infoContainerStyle},Po("div",{style:this.infotextStyle},n("recording")),Po("div",{style:this.timeStyle},e))):null},n}(ie.Component),Fo=ie.h;function Ao(){return(Ao=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,r=arguments[t];for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}var Eo=ie.h,Oo=function(e){var t;function n(){return e.apply(this,arguments)||this}r=e,(t=n).prototype=Object.create(r.prototype),(t.prototype.constructor=t).__proto__=r;var r=n.prototype;return r.componentWillUnmount=function(){this.props.onStop()},r.render=function(){var t=this,e=this.props,n=e.recording,r=e.stream,i=e.recordedVideo,e={playsinline:!0};return!n&&(i||n)||(e.muted=!0,e.autoplay=!0,e.srcObject=r),i&&!n&&(e.muted=!1,e.controls=!0,e.src=i,this.videoElement&&(this.videoElement.srcObject=void 0)),Eo("div",{class:"uppy uppy-ScreenCapture-container"},Eo("div",{class:"uppy-ScreenCapture-videoContainer"},Eo(ko,this.props),Eo("video",Ao({ref:function(e){return t.videoElement=e},class:"uppy-ScreenCapture-video"},e)),Eo(Co,this.props)),Eo("div",{class:"uppy-ScreenCapture-buttonContainer"},Eo(mo,this.props),Eo(vo,this.props)))},n}(ie.Component);function Uo(){return(Uo=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,r=arguments[t];for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function Ro(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function To(e,t){if(t=t.split(":")[0],e=+e){switch(t){case"http":case"ws":return 80!==e;case"https":case"wss":return 443!==e;case"ftp":return 21!==e;case"gopher":return 70!==e;case"file":return}return 0!==e}}var xo=ie.h,e=(Ss=ds=function(n){var e;function t(e,t){return(e=n.call(this,e,t)||this).mediaDevices=navigator&&navigator.mediaDevices&&navigator.mediaDevices.getDisplayMedia&&window&&window.MediaRecorder?navigator.mediaDevices:null,e.protocol=location.protocol.match(/https/i)?"https":"http",e.id=e.opts.id||"ScreenCapture",e.title=e.opts.title||"Screencast",e.type="acquirer",e.icon=go,e.defaultLocale={strings:{startCapturing:"Begin screen capturing",stopCapturing:"Stop screen capturing",submitRecordedFile:"Submit captured video",streamActive:"Stream active",streamPassive:"Stream passive",micDisabled:"Microphone access denied by user",recording:"Recording"}},e.opts=Uo({},{displayMediaConstraints:{video:{width:1280,height:720,frameRate:{ideal:3,max:5},cursor:"motion",displaySurface:"monitor"}},userMediaConstraints:{audio:!0},preferredVideoMimeType:"video/webm"},t),e.translator=new C([e.defaultLocale,e.uppy.locale,e.opts.locale]),e.i18n=e.translator.translate.bind(e.translator),e.i18nArray=e.translator.translateArray.bind(e.translator),e.install=e.install.bind(Ro(e)),e.setPluginState=e.setPluginState.bind(Ro(e)),e.render=e.render.bind(Ro(e)),e.start=e.start.bind(Ro(e)),e.stop=e.stop.bind(Ro(e)),e.startRecording=e.startRecording.bind(Ro(e)),e.stopRecording=e.stopRecording.bind(Ro(e)),e.submit=e.submit.bind(Ro(e)),e.streamInterrupted=e.streamInactivated.bind(Ro(e)),e.captureActive=!1,e.capturedMediaFile=null,e}r=n,(e=t).prototype=Object.create(r.prototype),(e.prototype.constructor=e).__proto__=r;var r=t.prototype;return r.install=function(){if(!this.mediaDevices)return this.uppy.log("Screen recorder access is not supported","error"),null;this.setPluginState({streamActive:!1,audioStreamActive:!1});var e=this.opts.target;e&&this.mount(e,this)},r.uninstall=function(){this.videoStream&&this.stop(),this.unmount()},r.start=function(){var t=this;if(!this.mediaDevices)return Promise.reject(new Error("Screen recorder access not supported"));this.captureActive=!0,this.selectAudioStreamSource(),this.selectVideoStreamSource().then(function(e){!1===e&&t.parent&&t.parent.hideAllPanels&&(t.parent.hideAllPanels(),t.captureActive=!1)})},r.selectVideoStreamSource=function(){var t=this;return this.videoStream?new Promise(function(e){return e(t.videoStream)}):this.mediaDevices.getDisplayMedia(this.opts.displayMediaConstraints).then(function(e){return t.videoStream=e,t.videoStream.addEventListener("inactive",function(e){t.streamInactivated()}),t.setPluginState({streamActive:!0}),e}).catch(function(e){return t.setPluginState({screenRecError:e}),t.userDenied=!0,setTimeout(function(){t.userDenied=!1},1e3),!1})},r.selectAudioStreamSource=function(){var t=this;return this.audioStream?new Promise(function(e){return e(t.audioStream)}):this.mediaDevices.getUserMedia(this.opts.userMediaConstraints).then(function(e){return t.audioStream=e,t.setPluginState({audioStreamActive:!0}),e}).catch(function(e){return"NotAllowedError"===e.name&&t.uppy.info(t.i18n("micDisabled"),"error",5e3),!1})},r.startRecording=function(){var t=this,n={};this.capturedMediaFile=null,this.recordingChunks=[];var r=this.opts.preferredVideoMimeType;this.selectVideoStreamSource().then(function(e){r&&MediaRecorder.isTypeSupported(r)&&Yi(r)&&(n.mimeType=r);e=[e.getVideoTracks()[0]];t.audioStream&&e.push(t.audioStream.getAudioTracks()[0]),t.outputStream=new MediaStream(e),t.recorder=new MediaRecorder(t.outputStream,n),t.recorder.addEventListener("dataavailable",function(e){t.recordingChunks.push(e.data)}),t.recorder.start(),t.setPluginState({recording:!0})}).catch(function(e){t.uppy.log(e,"error")})},r.streamInactivated=function(){var e=Uo({},this.getPluginState()),t=e.recordedVideo,e=e.recording;t||e?e&&(this.uppy.log("Capture stream inactive  stop recording"),this.stopRecording()):this.parent&&this.parent.hideAllPanels&&this.parent.hideAllPanels(),this.videoStream=null,this.audioStream=null,this.setPluginState({streamActive:!1,audioStreamActive:!1})},r.stopRecording=function(){var n=this;return new Promise(function(e,t){n.recorder.addEventListener("stop",function(){e()}),n.recorder.stop()}).then(function(){return n.setPluginState({recording:!1}),n.getVideo()}).then(function(e){n.capturedMediaFile=e,n.setPluginState({recordedVideo:URL.createObjectURL(e.data)})}).then(function(){n.recordingChunks=null,n.recorder=null},function(e){throw n.recordingChunks=null,n.recorder=null,e})},r.submit=function(){try{this.capturedMediaFile&&this.uppy.addFile(this.capturedMediaFile)}catch(e){e.isRestriction||this.uppy.log(e,"error")}},r.stop=function(){this.videoStream&&(this.videoStream.getVideoTracks().forEach(function(e){e.stop()}),this.videoStream.getAudioTracks().forEach(function(e){e.stop()}),this.videoStream=null),this.audioStream&&(this.audioStream.getAudioTracks().forEach(function(e){e.stop()}),this.audioStream.getVideoTracks().forEach(function(e){e.stop()}),this.audioStream=null),this.outputStream&&(this.outputStream.getAudioTracks().forEach(function(e){e.stop()}),this.outputStream.getVideoTracks().forEach(function(e){e.stop()}),this.outputStream=null),this.setPluginState({recordedVideo:null}),this.captureActive=!1},r.getVideo=function(){var e=this.recordingChunks[0].type,t=Yi(e);if(!t)return Promise.reject(new Error('Could not retrieve recording: Unsupported media type "'+e+'"'));var n="screencap-"+Date.now()+"."+t,t=new Blob(this.recordingChunks,{type:e}),e={source:this.id,name:n,data:new Blob([t],{type:e}),type:e};return Promise.resolve(e)},r.render=function(e){var t=this.getPluginState();return t.streamActive||this.captureActive||this.userDenied||this.start(),xo(Oo,Uo({},t,{onStartRecording:this.startRecording,onStopRecording:this.stopRecording,onStop:this.stop,onSubmit:this.submit,i18n:this.i18n,stream:this.videoStream}))},t}(ue.Plugin),ds.VERSION="1.0.10",Ss),Do={},Bo=Object.prototype.hasOwnProperty;function Io(e){try{return decodeURIComponent(e.replace(/\+/g," "))}catch(e){return null}}function jo(e){try{return encodeURIComponent(e)}catch(e){return null}}Do.stringify=function(e,t){var n,r,i=[];for(r in"string"!=typeof(t=t||"")&&(t="?"),e)if(Bo.call(e,r)){if((n=e[r])||null!=n&&!isNaN(n)||(n=""),r=jo(r),n=jo(n),null===r||null===n)continue;i.push(r+"="+n)}return i.length?t+i.join("&"):""},Do.parse=function(e){for(var t=/([^=?#&]+)=?([^&]*)/g,n={};i=t.exec(e);){var r=Io(i[1]),i=Io(i[2]);null===r||null===i||r in n||(n[r]=i)}return n};var Mo={};!function(s){!function(){"use strict";var i=/^[A-Za-z][A-Za-z0-9+-.]*:\/\//,t=/^([a-z][a-z0-9.+-]*:)?(\/\/)?([\S\s]*)/i,n=new RegExp("^[\\x09\\x0A\\x0B\\x0C\\x0D\\x20\\xA0\\u1680\\u180E\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200A\\u202F\\u205F\\u3000\\u2028\\u2029\\uFEFF]+");function d(e){return(e||"").toString().replace(n,"")}var h=[["#","hash"],["?","query"],function(e){return e.replace("\\","/")},["/","pathname"],["@","auth",1],[NaN,"host",void 0,1,1],[/:(\d+)$/,"port",void 0,1],[NaN,"hostname",void 0,1,1]],o={hash:1,query:1};function f(e){var t,n=("undefined"!=typeof window?window:void 0!==s?s:"undefined"!=typeof self?self:{}).location||{},r={},n=typeof(e=e||n);if("blob:"===e.protocol)r=new g(unescape(e.pathname),{});else if("string"==n)for(t in r=new g(e,{}),o)delete r[t];else if("object"==n){for(t in e)t in o||(r[t]=e[t]);void 0===r.slashes&&(r.slashes=i.test(e.href))}return r}function y(e){e=d(e);e=t.exec(e);return{protocol:e[1]?e[1].toLowerCase():"",slashes:!!e[2],rest:e[3]}}function g(e,t,n){if(e=d(e),!(this instanceof g))return new g(e,t,n);var r,i,o,s,a,u=h.slice(),l=typeof t,c=this,p=0;for("object"!=l&&"string"!=l&&(n=t,t=null),n&&"function"!=typeof n&&(n=Do.parse),t=f(t),r=!(l=y(e||"")).protocol&&!l.slashes,c.slashes=l.slashes||r&&t.slashes,c.protocol=l.protocol||t.protocol||"",e=l.rest,l.slashes||(u[3]=[/(.*)/,"pathname"]);p<u.length;p++)"function"!=typeof(o=u[p])?(i=o[0],a=o[1],i!=i?c[a]=e:"string"==typeof i?~(s=e.indexOf(i))&&(e="number"==typeof o[2]?(c[a]=e.slice(0,s),e.slice(s+o[2])):(c[a]=e.slice(s),e.slice(0,s))):(s=i.exec(e))&&(c[a]=s[1],e=e.slice(0,s.index)),c[a]=c[a]||r&&o[3]&&t[a]||"",o[4]&&(c[a]=c[a].toLowerCase())):e=o(e);n&&(c.query=n(c.query)),r&&t.slashes&&"/"!==c.pathname.charAt(0)&&(""!==c.pathname||""!==t.pathname)&&(c.pathname=function(e,t){if(""===e)return t;for(var n=(t||"/").split("/").slice(0,-1).concat(e.split("/")),r=n.length,e=n[r-1],i=!1,o=0;r--;)"."===n[r]?n.splice(r,1):".."===n[r]?(n.splice(r,1),o++):o&&(0===r&&(i=!0),n.splice(r,1),o--);return i&&n.unshift(""),"."!==e&&".."!==e||n.push(""),n.join("/")}(c.pathname,t.pathname)),To(c.port,c.protocol)||(c.host=c.hostname,c.port=""),c.username=c.password="",c.auth&&(o=c.auth.split(":"),c.username=o[0]||"",c.password=o[1]||""),c.origin=c.protocol&&c.host&&"file:"!==c.protocol?c.protocol+"//"+c.host:"null",c.href=c.toString()}g.prototype={set:function(e,t,n){var r,i=this;switch(e){case"query":"string"==typeof t&&t.length&&(t=(n||Do.parse)(t)),i[e]=t;break;case"port":i[e]=t,To(t,i.protocol)?t&&(i.host=i.hostname+":"+t):(i.host=i.hostname,i[e]="");break;case"hostname":i[e]=t,i.port&&(t+=":"+i.port),i.host=t;break;case"host":i[e]=t,/:\d+$/.test(t)?(t=t.split(":"),i.port=t.pop(),i.hostname=t.join(":")):(i.hostname=t,i.port="");break;case"protocol":i.protocol=t.toLowerCase(),i.slashes=!n;break;case"pathname":case"hash":t?(r="pathname"===e?"/":"#",i[e]=t.charAt(0)!==r?r+t:t):i[e]=t;break;default:i[e]=t}for(var o=0;o<h.length;o++){var s=h[o];s[4]&&(i[s[1]]=i[s[1]].toLowerCase())}return i.origin=i.protocol&&i.host&&"file:"!==i.protocol?i.protocol+"//"+i.host:"null",i.href=i.toString(),i},toString:function(e){e&&"function"==typeof e||(e=Do.stringify);var t=this,n=t.protocol;n&&":"!==n.charAt(n.length-1)&&(n+=":");n+=t.slashes?"//":"";return t.username&&(n+=t.username,t.password&&(n+=":"+t.password),n+="@"),n+=t.host+t.pathname,(e="object"==typeof t.query?e(t.query):t.query)&&(n+="?"!==e.charAt(0)?"?"+e:e),t.hash&&(n+=t.hash),n}},g.extractProtocol=y,g.location=f,g.trimLeft=d,g.qs=Do,Mo=g}.call(this)}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});function Lo(e){var t=[],n=[];function r(e){t.push(e)}function i(e){n.push(e)}return Promise.all(e.map(function(e){return e.then(r,i)})).then(function(){return{successful:t,failed:n}})}function No(e){var t=/^(?:https?:\/\/|\/\/)?(?:[^@\n]+@)?(?:www\.)?([^\n]+)/i.exec(e)[1];return(/^http:\/\//i.test(e)?"ws":"wss")+"://"+t}var zo=((o=$o.prototype)._call=function(e){var t=this;this.activeRequests+=1;var n,r=!1;try{n=e()}catch(e){throw--this.activeRequests,e}return{abort:function(){r||(r=!0,--t.activeRequests,n(),t._queueNext())},done:function(){r||(r=!0,--t.activeRequests,t._queueNext())}}},o._queueNext=function(){var e=this;Promise.resolve().then(function(){e._next()})},o._next=function(){var e,t;this.activeRequests>=this.limit||0===this.queuedHandlers.length||(e=this.queuedHandlers.shift(),t=this._call(e.fn),e.abort=t.abort,e.done=t.done)},o._queue=function(e,t){var n=this,r={fn:e,priority:(t=void 0===t?{}:t).priority||0,abort:function(){n._dequeue(r)},done:function(){throw new Error("Cannot mark a queued request as done: this indicates a bug")}},t=function(e){for(var t,n=0;n<e.length;n++)if(t=e[n],r.priority>t.priority)return n;return-1}(this.queuedHandlers);return-1===t?this.queuedHandlers.push(r):this.queuedHandlers.splice(t,0,r),r},o._dequeue=function(e){e=this.queuedHandlers.indexOf(e);-1!==e&&this.queuedHandlers.splice(e,1)},o.run=function(e,t){return this.activeRequests<this.limit?this._call(e):this._queue(e,t)},o.wrapPromiseFunction=function(a,u){var l=this;return function(){for(var e=arguments.length,o=new Array(e),t=0;t<e;t++)o[t]=arguments[t];var s,n=new Promise(function(r,i){s=l.run(function(){var t,n;try{n=Promise.resolve(a.apply(void 0,o))}catch(e){n=Promise.reject(e)}return n.then(function(e){t?i(t):(s.done(),r(e))},function(e){t?i(t):(s.done(),i(e))}),function(){t=new Error("Cancelled")}},u)});return n.abort=function(){s.abort()},n}},$o),qo=Object.prototype.hasOwnProperty,Ho=N(function(e,t,n){var r=t.progress,i=t.bytesUploaded,t=t.bytesTotal;r&&(e.uppy.log("Upload progress: "+r),e.uppy.emit("upload-progress",n,{uploader:e,bytesUploaded:i,bytesTotal:t}))},300,{leading:!0,trailing:!0}),Vo=((A=Ko.prototype).on=function(e,t){return this._events.push([e,t]),this._emitter.on(e,t)},A.remove=function(){var n=this;this._events.forEach(function(e){var t=e[0],e=e[1];n._emitter.off(t,e)})},Ko),Wo=((ne=Go.prototype).progress=function(){this._isDone||0<this._timeout&&(this._aliveTimer&&clearTimeout(this._aliveTimer),this._aliveTimer=setTimeout(this._onTimedOut,this._timeout))},ne.done=function(){this._aliveTimer&&(clearTimeout(this._aliveTimer),this._aliveTimer=null),this._isDone=!0},Go),Xo=function(e){return!!e&&(0!==e.readyState&&4!==e.readyState||0===e.status)};function Go(e,t){this._timeout=e,this._onTimedOut=t,this._isDone=!1,this._aliveTimer=null,this._onTimedOut=this._onTimedOut.bind(this)}function Ko(e){this._events=[],this._emitter=e}function $o(e){this.limit="number"!=typeof e||0===e?1/0:e,this.activeRequests=0,this.queuedHandlers=[]}function Yo(){return(Yo=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,r=arguments[t];for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}var Jo=We.Provider,Qo=We.RequestClient,Zo=We.Socket;function es(e,t){return(t="string"==typeof(t=t||new Error("Upload error"))?new Error(t):t)instanceof Error||(t=Yo(new Error("Upload error"),{data:t})),Xo(e)?new Ie(t,e):(t.request=e,t)}function ts(e,t){if("string"==typeof(t=t.headers?t.headers["content-type"]:t.getResponseHeader("Content-Type"))){t=t.replace(/;.*$/,"").toLowerCase();if("application/xml"===t||"text/xml"===t)return 1;if("text/html"===t&&/^<\?xml /.test(e))return 1}}var ns=((pa=rs.prototype)._getOptions=function(e){var t=this.uppy.getState().xhrUpload,n=Yo({},this.opts,t||{},e.xhrUpload||{},{headers:{}});return Yo(n.headers,this.opts.headers),t&&Yo(n.headers,t.headers),e.xhrUpload&&Yo(n.headers,e.xhrUpload.headers),n},pa.uploadFile=function(e,t,n){e=this.uppy.getFile(e);if(e.error)throw new Error(e.error);return e.isRemote?this._uploadRemoteFile(e,t,n):this._uploadLocalFile(e,t,n)},pa._addMetadata=function(t,n,e){(Array.isArray(e.metaFields)?e.metaFields:Object.keys(n)).forEach(function(e){t.append(e,n[e])})},pa._createFormDataUpload=function(e,t){var n=new FormData;this._addMetadata(n,e.meta,t);var r=e.data.slice(0,e.data.size,e.meta.type);return e.name?n.append(t.fieldName,r,e.meta.name):n.append(t.fieldName,r),n},pa._createBareUpload=function(e,t){return e.data},pa._onFileRemoved=function(t,n){this.uploaderEvents[t].on("file-removed",function(e){t===e.id&&n(e.id)})},pa._onRetry=function(t,n){this.uploaderEvents[t].on("upload-retry",function(e){t===e&&n()})},pa._onRetryAll=function(t,n){var r=this;this.uploaderEvents[t].on("retry-all",function(e){r.uppy.getFile(t)&&n()})},pa._onCancelAll=function(e,t){var n=this;this.uploaderEvents[e].on("cancel-all",function(){n.uppy.getFile(e)&&t()})},pa._uploadLocalFile=function(l,e,t){var c=this,p=this._getOptions(l);return this.uppy.log("uploading "+e+" of "+t),new Promise(function(r,i){var e=p.formData?c._createFormDataUpload(l,p):c._createBareUpload(l,p),o=new XMLHttpRequest;c.uploaderEvents[l.id]=new Vo(c.uppy);var s=new Wo(p.timeout,function(){o.abort(),u.done();var e=new Error(c.i18n("timedOut",{seconds:Math.ceil(p.timeout/1e3)}));c.uppy.emit("upload-error",l,e),i(e)}),a=D();o.upload.addEventListener("loadstart",function(e){c.uppy.log("[AwsS3/XHRUpload] "+a+" started")}),o.upload.addEventListener("progress",function(e){c.uppy.log("[AwsS3/XHRUpload] "+a+" progress: "+e.loaded+" / "+e.total),s.progress(),e.lengthComputable&&c.uppy.emit("upload-progress",l,{uploader:c,bytesUploaded:e.loaded,bytesTotal:e.total})}),o.addEventListener("load",function(e){if(c.uppy.log("[AwsS3/XHRUpload] "+a+" finished"),s.done(),u.done(),c.uploaderEvents[l.id]&&(c.uploaderEvents[l.id].remove(),c.uploaderEvents[l.id]=null),p.validateStatus(e.target.status,o.responseText,o)){var t=p.getResponseData(o.responseText,o),n=t[p.responseUrlFieldName],t={status:e.target.status,body:t,uploadURL:n};return c.uppy.emit("upload-success",l,t),n&&c.uppy.log("Download "+l.name+" from "+n),r(l)}t=p.getResponseData(o.responseText,o),n=es(o,p.getResponseError(o.responseText,o)),t={status:e.target.status,body:t};return c.uppy.emit("upload-error",l,n,t),i(n)}),o.addEventListener("error",function(e){c.uppy.log("[AwsS3/XHRUpload] "+a+" errored"),s.done(),u.done(),c.uploaderEvents[l.id]&&(c.uploaderEvents[l.id].remove(),c.uploaderEvents[l.id]=null);var t=es(o,p.getResponseError(o.responseText,o));return c.uppy.emit("upload-error",l,t),i(t)}),o.open(p.method.toUpperCase(),p.endpoint,!0),o.withCredentials=p.withCredentials,""!==p.responseType&&(o.responseType=p.responseType),Object.keys(p.headers).forEach(function(e){o.setRequestHeader(e,p.headers[e])});var u=c.requests.run(function(){return o.send(e),function(){s.done(),o.abort()}},{priority:1});c._onFileRemoved(l.id,function(){u.abort(),i(new Error("File removed"))}),c._onCancelAll(l.id,function(){u.abort(),i(new Error("Upload cancelled"))})})},pa._uploadRemoteFile=function(s,e,t){var a=this,u=this._getOptions(s);return new Promise(function(i,o){var t={};(Array.isArray(u.metaFields)?u.metaFields:Object.keys(s.meta)).forEach(function(e){t[e]=s.meta[e]}),new(s.remote.providerOptions.provider?Jo:Qo)(a.uppy,s.remote.providerOptions).post(s.remote.url,Yo({},s.remote.body,{endpoint:u.endpoint,size:s.data.size,fieldname:u.fieldName,metadata:t,httpMethod:u.method,useFormData:u.formData,headers:u.headers})).then(function(e){var t=e.token,e=No(s.remote.companionUrl),n=new Zo({target:e+"/api/"+t,autoOpen:!1});a.uploaderEvents[s.id]=new Vo(a.uppy),a._onFileRemoved(s.id,function(){n.send("pause",{}),r.abort(),i("upload "+s.id+" was removed")}),a._onCancelAll(s.id,function(){n.send("pause",{}),r.abort(),i("upload "+s.id+" was canceled")}),a._onRetry(s.id,function(){n.send("pause",{}),n.send("resume",{})}),a._onRetryAll(s.id,function(){n.send("pause",{}),n.send("resume",{})}),n.on("progress",function(e){return Ho(a,e,s)}),n.on("success",function(e){var t=u.getResponseData(e.response.responseText,e.response),n=t[u.responseUrlFieldName],n={status:e.response.status,body:t,uploadURL:n};return a.uppy.emit("upload-success",s,n),r.done(),a.uploaderEvents[s.id]&&(a.uploaderEvents[s.id].remove(),a.uploaderEvents[s.id]=null),i()}),n.on("error",function(e){var t=e.response,e=t?u.getResponseError(t.responseText,t):Yo(new Error(e.error.message),{cause:e.error});a.uppy.emit("upload-error",s,e),r.done(),a.uploaderEvents[s.id]&&(a.uploaderEvents[s.id].remove(),a.uploaderEvents[s.id]=null),o(e)});var r=a.requests.run(function(){return n.open(),s.isPaused&&n.send("pause",{}),function(){return n.close()}})}).catch(function(e){a.uppy.emit("upload-error",s,e),o(e)})})},rs);function rs(e,t){this.uppy=e,this.opts=Yo({validateStatus:function(e,t,n){return 200<=e&&e<300}},t),this.requests=t.__queue,this.uploaderEvents=Object.create(null),this.i18n=t.i18n}function is(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function os(){return(os=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,r=arguments[t];for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}var ss="function"==typeof URL?URL:Mo,as=We.RequestClient;function us(e,t){var n=e.indexOf("<"+t+">"),r=e.indexOf("</"+t+">",n);return-1!==n&&-1!==r?e.slice(n+t.length+2,r):""}function ls(e){if(e&&e.error){var t=new Error(e.message);throw os(t,e.error),t}return e}var cs=!1,ps=(Ls=ha=function(i){var e;function t(e,t){var n;(n=i.call(this,e,t)||this).type="uploader",n.id=n.opts.id||"AwsS3",n.title="AWS S3",n.defaultLocale={strings:{timedOut:"Upload stalled for %{seconds} seconds, aborting."}};var r={timeout:3e4,limit:0,metaFields:[],getUploadParameters:n.getUploadParameters.bind(is(n))};return n.opts=os({},r,t),n.i18nInit(),n.client=new as(e,t),n.handleUpload=n.handleUpload.bind(is(n)),n.requests=new zo(n.opts.limit),n}n=i,(e=t).prototype=Object.create(n.prototype),(e.prototype.constructor=e).__proto__=n;var n=t.prototype;return n.setOptions=function(e){i.prototype.setOptions.call(this,e),this.i18nInit()},n.i18nInit=function(){this.translator=new C([this.defaultLocale,this.uppy.locale,this.opts.locale]),this.i18n=this.translator.translate.bind(this.translator),this.setPluginState()},n.getUploadParameters=function(t){if(!this.opts.companionUrl)throw new Error("Expected a `companionUrl` option containing a Companion address.");var e=t.meta.name,n=t.meta.type,r={};this.opts.metaFields.forEach(function(e){null!=t.meta[e]&&(r[e]=t.meta[e].toString())});n=function e(t,n){var r,i,o,s=[];for(r in t)qo.call(t,r)&&(o=t[r],i=encodeURIComponent(r),o="object"==typeof o?e(o,n?n+"["+i+"]":i):(n?n+"["+i+"]":i)+"="+encodeURIComponent(o),s.push(o));return s.join("&")}({filename:e,type:n,metadata:r});return this.client.get("s3/params?"+n).then(ls)},n.validateParameters=function(e,t){if("object"!=typeof t||!t||"string"!=typeof t.url||"object"!=typeof t.fields&&null!=t.fields){var n=new TypeError("AwsS3: got incorrect result from 'getUploadParameters()' for file '"+e.name+"', expected an object '{ url, method, fields, headers }' but got '"+JSON.stringify(t)+"' instead.\nSee https://uppy.io/docs/aws-s3/#getUploadParameters-file for more on the expected format.");throw console.error(n),n}if(null!=t.method&&!/^(put|post)$/i.test(t.method)){t=new TypeError("AwsS3: got incorrect method from 'getUploadParameters()' for file '"+e.name+"', expected  'put' or 'post' but got '"+t.method+"' instead.\nSee https://uppy.io/docs/aws-s3/#getUploadParameters-file for more on the expected format.");throw console.error(t),t}},n.handleUpload=function(e){var a=this,u=Object.create(null);function t(e){e=e.id;w(u,e)&&u[e].abort()}this.uppy.on("file-removed",t),e.forEach(function(e){e=a.uppy.getFile(e);a.uppy.emit("upload-started",e)});var n=this.requests.wrapPromiseFunction(function(e){return a.opts.getUploadParameters(e)}),l=e.length;return Lo(e.map(function(o,s){return u[o]=n(a.uppy.getFile(o)),u[o].then(function(e){delete u[o];var t=a.uppy.getFile(o);a.validateParameters(t,e);var n=e.method,r=void 0===n?"post":n,i=e.url,n=e.fields,e=e.headers,i={method:r,formData:"post"===r.toLowerCase(),endpoint:i,metaFields:n?Object.keys(n):[]};return e&&(i.headers=e),a.uppy.setFileState(t.id,{meta:os({},t.meta,n),xhrUpload:i}),a._uploader.uploadFile(t.id,s,l)}).catch(function(e){delete u[o];var t=a.uppy.getFile(o);a.uppy.emit("upload-error",t,e)})})).then(function(e){return a.uppy.off("file-removed",t),e})},n.install=function(){var i=this.uppy;this.uppy.addUploader(this.handleUpload);var e={fieldName:"file",responseUrlFieldName:"location",timeout:this.opts.timeout,__queue:this.requests,responseType:"text",getResponseData:this.opts.getResponseData||function(e,t){var n,r;return ts(e,t)?{location:(n=t.responseURL,r=us(e,"Location"),(n?new ss(r,n):new ss(r)).toString()),bucket:us(e,"Bucket"),key:us(e,"Key"),etag:us(e,"ETag")}:"POST"===this.method.toUpperCase()?(cs||(i.log("[AwsS3] No response data found, make sure to set the success_action_status AWS SDK option to 201. See https://uppy.io/docs/aws-s3/#POST-Uploads","warning"),cs=!0),{location:null}):t.responseURL?{location:t.responseURL.replace(/\?.*$/,"")}:{location:null}},getResponseError:function(e,t){if(ts(e,t)){e=us(e,"Message");return new Error(e)}}};e.i18n=this.i18n,this._uploader=new ns(this.uppy,e)},n.uninstall=function(){this.uppy.removePreProcessor(this.handleUpload)},t}(ue.Plugin),ha.VERSION="1.7.3",Ls),ds={};function hs(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function fs(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ys(e,t,n){return t&&fs(e.prototype,t),n&&fs(e,n),e}function gs(e){return(gs=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ms(e,t){return(ms=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function vs(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function bs(e,t,n){return(bs="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){e=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=gs(e)););return e}(e,t);if(e){t=Object.getOwnPropertyDescriptor(e,t);return t.get?t.get.call(n):t.value}})(e,t,n||e)}Object.defineProperty(ds,"__esModule",{value:!0});var ws=(ys(Ps,[{key:"addEventListener",value:function(e,t){e in this.listeners||(this.listeners[e]=[]),this.listeners[e].push(t)}},{key:"removeEventListener",value:function(e,t){if(e in this.listeners)for(var n=this.listeners[e],r=0,i=n.length;r<i;r++)if(n[r]===t)return void n.splice(r,1)}},{key:"dispatchEvent",value:function(t){var n=this;if(t.type in this.listeners){for(var e=this.listeners[t.type],r=0,i=e.length;r<i;r++)!function(e){setTimeout(function(){return e.call(n,t)})}(e[r]);return!t.defaultPrevented}}}]),Ps),_s=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ms(e,t)}(i,ws);var n,r,t=(n=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}(),function(){var e,t=gs(n);return!(t=r?(e=gs(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments))||"object"!=typeof t&&"function"!=typeof t?vs(this):t});function i(){var e;return hs(this,i),(e=t.call(this)).listeners||ws.call(vs(e)),Object.defineProperty(vs(e),"aborted",{value:!1,writable:!0,configurable:!0}),Object.defineProperty(vs(e),"onabort",{value:null,writable:!0,configurable:!0}),e}return ys(i,[{key:"toString",value:function(){return"[object AbortSignal]"}},{key:"dispatchEvent",value:function(e){"abort"===e.type&&(this.aborted=!0,"function"==typeof this.onabort&&this.onabort.call(this,e)),bs(gs(i.prototype),"dispatchEvent",this).call(this,e)}}]),i}(),Ss=(ys(ks,[{key:"abort",value:function(){var t;try{t=new Event("abort")}catch(e){"undefined"!=typeof document?document.createEvent?(t=document.createEvent("Event")).initEvent("abort",!1,!1):(t=document.createEventObject()).type="abort":t={type:"abort",bubbles:!1,cancelable:!1}}this.signal.dispatchEvent(t)}},{key:"toString",value:function(){return"[object AbortController]"}}]),ks);function ks(){hs(this,ks),Object.defineProperty(this,"signal",{value:new _s,writable:!0,configurable:!0})}function Ps(){hs(this,Ps),Object.defineProperty(this,"listeners",{value:{},writable:!0,configurable:!0})}"undefined"!=typeof Symbol&&Symbol.toStringTag&&(Ss.prototype[Symbol.toStringTag]="AbortController",_s.prototype[Symbol.toStringTag]="AbortSignal"),ds.AbortController=Ss,ds.AbortSignal=_s;o={},A=ds.AbortController;ds.AbortSignal,o.AbortController=A,o.createAbortError=function(t){void 0===t&&(t="Aborted");try{return new DOMException(t,"AbortError")}catch(e){t=new Error(t);return t.name="AbortError",t}};var Cs=o.createAbortError;function Fs(){return(Fs=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,r=arguments[t];for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}var As=o.AbortController,Es=o.createAbortError,Os={limit:1,retryDelays:[0,1e3,3e3,5e3],getChunkSize:function(e){return Math.ceil(e.size/1e4)},onStart:function(){},onProgress:function(){},onPartComplete:function(){},onSuccess:function(){},onError:function(e){throw e}};function Us(e){if("string"==typeof e)return parseInt(e,10);if("number"==typeof e)return e;throw new TypeError("Expected a number")}var Rs=((ne=Ts.prototype)._aborted=function(){return this.abortController.signal.aborted},ne._initChunks=function(){var e=[],t=this.options.getChunkSize(this.file),n=Math.max(5242880,Math.ceil(this.file.size/1e4)),r=Math.max(t,n);if(0===this.file.size)e.push(this.file);else for(var i=0;i<this.file.size;i+=r){var o=Math.min(this.file.size,i+r);e.push(this.file.slice(i,o))}this.chunks=e,this.chunkState=e.map(function(){return{uploaded:0,busy:!1,done:!1}})},ne._createUpload=function(){var t=this;return this.createdPromise=Promise.resolve().then(function(){return t.options.createMultipartUpload()}),this.createdPromise.then(function(e){if(t._aborted())throw Es();if("object"!=typeof e||!e||"string"!=typeof e.uploadId||"string"!=typeof e.key)throw new TypeError("AwsS3/Multipart: Got incorrect result from `createMultipartUpload()`, expected an object `{ uploadId, key }`.");t.key=e.key,t.uploadId=e.uploadId,t.options.onStart(e),t._uploadParts()}).catch(function(e){t._onError(e)})},ne._resumeUpload=function(){var n=this;return Promise.resolve().then(function(){return n.options.listParts({uploadId:n.uploadId,key:n.key})}).then(function(e){if(n._aborted())throw Es();e.forEach(function(t){var e=t.PartNumber-1;n.chunkState[e]={uploaded:Us(t.Size),etag:t.ETag,done:!0},n.parts.some(function(e){return e.PartNumber===t.PartNumber})||n.parts.push({PartNumber:t.PartNumber,ETag:t.ETag})}),n._uploadParts()}).catch(function(e){n._onError(e)})},ne._uploadParts=function(){var t=this;if(!this.isPaused){var e=this.options.limit-this.partsInProgress;if(0!=e)if(this.chunkState.every(function(e){return e.done}))this._completeUpload();else{for(var n=[],r=0;r<this.chunkState.length;r++){var i=this.chunkState[r];if(!i.done&&!i.busy&&(n.push(r),n.length>=e))break}n.forEach(function(e){t._uploadPartRetryable(e).then(function(){t._uploadParts()},function(e){t._onError(e)})})}}},ne._retryable=function(e){var r=this,t=e.before,i=e.attempt,n=e.after,a=this.options.retryDelays,u=this.abortController.signal;return t&&t(),function e(n){return i().catch(function(t){if(r._aborted())throw Es();if(function(){if(t.source&&"number"==typeof t.source.status){var e=t.source.status;return 0===e||409===e||423===e||500<=e&&e<600}}()&&n<a.length)return o=a[n],s={signal:u},new Promise(function(e,t){if(s&&s.signal&&s.signal.aborted)return t(Cs());function n(){clearTimeout(r),i(),t(Cs())}var r=setTimeout(function(){i(),e()},o);function i(){s&&s.signal&&s.signal.removeEventListener("abort",n)}s&&s.signal&&s.signal.addEventListener("abort",n)}).then(function(){return e(n+1)});var o,s;throw t})}(0).then(function(e){return n&&n(),e},function(e){throw n&&n(),e})},ne._uploadPartRetryable=function(e){var t=this;return this._retryable({before:function(){t.partsInProgress+=1},attempt:function(){return t._uploadPart(e)},after:function(){--t.partsInProgress}})},ne._uploadPart=function(n){var r=this,e=this.chunks[n];return this.chunkState[n].busy=!0,Promise.resolve().then(function(){return r.options.prepareUploadPart({key:r.key,uploadId:r.uploadId,body:e,number:n+1})}).then(function(e){if("object"!=typeof e||!e||"string"!=typeof e.url)throw new TypeError("AwsS3/Multipart: Got incorrect result from `prepareUploadPart()`, expected an object `{ url }`.");return e}).then(function(e){var t=e.url,e=e.headers;if(r._aborted())throw r.chunkState[n].busy=!1,Es();return r._uploadPartBytes(n,t,e)})},ne._onPartProgress=function(e,t,n){this.chunkState[e].uploaded=Us(t);t=this.chunkState.reduce(function(e,t){return e+t.uploaded},0);this.options.onProgress(t,this.file.size)},ne._onPartComplete=function(e,t){this.chunkState[e].etag=t,this.chunkState[e].done=!0;t={PartNumber:e+1,ETag:t};this.parts.push(t),this.options.onPartComplete(t)},ne._uploadPartBytes=function(n,e,t){var r,i=this,o=this.chunks[n],s=this.abortController.signal,a=new Promise(function(e,t){r={resolve:e,reject:t}}),u=new XMLHttpRequest;function l(){s.removeEventListener("abort",c)}function c(){u.abort()}return u.open("PUT",e,!0),t&&Object.keys(t).map(function(e){u.setRequestHeader(e,t[e])}),u.responseType="text",s.addEventListener("abort",c),u.upload.addEventListener("progress",function(e){e.lengthComputable&&i._onPartProgress(n,e.loaded,e.total)}),u.addEventListener("abort",function(e){l(),i.chunkState[n].busy=!1,r.reject(Es())}),u.addEventListener("load",function(e){if(l(),i.chunkState[n].busy=!1,e.target.status<200||300<=e.target.status){var t=new Error("Non 2xx");return t.source=e.target,void r.reject(t)}i._onPartProgress(n,o.size,o.size);e=e.target.getResponseHeader("ETag");null!==e?(i._onPartComplete(n,e),r.resolve()):r.reject(new Error("AwsS3/Multipart: Could not read the ETag header. This likely means CORS is not configured correctly on the S3 Bucket. Seee https://uppy.io/docs/aws-s3-multipart#S3-Bucket-Configuration for instructions."))}),u.addEventListener("error",function(e){l(),i.chunkState[n].busy=!1;var t=new Error("Unknown error");t.source=e.target,r.reject(t)}),u.send(o),a},ne._completeUpload=function(){var t=this;return this.parts.sort(function(e,t){return e.PartNumber-t.PartNumber}),Promise.resolve().then(function(){return t.options.completeMultipartUpload({key:t.key,uploadId:t.uploadId,parts:t.parts})}).then(function(e){t.options.onSuccess(e)},function(e){t._onError(e)})},ne._abortUpload=function(){var e=this;this.abortController.abort(),this.createdPromise.then(function(){e.options.abortMultipartUpload({key:e.key,uploadId:e.uploadId})},function(){})},ne._onError=function(e){e&&"AbortError"===e.name||this.options.onError(e)},ne.start=function(){this.isPaused=!1,this.uploadId?this._resumeUpload():this._createUpload()},ne.pause=function(){this.abortController.abort(),this.abortController=new As,this.isPaused=!0},ne.abort=function(e){if(!(e=void 0===e?{}:e).really)return this.pause();this._abortUpload()},Ts);function Ts(e,t){this.options=Fs({},Os,t),this.options.getChunkSize||(this.options.getChunkSize=Os.getChunkSize),this.file=e,this.abortController=new As,this.key=this.options.key||null,this.uploadId=this.options.uploadId||null,this.parts=[],this.createdPromise=Promise.reject(),this.isPaused=!1,this.partsInProgress=0,this.chunks=null,this.chunkState=null,this._initChunks(),this.createdPromise.catch(function(){})}function xs(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ds(){return(Ds=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,r=arguments[t];for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}var Bs=We.Socket,Is=We.Provider,js=We.RequestClient;function Ms(e){if(e&&e.error){var t=new Error(e.message);throw Ds(t,e.error),t}return e}var Ls=(ha=pa=function(r){var e;function t(e,t){var n;(n=r.call(this,e,t)||this).type="uploader",n.id=n.opts.id||"AwsS3Multipart",n.title="AWS S3 Multipart",n.client=new js(e,t);e={timeout:3e4,limit:0,retryDelays:[0,1e3,3e3,5e3],createMultipartUpload:n.createMultipartUpload.bind(xs(n)),listParts:n.listParts.bind(xs(n)),prepareUploadPart:n.prepareUploadPart.bind(xs(n)),abortMultipartUpload:n.abortMultipartUpload.bind(xs(n)),completeMultipartUpload:n.completeMultipartUpload.bind(xs(n))};return n.opts=Ds({},e,t),n.upload=n.upload.bind(xs(n)),n.requests=new zo(n.opts.limit),n.uploaders=Object.create(null),n.uploaderEvents=Object.create(null),n.uploaderSockets=Object.create(null),n}n=r,(e=t).prototype=Object.create(n.prototype),(e.prototype.constructor=e).__proto__=n;var n=t.prototype;return n.resetUploaderReferences=function(e,t){void 0===t&&(t={}),this.uploaders[e]&&(this.uploaders[e].abort({really:t.abort||!1}),this.uploaders[e]=null),this.uploaderEvents[e]&&(this.uploaderEvents[e].remove(),this.uploaderEvents[e]=null),this.uploaderSockets[e]&&(this.uploaderSockets[e].close(),this.uploaderSockets[e]=null)},n.assertHost=function(e){if(!this.opts.companionUrl)throw new Error("Expected a `companionUrl` option containing a Companion address, or if you are not using Companion, a custom `"+e+"` implementation.")},n.createMultipartUpload=function(t){this.assertHost("createMultipartUpload");var n={};return Object.keys(t.meta).map(function(e){null!=t.meta[e]&&(n[e]=t.meta[e].toString())}),this.client.post("s3/multipart",{filename:t.name,type:t.type,metadata:n}).then(Ms)},n.listParts=function(e,t){var n=t.key,t=t.uploadId;this.assertHost("listParts");n=encodeURIComponent(n);return this.client.get("s3/multipart/"+t+"?key="+n).then(Ms)},n.prepareUploadPart=function(e,t){var n=t.key,r=t.uploadId,t=t.number;this.assertHost("prepareUploadPart");n=encodeURIComponent(n);return this.client.get("s3/multipart/"+r+"/"+t+"?key="+n).then(Ms)},n.completeMultipartUpload=function(e,t){var n=t.key,r=t.uploadId,t=t.parts;this.assertHost("completeMultipartUpload");n=encodeURIComponent(n),r=encodeURIComponent(r);return this.client.post("s3/multipart/"+r+"/complete?key="+n,{parts:t}).then(Ms)},n.abortMultipartUpload=function(e,t){var n=t.key,t=t.uploadId;this.assertHost("abortMultipartUpload");n=encodeURIComponent(n),t=encodeURIComponent(t);return this.client.delete("s3/multipart/"+t+"?key="+n).then(Ms)},n.uploadFile=function(o){var s=this;return new Promise(function(n,t){var r=new Rs(o.data,Ds({createMultipartUpload:s.opts.createMultipartUpload.bind(s,o),listParts:s.opts.listParts.bind(s,o),prepareUploadPart:s.opts.prepareUploadPart.bind(s,o),completeMultipartUpload:s.opts.completeMultipartUpload.bind(s,o),abortMultipartUpload:s.opts.abortMultipartUpload.bind(s,o),getChunkSize:s.opts.getChunkSize?s.opts.getChunkSize.bind(s):null,onStart:function(e){var t=s.uppy.getFile(o.id);s.uppy.setFileState(o.id,{s3Multipart:Ds({},t.s3Multipart,{key:e.key,uploadId:e.uploadId})})},onProgress:function(e,t){s.uppy.emit("upload-progress",o,{uploader:s,bytesUploaded:e,bytesTotal:t})},onError:function(e){s.uppy.log(e),s.uppy.emit("upload-error",o,e),i.done(),s.resetUploaderReferences(o.id),t(e)},onSuccess:function(e){var t={body:Ds({},e),uploadURL:e.location};i.done(),s.resetUploaderReferences(o.id),s.uppy.emit("upload-success",o,t),e.location&&s.uppy.log("Download "+r.file.name+" from "+e.location),n(r)},onPartComplete:function(e){var t=s.uppy.getFile(o.id);t&&s.uppy.emit("s3-multipart:part-uploaded",t,e)},limit:s.opts.limit||5,retryDelays:s.opts.retryDelays||[]},o.s3Multipart));s.uploaders[o.id]=r,s.uploaderEvents[o.id]=new Vo(s.uppy);var i=s.requests.run(function(){return o.isPaused||r.start(),function(){}});s.onFileRemove(o.id,function(e){i.abort(),s.resetUploaderReferences(o.id,{abort:!0}),n("upload "+e.id+" was removed")}),s.onCancelAll(o.id,function(){i.abort(),s.resetUploaderReferences(o.id,{abort:!0}),n("upload "+o.id+" was canceled")}),s.onFilePause(o.id,function(e){e?(i.abort(),r.pause()):(i.abort(),i=s.requests.run(function(){return r.start(),function(){}}))}),s.onPauseAll(o.id,function(){i.abort(),r.pause()}),s.onResumeAll(o.id,function(){i.abort(),o.error&&r.abort(),i=s.requests.run(function(){return r.start(),function(){}})}),o.isRestored||s.uppy.emit("upload-started",o,r)})},n.uploadRemote=function(n){var r=this;return this.resetUploaderReferences(n.id),this.uppy.emit("upload-started",n),n.serverToken?this.connectToServerSocket(n):new Promise(function(e,t){new(n.remote.providerOptions.provider?Is:js)(r.uppy,n.remote.providerOptions).post(n.remote.url,Ds({},n.remote.body,{protocol:"s3-multipart",size:n.data.size,metadata:n.meta})).then(function(e){return r.uppy.setFileState(n.id,{serverToken:e.token}),n=r.uppy.getFile(n.id)}).then(function(e){return r.connectToServerSocket(e)}).then(function(){e()}).catch(function(e){r.uppy.emit("upload-error",n,e),t(e)})})},n.connectToServerSocket=function(s){var a=this;return new Promise(function(t,n){var e=s.serverToken,r=No(s.remote.companionUrl),i=new Bs({target:r+"/api/"+e,autoOpen:!1});a.uploaderSockets[s.id]=i,a.uploaderEvents[s.id]=new Vo(a.uppy),a.onFileRemove(s.id,function(e){o.abort(),i.send("pause",{}),a.resetUploaderReferences(s.id,{abort:!0}),t("upload "+s.id+" was removed")}),a.onFilePause(s.id,function(e){e?(o.abort(),i.send("pause",{})):(o.abort(),o=a.requests.run(function(){return i.send("resume",{}),function(){}}))}),a.onPauseAll(s.id,function(){o.abort(),i.send("pause",{})}),a.onCancelAll(s.id,function(){o.abort(),i.send("pause",{}),a.resetUploaderReferences(s.id),t("upload "+s.id+" was canceled")}),a.onResumeAll(s.id,function(){o.abort(),s.error&&i.send("pause",{}),o=a.requests.run(function(){i.send("resume",{})})}),a.onRetry(s.id,function(){i.isOpen&&(i.send("pause",{}),i.send("resume",{}))}),a.onRetryAll(s.id,function(){i.isOpen&&(i.send("pause",{}),i.send("resume",{}))}),i.on("progress",function(e){return Ho(a,e,s)}),i.on("error",function(e){a.uppy.emit("upload-error",s,new Error(e.error)),a.resetUploaderReferences(s.id),o.done(),n(new Error(e.error))}),i.on("success",function(e){e={uploadURL:e.url};a.uppy.emit("upload-success",s,e),a.resetUploaderReferences(s.id),o.done(),t()});var o=a.requests.run(function(){return i.open(),s.isPaused&&i.send("pause",{}),function(){}})})},n.upload=function(e){var t=this;if(0===e.length)return Promise.resolve();e=e.map(function(e){e=t.uppy.getFile(e);return e.isRemote?t.uploadRemote(e):t.uploadFile(e)});return Promise.all(e)},n.onFileRemove=function(t,n){this.uploaderEvents[t].on("file-removed",function(e){t===e.id&&n(e.id)})},n.onFilePause=function(n,r){this.uploaderEvents[n].on("upload-pause",function(e,t){n===e&&r(t)})},n.onRetry=function(t,n){this.uploaderEvents[t].on("upload-retry",function(e){t===e&&n()})},n.onRetryAll=function(t,n){var r=this;this.uploaderEvents[t].on("retry-all",function(e){r.uppy.getFile(t)&&n()})},n.onPauseAll=function(e,t){var n=this;this.uploaderEvents[e].on("pause-all",function(){n.uppy.getFile(e)&&t()})},n.onCancelAll=function(e,t){var n=this;this.uploaderEvents[e].on("cancel-all",function(){n.uppy.getFile(e)&&t()})},n.onResumeAll=function(e,t){var n=this;this.uploaderEvents[e].on("resume-all",function(){n.uppy.getFile(e)&&t()})},n.install=function(){var e=this.uppy.getState().capabilities;this.uppy.setState({capabilities:Ds({},e,{resumableUploads:!0})}),this.uppy.addUploader(this.upload)},n.uninstall=function(){var e=this.uppy.getState().capabilities;this.uppy.setState({capabilities:Ds({},e,{resumableUploads:!1})}),this.uppy.removeUploader(this.upload)},t}(ue.Plugin),pa.VERSION="1.8.9",ha),Ns={exports:{}};(function(n){!function(){var e,t;e="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==n?n:this,t=function(t){"use strict";function n(e){if(e.length<2)return(t=e.charCodeAt(0))<128?e:t<2048?p(192|t>>>6)+p(128|63&t):p(224|t>>>12&15)+p(128|t>>>6&63)+p(128|63&t);var t=65536+1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320);return p(240|t>>>18&7)+p(128|t>>>12&63)+p(128|t>>>6&63)+p(128|63&t)}function r(e){return e.replace(d,n)}function i(e){var t=[0,2,1][e.length%3],e=e.charCodeAt(0)<<16|(1<e.length?e.charCodeAt(1):0)<<8|(2<e.length?e.charCodeAt(2):0);return[l.charAt(e>>>18),l.charAt(e>>>12&63),2<=t?"=":l.charAt(e>>>6&63),1<=t?"=":l.charAt(63&e)].join("")}function o(e){return h(r(String(e)))}function u(e){return e.replace(/[+\/]/g,function(e){return"+"==e?"-":"_"}).replace(/=/g,"")}function s(e,t){return t?u(o(e)):o(e)}var e,a=(t=t||{}).Base64,l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",c=function(e){for(var t={},n=0,r=e.length;n<r;n++)t[e.charAt(n)]=n;return t}(l),p=String.fromCharCode,d=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,h=t.btoa&&"function"==typeof t.btoa?function(e){return t.btoa(e)}:function(e){if(e.match(/[^\x00-\xFF]/))throw new RangeError("The string contains invalid characters.");return e.replace(/[\s\S]{1,3}/g,i)};t.Uint8Array&&(e=function(e,t){for(var n="",r=0,i=e.length;r<i;r+=3){var o=e[r],s=e[r+1],a=e[r+2],o=o<<16|s<<8|a;n+=l.charAt(o>>>18)+l.charAt(o>>>12&63)+(void 0!==s?l.charAt(o>>>6&63):"=")+(void 0!==a?l.charAt(63&o):"=")}return t?u(n):n});function f(e){switch(e.length){case 4:var t=((7&e.charCodeAt(0))<<18|(63&e.charCodeAt(1))<<12|(63&e.charCodeAt(2))<<6|63&e.charCodeAt(3))-65536;return p(55296+(t>>>10))+p(56320+(1023&t));case 3:return p((15&e.charCodeAt(0))<<12|(63&e.charCodeAt(1))<<6|63&e.charCodeAt(2));default:return p((31&e.charCodeAt(0))<<6|63&e.charCodeAt(1))}}function y(e){return e.replace(S,f)}function g(e){var t=e.length,n=t%4,e=(0<t?c[e.charAt(0)]<<18:0)|(1<t?c[e.charAt(1)]<<12:0)|(2<t?c[e.charAt(2)]<<6:0)|(3<t?c[e.charAt(3)]:0);return(e=[p(e>>>16),p(e>>>8&255),p(255&e)]).length-=[0,0,2,1][n],e.join("")}function m(e){return k(String(e).replace(/[^A-Za-z0-9\+\/]/g,""))}function v(e){return String(e).replace(/[-_]/g,function(e){return"-"==e?"+":"/"}).replace(/[^A-Za-z0-9\+\/]/g,"")}function b(e){return e=v(e),y(k(e))}var w,_,S=/[\xC0-\xDF][\x80-\xBF]|[\xE0-\xEF][\x80-\xBF]{2}|[\xF0-\xF7][\x80-\xBF]{3}/g,k=t.atob&&"function"==typeof t.atob?function(e){return t.atob(e)}:function(e){return e.replace(/\S{1,4}/g,g)};return t.Uint8Array&&(w=function(e){return Uint8Array.from(m(v(e)),function(e){return e.charCodeAt(0)})}),t.Base64={VERSION:"2.6.4",atob:m,btoa:h,fromBase64:b,toBase64:s,utob:r,encode:s,encodeURI:function(e){return s(e,!0)},btou:y,decode:b,noConflict:function(){var e=t.Base64;return t.Base64=a,e},fromUint8Array:e,toUint8Array:w},"function"==typeof Object.defineProperty&&(_=function(e){return{value:e,enumerable:!1,writable:!0,configurable:!0}},t.Base64.extendString=function(){Object.defineProperty(String.prototype,"fromBase64",_(function(){return b(this)})),Object.defineProperty(String.prototype,"toBase64",_(function(e){return s(this,e)})),Object.defineProperty(String.prototype,"toBase64URI",_(function(){return s(this,!0)}))}),t.Meteor&&(Base64=t.Base64),Ns.exports&&(Ns.exports.Base64=t.Base64),{Base64:t.Base64}},"object"==typeof Ns.exports?Ns.exports=t(e):t(e)}.call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});Ns=Ns.exports,Ss={};function zs(e){return(zs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function qs(e){var n="function"==typeof Map?new Map:void 0;return(qs=function(e){if(null===e||-1===Function.toString.call(e).indexOf("[native code]"))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==n){if(n.has(e))return n.get(e);n.set(e,t)}function t(){return Hs(e,arguments,Xs(this).constructor)}return t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),Ws(t,e)})(e)}function Hs(e,t,n){return(Hs=Vs()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);r=new(Function.bind.apply(e,r));return n&&Ws(r,n.prototype),r}).apply(null,arguments)}function Vs(){if("undefined"!=typeof Reflect&&Reflect.construct&&!Reflect.construct.sham){if("function"==typeof Proxy)return 1;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),1}catch(e){return}}}function Ws(e,t){return(Ws=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Xs(e){return(Xs=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Object.defineProperty(Ss,"__esModule",{value:!0}),Ss.default=void 0;ds=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ws(e,t)}(u,qs(Error));var n,a=function(){var e,t=Xs(n);return e=Vs()?(e=Xs(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),t=this,!(e=e)||"object"!==zs(e)&&"function"!=typeof e?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(t):e};function u(e){var t,n,r,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,o=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,s=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return function(e){if(!(e instanceof u))throw new TypeError("Cannot call a class as a function")}(this),(t=a.call(this,e)).originalRequest=o,t.originalResponse=s,null!=(t.causingError=i)&&(e+=", caused by ".concat(i.toString())),null!=o&&(n=o.getHeader("X-Request-ID")||"n/a",r=o.getMethod(),i=o.getURL(),o=s?s.getStatus():"n/a",s=s?s.getBody()||"":"n/a",e+=", originated from request (method: ".concat(r,", url: ").concat(i,", response code: ").concat(o,", response text: ").concat(s,", request id: ").concat(n,")")),t.message=e,t}return n=u}();Ss.default=ds;var Gs={};Object.defineProperty(Gs,"__esModule",{value:!0}),Gs.enableDebugLog=function(){Ks=!0};var Ks=!(Gs.log=function(e){Ks&&console.log(e)}),A={};Object.defineProperty(A,"__esModule",{value:!0}),A.default=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)})};o={};Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;var $s=Qs(Mo),Ys=Qs(Ss),Js=Qs(A);function Qs(e){return e&&e.__esModule?e:{default:e}}function Zs(t,e){var n,r=Object.keys(t);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(t),e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)),r}function ea(r){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?Zs(Object(i),!0).forEach(function(e){var t,n;t=r,e=i[n=e],n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(i)):Zs(Object(i)).forEach(function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(i,e))})}return r}function ta(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}ne=[{key:"terminate",value:function(r){var i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};if("function"==typeof i||"function"==typeof(2<arguments.length?arguments[2]:void 0))throw new Error("tus: the terminate function does not accept a callback since v2 anymore; please use the returned Promise instead");var o=oa("DELETE",r,i);return sa(o,null,i).then(function(e){if(204!==e.getStatus())throw new Ys.default("tus: unexpected response while terminating upload",null,o,e)}).catch(function(e){if(!aa(e=!(e instanceof Ys.default)?new Ys.default("tus: failed to terminate upload",e,o,null):e,0,i))throw e;var t=i.retryDelays[0],e=i.retryDelays.slice(1),n=ea({},i,{retryDelays:e});return new Promise(function(e){return setTimeout(e,t)}).then(function(){return na.terminate(r,n)})})}}],pa=[{key:"findPreviousUploads",value:function(){var t=this;return this.options.fingerprint(this.file,this.options).then(function(e){return t._urlStorage.findUploadsByFingerprint(e)})}},{key:"resumeFromPreviousUpload",value:function(e){this.url=e.uploadUrl||null,this._parallelUploadUrls=e.parallelUploadUrls||null,this._urlStorageKey=e.urlStorageKey}},{key:"start",value:function(){var e,t=this,n=this.file;n?this.options.endpoint||this.options.uploadUrl?null==(e=this.options.retryDelays)||"[object Array]"===Object.prototype.toString.call(e)?(1<this.options.parallelUploads&&["uploadUrl","uploadSize","uploadLengthDeferred"].forEach(function(e){t.options[e]&&t._emitError(new Error("tus: cannot use the ".concat(e," option when parallelUploads is enabled")))}),this.options.fingerprint(n,this.options).then(function(e){return null==e?(0,Gs.log)("No fingerprint was calculated meaning that the upload cannot be stored in the URL storage."):(0,Gs.log)("Calculated fingerprint: ".concat(e)),t._fingerprint=e,t._source||t.options.fileReader.openFile(n,t.options.chunkSize)}).then(function(e){t._source=e,1<t.options.parallelUploads||null!=t._parallelUploadUrls?t._startParallelUpload():t._startSingleUpload()}).catch(function(e){t._emitError(e)})):this._emitError(new Error("tus: the `retryDelays` option must either be an array or null")):this._emitError(new Error("tus: neither an endpoint or an upload URL is provided")):this._emitError(new Error("tus: no file or stream to upload provided"))}},{key:"_startParallelUpload",value:function(){var a=this,u=this._size=this._source.size,l=0;this._parallelUploads=[];var e=null!=this._parallelUploadUrls?this._parallelUploadUrls.length:this.options.parallelUploads,c=function(e,t,n){for(var r=Math.floor(e/t),i=[],o=0;o<t;o++)i.push({start:r*o,end:r*(o+1)});return i[t-1].end=e,n&&i.forEach(function(e,t){e.uploadUrl=n[t]||null}),i}(this._source.size,e,this._parallelUploadUrls);this._parallelUploadUrls=new Array(c.length);var n,e=c.map(function(i,o){var s=0;return a._source.slice(i.start,i.end).then(function(e){var r=e.value;return new Promise(function(e,t){var t=ea({},a.options,{uploadUrl:i.uploadUrl||null,storeFingerprintForResuming:!1,removeFingerprintOnSuccess:!1,parallelUploads:1,metadata:{},headers:ea({},a.options.headers,{"Upload-Concat":"partial"}),onSuccess:e,onError:t,onProgress:function(e){l=l-s+e,s=e,a._emitProgress(l,u)},_onUploadUrlAvailable:function(){a._parallelUploadUrls[o]=n.url,a._parallelUploadUrls.filter(function(e){return!!e}).length===c.length&&a._saveUploadInUrlStorage()}}),n=new na(r,t);n.start(),a._parallelUploads.push(n)})})});Promise.all(e).then(function(){(n=a._openRequest("POST",a.options.endpoint)).setHeader("Upload-Concat","final;".concat(a._parallelUploadUrls.join(" ")));var e=ra(a.options.metadata);return""!==e&&n.setHeader("Upload-Metadata",e),a._sendRequest(n,null)}).then(function(e){var t;ia(e.getStatus(),200)?null!=(t=e.getHeader("Location"))?(a.url=ua(a.options.endpoint,t),(0,Gs.log)("Created upload at ".concat(a.url)),a._emitSuccess()):a._emitHttpError(n,e,"tus: invalid or missing Location header"):a._emitHttpError(n,e,"tus: unexpected response while creating upload")}).catch(function(e){a._emitError(e)})}},{key:"_startSingleUpload",value:function(){if(this.options.uploadLengthDeferred)this._size=null;else if(null!=this.options.uploadSize){if(this._size=+this.options.uploadSize,isNaN(this._size))return void this._emitError(new Error("tus: cannot convert `uploadSize` option into a number"))}else if(this._size=this._source.size,null==this._size)return void this._emitError(new Error("tus: cannot automatically derive upload's size from input and must be specified manually using the `uploadSize` option"));return this._aborted=!1,null!=this.url?((0,Gs.log)("Resuming upload from previous URL: ".concat(this.url)),void this._resumeUpload()):null!=this.options.uploadUrl?((0,Gs.log)("Resuming upload from provided URL: ".concat(this.options.url)),this.url=this.options.uploadUrl,void this._resumeUpload()):((0,Gs.log)("Creating a new upload"),void this._createUpload())}},{key:"abort",value:function(t,e){var n=this;if("function"==typeof e)throw new Error("tus: the abort function does not accept a callback since v2 anymore; please use the returned Promise instead");return null!=this._parallelUploads&&this._parallelUploads.forEach(function(e){e.abort(t)}),null!==this._req&&(this._req.abort(),this._source.close()),this._aborted=!0,null!=this._retryTimeout&&(clearTimeout(this._retryTimeout),this._retryTimeout=null),t&&null!=this.url?na.terminate(this.url,this.options).then(function(){return n._removeFromUrlStorage()}):Promise.resolve()}},{key:"_emitHttpError",value:function(e,t,n,r){this._emitError(new Ys.default(n,r,e,t))}},{key:"_emitError",value:function(e){var t=this;if(!this._aborted){if(null!=this.options.retryDelays&&(null!=this._offset&&this._offset>this._offsetBeforeRetry&&(this._retryAttempt=0),aa(e,this._retryAttempt,this.options))){var n=this.options.retryDelays[this._retryAttempt++];return this._offsetBeforeRetry=this._offset,void(this._retryTimeout=setTimeout(function(){t.start()},n))}if("function"!=typeof this.options.onError)throw e;this.options.onError(e)}}},{key:"_emitSuccess",value:function(){this.options.removeFingerprintOnSuccess&&this._removeFromUrlStorage(),"function"==typeof this.options.onSuccess&&this.options.onSuccess()}},{key:"_emitProgress",value:function(e,t){"function"==typeof this.options.onProgress&&this.options.onProgress(e,t)}},{key:"_emitChunkComplete",value:function(e,t,n){"function"==typeof this.options.onChunkComplete&&this.options.onChunkComplete(e,t,n)}},{key:"_createUpload",value:function(){var n,e,r=this;this.options.endpoint?(n=this._openRequest("POST",this.options.endpoint),this.options.uploadLengthDeferred?n.setHeader("Upload-Defer-Length",1):n.setHeader("Upload-Length",this._size),""!==(e=ra(this.options.metadata))&&n.setHeader("Upload-Metadata",e),(this.options.uploadDataDuringCreation&&!this.options.uploadLengthDeferred?(this._offset=0,this._addChunkToRequest(n)):this._sendRequest(n,null)).then(function(e){if(ia(e.getStatus(),200)){var t=e.getHeader("Location");if(null!=t){if(r.url=ua(r.options.endpoint,t),(0,Gs.log)("Created upload at ".concat(r.url)),"function"==typeof r.options._onUploadUrlAvailable&&r.options._onUploadUrlAvailable(),0===r._size)return r._emitSuccess(),void r._source.close();r._saveUploadInUrlStorage(),r.options.uploadDataDuringCreation?r._handleUploadResponse(n,e):(r._offset=0,r._performUpload())}else r._emitHttpError(n,e,"tus: invalid or missing Location header")}else r._emitHttpError(n,e,"tus: unexpected response while creating upload")}).catch(function(e){r._emitHttpError(n,null,"tus: failed to create upload",e)})):this._emitError(new Error("tus: unable to create upload because no endpoint is provided"))}},{key:"_resumeUpload",value:function(){var r=this,i=this._openRequest("HEAD",this.url);this._sendRequest(i,null).then(function(e){var t=e.getStatus();if(!ia(t,200))return ia(t,400)&&r._removeFromUrlStorage(),423===t?void r._emitHttpError(i,e,"tus: upload is currently locked; retry later"):r.options.endpoint?(r.url=null,void r._createUpload()):void r._emitHttpError(i,e,"tus: unable to resume upload (new upload cannot be created without an endpoint)");var n=parseInt(e.getHeader("Upload-Offset"),10);if(isNaN(n))r._emitHttpError(i,e,"tus: invalid or missing offset value");else{t=parseInt(e.getHeader("Upload-Length"),10);if(!isNaN(t)||r.options.uploadLengthDeferred){if("function"==typeof r.options._onUploadUrlAvailable&&r.options._onUploadUrlAvailable(),n===t)return r._emitProgress(t,t),void r._emitSuccess();r._offset=n,r._performUpload()}else r._emitHttpError(i,e,"tus: invalid or missing length value")}}).catch(function(e){r._emitHttpError(i,null,"tus: failed to resume upload",e)})}},{key:"_performUpload",value:function(){var t,n=this;this._aborted||(this.options.overridePatchMethod?(t=this._openRequest("POST",this.url)).setHeader("X-HTTP-Method-Override","PATCH"):t=this._openRequest("PATCH",this.url),t.setHeader("Upload-Offset",this._offset),this._addChunkToRequest(t).then(function(e){ia(e.getStatus(),200)?n._handleUploadResponse(t,e):n._emitHttpError(t,e,"tus: unexpected response while uploading chunk")}).catch(function(e){n._aborted||n._emitHttpError(t,null,"tus: failed to upload chunk at offset "+n._offset,e)}))}},{key:"_addChunkToRequest",value:function(n){var r=this,t=this._offset,e=this._offset+this.options.chunkSize;return n.setProgressHandler(function(e){r._emitProgress(t+e,r._size)}),n.setHeader("Content-Type","application/offset+octet-stream"),(e===1/0||e>this._size)&&!this.options.uploadLengthDeferred&&(e=this._size),this._source.slice(t,e).then(function(e){var t=e.value,e=e.done;return r.options.uploadLengthDeferred&&e&&(r._size=r._offset+(t&&t.size?t.size:0),n.setHeader("Upload-Length",r._size)),null===t?r._sendRequest(n):(r._emitProgress(r._offset,r._size),r._sendRequest(n,t))})}},{key:"_handleUploadResponse",value:function(e,t){var n=parseInt(t.getHeader("Upload-Offset"),10);if(isNaN(n))this._emitHttpError(e,t,"tus: invalid or missing offset value");else{if(this._emitProgress(n,this._size),this._emitChunkComplete(n-this._offset,n,this._size),(this._offset=n)==this._size)return this._emitSuccess(),void this._source.close();this._performUpload()}}},{key:"_openRequest",value:function(e,t){t=oa(e,t,this.options);return this._req=t}},{key:"_removeFromUrlStorage",value:function(){var t=this;this._urlStorageKey&&(this._urlStorage.removeUpload(this._urlStorageKey).catch(function(e){t._emitError(e)}),this._urlStorageKey=null)}},{key:"_saveUploadInUrlStorage",value:function(){var e,t=this;this.options.storeFingerprintForResuming&&this._fingerprint&&(e={size:this._size,metadata:this.options.metadata,creationTime:(new Date).toString()},this._parallelUploads?e.parallelUploadUrls=this._parallelUploadUrls:e.uploadUrl=this.url,this._urlStorage.addUpload(this._fingerprint,e).then(function(e){return t._urlStorageKey=e}).catch(function(e){t._emitError(e)}))}},{key:"_sendRequest",value:function(e){return sa(e,1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,this.options)}}],ta((ha=na).prototype,pa),ta(ha,ne),ds=na;function na(e,t){!function(e){if(!(e instanceof na))throw new TypeError("Cannot call a class as a function")}(this),"resume"in t&&console.log("tus: The `resume` option has been removed in tus-js-client v2. Please use the URL storage API instead."),this.options=t,this._urlStorage=this.options.urlStorage,this.file=e,this.url=null,this._req=null,this._fingerprint=null,this._urlStorageKey=null,this._offset=null,this._aborted=!1,this._size=null,this._source=null,this._retryAttempt=0,this._retryTimeout=null,this._offsetBeforeRetry=0,this._parallelUploads=null,this._parallelUploadUrls=null}function ra(e){var t,n=[];for(t in e)n.push(t+" "+Ns.Base64.encode(e[t]));return n.join(",")}function ia(e,t){return t<=e&&e<t+100}function oa(e,t,n){var r=n.httpStack.createRequest(e,t);r.setHeader("Tus-Resumable","1.0.0");var i,o=n.headers||{};for(i in o)r.setHeader(i,o[i]);return n.addRequestId&&(n=(0,Js.default)(),r.setHeader("X-Request-ID",n)),r}function sa(t,e,n){return("function"==typeof n.onBeforeRequest?Promise.resolve(n.onBeforeRequest(t)):Promise.resolve()).then(function(){return t.send(e).then(function(e){return("function"==typeof n.onAfterResponse?Promise.resolve(n.onAfterResponse(t,e)):Promise.resolve()).then(function(){return e})})})}function aa(e,t,n){if(!(null==n.retryDelays||t>=n.retryDelays.length||null==e.originalRequest)){if(n&&"function"==typeof n.onShouldRetry)return n.onShouldRetry(e,t,n);var e=e.originalResponse?e.originalResponse.getStatus():0;return(!ia(e,400)||409===e||423===e)&&(e=!0,e="undefined"!=typeof window&&"navigator"in window&&!1===window.navigator.onLine?!1:e)}}function ua(e,t){return new $s.default(t,e).toString()}ds.defaultOptions={endpoint:null,uploadUrl:null,metadata:{},fingerprint:null,uploadSize:null,onProgress:null,onChunkComplete:null,onSuccess:null,onError:null,_onUploadUrlAvailable:null,overridePatchMethod:!1,headers:{},addRequestId:!1,onBeforeRequest:null,onAfterResponse:null,onShouldRetry:null,chunkSize:1/0,retryDelays:[0,1e3,3e3,5e3],parallelUploads:1,storeFingerprintForResuming:!0,removeFingerprintOnSuccess:!1,uploadLengthDeferred:!1,uploadDataDuringCreation:!1,urlStorage:null,fileReader:null,httpStack:null},o.default=ds;Ss={};Object.defineProperty(Ss,"__esModule",{value:!0}),Ss.default=void 0;(function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}})(la.prototype,[{key:"listAllUploads",value:function(){return Promise.resolve([])}},{key:"findUploadsByFingerprint",value:function(e){return Promise.resolve([])}},{key:"removeUpload",value:function(e){return Promise.resolve()}},{key:"addUpload",value:function(e,t){return Promise.resolve(null)}}]),A=la;function la(){!function(e){if(!(e instanceof la))throw new TypeError("Cannot call a class as a function")}(this)}Ss.default=A;var ca={};Object.defineProperty(ca,"__esModule",{value:!0}),ca.WebStorageUrlStorage=ca.canStoreURLs=void 0;var pa=!1;try{var pa="localStorage"in window,da="tusSupport";localStorage.setItem(da,localStorage.getItem(da))}catch(e){if(e.code!==e.SECURITY_ERR&&e.code!==e.QUOTA_EXCEEDED_ERR)throw e;pa=!1}var ha=pa;ca.canStoreURLs=ha;ne=[{key:"findAllUploads",value:function(){var e=this._findEntries("tus::");return Promise.resolve(e)}},{key:"findUploadsByFingerprint",value:function(e){e=this._findEntries("tus::".concat(e,"::"));return Promise.resolve(e)}},{key:"removeUpload",value:function(e){return localStorage.removeItem(e),Promise.resolve()}},{key:"addUpload",value:function(e,t){var n=Math.round(1e12*Math.random()),n="tus::".concat(e,"::").concat(n);return localStorage.setItem(n,JSON.stringify(t)),Promise.resolve(n)}},{key:"_findEntries",value:function(e){for(var t=[],n=0;n<localStorage.length;n++){var r=localStorage.key(n);if(0===r.indexOf(e))try{var i=JSON.parse(localStorage.getItem(r));i.urlStorageKey=r,t.push(i)}catch(e){}}return t}}],function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(fa.prototype,ne),ds=fa;function fa(){!function(e){if(!(e instanceof fa))throw new TypeError("Cannot call a class as a function")}(this)}ca.WebStorageUrlStorage=ds;A={};function ya(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ga(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ma(e,t,n){return t&&ga(e.prototype,t),n&&ga(e,n),e}Object.defineProperty(A,"__esModule",{value:!0}),A.default=void 0;ma(va,[{key:"createRequest",value:function(e,t){return new ba(e,t)}},{key:"getName",value:function(){return"XHRHttpStack"}}]),da=va;function va(){ya(this,va)}A.default=da;var ba=(ma(Sa,[{key:"getMethod",value:function(){return this._method}},{key:"getURL",value:function(){return this._url}},{key:"setHeader",value:function(e,t){this._xhr.setRequestHeader(e,t),this._headers[e]=t}},{key:"getHeader",value:function(e){return this._headers[e]}},{key:"setProgressHandler",value:function(t){"upload"in this._xhr&&(this._xhr.upload.onprogress=function(e){e.lengthComputable&&t(e.loaded)})}},{key:"send",value:function(){var n=this,r=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null;return new Promise(function(e,t){n._xhr.onload=function(){e(new wa(n._xhr))},n._xhr.onerror=function(e){t(e)},n._xhr.send(r)})}},{key:"abort",value:function(){return this._xhr.abort(),Promise.resolve()}},{key:"getUnderlyingObject",value:function(){return this._xhr}}]),Sa),wa=(ma(_a,[{key:"getStatus",value:function(){return this._xhr.status}},{key:"getHeader",value:function(e){return this._xhr.getResponseHeader(e)}},{key:"getBody",value:function(){return this._xhr.responseText}},{key:"getUnderlyingObject",value:function(){return this._xhr}}]),_a),pa={};function _a(e){ya(this,_a),this._xhr=e}function Sa(e,t){ya(this,Sa),this._xhr=new XMLHttpRequest,this._xhr.open(e,t,!0),this._method=e,this._url=t,this._headers={}}Object.defineProperty(pa,"__esModule",{value:!0}),pa.default=void 0,pa.default=function(){return"undefined"!=typeof navigator&&"string"==typeof navigator.product&&"reactnative"===navigator.product.toLowerCase()};ha={};Object.defineProperty(ha,"__esModule",{value:!0}),ha.default=function(e){return new Promise(function(t,n){var r=new XMLHttpRequest;r.responseType="blob",r.onload=function(){var e=r.response;t(e)},r.onerror=function(e){n(e)},r.open("GET",e),r.send()})};ne={};Object.defineProperty(ne,"__esModule",{value:!0}),ne.default=void 0,ne.default=function(){return"undefined"!=typeof window&&(void 0!==window.PhoneGap||void 0!==window.Cordova||void 0!==window.cordova)};ds={};Object.defineProperty(ds,"__esModule",{value:!0}),ds.default=function(e){return new Promise(function(t,n){var r=new FileReader;r.onload=function(){var e=new Uint8Array(r.result);t({value:e})},r.onerror=function(e){n(e)},r.readAsArrayBuffer(e)})};da={};Object.defineProperty(da,"__esModule",{value:!0}),da.default=void 0;var ka=Aa(pa),Pa=Aa(ha),Ca=Aa(ne),Fa=Aa(ds);function Aa(e){return e&&e.__esModule?e:{default:e}}function Ea(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Oa(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ua(e,t,n){return t&&Oa(e.prototype,t),n&&Oa(e,n),e}var Ra=(Ua(Da,[{key:"slice",value:function(e,t){if((0,Ca.default)())return(0,Fa.default)(this._file.slice(e,t));t=this._file.slice(e,t);return Promise.resolve({value:t})}},{key:"close",value:function(){}}]),Da),Ta=(Ua(xa,[{key:"slice",value:function(e,t){return e<this._bufferOffset?Promise.reject(new Error("Requested data is before the reader's current offset")):this._readUntilEnoughDataOrDone(e,t)}},{key:"_readUntilEnoughDataOrDone",value:function(n,r){var i=this,e=r<=this._bufferOffset+Ba(this._buffer);if(this._done||e){var t=this._getDataFromBuffer(n,r),e=null==t&&this._done;return Promise.resolve({value:t,done:e})}return this._reader.read().then(function(e){var t=e.value;return e.done?i._done=!0:void 0===i._buffer?i._buffer=t:i._buffer=function(e,t){if(e.concat)return e.concat(t);if(e instanceof Blob)return new Blob([e,t],{type:e.type});if(e.set){var n=new e.constructor(e.length+t.length);return n.set(e),n.set(t,e.length),n}throw new Error("Unknown data type")}(i._buffer,t),i._readUntilEnoughDataOrDone(n,r)})}},{key:"_getDataFromBuffer",value:function(e,t){e>this._bufferOffset&&(this._buffer=this._buffer.slice(e-this._bufferOffset),this._bufferOffset=e);var n=0===Ba(this._buffer);return this._done&&n?null:this._buffer.slice(0,t-e)}},{key:"close",value:function(){this._reader.cancel&&this._reader.cancel()}}]),xa);function xa(e,t){Ea(this,xa),this._chunkSize=t,this._buffer=void 0,this._bufferOffset=0,this._reader=e,this._done=!1}function Da(e){Ea(this,Da),this._file=e,this.size=e.size}function Ba(e){return void 0===e?0:void 0!==e.size?e.size:e.length}Ua(Ia,[{key:"openFile",value:function(e,t){return(0,ka.default)()&&e&&void 0!==e.uri?(0,Pa.default)(e.uri).then(function(e){return new Ra(e)}).catch(function(e){throw new Error("tus: cannot fetch `file.uri` as Blob, make sure the uri is correct and accessible. "+e)}):"function"==typeof e.slice&&void 0!==e.size?Promise.resolve(new Ra(e)):"function"==typeof e.read?(t=+t,isFinite(t)?Promise.resolve(new Ta(e,t)):Promise.reject(new Error("cannot create source for stream without a finite value for the `chunkSize` option"))):Promise.reject(new Error("source object may only be an instance of File, Blob, or Reader in this environment"))}}]),ds=Ia;function Ia(){Ea(this,Ia)}da.default=ds;ds={};Object.defineProperty(ds,"__esModule",{value:!0}),ds.default=function(e,t){return(0,ja.default)()?Promise.resolve((r=t,i=(n=e).exif?function(e){var t=0;if(0===e.length)return t;for(var n=0;n<e.length;n++)t=(t<<5)-t+e.charCodeAt(n),t&=t;return t}(JSON.stringify(n.exif)):"noexif",["tus-rn",n.name||"noname",n.size||"nosize",i,r.endpoint].join("/"))):Promise.resolve(["tus-br",e.name,e.type,e.size,e.lastModified,t.endpoint].join("-"));var n,r,i};var ja=pa&&pa.__esModule?pa:{default:pa},Ma={};Object.defineProperty(Ma,"__esModule",{value:!0}),Object.defineProperty(Ma,"enableDebugLog",{enumerable:!0,get:function(){return Gs.enableDebugLog}}),Object.defineProperty(Ma,"canStoreURLs",{enumerable:!0,get:function(){return ca.canStoreURLs}}),Object.defineProperty(Ma,"HttpStack",{enumerable:!0,get:function(){return Na.default}}),Ma.defaultOptions=Ma.Upload=void 0;var La=za(o),o=za(Ss),Na=za(A),Ss=za(da),A=za(ds);function za(e){return e&&e.__esModule?e:{default:e}}function qa(e){return(qa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ha(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Va(e,t){return(Va=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Wa(e){return(Wa=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Xa(t,e){var n,r=Object.keys(t);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(t),e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)),r}function Ga(r){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?Xa(Object(i),!0).forEach(function(e){var t,n;t=r,e=i[n=e],n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(i)):Xa(Object(i)).forEach(function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(i,e))})}return r}var Ka=Ga({},La.default.defaultOptions,{httpStack:new Na.default,fileReader:new Ss.default,urlStorage:new(ca.canStoreURLs?ca.WebStorageUrlStorage:o.default),fingerprint:A.default});Ma.defaultOptions=Ka;da=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Va(e,t)}(i,La.default);var n,r=function(){var e,t=Wa(n);return e=function(){if("undefined"!=typeof Reflect&&Reflect.construct&&!Reflect.construct.sham){if("function"==typeof Proxy)return 1;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),1}catch(e){return}}}()?(e=Wa(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),t=this,!(e=e)||"object"!==qa(e)&&"function"!=typeof e?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(t):e};function i(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return function(e){if(!(e instanceof i))throw new TypeError("Cannot call a class as a function")}(this),t=Ga({},Ka,{},t),r.call(this,e,t)}return Ha(n=i,[{key:"terminate",value:function(e,t,n){return t=Ga({},Ka,{},t),La.default.terminate(e,t,n)}}]),i}();Ma.Upload=da;ds=window,Ss=ds.XMLHttpRequest,o=ds.Blob;function $a(){return($a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,r=arguments[t];for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function Ya(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}Ss&&o&&o.prototype.slice;var Ja=We.Provider,Qa=We.RequestClient,Za=We.Socket,eu={endpoint:"",uploadUrl:null,metadata:{},uploadSize:null,onProgress:null,onChunkComplete:null,onSuccess:null,onError:null,overridePatchMethod:!1,headers:{},addRequestId:!1,chunkSize:1/0,retryDelays:[0,1e3,3e3,5e3],parallelUploads:1,storeFingerprintForResuming:!0,removeFingerprintOnSuccess:!1,uploadLengthDeferred:!1,uploadDataDuringCreation:!1},tu=(da=A=function(n){var e;function t(e,t){return(e=n.call(this,e,t)||this).type="uploader",e.id=e.opts.id||"Tus",e.title="Tus",e.opts=$a({},{autoRetry:!0,resume:!0,useFastRemoteRetry:!0,limit:0,retryDelays:[0,1e3,3e3,5e3],withCredentials:!1},t),e.requests=new zo(e.opts.limit),e.uploaders=Object.create(null),e.uploaderEvents=Object.create(null),e.uploaderSockets=Object.create(null),e.handleResetProgress=e.handleResetProgress.bind(Ya(e)),e.handleUpload=e.handleUpload.bind(Ya(e)),e}r=n,(e=t).prototype=Object.create(r.prototype),(e.prototype.constructor=e).__proto__=r;var r=t.prototype;return r.handleResetProgress=function(){var n=$a({},this.uppy.getState().files);Object.keys(n).forEach(function(e){var t;n[e].tus&&n[e].tus.uploadUrl&&(delete(t=$a({},n[e].tus)).uploadUrl,n[e]=$a({},n[e],{tus:t}))}),this.uppy.setState({files:n})},r.resetUploaderReferences=function(e,t){var n;void 0===t&&(t={}),this.uploaders[e]&&((n=this.uploaders[e]).abort(),t.abort&&setTimeout(function(){return n.abort(!0)},1e3),this.uploaders[e]=null),this.uploaderEvents[e]&&(this.uploaderEvents[e].remove(),this.uploaderEvents[e]=null),this.uploaderSockets[e]&&(this.uploaderSockets[e].close(),this.uploaderSockets[e]=null)},r.upload=function(l,e,t){var c=this;return this.resetUploaderReferences(l.id),new Promise(function(t,n){c.uppy.emit("upload-started",l);var r,i=$a({},c.opts,l.tus||{}),e=$a({},eu,i);delete e.resume,i.resume&&(e.storeFingerprintForResuming=!0),e.fingerprint=(r=l,function(e,t){if("undefined"!=typeof window&&(void 0!==window.PhoneGap||void 0!==window.Cordova||void 0!==window.cordova)||"undefined"!=typeof navigator&&"string"==typeof navigator.product&&"reactnative"===navigator.product.toLowerCase())return Ma.defaultOptions.fingerprint(e,t);t=["tus",r.id,t.endpoint].join("-");return Promise.resolve(t)}),e.onBeforeRequest=function(e){e.getUnderlyingObject().withCredentials=!!i.withCredentials,"function"==typeof i.onBeforeRequest&&i.onBeforeRequest(e)},e.onError=function(e){c.uppy.log(e);var t=e.originalRequest?e.originalRequest.getUnderlyingObject():null;Xo(t)&&(e=new Ie(e,t)),c.resetUploaderReferences(l.id),u.done(),c.uppy.emit("upload-error",l,e),n(e)},e.onProgress=function(e,t){c.onReceiveUploadUrl(l,a.url),c.uppy.emit("upload-progress",l,{uploader:c,bytesUploaded:e,bytesTotal:t})},e.onSuccess=function(){var e={uploadURL:a.url};c.resetUploaderReferences(l.id),u.done(),c.uppy.emit("upload-success",l,e),a.url&&c.uppy.log("Download "+a.file.name+" from "+a.url),t(a)};function o(e,t,n){w(e,t)&&!w(e,n)&&(e[n]=e[t])}var s={};(Array.isArray(i.metaFields)?i.metaFields:Object.keys(l.meta)).forEach(function(e){s[e]=l.meta[e]}),o(s,"type","filetype"),o(s,"name","filename"),e.metadata=s;var a=new Ma.Upload(l.data,e);c.uploaders[l.id]=a,c.uploaderEvents[l.id]=new Vo(c.uppy),i.resume&&a.findPreviousUploads().then(function(e){e=e[0];e&&(c.uppy.log("[Tus] Resuming upload of "+l.id+" started at "+e.creationTime),a.resumeFromPreviousUpload(e))});var u=c.requests.run(function(){return l.isPaused||Promise.resolve().then(function(){a.start()}),function(){}});c.onFileRemove(l.id,function(e){u.abort(),c.resetUploaderReferences(l.id,{abort:!!a.url}),t("upload "+e+" was removed")}),c.onPause(l.id,function(e){e?(u.abort(),a.abort()):(u.abort(),u=c.requests.run(function(){return a.start(),function(){}}))}),c.onPauseAll(l.id,function(){u.abort(),a.abort()}),c.onCancelAll(l.id,function(){u.abort(),c.resetUploaderReferences(l.id,{abort:!!a.url}),t("upload "+l.id+" was canceled")}),c.onResumeAll(l.id,function(){u.abort(),l.error&&a.abort(),u=c.requests.run(function(){return a.start(),function(){}})})}).catch(function(e){throw c.uppy.emit("upload-error",l,e),e})},r.uploadRemote=function(n,e,t){var r=this;this.resetUploaderReferences(n.id);var i=$a({},this.opts);return n.tus&&$a(i,n.tus),this.uppy.emit("upload-started",n),this.uppy.log(n.remote.url),n.serverToken?this.connectToServerSocket(n):new Promise(function(e,t){new(n.remote.providerOptions.provider?Ja:Qa)(r.uppy,n.remote.providerOptions).post(n.remote.url,$a({},n.remote.body,{endpoint:i.endpoint,uploadUrl:i.uploadUrl,protocol:"tus",size:n.data.size,headers:i.headers,metadata:n.meta})).then(function(e){return r.uppy.setFileState(n.id,{serverToken:e.token}),n=r.uppy.getFile(n.id),r.connectToServerSocket(n)}).then(function(){e()}).catch(function(e){r.uppy.emit("upload-error",n,e),t(e)})})},r.connectToServerSocket=function(s){var a=this;return new Promise(function(t,n){var e=s.serverToken,r=No(s.remote.companionUrl),i=new Za({target:r+"/api/"+e,autoOpen:!1});a.uploaderSockets[s.id]=i,a.uploaderEvents[s.id]=new Vo(a.uppy),a.onFileRemove(s.id,function(){o.abort(),i.send("pause",{}),i.send("cancel",{}),a.resetUploaderReferences(s.id),t("upload "+s.id+" was removed")}),a.onPause(s.id,function(e){e?(o.abort(),i.send("pause",{})):(o.abort(),o=a.requests.run(function(){return i.send("resume",{}),function(){}}))}),a.onPauseAll(s.id,function(){o.abort(),i.send("pause",{})}),a.onCancelAll(s.id,function(){o.abort(),i.send("pause",{}),i.send("cancel",{}),a.resetUploaderReferences(s.id),t("upload "+s.id+" was canceled")}),a.onResumeAll(s.id,function(){o.abort(),s.error&&i.send("pause",{}),o=a.requests.run(function(){return i.send("resume",{}),function(){}})}),a.onRetry(s.id,function(){i.isOpen&&(i.send("pause",{}),i.send("resume",{}))}),a.onRetryAll(s.id,function(){i.isOpen&&(i.send("pause",{}),i.send("resume",{}))}),i.on("progress",function(e){return Ho(a,e,s)}),i.on("error",function(e){var t=e.error.message,e=$a(new Error(t),{cause:e.error});a.opts.useFastRemoteRetry?i.close():(a.resetUploaderReferences(s.id),a.uppy.setFileState(s.id,{serverToken:null})),a.uppy.emit("upload-error",s,e),o.done(),n(e)}),i.on("success",function(e){e={uploadURL:e.url};a.uppy.emit("upload-success",s,e),a.resetUploaderReferences(s.id),o.done(),t()});var o=a.requests.run(function(){return i.open(),s.isPaused&&i.send("pause",{}),function(){}})})},r.onReceiveUploadUrl=function(e,t){e=this.uppy.getFile(e.id);e&&(e.tus&&e.tus.uploadUrl===t||(this.uppy.log("[Tus] Storing upload url"),this.uppy.setFileState(e.id,{tus:$a({},e.tus,{uploadUrl:t})})))},r.onFileRemove=function(t,n){this.uploaderEvents[t].on("file-removed",function(e){t===e.id&&n(e.id)})},r.onPause=function(n,r){this.uploaderEvents[n].on("upload-pause",function(e,t){n===e&&r(t)})},r.onRetry=function(t,n){this.uploaderEvents[t].on("upload-retry",function(e){t===e&&n()})},r.onRetryAll=function(t,n){var r=this;this.uploaderEvents[t].on("retry-all",function(e){r.uppy.getFile(t)&&n()})},r.onPauseAll=function(e,t){var n=this;this.uploaderEvents[e].on("pause-all",function(){n.uppy.getFile(e)&&t()})},r.onCancelAll=function(e,t){var n=this;this.uploaderEvents[e].on("cancel-all",function(){n.uppy.getFile(e)&&t()})},r.onResumeAll=function(e,t){var n=this;this.uploaderEvents[e].on("resume-all",function(){n.uppy.getFile(e)&&t()})},r.uploadFiles=function(r){var i=this,e=r.map(function(e,t){var n=t+1,t=r.length;return"error"in e&&e.error?Promise.reject(new Error(e.error)):e.isRemote?i.uploadRemote(e,n,t):i.upload(e,n,t)});return Lo(e)},r.handleUpload=function(e){var t=this;if(0===e.length)return this.uppy.log("[Tus] No files to upload"),Promise.resolve();0===this.opts.limit&&this.uppy.log("[Tus] When uploading multiple files at once, consider setting the `limit` option (to `10` for example), to limit the number of concurrent uploads, which helps prevent memory and network issues: https://uppy.io/docs/tus/#limit-0","warning"),this.uppy.log("[Tus] Uploading...");e=e.map(function(e){return t.uppy.getFile(e)});return this.uploadFiles(e).then(function(){return null})},r.install=function(){this.uppy.setState({capabilities:$a({},this.uppy.getState().capabilities,{resumableUploads:!0})}),this.uppy.addUploader(this.handleUpload),this.uppy.on("reset-progress",this.handleResetProgress),this.opts.autoRetry&&this.uppy.on("back-online",this.uppy.retryAll)},r.uninstall=function(){this.uppy.setState({capabilities:$a({},this.uppy.getState().capabilities,{resumableUploads:!1})}),this.uppy.removeUploader(this.handleUpload),this.opts.autoRetry&&this.uppy.off("back-online",this.uppy.retryAll)},t}(ue.Plugin),A.VERSION="1.8.1",da),nu=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,ru=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],iu=function(e){var t=e,n=e.indexOf("["),r=e.indexOf("]");-1!=n&&-1!=r&&(e=e.substring(0,n)+e.substring(n,r).replace(/:/g,";")+e.substring(r,e.length));for(var i=nu.exec(e||""),o={},s=14;s--;)o[ru[s]]=i[s]||"";return-1!=n&&-1!=r&&(o.source=t,o.host=o.host.substring(1,o.host.length-1).replace(/;/g,":"),o.authority=o.authority.replace("[","").replace("]","").replace(/;/g,":"),o.ipv6uri=!0),o},ou=864e5;function su(e,t,n){if(!(e<t))return e<1.5*t?Math.floor(e/t)+" "+n:Math.ceil(e/t)+" "+n+"s"}var au={};function uu(e){var s;function a(){if(a.enabled){var r=a,e=+new Date,t=e-(s||e);r.diff=t,r.prev=s,r.curr=e,s=e;for(var i=new Array(arguments.length),n=0;n<i.length;n++)i[n]=arguments[n];i[0]=au.coerce(i[0]),"string"!=typeof i[0]&&i.unshift("%O");var o=0;i[0]=i[0].replace(/%([a-zA-Z%])/g,function(e,t){if("%%"===e)return e;o++;var n=au.formatters[t];return"function"==typeof n&&(t=i[o],e=n.call(r,t),i.splice(o,1),o--),e}),au.formatArgs.call(r,i),(a.log||au.log||console.log.bind(console)).apply(r,i)}}return a.namespace=e,a.enabled=au.enabled(e),a.useColors=au.useColors(),a.color=function(e){var t,n=0;for(t in e)n=(n<<5)-n+e.charCodeAt(t),n|=0;return au.colors[Math.abs(n)%au.colors.length]}(e),a.destroy=lu,"function"==typeof au.init&&au.init(a),au.instances.push(a),a}function lu(){var e=au.instances.indexOf(this);return-1!==e&&(au.instances.splice(e,1),!0)}(au=uu.debug=uu.default=uu).coerce=function(e){return e instanceof Error?e.stack||e.message:e},au.disable=function(){au.enable("")},au.enable=function(e){au.save(e),au.names=[],au.skips=[];for(var t=("string"==typeof e?e:"").split(/[\s,]+/),n=t.length,r=0;r<n;r++)t[r]&&("-"===(e=t[r].replace(/\*/g,".*?"))[0]?au.skips.push(new RegExp("^"+e.substr(1)+"$")):au.names.push(new RegExp("^"+e+"$")));for(r=0;r<au.instances.length;r++){var i=au.instances[r];i.enabled=au.enabled(i.namespace)}},au.enabled=function(e){if("*"===e[e.length-1])return!0;for(var t=0,n=au.skips.length;t<n;t++)if(au.skips[t].test(e))return!1;for(t=0,n=au.names.length;t<n;t++)if(au.names[t].test(e))return!0;return!1},au.humanize=function(n,e){e=e||{};var t,r=typeof n;if("string"==r&&0<n.length)return function(e){if(!(100<(e=String(n)).length)){e=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(e);if(e){var t=parseFloat(e[1]);switch((e[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*t;case"days":case"day":case"d":return t*ou;case"hours":case"hour":case"hrs":case"hr":case"h":return 36e5*t;case"minutes":case"minute":case"mins":case"min":case"m":return 6e4*t;case"seconds":case"second":case"secs":case"sec":case"s":return 1e3*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return t;default:return}}}}(n);if("number"==r&&!1===isNaN(n))return e.long?su(t=n,ou,"day")||su(t,36e5,"hour")||su(t,6e4,"minute")||su(t,1e3,"second")||t+" ms":ou<=(t=n)?Math.round(t/ou)+"d":36e5<=t?Math.round(t/36e5)+"h":6e4<=t?Math.round(t/6e4)+"m":1e3<=t?Math.round(t/1e3)+"s":t+"ms";throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(n))},au.instances=[],au.names=[],au.skips=[],au.formatters={};var cu={};!function(t){!function(){function e(){var e;try{e=cu.storage.debug}catch(e){}return e=!e&&void 0!==t&&"env"in t?t.env.DEBUG:e}(cu=au).log=function(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},cu.formatArgs=function(e){var t,n,r=this.useColors;e[0]=(r?"%c":"")+this.namespace+(r?" %c":" ")+e[0]+(r?"%c ":" ")+"+"+cu.humanize(this.diff),r&&(r="color: "+this.color,e.splice(1,0,r,"color: inherit"),e[n=t=0].replace(/%[a-zA-Z%]/g,function(e){"%%"!==e&&(t++,"%c"===e&&(n=t))}),e.splice(n,0,r))},cu.save=function(e){try{null==e?cu.storage.removeItem("debug"):cu.storage.debug=e}catch(e){}},cu.load=e,cu.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&31<=parseInt(RegExp.$1,10)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},cu.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(e){}}(),cu.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],cu.formatters.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}},cu.enable(e())}.call(this)}.call(this,tl);var pu=cu("socket.io-client:url"),du=function(e,t){var n=e;t=t||"undefined"!=typeof location&&location,"string"==typeof(e=null==e?t.protocol+"//"+t.host:e)&&("/"===e.charAt(0)&&(e="/"===e.charAt(1)?t.protocol+e:t.host+e),/^(https?|wss?):\/\//.test(e)||(pu("protocol-less url %s",e),e=void 0!==t?t.protocol+"//"+e:"https://"+e),pu("parse %s",e),n=iu(e)),n.port||(/^(http|ws)$/.test(n.protocol)?n.port="80":/^(http|ws)s$/.test(n.protocol)&&(n.port="443")),n.path=n.path||"/";e=-1!==n.host.indexOf(":")?"["+n.host+"]":n.host;return n.id=n.protocol+"://"+e+":"+n.port,n.href=n.protocol+"://"+e+(t&&t.port===n.port?"":":"+n.port),n};function hu(e,t,n){if(!(e<t))return e<1.5*t?Math.floor(e/t)+" "+n:Math.ceil(e/t)+" "+n+"s"}var fu={};function yu(e){var s;function a(){if(a.enabled){var r=a,e=+new Date,t=e-(s||e);r.diff=t,r.prev=s,r.curr=e,s=e;for(var i=new Array(arguments.length),n=0;n<i.length;n++)i[n]=arguments[n];i[0]=fu.coerce(i[0]),"string"!=typeof i[0]&&i.unshift("%O");var o=0;i[0]=i[0].replace(/%([a-zA-Z%])/g,function(e,t){if("%%"===e)return e;o++;var n=fu.formatters[t];return"function"==typeof n&&(t=i[o],e=n.call(r,t),i.splice(o,1),o--),e}),fu.formatArgs.call(r,i),(a.log||fu.log||console.log.bind(console)).apply(r,i)}}return a.namespace=e,a.enabled=fu.enabled(e),a.useColors=fu.useColors(),a.color=function(e){var t,n=0;for(t in e)n=(n<<5)-n+e.charCodeAt(t),n|=0;return fu.colors[Math.abs(n)%fu.colors.length]}(e),a.destroy=gu,"function"==typeof fu.init&&fu.init(a),fu.instances.push(a),a}function gu(){var e=fu.instances.indexOf(this);return-1!==e&&(fu.instances.splice(e,1),!0)}(fu=yu.debug=yu.default=yu).coerce=function(e){return e instanceof Error?e.stack||e.message:e},fu.disable=function(){fu.enable("")},fu.enable=function(e){fu.save(e),fu.names=[],fu.skips=[];for(var t=("string"==typeof e?e:"").split(/[\s,]+/),n=t.length,r=0;r<n;r++)t[r]&&("-"===(e=t[r].replace(/\*/g,".*?"))[0]?fu.skips.push(new RegExp("^"+e.substr(1)+"$")):fu.names.push(new RegExp("^"+e+"$")));for(r=0;r<fu.instances.length;r++){var i=fu.instances[r];i.enabled=fu.enabled(i.namespace)}},fu.enabled=function(e){if("*"===e[e.length-1])return!0;for(var t=0,n=fu.skips.length;t<n;t++)if(fu.skips[t].test(e))return!1;for(t=0,n=fu.names.length;t<n;t++)if(fu.names[t].test(e))return!0;return!1},fu.humanize=function(n,e){e=e||{};var t,r=typeof n;if("string"==r&&0<n.length)return function(e){if(!(100<(e=String(n)).length)){e=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(e);if(e){var t=parseFloat(e[1]);switch((e[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*t;case"days":case"day":case"d":return 864e5*t;case"hours":case"hour":case"hrs":case"hr":case"h":return 36e5*t;case"minutes":case"minute":case"mins":case"min":case"m":return 6e4*t;case"seconds":case"second":case"secs":case"sec":case"s":return 1e3*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return t;default:return}}}}(n);if("number"==r&&!1===isNaN(n))return e.long?hu(t=n,864e5,"day")||hu(t,36e5,"hour")||hu(t,6e4,"minute")||hu(t,1e3,"second")||t+" ms":864e5<=(t=n)?Math.round(t/864e5)+"d":36e5<=t?Math.round(t/36e5)+"h":6e4<=t?Math.round(t/6e4)+"m":1e3<=t?Math.round(t/1e3)+"s":t+"ms";throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(n))},fu.instances=[],fu.names=[],fu.skips=[],fu.formatters={};var mu={};function vu(e){if(e)return function(e){for(var t in vu.prototype)e[t]=vu.prototype[t];return e}(e)}!function(t){!function(){function e(){var e;try{e=mu.storage.debug}catch(e){}return e=!e&&void 0!==t&&"env"in t?t.env.DEBUG:e}(mu=fu).log=function(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},mu.formatArgs=function(e){var t,n,r=this.useColors;e[0]=(r?"%c":"")+this.namespace+(r?" %c":" ")+e[0]+(r?"%c ":" ")+"+"+mu.humanize(this.diff),r&&(r="color: "+this.color,e.splice(1,0,r,"color: inherit"),e[n=t=0].replace(/%[a-zA-Z%]/g,function(e){"%%"!==e&&(t++,"%c"===e&&(n=t))}),e.splice(n,0,r))},mu.save=function(e){try{null==e?mu.storage.removeItem("debug"):mu.storage.debug=e}catch(e){}},mu.load=e,mu.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&31<=parseInt(RegExp.$1,10)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},mu.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(e){}}(),mu.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],mu.formatters.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}},mu.enable(e())}.call(this)}.call(this,tl),((ds={exports:{}}).exports=vu).prototype.on=vu.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this},vu.prototype.once=function(e,t){function n(){this.off(e,n),t.apply(this,arguments)}return n.fn=t,this.on(e,n),this},vu.prototype.off=vu.prototype.removeListener=vu.prototype.removeAllListeners=vu.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n,r=this._callbacks["$"+e];if(!r)return this;if(1==arguments.length)return delete this._callbacks["$"+e],this;for(var i=0;i<r.length;i++)if((n=r[i])===t||n.fn===t){r.splice(i,1);break}return 0===r.length&&delete this._callbacks["$"+e],this},vu.prototype.emit=function(e){this._callbacks=this._callbacks||{};for(var t=new Array(arguments.length-1),n=this._callbacks["$"+e],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(n)for(var r=0,i=(n=n.slice(0)).length;r<i;++r)n[r].apply(this,t);return this},vu.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]},vu.prototype.hasListeners=function(e){return!!this.listeners(e).length};var ds=ds.exports,bu={}.toString,wu=Array.isArray||function(e){return"[object Array]"==bu.call(e)},_u={};!function(i){!function(){_u=function(e){return t&&i.isBuffer(e)||n&&(e instanceof ArrayBuffer||r(e))};var t="function"==typeof i&&"function"==typeof i.isBuffer,n="function"==typeof ArrayBuffer,r=function(e){return"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(e):e.buffer instanceof ArrayBuffer}}.call(this)}.call(this,t({}).Buffer);var Su={},Ss=Object.prototype.toString,ku="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===Ss.call(Blob),Pu="function"==typeof File||"undefined"!=typeof File&&"[object FileConstructor]"===Ss.call(File);Su.deconstructPacket=function(e){var t=[],n=e.data,e=e;return e.data=function e(t,n){if(!t)return t;if(_u(t)){var r={_placeholder:!0,num:n.length};return n.push(t),r}if(wu(t)){for(var i=new Array(t.length),o=0;o<t.length;o++)i[o]=e(t[o],n);return i}if("object"!=typeof t||t instanceof Date)return t;for(var s in i={},t)i[s]=e(t[s],n);return i}(n,t),e.attachments=t.length,{packet:e,buffers:t}},Su.reconstructPacket=function(e,t){return e.data=function e(t,n){if(!t)return t;if(t&&t._placeholder)return n[t.num];if(wu(t))for(var r=0;r<t.length;r++)t[r]=e(t[r],n);else if("object"==typeof t)for(var i in t)t[i]=e(t[i],n);return t}(e.data,t),e.attachments=void 0,e},Su.removeBlobs=function(e,a){var u=0,l=e;!function e(t,n,r){if(!t)return t;if(ku&&t instanceof Blob||Pu&&t instanceof File){u++;var i=new FileReader;i.onload=function(){r?r[n]=this.result:l=this.result,--u||a(l)},i.readAsArrayBuffer(t)}else if(wu(t))for(var o=0;o<t.length;o++)e(t[o],o,t);else if("object"==typeof t&&!_u(t))for(var s in t)e(t[s],s,t)}(l),u||a(l)};var Cu={},Fu=mu("socket.io-parser");function Au(){}Cu.protocol=4,Cu.types=["CONNECT","DISCONNECT","EVENT","ACK","ERROR","BINARY_EVENT","BINARY_ACK"],Cu.CONNECT=0,Cu.DISCONNECT=1,Cu.EVENT=2,Cu.ACK=3,Cu.ERROR=4,Cu.BINARY_EVENT=5,Cu.BINARY_ACK=6,Cu.Encoder=Au,Cu.Decoder=Uu;var Eu=Cu.ERROR+'"encode error"';function Ou(e){var t=""+e.type;if(Cu.BINARY_EVENT!==e.type&&Cu.BINARY_ACK!==e.type||(t+=e.attachments+"-"),e.nsp&&"/"!==e.nsp&&(t+=e.nsp+","),null!=e.id&&(t+=e.id),null!=e.data){var n=function(e){try{return JSON.stringify(e)}catch(e){return!1}}(e.data);if(!1===n)return Eu;t+=n}return Fu("encoded %j as %s",e,t),t}function Uu(){this.reconstructor=null}function Ru(e){this.reconPack=e,this.buffers=[]}function Tu(e){return{type:Cu.ERROR,data:"parser error: "+e}}function xu(e){if(e)return function(e){for(var t in xu.prototype)e[t]=xu.prototype[t];return e}(e)}Au.prototype.encode=function(e,t){var n;Fu("encoding packet %j",e),Cu.BINARY_EVENT===e.type||Cu.BINARY_ACK===e.type?(n=t,Su.removeBlobs(e,function(e){var t=Su.deconstructPacket(e),e=Ou(t.packet),t=t.buffers;t.unshift(e),n(t)})):t([Ou(e)])},ds(Uu.prototype),Uu.prototype.add=function(e){var t;if("string"==typeof e)t=function(e){var t=0,n={type:Number(e.charAt(0))};if(null==Cu.types[n.type])return Tu("unknown packet type "+n.type);if(Cu.BINARY_EVENT===n.type||Cu.BINARY_ACK===n.type){for(var r="";"-"!==e.charAt(++t)&&(r+=e.charAt(t),t!=e.length););if(r!=Number(r)||"-"!==e.charAt(t))throw new Error("Illegal attachments");n.attachments=Number(r)}if("/"===e.charAt(t+1))for(n.nsp="";++t&&","!==(i=e.charAt(t))&&(n.nsp+=i,t!==e.length););else n.nsp="/";var i,o=e.charAt(t+1);if(""!==o&&Number(o)==o){for(n.id="";++t;){if(null==(i=e.charAt(t))||Number(i)!=i){--t;break}if(n.id+=e.charAt(t),t===e.length)break}n.id=Number(n.id)}if(e.charAt(++t)){o=function(e){try{return JSON.parse(e)}catch(e){return!1}}(e.substr(t));if(!1===o||n.type!==Cu.ERROR&&!wu(o))return Tu("invalid payload");n.data=o}return Fu("decoded %s as %j",e,n),n}(e),Cu.BINARY_EVENT===t.type||Cu.BINARY_ACK===t.type?(this.reconstructor=new Ru(t),0===this.reconstructor.reconPack.attachments&&this.emit("decoded",t)):this.emit("decoded",t);else{if(!_u(e)&&!e.base64)throw new Error("Unknown type: "+e);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");(t=this.reconstructor.takeBinaryData(e))&&(this.reconstructor=null,this.emit("decoded",t))}},Uu.prototype.destroy=function(){this.reconstructor&&this.reconstructor.finishedReconstruction()},Ru.prototype.takeBinaryData=function(e){if(this.buffers.push(e),this.buffers.length!==this.reconPack.attachments)return null;e=Su.reconstructPacket(this.reconPack,this.buffers);return this.finishedReconstruction(),e},Ru.prototype.finishedReconstruction=function(){this.reconPack=null,this.buffers=[]},((o={exports:{}}).exports=xu).prototype.on=xu.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this},xu.prototype.once=function(e,t){function n(){this.off(e,n),t.apply(this,arguments)}return n.fn=t,this.on(e,n),this},xu.prototype.off=xu.prototype.removeListener=xu.prototype.removeAllListeners=xu.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n,r=this._callbacks["$"+e];if(!r)return this;if(1==arguments.length)return delete this._callbacks["$"+e],this;for(var i=0;i<r.length;i++)if((n=r[i])===t||n.fn===t){r.splice(i,1);break}return this},xu.prototype.emit=function(e){this._callbacks=this._callbacks||{};var t=[].slice.call(arguments,1),n=this._callbacks["$"+e];if(n)for(var r=0,i=(n=n.slice(0)).length;r<i;++r)n[r].apply(this,t);return this},xu.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]},xu.prototype.hasListeners=function(e){return!!this.listeners(e).length};function Du(e,t){if(Bu)return e.indexOf(t);for(var n=0;n<e.length;++n)if(e[n]===t)return n;return-1}var o=o.exports,Bu=[].indexOf,Iu={encode:function(e){var t,n="";for(t in e)e.hasOwnProperty(t)&&(n.length&&(n+="&"),n+=encodeURIComponent(t)+"="+encodeURIComponent(e[t]));return n},decode:function(e){for(var t={},n=e.split("&"),r=0,i=n.length;r<i;r++){var o=n[r].split("=");t[decodeURIComponent(o[0])]=decodeURIComponent(o[1])}return t}},A=Object.keys||function(e){var t,n=[],r=Object.prototype.hasOwnProperty;for(t in e)r.call(e,t)&&n.push(t);return n},ju={}.toString,Mu=Array.isArray||function(e){return"[object Array]"==ju.call(e)},Lu={};!function(a){!function(){var e=Object.prototype.toString,o="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===e.call(Blob),s="function"==typeof File||"undefined"!=typeof File&&"[object FileConstructor]"===e.call(File);Lu=function e(t){if(!t||"object"!=typeof t)return!1;if(Mu(t)){for(var n=0,r=t.length;n<r;n++)if(e(t[n]))return!0;return!1}if("function"==typeof a&&a.isBuffer&&a.isBuffer(t)||"function"==typeof ArrayBuffer&&t instanceof ArrayBuffer||o&&t instanceof Blob||s&&t instanceof File)return!0;if(t.toJSON&&"function"==typeof t.toJSON&&1===arguments.length)return e(t.toJSON(),!0);for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)&&e(t[i]))return!0;return!1}}.call(this)}.call(this,t({}).Buffer);function Nu(e,t,n){var r=e.byteLength;if(t=t||0,n=n||r,e.slice)return e.slice(t,n);if(t<0&&(t+=r),n<0&&(n+=r),r<n&&(n=r),r<=t||n<=t||0===r)return new ArrayBuffer(0);for(var i=new Uint8Array(e),o=new Uint8Array(n-t),s=t,a=0;s<n;s++,a++)o[a]=i[s];return o.buffer}function zu(){}var qu,Hu,Vu,Wu=String.fromCharCode;function Xu(e){for(var t,n,r=[],i=0,o=e.length;i<o;)55296<=(t=e.charCodeAt(i++))&&t<=56319&&i<o?56320==(64512&(n=e.charCodeAt(i++)))?r.push(((1023&t)<<10)+(1023&n)+65536):(r.push(t),i--):r.push(t);return r}function Gu(e,t){if(!(55296<=e&&e<=57343))return 1;if(t)throw Error("Lone surrogate U+"+e.toString(16).toUpperCase()+" is not a scalar value")}function Ku(e,t){return Wu(e>>t&63|128)}function $u(){if(Hu<=Vu)throw Error("Invalid byte index");var e=255&qu[Vu];if(Vu++,128==(192&e))return 63&e;throw Error("Invalid continuation byte")}function Yu(e,t){for(var n=!1!==(t=t||{}).strict,r=Xu(e),i=r.length,o=-1,s="";++o<i;)s+=function(e,t){if(0==(4294967168&e))return Wu(e);var n="";return 0==(4294965248&e)?n=Wu(e>>6&31|192):0==(4294901760&e)?(Gu(e,t)||(e=65533),n=Wu(e>>12&15|224),n+=Ku(e,6)):0==(4292870144&e)&&(n=Wu(e>>18&7|240),n+=Ku(e,12),n+=Ku(e,6)),n+Wu(63&e|128)}(r[o],n);return s}function Ju(e,t){var n=!1!==(t=t||{}).strict;qu=Xu(e),Hu=qu.length,Vu=0;for(var r,i=[];!1!==(r=function(e){var t,n;if(Hu<Vu)throw Error("Invalid byte index");if(Vu==Hu)return!1;if(t=255&qu[Vu],Vu++,0==(128&t))return t;if(192==(224&t)){if(128<=(n=(31&t)<<6|$u()))return n;throw Error("Invalid continuation byte")}if(224==(240&t)){if(2048<=(n=(15&t)<<12|$u()<<6|$u()))return Gu(n,e)?n:65533;throw Error("Invalid continuation byte")}if(240==(248&t)&&65536<=(n=(7&t)<<18|$u()<<12|$u()<<6|$u())&&n<=1114111)return n;throw Error("Invalid UTF-8 detected")}(n));)i.push(r);return function(e){for(var t,n=e.length,r=-1,i="";++r<n;)65535<(t=e[r])&&(i+=Wu((t-=65536)>>>10&1023|55296),t=56320|1023&t),i+=Wu(t);return i}(i)}var Qu={};!function(){"use strict";for(var o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",c=new Uint8Array(256),e=0;e<o.length;e++)c[o.charCodeAt(e)]=e;Qu.encode=function(e){for(var t=new Uint8Array(e),n=t.length,r="",i=0;i<n;i+=3)r+=o[t[i]>>2],r+=o[(3&t[i])<<4|t[i+1]>>4],r+=o[(15&t[i+1])<<2|t[i+2]>>6],r+=o[63&t[i+2]];return n%3==2?r=r.substring(0,r.length-1)+"=":n%3==1&&(r=r.substring(0,r.length-2)+"=="),r},Qu.decode=function(e){var t,n,r,i,o=.75*e.length,s=e.length,a=0;"="===e[e.length-1]&&(o--,"="===e[e.length-2]&&o--);for(var o=new ArrayBuffer(o),u=new Uint8Array(o),l=0;l<s;l+=4)t=c[e.charCodeAt(l)],n=c[e.charCodeAt(l+1)],r=c[e.charCodeAt(l+2)],i=c[e.charCodeAt(l+3)],u[a++]=t<<2|n>>4,u[a++]=(15&n)<<4|r>>2,u[a++]=(3&r)<<6|63&i;return o}}();var Zu={},el=void 0!==el?el:"undefined"!=typeof WebKitBlobBuilder?WebKitBlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder&&MozBlobBuilder,da=function(){try{return 2===new Blob(["hi"]).size}catch(e){return!1}}(),tl=da&&function(){try{return 2===new Blob([new Uint8Array([1,2])]).size}catch(e){return!1}}(),Ss=el&&el.prototype.append&&el.prototype.getBlob;function nl(e){return e.map(function(e){if(e.buffer instanceof ArrayBuffer){var t,n=e.buffer;return e.byteLength!==n.byteLength&&((t=new Uint8Array(e.byteLength)).set(new Uint8Array(n,e.byteOffset,e.byteLength)),n=t.buffer),n}return e})}function rl(e,t){t=t||{};var n=new el;return nl(e).forEach(function(e){n.append(e)}),t.type?n.getBlob(t.type):n.getBlob()}function il(e,t){return new Blob(nl(e),t||{})}"undefined"!=typeof Blob&&(rl.prototype=Blob.prototype,il.prototype=Blob.prototype);var ol,Zu=da?tl?Blob:il:Ss?rl:void 0,sl={};"undefined"!=typeof ArrayBuffer&&(ol=Qu);var tl="undefined"!=typeof navigator&&/Android/i.test(navigator.userAgent),Ss="undefined"!=typeof navigator&&/PhantomJS/i.test(navigator.userAgent),al=tl||Ss;sl.protocol=3;var ul=sl.packets={open:0,close:1,ping:2,pong:3,message:4,upgrade:5,noop:6},ll=A(ul),cl={type:"error",data:"parser error"};function pl(e,t,n){for(var r,i,o,s,a=new Array(e.length),u=(r=e.length,i=n,s=!1,o=o||zu,0===(c.count=r)?i():c),l=0;l<e.length;l++)!function(n,e,r){t(e,function(e,t){a[n]=t,r(e,a)})}(l,e[l],u);function c(e,t){if(c.count<=0)throw new Error("after called too many times");--c.count,e?(s=!0,i(e),i=o):0!==c.count||s||i(null,t)}}sl.encodePacket=function(e,s,t,n){"function"==typeof s&&(n=s,s=!1),"function"==typeof t&&(n=t,t=null);var r=void 0===e.data?void 0:e.data.buffer||e.data;if("undefined"!=typeof ArrayBuffer&&r instanceof ArrayBuffer)return function(e,t){if(!s)return sl.encodeBase64Packet(e,t);var n=e.data,r=new Uint8Array(n),i=new Uint8Array(1+n.byteLength);i[0]=ul[e.type];for(var o=0;o<r.length;o++)i[o+1]=r[o];return t(i.buffer)}(e,n);if(void 0!==Zu&&r instanceof Zu)return function(e,t,n){if(!t)return sl.encodeBase64Packet(e,n);if(al)return function(e,t,n){if(!t)return sl.encodeBase64Packet(e,n);var r=new FileReader;return r.onload=function(){sl.encodePacket({type:e.type,data:r.result},t,!0,n)},r.readAsArrayBuffer(e.data)}(e,t,n);t=new Uint8Array(1);return t[0]=ul[e.type],n(new Zu([t.buffer,e.data]))}(e,s,n);if(r&&r.base64)return n("b"+sl.packets[e.type]+e.data.data);r=ul[e.type];return void 0!==e.data&&(r+=t?Yu(String(e.data),{strict:!1}):String(e.data)),n(""+r)},sl.encodeBase64Packet=function(t,n){var r,i="b"+sl.packets[t.type];if(void 0!==Zu&&t.data instanceof Zu){var o=new FileReader;return o.onload=function(){var e=o.result.split(",")[1];n(i+e)},o.readAsDataURL(t.data)}try{r=String.fromCharCode.apply(null,new Uint8Array(t.data))}catch(e){for(var s=new Uint8Array(t.data),a=new Array(s.length),u=0;u<s.length;u++)a[u]=s[u];r=String.fromCharCode.apply(null,a)}return i+=btoa(r),n(i)},sl.decodePacket=function(e,t,n){if(void 0===e)return cl;if("string"==typeof e){if("b"===e.charAt(0))return sl.decodeBase64Packet(e.substr(1),t);if(n&&!1===(e=function(e){try{e=Ju(e,{strict:!1})}catch(e){return!1}return e}(e)))return cl;var r=e.charAt(0);return Number(r)==r&&ll[r]?1<e.length?{type:ll[r],data:e.substring(1)}:{type:ll[r]}:cl}r=new Uint8Array(e)[0],e=Nu(e,1);return Zu&&"blob"===t&&(e=new Zu([e])),{type:ll[r],data:e}},sl.decodeBase64Packet=function(e,t){var n=ll[e.charAt(0)];if(!ol)return{type:n,data:{base64:!0,data:e.substr(1)}};e=ol.decode(e.substr(1));return{type:n,data:e="blob"===t&&Zu?new Zu([e]):e}},sl.encodePayload=function(e,n,r){"function"==typeof n&&(r=n,n=null);var i=Lu(e);return n&&i?Zu&&!al?sl.encodePayloadAsBlob(e,r):sl.encodePayloadAsArrayBuffer(e,r):e.length?void pl(e,function(e,t){sl.encodePacket(e,!!i&&n,!1,function(e){t(null,e.length+":"+e)})},function(e,t){return r(t.join(""))}):r("0:")},sl.decodePayload=function(e,t,n){if("string"!=typeof e)return sl.decodePayloadAsBinary(e,t,n);if("function"==typeof t&&(n=t,t=null),""===e)return n(cl,0,1);for(var r,i,o="",s=0,a=e.length;s<a;s++){var u=e.charAt(s);if(":"===u){if(""===o||o!=(r=Number(o)))return n(cl,0,1);if(o!=(i=e.substr(s+1,r)).length)return n(cl,0,1);if(i.length){if(i=sl.decodePacket(i,t,!1),cl.type===i.type&&cl.data===i.data)return n(cl,0,1);if(!1===n(i,s+r,a))return}s+=r,o=""}else o+=u}return""!==o?n(cl,0,1):void 0},sl.encodePayloadAsArrayBuffer=function(e,r){if(!e.length)return r(new ArrayBuffer(0));pl(e,function(e,t){sl.encodePacket(e,!0,!0,function(e){return t(null,e)})},function(e,t){var n=t.reduce(function(e,t){return e+(t="string"==typeof t?t.length:t.byteLength).toString().length+t+2},0),s=new Uint8Array(n),a=0;return t.forEach(function(e){var t="string"==typeof e,n=e;if(t){for(var r=new Uint8Array(e.length),i=0;i<e.length;i++)r[i]=e.charCodeAt(i);n=r.buffer}s[a++]=t?0:1;for(var o=n.byteLength.toString(),i=0;i<o.length;i++)s[a++]=parseInt(o[i]);for(s[a++]=255,r=new Uint8Array(n),i=0;i<r.length;i++)s[a++]=r[i]}),r(s.buffer)})},sl.encodePayloadAsBlob=function(e,n){pl(e,function(e,s){sl.encodePacket(e,!0,!0,function(e){var t=new Uint8Array(1);if(t[0]=1,"string"==typeof e){for(var n=new Uint8Array(e.length),r=0;r<e.length;r++)n[r]=e.charCodeAt(r);e=n.buffer,t[0]=0}for(var i=(e instanceof ArrayBuffer?e.byteLength:e.size).toString(),o=new Uint8Array(i.length+1),r=0;r<i.length;r++)o[r]=parseInt(i[r]);o[i.length]=255,Zu&&(t=new Zu([t.buffer,o.buffer,e]),s(null,t))})},function(e,t){return n(new Zu(t))})},sl.decodePayloadAsBinary=function(e,n,r){"function"==typeof n&&(r=n,n=null);for(var t=e,i=[];0<t.byteLength;){for(var o=new Uint8Array(t),s=0===o[0],a="",u=1;255!==o[u];u++){if(310<a.length)return r(cl,0,1);a+=o[u]}var t=Nu(t,2+a.length),a=parseInt(a),l=Nu(t,0,a);if(s)try{l=String.fromCharCode.apply(null,new Uint8Array(l))}catch(e){for(var c=new Uint8Array(l),l="",u=0;u<c.length;u++)l+=String.fromCharCode(c[u])}i.push(l),t=Nu(t,a)}var p=i.length;i.forEach(function(e,t){r(sl.decodePacket(e,n,!0),t,p)})};var dl={};function hl(e){this.path=e.path,this.hostname=e.hostname,this.port=e.port,this.secure=e.secure,this.query=e.query,this.timestampParam=e.timestampParam,this.timestampRequests=e.timestampRequests,this.readyState="",this.agent=e.agent||!1,this.socket=e.socket,this.enablesXDR=e.enablesXDR,this.pfx=e.pfx,this.key=e.key,this.passphrase=e.passphrase,this.cert=e.cert,this.ca=e.ca,this.ciphers=e.ciphers,this.rejectUnauthorized=e.rejectUnauthorized,this.forceNode=e.forceNode,this.isReactNative=e.isReactNative,this.extraHeaders=e.extraHeaders,this.localAddress=e.localAddress}o((dl=hl).prototype),hl.prototype.onError=function(e,t){e=new Error(e);return e.type="TransportError",e.description=t,this.emit("error",e),this},hl.prototype.open=function(){return"closed"!==this.readyState&&""!==this.readyState||(this.readyState="opening",this.doOpen()),this},hl.prototype.close=function(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this},hl.prototype.send=function(e){if("open"!==this.readyState)throw new Error("Transport not open");this.write(e)},hl.prototype.onOpen=function(){this.readyState="open",this.writable=!0,this.emit("open")},hl.prototype.onData=function(e){e=sl.decodePacket(e,this.socket.binaryType);this.onPacket(e)},hl.prototype.onPacket=function(e){this.emit("packet",e)},hl.prototype.onClose=function(){this.readyState="closed",this.emit("close")};var fl={};try{fl="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(cl){fl=!1}function yl(e){var t=e.xdomain,n=e.xscheme,e=e.enablesXDR;try{if("undefined"!=typeof XMLHttpRequest&&(!t||fl))return new XMLHttpRequest}catch(e){}try{if("undefined"!=typeof XDomainRequest&&!n&&e)return new XDomainRequest}catch(e){}if(!t)try{return new self[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch(e){}}function gl(e,t){function n(){}n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}var ml,vl={},bl="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),wl={},_l=0,Sl=0;function kl(e){for(var t="";t=bl[e%64]+t,0<(e=Math.floor(e/64)););return t}function Pl(){var e=kl(+new Date);return e!==ml?(_l=0,ml=e):e+"."+kl(_l++)}for(;Sl<64;Sl++)wl[bl[Sl]]=Sl;Pl.encode=kl,Pl.decode=function(e){var t=0;for(Sl=0;Sl<e.length;Sl++)t=64*t+wl[e.charAt(Sl)];return t};var vl=Pl,Cl=cu("engine.io-client:polling"),Fl=El,Al=null!=new yl({xdomain:!1}).responseType;function El(e){var t=e&&e.forceBase64;Al&&!t||(this.supportsBinary=!1),dl.call(this,e)}gl(El,dl),El.prototype.name="polling",El.prototype.doOpen=function(){this.poll()},El.prototype.pause=function(e){var t,n=this;function r(){Cl("paused"),n.readyState="paused",e()}this.readyState="pausing",this.polling||!this.writable?(t=0,this.polling&&(Cl("we are currently polling - waiting to pause"),t++,this.once("pollComplete",function(){Cl("pre-pause polling complete"),--t||r()})),this.writable||(Cl("we are currently writing - waiting to pause"),t++,this.once("drain",function(){Cl("pre-pause writing complete"),--t||r()}))):r()},El.prototype.poll=function(){Cl("polling"),this.polling=!0,this.doPoll(),this.emit("poll")},El.prototype.onData=function(e){var r=this;Cl("polling got data %s",e),sl.decodePayload(e,this.socket.binaryType,function(e,t,n){return"opening"===r.readyState&&r.onOpen(),"close"===e.type?(r.onClose(),!1):void r.onPacket(e)}),"closed"!==this.readyState&&(this.polling=!1,this.emit("pollComplete"),"open"===this.readyState?this.poll():Cl('ignoring poll - transport state "%s"',this.readyState))},El.prototype.doClose=function(){var e=this;function t(){Cl("writing close packet"),e.write([{type:"close"}])}"open"===this.readyState?(Cl("transport open - closing"),t()):(Cl("transport not open - deferring close"),this.once("open",t))},El.prototype.write=function(e){var t=this;this.writable=!1;function n(){t.writable=!0,t.emit("drain")}sl.encodePayload(e,this.supportsBinary,function(e){t.doWrite(e,n)})},El.prototype.uri=function(){var e=this.query||{},t=this.secure?"https":"http",n="";return!1!==this.timestampRequests&&(e[this.timestampParam]=vl()),this.supportsBinary||e.sid||(e.b64=1),e=Iu.encode(e),this.port&&("https"==t&&443!==Number(this.port)||"http"==t&&80!==Number(this.port))&&(n=":"+this.port),e.length&&(e="?"+e),t+"://"+(-1!==this.hostname.indexOf(":")?"["+this.hostname+"]":this.hostname)+n+this.path+e};var Ol={},Ul=cu("engine.io-client:polling-xhr");function Rl(){}function Tl(e){var t,n;Fl.call(this,e),this.requestTimeout=e.requestTimeout,this.extraHeaders=e.extraHeaders,"undefined"!=typeof location&&(t="https:"===location.protocol,n=(n=location.port)||(t?443:80),this.xd="undefined"!=typeof location&&e.hostname!==location.hostname||n!==e.port,this.xs=e.secure!==t)}function xl(e){this.method=e.method||"GET",this.uri=e.uri,this.xd=!!e.xd,this.xs=!!e.xs,this.async=!1!==e.async,this.data=void 0!==e.data?e.data:null,this.agent=e.agent,this.isBinary=e.isBinary,this.supportsBinary=e.supportsBinary,this.enablesXDR=e.enablesXDR,this.requestTimeout=e.requestTimeout,this.pfx=e.pfx,this.key=e.key,this.passphrase=e.passphrase,this.cert=e.cert,this.ca=e.ca,this.ciphers=e.ciphers,this.rejectUnauthorized=e.rejectUnauthorized,this.extraHeaders=e.extraHeaders,this.create()}function Dl(){for(var e in xl.requests)xl.requests.hasOwnProperty(e)&&xl.requests[e].abort()}(Ol=Tl).Request=xl,gl(Tl,Fl),Tl.prototype.supportsBinary=!0,Tl.prototype.request=function(e){return(e=e||{}).uri=this.uri(),e.xd=this.xd,e.xs=this.xs,e.agent=this.agent||!1,e.supportsBinary=this.supportsBinary,e.enablesXDR=this.enablesXDR,e.pfx=this.pfx,e.key=this.key,e.passphrase=this.passphrase,e.cert=this.cert,e.ca=this.ca,e.ciphers=this.ciphers,e.rejectUnauthorized=this.rejectUnauthorized,e.requestTimeout=this.requestTimeout,e.extraHeaders=this.extraHeaders,new xl(e)},Tl.prototype.doWrite=function(e,t){var e=this.request({method:"POST",data:e,isBinary:"string"!=typeof e&&void 0!==e}),n=this;e.on("success",t),e.on("error",function(e){n.onError("xhr post error",e)}),this.sendXhr=e},Tl.prototype.doPoll=function(){Ul("xhr poll");var e=this.request(),t=this;e.on("data",function(e){t.onData(e)}),e.on("error",function(e){t.onError("xhr poll error",e)}),this.pollXhr=e},o(xl.prototype),xl.prototype.create=function(){var e={agent:this.agent,xdomain:this.xd,xscheme:this.xs,enablesXDR:this.enablesXDR};e.pfx=this.pfx,e.key=this.key,e.passphrase=this.passphrase,e.cert=this.cert,e.ca=this.ca,e.ciphers=this.ciphers,e.rejectUnauthorized=this.rejectUnauthorized;var t=this.xhr=new yl(e),n=this;try{Ul("xhr open %s: %s",this.method,this.uri),t.open(this.method,this.uri,this.async);try{if(this.extraHeaders)for(var r in t.setDisableHeaderCheck&&t.setDisableHeaderCheck(!0),this.extraHeaders)this.extraHeaders.hasOwnProperty(r)&&t.setRequestHeader(r,this.extraHeaders[r])}catch(e){}if("POST"===this.method)try{this.isBinary?t.setRequestHeader("Content-type","application/octet-stream"):t.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(e){}try{t.setRequestHeader("Accept","*/*")}catch(e){}"withCredentials"in t&&(t.withCredentials=!0),this.requestTimeout&&(t.timeout=this.requestTimeout),this.hasXDR()?(t.onload=function(){n.onLoad()},t.onerror=function(){n.onError(t.responseText)}):t.onreadystatechange=function(){if(2===t.readyState)try{var e=t.getResponseHeader("Content-Type");n.supportsBinary&&"application/octet-stream"===e&&(t.responseType="arraybuffer")}catch(e){}4===t.readyState&&(200===t.status||1223===t.status?n.onLoad():setTimeout(function(){n.onError(t.status)},0))},Ul("xhr data %s",this.data),t.send(this.data)}catch(e){return void setTimeout(function(){n.onError(e)},0)}"undefined"!=typeof document&&(this.index=xl.requestsCount++,xl.requests[this.index]=this)},xl.prototype.onSuccess=function(){this.emit("success"),this.cleanup()},xl.prototype.onData=function(e){this.emit("data",e),this.onSuccess()},xl.prototype.onError=function(e){this.emit("error",e),this.cleanup(!0)},xl.prototype.cleanup=function(e){if(void 0!==this.xhr&&null!==this.xhr){if(this.hasXDR()?this.xhr.onload=this.xhr.onerror=Rl:this.xhr.onreadystatechange=Rl,e)try{this.xhr.abort()}catch(e){}"undefined"!=typeof document&&delete xl.requests[this.index],this.xhr=null}},xl.prototype.onLoad=function(){var e,t;try{try{t=this.xhr.getResponseHeader("Content-Type")}catch(e){}e="application/octet-stream"===t&&this.xhr.response||this.xhr.responseText}catch(e){this.onError(e)}null!=e&&this.onData(e)},xl.prototype.hasXDR=function(){return"undefined"!=typeof XDomainRequest&&!this.xs&&this.enablesXDR},xl.prototype.abort=function(){this.cleanup()},xl.requestsCount=0,xl.requests={},"undefined"!=typeof document&&("function"==typeof attachEvent?attachEvent("onunload",Dl):"function"==typeof addEventListener&&(Fc="onpagehide"in self?"pagehide":"unload",addEventListener(Fc,Dl,!1)));var Bl={};!function(i){!function(){var n,l=/\n/g,c=/\\n/g;function r(){}function e(e){Fl.call(this,e),this.query=this.query||{},n||(e="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==i?i:{},n=e.___eio=e.___eio||[]),this.index=n.length;var t=this;n.push(function(e){t.onData(e)}),this.query.j=this.index,"function"==typeof addEventListener&&addEventListener("beforeunload",function(){t.script&&(t.script.onerror=r)},!1)}gl(Bl=e,Fl),e.prototype.supportsBinary=!1,e.prototype.doClose=function(){this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),this.form&&(this.form.parentNode.removeChild(this.form),this.form=null,this.iframe=null),Fl.prototype.doClose.call(this)},e.prototype.doPoll=function(){var t=this,e=document.createElement("script");this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),e.async=!0,e.src=this.uri(),e.onerror=function(e){t.onError("jsonp poll error",e)};var n=document.getElementsByTagName("script")[0];n?n.parentNode.insertBefore(e,n):(document.head||document.body).appendChild(e),this.script=e,"undefined"!=typeof navigator&&/gecko/i.test(navigator.userAgent)&&setTimeout(function(){var e=document.createElement("iframe");document.body.appendChild(e),document.body.removeChild(e)},100)},e.prototype.doWrite=function(e,t){var n,r,i,o,s=this;function a(){u(),t()}function u(){if(s.iframe)try{s.form.removeChild(s.iframe)}catch(e){s.onError("jsonp polling iframe removal error",e)}try{var e='<iframe src="javascript:0" name="'+s.iframeId+'">';n=document.createElement(e)}catch(e){(n=document.createElement("iframe")).name=s.iframeId,n.src="javascript:0"}n.id=s.iframeId,s.form.appendChild(n),s.iframe=n}this.form||(r=document.createElement("form"),i=document.createElement("textarea"),o=this.iframeId="eio_iframe_"+this.index,r.className="socketio",r.style.position="absolute",r.style.top="-1000px",r.style.left="-1000px",r.target=o,r.method="POST",r.setAttribute("accept-charset","utf-8"),i.name="d",r.appendChild(i),document.body.appendChild(r),this.form=r,this.area=i),this.form.action=this.uri(),u(),e=e.replace(c,"\\\n"),this.area.value=e.replace(l,"\\n");try{this.form.submit()}catch(e){}this.iframe.attachEvent?this.iframe.onreadystatechange=function(){"complete"===s.iframe.readyState&&a()}:this.iframe.onload=a}}.call(this)}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});var Il={};!function(s){!function(){var t,n,o=cu("engine.io-client:websocket");if("undefined"!=typeof WebSocket)t=WebSocket;else if("undefined"!=typeof self)t=self.WebSocket||self.MozWebSocket;else try{n=a({})}catch(e){}var r=t||n;function e(e){e&&e.forceBase64&&(this.supportsBinary=!1),this.perMessageDeflate=e.perMessageDeflate,this.usingBrowserWebSocket=t&&!e.forceNode,this.protocols=e.protocols,this.usingBrowserWebSocket||(r=n),dl.call(this,e)}gl(Il=e,dl),e.prototype.name="websocket",e.prototype.supportsBinary=!0,e.prototype.doOpen=function(){if(this.check()){var e=this.uri(),t=this.protocols,n={agent:this.agent,perMessageDeflate:this.perMessageDeflate};n.pfx=this.pfx,n.key=this.key,n.passphrase=this.passphrase,n.cert=this.cert,n.ca=this.ca,n.ciphers=this.ciphers,n.rejectUnauthorized=this.rejectUnauthorized,this.extraHeaders&&(n.headers=this.extraHeaders),this.localAddress&&(n.localAddress=this.localAddress);try{this.ws=this.usingBrowserWebSocket&&!this.isReactNative?t?new r(e,t):new r(e):new r(e,t,n)}catch(e){return this.emit("error",e)}void 0===this.ws.binaryType&&(this.supportsBinary=!1),this.ws.supports&&this.ws.supports.binary?(this.supportsBinary=!0,this.ws.binaryType="nodebuffer"):this.ws.binaryType="arraybuffer",this.addEventListeners()}},e.prototype.addEventListeners=function(){var t=this;this.ws.onopen=function(){t.onOpen()},this.ws.onclose=function(){t.onClose()},this.ws.onmessage=function(e){t.onData(e.data)},this.ws.onerror=function(e){t.onError("websocket error",e)}},e.prototype.write=function(e){var r=this;this.writable=!1;for(var i=e.length,t=0,n=i;t<n;t++)!function(n){sl.encodePacket(n,r.supportsBinary,function(e){var t;r.usingBrowserWebSocket||(t={},n.options&&(t.compress=n.options.compress),r.perMessageDeflate&&("string"==typeof e?s.byteLength(e):e.length)<r.perMessageDeflate.threshold&&(t.compress=!1));try{r.usingBrowserWebSocket?r.ws.send(e):r.ws.send(e,t)}catch(e){o("websocket closed before onclose event")}--i||(r.emit("flush"),setTimeout(function(){r.writable=!0,r.emit("drain")},0))})}(e[t])},e.prototype.onClose=function(){dl.prototype.onClose.call(this)},e.prototype.doClose=function(){void 0!==this.ws&&this.ws.close()},e.prototype.uri=function(){var e=this.query||{},t=this.secure?"wss":"ws",n="";return this.port&&("wss"==t&&443!==Number(this.port)||"ws"==t&&80!==Number(this.port))&&(n=":"+this.port),this.timestampRequests&&(e[this.timestampParam]=vl()),this.supportsBinary||(e.b64=1),(e=Iu.encode(e)).length&&(e="?"+e),t+"://"+(-1!==this.hostname.indexOf(":")?"["+this.hostname+"]":this.hostname)+n+this.path+e},e.prototype.check=function(){return!(!r||"__initialize"in r&&this.name===e.prototype.name)}}.call(this)}.call(this,t({}).Buffer);var jl={polling:function(e){var t,n,r=!1,i=!1,o=!1!==e.jsonp;if("undefined"!=typeof location&&(t="https:"===location.protocol,n=(n=location.port)||(t?443:80),r=e.hostname!==location.hostname||n!==e.port,i=e.secure!==t),e.xdomain=r,e.xscheme=i,"open"in new yl(e)&&!e.forceJSONP)return new Ol(e);if(!o)throw new Error("JSONP disabled");return new Bl(e)}};jl.websocket=Il;var Ml=cu("engine.io-client:socket");function Ll(e,t){if(!(this instanceof Ll))return new Ll(e,t);t=t||{},e&&"object"==typeof e&&(t=e,e=null),e?(e=iu(e),t.hostname=e.host,t.secure="https"===e.protocol||"wss"===e.protocol,t.port=e.port,e.query&&(t.query=e.query)):t.host&&(t.hostname=iu(t.host).host),this.secure=null!=t.secure?t.secure:"undefined"!=typeof location&&"https:"===location.protocol,t.hostname&&!t.port&&(t.port=this.secure?"443":"80"),this.agent=t.agent||!1,this.hostname=t.hostname||("undefined"!=typeof location?location.hostname:"localhost"),this.port=t.port||("undefined"!=typeof location&&location.port?location.port:this.secure?443:80),this.query=t.query||{},"string"==typeof this.query&&(this.query=Iu.decode(this.query)),this.upgrade=!1!==t.upgrade,this.path=(t.path||"/engine.io").replace(/\/$/,"")+"/",this.forceJSONP=!!t.forceJSONP,this.jsonp=!1!==t.jsonp,this.forceBase64=!!t.forceBase64,this.enablesXDR=!!t.enablesXDR,this.timestampParam=t.timestampParam||"t",this.timestampRequests=t.timestampRequests,this.transports=t.transports||["polling","websocket"],this.transportOptions=t.transportOptions||{},this.readyState="",this.writeBuffer=[],this.prevBufferLen=0,this.policyPort=t.policyPort||843,this.rememberUpgrade=t.rememberUpgrade||!1,this.binaryType=null,this.onlyBinaryUpgrades=t.onlyBinaryUpgrades,this.perMessageDeflate=!1!==t.perMessageDeflate&&(t.perMessageDeflate||{}),!0===this.perMessageDeflate&&(this.perMessageDeflate={}),this.perMessageDeflate&&null==this.perMessageDeflate.threshold&&(this.perMessageDeflate.threshold=1024),this.pfx=t.pfx||null,this.key=t.key||null,this.passphrase=t.passphrase||null,this.cert=t.cert||null,this.ca=t.ca||null,this.ciphers=t.ciphers||null,this.rejectUnauthorized=void 0===t.rejectUnauthorized||t.rejectUnauthorized,this.forceNode=!!t.forceNode,this.isReactNative="undefined"!=typeof navigator&&"string"==typeof navigator.product&&"reactnative"===navigator.product.toLowerCase(),"undefined"!=typeof self&&!this.isReactNative||(t.extraHeaders&&0<Object.keys(t.extraHeaders).length&&(this.extraHeaders=t.extraHeaders),t.localAddress&&(this.localAddress=t.localAddress)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingIntervalTimer=null,this.pingTimeoutTimer=null,this.open()}(tl=Ll).priorWebsocketSuccess=!1,o(Ll.prototype),Ll.protocol=sl.protocol,(Ll.Socket=Ll).Transport=dl,Ll.transports=jl,Ll.parser=sl,Ll.prototype.createTransport=function(e){Ml('creating transport "%s"',e);var t=function(e){var t,n={};for(t in e)e.hasOwnProperty(t)&&(n[t]=e[t]);return n}(this.query);t.EIO=sl.protocol,t.transport=e;var n=this.transportOptions[e]||{};return this.id&&(t.sid=this.id),new jl[e]({query:t,socket:this,agent:n.agent||this.agent,hostname:n.hostname||this.hostname,port:n.port||this.port,secure:n.secure||this.secure,path:n.path||this.path,forceJSONP:n.forceJSONP||this.forceJSONP,jsonp:n.jsonp||this.jsonp,forceBase64:n.forceBase64||this.forceBase64,enablesXDR:n.enablesXDR||this.enablesXDR,timestampRequests:n.timestampRequests||this.timestampRequests,timestampParam:n.timestampParam||this.timestampParam,policyPort:n.policyPort||this.policyPort,pfx:n.pfx||this.pfx,key:n.key||this.key,passphrase:n.passphrase||this.passphrase,cert:n.cert||this.cert,ca:n.ca||this.ca,ciphers:n.ciphers||this.ciphers,rejectUnauthorized:n.rejectUnauthorized||this.rejectUnauthorized,perMessageDeflate:n.perMessageDeflate||this.perMessageDeflate,extraHeaders:n.extraHeaders||this.extraHeaders,forceNode:n.forceNode||this.forceNode,localAddress:n.localAddress||this.localAddress,requestTimeout:n.requestTimeout||this.requestTimeout,protocols:n.protocols||void 0,isReactNative:this.isReactNative})},Ll.prototype.open=function(){var e;if(this.rememberUpgrade&&Ll.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket"))e="websocket";else{if(0===this.transports.length){var t=this;return void setTimeout(function(){t.emit("error","No transports available")},0)}e=this.transports[0]}this.readyState="opening";try{e=this.createTransport(e)}catch(e){return this.transports.shift(),void this.open()}e.open(),this.setTransport(e)},Ll.prototype.setTransport=function(e){Ml("setting transport %s",e.name);var t=this;this.transport&&(Ml("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners()),(this.transport=e).on("drain",function(){t.onDrain()}).on("packet",function(e){t.onPacket(e)}).on("error",function(e){t.onError(e)}).on("close",function(){t.onClose("transport close")})},Ll.prototype.probe=function(n){Ml('probing transport "%s"',n);var r=this.createTransport(n,{probe:1}),t=!1,i=this;function e(){var e;i.onlyBinaryUpgrades&&(e=!this.supportsBinary&&i.transport.supportsBinary,t=t||e),t||(Ml('probe transport "%s" opened',n),r.send([{type:"ping",data:"probe"}]),r.once("packet",function(e){t||("pong"===e.type&&"probe"===e.data?(Ml('probe transport "%s" pong',n),i.upgrading=!0,i.emit("upgrading",r),r&&(Ll.priorWebsocketSuccess="websocket"===r.name,Ml('pausing current transport "%s"',i.transport.name),i.transport.pause(function(){t||"closed"!==i.readyState&&(Ml("changing transport and sending upgrade packet"),c(),i.setTransport(r),r.send([{type:"upgrade"}]),i.emit("upgrade",r),r=null,i.upgrading=!1,i.flush())}))):(Ml('probe transport "%s" failed',n),(e=new Error("probe error")).transport=r.name,i.emit("upgradeError",e)))}))}function o(){t||(t=!0,c(),r.close(),r=null)}function s(e){var t=new Error("probe error: "+e);t.transport=r.name,o(),Ml('probe transport "%s" failed because of error: %s',n,e),i.emit("upgradeError",t)}function a(){s("transport closed")}function u(){s("socket closed")}function l(e){r&&e.name!==r.name&&(Ml('"%s" works - aborting "%s"',e.name,r.name),o())}function c(){r.removeListener("open",e),r.removeListener("error",s),r.removeListener("close",a),i.removeListener("close",u),i.removeListener("upgrading",l)}Ll.priorWebsocketSuccess=!1,r.once("open",e),r.once("error",s),r.once("close",a),this.once("close",u),this.once("upgrading",l),r.open()},Ll.prototype.onOpen=function(){if(Ml("socket open"),this.readyState="open",Ll.priorWebsocketSuccess="websocket"===this.transport.name,this.emit("open"),this.flush(),"open"===this.readyState&&this.upgrade&&this.transport.pause){Ml("starting upgrade probes");for(var e=0,t=this.upgrades.length;e<t;e++)this.probe(this.upgrades[e])}},Ll.prototype.onPacket=function(e){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(Ml('socket receive: type "%s", data "%s"',e.type,e.data),this.emit("packet",e),this.emit("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"pong":this.setPing(),this.emit("pong");break;case"error":var t=new Error("server error");t.code=e.data,this.onError(t);break;case"message":this.emit("data",e.data),this.emit("message",e.data)}else Ml('packet received with socket readyState "%s"',this.readyState)},Ll.prototype.onHandshake=function(e){this.emit("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this.upgrades=this.filterUpgrades(e.upgrades),this.pingInterval=e.pingInterval,this.pingTimeout=e.pingTimeout,this.onOpen(),"closed"!==this.readyState&&(this.setPing(),this.removeListener("heartbeat",this.onHeartbeat),this.on("heartbeat",this.onHeartbeat))},Ll.prototype.onHeartbeat=function(e){clearTimeout(this.pingTimeoutTimer);var t=this;t.pingTimeoutTimer=setTimeout(function(){"closed"!==t.readyState&&t.onClose("ping timeout")},e||t.pingInterval+t.pingTimeout)},Ll.prototype.setPing=function(){var e=this;clearTimeout(e.pingIntervalTimer),e.pingIntervalTimer=setTimeout(function(){Ml("writing ping packet - expecting pong within %sms",e.pingTimeout),e.ping(),e.onHeartbeat(e.pingTimeout)},e.pingInterval)},Ll.prototype.ping=function(){var e=this;this.sendPacket("ping",function(){e.emit("ping")})},Ll.prototype.onDrain=function(){this.writeBuffer.splice(0,this.prevBufferLen),(this.prevBufferLen=0)===this.writeBuffer.length?this.emit("drain"):this.flush()},Ll.prototype.flush=function(){"closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(Ml("flushing %d packets in socket",this.writeBuffer.length),this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emit("flush"))},Ll.prototype.write=Ll.prototype.send=function(e,t,n){return this.sendPacket("message",e,t,n),this},Ll.prototype.sendPacket=function(e,t,n,r){"function"==typeof t&&(r=t,t=void 0),"function"==typeof n&&(r=n,n=null),"closing"!==this.readyState&&"closed"!==this.readyState&&((n=n||{}).compress=!1!==n.compress,this.emit("packetCreate",n={type:e,data:t,options:n}),this.writeBuffer.push(n),r&&this.once("flush",r),this.flush())},Ll.prototype.close=function(){var e;function t(){e.onClose("forced close"),Ml("socket closing - telling transport to close"),e.transport.close()}function n(){e.removeListener("upgrade",n),e.removeListener("upgradeError",n),t()}function r(){e.once("upgrade",n),e.once("upgradeError",n)}return"opening"!==this.readyState&&"open"!==this.readyState||(this.readyState="closing",(e=this).writeBuffer.length?this.once("drain",function(){(this.upgrading?r:t)()}):(this.upgrading?r:t)()),this},Ll.prototype.onError=function(e){Ml("socket error %j",e),Ll.priorWebsocketSuccess=!1,this.emit("error",e),this.onClose("transport error",e)},Ll.prototype.onClose=function(e,t){"opening"!==this.readyState&&"open"!==this.readyState&&"closing"!==this.readyState||(Ml('socket close with reason: "%s"',e),clearTimeout(this.pingIntervalTimer),clearTimeout(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),this.readyState="closed",this.id=null,this.emit("close",e,t),this.writeBuffer=[],this.prevBufferLen=0)},Ll.prototype.filterUpgrades=function(e){for(var t=[],n=0,r=e.length;n<r;n++)~Du(this.transports,e[n])&&t.push(e[n]);return t};var Nl={};function zl(e){if(e)return function(e){for(var t in zl.prototype)e[t]=zl.prototype[t];return e}(e)}(Nl=tl).parser=sl,((Ss={exports:{}}).exports=zl).prototype.on=zl.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this},zl.prototype.once=function(e,t){function n(){this.off(e,n),t.apply(this,arguments)}return n.fn=t,this.on(e,n),this},zl.prototype.off=zl.prototype.removeListener=zl.prototype.removeAllListeners=zl.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n,r=this._callbacks["$"+e];if(!r)return this;if(1==arguments.length)return delete this._callbacks["$"+e],this;for(var i=0;i<r.length;i++)if((n=r[i])===t||n.fn===t){r.splice(i,1);break}return this},zl.prototype.emit=function(e){this._callbacks=this._callbacks||{};var t=[].slice.call(arguments,1),n=this._callbacks["$"+e];if(n)for(var r=0,i=(n=n.slice(0)).length;r<i;++r)n[r].apply(this,t);return this},zl.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]},zl.prototype.hasListeners=function(e){return!!this.listeners(e).length};function ql(e,t){for(var n=[],r=(t=t||0)||0;r<e.length;r++)n[r-t]=e[r];return n}function Hl(e,t,n){return e.on(t,n),{destroy:function(){e.removeListener(t,n)}}}function Vl(e,t){if("function"!=typeof(t="string"==typeof t?e[t]:t))throw new Error("bind() requires a function");var n=Wl.call(arguments,2);return function(){return t.apply(e,n.concat(Wl.call(arguments)))}}var Ss=Ss.exports,Wl=[].slice,Xl={},Gl=cu("socket.io-client:socket"),Xl=Yl,Kl={connect:1,connect_error:1,connect_timeout:1,connecting:1,disconnect:1,error:1,reconnect:1,reconnect_attempt:1,reconnect_failed:1,reconnect_error:1,reconnecting:1,ping:1,pong:1},$l=Ss.prototype.emit;function Yl(e,t,n){this.io=e,this.nsp=t,(this.json=this).ids=0,this.acks={},this.receiveBuffer=[],this.sendBuffer=[],this.connected=!1,this.disconnected=!0,this.flags={},n&&n.query&&(this.query=n.query),this.io.autoConnect&&this.open()}Ss(Yl.prototype),Yl.prototype.subEvents=function(){var e;this.subs||(e=this.io,this.subs=[Hl(e,"open",Vl(this,"onopen")),Hl(e,"packet",Vl(this,"onpacket")),Hl(e,"close",Vl(this,"onclose"))])},Yl.prototype.open=Yl.prototype.connect=function(){return this.connected||(this.subEvents(),this.io.open(),"open"===this.io.readyState&&this.onopen(),this.emit("connecting")),this},Yl.prototype.send=function(){var e=ql(arguments);return e.unshift("message"),this.emit.apply(this,e),this},Yl.prototype.emit=function(e){if(Kl.hasOwnProperty(e))return $l.apply(this,arguments),this;var t=ql(arguments),n={type:(void 0!==this.flags.binary?this.flags.binary:Lu(t))?Cu.BINARY_EVENT:Cu.EVENT,data:t,options:{}};return n.options.compress=!this.flags||!1!==this.flags.compress,"function"==typeof t[t.length-1]&&(Gl("emitting packet with ack id %d",this.ids),this.acks[this.ids]=t.pop(),n.id=this.ids++),this.connected?this.packet(n):this.sendBuffer.push(n),this.flags={},this},Yl.prototype.packet=function(e){e.nsp=this.nsp,this.io.packet(e)},Yl.prototype.onopen=function(){var e;Gl("transport is open - connecting"),"/"!==this.nsp&&(this.query?(e="object"==typeof this.query?Iu.encode(this.query):this.query,Gl("sending connect packet with query %s",e),this.packet({type:Cu.CONNECT,query:e})):this.packet({type:Cu.CONNECT}))},Yl.prototype.onclose=function(e){Gl("close (%s)",e),this.connected=!1,this.disconnected=!0,delete this.id,this.emit("disconnect",e)},Yl.prototype.onpacket=function(e){var t=e.nsp===this.nsp,n=e.type===Cu.ERROR&&"/"===e.nsp;if(t||n)switch(e.type){case Cu.CONNECT:this.onconnect();break;case Cu.EVENT:case Cu.BINARY_EVENT:this.onevent(e);break;case Cu.ACK:case Cu.BINARY_ACK:this.onack(e);break;case Cu.DISCONNECT:this.ondisconnect();break;case Cu.ERROR:this.emit("error",e.data)}},Yl.prototype.onevent=function(e){var t=e.data||[];Gl("emitting event %j",t),null!=e.id&&(Gl("attaching ack callback to event"),t.push(this.ack(e.id))),this.connected?$l.apply(this,t):this.receiveBuffer.push(t)},Yl.prototype.ack=function(t){var n=this,r=!1;return function(){var e;r||(r=!0,e=ql(arguments),Gl("sending ack %j",e),n.packet({type:Lu(e)?Cu.BINARY_ACK:Cu.ACK,id:t,data:e}))}},Yl.prototype.onack=function(e){var t=this.acks[e.id];"function"==typeof t?(Gl("calling ack %s with %j",e.id,e.data),t.apply(this,e.data),delete this.acks[e.id]):Gl("bad ack %s",e.id)},Yl.prototype.onconnect=function(){this.connected=!0,this.disconnected=!1,this.emit("connect"),this.emitBuffered()},Yl.prototype.emitBuffered=function(){for(var e=0;e<this.receiveBuffer.length;e++)$l.apply(this,this.receiveBuffer[e]);for(this.receiveBuffer=[],e=0;e<this.sendBuffer.length;e++)this.packet(this.sendBuffer[e]);this.sendBuffer=[]},Yl.prototype.ondisconnect=function(){Gl("server disconnect (%s)",this.nsp),this.destroy(),this.onclose("io server disconnect")},Yl.prototype.destroy=function(){if(this.subs){for(var e=0;e<this.subs.length;e++)this.subs[e].destroy();this.subs=null}this.io.destroy(this)},Yl.prototype.close=Yl.prototype.disconnect=function(){return this.connected&&(Gl("performing disconnect (%s)",this.nsp),this.packet({type:Cu.DISCONNECT})),this.destroy(),this.connected&&this.onclose("io client disconnect"),this},Yl.prototype.compress=function(e){return this.flags.compress=e,this},Yl.prototype.binary=function(e){return this.flags.binary=e,this};var Jl={};function Ql(e){this.ms=(e=e||{}).min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=0<e.jitter&&e.jitter<=1?e.jitter:0,this.attempts=0}(Jl=Ql).prototype.duration=function(){var e,t,n=this.ms*Math.pow(this.factor,this.attempts++);return this.jitter&&(e=Math.random(),t=Math.floor(e*this.jitter*n),n=0==(1&Math.floor(10*e))?n-t:n+t),0|Math.min(n,this.max)},Ql.prototype.reset=function(){this.attempts=0},Ql.prototype.setMin=function(e){this.ms=e},Ql.prototype.setMax=function(e){this.max=e},Ql.prototype.setJitter=function(e){this.jitter=e};var Zl={},ec=cu("socket.io-client:manager"),tc=Object.prototype.hasOwnProperty;function nc(e,t){if(!(this instanceof nc))return new nc(e,t);e&&"object"==typeof e&&(t=e,e=void 0),(t=t||{}).path=t.path||"/socket.io",this.nsps={},this.subs=[],this.opts=t,this.reconnection(!1!==t.reconnection),this.reconnectionAttempts(t.reconnectionAttempts||1/0),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.randomizationFactor(t.randomizationFactor||.5),this.backoff=new Jl({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==t.timeout?2e4:t.timeout),this.readyState="closed",this.uri=e,this.connecting=[],this.lastPing=null,this.encoding=!1,this.packetBuffer=[];e=t.parser||Cu;this.encoder=new e.Encoder,this.decoder=new e.Decoder,this.autoConnect=!1!==t.autoConnect,this.autoConnect&&this.open()}function rc(){return(rc=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,r=arguments[t];for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}(Zl=nc).prototype.emitAll=function(){for(var e in this.emit.apply(this,arguments),this.nsps)tc.call(this.nsps,e)&&this.nsps[e].emit.apply(this.nsps[e],arguments)},nc.prototype.updateSocketIds=function(){for(var e in this.nsps)tc.call(this.nsps,e)&&(this.nsps[e].id=this.generateId(e))},nc.prototype.generateId=function(e){return("/"===e?"":e+"#")+this.engine.id},Ss(nc.prototype),nc.prototype.reconnection=function(e){return arguments.length?(this._reconnection=!!e,this):this._reconnection},nc.prototype.reconnectionAttempts=function(e){return arguments.length?(this._reconnectionAttempts=e,this):this._reconnectionAttempts},nc.prototype.reconnectionDelay=function(e){return arguments.length?(this._reconnectionDelay=e,this.backoff&&this.backoff.setMin(e),this):this._reconnectionDelay},nc.prototype.randomizationFactor=function(e){return arguments.length?(this._randomizationFactor=e,this.backoff&&this.backoff.setJitter(e),this):this._randomizationFactor},nc.prototype.reconnectionDelayMax=function(e){return arguments.length?(this._reconnectionDelayMax=e,this.backoff&&this.backoff.setMax(e),this):this._reconnectionDelayMax},nc.prototype.timeout=function(e){return arguments.length?(this._timeout=e,this):this._timeout},nc.prototype.maybeReconnectOnOpen=function(){!this.reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()},nc.prototype.open=nc.prototype.connect=function(n,e){if(ec("readyState %s",this.readyState),~this.readyState.indexOf("open"))return this;ec("opening %s",this.uri),this.engine=Nl(this.uri,this.opts);var t=this.engine,r=this;this.readyState="opening",this.skipReconnect=!1;var i,o,s=Hl(t,"open",function(){r.onopen(),n&&n()}),a=Hl(t,"error",function(e){var t;ec("connect_error"),r.cleanup(),r.readyState="closed",r.emitAll("connect_error",e),n?((t=new Error("Connection error")).data=e,n(t)):r.maybeReconnectOnOpen()});return!1!==this._timeout&&(i=this._timeout,ec("connect attempt will timeout after %d",i),o=setTimeout(function(){ec("connect attempt timed out after %d",i),s.destroy(),t.close(),t.emit("error","timeout"),r.emitAll("connect_timeout",i)},i),this.subs.push({destroy:function(){clearTimeout(o)}})),this.subs.push(s),this.subs.push(a),this},nc.prototype.onopen=function(){ec("open"),this.cleanup(),this.readyState="open",this.emit("open");var e=this.engine;this.subs.push(Hl(e,"data",Vl(this,"ondata"))),this.subs.push(Hl(e,"ping",Vl(this,"onping"))),this.subs.push(Hl(e,"pong",Vl(this,"onpong"))),this.subs.push(Hl(e,"error",Vl(this,"onerror"))),this.subs.push(Hl(e,"close",Vl(this,"onclose"))),this.subs.push(Hl(this.decoder,"decoded",Vl(this,"ondecoded")))},nc.prototype.onping=function(){this.lastPing=new Date,this.emitAll("ping")},nc.prototype.onpong=function(){this.emitAll("pong",new Date-this.lastPing)},nc.prototype.ondata=function(e){this.decoder.add(e)},nc.prototype.ondecoded=function(e){this.emit("packet",e)},nc.prototype.onerror=function(e){ec("error",e),this.emitAll("error",e)},nc.prototype.socket=function(e,t){var n,r=this.nsps[e];function i(){~Du(n.connecting,r)||n.connecting.push(r)}return r||(r=new Xl(this,e,t),this.nsps[e]=r,n=this,r.on("connecting",i),r.on("connect",function(){r.id=n.generateId(e)}),this.autoConnect&&i()),r},nc.prototype.destroy=function(e){e=Du(this.connecting,e);~e&&this.connecting.splice(e,1),this.connecting.length||this.close()},nc.prototype.packet=function(n){ec("writing packet %j",n);var r=this;n.query&&0===n.type&&(n.nsp+="?"+n.query),r.encoding?r.packetBuffer.push(n):(r.encoding=!0,this.encoder.encode(n,function(e){for(var t=0;t<e.length;t++)r.engine.write(e[t],n.options);r.encoding=!1,r.processPacketQueue()}))},nc.prototype.processPacketQueue=function(){var e;0<this.packetBuffer.length&&!this.encoding&&(e=this.packetBuffer.shift(),this.packet(e))},nc.prototype.cleanup=function(){ec("cleanup");for(var e=this.subs.length,t=0;t<e;t++)this.subs.shift().destroy();this.packetBuffer=[],this.encoding=!1,this.lastPing=null,this.decoder.destroy()},nc.prototype.close=nc.prototype.disconnect=function(){ec("disconnect"),this.skipReconnect=!0,this.reconnecting=!1,"opening"===this.readyState&&this.cleanup(),this.backoff.reset(),this.readyState="closed",this.engine&&this.engine.close()},nc.prototype.onclose=function(e){ec("onclose"),this.cleanup(),this.backoff.reset(),this.readyState="closed",this.emit("close",e),this._reconnection&&!this.skipReconnect&&this.reconnect()},nc.prototype.reconnect=function(){if(this.reconnecting||this.skipReconnect)return this;var e,t,n=this;this.backoff.attempts>=this._reconnectionAttempts?(ec("reconnect failed"),this.backoff.reset(),this.emitAll("reconnect_failed"),this.reconnecting=!1):(e=this.backoff.duration(),ec("will wait %dms before reconnect attempt",e),this.reconnecting=!0,t=setTimeout(function(){n.skipReconnect||(ec("attempting reconnect"),n.emitAll("reconnect_attempt",n.backoff.attempts),n.emitAll("reconnecting",n.backoff.attempts),n.skipReconnect||n.open(function(e){e?(ec("reconnect attempt error"),n.reconnecting=!1,n.reconnect(),n.emitAll("reconnect_error",e.data)):(ec("reconnect success"),n.onreconnect())}))},e),this.subs.push({destroy:function(){clearTimeout(t)}}))},nc.prototype.onreconnect=function(){var e=this.backoff.attempts;this.reconnecting=!1,this.backoff.reset(),this.updateSocketIds(),this.emitAll("reconnect",e)};var ic,oc=["ASSEMBLY_UPLOADING","ASSEMBLY_EXECUTING","ASSEMBLY_COMPLETED"];function sc(e,t){return oc.indexOf(e)>=oc.indexOf(t)}var ac=function(n){var e;function t(e){var t;return(t=n.call(this)||this).status=e,t.socket=null,t.pollInterval=null,t.closed=!1,t}r=n,(e=t).prototype=Object.create(r.prototype),(e.prototype.constructor=e).__proto__=r;var r=t.prototype;return r.connect=function(){this._connectSocket(),this._beginPolling()},r._onFinished=function(){this.emit("finished"),this.close()},r._connectSocket=function(){var n=this,e=function(e){var t=/^\w+:\/\//.exec(e),n=0;t&&(n=t[0].length+1);n=e.indexOf("/",n);return-1===n?{origin:e,pathname:"/"}:{origin:e.slice(0,n),pathname:e.slice(n)}}(this.status.websocket_url),t=(ic=ic||i({})).connect(e.origin,{transports:["websocket"],path:e.pathname});t.on("connect",function(){t.emit("assembly_connect",{id:n.status.assembly_id}),n.emit("connect")}),t.on("connect_failed",function(){n._onError(new Ie("Transloadit Socket.io connection error")),n.socket=null}),t.on("error",function(){t.disconnect(),n.socket=null}),t.on("assembly_finished",function(){n._onFinished()}),t.on("assembly_upload_finished",function(e){n.emit("upload",e),n.status.uploads.push(e)}),t.on("assembly_uploading_finished",function(){n.emit("executing")}),t.on("assembly_upload_meta_data_extracted",function(){n.emit("metadata"),n._fetchStatus({diff:!1})}),t.on("assembly_result_finished",function(e,t){n.emit("result",e,t),n.status.results[e]||(n.status.results[e]=[]),n.status.results[e].push(t)}),t.on("assembly_error",function(e){n._onError(e),n._fetchStatus({diff:!1})}),this.socket=t},r._onError=function(e){this.emit("error",rc(new Error(e.message),e))},r._beginPolling=function(){var e=this;this.pollInterval=setInterval(function(){e.socket&&e.socket.connected||e._fetchStatus()},2e3)},r._fetchStatus=function(e){var t=this,e=(void 0===e?{}:e).diff,n=void 0===e||e;return De(this.status.assembly_ssl_url).then(function(e){return e.json()}).then(function(e){t.closed||(t.emit("status",e),n?t.updateStatus(e):t.status=e)}).catch(function(e){return t._onError(e)})},r.update=function(){return this._fetchStatus({diff:!0})},r.updateStatus=function(e){this._diffStatus(this.status,e),this.status=e},r._diffStatus=function(r,i){var o=this,e=r.ok,t=i.ok;if(i.error&&!r.error)return this._onError(i);var n=sc(t,"ASSEMBLY_EXECUTING")&&!sc(e,"ASSEMBLY_EXECUTING");n&&this.emit("executing"),Object.keys(i.uploads).filter(function(e){return!w(r.uploads,e)}).map(function(e){return i.uploads[e]}).forEach(function(e){o.emit("upload",e)}),n&&this.emit("metadata"),Object.keys(i.results).forEach(function(t){var e=i.results[t],n=r.results[t];e.filter(function(t){return!n||!n.some(function(e){return e.id===t.id})}).forEach(function(e){o.emit("result",t,e)})}),sc(t,"ASSEMBLY_COMPLETED")&&!sc(e,"ASSEMBLY_COMPLETED")&&this.emit("finished")},r.close=function(){this.closed=!0,this.socket&&(this.socket.disconnect(),this.socket=null),clearInterval(this.pollInterval)},t}(ds),uc=((A=cc.prototype).createAssembly=function(e){var t=this,n=e.params,r=e.fields,i=e.signature,e=e.expectedFiles,o=new FormData;o.append("params","string"==typeof n?n:JSON.stringify(n)),i&&o.append("signature",i),Object.keys(r).forEach(function(e){o.append(e,r[e])}),o.append("num_expected_upload_files",e);var s=this.opts.service+"/assemblies";return De(s,{method:"post",headers:this._headers,body:o}).then(function(e){return e.json()}).then(function(e){if(e.error){var t=new Error(e.error);throw t.details=e.message,(t.assembly=e).assembly_id&&(t.details+=" Assembly ID: "+e.assembly_id),t}return e}).catch(function(e){return t._reportError(e,{url:s,type:"API_ERROR"})})},A.reserveFile=function(t,n){var r=this,e=encodeURIComponent(n.size),i=t.assembly_ssl_url+"/reserve_file?size="+e;return De(i,{method:"post",headers:this._headers}).then(function(e){return e.json()}).catch(function(e){return r._reportError(e,{assembly:t,file:n,url:i,type:"API_ERROR"})})},A.addFile=function(t,n){var r=this;if(!n.uploadURL)return Promise.reject(new Error("File does not have an `uploadURL`."));var e=encodeURIComponent(n.size),i=encodeURIComponent(n.uploadURL),i="size="+e+"&filename="+encodeURIComponent(n.name)+"&fieldname=file&s3Url="+i,o=t.assembly_ssl_url+"/add_file?"+i;return De(o,{method:"post",headers:this._headers}).then(function(e){return e.json()}).catch(function(e){return r._reportError(e,{assembly:t,file:n,url:o,type:"API_ERROR"})})},A.cancelAssembly=function(e){var t=this,n=e.assembly_ssl_url;return De(n,{method:"delete",headers:this._headers}).then(function(e){return e.json()}).catch(function(e){return t._reportError(e,{url:n,type:"API_ERROR"})})},A.getAssemblyStatus=function(t){var n=this;return De(t,{headers:this._headers}).then(function(e){return e.json()}).catch(function(e){return n._reportError(e,{url:t,type:"STATUS_ERROR"})})},A.submitError=function(e,t){var n=t.endpoint,r=t.instance,t=t.assembly,e=e.details?e.message+" ("+e.details+")":e.message;return De("https://transloaditstatus.com/client_error",{method:"post",body:JSON.stringify({endpoint:n,instance:r,assembly_id:t,agent:"undefined"!=typeof navigator?navigator.userAgent:"",client:this.opts.client,error:e})}).then(function(e){return e.json()})},A._reportError=function(e,t){if(!1===this.opts.errorReporting)throw e;var n={type:t.type};throw t.assembly&&(n.assembly=t.assembly.assembly_id,n.instance=t.assembly.instance),t.url&&(n.endpoint=t.url),this.submitError(e,n).catch(function(e){}),e},cc),lc={};function cc(e){this.opts=e=void 0===e?{}:e,this._reportError=this._reportError.bind(this),this._headers={"Transloadit-Client":this.opts.client}}function pc(e){if(!e)throw new Error("Transloadit: The `params` option is required.");if("string"==typeof e)try{e=JSON.parse(e)}catch(e){throw e.message="Transloadit: The `params` option is a malformed JSON string: "+e.message,e}if(!e.auth||!e.auth.key)throw new Error("Transloadit: The `params.auth.key` option is required. You can find your Transloadit API key at https://transloadit.com/account/api-settings.")}(Fc=dc.prototype)._normalizeAssemblyOptions=function(t,n){var e;return Array.isArray(n.fields)&&(e=n.fields,n.fields={},e.forEach(function(e){n.fields[e]=t.meta[e]})),n.fields||(n.fields={}),n},Fc._getAssemblyOptions=function(t){var n=this,e=this.opts;return Promise.resolve().then(function(){return e.getAssemblyOptions(t,e)}).then(function(e){return n._normalizeAssemblyOptions(t,e)}).then(function(e){return pc(e.params),{fileIDs:[t.id],options:e}})},Fc._dedupe=function(e){var i=Object.create(null);return e.forEach(function(e){var t=e.fileIDs,n=e.options,r=JSON.stringify(n);i[r]?(e=i[r].fileIDs).push.apply(e,t):i[r]={options:n,fileIDs:[].concat(t)}}),Object.keys(i).map(function(e){return i[e]})},Fc.build=function(){var t=this,e=this.opts;return 0<this.files.length?Promise.all(this.files.map(function(e){return t._getAssemblyOptions(e)})).then(function(e){return t._dedupe(e)}):e.alwaysRunAssembly?Promise.resolve(e.getAssemblyOptions(null,e)).then(function(e){return pc(e.params),[{fileIDs:t.files.map(function(e){return e.id}),options:e}]}):Promise.resolve([])},o=dc;function dc(e,t){this.files=e,this.opts=t}function hc(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(lc=o).validateParams=pc;var fc=function(r){var e;function t(e,t){var n;return(n=r.call(this)||this)._uppy=e,n._assemblyIDs=t,n._remaining=t.length,n.promise=new Promise(function(e,t){n._resolve=e,n._reject=t}),n._onAssemblyComplete=n._onAssemblyComplete.bind(hc(n)),n._onAssemblyCancel=n._onAssemblyCancel.bind(hc(n)),n._onAssemblyError=n._onAssemblyError.bind(hc(n)),n._onImportError=n._onImportError.bind(hc(n)),n._addListeners(),n}n=r,(e=t).prototype=Object.create(n.prototype),(e.prototype.constructor=e).__proto__=n;var n=t.prototype;return n._watching=function(e){return-1!==this._assemblyIDs.indexOf(e)},n._onAssemblyComplete=function(e){this._watching(e.assembly_id)&&(this._uppy.log("[Transloadit] AssemblyWatcher: Got Assembly finish "+e.assembly_id),this.emit("assembly-complete",e.assembly_id),this._checkAllComplete())},n._onAssemblyCancel=function(e){this._watching(e.assembly_id)&&this._checkAllComplete()},n._onAssemblyError=function(e,t){this._watching(e.assembly_id)&&(this._uppy.log("[Transloadit] AssemblyWatcher: Got Assembly error "+e.assembly_id),this._uppy.log(t),this.emit("assembly-error",e.assembly_id,t),this._checkAllComplete())},n._onImportError=function(e,t,n){this._watching(e.assembly_id)&&this._onAssemblyError(e,n)},n._checkAllComplete=function(){--this._remaining,0===this._remaining&&(this._removeListeners(),this._resolve())},n._removeListeners=function(){this._uppy.off("transloadit:complete",this._onAssemblyComplete),this._uppy.off("transloadit:assembly-cancel",this._onAssemblyCancel),this._uppy.off("transloadit:assembly-error",this._onAssemblyError),this._uppy.off("transloadit:import-error",this._onImportError)},n._addListeners=function(){this._uppy.on("transloadit:complete",this._onAssemblyComplete),this._uppy.on("transloadit:assembly-cancel",this._onAssemblyCancel),this._uppy.on("transloadit:assembly-error",this._onAssemblyError),this._uppy.on("transloadit:import-error",this._onImportError)},t}(ds),tl={};function yc(){return(yc=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,r=arguments[t];for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function gc(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function mc(e,t){return{params:t.params,signature:t.signature,fields:t.fields}}var Ss="https://api2.transloadit.com/companion",vc=/https?:\/\/api2(?:-\w+)?\.transloadit\.com\/companion/,bc=/https?:\/\/api2(?:-\w+)?\.transloadit\.com\/uppy-server/;function wc(){return(wc=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,r=arguments[t];for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}Fc=A=function(r){var e;function t(e,t){var n;(n=r.call(this,e,t)||this).type="uploader",n.id=n.opts.id||"Transloadit",n.title="Transloadit";e={service:"https://api2.transloadit.com",errorReporting:!0,waitForEncoding:!(n.defaultLocale={strings:{creatingAssembly:"Preparing upload...",creatingAssemblyFailed:"Transloadit: Could not create Assembly",encoding:"Encoding..."}}),waitForMetadata:!1,alwaysRunAssembly:!1,importFromUploadURLs:!1,signature:null,params:null,fields:{},getAssemblyOptions:mc,limit:0};n.opts=yc({},e,t),n.i18nInit(),n._prepareUpload=n._prepareUpload.bind(gc(n)),n._afterUpload=n._afterUpload.bind(gc(n)),n._onError=n._onError.bind(gc(n)),n._onTusError=n._onTusError.bind(gc(n)),n._onCancelAll=n._onCancelAll.bind(gc(n)),n._onFileUploadURLAvailable=n._onFileUploadURLAvailable.bind(gc(n)),n._onRestored=n._onRestored.bind(gc(n)),n._getPersistentData=n._getPersistentData.bind(gc(n));e=n.opts.getAssemblyOptions!==e.getAssemblyOptions;return n.opts.params?lc.validateParams(n.opts.params):e||lc.validateParams(null),n.client=new uc({service:n.opts.service,client:n._getClientVersion(),errorReporting:n.opts.errorReporting}),n.activeAssemblies={},n.assemblyWatchers={},n.completedFiles=Object.create(null),n}n=r,(e=t).prototype=Object.create(n.prototype),(e.prototype.constructor=e).__proto__=n;var n=t.prototype;return n.setOptions=function(e){r.prototype.setOptions.call(this,e),this.i18nInit()},n.i18nInit=function(){this.translator=new C([this.defaultLocale,this.uppy.locale,this.opts.locale]),this.i18n=this.translator.translate.bind(this.translator),this.i18nArray=this.translator.translateArray.bind(this.translator),this.setPluginState()},n._getClientVersion=function(){function e(e,t){(e=n.uppy.getPlugin(e))&&r.push(t+":"+e.constructor.VERSION)}var n=this,r=["uppy-core:"+this.uppy.constructor.VERSION,"uppy-transloadit:"+this.constructor.VERSION,"uppy-tus:"+tu.VERSION];return this.opts.importFromUploadURLs&&(e("XHRUpload","uppy-xhr-upload"),e("AwsS3","uppy-aws-s3"),e("AwsS3Multipart","uppy-aws-s3-multipart")),e("Dropbox","uppy-dropbox"),e("Box","uppy-box"),e("Facebook","uppy-facebook"),e("GoogleDrive","uppy-google-drive"),e("Instagram","uppy-instagram"),e("OneDrive","uppy-onedrive"),e("Zoom","uppy-zoom"),e("Url","uppy-url"),r.join(",")},n._attachAssemblyMetadata=function(e,t){var n,r=yc({},e.meta,{assembly_url:t.assembly_url,filename:e.name,fieldname:"file"}),i=yc({},e.tus,{endpoint:t.tus_url,addRequestId:!0}),o=e.remote;if(e.remote&&bc.test(e.remote.companionUrl)){var s=new Error("The https://api2.transloadit.com/uppy-server endpoint was renamed to https://api2.transloadit.com/companion, please update your `companionUrl` options accordingly.");throw this.uppy.log(s),s}e.remote&&vc.test(e.remote.companionUrl)&&(n=t.companion_url.replace(/\/$/,""),s=e.remote.url.replace(e.remote.companionUrl,"").replace(/^\//,""),o=yc({},e.remote,{companionUrl:n,url:n+"/"+s}));t=yc({},e,{transloadit:{assembly:t.assembly_id}});return this.opts.importFromUploadURLs||yc(t,{meta:r,tus:i,remote:o}),t},n._createAssembly=function(s,a,e){var u=this;return this.uppy.log("[Transloadit] Create Assembly"),this.client.createAssembly({params:e.params,fields:e.fields,expectedFiles:s.length,signature:e.signature}).then(function(e){var t=new ac(e),n=t.status,r=n.assembly_id,i=u.getPluginState(),e=i.assemblies,i=i.uploadsAssemblies;u.setPluginState({assemblies:yc({},e,((e={})[r]=n,e)),uploadsAssemblies:yc({},i,((e={})[a]=[].concat(i[a],[r]),e))});var e=u.uppy.getState().files,o={};return s.forEach(function(e){o[e]=u._attachAssemblyMetadata(u.uppy.getFile(e),n)}),u.uppy.setState({files:yc({},e,o)}),u.uppy.emit("transloadit:assembly-created",n,s),u.uppy.log("[Transloadit] Created Assembly "+r),t}).catch(function(e){throw e.message=u.i18n("creatingAssemblyFailed")+": "+e.message,e})},n._createAssemblyWatcher=function(e,t,n){var r=this,e=new fc(this.uppy,e);e.on("assembly-complete",function(e){r.getAssemblyFiles(e).forEach(function(e){r.completedFiles[e.id]=!0,r.uppy.emit("postprocess-complete",e)})}),e.on("assembly-error",function(e,t){r.getAssemblyFiles(e).forEach(function(e){r.uppy.emit("upload-error",e,t),r.uppy.emit("postprocess-complete",e)})}),this.assemblyWatchers[n]=e},n._shouldWaitAfterUpload=function(){return this.opts.waitForEncoding||this.opts.waitForMetadata},n._reserveFiles=function(t,e){var n=this;return Promise.all(e.map(function(e){e=n.uppy.getFile(e);return n.client.reserveFile(t,e)}))},n._onFileUploadURLAvailable=function(t){var n,r=this;t&&t.transloadit&&t.transloadit.assembly&&(n=this.getPluginState().assemblies[t.transloadit.assembly],this.client.addFile(n,t).catch(function(e){r.uppy.log(e),r.uppy.emit("transloadit:import-error",n,t.id,e)}))},n._findFile=function(e){for(var t=this.uppy.getFiles(),n=0;n<t.length;n++){var r=t[n];if(r.uploadURL===e.tus_upload_url)return r;if(r.tus&&r.tus.uploadUrl===e.tus_upload_url)return r;if(!e.is_tus_file&&r.name===e.name&&r.size===e.size)return r}},n._onFileUploadComplete=function(e,t){var n=this.getPluginState(),r=this._findFile(t);r?(this.setPluginState({files:yc({},n.files,((n={})[t.id]={assembly:e,id:r.id,uploadedFile:t},n))}),this.uppy.emit("transloadit:upload",t,this.getAssembly(e))):this.uppy.log("[Transloadit] Couldnt file the file, it was likely removed in the process")},n._onResult=function(e,t,n){var r=this.getPluginState(),i=r.files[n.original_id];n.localId=i?i.id:null;i={result:n,stepName:t,id:n.id,assembly:e};this.setPluginState({results:[].concat(r.results,[i])}),this.uppy.emit("transloadit:result",t,n,this.getAssembly(e))},n._onAssemblyFinished=function(e){var r=this,e=e.assembly_ssl_url;this.client.getAssemblyStatus(e).then(function(e){var t=e.assembly_id,n=r.getPluginState();r.setPluginState({assemblies:yc({},n.assemblies,((n={})[t]=e,n))}),r.uppy.emit("transloadit:complete",e)})},n._cancelAssembly=function(e){var t=this;return this.client.cancelAssembly(e).then(function(){t.uppy.emit("transloadit:assembly-cancelled",e)})},n._onCancelAll=function(){var t=this,n=this.getPluginState().uploadsAssemblies,e=Object.keys(n).reduce(function(e,t){return e.push.apply(e,n[t]),e},[]).map(function(e){e=t.getAssembly(e);return t._cancelAssembly(e)});Promise.all(e).catch(function(e){t.uppy.log(e)})},n._getPersistentData=function(e){var t=this.getPluginState(),n=t.assemblies,t=t.uploadsAssemblies;e(((e={})[this.id]={assemblies:n,uploadsAssemblies:t},e))},n._onRestored=function(e){var a=this,e=e&&e[this.id]?e[this.id]:{},i=e.assemblies||{},u=e.uploadsAssemblies||{};0!==Object.keys(u).length&&(this.restored=Promise.resolve().then(function(){var e,t,r,n=i,o={},s=[];return Object.keys(n).forEach(function(r){var e=n[r];e.uploads.forEach(function(e){var t=a._findFile(e);o[e.id]={id:t.id,assembly:r,uploadedFile:e}});var i=a.getPluginState();Object.keys(e.results).forEach(function(n){e.results[n].forEach(function(e){var t=i.files[e.original_id];e.localId=t?t.id:null,s.push({id:e.id,result:e,stepName:n,assembly:r})})})}),a.setPluginState({assemblies:n,files:o,results:s,uploadsAssemblies:u}),e=a.getPluginState(),t=e.assemblies,r=e.uploadsAssemblies,Object.keys(r).forEach(function(e){var t=r[e],n=t.reduce(function(e,t){t=a.getAssemblyFiles(t).map(function(e){return e.id});return e.push.apply(e,t),e},[]);a._createAssemblyWatcher(t,n,e)}),Object.keys(t).forEach(function(e){e=new ac(t[e]);a._connectAssembly(e)}),e=a.getPluginState().assemblies,Promise.all(Object.keys(e).map(function(e){return a.activeAssemblies[e].update()}))}),this.restored.then(function(){a.restored=null}))},n._connectAssembly=function(n){var r=this,i=n.status.assembly_id;return(this.activeAssemblies[i]=n).on("status",function(e){var t=r.getPluginState().assemblies;r.setPluginState({assemblies:yc({},t,((t={})[i]=e,t))})}),n.on("upload",function(e){r._onFileUploadComplete(i,e)}),n.on("error",function(e){e.assembly=n.status,r.uppy.emit("transloadit:assembly-error",n.status,e)}),n.on("executing",function(){r.uppy.emit("transloadit:assembly-executing",n.status)}),this.opts.waitForEncoding&&n.on("result",function(e,t){r._onResult(i,e,t)}),this.opts.waitForEncoding?n.on("finished",function(){r._onAssemblyFinished(n.status)}):this.opts.waitForMetadata&&n.on("metadata",function(){r._onAssemblyFinished(n.status)}),"ASSEMBLY_COMPLETE"===n.ok||(new Promise(function(e,t){n.once("connect",e),n.once("status",e),n.once("error",t)}).then(function(){r.uppy.log("[Transloadit] Socket is ready")}),n.connect()),n},n._prepareUpload=function(n,r){var i=this;(n=n.filter(function(e){return!e.error})).forEach(function(e){e=i.uppy.getFile(e);i.uppy.emit("preprocess-progress",e,{mode:"indeterminate",message:i.i18n("creatingAssembly")})});function t(e){var t,n=e.fileIDs,e=e.options;return i._createAssembly(n,r,e).then(function(e){if(t=e,i.opts.importFromUploadURLs)return i._reserveFiles(e,n)}).then(function(){return n.forEach(function(e){e=i.uppy.getFile(e);i.uppy.emit("preprocess-complete",e)}),t}).catch(function(t){throw n.forEach(function(e){e=i.uppy.getFile(e);i.uppy.emit("preprocess-complete",e),i.uppy.emit("upload-error",e,t)}),t})}var e=this.getPluginState().uploadsAssemblies;this.setPluginState({uploadsAssemblies:yc({},e,((e={})[r]=[],e))});e=n.map(function(e){return i.uppy.getFile(e)});return new lc(e,this.opts).build().then(function(e){return Promise.all(e.map(t)).then(function(e){var t=e.map(function(e){return e.status.assembly_id});i._createAssemblyWatcher(t,n,r),e.map(function(e){return i._connectAssembly(e)})})},function(t){throw n.forEach(function(e){e=i.uppy.getFile(e);i.uppy.emit("preprocess-complete",e),i.uppy.emit("upload-error",e,t)}),t})},n._afterUpload=function(e,n){var r=this,t=e.map(function(e){return r.uppy.getFile(e)});e=t.filter(function(e){return!e.error}).map(function(e){return e.id});var i=this.getPluginState();if(this.restored)return this.restored.then(function(){return r._afterUpload(e,n)});var o=i.uploadsAssemblies[n];if(this._shouldWaitAfterUpload())return 0===o.length?(this.uppy.addResultData(n,{transloadit:[]}),Promise.resolve()):(t.filter(function(e){return!w(r.completedFiles,e.id)}).forEach(function(e){r.uppy.emit("postprocess-progress",e,{mode:"indeterminate",message:r.i18n("encoding")})}),this.assemblyWatchers[n].promise.then(function(){var e=o.map(function(e){return r.getAssembly(e)}),t=yc({},r.getPluginState().uploadsAssemblies);delete t[n],r.setPluginState({uploadsAssemblies:t}),r.uppy.addResultData(n,{transloadit:e})}));o.forEach(function(e){r.activeAssemblies[e].close(),delete r.activeAssemblies[e]});t=o.map(function(e){return r.getAssembly(e)});return this.uppy.addResultData(n,{transloadit:t}),Promise.resolve()},n._onError=function(e,t){var n=this;void 0===e&&(e=null),this.getPluginState().uploadsAssemblies[t].forEach(function(e){n.activeAssemblies[e]&&n.activeAssemblies[e].close()})},n._onTusError=function(e){var t;e&&/^tus: /.test(e.message)&&(t=(t=e.originalRequest?e.originalRequest.getUnderlyingObject():null)&&t.responseURL?t.responseURL:null,this.client.submitError(e,{url:t,type:"TUS_ERROR"}).then(function(e){}))},n.install=function(){this.uppy.addPreProcessor(this._prepareUpload),this.uppy.addPostProcessor(this._afterUpload),this.uppy.on("error",this._onError),this.uppy.on("cancel-all",this._onCancelAll),this.uppy.on("upload-error",this._onTusError),this.opts.importFromUploadURLs?this.uppy.on("upload-success",this._onFileUploadURLAvailable):this.uppy.use(tu,{storeFingerprintForResuming:!1,resume:!1,useFastRemoteRetry:!1,metaFields:["assembly_url","filename","fieldname"],limit:this.opts.limit}),this.uppy.on("restore:get-data",this._getPersistentData),this.uppy.on("restored",this._onRestored),this.setPluginState({assemblies:{},uploadsAssemblies:{},files:{},results:[]});var e=this.uppy.getState().capabilities;this.uppy.setState({capabilities:yc({},e,{individualCancellation:!1})})},n.uninstall=function(){this.uppy.removePreProcessor(this._prepareUpload),this.uppy.removePostProcessor(this._afterUpload),this.uppy.off("error",this._onError),this.opts.importFromUploadURLs&&this.uppy.off("upload-success",this._onFileUploadURLAvailable);var e=this.uppy.getState().capabilities;this.uppy.setState({capabilities:yc({},e,{individualCancellation:!0})})},n.getAssembly=function(e){return this.getPluginState().assemblies[e]},n.getAssemblyFiles=function(t){return this.uppy.getFiles().filter(function(e){return e&&e.transloadit&&e.transloadit.assembly===t})},t}(ue.Plugin),A.VERSION="1.6.15",(tl=Fc).COMPANION=Ss,tl.UPPY_SERVER=Ss,tl.COMPANION_PATTERN=/\.transloadit\.com$/;var _c=We.Provider,Sc=We.RequestClient,kc=We.Socket;function Pc(e,t){return(t="string"==typeof(t=t||new Error("Upload error"))?new Error(t):t)instanceof Error||(t=wc(new Error("Upload error"),{data:t})),Xo(e)?new Ie(t,e):(t.request=e,t)}function Cc(e){return e.data.slice(0,e.data.size,e.meta.type)}var A=(ds=o=function(r){var e;function t(e,t){var n;(n=r.call(this,e,t)||this).type="uploader",n.id=n.opts.id||"XHRUpload",n.title="XHRUpload";e={formData:!0,fieldName:"files[]",method:"post",metaFields:null,responseUrlFieldName:"url",bundle:!(n.defaultLocale={strings:{timedOut:"Upload stalled for %{seconds} seconds, aborting."}}),headers:{},timeout:3e4,limit:0,withCredentials:!1,responseType:"",getResponseData:function(e,t){var n={};try{n=JSON.parse(e)}catch(e){console.log(e)}return n},getResponseError:function(e,t){var n=new Error("Upload error");return n=Xo(t)?new Ie(n,t):n},validateStatus:function(e,t,n){return 200<=e&&e<300}};if(n.opts=wc({},e,t),n.i18nInit(),n.handleUpload=n.handleUpload.bind(function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(n)),n.opts.__queue instanceof zo?n.requests=n.opts.__queue:n.requests=new zo(n.opts.limit),n.opts.bundle&&!n.opts.formData)throw new Error("`opts.formData` must be true when `opts.bundle` is enabled.");return n.uploaderEvents=Object.create(null),n}n=r,(e=t).prototype=Object.create(n.prototype),(e.prototype.constructor=e).__proto__=n;var n=t.prototype;return n.setOptions=function(e){r.prototype.setOptions.call(this,e),this.i18nInit()},n.i18nInit=function(){this.translator=new C([this.defaultLocale,this.uppy.locale,this.opts.locale]),this.i18n=this.translator.translate.bind(this.translator),this.setPluginState()},n.getOptions=function(e){var t=this.uppy.getState().xhrUpload,n=wc({},this.opts,t||{},e.xhrUpload||{},{headers:{}});return wc(n.headers,this.opts.headers),t&&wc(n.headers,t.headers),e.xhrUpload&&wc(n.headers,e.xhrUpload.headers),n},n.addMetadata=function(t,n,e){(Array.isArray(e.metaFields)?e.metaFields:Object.keys(n)).forEach(function(e){t.append(e,n[e])})},n.createFormDataUpload=function(e,t){var n=new FormData;this.addMetadata(n,e.meta,t);var r=Cc(e);return e.name?n.append(t.fieldName,r,e.meta.name):n.append(t.fieldName,r),n},n.createBundledUpload=function(e,t){var r=this,i=new FormData,n=this.uppy.getState().meta;return this.addMetadata(i,n,t),e.forEach(function(e){var t=r.getOptions(e),n=Cc(e);e.name?i.append(t.fieldName,n,e.name):i.append(t.fieldName,n)}),i},n.createBareUpload=function(e,t){return e.data},n.upload=function(l,e,t){var c=this,p=this.getOptions(l);return this.uppy.log("uploading "+e+" of "+t),new Promise(function(r,i){c.uppy.emit("upload-started",l);var e=p.formData?c.createFormDataUpload(l,p):c.createBareUpload(l,p),o=new XMLHttpRequest;c.uploaderEvents[l.id]=new Vo(c.uppy);var s=new Wo(p.timeout,function(){o.abort(),u.done();var e=new Error(c.i18n("timedOut",{seconds:Math.ceil(p.timeout/1e3)}));c.uppy.emit("upload-error",l,e),i(e)}),a=D();o.upload.addEventListener("loadstart",function(e){c.uppy.log("[XHRUpload] "+a+" started")}),o.upload.addEventListener("progress",function(e){c.uppy.log("[XHRUpload] "+a+" progress: "+e.loaded+" / "+e.total),s.progress(),e.lengthComputable&&c.uppy.emit("upload-progress",l,{uploader:c,bytesUploaded:e.loaded,bytesTotal:e.total})}),o.addEventListener("load",function(e){if(c.uppy.log("[XHRUpload] "+a+" finished"),s.done(),u.done(),c.uploaderEvents[l.id]&&(c.uploaderEvents[l.id].remove(),c.uploaderEvents[l.id]=null),p.validateStatus(e.target.status,o.responseText,o)){var t=p.getResponseData(o.responseText,o),n=t[p.responseUrlFieldName],t={status:e.target.status,body:t,uploadURL:n};return c.uppy.emit("upload-success",l,t),n&&c.uppy.log("Download "+l.name+" from "+n),r(l)}t=p.getResponseData(o.responseText,o),n=Pc(o,p.getResponseError(o.responseText,o)),t={status:e.target.status,body:t};return c.uppy.emit("upload-error",l,n,t),i(n)}),o.addEventListener("error",function(e){c.uppy.log("[XHRUpload] "+a+" errored"),s.done(),u.done(),c.uploaderEvents[l.id]&&(c.uploaderEvents[l.id].remove(),c.uploaderEvents[l.id]=null);var t=Pc(o,p.getResponseError(o.responseText,o));return c.uppy.emit("upload-error",l,t),i(t)}),o.open(p.method.toUpperCase(),p.endpoint,!0),o.withCredentials=p.withCredentials,""!==p.responseType&&(o.responseType=p.responseType),Object.keys(p.headers).forEach(function(e){o.setRequestHeader(e,p.headers[e])});var u=c.requests.run(function(){return o.send(e),function(){s.done(),o.abort()}});c.onFileRemove(l.id,function(){u.abort(),i(new Error("File removed"))}),c.onCancelAll(l.id,function(){u.abort(),i(new Error("Upload cancelled"))})})},n.uploadRemote=function(s,e,t){var a=this,u=this.getOptions(s);return new Promise(function(i,o){a.uppy.emit("upload-started",s);var t={};(Array.isArray(u.metaFields)?u.metaFields:Object.keys(s.meta)).forEach(function(e){t[e]=s.meta[e]}),new(s.remote.providerOptions.provider?_c:Sc)(a.uppy,s.remote.providerOptions).post(s.remote.url,wc({},s.remote.body,{endpoint:u.endpoint,size:s.data.size,fieldname:u.fieldName,metadata:t,httpMethod:u.method,useFormData:u.formData,headers:u.headers})).then(function(e){var t=e.token,e=No(s.remote.companionUrl),n=new kc({target:e+"/api/"+t,autoOpen:!1});a.uploaderEvents[s.id]=new Vo(a.uppy),a.onFileRemove(s.id,function(){n.send("pause",{}),r.abort(),i("upload "+s.id+" was removed")}),a.onCancelAll(s.id,function(){n.send("pause",{}),r.abort(),i("upload "+s.id+" was canceled")}),a.onRetry(s.id,function(){n.send("pause",{}),n.send("resume",{})}),a.onRetryAll(s.id,function(){n.send("pause",{}),n.send("resume",{})}),n.on("progress",function(e){return Ho(a,e,s)}),n.on("success",function(e){var t=u.getResponseData(e.response.responseText,e.response),n=t[u.responseUrlFieldName],n={status:e.response.status,body:t,uploadURL:n};return a.uppy.emit("upload-success",s,n),r.done(),a.uploaderEvents[s.id]&&(a.uploaderEvents[s.id].remove(),a.uploaderEvents[s.id]=null),i()}),n.on("error",function(e){var t=e.response,e=t?u.getResponseError(t.responseText,t):wc(new Error(e.error.message),{cause:e.error});a.uppy.emit("upload-error",s,e),r.done(),a.uploaderEvents[s.id]&&(a.uploaderEvents[s.id].remove(),a.uploaderEvents[s.id]=null),o(e)});var r=a.requests.run(function(){return n.open(),s.isPaused&&n.send("pause",{}),function(){return n.close()}})}).catch(function(e){a.uppy.emit("upload-error",s,e),o(e)})})},n.uploadBundle=function(u){var l=this;return new Promise(function(r,i){var e=l.opts.endpoint,t=l.opts.method,n=l.uppy.getState().xhrUpload,n=l.createBundledUpload(u,wc({},l.opts,n||{})),o=new XMLHttpRequest,s=new Wo(l.opts.timeout,function(){o.abort();var e=new Error(l.i18n("timedOut",{seconds:Math.ceil(l.opts.timeout/1e3)}));a(e),i(e)}),a=function(t){u.forEach(function(e){l.uppy.emit("upload-error",e,t)})};o.upload.addEventListener("loadstart",function(e){l.uppy.log("[XHRUpload] started uploading bundle"),s.progress()}),o.upload.addEventListener("progress",function(t){s.progress(),t.lengthComputable&&u.forEach(function(e){l.uppy.emit("upload-progress",e,{uploader:l,bytesUploaded:t.loaded/t.total*e.size,bytesTotal:e.size})})}),o.addEventListener("load",function(e){if(s.done(),l.opts.validateStatus(e.target.status,o.responseText,o)){var t=l.opts.getResponseData(o.responseText,o),n={status:e.target.status,body:t};return u.forEach(function(e){l.uppy.emit("upload-success",e,n)}),r()}t=l.opts.getResponseError(o.responseText,o)||new Error("Upload error");return t.request=o,a(t),i(t)}),o.addEventListener("error",function(e){s.done();var t=l.opts.getResponseError(o.responseText,o)||new Error("Upload error");return a(t),i(t)}),l.uppy.on("cancel-all",function(){s.done(),o.abort()}),o.open(t.toUpperCase(),e,!0),o.withCredentials=l.opts.withCredentials,""!==l.opts.responseType&&(o.responseType=l.opts.responseType),Object.keys(l.opts.headers).forEach(function(e){o.setRequestHeader(e,l.opts.headers[e])}),o.send(n),u.forEach(function(e){l.uppy.emit("upload-started",e)})})},n.uploadFiles=function(r){var i=this,e=r.map(function(e,t){var n=parseInt(t,10)+1,t=r.length;return e.error?Promise.reject(new Error(e.error)):e.isRemote?i.uploadRemote(e,n,t):i.upload(e,n,t)});return Lo(e)},n.onFileRemove=function(t,n){this.uploaderEvents[t].on("file-removed",function(e){t===e.id&&n(e.id)})},n.onRetry=function(t,n){this.uploaderEvents[t].on("upload-retry",function(e){t===e&&n()})},n.onRetryAll=function(t,n){var r=this;this.uploaderEvents[t].on("retry-all",function(e){r.uppy.getFile(t)&&n()})},n.onCancelAll=function(e,t){var n=this;this.uploaderEvents[e].on("cancel-all",function(){n.uppy.getFile(e)&&t()})},n.handleUpload=function(e){var t=this;if(0===e.length)return this.uppy.log("[XHRUpload] No files to upload!"),Promise.resolve();0!==this.opts.limit||this.opts.__queue||this.uppy.log("[XHRUpload] When uploading multiple files at once, consider setting the `limit` option (to `10` for example), to limit the number of concurrent uploads, which helps prevent memory and network issues: https://uppy.io/docs/xhr-upload/#limit-0","warning"),this.uppy.log("[XHRUpload] Uploading...");e=e.map(function(e){return t.uppy.getFile(e)});if(this.opts.bundle){if(e.some(function(e){return e.isRemote}))throw new Error("Cant upload remote files when bundle: true option is set");return this.uploadBundle(e)}return this.uploadFiles(e).then(function(){return null})},n.install=function(){var e;this.opts.bundle&&(e=this.uppy.getState().capabilities,this.uppy.setState({capabilities:wc({},e,{individualCancellation:!1})})),this.uppy.addUploader(this.handleUpload)},n.uninstall=function(){var e;this.opts.bundle&&(e=this.uppy.getState().capabilities,this.uppy.setState({capabilities:wc({},e,{individualCancellation:!0})})),this.uppy.removeUploader(this.handleUpload)},t}(ue.Plugin),o.VERSION="1.6.7",ds),Fc={__esModule:!0};Fc.default=xc,Fc.getFieldData=Dc;var Ac={"[object HTMLCollection]":!0,"[object NodeList]":!0,"[object RadioNodeList]":!0},Ec={button:!0,fieldset:!0,reset:!0,submit:!0},Oc={checkbox:!0,radio:!0},Uc=/^\s+|\s+$/g,Rc=Array.prototype.slice,Tc=Object.prototype.toString;function xc(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{trim:!1};if(!e)throw new Error("A form is required by getFormData, was given form="+e);for(var n={},r=void 0,i=[],o={},s=0,a=e.elements.length;s<a;s++){var u=e.elements[s];Ec[u.type]||u.disabled||(r=u.name||u.id)&&!o[r]&&(i.push(r),o[r]=!0)}for(var l=0,c=i.length;l<c;l++){var p=Dc(e,r=i[l],t);null!=p&&(n[r]=p)}return n}function Dc(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{trim:!1};if(!e)throw new Error("A form is required by getFieldData, was given form="+e);if(!t&&"[object String]"!==Tc.call(t))throw new Error("A field name is required by getFieldData, was given fieldName="+t);var r=e.elements[t];if(!r||r.disabled)return null;if(!Ac[Tc.call(r)])return Bc(r,n.trim);for(var i,o=[],s=!0,a=0,u=r.length;a<u;a++)r[a].disabled||(s&&"radio"!==r[a].type&&(s=!1),null!=(i=Bc(r[a],n.trim))&&(o=o.concat(i)));return s&&1===o.length?o[0]:0<o.length?o:null}function Bc(e,t){var n=null,r=e.type;if("select-one"===r)return n=e.options.length?e.options[e.selectedIndex].value:n;if("select-multiple"!==r)return"file"===r&&"files"in e?e.multiple?0===(n=Rc.call(e.files)).length&&(n=null):n=e.files[0]:Oc[r]?e.checked&&(n=e.value):n=t?e.value.replace(Uc,""):e.value,n;for(var n=[],i=0,o=e.options.length;i<o;i++)e.options[i].selected&&n.push(e.options[i].value);return n=0===n.length?null:n}function Ic(){return(Ic=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,r=arguments[t];for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function jc(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}xc.getFieldData=Dc;var Mc=Fc.default||Fc,ds=(o=Ss=function(n){var e;function t(e,t){return(e=n.call(this,e,t)||this).type="acquirer",e.id=e.opts.id||"Form",e.title="Form",e.opts=Ic({},{target:null,resultName:"uppyResult",getMetaFromForm:!0,addResultToForm:!0,multipleResults:!1,submitOnSuccess:!1,triggerUploadOnSubmit:!1},t),e.handleFormSubmit=e.handleFormSubmit.bind(jc(e)),e.handleUploadStart=e.handleUploadStart.bind(jc(e)),e.handleSuccess=e.handleSuccess.bind(jc(e)),e.addResultToForm=e.addResultToForm.bind(jc(e)),e.getMetaFromForm=e.getMetaFromForm.bind(jc(e)),e}r=n,(e=t).prototype=Object.create(r.prototype),(e.prototype.constructor=e).__proto__=r;var r=t.prototype;return r.handleUploadStart=function(){this.opts.getMetaFromForm&&this.getMetaFromForm()},r.handleSuccess=function(e){this.opts.addResultToForm&&this.addResultToForm(e),this.opts.submitOnSuccess&&this.form.submit()},r.handleFormSubmit=function(e){var t,n=this;this.opts.triggerUploadOnSubmit&&(e.preventDefault(),e=Mr(e.target.elements),t=[],e.forEach(function(e){"BUTTON"!==e.tagName&&("INPUT"!==e.tagName||"submit"!==e.type)||e.disabled||(e.disabled=!0,t.push(e))}),this.uppy.upload().then(function(){t.forEach(function(e){e.disabled=!1})},function(e){return t.forEach(function(e){e.disabled=!1}),Promise.reject(e)}).catch(function(e){n.uppy.log(e.stack||e.message||e)}))},r.addResultToForm=function(e){this.uppy.log("[Form] Adding result to the original form:"),this.uppy.log(e);var t,n=this.form.querySelector('[name="'+this.opts.resultName+'"]');if(n)if(this.opts.multipleResults){try{t=JSON.parse(n.value)}catch(e){}(t=!Array.isArray(t)?[]:t).push(e),n.value=JSON.stringify(t)}else n.value=JSON.stringify(e);else(n=document.createElement("input")).name=this.opts.resultName,n.type="hidden",this.opts.multipleResults?n.value=JSON.stringify([e]):n.value=JSON.stringify(e),this.form.appendChild(n)},r.getMetaFromForm=function(){var e=Mc(this.form);delete e[this.opts.resultName],this.uppy.setMeta(e)},r.install=function(){this.form=se(this.opts.target),this.form&&"FORM"===this.form.nodeName?(this.form.addEventListener("submit",this.handleFormSubmit),this.uppy.on("upload",this.handleUploadStart),this.uppy.on("complete",this.handleSuccess)):this.uppy.log("Form plugin requires a <form> target element passed in options to operate, none was found","error")},r.uninstall=function(){this.form.removeEventListener("submit",this.handleFormSubmit),this.uppy.off("upload",this.handleUploadStart),this.uppy.off("complete",this.handleSuccess)},t}(ue.Plugin),Ss.VERSION="1.3.22",o),Lc={},Nc="undefined"!=typeof navigator&&"serviceWorker"in navigator,Ss=((Fc=zc.prototype).list=function(){var t=this,n={},e=new Promise(function(e,t){n.resolve=e,n.reject=t});console.log("Loading stored blobs from Service Worker");function r(e){e.data.store===t.name&&"uppy/ALL_FILES"===e.data.type&&(n.resolve(e.data.files),navigator.serviceWorker.removeEventListener("message",r))}return this.ready.then(function(){navigator.serviceWorker.addEventListener("message",r),navigator.serviceWorker.controller.postMessage({type:"uppy/GET_FILES",store:t.name})}),e},Fc.put=function(e){var t=this;return this.ready.then(function(){navigator.serviceWorker.controller.postMessage({type:"uppy/ADD_FILE",store:t.name,file:e})})},Fc.delete=function(e){var t=this;return this.ready.then(function(){navigator.serviceWorker.controller.postMessage({type:"uppy/REMOVE_FILE",store:t.name,fileID:e})})},zc);function zc(e){this.ready=new Promise(function(e,t){Nc?navigator.serviceWorker.controller?e():navigator.serviceWorker.addEventListener("controllerchange",function(){e()}):t(new Error("Unsupported"))}),this.name=e.storeName}Ss.isSupported=Nc;var Lc=Ss,qc={};function Hc(){return(Hc=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,r=arguments[t];for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}var Vc="undefined"!=typeof window&&(window.indexedDB||window.webkitIndexedDB||window.mozIndexedDB||window.OIndexedDB||window.msIndexedDB),o=!!Vc;function Wc(e){var t=Vc.open(e,3);return new Promise(function(r,e){t.onupgradeneeded=function(e){var t=e.target.result,n=e.currentTarget.transaction;e.oldVersion<2&&t.createObjectStore("files",{keyPath:"id"}).createIndex("store","store",{unique:!1}),e.oldVersion<3&&((e=n.objectStore("files")).createIndex("expires","expires",{unique:!1}),e.openCursor().onsuccess=function(e){var t=e.target.result;t&&((e=t.value).expires=Date.now()+864e5,t.update(e))}),n.oncomplete=function(){r(t)}},t.onsuccess=function(e){r(e.target.result)},t.onerror=e})}function Xc(n){return new Promise(function(t,e){n.onsuccess=function(e){t(e.target.result)},n.onerror=e})}var Gc=!1,Ss=((Fc=Kc.prototype).key=function(e){return this.name+"!"+e},Fc.list=function(){var t=this;return this.ready.then(function(e){return Xc(e.transaction(["files"],"readonly").objectStore("files").index("store").getAll(IDBKeyRange.only(t.name)))}).then(function(e){var t={};return e.forEach(function(e){t[e.fileID]=e.data}),t})},Fc.get=function(t){var n=this;return this.ready.then(function(e){return Xc(e.transaction(["files"],"readonly").objectStore("files").get(n.key(t)))}).then(function(e){return{id:e.data.fileID,data:e.data.data}})},Fc.getSize=function(){var t=this;return this.ready.then(function(e){var r=e.transaction(["files"],"readonly").objectStore("files").index("store").openCursor(IDBKeyRange.only(t.name));return new Promise(function(t,e){var n=0;r.onsuccess=function(e){e=e.target.result;e?(n+=e.value.data.size,e.continue()):t(n)},r.onerror=function(){e(new Error("Could not retrieve stored blobs size"))}})})},Fc.put=function(t){var n=this;return t.data.size>this.opts.maxFileSize?Promise.reject(new Error("File is too big to store.")):this.getSize().then(function(e){return e>n.opts.maxTotalSize?Promise.reject(new Error("No space left")):n.ready}).then(function(e){return Xc(e.transaction(["files"],"readwrite").objectStore("files").add({id:n.key(t.id),fileID:t.id,store:n.name,expires:Date.now()+n.opts.expires,data:t.data}))})},Fc.delete=function(t){var n=this;return this.ready.then(function(e){return Xc(e.transaction(["files"],"readwrite").objectStore("files").delete(n.key(t)))})},Kc.cleanup=function(){return Wc("uppy-blobs").then(function(r){var t=r.transaction(["files"],"readwrite").objectStore("files").index("expires").openCursor(IDBKeyRange.upperBound(Date.now()));return new Promise(function(n,e){t.onsuccess=function(e){var t=e.target.result;t?(e=t.value,console.log("[IndexedDBStore] Deleting record",e.fileID,"of size",z(e.data.size),"- expired on",new Date(e.expires)),t.delete(),t.continue()):n(r)},t.onerror=e})}).then(function(e){e.close()})},Kc);function Kc(e){var t=this;this.opts=Hc({dbName:"uppy-blobs",storeName:"default",expires:864e5,maxFileSize:10485760,maxTotalSize:314572800},e),this.name=this.opts.storeName;e=function(){return Wc(t.opts.dbName)};Gc?this.ready=e():(Gc=!0,this.ready=Kc.cleanup().then(e,e))}function $c(){return($c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,r=arguments[t];for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function Yc(e){try{return JSON.parse(e)}catch(e){return null}}Ss.isSupported=o;var qc=Ss,Jc=!1,Qc=((Fc=Zc.prototype).load=function(){var e=localStorage.getItem(this.name);if(!e)return null;e=Yc(e);return e?e.metadata||(this.save(e),e):null},Fc.save=function(e){var t=Date.now()+this.opts.expires,t=JSON.stringify({metadata:e,expires:t});localStorage.setItem(this.name,t)},Zc.cleanup=function(){var e=function(){for(var e=[],t=0;t<localStorage.length;t++){var n=localStorage.key(t);/^uppyState:/.test(n)&&e.push(n.slice("uppyState:".length))}return e}(),n=Date.now();e.forEach(function(e){var t=localStorage.getItem("uppyState:"+e);if(!t)return null;t=Yc(t);if(!t)return null;t.expires&&t.expires<n&&localStorage.removeItem("uppyState:"+e)})},Zc);function Zc(e){this.opts=$c({expires:864e5},e),this.name="uppyState:"+e.storeName,Jc||(Jc=!0,Zc.cleanup())}function ep(){return(ep=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,r=arguments[t];for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function tp(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}Ss=o=function(r){var e;function t(e,t){var n;return(n=r.call(this,e,t)||this).type="debugger",n.id=n.opts.id||"GoldenRetriever",n.title="Golden Retriever",n.opts=ep({},{expires:864e5,serviceWorker:!1},t),n.MetaDataStore=new Qc({expires:n.opts.expires,storeName:e.getID()}),n.ServiceWorkerStore=null,n.opts.serviceWorker&&(n.ServiceWorkerStore=new Lc({storeName:e.getID()})),n.IndexedDBStore=new qc(ep({expires:n.opts.expires},n.opts.indexedDB||{},{storeName:e.getID()})),n.saveFilesStateToLocalStorage=n.saveFilesStateToLocalStorage.bind(tp(n)),n.loadFilesStateFromLocalStorage=n.loadFilesStateFromLocalStorage.bind(tp(n)),n.loadFileBlobsFromServiceWorker=n.loadFileBlobsFromServiceWorker.bind(tp(n)),n.loadFileBlobsFromIndexedDB=n.loadFileBlobsFromIndexedDB.bind(tp(n)),n.onBlobsLoaded=n.onBlobsLoaded.bind(tp(n)),n}n=r,(e=t).prototype=Object.create(n.prototype),(e.prototype.constructor=e).__proto__=n;var n=t.prototype;return n.loadFilesStateFromLocalStorage=function(){var e=this.MetaDataStore.load();e&&(this.uppy.log("[GoldenRetriever] Recovered some state from Local Storage"),this.uppy.setState({currentUploads:e.currentUploads||{},files:e.files||{}}),this.savedPluginData=e.pluginData)},n.getWaitingFiles=function(){var t={};return this.uppy.getFiles().forEach(function(e){e.progress&&e.progress.uploadStarted||(t[e.id]=e)}),t},n.getUploadingFiles=function(){var t=this,n={},r=this.uppy.getState().currentUploads;return r&&Object.keys(r).forEach(function(e){r[e].fileIDs.forEach(function(e){n[e]=t.uppy.getFile(e)})}),n},n.saveFilesStateToLocalStorage=function(){var e=ep(this.getWaitingFiles(),this.getUploadingFiles()),t={};this.uppy.emit("restore:get-data",function(e){ep(t,e)});var n=this.uppy.getState().currentUploads;this.MetaDataStore.save({currentUploads:n,files:e,pluginData:t})},n.loadFileBlobsFromServiceWorker=function(){var n=this;this.ServiceWorkerStore.list().then(function(e){var t=Object.keys(e).length;return t===n.uppy.getFiles().length?(n.uppy.log("[GoldenRetriever] Successfully recovered "+t+" blobs from Service Worker!"),n.uppy.info("Successfully recovered "+t+" files","success",3e3),n.onBlobsLoaded(e)):(n.uppy.log("[GoldenRetriever] No blobs found in Service Worker, trying IndexedDB now..."),n.loadFileBlobsFromIndexedDB())}).catch(function(e){n.uppy.log("[GoldenRetriever] Failed to recover blobs from Service Worker","warning"),n.uppy.log(e)})},n.loadFileBlobsFromIndexedDB=function(){var n=this;this.IndexedDBStore.list().then(function(e){var t=Object.keys(e).length;if(0<t)return n.uppy.log("[GoldenRetriever] Successfully recovered "+t+" blobs from IndexedDB!"),n.uppy.info("Successfully recovered "+t+" files","success",3e3),n.onBlobsLoaded(e);n.uppy.log("[GoldenRetriever] No blobs found in IndexedDB")}).catch(function(e){n.uppy.log("[GoldenRetriever] Failed to recover blobs from IndexedDB","warning"),n.uppy.log(e)})},n.onBlobsLoaded=function(n){var r=this,i=[],o=ep({},this.uppy.getState().files);Object.keys(n).forEach(function(e){var t=r.uppy.getFile(e);t?(t=ep({},t,{data:n[e],isRestored:!0}),o[e]=t):i.push(e)}),this.uppy.setState({files:o}),this.uppy.emit("restored",this.savedPluginData),i.length&&this.deleteBlobs(i).then(function(){r.uppy.log("[GoldenRetriever] Cleaned up "+i.length+" old files")}).catch(function(e){r.uppy.log("[GoldenRetriever] Could not clean up "+i.length+" old files","warning"),r.uppy.log(e)})},n.deleteBlobs=function(e){var t=this,n=[];return e.forEach(function(e){t.ServiceWorkerStore&&n.push(t.ServiceWorkerStore.delete(e)),t.IndexedDBStore&&n.push(t.IndexedDBStore.delete(e))}),Promise.all(n)},n.install=function(){var n=this;this.loadFilesStateFromLocalStorage(),0<this.uppy.getFiles().length?this.ServiceWorkerStore?(this.uppy.log("[GoldenRetriever] Attempting to load files from Service Worker..."),this.loadFileBlobsFromServiceWorker()):(this.uppy.log("[GoldenRetriever] Attempting to load files from Indexed DB..."),this.loadFileBlobsFromIndexedDB()):(this.uppy.log("[GoldenRetriever] No files need to be loaded, only restoring processing state..."),this.onBlobsLoaded([])),this.uppy.on("file-added",function(e){e.isRemote||(n.ServiceWorkerStore&&n.ServiceWorkerStore.put(e).catch(function(e){n.uppy.log("[GoldenRetriever] Could not store file","warning"),n.uppy.log(e)}),n.IndexedDBStore.put(e).catch(function(e){n.uppy.log("[GoldenRetriever] Could not store file","warning"),n.uppy.log(e)}))}),this.uppy.on("file-removed",function(e){n.ServiceWorkerStore&&n.ServiceWorkerStore.delete(e.id).catch(function(e){n.uppy.log("[GoldenRetriever] Failed to remove file","warning"),n.uppy.log(e)}),n.IndexedDBStore.delete(e.id).catch(function(e){n.uppy.log("[GoldenRetriever] Failed to remove file","warning"),n.uppy.log(e)})}),this.uppy.on("complete",function(e){var t=e.successful,e=t.map(function(e){return e.id});n.deleteBlobs(e).then(function(){n.uppy.log("[GoldenRetriever] Removed "+t.length+" files that finished uploading")}).catch(function(e){n.uppy.log("[GoldenRetriever] Could not remove "+t.length+" files that finished uploading","warning"),n.uppy.log(e)})}),this.uppy.on("state-update",this.saveFilesStateToLocalStorage),this.uppy.on("restored",function(){var t=n.uppy.getState().currentUploads;t&&Object.keys(t).forEach(function(e){n.uppy.restore(e,t[e])})})},t}(ue.Plugin),o.VERSION="1.3.21",Fc=Ss;function np(){return(np=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,r=arguments[t];for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function rp(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}Ss=o=function(n){var e;function t(e,t){return(e=n.call(this,e,t)||this).type="debugger",e.id=e.opts.id||"ReduxDevTools",e.title="Redux DevTools",e.opts=np({},{},t),e.handleStateChange=e.handleStateChange.bind(rp(e)),e.initDevTools=e.initDevTools.bind(rp(e)),e}r=n,(e=t).prototype=Object.create(r.prototype),(e.prototype.constructor=e).__proto__=r;var r=t.prototype;return r.handleStateChange=function(e,t,n){this.devTools.send("UPPY_STATE_UPDATE",t)},r.initDevTools=function(){var n=this;this.devTools=window.devToolsExtension.connect(),this.devToolsUnsubscribe=this.devTools.subscribe(function(e){if("DISPATCH"===e.type)switch(e.payload.type){case"RESET":return void n.uppy.reset();case"IMPORT_STATE":var t=e.payload.nextLiftedState.computedStates;return n.uppy.store.state=np({},n.uppy.getState(),t[t.length-1].state),void n.uppy.updateAll(n.uppy.getState());case"JUMP_TO_STATE":case"JUMP_TO_ACTION":n.uppy.store.state=np({},n.uppy.getState(),JSON.parse(e.state)),n.uppy.updateAll(n.uppy.getState())}})},r.install=function(){this.withDevTools="undefined"!=typeof window&&window.__REDUX_DEVTOOLS_EXTENSION__,this.withDevTools&&(this.initDevTools(),this.uppy.on("state-update",this.handleStateChange))},r.uninstall=function(){this.withDevTools&&(this.devToolsUnsubscribe(),this.uppy.off("state-update",this.handleStateUpdate))},t}(ue.Plugin),o.VERSION="1.3.6",o=Ss,Ss={};return Ss.Core=ue,Ss.debugLogger=Ss.Core.debugLogger,Ss.server=We,Ss.views={ProviderView:Mt},Ss.DefaultStore=Y,Ss.ReduxStore=E,Ss.Dashboard=Le,Ss.DragDrop=oi,Ss.FileInput=b,Ss.Informer=Sr,Ss.ProgressBar=yn,Ss.StatusBar=gr,Ss.Dropbox=re,Ss.GoogleDrive=_i,Ss.Instagram=Fi,Ss.OneDrive=Ri,Ss.Facebook=_,Ss.Unsplash=Ni,Ss.Url=le,Ss.Webcam=Xr,Ss.ScreenCapture=e,Ss.AwsS3=ps,Ss.AwsS3Multipart=Ls,Ss.Transloadit=tl,Ss.Tus=tu,Ss.XHRUpload=A,Ss.Form=ds,Ss.GoldenRetriever=Fc,Ss.ReduxDevTools=o,Ss.ThumbnailGenerator=jr,Ss.locales={},Ss});